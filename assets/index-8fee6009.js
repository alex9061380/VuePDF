var GC=Object.defineProperty;var eC=(wI,c,$)=>c in wI?GC(wI,c,{enumerable:!0,configurable:!0,writable:!0,value:$}):wI[c]=$;var cg=(wI,c,$)=>(eC(wI,typeof c!="symbol"?c+"":c,$),$),ug=(wI,c,$)=>{if(!c.has(wI))throw TypeError("Cannot "+$)};var VI=(wI,c,$)=>(ug(wI,c,"read from private field"),$?$.call(wI):c.get(wI)),zI=(wI,c,$)=>{if(c.has(wI))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(wI):c.set(wI,$)},UI=(wI,c,$,h)=>(ug(wI,c,"write to private field"),h?h.call(wI,$):c.set(wI,$),$),yg=(wI,c,$,h)=>({set _(M){UI(wI,c,M,$)},get _(){return VI(wI,c,h)}}),jI=(wI,c,$)=>(ug(wI,c,"access private method"),$);import{k as defineComponent,g as ref,j as watch,l as onMounted,o as openBlock,c as createElementBlock,a as createBaseVNode,h as withDirectives,m as vShow,p as renderSlot,s as shallowRef}from"./app-268824dc.js";function getAugmentedNamespace$1(wI){if(wI.__esModule)return wI;var c=wI.default;if(typeof c=="function"){var $=function h(){if(this instanceof h){var M=[null];M.push.apply(M,arguments);var _=Function.bind.apply(c,M);return new _}return c.apply(this,arguments)};$.prototype=c.prototype}else $={};return Object.defineProperty($,"__esModule",{value:!0}),Object.keys(wI).forEach(function(h){var M=Object.getOwnPropertyDescriptor(wI,h);Object.defineProperty($,h,M.get?M:{enumerable:!0,get:function(){return wI[h]}})}),$}function commonjsRequire$1(wI){throw new Error('Could not dynamically require "'+wI+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal$2={},__viteBrowserExternal$3=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal$2},Symbol.toStringTag,{value:"Module"})),require$$5$1=getAugmentedNamespace$1(__viteBrowserExternal$3);(function(module,exports){(function(c,$){module.exports=$()})(globalThis,()=>(()=>{var __webpack_modules__=[,(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.VerbosityLevel=c.Util=c.UnknownErrorException=c.UnexpectedResponseException=c.UNSUPPORTED_FEATURES=c.TextRenderingMode=c.StreamType=c.RenderingIntentFlag=c.PermissionFlag=c.PasswordResponses=c.PasswordException=c.PageActionEventType=c.OPS=c.MissingPDFException=c.LINE_FACTOR=c.LINE_DESCENT_FACTOR=c.InvalidPDFException=c.ImageKind=c.IDENTITY_MATRIX=c.FormatError=c.FontType=c.FeatureTest=c.FONT_IDENTITY_MATRIX=c.DocumentActionEventType=c.CMapCompressionType=c.BaseException=c.AnnotationType=c.AnnotationStateModelType=c.AnnotationReviewState=c.AnnotationReplyType=c.AnnotationMode=c.AnnotationMarkedState=c.AnnotationFlag=c.AnnotationFieldFlag=c.AnnotationEditorType=c.AnnotationEditorPrefix=c.AnnotationEditorParamsType=c.AnnotationBorderStyleType=c.AnnotationActionEventType=c.AbortException=void 0,c.arrayByteLength=uI,c.arraysToBytes=MI,c.assert=e,c.bytesToString=Q,c.createPromiseCapability=HI,c.createValidAbsoluteUrl=x,c.escapeString=TI,c.getModificationDate=yI,c.getVerbosityLevel=mI,c.info=NI,c.isArrayBuffer=SI,c.isArrayEqual=JI,c.isAscii=vI,c.objectFromMap=tI,c.objectSize=WI,c.setVerbosityLevel=q,c.shadow=E,c.string32=ZI,c.stringToBytes=lI,c.stringToPDFString=FI,c.stringToUTF16BEString=fI,c.stringToUTF8String=PI,c.unreachable=J,c.utf8StringToString=EI,c.warn=BI,$(2);const h=[1,0,0,1,0,0];c.IDENTITY_MATRIX=h;const M=[.001,0,0,.001,0,0];c.FONT_IDENTITY_MATRIX=M;const _=1.35;c.LINE_FACTOR=_;const z=.35;c.LINE_DESCENT_FACTOR=z;const T={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};c.RenderingIntentFlag=T;const r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};c.AnnotationMode=r;const Z="pdfjs_internal_editor_";c.AnnotationEditorPrefix=Z;const p={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};c.AnnotationEditorType=p;const j={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};c.AnnotationEditorParamsType=j;const D={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};c.PermissionFlag=D;const m={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};c.TextRenderingMode=m;const d={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};c.ImageKind=d;const C={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};c.AnnotationType=C;const l={MARKED:"Marked",REVIEW:"Review"};c.AnnotationStateModelType=l;const B={MARKED:"Marked",UNMARKED:"Unmarked"};c.AnnotationMarkedState=B;const Y={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};c.AnnotationReviewState=Y;const a={GROUP:"Group",REPLY:"R"};c.AnnotationReplyType=a;const i={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};c.AnnotationFlag=i;const I={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};c.AnnotationFieldFlag=I;const g={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};c.AnnotationBorderStyleType=g;const o={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};c.AnnotationActionEventType=o;const X={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};c.DocumentActionEventType=X;const b={O:"PageOpen",C:"PageClose"};c.PageActionEventType=b;const N={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};c.StreamType=N;const F={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};c.FontType=F;const hI={ERRORS:0,WARNINGS:1,INFOS:5};c.VerbosityLevel=hI;const YI={NONE:0,BINARY:1,STREAM:2};c.CMapCompressionType=YI;const nI={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};c.OPS=nI;const gI={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};c.UNSUPPORTED_FEATURES=gI;const U={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};c.PasswordResponses=U;let II=hI.WARNINGS;function q(cI){Number.isInteger(cI)&&(II=cI)}function mI(){return II}function NI(cI){II>=hI.INFOS&&console.log(`Info: ${cI}`)}function BI(cI){II>=hI.WARNINGS&&console.log(`Warning: ${cI}`)}function J(cI){throw new Error(cI)}function e(cI,CI){cI||J(CI)}function w(cI){if(!cI)return!1;switch(cI.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function x(cI,CI=null,AI=null){if(!cI)return null;try{if(AI&&typeof cI=="string"){if(AI.addDefaultProtocol&&cI.startsWith("www.")){const LI=cI.match(/\./g);LI&&LI.length>=2&&(cI=`http://${cI}`)}if(AI.tryConvertEncoding)try{cI=PI(cI)}catch{}}const KI=CI?new URL(cI,CI):new URL(cI);if(w(KI))return KI}catch{}return null}function E(cI,CI,AI){return Object.defineProperty(cI,CI,{value:AI,enumerable:!0,configurable:!0,writable:!1}),AI}const P=function(){function CI(AI,KI){this.constructor===CI&&J("Cannot initialize BaseException."),this.message=AI,this.name=KI}return CI.prototype=new Error,CI.constructor=CI,CI}();c.BaseException=P;class iI extends P{constructor(CI,AI){super(CI,"PasswordException"),this.code=AI}}c.PasswordException=iI;class aI extends P{constructor(CI,AI){super(CI,"UnknownErrorException"),this.details=AI}}c.UnknownErrorException=aI;class eI extends P{constructor(CI){super(CI,"InvalidPDFException")}}c.InvalidPDFException=eI;class A extends P{constructor(CI){super(CI,"MissingPDFException")}}c.MissingPDFException=A;class W extends P{constructor(CI,AI){super(CI,"UnexpectedResponseException"),this.status=AI}}c.UnexpectedResponseException=W;class L extends P{constructor(CI){super(CI,"FormatError")}}c.FormatError=L;class S extends P{constructor(CI){super(CI,"AbortException")}}c.AbortException=S;function Q(cI){(typeof cI!="object"||cI===null||cI.length===void 0)&&J("Invalid argument for bytesToString");const CI=cI.length,AI=8192;if(CI<AI)return String.fromCharCode.apply(null,cI);const KI=[];for(let LI=0;LI<CI;LI+=AI){const rI=Math.min(LI+AI,CI),kI=cI.subarray(LI,rI);KI.push(String.fromCharCode.apply(null,kI))}return KI.join("")}function lI(cI){typeof cI!="string"&&J("Invalid argument for stringToBytes");const CI=cI.length,AI=new Uint8Array(CI);for(let KI=0;KI<CI;++KI)AI[KI]=cI.charCodeAt(KI)&255;return AI}function uI(cI){if(cI.length!==void 0)return cI.length;if(cI.byteLength!==void 0)return cI.byteLength;J("Invalid argument for arrayByteLength")}function MI(cI){const CI=cI.length;if(CI===1&&cI[0]instanceof Uint8Array)return cI[0];let AI=0;for(let rI=0;rI<CI;rI++)AI+=uI(cI[rI]);let KI=0;const LI=new Uint8Array(AI);for(let rI=0;rI<CI;rI++){let kI=cI[rI];kI instanceof Uint8Array||(typeof kI=="string"?kI=lI(kI):kI=new Uint8Array(kI));const xI=kI.byteLength;LI.set(kI,KI),KI+=xI}return LI}function ZI(cI){return String.fromCharCode(cI>>24&255,cI>>16&255,cI>>8&255,cI&255)}function WI(cI){return Object.keys(cI).length}function tI(cI){const CI=Object.create(null);for(const[AI,KI]of cI)CI[AI]=KI;return CI}function O(){const cI=new Uint8Array(4);return cI[0]=1,new Uint32Array(cI.buffer,0,1)[0]===1}function f(){try{return new Function(""),!0}catch{return!1}}class v{static get isLittleEndian(){return E(this,"isLittleEndian",O())}static get isEvalSupported(){return E(this,"isEvalSupported",f())}static get isOffscreenCanvasSupported(){return E(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}c.FeatureTest=v;const RI=[...Array(256).keys()].map(cI=>cI.toString(16).padStart(2,"0"));class pI{static makeHexColor(CI,AI,KI){return`#${RI[CI]}${RI[AI]}${RI[KI]}`}static scaleMinMax(CI,AI){let KI;CI[0]?(CI[0]<0&&(KI=AI[0],AI[0]=AI[1],AI[1]=KI),AI[0]*=CI[0],AI[1]*=CI[0],CI[3]<0&&(KI=AI[2],AI[2]=AI[3],AI[3]=KI),AI[2]*=CI[3],AI[3]*=CI[3]):(KI=AI[0],AI[0]=AI[2],AI[2]=KI,KI=AI[1],AI[1]=AI[3],AI[3]=KI,CI[1]<0&&(KI=AI[2],AI[2]=AI[3],AI[3]=KI),AI[2]*=CI[1],AI[3]*=CI[1],CI[2]<0&&(KI=AI[0],AI[0]=AI[1],AI[1]=KI),AI[0]*=CI[2],AI[1]*=CI[2]),AI[0]+=CI[4],AI[1]+=CI[4],AI[2]+=CI[5],AI[3]+=CI[5]}static transform(CI,AI){return[CI[0]*AI[0]+CI[2]*AI[1],CI[1]*AI[0]+CI[3]*AI[1],CI[0]*AI[2]+CI[2]*AI[3],CI[1]*AI[2]+CI[3]*AI[3],CI[0]*AI[4]+CI[2]*AI[5]+CI[4],CI[1]*AI[4]+CI[3]*AI[5]+CI[5]]}static applyTransform(CI,AI){const KI=CI[0]*AI[0]+CI[1]*AI[2]+AI[4],LI=CI[0]*AI[1]+CI[1]*AI[3]+AI[5];return[KI,LI]}static applyInverseTransform(CI,AI){const KI=AI[0]*AI[3]-AI[1]*AI[2],LI=(CI[0]*AI[3]-CI[1]*AI[2]+AI[2]*AI[5]-AI[4]*AI[3])/KI,rI=(-CI[0]*AI[1]+CI[1]*AI[0]+AI[4]*AI[1]-AI[5]*AI[0])/KI;return[LI,rI]}static getAxialAlignedBoundingBox(CI,AI){const KI=pI.applyTransform(CI,AI),LI=pI.applyTransform(CI.slice(2,4),AI),rI=pI.applyTransform([CI[0],CI[3]],AI),kI=pI.applyTransform([CI[2],CI[1]],AI);return[Math.min(KI[0],LI[0],rI[0],kI[0]),Math.min(KI[1],LI[1],rI[1],kI[1]),Math.max(KI[0],LI[0],rI[0],kI[0]),Math.max(KI[1],LI[1],rI[1],kI[1])]}static inverseTransform(CI){const AI=CI[0]*CI[3]-CI[1]*CI[2];return[CI[3]/AI,-CI[1]/AI,-CI[2]/AI,CI[0]/AI,(CI[2]*CI[5]-CI[4]*CI[3])/AI,(CI[4]*CI[1]-CI[5]*CI[0])/AI]}static apply3dTransform(CI,AI){return[CI[0]*AI[0]+CI[1]*AI[1]+CI[2]*AI[2],CI[3]*AI[0]+CI[4]*AI[1]+CI[5]*AI[2],CI[6]*AI[0]+CI[7]*AI[1]+CI[8]*AI[2]]}static singularValueDecompose2dScale(CI){const AI=[CI[0],CI[2],CI[1],CI[3]],KI=CI[0]*AI[0]+CI[1]*AI[2],LI=CI[0]*AI[1]+CI[1]*AI[3],rI=CI[2]*AI[0]+CI[3]*AI[2],kI=CI[2]*AI[1]+CI[3]*AI[3],xI=(KI+kI)/2,_I=Math.sqrt((KI+kI)**2-4*(KI*kI-rI*LI))/2,$I=xI+_I||1,OI=xI-_I||1;return[Math.sqrt($I),Math.sqrt(OI)]}static normalizeRect(CI){const AI=CI.slice(0);return CI[0]>CI[2]&&(AI[0]=CI[2],AI[2]=CI[0]),CI[1]>CI[3]&&(AI[1]=CI[3],AI[3]=CI[1]),AI}static intersect(CI,AI){const KI=Math.max(Math.min(CI[0],CI[2]),Math.min(AI[0],AI[2])),LI=Math.min(Math.max(CI[0],CI[2]),Math.max(AI[0],AI[2]));if(KI>LI)return null;const rI=Math.max(Math.min(CI[1],CI[3]),Math.min(AI[1],AI[3])),kI=Math.min(Math.max(CI[1],CI[3]),Math.max(AI[1],AI[3]));return rI>kI?null:[KI,rI,LI,kI]}static bezierBoundingBox(CI,AI,KI,LI,rI,kI,xI,_I){const $I=[],OI=[[],[]];let gg,Ig,Ag,qI,lg,ig,og,Zg;for(let Gg=0;Gg<2;++Gg){if(Gg===0?(Ig=6*CI-12*KI+6*rI,gg=-3*CI+9*KI-9*rI+3*xI,Ag=3*KI-3*CI):(Ig=6*AI-12*LI+6*kI,gg=-3*AI+9*LI-9*kI+3*_I,Ag=3*LI-3*AI),Math.abs(gg)<1e-12){if(Math.abs(Ig)<1e-12)continue;qI=-Ag/Ig,0<qI&&qI<1&&$I.push(qI);continue}og=Ig*Ig-4*Ag*gg,Zg=Math.sqrt(og),!(og<0)&&(lg=(-Ig+Zg)/(2*gg),0<lg&&lg<1&&$I.push(lg),ig=(-Ig-Zg)/(2*gg),0<ig&&ig<1&&$I.push(ig))}let sg=$I.length,Cg;const dg=sg;for(;sg--;)qI=$I[sg],Cg=1-qI,OI[0][sg]=Cg*Cg*Cg*CI+3*Cg*Cg*qI*KI+3*Cg*qI*qI*rI+qI*qI*qI*xI,OI[1][sg]=Cg*Cg*Cg*AI+3*Cg*Cg*qI*LI+3*Cg*qI*qI*kI+qI*qI*qI*_I;return OI[0][dg]=CI,OI[1][dg]=AI,OI[0][dg+1]=xI,OI[1][dg+1]=_I,OI[0].length=OI[1].length=dg+2,[Math.min(...OI[0]),Math.min(...OI[1]),Math.max(...OI[0]),Math.max(...OI[1])]}}c.Util=pI;const DI=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function FI(cI){if(cI[0]>="ï"){let AI;if(cI[0]==="þ"&&cI[1]==="ÿ"?AI="utf-16be":cI[0]==="ÿ"&&cI[1]==="þ"?AI="utf-16le":cI[0]==="ï"&&cI[1]==="»"&&cI[2]==="¿"&&(AI="utf-8"),AI)try{const KI=new TextDecoder(AI,{fatal:!0}),LI=lI(cI);return KI.decode(LI)}catch(KI){BI(`stringToPDFString: "${KI}".`)}}const CI=[];for(let AI=0,KI=cI.length;AI<KI;AI++){const LI=DI[cI.charCodeAt(AI)];CI.push(LI?String.fromCharCode(LI):cI.charAt(AI))}return CI.join("")}function TI(cI){return cI.replace(/([()\\\n\r])/g,CI=>CI===`
`?"\\n":CI==="\r"?"\\r":`\\${CI}`)}function vI(cI){return/^[\x00-\x7F]*$/.test(cI)}function fI(cI){const CI=["þÿ"];for(let AI=0,KI=cI.length;AI<KI;AI++){const LI=cI.charCodeAt(AI);CI.push(String.fromCharCode(LI>>8&255),String.fromCharCode(LI&255))}return CI.join("")}function PI(cI){return decodeURIComponent(escape(cI))}function EI(cI){return unescape(encodeURIComponent(cI))}function SI(cI){return typeof cI=="object"&&cI!==null&&cI.byteLength!==void 0}function JI(cI,CI){if(cI.length!==CI.length)return!1;for(let AI=0,KI=cI.length;AI<KI;AI++)if(cI[AI]!==CI[AI])return!1;return!0}function yI(cI=new Date){return[cI.getUTCFullYear().toString(),(cI.getUTCMonth()+1).toString().padStart(2,"0"),cI.getUTCDate().toString().padStart(2,"0"),cI.getUTCHours().toString().padStart(2,"0"),cI.getUTCMinutes().toString().padStart(2,"0"),cI.getUTCSeconds().toString().padStart(2,"0")].join("")}function HI(){const cI=Object.create(null);let CI=!1;return Object.defineProperty(cI,"settled",{get(){return CI}}),cI.promise=new Promise(function(AI,KI){cI.resolve=function(LI){CI=!0,AI(LI)},cI.reject=function(LI){CI=!0,KI(LI)}}),cI}},(wI,c,$)=>{$(3)},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isNodeJS=void 0;const $=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");c.isNodeJS=$},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var wI,$,h,M,_,z,T,r,Z,Rg,j,D;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:d,NodeCMapReaderFactory:C,NodeStandardFontDataFactory:l}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=d,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=C,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=l}let createPDFNetworkStream;function setPDFNetworkStreamFactory(d){createPDFNetworkStream=d}function getDocument(d){const C=new PDFDocumentLoadingTask;let l;if(typeof d=="string"||d instanceof URL)l={url:d};else if((0,_util.isArrayBuffer)(d))l={data:d};else if(d instanceof PDFDataRangeTransport)l={range:d};else{if(typeof d!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!d.url&&!d.data&&!d.range)throw new Error("Invalid parameter object: need either .data, .range or .url");l=d}const B=Object.create(null);let Y=null,a=null;for(const I in l){const g=l[I];switch(I){case"url":if(typeof window<"u")try{B[I]=new URL(g,window.location).href;continue}catch(o){(0,_util.warn)(`Cannot create valid URL: "${o}".`)}else if(typeof g=="string"||g instanceof URL){B[I]=g.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":Y=g;continue;case"worker":a=g;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&g instanceof Buffer)B[I]=new Uint8Array(g);else{if(g instanceof Uint8Array)break;if(typeof g=="string")B[I]=(0,_util.stringToBytes)(g);else if(typeof g=="object"&&g!==null&&!isNaN(g.length))B[I]=new Uint8Array(g);else if((0,_util.isArrayBuffer)(g))B[I]=new Uint8Array(g);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}B[I]=g}if(B.CMapReaderFactory=B.CMapReaderFactory||DefaultCMapReaderFactory,B.StandardFontDataFactory=B.StandardFontDataFactory||DefaultStandardFontDataFactory,B.ignoreErrors=B.stopAtErrors!==!0,B.fontExtraProperties=B.fontExtraProperties===!0,B.pdfBug=B.pdfBug===!0,B.enableXfa=B.enableXfa===!0,(!Number.isInteger(B.rangeChunkSize)||B.rangeChunkSize<1)&&(B.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof B.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(B.docBaseUrl))&&(B.docBaseUrl=null),(!Number.isInteger(B.maxImageSize)||B.maxImageSize<-1)&&(B.maxImageSize=-1),typeof B.cMapUrl!="string"&&(B.cMapUrl=null),typeof B.standardFontDataUrl!="string"&&(B.standardFontDataUrl=null),typeof B.useWorkerFetch!="boolean"&&(B.useWorkerFetch=B.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&B.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof B.isEvalSupported!="boolean"&&(B.isEvalSupported=!0),typeof B.disableFontFace!="boolean"&&(B.disableFontFace=_is_node.isNodeJS),typeof B.useSystemFonts!="boolean"&&(B.useSystemFonts=!_is_node.isNodeJS&&!B.disableFontFace),(typeof B.ownerDocument!="object"||B.ownerDocument===null)&&(B.ownerDocument=globalThis.document),typeof B.disableRange!="boolean"&&(B.disableRange=!1),typeof B.disableStream!="boolean"&&(B.disableStream=!1),typeof B.disableAutoFetch!="boolean"&&(B.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(B.verbosity),!a){const I={verbosity:B.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};a=I.port?PDFWorker.fromPort(I):new PDFWorker(I),C._worker=a}const i=C.docId;return a.promise.then(function(){if(C.destroyed)throw new Error("Loading aborted");const I=_fetchDocument(a,B,Y,i),g=new Promise(function(o){let X;Y?X=new _transport_stream.PDFDataTransportStream({length:B.length,initialData:B.initialData,progressiveDone:B.progressiveDone,contentDispositionFilename:B.contentDispositionFilename,disableRange:B.disableRange,disableStream:B.disableStream},Y):B.data||(X=createPDFNetworkStream({url:B.url,length:B.length,httpHeaders:B.httpHeaders,withCredentials:B.withCredentials,rangeChunkSize:B.rangeChunkSize,disableRange:B.disableRange,disableStream:B.disableStream})),o(X)});return Promise.all([I,g]).then(function([o,X]){if(C.destroyed)throw new Error("Loading aborted");const b=new _message_handler.MessageHandler(i,o,a.port),N=new WorkerTransport(b,C,X,B);C._transport=N,b.send("Ready",null)})}).catch(C._capability.reject),C}async function _fetchDocument(d,C,l,B){if(d.destroyed)throw new Error("Worker was destroyed");l&&(C.length=l.length,C.initialData=l.initialData,C.progressiveDone=l.progressiveDone,C.contentDispositionFilename=l.contentDispositionFilename);const Y=await d.messageHandler.sendWithPromise("GetDocRequest",{docId:B,apiVersion:"2.16.105",source:{data:C.data,url:C.url,password:C.password,disableAutoFetch:C.disableAutoFetch,rangeChunkSize:C.rangeChunkSize,length:C.length},maxImageSize:C.maxImageSize,disableFontFace:C.disableFontFace,docBaseUrl:C.docBaseUrl,ignoreErrors:C.ignoreErrors,isEvalSupported:C.isEvalSupported,fontExtraProperties:C.fontExtraProperties,enableXfa:C.enableXfa,useSystemFonts:C.useSystemFonts,cMapUrl:C.useWorkerFetch?C.cMapUrl:null,standardFontDataUrl:C.useWorkerFetch?C.standardFontDataUrl:null});if(C.data&&(C.data=null),d.destroyed)throw new Error("Worker was destroyed");return Y}const c=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${yg(c,wI)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var C;this.destroyed=!0,await((C=this._transport)==null?void 0:C.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=c;wI=new WeakMap,zI(PDFDocumentLoadingTask,wI,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(C,l,B=!1,Y=null){this.length=C,this.initialData=l,this.progressiveDone=B,this.contentDispositionFilename=Y,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(C){this._rangeListeners.push(C)}addProgressListener(C){this._progressListeners.push(C)}addProgressiveReadListener(C){this._progressiveReadListeners.push(C)}addProgressiveDoneListener(C){this._progressiveDoneListeners.push(C)}onDataRange(C,l){for(const B of this._rangeListeners)B(C,l)}onDataProgress(C,l){this._readyCapability.promise.then(()=>{for(const B of this._progressListeners)B(C,l)})}onDataProgressiveRead(C){this._readyCapability.promise.then(()=>{for(const l of this._progressiveReadListeners)l(C)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const C of this._progressiveDoneListeners)C()})}transportReady(){this._readyCapability.resolve()}requestDataRange(C,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(C,l){this._pdfInfo=C,this._transport=l,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(C){return this._transport.getPage(C)}getPageIndex(C){return this._transport.getPageIndex(C)}getDestinations(){return this._transport.getDestinations()}getDestination(C){return this._transport.getDestination(C)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(C=!1){return this._transport.startCleanup(C||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(C,l,B,Y,a=!1){this._pageIndex=C,this._pageInfo=l,this._ownerDocument=Y,this._transport=B,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=B.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:C,rotation:l=this.rotate,offsetX:B=0,offsetY:Y=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:C,rotation:l,offsetX:B,offsetY:Y,dontFlip:a})}getAnnotations({intent:C="display"}={}){const l=this._transport.getRenderingIntent(C);let B=this._annotationPromises.get(l.cacheKey);return B||(B=this._transport.getAnnotations(this._pageIndex,l.renderingIntent),this._annotationPromises.set(l.cacheKey,B),B=B.then(Y=>{for(const a of Y)a.titleObj!==void 0&&Object.defineProperty(a,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),a.titleObj.str}}),a.contentsObj!==void 0&&Object.defineProperty(a,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),a.contentsObj.str}});return Y})),B}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var C;return((C=this._transport._htmlForXfa)==null?void 0:C.children[this._pageIndex])||null}render({canvasContext:C,viewport:l,intent:B="display",annotationMode:Y=_util.AnnotationMode.ENABLE,transform:a=null,imageLayer:i=null,canvasFactory:I=null,background:g=null,optionalContentConfigPromise:o=null,annotationCanvasMap:X=null,pageColors:b=null,printAnnotationStorage:N=null}){var q,mI;((q=arguments[0])==null?void 0:q.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&Y===_util.AnnotationMode.ENABLE&&(Y=_util.AnnotationMode.ENABLE_FORMS)),((mI=arguments[0])==null?void 0:mI.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&Y===_util.AnnotationMode.ENABLE&&(Y=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const F=this._transport.getRenderingIntent(B,Y,N);this.pendingCleanup=!1,o||(o=this._transport.getOptionalContentConfig());let hI=this._intentStates.get(F.cacheKey);hI||(hI=Object.create(null),this._intentStates.set(F.cacheKey,hI)),hI.streamReaderCancelTimeout&&(clearTimeout(hI.streamReaderCancelTimeout),hI.streamReaderCancelTimeout=null);const YI=I||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),nI=!!(F.renderingIntent&_util.RenderingIntentFlag.PRINT);hI.displayReadyCapability||(hI.displayReadyCapability=(0,_util.createPromiseCapability)(),hI.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(F));const gI=NI=>{hI.renderTasks.delete(U),(this.cleanupAfterRender||nI)&&(this.pendingCleanup=!0),this._tryCleanup(),NI?(U.capability.reject(NI),this._abortOperatorList({intentState:hI,reason:NI instanceof Error?NI:new Error(NI)})):U.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},U=new InternalRenderTask({callback:gI,params:{canvasContext:C,viewport:l,transform:a,imageLayer:i,background:g},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:X,operatorList:hI.operatorList,pageIndex:this._pageIndex,canvasFactory:YI,useRequestAnimationFrame:!nI,pdfBug:this._pdfBug,pageColors:b});(hI.renderTasks||(hI.renderTasks=new Set)).add(U);const II=U.task;return Promise.all([hI.displayReadyCapability.promise,o]).then(([NI,BI])=>{if(this.pendingCleanup){gI();return}this._stats&&this._stats.time("Rendering"),U.initializeGraphics({transparency:NI,optionalContentConfig:BI}),U.operatorListChanged()}).catch(gI),II}getOperatorList({intent:C="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:B=null}={}){function Y(){i.operatorList.lastChunk&&(i.opListReadCapability.resolve(i.operatorList),i.renderTasks.delete(I))}const a=this._transport.getRenderingIntent(C,l,B,!0);let i=this._intentStates.get(a.cacheKey);i||(i=Object.create(null),this._intentStates.set(a.cacheKey,i));let I;return i.opListReadCapability||(I=Object.create(null),I.operatorListChanged=Y,i.opListReadCapability=(0,_util.createPromiseCapability)(),(i.renderTasks||(i.renderTasks=new Set)).add(I),i.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(a)),i.opListReadCapability.promise}streamTextContent({disableCombineTextItems:C=!1,includeMarkedContent:l=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:C!==!0,includeMarkedContent:l===!0},{highWaterMark:100,size(Y){return Y.items.length}})}getTextContent(C={}){if(this._transport._htmlForXfa)return this.getXfa().then(B=>_xfa_text.XfaText.textContent(B));const l=this.streamTextContent(C);return new Promise(function(B,Y){function a(){i.read().then(function({value:g,done:o}){if(o){B(I);return}Object.assign(I.styles,g.styles),I.items.push(...g.items),a()},Y)}const i=l.getReader(),I={items:[],styles:Object.create(null)};a()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const C=[];for(const l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:new Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(const B of l.renderTasks)C.push(B.completed),B.cancel();this.objs.clear();for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(C)}cleanup(C=!1){return this.pendingCleanup=!0,this._tryCleanup(C)}_tryCleanup(C=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:l,operatorList:B}of this._intentStates.values())if(l.size>0||!B.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,C&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(C,l){const B=this._intentStates.get(l);B&&(this._stats&&this._stats.timeEnd("Page Request"),B.displayReadyCapability&&B.displayReadyCapability.resolve(C))}_renderPageChunk(C,l){for(let B=0,Y=C.length;B<Y;B++)l.operatorList.fnArray.push(C.fnArray[B]),l.operatorList.argsArray.push(C.argsArray[B]);l.operatorList.lastChunk=C.lastChunk,l.operatorList.separateAnnots=C.separateAnnots;for(const B of l.renderTasks)B.operatorListChanged();C.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:C,cacheKey:l,annotationStorageMap:B}){const a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:C,cacheKey:l,annotationStorage:B}).getReader(),i=this._intentStates.get(l);i.streamReader=a;const I=()=>{a.read().then(({value:g,done:o})=>{if(o){i.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,i),I())},g=>{if(i.streamReader=null,!this._transport.destroyed){if(i.operatorList){i.operatorList.lastChunk=!0;for(const o of i.renderTasks)o.operatorListChanged();this._tryCleanup()}if(i.displayReadyCapability)i.displayReadyCapability.reject(g);else if(i.opListReadCapability)i.opListReadCapability.reject(g);else throw g}})};I()}_abortOperatorList({intentState:C,reason:l,force:B=!1}){if(C.streamReader){if(!B){if(C.renderTasks.size>0)return;if(l instanceof _display_utils.RenderingCancelledException){C.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:C,reason:l,force:!0}),C.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(C.streamReader.cancel(new _util.AbortException(l.message)).catch(()=>{}),C.streamReader=null,!this._transport.destroyed){for(const[Y,a]of this._intentStates)if(a===C){this._intentStates.delete(Y);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(C,l){const B={data:structuredClone(C,l)};this._deferred.then(()=>{for(const Y of this._listeners)Y.call(this,B)})}addEventListener(C,l){this._listeners.push(l)}removeEventListener(C,l){const B=this._listeners.indexOf(l);this._listeners.splice(B,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire$1=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const d=($=document==null?void 0:document.currentScript)==null?void 0:$.src;d&&(PDFWorkerUtil.fallbackWorkerSrc=d.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(d,C){let l;try{if(l=new URL(d),!l.origin||l.origin==="null")return!1}catch{return!1}const B=new URL(C,l);return l.origin===B.origin},PDFWorkerUtil.createCDNWrapper=function(d){const C=`importScripts("${d}");`;return URL.createObjectURL(new Blob([C]))}}const _PDFWorker=class{constructor({name:d=null,port:C=null,verbosity:l=(0,_util.getVerbosityLevel)()}={}){if(C&&VI(_PDFWorker,h).has(C))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=d,this.destroyed=!1,this.verbosity=l,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,C){VI(_PDFWorker,h).set(C,this),this._initializeFromPort(C);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(d){this._port=d,this._messageHandler=new _message_handler.MessageHandler("main","worker",d),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:d}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,d)||(d=PDFWorkerUtil.createCDNWrapper(new URL(d,window.location).href));const C=new Worker(d),l=new _message_handler.MessageHandler("main","worker",C),B=()=>{C.removeEventListener("error",Y),l.destroy(),C.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Y=()=>{this._webWorker||B()};C.addEventListener("error",Y),l.on("test",i=>{if(C.removeEventListener("error",Y),this.destroyed){B();return}i?(this._messageHandler=l,this._port=C,this._webWorker=C,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),C.terminate())}),l.on("ready",i=>{if(C.removeEventListener("error",Y),this.destroyed){B();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const i=new Uint8Array;l.send("test",i,[i.buffer])};a();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(d=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const C=new LoopbackPort;this._port=C;const l=`fake${PDFWorkerUtil.fakeWorkerId++}`,B=new _message_handler.MessageHandler(l+"_worker",l,C);d.setup(B,C);const Y=new _message_handler.MessageHandler(l,l+"_worker",C);this._messageHandler=Y,this._readyCapability.resolve(),Y.send("configure",{verbosity:this.verbosity})}).catch(d=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${d.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),VI(_PDFWorker,h).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(d){if(!(d!=null&&d.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return VI(this,h).has(d.port)?VI(this,h).get(d.port):new _PDFWorker(d)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var d;try{return((d=globalThis.pdfjsWorker)==null?void 0:d.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire$1=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;h=new WeakMap,zI(PDFWorker,h,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(C,l,B,Y){zI(this,M,null);zI(this,_,new Map);zI(this,z,new Map);zI(this,T,null);this.messageHandler=C,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:l.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:Y.ownerDocument,styleElement:Y.styleElement}),this._params=Y,Y.useWorkerFetch||(this.CMapReaderFactory=new Y.CMapReaderFactory({baseUrl:Y.cMapUrl,isCompressed:Y.cMapPacked}),this.StandardFontDataFactory=new Y.StandardFontDataFactory({baseUrl:Y.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=B,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return VI(this,M)}getRenderingIntent(C,l=_util.AnnotationMode.ENABLE,B=null,Y=!1){let a=_util.RenderingIntentFlag.DISPLAY,i=null;switch(C){case"any":a=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":a=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${C}`)}switch(l){case _util.AnnotationMode.DISABLE:a+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:a+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:a+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,i=(a&_util.RenderingIntentFlag.PRINT&&B instanceof _annotation_storage.PrintAnnotationStorage?B:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return Y&&(a+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:a,cacheKey:`${a}_${_annotation_storage.AnnotationStorage.getHash(i)}`,annotationStorageMap:i}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const C=[];for(const B of VI(this,_).values())C.push(B._destroy());VI(this,_).clear(),VI(this,z).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const l=this.messageHandler.sendWithPromise("Terminate",null);return C.push(l),Promise.all(C).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),UI(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:C,loadingTask:l}=this;C.on("GetReader",(B,Y)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},Y.onPull=()=>{this._fullReader.read().then(function({value:a,done:i}){if(i){Y.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetReader - expected an ArrayBuffer."),Y.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{Y.error(a)})},Y.onCancel=a=>{this._fullReader.cancel(a),Y.ready.catch(i=>{if(!this.destroyed)throw i})}}),C.on("ReaderHeadersReady",B=>{const Y=(0,_util.createPromiseCapability)(),a=this._fullReader;return a.headersReady.then(()=>{var i;(!a.isStreamingSupported||!a.isRangeSupported)&&(this._lastProgress&&((i=l.onProgress)==null||i.call(l,this._lastProgress)),a.onProgress=I=>{var g;(g=l.onProgress)==null||g.call(l,{loaded:I.loaded,total:I.total})}),Y.resolve({isStreamingSupported:a.isStreamingSupported,isRangeSupported:a.isRangeSupported,contentLength:a.contentLength})},Y.reject),Y.promise}),C.on("GetRangeReader",(B,Y)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(B.begin,B.end);if(!a){Y.close();return}Y.onPull=()=>{a.read().then(function({value:i,done:I}){if(I){Y.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(i),"GetRangeReader - expected an ArrayBuffer."),Y.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{Y.error(i)})},Y.onCancel=i=>{a.cancel(i),Y.ready.catch(I=>{if(!this.destroyed)throw I})}}),C.on("GetDoc",({pdfInfo:B})=>{this._numPages=B.numPages,this._htmlForXfa=B.htmlForXfa,delete B.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(B,this))}),C.on("DocException",function(B){let Y;switch(B.name){case"PasswordException":Y=new _util.PasswordException(B.message,B.code);break;case"InvalidPDFException":Y=new _util.InvalidPDFException(B.message);break;case"MissingPDFException":Y=new _util.MissingPDFException(B.message);break;case"UnexpectedResponseException":Y=new _util.UnexpectedResponseException(B.message,B.status);break;case"UnknownErrorException":Y=new _util.UnknownErrorException(B.message,B.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(Y)}),C.on("PasswordRequest",B=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),l.onPassword){const Y=a=>{a instanceof Error?this._passwordCapability.reject(a):this._passwordCapability.resolve({password:a})};try{l.onPassword(Y,B.code)}catch(a){this._passwordCapability.reject(a)}}else this._passwordCapability.reject(new _util.PasswordException(B.message,B.code));return this._passwordCapability.promise}),C.on("DataLoaded",B=>{var Y;(Y=l.onProgress)==null||Y.call(l,{loaded:B.length,total:B.length}),this.downloadInfoCapability.resolve(B)}),C.on("StartRenderPage",B=>{if(this.destroyed)return;VI(this,_).get(B.pageIndex)._startRenderPage(B.transparency,B.cacheKey)}),C.on("commonobj",([B,Y,a])=>{var i;if(!this.destroyed&&!this.commonObjs.has(B))switch(Y){case"Font":const I=this._params;if("error"in a){const X=a.error;(0,_util.warn)(`Error during font loading: ${X}`),this.commonObjs.resolve(B,X);break}let g=null;I.pdfBug&&((i=globalThis.FontInspector)!=null&&i.enabled)&&(g={registerFont(X,b){globalThis.FontInspector.fontAdded(X,b)}});const o=new _font_loader.FontFaceObject(a,{isEvalSupported:I.isEvalSupported,disableFontFace:I.disableFontFace,ignoreErrors:I.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:g});this.fontLoader.bind(o).catch(X=>C.sendWithPromise("FontFallback",{id:B})).finally(()=>{!I.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(B,o)});break;case"FontPath":case"Image":this.commonObjs.resolve(B,a);break;default:throw new Error(`Got unknown common object type ${Y}`)}}),C.on("obj",([B,Y,a,i])=>{var g;if(this.destroyed)return;const I=VI(this,_).get(Y);if(!I.objs.has(B))switch(a){case"Image":I.objs.resolve(B,i);const o=8e6;if(i){let X;if(i.bitmap){const{bitmap:b,width:N,height:F}=i;X=N*F*4,I._bitmaps.add(b)}else X=((g=i.data)==null?void 0:g.length)||0;X>o&&(I.cleanupAfterRender=!0)}break;case"Pattern":I.objs.resolve(B,i);break;default:throw new Error(`Got unknown object type ${a}`)}}),C.on("DocProgress",B=>{var Y;this.destroyed||(Y=l.onProgress)==null||Y.call(l,{loaded:B.loaded,total:B.total})}),C.on("DocStats",B=>{this.destroyed||UI(this,M,Object.freeze({streamTypes:Object.freeze(B.streamTypes),fontTypes:Object.freeze(B.fontTypes)}))}),C.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),C.on("FetchBuiltInCMap",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(B):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),C.on("FetchStandardFontData",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(B):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:C}){var l,B;this.destroyed||(B=(l=this.loadingTask).onUnsupportedFeature)==null||B.call(l,C)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(C){if(!Number.isInteger(C)||C<=0||C>this._numPages)return Promise.reject(new Error("Invalid page request."));const l=C-1,B=VI(this,z).get(l);if(B)return B;const Y=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");const i=new PDFPageProxy(l,a,this,this._params.ownerDocument,this._params.pdfBug);return VI(this,_).set(l,i),i});return VI(this,z).set(l,Y),Y}getPageIndex(C){return typeof C!="object"||C===null||!Number.isInteger(C.num)||C.num<0||!Number.isInteger(C.gen)||C.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:C.num,gen:C.gen})}getAnnotations(C,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:C,intent:l})}saveDocument(){var C;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((C=this._fullReader)==null?void 0:C.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(C){return typeof C!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:C})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(C){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:C})}getStructTree(C){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:C})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(C=>new _optional_content_config.OptionalContentConfig(C))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return VI(this,T)||UI(this,T,this.messageHandler.sendWithPromise("GetMetadata",null).then(C=>{var l,B;return{info:C[0],metadata:C[1]?new _metadata.Metadata(C[1]):null,contentDispositionFilename:((l=this._fullReader)==null?void 0:l.filename)??null,contentLength:((B=this._fullReader)==null?void 0:B.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(C=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const l of VI(this,_).values())if(!l.cleanup())throw new Error(`startCleanup: Page ${l.pageNumber} is currently rendering.`);this.commonObjs.clear(),C||this.fontLoader.clear(),UI(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const C=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:C.disableAutoFetch,enableXfa:C.enableXfa})}}M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap;class PDFObjects{constructor(){zI(this,Z);zI(this,r,Object.create(null))}get(C,l=null){if(l){const Y=jI(this,Z,Rg).call(this,C);return Y.capability.promise.then(()=>l(Y.data)),null}const B=VI(this,r)[C];if(!(B!=null&&B.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${C}.`);return B.data}has(C){const l=VI(this,r)[C];return(l==null?void 0:l.capability.settled)||!1}resolve(C,l=null){const B=jI(this,Z,Rg).call(this,C);B.data=l,B.capability.resolve()}clear(){UI(this,r,Object.create(null))}}r=new WeakMap,Z=new WeakSet,Rg=function(C){const l=VI(this,r)[C];return l||(VI(this,r)[C]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(C){zI(this,j,null);UI(this,j,C),this.onContinue=null}get promise(){return VI(this,j).capability.promise}cancel(){VI(this,j).cancel()}get separateAnnots(){const{separateAnnots:C}=VI(this,j).operatorList;if(!C)return!1;const{annotationCanvasMap:l}=VI(this,j);return C.form||C.canvas&&(l==null?void 0:l.size)>0}}j=new WeakMap,exports.RenderTask=RenderTask;const m=class{constructor({callback:C,params:l,objs:B,commonObjs:Y,annotationCanvasMap:a,operatorList:i,pageIndex:I,canvasFactory:g,useRequestAnimationFrame:o=!1,pdfBug:X=!1,pageColors:b=null}){this.callback=C,this.params=l,this.objs=B,this.commonObjs=Y,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=i,this._pageIndex=I,this.canvasFactory=g,this._pdfBug=X,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=o===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=l.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:C=!1,optionalContentConfig:l}){var g;if(this.cancelled)return;if(this._canvas){if(VI(m,D).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");VI(m,D).add(this._canvas)}this._pdfBug&&((g=globalThis.StepperManager)!=null&&g.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:B,viewport:Y,transform:a,imageLayer:i,background:I}=this.params;this.gfx=new _canvas.CanvasGraphics(B,this.commonObjs,this.objs,this.canvasFactory,i,l,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:Y,transparency:C,background:I}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(C=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&VI(m,D).delete(this._canvas),this.callback(C||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&VI(m,D).delete(this._canvas),this.callback())))}};let InternalRenderTask=m;D=new WeakMap,zI(InternalRenderTask,D,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(wI,c,$)=>{var r,vg,p;Object.defineProperty(c,"__esModule",{value:!0}),c.PrintAnnotationStorage=c.AnnotationStorage=void 0;var h=$(1),M=$(6),_=$(10);class z{constructor(){zI(this,r);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(D,m){const d=this._storage.get(D);return d===void 0?m:Object.assign(m,d)}getRawValue(D){return this._storage.get(D)}remove(D){if(this._storage.delete(D),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const m of this._storage.values())if(m instanceof M.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(D,m){const d=this._storage.get(D);let C=!1;if(d!==void 0)for(const[l,B]of Object.entries(m))d[l]!==B&&(C=!0,d[l]=B);else C=!0,this._storage.set(D,m);C&&jI(this,r,vg).call(this),m instanceof M.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(m.constructor._type)}has(D){return this._storage.has(D)}getAll(){return this._storage.size>0?(0,h.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new T(this)}get serializable(){if(this._storage.size===0)return null;const D=new Map;for(const[m,d]of this._storage){const C=d instanceof M.AnnotationEditor?d.serialize():d;C&&D.set(m,C)}return D}static getHash(D){if(!D)return"";const m=new _.MurmurHash3_64;for(const[d,C]of D)m.update(`${d}:${JSON.stringify(C)}`);return m.hexdigest()}}r=new WeakSet,vg=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},c.AnnotationStorage=z;class T extends z{constructor(m){super();zI(this,p,null);UI(this,p,structuredClone(m.serializable))}get print(){(0,h.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return VI(this,p)}}p=new WeakMap,c.PrintAnnotationStorage=T},(wI,c,$)=>{var z,T,r,Z,p,j;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditor=void 0;var h=$(7),M=$(1);const D=class{constructor(d){zI(this,z,this.focusin.bind(this));zI(this,T,this.focusout.bind(this));zI(this,r,!1);zI(this,Z,!1);zI(this,p,!1);zI(this,j,D._zIndex++);this.constructor===D&&(0,M.unreachable)("Cannot initialize AnnotationEditor."),this.parent=d.parent,this.id=d.id,this.width=this.height=null,this.pageIndex=d.parent.pageIndex,this.name=d.name,this.div=null;const[C,l]=this.parent.viewportBaseDimensions;this.x=d.x/C,this.y=d.y/l,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,M.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=VI(this,j)}focusin(d){VI(this,r)?UI(this,r,!1):this.parent.setSelected(this)}focusout(d){if(!this.isAttachedToDOM)return;const C=d.relatedTarget;C!=null&&C.closest(`#${this.id}`)||(d.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(d){const C=this.parent.div.getBoundingClientRect();this.startX=d.clientX-C.x,this.startY=d.clientY-C.y,d.dataTransfer.setData("text/plain",this.id),d.dataTransfer.effectAllowed="move"}setAt(d,C,l,B){const[Y,a]=this.parent.viewportBaseDimensions;[l,B]=this.screenToPageTranslation(l,B),this.x=(d+l)/Y,this.y=(C+B)/a,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(d,C){const[l,B]=this.parent.viewportBaseDimensions;[d,C]=this.screenToPageTranslation(d,C),this.x+=d/l,this.y+=C/B,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(d,C){const{rotation:l}=this.parent.viewport;switch(l){case 90:return[C,-d];case 180:return[-d,-C];case 270:return[-C,d];default:return[d,C]}}setDims(d,C){const[l,B]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*d/l}%`,this.div.style.height=`${100*C/B}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",VI(this,z)),this.div.addEventListener("focusout",VI(this,T));const[d,C]=this.getInitialTranslation();return this.translate(d,C),(0,h.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(d){const C=h.KeyboardManager.platform.isMac;if(d.button!==0||d.ctrlKey&&C){d.preventDefault();return}d.ctrlKey&&!C||d.shiftKey||d.metaKey&&C?this.parent.toggleSelected(this):this.parent.setSelected(this),UI(this,r,!0)}getRect(d,C){const[l,B]=this.parent.viewportBaseDimensions,[Y,a]=this.parent.pageDimensions,i=Y*d/l,I=a*C/B,g=this.x*Y,o=this.y*a,X=this.width*Y,b=this.height*a;switch(this.rotation){case 0:return[g+i,a-o-I-b,g+i+X,a-o-I];case 90:return[g+I,a-o+i,g+I+b,a-o+i+X];case 180:return[g-i-X,a-o+I,g-i,a-o+I+b];case 270:return[g-I-b,a-o-i-X,g-I,a-o-i];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(d,C){const[l,B,Y,a]=d,i=Y-l,I=a-B;switch(this.rotation){case 0:return[l,C-a,i,I];case 90:return[l,C-B,I,i];case 180:return[Y,C-B,i,I];case 270:return[Y,C-a,I,i];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){UI(this,p,!0)}disableEditMode(){UI(this,p,!1)}isInEditMode(){return VI(this,p)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var d;(d=this.div)==null||d.addEventListener("focusin",VI(this,z))}serialize(){(0,M.unreachable)("An editor must be serializable")}static deserialize(d,C){const l=new this.prototype.constructor({parent:C,id:C.getNextId()});l.rotation=d.rotation;const[B,Y]=C.pageDimensions,[a,i,I,g]=l.getRectInCurrentCoords(d.rect,Y);return l.x=a/B,l.y=i/Y,l.width=I/B,l.height=g/Y,l}remove(){this.div.removeEventListener("focusin",VI(this,z)),this.div.removeEventListener("focusout",VI(this,T)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var d;(d=this.div)==null||d.classList.add("selectedEditor")}unselect(){var d;(d=this.div)==null||d.classList.remove("selectedEditor")}updateParams(d,C){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return VI(this,Z)}set isEditing(d){UI(this,Z,d),d?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let _=D;z=new WeakMap,T=new WeakMap,r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakMap,cg(_,"_colorManager",new h.ColorManager),cg(_,"_zIndex",1),c.AnnotationEditor=_},(wI,c,$)=>{var m,d,C,l,B,Y,Ug,I,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI,NI,BI,J,e,w,Og,E,Mg,iI,eg,eI,ng,W,Eg,S,fg,lI,Kg,MI,hg,WI,Bg;Object.defineProperty(c,"__esModule",{value:!0}),c.KeyboardManager=c.CommandManager=c.ColorManager=c.AnnotationEditorUIManager=void 0,c.bindEvents=_,c.opacityToHex=z;var h=$(1),M=$(8);function _(f,v,RI){for(const pI of RI)v.addEventListener(pI,f[pI].bind(f))}function z(f){return Math.round(Math.min(255,Math.max(1,255*f))).toString(16).padStart(2,"0")}class T{constructor(){zI(this,m,0)}getId(){return`${h.AnnotationEditorPrefix}${yg(this,m)._++}`}}m=new WeakMap;class r{constructor(v=128){zI(this,d,[]);zI(this,C,!1);zI(this,l,void 0);zI(this,B,-1);UI(this,l,v)}add({cmd:v,undo:RI,mustExec:pI,type:DI=NaN,overwriteIfSameType:FI=!1,keepUndo:TI=!1}){if(pI&&v(),VI(this,C))return;const vI={cmd:v,undo:RI,type:DI};if(VI(this,B)===-1){VI(this,d).length>0&&(VI(this,d).length=0),UI(this,B,0),VI(this,d).push(vI);return}if(FI&&VI(this,d)[VI(this,B)].type===DI){TI&&(vI.undo=VI(this,d)[VI(this,B)].undo),VI(this,d)[VI(this,B)]=vI;return}const fI=VI(this,B)+1;fI===VI(this,l)?VI(this,d).splice(0,1):(UI(this,B,fI),fI<VI(this,d).length&&VI(this,d).splice(fI)),VI(this,d).push(vI)}undo(){VI(this,B)!==-1&&(UI(this,C,!0),VI(this,d)[VI(this,B)].undo(),UI(this,C,!1),UI(this,B,VI(this,B)-1))}redo(){VI(this,B)<VI(this,d).length-1&&(UI(this,B,VI(this,B)+1),UI(this,C,!0),VI(this,d)[VI(this,B)].cmd(),UI(this,C,!1))}hasSomethingToUndo(){return VI(this,B)!==-1}hasSomethingToRedo(){return VI(this,B)<VI(this,d).length-1}destroy(){UI(this,d,null)}}d=new WeakMap,C=new WeakMap,l=new WeakMap,B=new WeakMap,c.CommandManager=r;const i=class{constructor(v){zI(this,Y);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const RI=i.platform.isMac;for(const[pI,DI]of v)for(const FI of pI){const TI=FI.startsWith("mac+");RI&&TI?(this.callbacks.set(FI.slice(4),DI),this.allKeys.add(FI.split("+").at(-1))):!RI&&!TI&&(this.callbacks.set(FI,DI),this.allKeys.add(FI.split("+").at(-1)))}}static get platform(){const v=typeof navigator<"u"?navigator.platform:"";return(0,h.shadow)(this,"platform",{isWin:v.includes("Win"),isMac:v.includes("Mac")})}exec(v,RI){if(!this.allKeys.has(RI.key))return;const pI=this.callbacks.get(jI(this,Y,Ug).call(this,RI));pI&&(pI.bind(v)(),RI.stopPropagation(),RI.preventDefault())}};let Z=i;Y=new WeakSet,Ug=function(v){v.altKey&&this.buffer.push("alt"),v.ctrlKey&&this.buffer.push("ctrl"),v.metaKey&&this.buffer.push("meta"),v.shiftKey&&this.buffer.push("shift"),this.buffer.push(v.key);const RI=this.buffer.join("+");return this.buffer.length=0,RI},c.KeyboardManager=Z;class p{constructor(){zI(this,I,null)}copy(v){v&&(Array.isArray(v)?UI(this,I,v.map(RI=>RI.serialize())):UI(this,I,[v.serialize()]),UI(this,I,VI(this,I).filter(RI=>!!RI)),VI(this,I).length===0&&UI(this,I,null))}paste(){return VI(this,I)}isEmpty(){return VI(this,I)===null}destroy(){UI(this,I,null)}}I=new WeakMap;const g=class{get _colors(){const v=new Map([["CanvasText",null],["Canvas",null]]);return(0,M.getColorValues)(v),(0,h.shadow)(this,"_colors",v)}convert(v){const RI=(0,M.getRGB)(v);if(!window.matchMedia("(forced-colors: active)").matches)return RI;for(const[pI,DI]of this._colors)if(DI.every((FI,TI)=>FI===RI[TI]))return g._colorsMapping.get(pI);return RI}getHexCode(v){const RI=this._colors.get(v);return RI?h.Util.makeHexColor(...RI):v}};let j=g;cg(j,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),c.ColorManager=j;const O=class{constructor(v,RI){zI(this,w);zI(this,E);zI(this,iI);zI(this,eI);zI(this,W);zI(this,S);zI(this,lI);zI(this,MI);zI(this,WI);zI(this,o,null);zI(this,X,new Map);zI(this,b,new Map);zI(this,N,new p);zI(this,F,new r);zI(this,hI,0);zI(this,YI,null);zI(this,nI,null);zI(this,gI,new T);zI(this,U,!1);zI(this,II,h.AnnotationEditorType.NONE);zI(this,q,new Set);zI(this,mI,this.keydown.bind(this));zI(this,NI,this.onEditingAction.bind(this));zI(this,BI,this.onPageChanging.bind(this));zI(this,J,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});zI(this,e,null);UI(this,e,v),UI(this,nI,RI),VI(this,nI)._on("editingaction",VI(this,NI)),VI(this,nI)._on("pagechanging",VI(this,BI))}destroy(){jI(this,E,Mg).call(this),VI(this,nI)._off("editingaction",VI(this,NI)),VI(this,nI)._off("pagechanging",VI(this,BI));for(const v of VI(this,b).values())v.destroy();VI(this,b).clear(),VI(this,X).clear(),UI(this,o,null),VI(this,q).clear(),VI(this,N).destroy(),VI(this,F).destroy()}onPageChanging({pageNumber:v}){UI(this,hI,v-1)}focusMainContainer(){VI(this,e).focus()}keydown(v){var RI;(RI=this.getActive())!=null&&RI.shouldGetKeyboardEvents()||O._keyboardManager.exec(this,v)}onEditingAction(v){["undo","redo","cut","copy","paste","delete","selectAll"].includes(v.name)&&this[v.name]()}setEditingState(v){v?(jI(this,w,Og).call(this),jI(this,iI,eg).call(this,{isEditing:VI(this,II)!==h.AnnotationEditorType.NONE,isEmpty:jI(this,MI,hg).call(this),hasSomethingToUndo:VI(this,F).hasSomethingToUndo(),hasSomethingToRedo:VI(this,F).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:VI(this,N).isEmpty()})):(jI(this,E,Mg).call(this),jI(this,iI,eg).call(this,{isEditing:!1}))}registerEditorTypes(v){UI(this,YI,v);for(const RI of VI(this,YI))jI(this,eI,ng).call(this,RI.defaultPropertiesToUpdate)}getId(){return VI(this,gI).getId()}addLayer(v){VI(this,b).set(v.pageIndex,v),VI(this,U)?v.enable():v.disable()}removeLayer(v){VI(this,b).delete(v.pageIndex)}updateMode(v){if(UI(this,II,v),v===h.AnnotationEditorType.NONE)this.setEditingState(!1),jI(this,S,fg).call(this);else{this.setEditingState(!0),jI(this,W,Eg).call(this);for(const RI of VI(this,b).values())RI.updateMode(v)}}updateToolbar(v){v!==VI(this,II)&&VI(this,nI).dispatch("switchannotationeditormode",{source:this,mode:v})}updateParams(v,RI){for(const pI of VI(this,q))pI.updateParams(v,RI);for(const pI of VI(this,YI))pI.updateDefaultParams(v,RI)}getEditors(v){const RI=[];for(const pI of VI(this,X).values())pI.pageIndex===v&&RI.push(pI);return RI}getEditor(v){return VI(this,X).get(v)}addEditor(v){VI(this,X).set(v.id,v)}removeEditor(v){VI(this,X).delete(v.id),this.unselect(v)}setActiveEditor(v){VI(this,o)!==v&&(UI(this,o,v),v&&jI(this,eI,ng).call(this,v.propertiesToUpdate))}toggleSelected(v){if(VI(this,q).has(v)){VI(this,q).delete(v),v.unselect(),jI(this,iI,eg).call(this,{hasSelectedEditor:this.hasSelection});return}VI(this,q).add(v),v.select(),jI(this,eI,ng).call(this,v.propertiesToUpdate),jI(this,iI,eg).call(this,{hasSelectedEditor:!0})}setSelected(v){for(const RI of VI(this,q))RI!==v&&RI.unselect();VI(this,q).clear(),VI(this,q).add(v),v.select(),jI(this,eI,ng).call(this,v.propertiesToUpdate),jI(this,iI,eg).call(this,{hasSelectedEditor:!0})}isSelected(v){return VI(this,q).has(v)}unselect(v){v.unselect(),VI(this,q).delete(v),jI(this,iI,eg).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return VI(this,q).size!==0}undo(){VI(this,F).undo(),jI(this,iI,eg).call(this,{hasSomethingToUndo:VI(this,F).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:jI(this,MI,hg).call(this)})}redo(){VI(this,F).redo(),jI(this,iI,eg).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:VI(this,F).hasSomethingToRedo(),isEmpty:jI(this,MI,hg).call(this)})}addCommands(v){VI(this,F).add(v),jI(this,iI,eg).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:jI(this,MI,hg).call(this)})}delete(){if(VI(this,o)&&VI(this,o).commitOrRemove(),!this.hasSelection)return;const v=[...VI(this,q)],RI=()=>{for(const DI of v)DI.remove()},pI=()=>{for(const DI of v)jI(this,lI,Kg).call(this,DI)};this.addCommands({cmd:RI,undo:pI,mustExec:!0})}copy(){if(VI(this,o)&&VI(this,o).commitOrRemove(),this.hasSelection){const v=[];for(const RI of VI(this,q))RI.isEmpty()||v.push(RI);if(v.length===0)return;VI(this,N).copy(v),jI(this,iI,eg).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(VI(this,N).isEmpty())return;this.unselectAll();const v=VI(this,b).get(VI(this,hI)),RI=VI(this,N).paste().map(FI=>v.deserialize(FI)),pI=()=>{for(const FI of RI)jI(this,lI,Kg).call(this,FI);jI(this,WI,Bg).call(this,RI)},DI=()=>{for(const FI of RI)FI.remove()};this.addCommands({cmd:pI,undo:DI,mustExec:!0})}selectAll(){for(const v of VI(this,q))v.commit();jI(this,WI,Bg).call(this,VI(this,X).values())}unselectAll(){if(VI(this,o)){VI(this,o).commitOrRemove();return}if(jI(this,WI,Bg).size!==0){for(const v of VI(this,q))v.unselect();VI(this,q).clear(),jI(this,iI,eg).call(this,{hasSelectedEditor:!1})}}isActive(v){return VI(this,o)===v}getActive(){return VI(this,o)}getMode(){return VI(this,II)}};let D=O;o=new WeakMap,X=new WeakMap,b=new WeakMap,N=new WeakMap,F=new WeakMap,hI=new WeakMap,YI=new WeakMap,nI=new WeakMap,gI=new WeakMap,U=new WeakMap,II=new WeakMap,q=new WeakMap,mI=new WeakMap,NI=new WeakMap,BI=new WeakMap,J=new WeakMap,e=new WeakMap,w=new WeakSet,Og=function(){VI(this,e).addEventListener("keydown",VI(this,mI))},E=new WeakSet,Mg=function(){VI(this,e).removeEventListener("keydown",VI(this,mI))},iI=new WeakSet,eg=function(v){Object.entries(v).some(([pI,DI])=>VI(this,J)[pI]!==DI)&&VI(this,nI).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(VI(this,J),v)})},eI=new WeakSet,ng=function(v){VI(this,nI).dispatch("annotationeditorparamschanged",{source:this,details:v})},W=new WeakSet,Eg=function(){if(!VI(this,U)){UI(this,U,!0);for(const v of VI(this,b).values())v.enable()}},S=new WeakSet,fg=function(){if(this.unselectAll(),VI(this,U)){UI(this,U,!1);for(const v of VI(this,b).values())v.disable()}},lI=new WeakSet,Kg=function(v){const RI=VI(this,b).get(v.pageIndex);RI?RI.addOrRebuild(v):this.addEditor(v)},MI=new WeakSet,hg=function(){if(VI(this,X).size===0)return!0;if(VI(this,X).size===1)for(const v of VI(this,X).values())return v.isEmpty();return!1},WI=new WeakSet,Bg=function(v){VI(this,q).clear();for(const RI of v)RI.isEmpty()||(VI(this,q).add(RI),RI.select());jI(this,iI,eg).call(this,{hasSelectedEditor:!0})},cg(D,"_keyboardManager",new Z([[["ctrl+a","mac+meta+a"],O.prototype.selectAll],[["ctrl+c","mac+meta+c"],O.prototype.copy],[["ctrl+v","mac+meta+v"],O.prototype.paste],[["ctrl+x","mac+meta+x"],O.prototype.cut],[["ctrl+z","mac+meta+z"],O.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],O.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],O.prototype.delete],[["Escape","mac+Escape"],O.prototype.unselectAll]])),c.AnnotationEditorUIManager=D},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.StatTimer=c.RenderingCancelledException=c.PixelsPerInch=c.PageViewport=c.PDFDateString=c.DOMStandardFontDataFactory=c.DOMSVGFactory=c.DOMCanvasFactory=c.DOMCMapReaderFactory=c.AnnotationPrefix=void 0,c.deprecated=g,c.getColorValues=F,c.getCurrentTransform=hI,c.getCurrentTransformInverse=YI,c.getFilenameFromUrl=B,c.getPdfFilenameFromUrl=Y,c.getRGB=N,c.getXfaPageViewport=b,c.isDataScheme=C,c.isPdfFile=l,c.isValidFetchUrl=i,c.loadScript=I;var h=$(9),M=$(1);const _="http://www.w3.org/2000/svg",z="pdfjs_internal_id_";c.AnnotationPrefix=z;const nI=class{};let T=nI;cg(T,"CSS",96),cg(T,"PDF",72),cg(T,"PDF_TO_CSS_UNITS",nI.CSS/nI.PDF),c.PixelsPerInch=T;class r extends h.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,II){const q=this._document.createElement("canvas");return q.width=U,q.height=II,q}}c.DOMCanvasFactory=r;async function Z(gI,U=!1){if(i(gI,document.baseURI)){const II=await fetch(gI);if(!II.ok)throw new Error(II.statusText);return U?new Uint8Array(await II.arrayBuffer()):(0,M.stringToBytes)(await II.text())}return new Promise((II,q)=>{const mI=new XMLHttpRequest;mI.open("GET",gI,!0),U&&(mI.responseType="arraybuffer"),mI.onreadystatechange=()=>{if(mI.readyState===XMLHttpRequest.DONE){if(mI.status===200||mI.status===0){let NI;if(U&&mI.response?NI=new Uint8Array(mI.response):!U&&mI.responseText&&(NI=(0,M.stringToBytes)(mI.responseText)),NI){II(NI);return}}q(new Error(mI.statusText))}},mI.send(null)})}class p extends h.BaseCMapReaderFactory{_fetchData(U,II){return Z(U,this.isCompressed).then(q=>({cMapData:q,compressionType:II}))}}c.DOMCMapReaderFactory=p;class j extends h.BaseStandardFontDataFactory{_fetchData(U){return Z(U,!0)}}c.DOMStandardFontDataFactory=j;class D extends h.BaseSVGFactory{_createSVG(U){return document.createElementNS(_,U)}}c.DOMSVGFactory=D;class m{constructor({viewBox:U,scale:II,rotation:q,offsetX:mI=0,offsetY:NI=0,dontFlip:BI=!1}){this.viewBox=U,this.scale=II,this.rotation=q,this.offsetX=mI,this.offsetY=NI;const J=(U[2]+U[0])/2,e=(U[3]+U[1])/2;let w,x,E,P;switch(q%=360,q<0&&(q+=360),q){case 180:w=-1,x=0,E=0,P=1;break;case 90:w=0,x=1,E=1,P=0;break;case 270:w=0,x=-1,E=-1,P=0;break;case 0:w=1,x=0,E=0,P=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}BI&&(E=-E,P=-P);let iI,aI,eI,A;w===0?(iI=Math.abs(e-U[1])*II+mI,aI=Math.abs(J-U[0])*II+NI,eI=Math.abs(U[3]-U[1])*II,A=Math.abs(U[2]-U[0])*II):(iI=Math.abs(J-U[0])*II+mI,aI=Math.abs(e-U[1])*II+NI,eI=Math.abs(U[2]-U[0])*II,A=Math.abs(U[3]-U[1])*II),this.transform=[w*II,x*II,E*II,P*II,iI-w*II*J-E*II*e,aI-x*II*J-P*II*e],this.width=eI,this.height=A}clone({scale:U=this.scale,rotation:II=this.rotation,offsetX:q=this.offsetX,offsetY:mI=this.offsetY,dontFlip:NI=!1}={}){return new m({viewBox:this.viewBox.slice(),scale:U,rotation:II,offsetX:q,offsetY:mI,dontFlip:NI})}convertToViewportPoint(U,II){return M.Util.applyTransform([U,II],this.transform)}convertToViewportRectangle(U){const II=M.Util.applyTransform([U[0],U[1]],this.transform),q=M.Util.applyTransform([U[2],U[3]],this.transform);return[II[0],II[1],q[0],q[1]]}convertToPdfPoint(U,II){return M.Util.applyInverseTransform([U,II],this.transform)}}c.PageViewport=m;class d extends M.BaseException{constructor(U,II){super(U,"RenderingCancelledException"),this.type=II}}c.RenderingCancelledException=d;function C(gI){const U=gI.length;let II=0;for(;II<U&&gI[II].trim()==="";)II++;return gI.substring(II,II+5).toLowerCase()==="data:"}function l(gI){return typeof gI=="string"&&/\.pdf$/i.test(gI)}function B(gI){const U=gI.indexOf("#"),II=gI.indexOf("?"),q=Math.min(U>0?U:gI.length,II>0?II:gI.length);return gI.substring(gI.lastIndexOf("/",q)+1,q)}function Y(gI,U="document.pdf"){if(typeof gI!="string")return U;if(C(gI))return(0,M.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const II=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,mI=II.exec(gI);let NI=q.exec(mI[1])||q.exec(mI[2])||q.exec(mI[3]);if(NI&&(NI=NI[0],NI.includes("%")))try{NI=q.exec(decodeURIComponent(NI))[0]}catch{}return NI||U}class a{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,M.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,M.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let II=0;for(const q of this.times){const mI=q.name;mI.length>II&&(II=mI.length)}for(const q of this.times){const mI=q.end-q.start;U.push(`${q.name.padEnd(II)} ${mI}ms
`)}return U.join("")}}c.StatTimer=a;function i(gI,U){try{const{protocol:II}=U?new URL(gI,U):new URL(gI);return II==="http:"||II==="https:"}catch{return!1}}function I(gI,U=!1){return new Promise((II,q)=>{const mI=document.createElement("script");mI.src=gI,mI.onload=function(NI){U&&mI.remove(),II(NI)},mI.onerror=function(){q(new Error(`Cannot load script at: ${mI.src}`))},(document.head||document.documentElement).append(mI)})}function g(gI){console.log("Deprecated API usage: "+gI)}let o;class X{static toDateObject(U){if(!U||typeof U!="string")return null;o||(o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const II=o.exec(U);if(!II)return null;const q=parseInt(II[1],10);let mI=parseInt(II[2],10);mI=mI>=1&&mI<=12?mI-1:0;let NI=parseInt(II[3],10);NI=NI>=1&&NI<=31?NI:1;let BI=parseInt(II[4],10);BI=BI>=0&&BI<=23?BI:0;let J=parseInt(II[5],10);J=J>=0&&J<=59?J:0;let e=parseInt(II[6],10);e=e>=0&&e<=59?e:0;const w=II[7]||"Z";let x=parseInt(II[8],10);x=x>=0&&x<=23?x:0;let E=parseInt(II[9],10)||0;return E=E>=0&&E<=59?E:0,w==="-"?(BI+=x,J+=E):w==="+"&&(BI-=x,J-=E),new Date(Date.UTC(q,mI,NI,BI,J,e))}}c.PDFDateString=X;function b(gI,{scale:U=1,rotation:II=0}){const{width:q,height:mI}=gI.attributes.style,NI=[0,0,parseInt(q),parseInt(mI)];return new m({viewBox:NI,scale:U,rotation:II})}function N(gI){if(gI.startsWith("#")){const U=parseInt(gI.slice(1),16);return[(U&16711680)>>16,(U&65280)>>8,U&255]}return gI.startsWith("rgb(")?gI.slice(4,-1).split(",").map(U=>parseInt(U)):gI.startsWith("rgba(")?gI.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,M.warn)(`Not a valid color format: "${gI}"`),[0,0,0])}function F(gI){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const II of gI.keys()){U.style.color=II;const q=window.getComputedStyle(U).color;gI.set(II,N(q))}U.remove()}function hI(gI){const{a:U,b:II,c:q,d:mI,e:NI,f:BI}=gI.getTransform();return[U,II,q,mI,NI,BI]}function YI(gI){const{a:U,b:II,c:q,d:mI,e:NI,f:BI}=gI.getTransform().invertSelf();return[U,II,q,mI,NI,BI]}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseStandardFontDataFactory=c.BaseSVGFactory=c.BaseCanvasFactory=c.BaseCMapReaderFactory=void 0;var h=$(1);class M{constructor(){this.constructor===M&&(0,h.unreachable)("Cannot initialize BaseCanvasFactory.")}create(Z,p){if(Z<=0||p<=0)throw new Error("Invalid canvas size");const j=this._createCanvas(Z,p);return{canvas:j,context:j.getContext("2d")}}reset(Z,p,j){if(!Z.canvas)throw new Error("Canvas is not specified");if(p<=0||j<=0)throw new Error("Invalid canvas size");Z.canvas.width=p,Z.canvas.height=j}destroy(Z){if(!Z.canvas)throw new Error("Canvas is not specified");Z.canvas.width=0,Z.canvas.height=0,Z.canvas=null,Z.context=null}_createCanvas(Z,p){(0,h.unreachable)("Abstract method `_createCanvas` called.")}}c.BaseCanvasFactory=M;class _{constructor({baseUrl:Z=null,isCompressed:p=!1}){this.constructor===_&&(0,h.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=Z,this.isCompressed=p}async fetch({name:Z}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!Z)throw new Error("CMap name must be specified.");const p=this.baseUrl+Z+(this.isCompressed?".bcmap":""),j=this.isCompressed?h.CMapCompressionType.BINARY:h.CMapCompressionType.NONE;return this._fetchData(p,j).catch(D=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(Z,p){(0,h.unreachable)("Abstract method `_fetchData` called.")}}c.BaseCMapReaderFactory=_;class z{constructor({baseUrl:Z=null}){this.constructor===z&&(0,h.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=Z}async fetch({filename:Z}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!Z)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${Z}`;return this._fetchData(p).catch(j=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(Z){(0,h.unreachable)("Abstract method `_fetchData` called.")}}c.BaseStandardFontDataFactory=z;class T{constructor(){this.constructor===T&&(0,h.unreachable)("Cannot initialize BaseSVGFactory.")}create(Z,p,j=!1){if(Z<=0||p<=0)throw new Error("Invalid SVG dimensions");const D=this._createSVG("svg:svg");return D.setAttribute("version","1.1"),j||(D.setAttribute("width",`${Z}px`),D.setAttribute("height",`${p}px`)),D.setAttribute("preserveAspectRatio","none"),D.setAttribute("viewBox",`0 0 ${Z} ${p}`),D}createElement(Z){if(typeof Z!="string")throw new Error("Invalid SVG element type");return this._createSVG(Z)}_createSVG(Z){(0,h.unreachable)("Abstract method `_createSVG` called.")}}c.BaseSVGFactory=T},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MurmurHash3_64=void 0;var h=$(1);const M=3285377520,_=4294901760,z=65535;class T{constructor(Z){this.h1=Z?Z&4294967295:M,this.h2=Z?Z&4294967295:M}update(Z){let p,j;if(typeof Z=="string"){p=new Uint8Array(Z.length*2),j=0;for(let o=0,X=Z.length;o<X;o++){const b=Z.charCodeAt(o);b<=255?p[j++]=b:(p[j++]=b>>>8,p[j++]=b&255)}}else if((0,h.isArrayBuffer)(Z))p=Z.slice(),j=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const D=j>>2,m=j-D*4,d=new Uint32Array(p.buffer,0,D);let C=0,l=0,B=this.h1,Y=this.h2;const a=3432918353,i=461845907,I=a&z,g=i&z;for(let o=0;o<D;o++)o&1?(C=d[o],C=C*a&_|C*I&z,C=C<<15|C>>>17,C=C*i&_|C*g&z,B^=C,B=B<<13|B>>>19,B=B*5+3864292196):(l=d[o],l=l*a&_|l*I&z,l=l<<15|l>>>17,l=l*i&_|l*g&z,Y^=l,Y=Y<<13|Y>>>19,Y=Y*5+3864292196);switch(C=0,m){case 3:C^=p[D*4+2]<<16;case 2:C^=p[D*4+1]<<8;case 1:C^=p[D*4],C=C*a&_|C*I&z,C=C<<15|C>>>17,C=C*i&_|C*g&z,D&1?B^=C:Y^=C}this.h1=B,this.h2=Y}hexdigest(){let Z=this.h1,p=this.h2;Z^=p>>>1,Z=Z*3981806797&_|Z*36045&z,p=p*4283543511&_|((p<<16|Z>>>16)*2950163797&_)>>>16,Z^=p>>>1,Z=Z*444984403&_|Z*60499&z,p=p*3301882366&_|((p<<16|Z>>>16)*3120437893&_)>>>16,Z^=p>>>1;const j=(Z>>>0).toString(16),D=(p>>>0).toString(16);return j.padStart(8,"0")+D.padStart(8,"0")}}c.MurmurHash3_64=T},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FontLoader=c.FontFaceObject=void 0;var h=$(1);class M{constructor({docId:r,onUnsupportedFeature:Z,ownerDocument:p=globalThis.document,styleElement:j=null}){this.constructor===M&&(0,h.unreachable)("Cannot initialize BaseFontLoader."),this.docId=r,this._onUnsupportedFeature=Z,this._document=p,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(r){this.nativeFontFaces.push(r),this._document.fonts.add(r)}insertRule(r){let Z=this.styleElement;Z||(Z=this.styleElement=this._document.createElement("style"),Z.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(Z));const p=Z.sheet;p.insertRule(r,p.cssRules.length)}clear(){for(const r of this.nativeFontFaces)this._document.fonts.delete(r);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(r){if(r.attached||r.missingFile)return;if(r.attached=!0,this.isFontLoadingAPISupported){const p=r.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(j){throw this._onUnsupportedFeature({featureId:h.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,h.warn)(`Failed to load font '${p.family}': '${j}'.`),r.disableFontFace=!0,j}}return}const Z=r.createFontFaceRule();if(Z){if(this.insertRule(Z),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const j=this._queueLoadingCallback(p);this._prepareFontLoadEvent([Z],[r],j)})}}_queueLoadingCallback(r){(0,h.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var Z;const r=!!((Z=this._document)!=null&&Z.fonts);return(0,h.shadow)(this,"isFontLoadingAPISupported",r)}get isSyncFontLoadingSupported(){(0,h.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,h.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(r,Z,p){(0,h.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let _;c.FontLoader=_,c.FontLoader=_=class extends M{constructor(r){super(r),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let r=!1;if(typeof navigator>"u")r=!0;else{const Z=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(Z==null?void 0:Z[1])>=14&&(r=!0)}return(0,h.shadow)(this,"isSyncFontLoadingSupported",r)}_queueLoadingCallback(r){function Z(){for((0,h.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;p.requests.length>0&&p.requests[0].done;){const D=p.requests.shift();setTimeout(D.callback,0)}}const p=this.loadingContext,j={id:`pdfjs-font-loading-${p.nextRequestId++}`,done:!1,complete:Z,callback:r};return p.requests.push(j),j}get _loadTestFont(){const r=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,h.shadow)(this,"_loadTestFont",r())}_prepareFontLoadEvent(r,Z,p){function j(YI,nI){return YI.charCodeAt(nI)<<24|YI.charCodeAt(nI+1)<<16|YI.charCodeAt(nI+2)<<8|YI.charCodeAt(nI+3)&255}function D(YI,nI,gI,U){const II=YI.substring(0,nI),q=YI.substring(nI+gI);return II+U+q}let m,d;const C=this._document.createElement("canvas");C.width=1,C.height=1;const l=C.getContext("2d");let B=0;function Y(YI,nI){if(B++,B>30){(0,h.warn)("Load test font never loaded."),nI();return}if(l.font="30px "+YI,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){nI();return}setTimeout(Y.bind(null,YI,nI))}const a=`lt${Date.now()}${this.loadTestFontId++}`;let i=this._loadTestFont;i=D(i,976,a.length,a);const g=16,o=1482184792;let X=j(i,g);for(m=0,d=a.length-3;m<d;m+=4)X=X-o+j(a,m)|0;m<a.length&&(X=X-o+j(a+"XXX",m)|0),i=D(i,g,4,(0,h.string32)(X));const b=`url(data:font/opentype;base64,${btoa(i)});`,N=`@font-face {font-family:"${a}";src:${b}}`;this.insertRule(N);const F=[];for(const YI of Z)F.push(YI.loadedName);F.push(a);const hI=this._document.createElement("div");hI.style.visibility="hidden",hI.style.width=hI.style.height="10px",hI.style.position="absolute",hI.style.top=hI.style.left="0px";for(const YI of F){const nI=this._document.createElement("span");nI.textContent="Hi",nI.style.fontFamily=YI,hI.append(nI)}this._document.body.append(hI),Y(a,()=>{hI.remove(),p.complete()})}};class z{constructor(r,{isEvalSupported:Z=!0,disableFontFace:p=!1,ignoreErrors:j=!1,onUnsupportedFeature:D,fontRegistry:m=null}){this.compiledGlyphs=Object.create(null);for(const d in r)this[d]=r[d];this.isEvalSupported=Z!==!1,this.disableFontFace=p===!0,this.ignoreErrors=j===!0,this._onUnsupportedFeature=D,this.fontRegistry=m}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let r;if(!this.cssFontInfo)r=new FontFace(this.loadedName,this.data,{});else{const Z={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(Z.style=`oblique ${this.cssFontInfo.italicAngle}deg`),r=new FontFace(this.cssFontInfo.fontFamily,this.data,Z)}return this.fontRegistry&&this.fontRegistry.registerFont(this),r}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const r=(0,h.bytesToString)(this.data),Z=`url(data:${this.mimetype};base64,${btoa(r)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${Z}}`;else{let j=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(j+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${j}src:${Z}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,Z),p}getPathGenerator(r,Z){if(this.compiledGlyphs[Z]!==void 0)return this.compiledGlyphs[Z];let p;try{p=r.get(this.loadedName+"_path_"+Z)}catch(j){if(!this.ignoreErrors)throw j;return this._onUnsupportedFeature({featureId:h.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,h.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[Z]=function(D,m){}}if(this.isEvalSupported&&h.FeatureTest.isEvalSupported){const j=[];for(const D of p){const m=D.args!==void 0?D.args.join(","):"";j.push("c.",D.cmd,"(",m,`);
`)}return this.compiledGlyphs[Z]=new Function("c","size",j.join(""))}return this.compiledGlyphs[Z]=function(j,D){for(const m of p)m.cmd==="scale"&&(m.args=[D,-D]),j[m.cmd].apply(j,m.args)}}}c.FontFaceObject=z},(wI,c,$)=>{var mI,pg;Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasGraphics=void 0;var h=$(8),M=$(1),_=$(13),z=$(14),T=$(3);const r=16,Z=100,p=4096,j=15,D=10,m=T.isNodeJS&&typeof Path2D>"u"?-1:1e3,d=16;function C(J,e){if(J._removeMirroring)throw new Error("Context is already forwarding operations.");J.__originalSave=J.save,J.__originalRestore=J.restore,J.__originalRotate=J.rotate,J.__originalScale=J.scale,J.__originalTranslate=J.translate,J.__originalTransform=J.transform,J.__originalSetTransform=J.setTransform,J.__originalResetTransform=J.resetTransform,J.__originalClip=J.clip,J.__originalMoveTo=J.moveTo,J.__originalLineTo=J.lineTo,J.__originalBezierCurveTo=J.bezierCurveTo,J.__originalRect=J.rect,J.__originalClosePath=J.closePath,J.__originalBeginPath=J.beginPath,J._removeMirroring=()=>{J.save=J.__originalSave,J.restore=J.__originalRestore,J.rotate=J.__originalRotate,J.scale=J.__originalScale,J.translate=J.__originalTranslate,J.transform=J.__originalTransform,J.setTransform=J.__originalSetTransform,J.resetTransform=J.__originalResetTransform,J.clip=J.__originalClip,J.moveTo=J.__originalMoveTo,J.lineTo=J.__originalLineTo,J.bezierCurveTo=J.__originalBezierCurveTo,J.rect=J.__originalRect,J.closePath=J.__originalClosePath,J.beginPath=J.__originalBeginPath,delete J._removeMirroring},J.save=function(){e.save(),this.__originalSave()},J.restore=function(){e.restore(),this.__originalRestore()},J.translate=function(x,E){e.translate(x,E),this.__originalTranslate(x,E)},J.scale=function(x,E){e.scale(x,E),this.__originalScale(x,E)},J.transform=function(x,E,P,iI,aI,eI){e.transform(x,E,P,iI,aI,eI),this.__originalTransform(x,E,P,iI,aI,eI)},J.setTransform=function(x,E,P,iI,aI,eI){e.setTransform(x,E,P,iI,aI,eI),this.__originalSetTransform(x,E,P,iI,aI,eI)},J.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},J.rotate=function(x){e.rotate(x),this.__originalRotate(x)},J.clip=function(x){e.clip(x),this.__originalClip(x)},J.moveTo=function(w,x){e.moveTo(w,x),this.__originalMoveTo(w,x)},J.lineTo=function(w,x){e.lineTo(w,x),this.__originalLineTo(w,x)},J.bezierCurveTo=function(w,x,E,P,iI,aI){e.bezierCurveTo(w,x,E,P,iI,aI),this.__originalBezierCurveTo(w,x,E,P,iI,aI)},J.rect=function(w,x,E,P){e.rect(w,x,E,P),this.__originalRect(w,x,E,P)},J.closePath=function(){e.closePath(),this.__originalClosePath()},J.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class l{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,w,x){let E;return this.cache[e]!==void 0?(E=this.cache[e],this.canvasFactory.reset(E,w,x)):(E=this.canvasFactory.create(w,x),this.cache[e]=E),E}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const w=this.cache[e];this.canvasFactory.destroy(w),delete this.cache[e]}}}function B(J,e,w,x,E,P,iI,aI,eI,A){const[W,L,S,Q,lI,uI]=(0,h.getCurrentTransform)(J);if(L===0&&S===0){const WI=iI*W+lI,tI=Math.round(WI),O=aI*Q+uI,f=Math.round(O),v=(iI+eI)*W+lI,RI=Math.abs(Math.round(v)-tI)||1,pI=(aI+A)*Q+uI,DI=Math.abs(Math.round(pI)-f)||1;return J.setTransform(Math.sign(W),0,0,Math.sign(Q),tI,f),J.drawImage(e,w,x,E,P,0,0,RI,DI),J.setTransform(W,L,S,Q,lI,uI),[RI,DI]}if(W===0&&Q===0){const WI=aI*S+lI,tI=Math.round(WI),O=iI*L+uI,f=Math.round(O),v=(aI+A)*S+lI,RI=Math.abs(Math.round(v)-tI)||1,pI=(iI+eI)*L+uI,DI=Math.abs(Math.round(pI)-f)||1;return J.setTransform(0,Math.sign(L),Math.sign(S),0,tI,f),J.drawImage(e,w,x,E,P,0,0,DI,RI),J.setTransform(W,L,S,Q,lI,uI),[DI,RI]}J.drawImage(e,w,x,E,P,iI,aI,eI,A);const MI=Math.hypot(W,L),ZI=Math.hypot(S,Q);return[MI*eI,ZI*A]}function Y(J){const{width:e,height:w}=J;if(e>m||w>m)return null;const x=1e3,E=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),P=e+1;let iI=new Uint8Array(P*(w+1)),aI,eI,A;const W=e+7&-8;let L=new Uint8Array(W*w),S=0;for(const ZI of J.data){let WI=128;for(;WI>0;)L[S++]=ZI&WI?0:255,WI>>=1}let Q=0;for(S=0,L[S]!==0&&(iI[0]=1,++Q),eI=1;eI<e;eI++)L[S]!==L[S+1]&&(iI[eI]=L[S]?2:1,++Q),S++;for(L[S]!==0&&(iI[eI]=2,++Q),aI=1;aI<w;aI++){S=aI*W,A=aI*P,L[S-W]!==L[S]&&(iI[A]=L[S]?1:8,++Q);let ZI=(L[S]?4:0)+(L[S-W]?8:0);for(eI=1;eI<e;eI++)ZI=(ZI>>2)+(L[S+1]?4:0)+(L[S-W+1]?8:0),E[ZI]&&(iI[A+eI]=E[ZI],++Q),S++;if(L[S-W]!==L[S]&&(iI[A+eI]=L[S]?2:4,++Q),Q>x)return null}for(S=W*(w-1),A=aI*P,L[S]!==0&&(iI[A]=8,++Q),eI=1;eI<e;eI++)L[S]!==L[S+1]&&(iI[A+eI]=L[S]?4:8,++Q),S++;if(L[S]!==0&&(iI[A+eI]=4,++Q),Q>x)return null;const lI=new Int32Array([0,P,-1,0,-P,0,0,0,1]),uI=new Path2D;for(aI=0;Q&&aI<=w;aI++){let ZI=aI*P;const WI=ZI+e;for(;ZI<WI&&!iI[ZI];)ZI++;if(ZI===WI)continue;uI.moveTo(ZI%P,aI);const tI=ZI;let O=iI[ZI];do{const f=lI[O];do ZI+=f;while(!iI[ZI]);const v=iI[ZI];v!==5&&v!==10?(O=v,iI[ZI]=0):(O=v&51*O>>4,iI[ZI]&=O>>2|O<<2),uI.lineTo(ZI%P,ZI/P|0),iI[ZI]||--Q}while(tI!==ZI);--aI}return L=null,iI=null,function(ZI){ZI.save(),ZI.scale(1/e,-1/w),ZI.translate(0,-w),ZI.fill(uI),ZI.beginPath(),ZI.restore()}}class a{constructor(e,w){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=M.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=M.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,e,w])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,w){this.x=e,this.y=w}updatePathMinMax(e,w,x){[w,x]=M.Util.applyTransform([w,x],e),this.minX=Math.min(this.minX,w),this.minY=Math.min(this.minY,x),this.maxX=Math.max(this.maxX,w),this.maxY=Math.max(this.maxY,x)}updateRectMinMax(e,w){const x=M.Util.applyTransform(w,e),E=M.Util.applyTransform(w.slice(2),e);this.minX=Math.min(this.minX,x[0],E[0]),this.minY=Math.min(this.minY,x[1],E[1]),this.maxX=Math.max(this.maxX,x[0],E[0]),this.maxY=Math.max(this.maxY,x[1],E[1])}updateScalingPathMinMax(e,w){M.Util.scaleMinMax(e,w),this.minX=Math.min(this.minX,w[0]),this.maxX=Math.max(this.maxX,w[1]),this.minY=Math.min(this.minY,w[2]),this.maxY=Math.max(this.maxY,w[3])}updateCurvePathMinMax(e,w,x,E,P,iI,aI,eI,A,W){const L=M.Util.bezierBoundingBox(w,x,E,P,iI,aI,eI,A);if(W){W[0]=Math.min(W[0],L[0],L[2]),W[1]=Math.max(W[1],L[0],L[2]),W[2]=Math.min(W[2],L[1],L[3]),W[3]=Math.max(W[3],L[1],L[3]);return}this.updateRectMinMax(e,L)}getPathBoundingBox(e=_.PathType.FILL,w=null){const x=[this.minX,this.minY,this.maxX,this.maxY];if(e===_.PathType.STROKE){w||(0,M.unreachable)("Stroke bounding box must include transform.");const E=M.Util.singularValueDecompose2dScale(w),P=E[0]*this.lineWidth/2,iI=E[1]*this.lineWidth/2;x[0]-=P,x[1]-=iI,x[2]+=P,x[3]+=iI}return x}updateClipFromPath(){const e=M.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=_.PathType.FILL,w=null){return M.Util.intersect(this.clipBox,this.getPathBoundingBox(e,w))}}function i(J,e,w=null){if(typeof ImageData<"u"&&e instanceof ImageData){J.putImageData(e,0,0);return}const x=e.height,E=e.width,P=x%d,iI=(x-P)/d,aI=P===0?iI:iI+1,eI=J.createImageData(E,d);let A=0,W;const L=e.data,S=eI.data;let Q,lI,uI,MI,ZI,WI,tI,O;if(w)switch(w.length){case 1:ZI=w[0],WI=w[0],tI=w[0],O=w[0];break;case 4:ZI=w[0],WI=w[1],tI=w[2],O=w[3];break}if(e.kind===M.ImageKind.GRAYSCALE_1BPP){const f=L.byteLength,v=new Uint32Array(S.buffer,0,S.byteLength>>2),RI=v.length,pI=E+7>>3;let DI=4294967295,FI=M.FeatureTest.isLittleEndian?4278190080:255;for(O&&O[0]===255&&O[255]===0&&([DI,FI]=[FI,DI]),Q=0;Q<aI;Q++){for(uI=Q<iI?d:P,W=0,lI=0;lI<uI;lI++){const TI=f-A;let vI=0;const fI=TI>pI?E:TI*8-7,PI=fI&-8;let EI=0,SI=0;for(;vI<PI;vI+=8)SI=L[A++],v[W++]=SI&128?DI:FI,v[W++]=SI&64?DI:FI,v[W++]=SI&32?DI:FI,v[W++]=SI&16?DI:FI,v[W++]=SI&8?DI:FI,v[W++]=SI&4?DI:FI,v[W++]=SI&2?DI:FI,v[W++]=SI&1?DI:FI;for(;vI<fI;vI++)EI===0&&(SI=L[A++],EI=128),v[W++]=SI&EI?DI:FI,EI>>=1}for(;W<RI;)v[W++]=0;J.putImageData(eI,0,Q*d)}}else if(e.kind===M.ImageKind.RGBA_32BPP){const f=!!(ZI||WI||tI);for(lI=0,MI=E*d*4,Q=0;Q<iI;Q++){if(S.set(L.subarray(A,A+MI)),A+=MI,f)for(let v=0;v<MI;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,lI),lI+=d}if(Q<aI){if(MI=E*P*4,S.set(L.subarray(A,A+MI)),f)for(let v=0;v<MI;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,lI)}}else if(e.kind===M.ImageKind.RGB_24BPP){const f=!!(ZI||WI||tI);for(uI=d,MI=E*uI,Q=0;Q<aI;Q++){for(Q>=iI&&(uI=P,MI=E*uI),W=0,lI=MI;lI--;)S[W++]=L[A++],S[W++]=L[A++],S[W++]=L[A++],S[W++]=255;if(f)for(let v=0;v<W;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,Q*d)}}else throw new Error(`bad image kind: ${e.kind}`)}function I(J,e){if(e.bitmap){J.drawImage(e.bitmap,0,0);return}const w=e.height,x=e.width,E=w%d,P=(w-E)/d,iI=E===0?P:P+1,aI=J.createImageData(x,d);let eI=0;const A=e.data,W=aI.data;for(let L=0;L<iI;L++){const S=L<P?d:E;({srcPos:eI}=(0,z.applyMaskImageData)({src:A,srcPos:eI,dest:W,width:x,height:S})),J.putImageData(aI,0,L*d)}}function g(J,e){const w=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let x=0,E=w.length;x<E;x++){const P=w[x];J[P]!==void 0&&(e[P]=J[P])}J.setLineDash!==void 0&&(e.setLineDash(J.getLineDash()),e.lineDashOffset=J.lineDashOffset)}function o(J,e){J.strokeStyle=J.fillStyle=e||"#000000",J.fillRule="nonzero",J.globalAlpha=1,J.lineWidth=1,J.lineCap="butt",J.lineJoin="miter",J.miterLimit=10,J.globalCompositeOperation="source-over",J.font="10px sans-serif",J.setLineDash!==void 0&&(J.setLineDash([]),J.lineDashOffset=0)}function X(J,e,w,x){const E=J.length;for(let P=3;P<E;P+=4){const iI=J[P];if(iI===0)J[P-3]=e,J[P-2]=w,J[P-1]=x;else if(iI<255){const aI=255-iI;J[P-3]=J[P-3]*iI+e*aI>>8,J[P-2]=J[P-2]*iI+w*aI>>8,J[P-1]=J[P-1]*iI+x*aI>>8}}}function b(J,e,w){const x=J.length,E=1/255;for(let P=3;P<x;P+=4){const iI=w?w[J[P]]:J[P];e[P]=e[P]*iI*E|0}}function N(J,e,w){const x=J.length;for(let E=3;E<x;E+=4){const P=J[E-3]*77+J[E-2]*152+J[E-1]*28;e[E]=w?e[E]*w[P>>8]>>8:e[E]*P>>16}}function F(J,e,w,x,E,P,iI,aI,eI,A,W){const L=!!P,S=L?P[0]:0,Q=L?P[1]:0,lI=L?P[2]:0;let uI;E==="Luminosity"?uI=N:uI=b;const ZI=Math.min(x,Math.ceil(1048576/w));for(let WI=0;WI<x;WI+=ZI){const tI=Math.min(ZI,x-WI),O=J.getImageData(aI-A,WI+(eI-W),w,tI),f=e.getImageData(aI,WI+eI,w,tI);L&&X(O.data,S,Q,lI),uI(O.data,f.data,iI),e.putImageData(f,aI,WI+eI)}}function hI(J,e,w,x){const E=x[0],P=x[1],iI=x[2]-E,aI=x[3]-P;iI===0||aI===0||(F(e.context,w,iI,aI,e.subtype,e.backdrop,e.transferMap,E,P,e.offsetX,e.offsetY),J.save(),J.globalAlpha=1,J.globalCompositeOperation="source-over",J.setTransform(1,0,0,1,0,0),J.drawImage(w.canvas,0,0),J.restore())}function YI(J,e){const w=M.Util.singularValueDecompose2dScale(J);w[0]=Math.fround(w[0]),w[1]=Math.fround(w[1]);const x=Math.fround((globalThis.devicePixelRatio||1)*h.PixelsPerInch.PDF_TO_CSS_UNITS);return e!==void 0?e:w[0]<=x||w[1]<=x}const nI=["butt","round","square"],gI=["miter","round","bevel"],U={},II={},BI=class{constructor(e,w,x,E,P,iI,aI,eI){zI(this,mI);this.ctx=e,this.current=new a(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=w,this.objs=x,this.canvasFactory=E,this.imageLayer=P,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=iI,this.cachedCanvases=new l(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=aI,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(eI==null?void 0:eI.background)||null,this.foregroundColor=(eI==null?void 0:eI.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,w=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):w}beginDrawing({transform:e,viewport:w,transparency:x=!1,background:E=null}){const P=this.ctx.canvas.width,iI=this.ctx.canvas.height,aI=E||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const eI=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const A=this.backgroundColor=this.ctx.fillStyle;let W=!0,L=aI;if(this.ctx.fillStyle=aI,L=this.ctx.fillStyle,W=typeof L=="string"&&/^#[0-9A-Fa-f]{6}$/.test(L),eI==="#000000"&&A==="#ffffff"||eI===A||!W)this.foregroundColor=this.backgroundColor=null;else{const[S,Q,lI]=(0,h.getRGB)(L),uI=ZI=>(ZI/=255,ZI<=.03928?ZI/12.92:((ZI+.055)/1.055)**2.4),MI=Math.round(.2126*uI(S)+.7152*uI(Q)+.0722*uI(lI));this.selectColor=(ZI,WI,tI)=>{const O=.2126*uI(ZI)+.7152*uI(WI)+.0722*uI(tI);return Math.round(O)===MI?A:eI}}}if(this.ctx.fillStyle=this.backgroundColor||aI,this.ctx.fillRect(0,0,P,iI),this.ctx.restore(),x){const eI=this.cachedCanvases.getCanvas("transparent",P,iI);this.compositeCtx=this.ctx,this.transparentCanvas=eI.canvas,this.ctx=eI.context,this.ctx.save(),this.ctx.transform(...(0,h.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx,this.foregroundColor),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...w.transform),this.viewportScale=w.scale,this.baseTransform=(0,h.getCurrentTransform)(this.ctx),this.imageLayer&&((0,h.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(e,w,x,E){const P=e.argsArray,iI=e.fnArray;let aI=w||0;const eI=P.length;if(eI===aI)return aI;const A=eI-aI>D&&typeof x=="function",W=A?Date.now()+j:0;let L=0;const S=this.commonObjs,Q=this.objs;let lI;for(;;){if(E!==void 0&&aI===E.nextBreakPoint)return E.breakIt(aI,x),aI;if(lI=iI[aI],lI!==M.OPS.dependency)this[lI].apply(this,P[aI]);else for(const uI of P[aI]){const MI=uI.startsWith("g_")?S:Q;if(!MI.has(uI))return MI.get(uI,x),aI}if(aI++,aI===eI)return aI;if(A&&++L>D){if(Date.now()>W)return x(),aI;L=0}}}endDrawing(){jI(this,mI,pg).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const w of e.values())typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement&&(w.width=w.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(e,w){const x=e.width,E=e.height;let P=Math.max(Math.hypot(w[0],w[1]),1),iI=Math.max(Math.hypot(w[2],w[3]),1),aI=x,eI=E,A="prescale1",W,L;for(;P>2&&aI>1||iI>2&&eI>1;){let S=aI,Q=eI;P>2&&aI>1&&(S=Math.ceil(aI/2),P/=aI/S),iI>2&&eI>1&&(Q=Math.ceil(eI/2),iI/=eI/Q),W=this.cachedCanvases.getCanvas(A,S,Q),L=W.context,L.clearRect(0,0,S,Q),L.drawImage(e,0,0,aI,eI,0,0,S,Q),e=W.canvas,aI=S,eI=Q,A=A==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:aI,paintHeight:eI}}_createMaskCanvas(e){const w=this.ctx,{width:x,height:E}=e,P=this.current.fillColor,iI=this.current.patternFill,aI=(0,h.getCurrentTransform)(w);let eI,A,W,L;if((e.bitmap||e.data)&&e.count>1){const RI=e.bitmap||e.data.buffer,pI=aI.slice(0,4);A=JSON.stringify(iI?pI:[pI,P]),eI=this._cachedBitmapsMap.get(RI),eI||(eI=new Map,this._cachedBitmapsMap.set(RI,eI));const DI=eI.get(A);if(DI&&!iI){const FI=Math.round(Math.min(aI[0],aI[2])+aI[4]),TI=Math.round(Math.min(aI[1],aI[3])+aI[5]);return{canvas:DI,offsetX:FI,offsetY:TI}}W=DI}W||(L=this.cachedCanvases.getCanvas("maskCanvas",x,E),I(L.context,e));let S=M.Util.transform(aI,[1/x,0,0,-1/E,0,0]);S=M.Util.transform(S,[1,0,0,1,0,-E]);const Q=M.Util.applyTransform([0,0],S),lI=M.Util.applyTransform([x,E],S),uI=M.Util.normalizeRect([Q[0],Q[1],lI[0],lI[1]]),MI=Math.round(uI[2]-uI[0])||1,ZI=Math.round(uI[3]-uI[1])||1,WI=this.cachedCanvases.getCanvas("fillCanvas",MI,ZI),tI=WI.context,O=Math.min(Q[0],lI[0]),f=Math.min(Q[1],lI[1]);tI.translate(-O,-f),tI.transform(...S),W||(W=this._scaleImage(L.canvas,(0,h.getCurrentTransformInverse)(tI)),W=W.img,eI&&iI&&eI.set(A,W)),tI.imageSmoothingEnabled=YI((0,h.getCurrentTransform)(tI),e.interpolate),B(tI,W,0,0,W.width,W.height,0,0,x,E),tI.globalCompositeOperation="source-in";const v=M.Util.transform((0,h.getCurrentTransformInverse)(tI),[1,0,0,1,-O,-f]);return tI.fillStyle=iI?P.getPattern(w,this,v,_.PathType.FILL):P,tI.fillRect(0,0,x,E),eI&&!iI&&(this.cachedCanvases.delete("fillCanvas"),eI.set(A,WI.canvas)),{canvas:WI.canvas,offsetX:Math.round(O),offsetY:Math.round(f)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=nI[e]}setLineJoin(e){this.ctx.lineJoin=gI[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,w){const x=this.ctx;x.setLineDash!==void 0&&(x.setLineDash(e),x.lineDashOffset=w)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let w=0,x=e.length;w<x;w++){const E=e[w],P=E[0],iI=E[1];switch(P){case"LW":this.setLineWidth(iI);break;case"LC":this.setLineCap(iI);break;case"LJ":this.setLineJoin(iI);break;case"ML":this.setMiterLimit(iI);break;case"D":this.setDash(iI[0],iI[1]);break;case"RI":this.setRenderingIntent(iI);break;case"FL":this.setFlatness(iI);break;case"Font":this.setFont(iI[0],iI[1]);break;case"CA":this.current.strokeAlpha=E[1];break;case"ca":this.current.fillAlpha=E[1],this.ctx.globalAlpha=E[1];break;case"BM":this.ctx.globalCompositeOperation=iI;break;case"SMask":this.current.activeSMask=iI?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=iI}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,w=this.ctx.canvas.height,x="smaskGroupAt"+this.groupLevel,E=this.cachedCanvases.getCanvas(x,e,w);this.suspendedCtx=this.ctx,this.ctx=E.context;const P=this.ctx;P.setTransform(...(0,h.getCurrentTransform)(this.suspendedCtx)),g(this.suspendedCtx,P),C(P,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),g(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const w=this.current.activeSMask,x=this.suspendedCtx;hI(x,w,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(g(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),g(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(e,w,x,E,P,iI){this.ctx.transform(e,w,x,E,P,iI),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(e,w,x){const E=this.ctx,P=this.current;let iI=P.x,aI=P.y,eI,A;const W=(0,h.getCurrentTransform)(E),L=W[0]===0&&W[3]===0||W[1]===0&&W[2]===0,S=L?x.slice(0):null;for(let Q=0,lI=0,uI=e.length;Q<uI;Q++)switch(e[Q]|0){case M.OPS.rectangle:iI=w[lI++],aI=w[lI++];const MI=w[lI++],ZI=w[lI++],WI=iI+MI,tI=aI+ZI;E.moveTo(iI,aI),MI===0||ZI===0?E.lineTo(WI,tI):(E.lineTo(WI,aI),E.lineTo(WI,tI),E.lineTo(iI,tI)),L||P.updateRectMinMax(W,[iI,aI,WI,tI]),E.closePath();break;case M.OPS.moveTo:iI=w[lI++],aI=w[lI++],E.moveTo(iI,aI),L||P.updatePathMinMax(W,iI,aI);break;case M.OPS.lineTo:iI=w[lI++],aI=w[lI++],E.lineTo(iI,aI),L||P.updatePathMinMax(W,iI,aI);break;case M.OPS.curveTo:eI=iI,A=aI,iI=w[lI+4],aI=w[lI+5],E.bezierCurveTo(w[lI],w[lI+1],w[lI+2],w[lI+3],iI,aI),P.updateCurvePathMinMax(W,eI,A,w[lI],w[lI+1],w[lI+2],w[lI+3],iI,aI,S),lI+=6;break;case M.OPS.curveTo2:eI=iI,A=aI,E.bezierCurveTo(iI,aI,w[lI],w[lI+1],w[lI+2],w[lI+3]),P.updateCurvePathMinMax(W,eI,A,iI,aI,w[lI],w[lI+1],w[lI+2],w[lI+3],S),iI=w[lI+2],aI=w[lI+3],lI+=4;break;case M.OPS.curveTo3:eI=iI,A=aI,iI=w[lI+2],aI=w[lI+3],E.bezierCurveTo(w[lI],w[lI+1],iI,aI,iI,aI),P.updateCurvePathMinMax(W,eI,A,w[lI],w[lI+1],iI,aI,iI,aI,S),lI+=4;break;case M.OPS.closePath:E.closePath();break}L&&P.updateScalingPathMinMax(W,S),P.setCurrentPoint(iI,aI)}closePath(){this.ctx.closePath()}stroke(e){e=typeof e<"u"?e:!0;const w=this.ctx,x=this.current.strokeColor;w.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof x=="object"&&(x!=null&&x.getPattern)?(w.save(),w.strokeStyle=x.getPattern(w,this,(0,h.getCurrentTransformInverse)(w),_.PathType.STROKE),this.rescaleAndStroke(!1),w.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),w.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e){e=typeof e<"u"?e:!0;const w=this.ctx,x=this.current.fillColor,E=this.current.patternFill;let P=!1;E&&(w.save(),w.fillStyle=x.getPattern(w,this,(0,h.getCurrentTransformInverse)(w),_.PathType.FILL),P=!0);const iI=this.current.getClippedPathBoundingBox();this.contentVisible&&iI!==null&&(this.pendingEOFill?(w.fill("evenodd"),this.pendingEOFill=!1):w.fill()),P&&w.restore(),e&&this.consumePath(iI)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=U}eoClip(){this.pendingClip=II}beginText(){this.current.textMatrix=M.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,w=this.ctx;if(e===void 0){w.beginPath();return}w.save(),w.beginPath();for(const x of e)w.setTransform(...x.transform),w.translate(x.x,x.y),x.addToPath(w,x.fontSize);w.restore(),w.clip(),w.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,w){const x=this.commonObjs.get(e),E=this.current;if(!x)throw new Error(`Can't find font for ${e}`);if(E.fontMatrix=x.fontMatrix||M.FONT_IDENTITY_MATRIX,(E.fontMatrix[0]===0||E.fontMatrix[3]===0)&&(0,M.warn)("Invalid font matrix for font "+e),w<0?(w=-w,E.fontDirection=-1):E.fontDirection=1,this.current.font=x,this.current.fontSize=w,x.isType3Font)return;const P=x.loadedName||"sans-serif";let iI="normal";x.black?iI="900":x.bold&&(iI="bold");const aI=x.italic?"italic":"normal",eI=`"${P}", ${x.fallbackName}`;let A=w;w<r?A=r:w>Z&&(A=Z),this.current.fontSizeScale=w/A,this.ctx.font=`${aI} ${iI} ${A}px ${eI}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,w){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=w}setLeadingMoveText(e,w){this.setLeading(-w),this.moveText(e,w)}setTextMatrix(e,w,x,E,P,iI){this.current.textMatrix=[e,w,x,E,P,iI],this.current.textMatrixScale=Math.hypot(e,w),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,w,x,E){const P=this.ctx,iI=this.current,aI=iI.font,eI=iI.textRenderingMode,A=iI.fontSize/iI.fontSizeScale,W=eI&M.TextRenderingMode.FILL_STROKE_MASK,L=!!(eI&M.TextRenderingMode.ADD_TO_PATH_FLAG),S=iI.patternFill&&!aI.missingFile;let Q;(aI.disableFontFace||L||S)&&(Q=aI.getPathGenerator(this.commonObjs,e)),aI.disableFontFace||S?(P.save(),P.translate(w,x),P.beginPath(),Q(P,A),E&&P.setTransform(...E),(W===M.TextRenderingMode.FILL||W===M.TextRenderingMode.FILL_STROKE)&&P.fill(),(W===M.TextRenderingMode.STROKE||W===M.TextRenderingMode.FILL_STROKE)&&P.stroke(),P.restore()):((W===M.TextRenderingMode.FILL||W===M.TextRenderingMode.FILL_STROKE)&&P.fillText(e,w,x),(W===M.TextRenderingMode.STROKE||W===M.TextRenderingMode.FILL_STROKE)&&P.strokeText(e,w,x)),L&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,h.getCurrentTransform)(P),x:w,y:x,fontSize:A,addToPath:Q})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const w=e.getImageData(0,0,10,10).data;let x=!1;for(let E=3;E<w.length;E+=4)if(w[E]>0&&w[E]<255){x=!0;break}return(0,M.shadow)(this,"isFontSubpixelAAEnabled",x)}showText(e){const w=this.current,x=w.font;if(x.isType3Font)return this.showType3Text(e);const E=w.fontSize;if(E===0)return;const P=this.ctx,iI=w.fontSizeScale,aI=w.charSpacing,eI=w.wordSpacing,A=w.fontDirection,W=w.textHScale*A,L=e.length,S=x.vertical,Q=S?1:-1,lI=x.defaultVMetrics,uI=E*w.fontMatrix[0],MI=w.textRenderingMode===M.TextRenderingMode.FILL&&!x.disableFontFace&&!w.patternFill;P.save(),P.transform(...w.textMatrix),P.translate(w.x,w.y+w.textRise),A>0?P.scale(W,-1):P.scale(W,1);let ZI;if(w.patternFill){P.save();const v=w.fillColor.getPattern(P,this,(0,h.getCurrentTransformInverse)(P),_.PathType.FILL);ZI=(0,h.getCurrentTransform)(P),P.restore(),P.fillStyle=v}let WI=w.lineWidth;const tI=w.textMatrixScale;if(tI===0||WI===0){const v=w.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;(v===M.TextRenderingMode.STROKE||v===M.TextRenderingMode.FILL_STROKE)&&(WI=this.getSinglePixelWidth())}else WI/=tI;iI!==1&&(P.scale(iI,iI),WI/=iI),P.lineWidth=WI;let O=0,f;for(f=0;f<L;++f){const v=e[f];if(typeof v=="number"){O+=Q*v*E/1e3;continue}let RI=!1;const pI=(v.isSpace?eI:0)+aI,DI=v.fontChar,FI=v.accent;let TI,vI,fI=v.width;if(S){const EI=v.vmetric||lI,SI=-(v.vmetric?EI[1]:fI*.5)*uI,JI=EI[2]*uI;fI=EI?-EI[0]:fI,TI=SI/iI,vI=(O+JI)/iI}else TI=O/iI,vI=0;if(x.remeasure&&fI>0){const EI=P.measureText(DI).width*1e3/E*iI;if(fI<EI&&this.isFontSubpixelAAEnabled){const SI=fI/EI;RI=!0,P.save(),P.scale(SI,1),TI/=SI}else fI!==EI&&(TI+=(fI-EI)/2e3*E/iI)}if(this.contentVisible&&(v.isInFont||x.missingFile)){if(MI&&!FI)P.fillText(DI,TI,vI);else if(this.paintChar(DI,TI,vI,ZI),FI){const EI=TI+E*FI.offset.x/iI,SI=vI-E*FI.offset.y/iI;this.paintChar(FI.fontChar,EI,SI,ZI)}}let PI;S?PI=fI*uI-pI*A:PI=fI*uI+pI*A,O+=PI,RI&&P.restore()}S?w.y-=O:w.x+=O*W,P.restore(),this.compose()}showType3Text(e){const w=this.ctx,x=this.current,E=x.font,P=x.fontSize,iI=x.fontDirection,aI=E.vertical?1:-1,eI=x.charSpacing,A=x.wordSpacing,W=x.textHScale*iI,L=x.fontMatrix||M.FONT_IDENTITY_MATRIX,S=e.length,Q=x.textRenderingMode===M.TextRenderingMode.INVISIBLE;let lI,uI,MI,ZI;if(!(Q||P===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,w.save(),w.transform(...x.textMatrix),w.translate(x.x,x.y),w.scale(W,iI),lI=0;lI<S;++lI){if(uI=e[lI],typeof uI=="number"){ZI=aI*uI*P/1e3,this.ctx.translate(ZI,0),x.x+=ZI*W;continue}const WI=(uI.isSpace?A:0)+eI,tI=E.charProcOperatorList[uI.operatorListId];if(!tI){(0,M.warn)(`Type3 character "${uI.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=uI,this.save(),w.scale(P,P),w.transform(...L),this.executeOperatorList(tI),this.restore()),MI=M.Util.applyTransform([uI.width,0],L)[0]*P+WI,w.translate(MI,0),x.x+=MI*W}w.restore(),this.processingType3=null}}setCharWidth(e,w){}setCharWidthAndBounds(e,w,x,E,P,iI){this.ctx.rect(x,E,P-x,iI-E),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let w;if(e[0]==="TilingPattern"){const x=e[1],E=this.baseTransform||(0,h.getCurrentTransform)(this.ctx),P={createCanvasGraphics:iI=>new BI(iI,this.commonObjs,this.objs,this.canvasFactory)};w=new _.TilingPattern(e,x,this.ctx,P,E)}else w=this._getPattern(e[1],e[2]);return w}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,w,x){var P;const E=((P=this.selectColor)==null?void 0:P.call(this,e,w,x))||M.Util.makeHexColor(e,w,x);this.ctx.strokeStyle=E,this.current.strokeColor=E}setFillRGBColor(e,w,x){var P;const E=((P=this.selectColor)==null?void 0:P.call(this,e,w,x))||M.Util.makeHexColor(e,w,x);this.ctx.fillStyle=E,this.current.fillColor=E,this.current.patternFill=!1}_getPattern(e,w=null){let x;return this.cachedPatterns.has(e)?x=this.cachedPatterns.get(e):(x=(0,_.getShadingPattern)(this.objs.get(e)),this.cachedPatterns.set(e,x)),w&&(x.matrix=w),x}shadingFill(e){if(!this.contentVisible)return;const w=this.ctx;this.save();const x=this._getPattern(e);w.fillStyle=x.getPattern(w,this,(0,h.getCurrentTransformInverse)(w),_.PathType.SHADING);const E=(0,h.getCurrentTransformInverse)(w);if(E){const P=w.canvas,iI=P.width,aI=P.height,eI=M.Util.applyTransform([0,0],E),A=M.Util.applyTransform([0,aI],E),W=M.Util.applyTransform([iI,0],E),L=M.Util.applyTransform([iI,aI],E),S=Math.min(eI[0],A[0],W[0],L[0]),Q=Math.min(eI[1],A[1],W[1],L[1]),lI=Math.max(eI[0],A[0],W[0],L[0]),uI=Math.max(eI[1],A[1],W[1],L[1]);this.ctx.fillRect(S,Q,lI-S,uI-Q)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,M.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,M.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,w){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&e.length===6&&this.transform(...e),this.baseTransform=(0,h.getCurrentTransform)(this.ctx),w)){const x=w[2]-w[0],E=w[3]-w[1];this.ctx.rect(w[0],w[1],x,E),this.current.updateRectMinMax((0,h.getCurrentTransform)(this.ctx),w),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const w=this.ctx;e.isolated||(0,M.info)("TODO: Support non-isolated groups."),e.knockout&&(0,M.warn)("Knockout groups not supported.");const x=(0,h.getCurrentTransform)(w);if(e.matrix&&w.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let E=M.Util.getAxialAlignedBoundingBox(e.bbox,(0,h.getCurrentTransform)(w));const P=[0,0,w.canvas.width,w.canvas.height];E=M.Util.intersect(E,P)||[0,0,0,0];const iI=Math.floor(E[0]),aI=Math.floor(E[1]);let eI=Math.max(Math.ceil(E[2])-iI,1),A=Math.max(Math.ceil(E[3])-aI,1),W=1,L=1;eI>p&&(W=eI/p,eI=p),A>p&&(L=A/p,A=p),this.current.startNewPathAndClipBox([0,0,eI,A]);let S="groupAt"+this.groupLevel;e.smask&&(S+="_smask_"+this.smaskCounter++%2);const Q=this.cachedCanvases.getCanvas(S,eI,A),lI=Q.context;lI.scale(1/W,1/L),lI.translate(-iI,-aI),lI.transform(...x),e.smask?this.smaskStack.push({canvas:Q.canvas,context:lI,offsetX:iI,offsetY:aI,scaleX:W,scaleY:L,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(w.setTransform(1,0,0,1,0,0),w.translate(iI,aI),w.scale(W,L),w.save()),g(w,lI),this.ctx=lI,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(w),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const w=this.ctx,x=this.groupStack.pop();if(this.ctx=x,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const E=(0,h.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...E);const P=M.Util.getAxialAlignedBoundingBox([0,0,w.canvas.width,w.canvas.height],E);this.ctx.drawImage(w.canvas,0,0),this.ctx.restore(),this.compose(P)}}beginAnnotation(e,w,x,E,P){if(jI(this,mI,pg).call(this),o(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(w)&&w.length===4){const iI=w[2]-w[0],aI=w[3]-w[1];if(P&&this.annotationCanvasMap){x=x.slice(),x[4]-=w[0],x[5]-=w[1],w=w.slice(),w[0]=w[1]=0,w[2]=iI,w[3]=aI;const[eI,A]=M.Util.singularValueDecompose2dScale((0,h.getCurrentTransform)(this.ctx)),{viewportScale:W}=this,L=Math.ceil(iI*this.outputScaleX*W),S=Math.ceil(aI*this.outputScaleY*W);this.annotationCanvas=this.canvasFactory.create(L,S);const{canvas:Q,context:lI}=this.annotationCanvas;this.annotationCanvasMap.set(e,Q),this.annotationCanvas.savedCtx=this.ctx,this.ctx=lI,this.ctx.setTransform(eI,0,0,-A,0,aI*A),o(this.ctx,this.foregroundColor)}else o(this.ctx,this.foregroundColor),this.ctx.rect(w[0],w[1],iI,aI),this.ctx.clip(),this.endPath()}this.current=new a(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...x),this.transform(...E)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const w=e.count;e=this.getObject(e.data,e),e.count=w;const x=this.ctx,E=this.processingType3;if(E&&(E.compiled===void 0&&(E.compiled=Y(e)),E.compiled)){E.compiled(x);return}const P=this._createMaskCanvas(e),iI=P.canvas;x.save(),x.setTransform(1,0,0,1,0,0),x.drawImage(iI,P.offsetX,P.offsetY),x.restore(),this.compose()}paintImageMaskXObjectRepeat(e,w,x=0,E=0,P,iI){if(!this.contentVisible)return;e=this.getObject(e.data,e);const aI=this.ctx;aI.save();const eI=(0,h.getCurrentTransform)(aI);aI.transform(w,x,E,P,0,0);const A=this._createMaskCanvas(e);aI.setTransform(1,0,0,1,0,0);for(let W=0,L=iI.length;W<L;W+=2){const S=M.Util.transform(eI,[w,x,E,P,iI[W],iI[W+1]]),[Q,lI]=M.Util.applyTransform([0,0],S);aI.drawImage(A.canvas,Q,lI)}aI.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const w=this.ctx,x=this.current.fillColor,E=this.current.patternFill;for(const P of e){const{data:iI,width:aI,height:eI,transform:A}=P,W=this.cachedCanvases.getCanvas("maskCanvas",aI,eI),L=W.context;L.save();const S=this.getObject(iI,P);I(L,S),L.globalCompositeOperation="source-in",L.fillStyle=E?x.getPattern(L,this,(0,h.getCurrentTransformInverse)(w),_.PathType.FILL):x,L.fillRect(0,0,aI,eI),L.restore(),w.save(),w.transform(...A),w.scale(1,-1),B(w,W.canvas,0,0,aI,eI,0,-1,1,1),w.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const w=this.getObject(e);if(!w){(0,M.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(w)}paintImageXObjectRepeat(e,w,x,E){if(!this.contentVisible)return;const P=this.getObject(e);if(!P){(0,M.warn)("Dependent image isn't ready yet");return}const iI=P.width,aI=P.height,eI=[];for(let A=0,W=E.length;A<W;A+=2)eI.push({transform:[w,0,0,x,E[A],E[A+1]],x:0,y:0,w:iI,h:aI});this.paintInlineImageXObjectGroup(P,eI)}paintInlineImageXObject(e){if(!this.contentVisible)return;const w=e.width,x=e.height,E=this.ctx;this.save(),E.scale(1/w,-1/x);let P;if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)P=e;else{const A=this.cachedCanvases.getCanvas("inlineImage",w,x),W=A.context;i(W,e,this.current.transferMaps),P=A.canvas}const iI=this._scaleImage(P,(0,h.getCurrentTransformInverse)(E));E.imageSmoothingEnabled=YI((0,h.getCurrentTransform)(E),e.interpolate);const[aI,eI]=B(E,iI.img,0,0,iI.paintWidth,iI.paintHeight,0,-x,w,x);if(this.imageLayer){const[A,W]=M.Util.applyTransform([0,-x],(0,h.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:e,left:A,top:W,width:aI,height:eI})}this.compose(),this.restore()}paintInlineImageXObjectGroup(e,w){if(!this.contentVisible)return;const x=this.ctx,E=e.width,P=e.height,iI=this.cachedCanvases.getCanvas("inlineImage",E,P),aI=iI.context;i(aI,e,this.current.transferMaps);for(const eI of w){if(x.save(),x.transform(...eI.transform),x.scale(1,-1),B(x,iI.canvas,eI.x,eI.y,eI.w,eI.h,0,-1,1,1),this.imageLayer){const[A,W]=M.Util.applyTransform([eI.x,eI.y],(0,h.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:e,left:A,top:W,width:E,height:P})}x.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,w){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,w){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(w)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const w=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const x=this.ctx;this.pendingClip&&(w||(this.pendingClip===II?x.clip("evenodd"):x.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),x.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,h.getCurrentTransform)(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const w=Math.abs(e[0]*e[3]-e[2]*e[1]),x=Math.hypot(e[0],e[2]),E=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(x,E)/w}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:e}=this.current,w=(0,h.getCurrentTransform)(this.ctx);let x,E;if(w[1]===0&&w[2]===0){const P=Math.abs(w[0]),iI=Math.abs(w[3]);if(e===0)x=1/P,E=1/iI;else{const aI=P*e,eI=iI*e;x=aI<1?1/aI:1,E=eI<1?1/eI:1}}else{const P=Math.abs(w[0]*w[3]-w[2]*w[1]),iI=Math.hypot(w[0],w[1]),aI=Math.hypot(w[2],w[3]);if(e===0)x=aI/P,E=iI/P;else{const eI=e*P;x=aI>eI?aI/eI:1,E=iI>eI?iI/eI:1}}this._cachedScaleForStroking=[x,E]}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:w}=this,{lineWidth:x}=this.current,[E,P]=this.getScaleForStroking();if(w.lineWidth=x||1,E===1&&P===1){w.stroke();return}let iI,aI,eI;e&&(iI=(0,h.getCurrentTransform)(w),aI=w.getLineDash().slice(),eI=w.lineDashOffset),w.scale(E,P);const A=Math.max(E,P);w.setLineDash(w.getLineDash().map(W=>W/A)),w.lineDashOffset/=A,w.stroke(),e&&(w.setTransform(...iI),w.setLineDash(aI),w.lineDashOffset=eI)}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};let q=BI;mI=new WeakSet,pg=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},c.CanvasGraphics=q;for(const J in M.OPS)q.prototype[J]!==void 0&&(q.prototype[M.OPS[J]]=q.prototype[J])},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TilingPattern=c.PathType=void 0,c.getShadingPattern=d;var h=$(1),M=$(8),_=$(3);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};c.PathType=z;function T(B,Y){if(!Y||_.isNodeJS)return;const a=Y[2]-Y[0],i=Y[3]-Y[1],I=new Path2D;I.rect(Y[0],Y[1],a,i),B.clip(I)}class r{constructor(){this.constructor===r&&(0,h.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,h.unreachable)("Abstract method `getPattern` called.")}}class Z extends r{constructor(Y){super(),this._type=Y[1],this._bbox=Y[2],this._colorStops=Y[3],this._p0=Y[4],this._p1=Y[5],this._r0=Y[6],this._r1=Y[7],this.matrix=null}_createGradient(Y){let a;this._type==="axial"?a=Y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(a=Y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)a.addColorStop(i[0],i[1]);return a}getPattern(Y,a,i,I){let g;if(I===z.STROKE||I===z.FILL){const o=a.current.getClippedPathBoundingBox(I,(0,M.getCurrentTransform)(Y))||[0,0,0,0],X=Math.ceil(o[2]-o[0])||1,b=Math.ceil(o[3]-o[1])||1,N=a.cachedCanvases.getCanvas("pattern",X,b,!0),F=N.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-o[0],-o[1]),i=h.Util.transform(i,[1,0,0,1,o[0],o[1]]),F.transform(...a.baseTransform),this.matrix&&F.transform(...this.matrix),T(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),g=Y.createPattern(N.canvas,"no-repeat");const hI=new DOMMatrix(i);try{g.setTransform(hI)}catch(YI){(0,h.warn)(`RadialAxialShadingPattern.getPattern: "${YI==null?void 0:YI.message}".`)}}else T(Y,this._bbox),g=this._createGradient(Y);return g}}function p(B,Y,a,i,I,g,o,X){const b=Y.coords,N=Y.colors,F=B.data,hI=B.width*4;let YI;b[a+1]>b[i+1]&&(YI=a,a=i,i=YI,YI=g,g=o,o=YI),b[i+1]>b[I+1]&&(YI=i,i=I,I=YI,YI=o,o=X,X=YI),b[a+1]>b[i+1]&&(YI=a,a=i,i=YI,YI=g,g=o,o=YI);const nI=(b[a]+Y.offsetX)*Y.scaleX,gI=(b[a+1]+Y.offsetY)*Y.scaleY,U=(b[i]+Y.offsetX)*Y.scaleX,II=(b[i+1]+Y.offsetY)*Y.scaleY,q=(b[I]+Y.offsetX)*Y.scaleX,mI=(b[I+1]+Y.offsetY)*Y.scaleY;if(gI>=mI)return;const NI=N[g],BI=N[g+1],J=N[g+2],e=N[o],w=N[o+1],x=N[o+2],E=N[X],P=N[X+1],iI=N[X+2],aI=Math.round(gI),eI=Math.round(mI);let A,W,L,S,Q,lI,uI,MI;for(let ZI=aI;ZI<=eI;ZI++){if(ZI<II){let v;ZI<gI?v=0:v=(gI-ZI)/(gI-II),A=nI-(nI-U)*v,W=NI-(NI-e)*v,L=BI-(BI-w)*v,S=J-(J-x)*v}else{let v;ZI>mI?v=1:II===mI?v=0:v=(II-ZI)/(II-mI),A=U-(U-q)*v,W=e-(e-E)*v,L=w-(w-P)*v,S=x-(x-iI)*v}let WI;ZI<gI?WI=0:ZI>mI?WI=1:WI=(gI-ZI)/(gI-mI),Q=nI-(nI-q)*WI,lI=NI-(NI-E)*WI,uI=BI-(BI-P)*WI,MI=J-(J-iI)*WI;const tI=Math.round(Math.min(A,Q)),O=Math.round(Math.max(A,Q));let f=hI*ZI+tI*4;for(let v=tI;v<=O;v++)WI=(A-v)/(A-Q),WI<0?WI=0:WI>1&&(WI=1),F[f++]=W-(W-lI)*WI|0,F[f++]=L-(L-uI)*WI|0,F[f++]=S-(S-MI)*WI|0,F[f++]=255}}function j(B,Y,a){const i=Y.coords,I=Y.colors;let g,o;switch(Y.type){case"lattice":const X=Y.verticesPerRow,b=Math.floor(i.length/X)-1,N=X-1;for(g=0;g<b;g++){let F=g*X;for(let hI=0;hI<N;hI++,F++)p(B,a,i[F],i[F+1],i[F+X],I[F],I[F+1],I[F+X]),p(B,a,i[F+X+1],i[F+1],i[F+X],I[F+X+1],I[F+1],I[F+X])}break;case"triangles":for(g=0,o=i.length;g<o;g+=3)p(B,a,i[g],i[g+1],i[g+2],I[g],I[g+1],I[g+2]);break;default:throw new Error("illegal figure")}}class D extends r{constructor(Y){super(),this._coords=Y[2],this._colors=Y[3],this._figures=Y[4],this._bounds=Y[5],this._bbox=Y[7],this._background=Y[8],this.matrix=null}_createMeshCanvas(Y,a,i){const X=Math.floor(this._bounds[0]),b=Math.floor(this._bounds[1]),N=Math.ceil(this._bounds[2])-X,F=Math.ceil(this._bounds[3])-b,hI=Math.min(Math.ceil(Math.abs(N*Y[0]*1.1)),3e3),YI=Math.min(Math.ceil(Math.abs(F*Y[1]*1.1)),3e3),nI=N/hI,gI=F/YI,U={coords:this._coords,colors:this._colors,offsetX:-X,offsetY:-b,scaleX:1/nI,scaleY:1/gI},II=hI+2*2,q=YI+2*2,mI=i.getCanvas("mesh",II,q,!1),NI=mI.context,BI=NI.createImageData(hI,YI);if(a){const e=BI.data;for(let w=0,x=e.length;w<x;w+=4)e[w]=a[0],e[w+1]=a[1],e[w+2]=a[2],e[w+3]=255}for(const e of this._figures)j(BI,e,U);return NI.putImageData(BI,2,2),{canvas:mI.canvas,offsetX:X-2*nI,offsetY:b-2*gI,scaleX:nI,scaleY:gI}}getPattern(Y,a,i,I){T(Y,this._bbox);let g;if(I===z.SHADING)g=h.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(Y));else if(g=h.Util.singularValueDecompose2dScale(a.baseTransform),this.matrix){const X=h.Util.singularValueDecompose2dScale(this.matrix);g=[g[0]*X[0],g[1]*X[1]]}const o=this._createMeshCanvas(g,I===z.SHADING?null:this._background,a.cachedCanvases);return I!==z.SHADING&&(Y.setTransform(...a.baseTransform),this.matrix&&Y.transform(...this.matrix)),Y.translate(o.offsetX,o.offsetY),Y.scale(o.scaleX,o.scaleY),Y.createPattern(o.canvas,"no-repeat")}}class m extends r{getPattern(){return"hotpink"}}function d(B){switch(B[0]){case"RadialAxial":return new Z(B);case"Mesh":return new D(B);case"Dummy":return new m}throw new Error(`Unknown IR type: ${B[0]}`)}const C={COLORED:1,UNCOLORED:2};class l{static get MAX_PATTERN_SIZE(){return(0,h.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(Y,a,i,I,g){this.operatorList=Y[2],this.matrix=Y[3]||[1,0,0,1,0,0],this.bbox=Y[4],this.xstep=Y[5],this.ystep=Y[6],this.paintType=Y[7],this.tilingType=Y[8],this.color=a,this.ctx=i,this.canvasGraphicsFactory=I,this.baseTransform=g}createPatternCanvas(Y){const a=this.operatorList,i=this.bbox,I=this.xstep,g=this.ystep,o=this.paintType,X=this.tilingType,b=this.color,N=this.canvasGraphicsFactory;(0,h.info)("TilingType: "+X);const F=i[0],hI=i[1],YI=i[2],nI=i[3],gI=h.Util.singularValueDecompose2dScale(this.matrix),U=h.Util.singularValueDecompose2dScale(this.baseTransform),II=[gI[0]*U[0],gI[1]*U[1]],q=this.getSizeAndScale(I,this.ctx.canvas.width,II[0]),mI=this.getSizeAndScale(g,this.ctx.canvas.height,II[1]),NI=Y.cachedCanvases.getCanvas("pattern",q.size,mI.size,!0),BI=NI.context,J=N.createCanvasGraphics(BI);J.groupLevel=Y.groupLevel,this.setFillAndStrokeStyleToContext(J,o,b);let e=F,w=hI,x=YI,E=nI;return F<0&&(e=0,x+=Math.abs(F)),hI<0&&(w=0,E+=Math.abs(hI)),BI.translate(-(q.scale*e),-(mI.scale*w)),J.transform(q.scale,0,0,mI.scale,0,0),BI.save(),this.clipBbox(J,e,w,x,E),J.baseTransform=(0,M.getCurrentTransform)(J.ctx),J.executeOperatorList(a),J.endDrawing(),{canvas:NI.canvas,scaleX:q.scale,scaleY:mI.scale,offsetX:e,offsetY:w}}getSizeAndScale(Y,a,i){Y=Math.abs(Y);const I=Math.max(l.MAX_PATTERN_SIZE,a);let g=Math.ceil(Y*i);return g>=I?g=I:i=g/Y,{scale:i,size:g}}clipBbox(Y,a,i,I,g){const o=I-a,X=g-i;Y.ctx.rect(a,i,o,X),Y.current.updateRectMinMax((0,M.getCurrentTransform)(Y.ctx),[a,i,I,g]),Y.clip(),Y.endPath()}setFillAndStrokeStyleToContext(Y,a,i){const I=Y.ctx,g=Y.current;switch(a){case C.COLORED:const o=this.ctx;I.fillStyle=o.fillStyle,I.strokeStyle=o.strokeStyle,g.fillColor=o.fillStyle,g.strokeColor=o.strokeStyle;break;case C.UNCOLORED:const X=h.Util.makeHexColor(i[0],i[1],i[2]);I.fillStyle=X,I.strokeStyle=X,g.fillColor=X,g.strokeColor=X;break;default:throw new h.FormatError(`Unsupported paint type: ${a}`)}}getPattern(Y,a,i,I){let g=i;I!==z.SHADING&&(g=h.Util.transform(g,a.baseTransform),this.matrix&&(g=h.Util.transform(g,this.matrix)));const o=this.createPatternCanvas(a);let X=new DOMMatrix(g);X=X.translate(o.offsetX,o.offsetY),X=X.scale(1/o.scaleX,1/o.scaleY);const b=Y.createPattern(o.canvas,"repeat");try{b.setTransform(X)}catch(N){(0,h.warn)(`TilingPattern.getPattern: "${N==null?void 0:N.message}".`)}return b}}c.TilingPattern=l},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.applyMaskImageData=M;var h=$(1);function M({src:_,srcPos:z=0,dest:T,destPos:r=0,width:Z,height:p,inverseDecode:j=!1}){const D=h.FeatureTest.isLittleEndian?4278190080:255,[m,d]=j?[0,D]:[D,0],C=Z>>3,l=Z&7,B=_.length;T=new Uint32Array(T.buffer);for(let Y=0;Y<p;Y++){for(const i=z+C;z<i;z++){const I=z<B?_[z]:255;T[r++]=I&128?d:m,T[r++]=I&64?d:m,T[r++]=I&32?d:m,T[r++]=I&16?d:m,T[r++]=I&8?d:m,T[r++]=I&4?d:m,T[r++]=I&2?d:m,T[r++]=I&1?d:m}if(l===0)continue;const a=z<B?_[z++]:255;for(let i=0;i<l;i++)T[r++]=a&1<<7-i?d:m}return{srcPos:z,destPos:r}}},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GlobalWorkerOptions=void 0;const $=Object.create(null);c.GlobalWorkerOptions=$,$.workerPort=$.workerPort===void 0?null:$.workerPort,$.workerSrc=$.workerSrc===void 0?"":$.workerSrc},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MessageHandler=void 0;var h=$(1);const M={UNKNOWN:0,DATA:1,ERROR:2},_={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z(r){switch(r instanceof Error||typeof r=="object"&&r!==null||(0,h.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new h.AbortException(r.message);case"MissingPDFException":return new h.MissingPDFException(r.message);case"PasswordException":return new h.PasswordException(r.message,r.code);case"UnexpectedResponseException":return new h.UnexpectedResponseException(r.message,r.status);case"UnknownErrorException":return new h.UnknownErrorException(r.message,r.details);default:return new h.UnknownErrorException(r.message,r.toString())}}class T{constructor(Z,p,j){this.sourceName=Z,this.targetName=p,this.comObj=j,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=D=>{const m=D.data;if(m.targetName!==this.sourceName)return;if(m.stream){this._processStreamMessage(m);return}if(m.callback){const C=m.callbackId,l=this.callbackCapabilities[C];if(!l)throw new Error(`Cannot resolve callback ${C}`);if(delete this.callbackCapabilities[C],m.callback===M.DATA)l.resolve(m.data);else if(m.callback===M.ERROR)l.reject(z(m.reason));else throw new Error("Unexpected callback case");return}const d=this.actionHandler[m.action];if(!d)throw new Error(`Unknown action from worker: ${m.action}`);if(m.callbackId){const C=this.sourceName,l=m.sourceName;new Promise(function(B){B(d(m.data))}).then(function(B){j.postMessage({sourceName:C,targetName:l,callback:M.DATA,callbackId:m.callbackId,data:B})},function(B){j.postMessage({sourceName:C,targetName:l,callback:M.ERROR,callbackId:m.callbackId,reason:z(B)})});return}if(m.streamId){this._createStreamSink(m);return}d(m.data)},j.addEventListener("message",this._onComObjOnMessage)}on(Z,p){const j=this.actionHandler;if(j[Z])throw new Error(`There is already an actionName called "${Z}"`);j[Z]=p}send(Z,p,j){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Z,data:p},j)}sendWithPromise(Z,p,j){const D=this.callbackId++,m=(0,h.createPromiseCapability)();this.callbackCapabilities[D]=m;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Z,callbackId:D,data:p},j)}catch(d){m.reject(d)}return m.promise}sendWithStream(Z,p,j,D){const m=this.streamId++,d=this.sourceName,C=this.targetName,l=this.comObj;return new ReadableStream({start:B=>{const Y=(0,h.createPromiseCapability)();return this.streamControllers[m]={controller:B,startCall:Y,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:d,targetName:C,action:Z,streamId:m,data:p,desiredSize:B.desiredSize},D),Y.promise},pull:B=>{const Y=(0,h.createPromiseCapability)();return this.streamControllers[m].pullCall=Y,l.postMessage({sourceName:d,targetName:C,stream:_.PULL,streamId:m,desiredSize:B.desiredSize}),Y.promise},cancel:B=>{(0,h.assert)(B instanceof Error,"cancel must have a valid reason");const Y=(0,h.createPromiseCapability)();return this.streamControllers[m].cancelCall=Y,this.streamControllers[m].isClosed=!0,l.postMessage({sourceName:d,targetName:C,stream:_.CANCEL,streamId:m,reason:z(B)}),Y.promise}},j)}_createStreamSink(Z){const p=Z.streamId,j=this.sourceName,D=Z.sourceName,m=this.comObj,d=this,C=this.actionHandler[Z.action],l={enqueue(B,Y=1,a){if(this.isCancelled)return;const i=this.desiredSize;this.desiredSize-=Y,i>0&&this.desiredSize<=0&&(this.sinkCapability=(0,h.createPromiseCapability)(),this.ready=this.sinkCapability.promise),m.postMessage({sourceName:j,targetName:D,stream:_.ENQUEUE,streamId:p,chunk:B},a)},close(){this.isCancelled||(this.isCancelled=!0,m.postMessage({sourceName:j,targetName:D,stream:_.CLOSE,streamId:p}),delete d.streamSinks[p])},error(B){(0,h.assert)(B instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,m.postMessage({sourceName:j,targetName:D,stream:_.ERROR,streamId:p,reason:z(B)}))},sinkCapability:(0,h.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:Z.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[p]=l,new Promise(function(B){B(C(Z.data,l))}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.START_COMPLETE,streamId:p,success:!0})},function(B){m.postMessage({sourceName:j,targetName:D,stream:_.START_COMPLETE,streamId:p,reason:z(B)})})}_processStreamMessage(Z){const p=Z.streamId,j=this.sourceName,D=Z.sourceName,m=this.comObj,d=this.streamControllers[p],C=this.streamSinks[p];switch(Z.stream){case _.START_COMPLETE:Z.success?d.startCall.resolve():d.startCall.reject(z(Z.reason));break;case _.PULL_COMPLETE:Z.success?d.pullCall.resolve():d.pullCall.reject(z(Z.reason));break;case _.PULL:if(!C){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,success:!0});break}C.desiredSize<=0&&Z.desiredSize>0&&C.sinkCapability.resolve(),C.desiredSize=Z.desiredSize,new Promise(function(l){l(C.onPull&&C.onPull())}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,success:!0})},function(l){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,reason:z(l)})});break;case _.ENQUEUE:if((0,h.assert)(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(Z.chunk);break;case _.CLOSE:if((0,h.assert)(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this._deleteStreamController(d,p);break;case _.ERROR:(0,h.assert)(d,"error should have stream controller"),d.controller.error(z(Z.reason)),this._deleteStreamController(d,p);break;case _.CANCEL_COMPLETE:Z.success?d.cancelCall.resolve():d.cancelCall.reject(z(Z.reason)),this._deleteStreamController(d,p);break;case _.CANCEL:if(!C)break;new Promise(function(l){l(C.onCancel&&C.onCancel(z(Z.reason)))}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.CANCEL_COMPLETE,streamId:p,success:!0})},function(l){m.postMessage({sourceName:j,targetName:D,stream:_.CANCEL_COMPLETE,streamId:p,reason:z(l)})}),C.sinkCapability.reject(z(Z.reason)),C.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(Z,p){await Promise.allSettled([Z.startCall&&Z.startCall.promise,Z.pullCall&&Z.pullCall.promise,Z.cancelCall&&Z.cancelCall.promise]),delete this.streamControllers[p]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}c.MessageHandler=T},(wI,c,$)=>{var _,z;Object.defineProperty(c,"__esModule",{value:!0}),c.Metadata=void 0;var h=$(1);class M{constructor({parsedData:r,rawData:Z}){zI(this,_,void 0);zI(this,z,void 0);UI(this,_,r),UI(this,z,Z)}getRaw(){return VI(this,z)}get(r){return VI(this,_).get(r)??null}getAll(){return(0,h.objectFromMap)(VI(this,_))}has(r){return VI(this,_).has(r)}}_=new WeakMap,z=new WeakMap,c.Metadata=M},(wI,c,$)=>{var T,r,Z,p,j,D,Dg;Object.defineProperty(c,"__esModule",{value:!0}),c.OptionalContentConfig=void 0;var h=$(1);const M=Symbol("INTERNAL");class _{constructor(C,l){zI(this,T,!0);this.name=C,this.intent=l}get visible(){return VI(this,T)}_setVisible(C,l){C!==M&&(0,h.unreachable)("Internal method `_setVisible` called."),UI(this,T,l)}}T=new WeakMap;class z{constructor(C){zI(this,D);zI(this,r,!0);zI(this,Z,new Map);zI(this,p,null);zI(this,j,null);if(this.name=null,this.creator=null,C!==null){this.name=C.name,this.creator=C.creator,UI(this,j,C.order);for(const l of C.groups)VI(this,Z).set(l.id,new _(l.name,l.intent));if(C.baseState==="OFF")for(const l of VI(this,Z).values())l._setVisible(M,!1);for(const l of C.on)VI(this,Z).get(l)._setVisible(M,!0);for(const l of C.off)VI(this,Z).get(l)._setVisible(M,!1);UI(this,p,new Map);for(const[l,B]of VI(this,Z))VI(this,p).set(l,B.visible)}}isVisible(C){if(VI(this,Z).size===0)return!0;if(!C)return(0,h.warn)("Optional content group not defined."),!0;if(C.type==="OCG")return VI(this,Z).has(C.id)?VI(this,Z).get(C.id).visible:((0,h.warn)(`Optional content group not found: ${C.id}`),!0);if(C.type==="OCMD"){if(C.expression)return jI(this,D,Dg).call(this,C.expression);if(!C.policy||C.policy==="AnyOn"){for(const l of C.ids){if(!VI(this,Z).has(l))return(0,h.warn)(`Optional content group not found: ${l}`),!0;if(VI(this,Z).get(l).visible)return!0}return!1}else if(C.policy==="AllOn"){for(const l of C.ids){if(!VI(this,Z).has(l))return(0,h.warn)(`Optional content group not found: ${l}`),!0;if(!VI(this,Z).get(l).visible)return!1}return!0}else if(C.policy==="AnyOff"){for(const l of C.ids){if(!VI(this,Z).has(l))return(0,h.warn)(`Optional content group not found: ${l}`),!0;if(!VI(this,Z).get(l).visible)return!0}return!1}else if(C.policy==="AllOff"){for(const l of C.ids){if(!VI(this,Z).has(l))return(0,h.warn)(`Optional content group not found: ${l}`),!0;if(VI(this,Z).get(l).visible)return!1}return!0}return(0,h.warn)(`Unknown optional content policy ${C.policy}.`),!0}return(0,h.warn)(`Unknown group type ${C.type}.`),!0}setVisibility(C,l=!0){if(!VI(this,Z).has(C)){(0,h.warn)(`Optional content group not found: ${C}`);return}VI(this,Z).get(C)._setVisible(M,!!l),UI(this,r,null)}get hasInitialVisibility(){if(VI(this,r)!==null)return VI(this,r);for(const[C,l]of VI(this,Z)){const B=VI(this,p).get(C);if(l.visible!==B)return UI(this,r,!1)}return UI(this,r,!0)}getOrder(){return VI(this,Z).size?VI(this,j)?VI(this,j).slice():[...VI(this,Z).keys()]:null}getGroups(){return VI(this,Z).size>0?(0,h.objectFromMap)(VI(this,Z)):null}getGroup(C){return VI(this,Z).get(C)||null}}r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakSet,Dg=function(C){const l=C.length;if(l<2)return!0;const B=C[0];for(let Y=1;Y<l;Y++){const a=C[Y];let i;if(Array.isArray(a))i=jI(this,D,Dg).call(this,a);else if(VI(this,Z).has(a))i=VI(this,Z).get(a).visible;else return(0,h.warn)(`Optional content group not found: ${a}`),!0;switch(B){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return B==="And"},c.OptionalContentConfig=z},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFDataTransportStream=void 0;var h=$(1),M=$(8);class _{constructor(Z,p){(0,h.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=Z.progressiveDone||!1,this._contentDispositionFilename=Z.contentDispositionFilename||null;const j=Z.initialData;if((j==null?void 0:j.length)>0){const D=new Uint8Array(j).buffer;this._queuedChunks.push(D)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!Z.disableStream,this._isRangeSupported=!Z.disableRange,this._contentLength=Z.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((D,m)=>{this._onReceiveData({begin:D,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((D,m)=>{this._onProgress({loaded:D,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(D=>{this._onReceiveData({chunk:D})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(Z){const p=new Uint8Array(Z.chunk).buffer;if(Z.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const j=this._rangeReaders.some(function(D){return D._begin!==Z.begin?!1:(D._enqueue(p),!0)});(0,h.assert)(j,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var Z;return((Z=this._fullRequestReader)==null?void 0:Z._loaded)??0}_onProgress(Z){if(Z.total===void 0){const p=this._rangeReaders[0];p!=null&&p.onProgress&&p.onProgress({loaded:Z.loaded})}else{const p=this._fullRequestReader;p!=null&&p.onProgress&&p.onProgress({loaded:Z.loaded,total:Z.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(Z){const p=this._rangeReaders.indexOf(Z);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,h.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const Z=this._queuedChunks;return this._queuedChunks=null,new z(this,Z,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(Z,p){if(p<=this._progressiveDataLength)return null;const j=new T(this,Z,p);return this._pdfDataRangeTransport.requestDataRange(Z,p),this._rangeReaders.push(j),j}cancelAllRequests(Z){this._fullRequestReader&&this._fullRequestReader.cancel(Z);for(const p of this._rangeReaders.slice(0))p.cancel(Z);this._pdfDataRangeTransport.abort()}}c.PDFDataTransportStream=_;class z{constructor(Z,p,j=!1,D=null){this._stream=Z,this._done=j||!1,this._filename=(0,M.isPdfFile)(D)?D:null,this._queuedChunks=p||[],this._loaded=0;for(const m of this._queuedChunks)this._loaded+=m.byteLength;this._requests=[],this._headersReady=Promise.resolve(),Z._fullRequestReader=this,this.onProgress=null}_enqueue(Z){this._done||(this._requests.length>0?this._requests.shift().resolve({value:Z,done:!1}):this._queuedChunks.push(Z),this._loaded+=Z.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Z=(0,h.createPromiseCapability)();return this._requests.push(Z),Z.promise}cancel(Z){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class T{constructor(Z,p,j){this._stream=Z,this._begin=p,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(Z){if(!this._done){if(this._requests.length===0)this._queuedChunk=Z;else{this._requests.shift().resolve({value:Z,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const Z=(0,h.createPromiseCapability)();return this._requests.push(Z),Z.promise}cancel(Z){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaText=void 0;class ${static textContent(M){const _=[],z={items:_,styles:Object.create(null)};function T(r){var j;if(!r)return;let Z=null;const p=r.name;if(p==="#text")Z=r.value;else if($.shouldBuildText(p))(j=r==null?void 0:r.attributes)!=null&&j.textContent?Z=r.attributes.textContent:r.value&&(Z=r.value);else return;if(Z!==null&&_.push({str:Z}),!!r.children)for(const D of r.children)T(D)}return T(M),z}static shouldBuildText(M){return!(M==="textarea"||M==="input"||M==="option"||M==="select")}}c.XfaText=$},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.NodeStandardFontDataFactory=c.NodeCanvasFactory=c.NodeCMapReaderFactory=void 0;var h=$(9);const M=function(r){return new Promise((Z,p)=>{require$$5$1.readFile(r,(D,m)=>{if(D||!m){p(new Error(D));return}Z(new Uint8Array(m))})})};class _ extends h.BaseCanvasFactory{_createCanvas(Z,p){return require$$5$1.createCanvas(Z,p)}}c.NodeCanvasFactory=_;class z extends h.BaseCMapReaderFactory{_fetchData(Z,p){return M(Z).then(j=>({cMapData:j,compressionType:p}))}}c.NodeCMapReaderFactory=z;class T extends h.BaseStandardFontDataFactory{_fetchData(Z){return M(Z)}}c.NodeStandardFontDataFactory=T},(wI,c,$)=>{var r,Z,p,j,D,m,d,C,l,Hg,Y,Pg,i,Jg,g,_g;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditorLayer=void 0;var h=$(7),M=$(1),_=$(23),z=$(24);const X=class{constructor(N){zI(this,l);zI(this,Y);zI(this,i);zI(this,g);zI(this,r,void 0);zI(this,Z,!1);zI(this,p,this.pointerup.bind(this));zI(this,j,this.pointerdown.bind(this));zI(this,D,new Map);zI(this,m,!1);zI(this,d,!1);zI(this,C,void 0);X._initialized||(X._initialized=!0,_.FreeTextEditor.initialize(N.l10n),z.InkEditor.initialize(N.l10n),N.uiManager.registerEditorTypes([_.FreeTextEditor,z.InkEditor])),UI(this,C,N.uiManager),this.annotationStorage=N.annotationStorage,this.pageIndex=N.pageIndex,this.div=N.div,UI(this,r,N.accessibilityManager),VI(this,C).addLayer(this)}updateToolbar(N){VI(this,C).updateToolbar(N)}updateMode(N=VI(this,C).getMode()){jI(this,g,_g).call(this),N===M.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),VI(this,C).unselectAll()}addInkEditorIfNeeded(N){if(!N&&VI(this,C).getMode()!==M.AnnotationEditorType.INK)return;if(!N){for(const hI of VI(this,D).values())if(hI.isEmpty()){hI.setInBackground();return}}jI(this,i,Jg).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(N){VI(this,C).setEditingState(N)}addCommands(N){VI(this,C).addCommands(N)}enable(){this.div.style.pointerEvents="auto";for(const N of VI(this,D).values())N.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const N of VI(this,D).values())N.disableEditing()}setActiveEditor(N){VI(this,C).getActive()!==N&&VI(this,C).setActiveEditor(N)}enableClick(){this.div.addEventListener("pointerdown",VI(this,j)),this.div.addEventListener("pointerup",VI(this,p))}disableClick(){this.div.removeEventListener("pointerdown",VI(this,j)),this.div.removeEventListener("pointerup",VI(this,p))}attach(N){VI(this,D).set(N.id,N)}detach(N){var F;VI(this,D).delete(N.id),(F=VI(this,r))==null||F.removePointerInTextLayer(N.contentDiv)}remove(N){VI(this,C).removeEditor(N),this.detach(N),this.annotationStorage.remove(N.id),N.div.style.display="none",setTimeout(()=>{N.div.style.display="",N.div.remove(),N.isAttachedToDOM=!1,document.activeElement===document.body&&VI(this,C).focusMainContainer()},0),VI(this,d)||this.addInkEditorIfNeeded(!1)}add(N){if(jI(this,l,Hg).call(this,N),VI(this,C).addEditor(N),this.attach(N),!N.isAttachedToDOM){const F=N.render();this.div.append(F),N.isAttachedToDOM=!0}this.moveEditorInDOM(N),N.onceAdded(),this.addToAnnotationStorage(N)}moveEditorInDOM(N){var F;(F=VI(this,r))==null||F.moveElementInDOM(this.div,N.div,N.contentDiv,!0)}addToAnnotationStorage(N){!N.isEmpty()&&!this.annotationStorage.has(N.id)&&this.annotationStorage.setValue(N.id,N)}addOrRebuild(N){N.needsToBeRebuilt()?N.rebuild():this.add(N)}addANewEditor(N){const F=()=>{this.addOrRebuild(N)},hI=()=>{N.remove()};this.addCommands({cmd:F,undo:hI,mustExec:!0})}addUndoableEditor(N){const F=()=>{this.addOrRebuild(N)},hI=()=>{N.remove()};this.addCommands({cmd:F,undo:hI,mustExec:!1})}getNextId(){return VI(this,C).getId()}deserialize(N){switch(N.annotationType){case M.AnnotationEditorType.FREETEXT:return _.FreeTextEditor.deserialize(N,this);case M.AnnotationEditorType.INK:return z.InkEditor.deserialize(N,this)}return null}setSelected(N){VI(this,C).setSelected(N)}toggleSelected(N){VI(this,C).toggleSelected(N)}isSelected(N){return VI(this,C).isSelected(N)}unselect(N){VI(this,C).unselect(N)}pointerup(N){const F=h.KeyboardManager.platform.isMac;if(!(N.button!==0||N.ctrlKey&&F)&&N.target===this.div&&VI(this,m)){if(UI(this,m,!1),!VI(this,Z)){UI(this,Z,!0);return}jI(this,i,Jg).call(this,N)}}pointerdown(N){const F=h.KeyboardManager.platform.isMac;if(N.button!==0||N.ctrlKey&&F||N.target!==this.div)return;UI(this,m,!0);const hI=VI(this,C).getActive();UI(this,Z,!hI||hI.isEmpty())}drop(N){const F=N.dataTransfer.getData("text/plain"),hI=VI(this,C).getEditor(F);if(!hI)return;N.preventDefault(),N.dataTransfer.dropEffect="move",jI(this,l,Hg).call(this,hI);const YI=this.div.getBoundingClientRect(),nI=N.clientX-YI.x,gI=N.clientY-YI.y;hI.translate(nI-hI.startX,gI-hI.startY),this.moveEditorInDOM(hI),hI.div.focus()}dragover(N){N.preventDefault()}destroy(){var N,F;((N=VI(this,C).getActive())==null?void 0:N.parent)===this&&VI(this,C).setActiveEditor(null);for(const hI of VI(this,D).values())(F=VI(this,r))==null||F.removePointerInTextLayer(hI.contentDiv),hI.isAttachedToDOM=!1,hI.div.remove(),hI.parent=null;this.div=null,VI(this,D).clear(),VI(this,C).removeLayer(this)}render(N){this.viewport=N.viewport,(0,h.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const F of VI(this,C).getEditors(this.pageIndex))this.add(F);this.updateMode()}update(N){this.viewport=N.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[N,F,hI,YI]=this.viewport.viewBox,nI=hI-N,gI=YI-F;return[nI,gI]}get viewportBaseDimensions(){const{width:N,height:F,rotation:hI}=this.viewport;return hI%180===0?[N,F]:[F,N]}setDimensions(){const{width:N,height:F,rotation:hI}=this.viewport,YI=hI%180!==0,nI=Math.floor(N)+"px",gI=Math.floor(F)+"px";this.div.style.width=YI?gI:nI,this.div.style.height=YI?nI:gI,this.div.setAttribute("data-main-rotation",hI)}};let T=X;r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakMap,d=new WeakMap,C=new WeakMap,l=new WeakSet,Hg=function(N){var F;N.parent!==this&&(this.attach(N),N.pageIndex=this.pageIndex,(F=N.parent)==null||F.detach(N),N.parent=this,N.div&&N.isAttachedToDOM&&(N.div.remove(),this.div.append(N.div)))},Y=new WeakSet,Pg=function(N){switch(VI(this,C).getMode()){case M.AnnotationEditorType.FREETEXT:return new _.FreeTextEditor(N);case M.AnnotationEditorType.INK:return new z.InkEditor(N)}return null},i=new WeakSet,Jg=function(N){const F=this.getNextId(),hI=jI(this,Y,Pg).call(this,{parent:this,id:F,x:N.offsetX,y:N.offsetY});return hI&&this.add(hI),hI},g=new WeakSet,_g=function(){UI(this,d,!0);for(const N of VI(this,D).values())N.isEmpty()&&N.remove();UI(this,d,!1)},cg(T,"_initialized",!1),c.AnnotationEditorLayer=T},(wI,c,$)=>{var T,r,Z,p,j,D,m,d,qg,l,$g,Y,IC,i,Sg;Object.defineProperty(c,"__esModule",{value:!0}),c.FreeTextEditor=void 0;var h=$(1),M=$(7),_=$(6);const g=class extends _.AnnotationEditor{constructor(b){super({...b,name:"freeTextEditor"});zI(this,d);zI(this,l);zI(this,Y);zI(this,i);zI(this,T,this.editorDivBlur.bind(this));zI(this,r,this.editorDivFocus.bind(this));zI(this,Z,this.editorDivKeydown.bind(this));zI(this,p,void 0);zI(this,j,"");zI(this,D,!1);zI(this,m,void 0);UI(this,p,b.color||g._defaultColor||_.AnnotationEditor._defaultLineColor),UI(this,m,b.fontSize||g._defaultFontSize)}static initialize(b){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(F=>[F,b.get(F)]));const N=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(N.getPropertyValue("--freetext-padding"))}static updateDefaultParams(b,N){switch(b){case h.AnnotationEditorParamsType.FREETEXT_SIZE:g._defaultFontSize=N;break;case h.AnnotationEditorParamsType.FREETEXT_COLOR:g._defaultColor=N;break}}updateParams(b,N){switch(b){case h.AnnotationEditorParamsType.FREETEXT_SIZE:jI(this,d,qg).call(this,N);break;case h.AnnotationEditorParamsType.FREETEXT_COLOR:jI(this,l,$g).call(this,N);break}}static get defaultPropertiesToUpdate(){return[[h.AnnotationEditorParamsType.FREETEXT_SIZE,g._defaultFontSize],[h.AnnotationEditorParamsType.FREETEXT_COLOR,g._defaultColor||_.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[h.AnnotationEditorParamsType.FREETEXT_SIZE,VI(this,m)],[h.AnnotationEditorParamsType.FREETEXT_COLOR,VI(this,p)]]}getInitialTranslation(){return[-g._internalPadding*this.parent.scaleFactor,-(g._internalPadding+VI(this,m))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(h.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",VI(this,Z)),this.editorDiv.addEventListener("focus",VI(this,r)),this.editorDiv.addEventListener("blur",VI(this,T)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",VI(this,Z)),this.editorDiv.removeEventListener("focus",VI(this,r)),this.editorDiv.removeEventListener("blur",VI(this,T)),this.div.focus(),this.isEditing=!1)}focusin(b){super.focusin(b),b.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),VI(this,D)||(UI(this,D,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),UI(this,j,jI(this,Y,IC).call(this).trimEnd()),jI(this,i,Sg).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(b){this.enableEditMode(),this.editorDiv.focus()}keydown(b){b.target===this.div&&b.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(b){g._keyboardManager.exec(this,b)}editorDivFocus(b){this.isEditing=!0}editorDivBlur(b){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let b,N;this.width&&(b=this.x,N=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),g._l10nPromise.get("editor_free_text_aria_label").then(hI=>{var YI;return(YI=this.editorDiv)==null?void 0:YI.setAttribute("aria-label",hI)}),g._l10nPromise.get("free_text_default_content").then(hI=>{var YI;return(YI=this.editorDiv)==null?void 0:YI.setAttribute("default-content",hI)}),this.editorDiv.contentEditable=!0;const{style:F}=this.editorDiv;if(F.fontSize=`calc(${VI(this,m)}px * var(--scale-factor))`,F.color=VI(this,p),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,M.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[hI,YI]=this.parent.viewportBaseDimensions;this.setAt(b*hI,N*YI,this.width*hI,this.height*YI);for(const nI of VI(this,j).split(`
`)){const gI=document.createElement("div");gI.append(nI?document.createTextNode(nI):document.createElement("br")),this.editorDiv.append(gI)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(b,N){const F=super.deserialize(b,N);return UI(F,m,b.fontSize),UI(F,p,h.Util.makeHexColor(...b.color)),UI(F,j,b.value),F}serialize(){if(this.isEmpty())return null;const b=g._internalPadding*this.parent.scaleFactor,N=this.getRect(b,b),F=_.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:h.AnnotationEditorType.FREETEXT,color:F,fontSize:VI(this,m),value:VI(this,j),pageIndex:this.parent.pageIndex,rect:N,rotation:this.rotation}}};let z=g;T=new WeakMap,r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakMap,d=new WeakSet,qg=function(b){const N=hI=>{this.editorDiv.style.fontSize=`calc(${hI}px * var(--scale-factor))`,this.translate(0,-(hI-VI(this,m))*this.parent.scaleFactor),UI(this,m,hI),jI(this,i,Sg).call(this)},F=VI(this,m);this.parent.addCommands({cmd:()=>{N(b)},undo:()=>{N(F)},mustExec:!0,type:h.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,$g=function(b){const N=VI(this,p);this.parent.addCommands({cmd:()=>{UI(this,p,b),this.editorDiv.style.color=b},undo:()=>{UI(this,p,N),this.editorDiv.style.color=N},mustExec:!0,type:h.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Y=new WeakSet,IC=function(){const b=this.editorDiv.getElementsByTagName("div");if(b.length===0)return this.editorDiv.innerText;const N=[];for(let F=0,hI=b.length;F<hI;F++){const nI=b[F].firstChild;(nI==null?void 0:nI.nodeName)==="#text"?N.push(nI.data):N.push("")}return N.join(`
`)},i=new WeakSet,Sg=function(){const[b,N]=this.parent.viewportBaseDimensions,F=this.div.getBoundingClientRect();this.width=F.width/b,this.height=F.height/N},cg(z,"_freeTextDefaultContent",""),cg(z,"_l10nPromise"),cg(z,"_internalPadding",0),cg(z,"_defaultColor",null),cg(z,"_defaultFontSize",10),cg(z,"_keyboardManager",new M.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],g.prototype.commitOrRemove]])),cg(z,"_type","freetext"),c.FreeTextEditor=z},(wI,c,$)=>{var Z,p,j,D,m,d,C,l,B,Y,a,i,I,g,o,gC,b,CC,F,AC,YI,iC,gI,Lg,II,lC,mI,sC,BI,dC,e,bg,x,Fg,P,Yg,aI,Vg,A,ag,L,rg,Q,Ng,uI,kg,ZI,cC,tI,oC,f,ZC,RI,zg,DI,Xg,TI,tg,fI,Tg;Object.defineProperty(c,"__esModule",{value:!0}),c.InkEditor=void 0,Object.defineProperty(c,"fitCurve",{enumerable:!0,get:function(){return _.fitCurve}});var h=$(1),M=$(6),_=$(25),z=$(7);const T=16,EI=class extends M.AnnotationEditor{constructor(yI){super({...yI,name:"inkEditor"});zI(this,o);zI(this,b);zI(this,F);zI(this,YI);zI(this,gI);zI(this,II);zI(this,mI);zI(this,BI);zI(this,e);zI(this,x);zI(this,P);zI(this,aI);zI(this,A);zI(this,L);zI(this,Q);zI(this,ZI);zI(this,tI);zI(this,f);zI(this,RI);zI(this,DI);zI(this,TI);zI(this,fI);zI(this,Z,0);zI(this,p,0);zI(this,j,0);zI(this,D,this.canvasPointermove.bind(this));zI(this,m,this.canvasPointerleave.bind(this));zI(this,d,this.canvasPointerup.bind(this));zI(this,C,this.canvasPointerdown.bind(this));zI(this,l,!1);zI(this,B,!1);zI(this,Y,null);zI(this,a,null);zI(this,i,0);zI(this,I,0);zI(this,g,null);this.color=yI.color||null,this.thickness=yI.thickness||null,this.opacity=yI.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(yI){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(HI=>[HI,yI.get(HI)]))}static updateDefaultParams(yI,HI){switch(yI){case h.AnnotationEditorParamsType.INK_THICKNESS:EI._defaultThickness=HI;break;case h.AnnotationEditorParamsType.INK_COLOR:EI._defaultColor=HI;break;case h.AnnotationEditorParamsType.INK_OPACITY:EI._defaultOpacity=HI/100;break}}updateParams(yI,HI){switch(yI){case h.AnnotationEditorParamsType.INK_THICKNESS:jI(this,o,gC).call(this,HI);break;case h.AnnotationEditorParamsType.INK_COLOR:jI(this,b,CC).call(this,HI);break;case h.AnnotationEditorParamsType.INK_OPACITY:jI(this,F,AC).call(this,HI);break}}static get defaultPropertiesToUpdate(){return[[h.AnnotationEditorParamsType.INK_THICKNESS,EI._defaultThickness],[h.AnnotationEditorParamsType.INK_COLOR,EI._defaultColor||M.AnnotationEditor._defaultLineColor],[h.AnnotationEditorParamsType.INK_OPACITY,Math.round(EI._defaultOpacity*100)]]}get propertiesToUpdate(){return[[h.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||EI._defaultThickness],[h.AnnotationEditorParamsType.INK_COLOR,this.color||EI._defaultColor||M.AnnotationEditor._defaultLineColor],[h.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??EI._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(jI(this,P,Yg).call(this),jI(this,aI,Vg).call(this)),this.isAttachedToDOM||(this.parent.add(this),jI(this,A,ag).call(this)),jI(this,TI,tg).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,VI(this,a).disconnect(),UI(this,a,null),super.remove())}enableEditMode(){VI(this,l)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",VI(this,C)),this.canvas.addEventListener("pointerup",VI(this,d)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",VI(this,C)),this.canvas.removeEventListener("pointerup",VI(this,d)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){VI(this,l)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),UI(this,l,!0),this.div.classList.add("disabled"),jI(this,TI,tg).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(yI){super.focusin(yI),this.enableEditMode()}canvasPointerdown(yI){yI.button!==0||!this.isInEditMode()||VI(this,l)||(this.setInForeground(),yI.type!=="mouse"&&this.div.focus(),yI.stopPropagation(),this.canvas.addEventListener("pointerleave",VI(this,m)),this.canvas.addEventListener("pointermove",VI(this,D)),jI(this,II,lC).call(this,yI.offsetX,yI.offsetY))}canvasPointermove(yI){yI.stopPropagation(),jI(this,mI,sC).call(this,yI.offsetX,yI.offsetY)}canvasPointerup(yI){yI.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(yI.stopPropagation(),jI(this,x,Fg).call(this,yI),this.setInBackground())}canvasPointerleave(yI){jI(this,x,Fg).call(this,yI),this.setInBackground()}render(){if(this.div)return this.div;let yI,HI;this.width&&(yI=this.x,HI=this.y),super.render(),EI._l10nPromise.get("editor_ink_aria_label").then(LI=>{var rI;return(rI=this.div)==null?void 0:rI.setAttribute("aria-label",LI)});const[cI,CI,AI,KI]=jI(this,YI,iC).call(this);if(this.setAt(cI,CI,0,0),this.setDims(AI,KI),jI(this,P,Yg).call(this),this.width){const[LI,rI]=this.parent.viewportBaseDimensions;this.setAt(yI*LI,HI*rI,this.width*LI,this.height*rI),UI(this,B,!0),jI(this,A,ag).call(this),this.setDims(this.width*LI,this.height*rI),jI(this,e,bg).call(this),jI(this,fI,Tg).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return jI(this,aI,Vg).call(this),this.div}setDimensions(yI,HI){const cI=Math.round(yI),CI=Math.round(HI);if(VI(this,i)===cI&&VI(this,I)===CI)return;UI(this,i,cI),UI(this,I,CI),this.canvas.style.visibility="hidden",VI(this,Z)&&Math.abs(VI(this,Z)-yI/HI)>.01&&(HI=Math.ceil(yI/VI(this,Z)),this.setDims(yI,HI));const[AI,KI]=this.parent.viewportBaseDimensions;this.width=yI/AI,this.height=HI/KI,VI(this,l)&&jI(this,L,rg).call(this,yI,HI),jI(this,A,ag).call(this),jI(this,e,bg).call(this),this.canvas.style.visibility="visible"}static deserialize(yI,HI){var _I,$I;const cI=super.deserialize(yI,HI);cI.thickness=yI.thickness,cI.color=h.Util.makeHexColor(...yI.color),cI.opacity=yI.opacity;const[CI,AI]=HI.pageDimensions,KI=cI.width*CI,LI=cI.height*AI,rI=HI.scaleFactor,kI=yI.thickness/2;UI(cI,Z,KI/LI),UI(cI,l,!0),UI(cI,i,Math.round(KI)),UI(cI,I,Math.round(LI));for(const{bezier:OI}of yI.paths){const gg=[];cI.paths.push(gg);let Ig=rI*(OI[0]-kI),Ag=rI*(LI-OI[1]-kI);for(let lg=2,ig=OI.length;lg<ig;lg+=6){const og=rI*(OI[lg]-kI),Zg=rI*(LI-OI[lg+1]-kI),sg=rI*(OI[lg+2]-kI),Cg=rI*(LI-OI[lg+3]-kI),dg=rI*(OI[lg+4]-kI),Gg=rI*(LI-OI[lg+5]-kI);gg.push([[Ig,Ag],[og,Zg],[sg,Cg],[dg,Gg]]),Ig=dg,Ag=Gg}const qI=jI(this,uI,kg).call(this,gg);cI.bezierPath2D.push(qI)}const xI=jI(_I=cI,RI,zg).call(_I);return UI(cI,j,Math.max(T,xI[2]-xI[0])),UI(cI,p,Math.max(T,xI[3]-xI[1])),jI($I=cI,L,rg).call($I,KI,LI),cI}serialize(){if(this.isEmpty())return null;const yI=this.getRect(0,0),HI=this.rotation%180===0?yI[3]-yI[1]:yI[2]-yI[0],cI=M.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:h.AnnotationEditorType.INK,color:cI,thickness:this.thickness,opacity:this.opacity,paths:jI(this,ZI,cC).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,HI),pageIndex:this.parent.pageIndex,rect:yI,rotation:this.rotation}}};let r=EI;Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakMap,d=new WeakMap,C=new WeakMap,l=new WeakMap,B=new WeakMap,Y=new WeakMap,a=new WeakMap,i=new WeakMap,I=new WeakMap,g=new WeakMap,o=new WeakSet,gC=function(yI){const HI=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=yI,jI(this,TI,tg).call(this)},undo:()=>{this.thickness=HI,jI(this,TI,tg).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},b=new WeakSet,CC=function(yI){const HI=this.color;this.parent.addCommands({cmd:()=>{this.color=yI,jI(this,e,bg).call(this)},undo:()=>{this.color=HI,jI(this,e,bg).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},F=new WeakSet,AC=function(yI){yI/=100;const HI=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=yI,jI(this,e,bg).call(this)},undo:()=>{this.opacity=HI,jI(this,e,bg).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},YI=new WeakSet,iC=function(){const{width:yI,height:HI,rotation:cI}=this.parent.viewport;switch(cI){case 90:return[0,yI,yI,HI];case 180:return[yI,HI,yI,HI];case 270:return[HI,0,yI,HI];default:return[0,0,yI,HI]}},gI=new WeakSet,Lg=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,z.opacityToHex)(this.opacity)}`},II=new WeakSet,lC=function(yI,HI){this.isEditing=!0,VI(this,B)||(UI(this,B,!0),jI(this,A,ag).call(this),this.thickness||(this.thickness=EI._defaultThickness),this.color||(this.color=EI._defaultColor||M.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=EI._defaultOpacity)),this.currentPath.push([yI,HI]),UI(this,Y,null),jI(this,gI,Lg).call(this),this.ctx.beginPath(),this.ctx.moveTo(yI,HI),UI(this,g,()=>{VI(this,g)&&(VI(this,Y)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):jI(this,e,bg).call(this),this.ctx.lineTo(...VI(this,Y)),UI(this,Y,null),this.ctx.stroke()),window.requestAnimationFrame(VI(this,g)))}),window.requestAnimationFrame(VI(this,g))},mI=new WeakSet,sC=function(yI,HI){const[cI,CI]=this.currentPath.at(-1);yI===cI&&HI===CI||(this.currentPath.push([yI,HI]),UI(this,Y,[yI,HI]))},BI=new WeakSet,dC=function(yI,HI){var kI;this.ctx.closePath(),UI(this,g,null),yI=Math.min(Math.max(yI,0),this.canvas.width),HI=Math.min(Math.max(HI,0),this.canvas.height);const[cI,CI]=this.currentPath.at(-1);(yI!==cI||HI!==CI)&&this.currentPath.push([yI,HI]);let AI;if(this.currentPath.length!==1)AI=(0,_.fitCurve)(this.currentPath,30,null);else{const xI=[yI,HI];AI=[[xI,xI.slice(),xI.slice(),xI]]}const KI=jI(kI=EI,uI,kg).call(kI,AI);this.currentPath.length=0;const LI=()=>{this.paths.push(AI),this.bezierPath2D.push(KI),this.rebuild()},rI=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(jI(this,P,Yg).call(this),jI(this,aI,Vg).call(this)),jI(this,TI,tg).call(this))};this.parent.addCommands({cmd:LI,undo:rI,mustExec:!0})},e=new WeakSet,bg=function(){if(this.isEmpty()){jI(this,Q,Ng).call(this);return}jI(this,gI,Lg).call(this);const{canvas:yI,ctx:HI}=this;HI.setTransform(1,0,0,1,0,0),HI.clearRect(0,0,yI.width,yI.height),jI(this,Q,Ng).call(this);for(const cI of this.bezierPath2D)HI.stroke(cI)},x=new WeakSet,Fg=function(yI){jI(this,BI,dC).call(this,yI.offsetX,yI.offsetY),this.canvas.removeEventListener("pointerleave",VI(this,m)),this.canvas.removeEventListener("pointermove",VI(this,D)),this.parent.addToAnnotationStorage(this)},P=new WeakSet,Yg=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",EI._l10nPromise.get("editor_ink_canvas_aria_label").then(yI=>{var HI;return(HI=this.canvas)==null?void 0:HI.setAttribute("aria-label",yI)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},aI=new WeakSet,Vg=function(){UI(this,a,new ResizeObserver(yI=>{const HI=yI[0].contentRect;HI.width&&HI.height&&this.setDimensions(HI.width,HI.height)})),VI(this,a).observe(this.div)},A=new WeakSet,ag=function(){if(!VI(this,B))return;const[yI,HI]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*yI),this.canvas.height=Math.ceil(this.height*HI),jI(this,Q,Ng).call(this)},L=new WeakSet,rg=function(yI,HI){const cI=jI(this,DI,Xg).call(this),CI=(yI-cI)/VI(this,j),AI=(HI-cI)/VI(this,p);this.scaleFactor=Math.min(CI,AI)},Q=new WeakSet,Ng=function(){const yI=jI(this,DI,Xg).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+yI,this.translationY*this.scaleFactor+yI)},uI=new WeakSet,kg=function(yI){const HI=new Path2D;for(let cI=0,CI=yI.length;cI<CI;cI++){const[AI,KI,LI,rI]=yI[cI];cI===0&&HI.moveTo(...AI),HI.bezierCurveTo(KI[0],KI[1],LI[0],LI[1],rI[0],rI[1])}return HI},ZI=new WeakSet,cC=function(yI,HI,cI,CI){const KI=[],LI=this.thickness/2;let rI,kI;for(const xI of this.paths){rI=[],kI=[];for(let _I=0,$I=xI.length;_I<$I;_I++){const[OI,gg,Ig,Ag]=xI[_I],qI=yI*(OI[0]+HI)+LI,lg=CI-yI*(OI[1]+cI)-LI,ig=yI*(gg[0]+HI)+LI,og=CI-yI*(gg[1]+cI)-LI,Zg=yI*(Ig[0]+HI)+LI,sg=CI-yI*(Ig[1]+cI)-LI,Cg=yI*(Ag[0]+HI)+LI,dg=CI-yI*(Ag[1]+cI)-LI;_I===0&&(rI.push(qI,lg),kI.push(qI,lg)),rI.push(ig,og,Zg,sg,Cg,dg),jI(this,tI,oC).call(this,qI,lg,ig,og,Zg,sg,Cg,dg,4,kI)}KI.push({bezier:rI,points:kI})}return KI},tI=new WeakSet,oC=function(yI,HI,cI,CI,AI,KI,LI,rI,kI,xI){if(jI(this,f,ZC).call(this,yI,HI,cI,CI,AI,KI,LI,rI)){xI.push(LI,rI);return}for(let _I=1;_I<kI-1;_I++){const $I=_I/kI,OI=1-$I;let gg=$I*yI+OI*cI,Ig=$I*HI+OI*CI,Ag=$I*cI+OI*AI,qI=$I*CI+OI*KI;const lg=$I*AI+OI*LI,ig=$I*KI+OI*rI;gg=$I*gg+OI*Ag,Ig=$I*Ig+OI*qI,Ag=$I*Ag+OI*lg,qI=$I*qI+OI*ig,gg=$I*gg+OI*Ag,Ig=$I*Ig+OI*qI,xI.push(gg,Ig)}xI.push(LI,rI)},f=new WeakSet,ZC=function(yI,HI,cI,CI,AI,KI,LI,rI){const xI=(3*cI-2*yI-LI)**2,_I=(3*CI-2*HI-rI)**2,$I=(3*AI-yI-2*LI)**2,OI=(3*KI-HI-2*rI)**2;return Math.max(xI,$I)+Math.max(_I,OI)<=10},RI=new WeakSet,zg=function(){let yI=1/0,HI=-1/0,cI=1/0,CI=-1/0;for(const AI of this.paths)for(const[KI,LI,rI,kI]of AI){const xI=h.Util.bezierBoundingBox(...KI,...LI,...rI,...kI);yI=Math.min(yI,xI[0]),cI=Math.min(cI,xI[1]),HI=Math.max(HI,xI[2]),CI=Math.max(CI,xI[3])}return[yI,cI,HI,CI]},DI=new WeakSet,Xg=function(){return VI(this,l)?Math.ceil(this.thickness*this.parent.scaleFactor):0},TI=new WeakSet,tg=function(yI=!1){if(this.isEmpty())return;if(!VI(this,l)){jI(this,e,bg).call(this);return}const HI=jI(this,RI,zg).call(this),cI=jI(this,DI,Xg).call(this);UI(this,j,Math.max(T,HI[2]-HI[0])),UI(this,p,Math.max(T,HI[3]-HI[1]));const CI=Math.ceil(cI+VI(this,j)*this.scaleFactor),AI=Math.ceil(cI+VI(this,p)*this.scaleFactor),[KI,LI]=this.parent.viewportBaseDimensions;this.width=CI/KI,this.height=AI/LI,UI(this,Z,CI/AI),jI(this,fI,Tg).call(this);const rI=this.translationX,kI=this.translationY;this.translationX=-HI[0],this.translationY=-HI[1],jI(this,A,ag).call(this),jI(this,e,bg).call(this),UI(this,i,CI),UI(this,I,AI),this.setDims(CI,AI);const xI=yI?cI/this.scaleFactor/2:0;this.translate(rI-this.translationX-xI,kI-this.translationY-xI)},fI=new WeakSet,Tg=function(){const{style:yI}=this.div;VI(this,Z)>=1?(yI.minHeight=`${T}px`,yI.minWidth=`${Math.round(VI(this,Z)*T)}px`):(yI.minWidth=`${T}px`,yI.minHeight=`${Math.round(T/VI(this,Z))}px`)},zI(r,uI),cg(r,"_defaultColor",null),cg(r,"_defaultOpacity",1),cg(r,"_defaultThickness",1),cg(r,"_l10nPromise"),cg(r,"_type","ink"),c.InkEditor=r},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.fitCurve=void 0;const h=$(26);c.fitCurve=h},wI=>{function c(d,C,l){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(i=>{if(!Array.isArray(i)||i.some(I=>typeof I!="number")||i.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),d=d.filter((i,I)=>I===0||!i.every((g,o)=>g===d[I-1][o])),d.length<2)return[];const B=d.length,Y=j(d[1],d[0]),a=j(d[B-2],d[B-1]);return $(d,Y,a,C,l)}function $(d,C,l,B,Y){var i,I,g,o,X,b,N,F,hI,YI,nI,gI,U;if(d.length===2)return gI=D.vectorLen(D.subtract(d[0],d[1]))/3,i=[d[0],D.addArrays(d[0],D.mulItems(C,gI)),D.addArrays(d[1],D.mulItems(l,gI)),d[1]],[i];if(I=T(d),[i,o,b]=h(d,I,I,C,l,Y),o===0||o<B)return[i];if(o<B*B)for(g=I,X=o,N=b,U=0;U<20;U++){if(g=_(i,d,g),[i,o,b]=h(d,I,g,C,l,Y),o<B)return[i];if(b===N){let II=o/X;if(II>.9999&&II<1.0001)break}X=o,N=b}return nI=[],F=D.subtract(d[b-1],d[b+1]),F.every(II=>II===0)&&(F=D.subtract(d[b-1],d[b]),[F[0],F[1]]=[-F[1],F[0]]),hI=D.normalize(F),YI=D.mulItems(hI,-1),nI=nI.concat($(d.slice(0,b+1),C,hI,B,Y)),nI=nI.concat($(d.slice(b),YI,l,B,Y)),nI}function h(d,C,l,B,Y,a){var i,I,g;return i=M(d,l,B,Y),[I,g]=r(d,i,C),a&&a({bez:i,points:d,params:C,maxErr:I,maxPoint:g}),[i,I,g]}function M(d,C,l,B){var Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI=d[0],NI=d[d.length-1];for(Y=[mI,null,null,NI],a=D.zeros_Xx2x2(C.length),nI=0,gI=C.length;nI<gI;nI++)II=C[nI],q=1-II,i=a[nI],i[0]=D.mulItems(l,3*II*(q*q)),i[1]=D.mulItems(B,3*q*(II*II));for(I=[[0,0],[0,0]],g=[0,0],nI=0,gI=d.length;nI<gI;nI++)II=C[nI],i=a[nI],I[0][0]+=D.dot(i[0],i[0]),I[0][1]+=D.dot(i[0],i[1]),I[1][0]+=D.dot(i[0],i[1]),I[1][1]+=D.dot(i[1],i[1]),U=D.subtract(d[nI],m.q([mI,mI,NI,NI],II)),g[0]+=D.dot(i[0],U),g[1]+=D.dot(i[1],U);return o=I[0][0]*I[1][1]-I[1][0]*I[0][1],X=I[0][0]*g[1]-I[1][0]*g[0],b=g[0]*I[1][1]-g[1]*I[0][1],N=o===0?0:b/o,F=o===0?0:X/o,YI=D.vectorLen(D.subtract(mI,NI)),hI=1e-6*YI,N<hI||F<hI?(Y[1]=D.addArrays(mI,D.mulItems(l,YI/3)),Y[2]=D.addArrays(NI,D.mulItems(B,YI/3))):(Y[1]=D.addArrays(mI,D.mulItems(l,N)),Y[2]=D.addArrays(NI,D.mulItems(B,F))),Y}function _(d,C,l){return l.map((B,Y)=>z(d,C[Y],B))}function z(d,C,l){var B=D.subtract(m.q(d,l),C),Y=m.qprime(d,l),a=D.mulMatrix(B,Y),i=D.sum(D.squareItems(Y))+2*D.mulMatrix(B,m.qprimeprime(d,l));return i===0?l:l-a/i}function T(d){var C=[],l,B,Y;return d.forEach((a,i)=>{l=i?B+D.vectorLen(D.subtract(a,Y)):0,C.push(l),B=l,Y=a}),C=C.map(a=>a/B),C}function r(d,C,l){var B,Y,a,i,I,g,o,X;Y=0,a=Math.floor(d.length/2);const b=Z(C,10);for(I=0,g=d.length;I<g;I++)o=d[I],X=p(C,l[I],b,10),i=D.subtract(m.q(C,X),o),B=i[0]*i[0]+i[1]*i[1],B>Y&&(Y=B,a=I);return[Y,a]}var Z=function(d,C){for(var l,B=[0],Y=d[0],a=0,i=1;i<=C;i++)l=m.q(d,i/C),a+=D.vectorLen(D.subtract(l,Y)),B.push(a),Y=l;return B=B.map(I=>I/a),B};function p(d,C,l,B){if(C<0)return 0;if(C>1)return 1;for(var Y,a,i,I,g,o=1;o<=B;o++)if(C<=l[o]){I=(o-1)/B,i=o/B,a=l[o-1],Y=l[o],g=(C-a)/(Y-a)*(i-I)+I;break}return g}function j(d,C){return D.normalize(D.subtract(d,C))}class D{static zeros_Xx2x2(C){for(var l=[];C--;)l.push([0,0]);return l}static mulItems(C,l){return C.map(B=>B*l)}static mulMatrix(C,l){return C.reduce((B,Y,a)=>B+Y*l[a],0)}static subtract(C,l){return C.map((B,Y)=>B-l[Y])}static addArrays(C,l){return C.map((B,Y)=>B+l[Y])}static addItems(C,l){return C.map(B=>B+l)}static sum(C){return C.reduce((l,B)=>l+B)}static dot(C,l){return D.mulMatrix(C,l)}static vectorLen(C){return Math.hypot(...C)}static divItems(C,l){return C.map(B=>B/l)}static squareItems(C){return C.map(l=>l*l)}static normalize(C){return this.divItems(C,this.vectorLen(C))}}class m{static q(C,l){var B=1-l,Y=D.mulItems(C[0],B*B*B),a=D.mulItems(C[1],3*B*B*l),i=D.mulItems(C[2],3*B*l*l),I=D.mulItems(C[3],l*l*l);return D.addArrays(D.addArrays(Y,a),D.addArrays(i,I))}static qprime(C,l){var B=1-l,Y=D.mulItems(D.subtract(C[1],C[0]),3*B*B),a=D.mulItems(D.subtract(C[2],C[1]),6*B*l),i=D.mulItems(D.subtract(C[3],C[2]),3*l*l);return D.addArrays(D.addArrays(Y,a),i)}static qprimeprime(C,l){return D.addArrays(D.mulItems(D.addArrays(D.subtract(C[2],D.mulItems(C[1],2)),C[0]),6*(1-l)),D.mulItems(D.addArrays(D.subtract(C[3],D.mulItems(C[2],2)),C[1]),6*l))}}wI.exports=c,wI.exports.fitCubic=$,wI.exports.createTangent=j},(wI,c,$)=>{var e,jg,x,xg,P,Qg;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationLayer=void 0;var h=$(1),M=$(8),_=$(5),z=$(28),T=$(29);const r=1e3,Z=9,p=new WeakSet;function j(eI){return{width:eI[2]-eI[0],height:eI[3]-eI[1]}}class D{static create(A){switch(A.data.annotationType){case h.AnnotationType.LINK:return new d(A);case h.AnnotationType.TEXT:return new C(A);case h.AnnotationType.WIDGET:switch(A.data.fieldType){case"Tx":return new B(A);case"Btn":return A.data.radioButton?new a(A):A.data.checkBox?new Y(A):new i(A);case"Ch":return new I(A)}return new l(A);case h.AnnotationType.POPUP:return new g(A);case h.AnnotationType.FREETEXT:return new X(A);case h.AnnotationType.LINE:return new b(A);case h.AnnotationType.SQUARE:return new N(A);case h.AnnotationType.CIRCLE:return new F(A);case h.AnnotationType.POLYLINE:return new hI(A);case h.AnnotationType.CARET:return new nI(A);case h.AnnotationType.INK:return new gI(A);case h.AnnotationType.POLYGON:return new YI(A);case h.AnnotationType.HIGHLIGHT:return new U(A);case h.AnnotationType.UNDERLINE:return new II(A);case h.AnnotationType.SQUIGGLY:return new q(A);case h.AnnotationType.STRIKEOUT:return new mI(A);case h.AnnotationType.STAMP:return new NI(A);case h.AnnotationType.FILEATTACHMENT:return new BI(A);default:return new m(A)}}}class m{constructor(A,{isRenderable:W=!1,ignoreBorder:L=!1,createQuadrilaterals:S=!1}={}){this.isRenderable=W,this.data=A.data,this.layer=A.layer,this.page=A.page,this.viewport=A.viewport,this.linkService=A.linkService,this.downloadManager=A.downloadManager,this.imageResourcesPath=A.imageResourcesPath,this.renderForms=A.renderForms,this.svgFactory=A.svgFactory,this.annotationStorage=A.annotationStorage,this.enableScripting=A.enableScripting,this.hasJSActions=A.hasJSActions,this._fieldObjects=A.fieldObjects,this._mouseState=A.mouseState,W&&(this.container=this._createContainer(L)),S&&(this.quadrilaterals=this._createQuadrilaterals(L))}_createContainer(A=!1){const W=this.data,L=this.page,S=this.viewport,Q=document.createElement("section"),{width:lI,height:uI}=j(W.rect),[MI,ZI,WI,tI]=S.viewBox,O=WI-MI,f=tI-ZI;Q.setAttribute("data-annotation-id",W.id);const v=h.Util.normalizeRect([W.rect[0],L.view[3]-W.rect[1]+L.view[1],W.rect[2],L.view[3]-W.rect[3]+L.view[1]]);if(!A&&W.borderStyle.width>0){Q.style.borderWidth=`${W.borderStyle.width}px`;const pI=W.borderStyle.horizontalCornerRadius,DI=W.borderStyle.verticalCornerRadius;if(pI>0||DI>0){const TI=`calc(${pI}px * var(--scale-factor)) / calc(${DI}px * var(--scale-factor))`;Q.style.borderRadius=TI}else if(this instanceof a){const TI=`calc(${lI}px * var(--scale-factor)) / calc(${uI}px * var(--scale-factor))`;Q.style.borderRadius=TI}switch(W.borderStyle.style){case h.AnnotationBorderStyleType.SOLID:Q.style.borderStyle="solid";break;case h.AnnotationBorderStyleType.DASHED:Q.style.borderStyle="dashed";break;case h.AnnotationBorderStyleType.BEVELED:(0,h.warn)("Unimplemented border style: beveled");break;case h.AnnotationBorderStyleType.INSET:(0,h.warn)("Unimplemented border style: inset");break;case h.AnnotationBorderStyleType.UNDERLINE:Q.style.borderBottomStyle="solid";break}const FI=W.borderColor||null;FI?Q.style.borderColor=h.Util.makeHexColor(FI[0]|0,FI[1]|0,FI[2]|0):Q.style.borderWidth=0}Q.style.left=`${100*(v[0]-MI)/O}%`,Q.style.top=`${100*(v[1]-ZI)/f}%`;const{rotation:RI}=W;return W.hasOwnCanvas||RI===0?(Q.style.width=`${100*lI/O}%`,Q.style.height=`${100*uI/f}%`):this.setRotation(RI,Q),Q}setRotation(A,W=this.container){const[L,S,Q,lI]=this.viewport.viewBox,uI=Q-L,MI=lI-S,{width:ZI,height:WI}=j(this.data.rect);let tI,O;A%180===0?(tI=100*ZI/uI,O=100*WI/MI):(tI=100*WI/uI,O=100*ZI/MI),W.style.width=`${tI}%`,W.style.height=`${O}%`,W.setAttribute("data-main-rotation",(360-A)%360)}get _commonActions(){const A=(W,L,S)=>{const Q=S.detail[W];S.target.style[L]=z.ColorConverters[`${Q[0]}_HTML`](Q.slice(1))};return(0,h.shadow)(this,"_commonActions",{display:W=>{const L=W.detail.display%2===1;this.container.style.visibility=L?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:L,print:W.detail.display===0||W.detail.display===3})},print:W=>{this.annotationStorage.setValue(this.data.id,{print:W.detail.print})},hidden:W=>{this.container.style.visibility=W.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:W.detail.hidden})},focus:W=>{setTimeout(()=>W.target.focus({preventScroll:!1}),0)},userName:W=>{W.target.title=W.detail.userName},readonly:W=>{W.detail.readonly?W.target.setAttribute("readonly",""):W.target.removeAttribute("readonly")},required:W=>{this._setRequired(W.target,W.detail.required)},bgColor:W=>{A("bgColor","backgroundColor",W)},fillColor:W=>{A("fillColor","backgroundColor",W)},fgColor:W=>{A("fgColor","color",W)},textColor:W=>{A("textColor","color",W)},borderColor:W=>{A("borderColor","borderColor",W)},strokeColor:W=>{A("strokeColor","borderColor",W)},rotation:W=>{const L=W.detail.rotation;this.setRotation(L),this.annotationStorage.setValue(this.data.id,{rotation:L})}})}_dispatchEventFromSandbox(A,W){const L=this._commonActions;for(const S of Object.keys(W.detail)){const Q=A[S]||L[S];Q&&Q(W)}}_setDefaultPropertiesFromJS(A){if(!this.enableScripting)return;const W=this.annotationStorage.getRawValue(this.data.id);if(!W)return;const L=this._commonActions;for(const[S,Q]of Object.entries(W)){const lI=L[S];if(lI){const uI={detail:{[S]:Q},target:A};lI(uI),delete W[S]}}}_createQuadrilaterals(A=!1){if(!this.data.quadPoints)return null;const W=[],L=this.data.rect;for(const S of this.data.quadPoints)this.data.rect=[S[2].x,S[2].y,S[1].x,S[1].y],W.push(this._createContainer(A));return this.data.rect=L,W}_createPopup(A,W){let L=this.container;this.quadrilaterals&&(A=A||this.quadrilaterals,L=this.quadrilaterals[0]),A||(A=document.createElement("div"),A.className="popupTriggerArea",L.append(A));const Q=new o({container:L,trigger:A,color:W.color,titleObj:W.titleObj,modificationDate:W.modificationDate,contentsObj:W.contentsObj,richText:W.richText,hideWrapper:!0}).render();Q.style.left="100%",L.append(Q)}_renderQuadrilaterals(A){for(const W of this.quadrilaterals)W.className=A;return this.quadrilaterals}render(){(0,h.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(A,W=null){const L=[];if(this._fieldObjects){const S=this._fieldObjects[A];if(S)for(const{page:Q,id:lI,exportValues:uI}of S){if(Q===-1||lI===W)continue;const MI=typeof uI=="string"?uI:null,ZI=document.querySelector(`[data-element-id="${lI}"]`);if(ZI&&!p.has(ZI)){(0,h.warn)(`_getElementsByName - element not allowed: ${lI}`);continue}L.push({id:lI,exportValue:MI,domElement:ZI})}return L}for(const S of document.getElementsByName(A)){const{id:Q,exportValue:lI}=S;Q!==W&&p.has(S)&&L.push({id:Q,exportValue:lI,domElement:S})}return L}static get platform(){const A=typeof navigator<"u"?navigator.platform:"";return(0,h.shadow)(this,"platform",{isWin:A.includes("Win"),isMac:A.includes("Mac")})}}class d extends m{constructor(A,W=null){super(A,{isRenderable:!0,ignoreBorder:!!(W!=null&&W.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=A.data.isTooltipOnly}render(){const{data:A,linkService:W}=this,L=document.createElement("a");L.setAttribute("data-element-id",A.id);let S=!1;return A.url?(W.addLinkAttributes(L,A.url,A.newWindow),S=!0):A.action?(this._bindNamedAction(L,A.action),S=!0):A.dest?(this._bindLink(L,A.dest),S=!0):(A.actions&&(A.actions.Action||A.actions["Mouse Up"]||A.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(L,A),S=!0),A.resetForm?(this._bindResetFormAction(L,A.resetForm),S=!0):this.isTooltipOnly&&!S&&(this._bindLink(L,""),S=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((Q,lI)=>{const uI=lI===0?L:L.cloneNode();return Q.append(uI),Q}):(this.container.className="linkAnnotation",S&&this.container.append(L),this.container)}_bindLink(A,W){A.href=this.linkService.getDestinationHash(W),A.onclick=()=>(W&&this.linkService.goToDestination(W),!1),(W||W==="")&&(A.className="internalLink")}_bindNamedAction(A,W){A.href=this.linkService.getAnchorUrl(""),A.onclick=()=>(this.linkService.executeNamedAction(W),!1),A.className="internalLink"}_bindJSAction(A,W){A.href=this.linkService.getAnchorUrl("");const L=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const S of Object.keys(W.actions)){const Q=L.get(S);Q&&(A[Q]=()=>{var lI;return(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W.id,name:S}}),!1})}A.onclick||(A.onclick=()=>!1),A.className="internalLink"}_bindResetFormAction(A,W){const L=A.onclick;if(L||(A.href=this.linkService.getAnchorUrl("")),A.className="internalLink",!this._fieldObjects){(0,h.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),L||(A.onclick=()=>!1);return}A.onclick=()=>{var WI;L&&L();const{fields:S,refs:Q,include:lI}=W,uI=[];if(S.length!==0||Q.length!==0){const tI=new Set(Q);for(const O of S){const f=this._fieldObjects[O]||[];for(const{id:v}of f)tI.add(v)}for(const O of Object.values(this._fieldObjects))for(const f of O)tI.has(f.id)===lI&&uI.push(f)}else for(const tI of Object.values(this._fieldObjects))uI.push(...tI);const MI=this.annotationStorage,ZI=[];for(const tI of uI){const{id:O}=tI;switch(ZI.push(O),tI.type){case"text":{const v=tI.defaultValue||"";MI.setValue(O,{value:v});break}case"checkbox":case"radiobutton":{const v=tI.defaultValue===tI.exportValues;MI.setValue(O,{value:v});break}case"combobox":case"listbox":{const v=tI.defaultValue||"";MI.setValue(O,{value:v});break}default:continue}const f=document.querySelector(`[data-element-id="${O}"]`);if(f){if(!p.has(f)){(0,h.warn)(`_bindResetFormAction - element not allowed: ${O}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((WI=this.linkService.eventBus)==null||WI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ZI,name:"ResetForm"}})),!1}}}class C extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W})}render(){this.container.className="textAnnotation";const A=document.createElement("img");return A.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",A.alt="[{{type}} Annotation]",A.dataset.l10nId="text_annotation_type",A.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(A,this.data),this.container.append(A),this.container}}class l extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(A){const{isWin:W,isMac:L}=m.platform;return W&&A.ctrlKey||L&&A.metaKey}_setEventListener(A,W,L,S){W.includes("mouse")?A.addEventListener(W,Q=>{var lI;(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:L,value:S(Q),shift:Q.shiftKey,modifier:this._getKeyModifier(Q)}})}):A.addEventListener(W,Q=>{var lI;(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:L,value:S(Q)}})})}_setEventListeners(A,W,L){var S;for(const[Q,lI]of W)(lI==="Action"||(S=this.data.actions)!=null&&S[lI])&&this._setEventListener(A,Q,lI,L)}_setBackgroundColor(A){const W=this.data.backgroundColor||null;A.style.backgroundColor=W===null?"transparent":h.Util.makeHexColor(W[0],W[1],W[2])}_setTextStyle(A){const W=["left","center","right"],{fontColor:L}=this.data.defaultAppearanceData,S=this.data.defaultAppearanceData.fontSize||Z,Q=A.style;let lI;if(this.data.multiLine){const uI=Math.abs(this.data.rect[3]-this.data.rect[1]),MI=Math.round(uI/(h.LINE_FACTOR*S))||1,ZI=uI/MI;lI=Math.min(S,Math.round(ZI/h.LINE_FACTOR))}else{const uI=Math.abs(this.data.rect[3]-this.data.rect[1]);lI=Math.min(S,Math.round(uI/h.LINE_FACTOR))}Q.fontSize=`calc(${lI}px * var(--scale-factor))`,Q.color=h.Util.makeHexColor(L[0],L[1],L[2]),this.data.textAlignment!==null&&(Q.textAlign=W[this.data.textAlignment])}_setRequired(A,W){W?A.setAttribute("required",!0):A.removeAttribute("required"),A.setAttribute("aria-required",W)}}class B extends l{constructor(A){const W=A.renderForms||!A.data.hasAppearance&&!!A.data.fieldValue;super(A,{isRenderable:W})}setPropertyOnSiblings(A,W,L,S){const Q=this.annotationStorage;for(const lI of this._getElementsByName(A.name,A.id))lI.domElement&&(lI.domElement[W]=L),Q.setValue(lI.id,{[S]:L})}render(){var S;const A=this.annotationStorage,W=this.data.id;this.container.className="textWidgetAnnotation";let L=null;if(this.renderForms){const Q=A.getValue(W,{value:this.data.fieldValue});let lI=Q.formattedValue||Q.value||"";const uI=A.getValue(W,{charLimit:this.data.maxLen}).charLimit;uI&&lI.length>uI&&(lI=lI.slice(0,uI));const MI={userValue:lI,formattedValue:null,valueOnFocus:""};this.data.multiLine?(L=document.createElement("textarea"),L.textContent=lI,this.data.doNotScroll&&(L.style.overflowY="hidden")):(L=document.createElement("input"),L.type="text",L.setAttribute("value",lI),this.data.doNotScroll&&(L.style.overflowX="hidden")),p.add(L),L.setAttribute("data-element-id",W),L.disabled=this.data.readOnly,L.name=this.data.fieldName,L.tabIndex=r,this._setRequired(L,this.data.required),uI&&(L.maxLength=uI),L.addEventListener("input",WI=>{A.setValue(W,{value:WI.target.value}),this.setPropertyOnSiblings(L,"value",WI.target.value,"value")}),L.addEventListener("resetform",WI=>{const tI=this.data.defaultFieldValue??"";L.value=MI.userValue=tI,MI.formattedValue=null});let ZI=WI=>{const{formattedValue:tI}=MI;tI!=null&&(WI.target.value=tI),WI.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){L.addEventListener("focus",tI=>{MI.userValue&&(tI.target.value=MI.userValue),MI.valueOnFocus=tI.target.value}),L.addEventListener("updatefromsandbox",tI=>{const O={value(f){MI.userValue=f.detail.value??"",A.setValue(W,{value:MI.userValue.toString()}),f.target.value=MI.userValue},formattedValue(f){const{formattedValue:v}=f.detail;MI.formattedValue=v,v!=null&&f.target!==document.activeElement&&(f.target.value=v),A.setValue(W,{formattedValue:v})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{var DI;const{charLimit:v}=f.detail,{target:RI}=f;if(v===0){RI.removeAttribute("maxLength");return}RI.setAttribute("maxLength",v);let pI=MI.userValue;!pI||pI.length<=v||(pI=pI.slice(0,v),RI.value=MI.userValue=pI,A.setValue(W,{value:pI}),(DI=this.linkService.eventBus)==null||DI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:pI,willCommit:!0,commitKey:1,selStart:RI.selectionStart,selEnd:RI.selectionEnd}}))}};this._dispatchEventFromSandbox(O,tI)}),L.addEventListener("keydown",tI=>{var v;let O=-1;if(tI.key==="Escape"?O=0:tI.key==="Enter"?O=2:tI.key==="Tab"&&(O=3),O===-1)return;const{value:f}=tI.target;MI.valueOnFocus!==f&&(MI.userValue=f,(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:f,willCommit:!0,commitKey:O,selStart:tI.target.selectionStart,selEnd:tI.target.selectionEnd}}))});const WI=ZI;ZI=null,L.addEventListener("blur",tI=>{var f;const{value:O}=tI.target;MI.userValue=O,this._mouseState.isDown&&MI.valueOnFocus!==O&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:O,willCommit:!0,commitKey:1,selStart:tI.target.selectionStart,selEnd:tI.target.selectionEnd}})),WI(tI)}),(S=this.data.actions)!=null&&S.Keystroke&&L.addEventListener("beforeinput",tI=>{var TI;const{data:O,target:f}=tI,{value:v,selectionStart:RI,selectionEnd:pI}=f;let DI=RI,FI=pI;switch(tI.inputType){case"deleteWordBackward":{const vI=v.substring(0,RI).match(/\w*[^\w]*$/);vI&&(DI-=vI[0].length);break}case"deleteWordForward":{const vI=v.substring(RI).match(/^[^\w]*\w*/);vI&&(FI+=vI[0].length);break}case"deleteContentBackward":RI===pI&&(DI-=1);break;case"deleteContentForward":RI===pI&&(FI+=1);break}tI.preventDefault(),(TI=this.linkService.eventBus)==null||TI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:v,change:O||"",willCommit:!1,selStart:DI,selEnd:FI}})}),this._setEventListeners(L,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],tI=>tI.target.value)}if(ZI&&L.addEventListener("blur",ZI),this.data.comb){const tI=(this.data.rect[2]-this.data.rect[0])/uI;L.classList.add("comb"),L.style.letterSpacing=`calc(${tI}px * var(--scale-factor) - 1ch)`}}else L=document.createElement("div"),L.textContent=this.data.fieldValue,L.style.verticalAlign="middle",L.style.display="table-cell";return this._setTextStyle(L),this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class Y extends l{constructor(A){super(A,{isRenderable:A.renderForms})}render(){const A=this.annotationStorage,W=this.data,L=W.id;let S=A.getValue(L,{value:W.exportValue===W.fieldValue}).value;typeof S=="string"&&(S=S!=="Off",A.setValue(L,{value:S})),this.container.className="buttonWidgetAnnotation checkBox";const Q=document.createElement("input");return p.add(Q),Q.setAttribute("data-element-id",L),Q.disabled=W.readOnly,this._setRequired(Q,this.data.required),Q.type="checkbox",Q.name=W.fieldName,S&&Q.setAttribute("checked",!0),Q.setAttribute("exportValue",W.exportValue),Q.tabIndex=r,Q.addEventListener("change",lI=>{const{name:uI,checked:MI}=lI.target;for(const ZI of this._getElementsByName(uI,L)){const WI=MI&&ZI.exportValue===W.exportValue;ZI.domElement&&(ZI.domElement.checked=WI),A.setValue(ZI.id,{value:WI})}A.setValue(L,{value:MI})}),Q.addEventListener("resetform",lI=>{const uI=W.defaultFieldValue||"Off";lI.target.checked=uI===W.exportValue}),this.enableScripting&&this.hasJSActions&&(Q.addEventListener("updatefromsandbox",lI=>{const uI={value(MI){MI.target.checked=MI.detail.value!=="Off",A.setValue(L,{value:MI.target.checked})}};this._dispatchEventFromSandbox(uI,lI)}),this._setEventListeners(Q,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],lI=>lI.target.checked)),this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class a extends l{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const A=this.annotationStorage,W=this.data,L=W.id;let S=A.getValue(L,{value:W.fieldValue===W.buttonValue}).value;typeof S=="string"&&(S=S!==W.buttonValue,A.setValue(L,{value:S}));const Q=document.createElement("input");if(p.add(Q),Q.setAttribute("data-element-id",L),Q.disabled=W.readOnly,this._setRequired(Q,this.data.required),Q.type="radio",Q.name=W.fieldName,S&&Q.setAttribute("checked",!0),Q.tabIndex=r,Q.addEventListener("change",lI=>{const{name:uI,checked:MI}=lI.target;for(const ZI of this._getElementsByName(uI,L))A.setValue(ZI.id,{value:!1});A.setValue(L,{value:MI})}),Q.addEventListener("resetform",lI=>{const uI=W.defaultFieldValue;lI.target.checked=uI!=null&&uI===W.buttonValue}),this.enableScripting&&this.hasJSActions){const lI=W.buttonValue;Q.addEventListener("updatefromsandbox",uI=>{const MI={value:ZI=>{const WI=lI===ZI.detail.value;for(const tI of this._getElementsByName(ZI.target.name)){const O=WI&&tI.id===L;tI.domElement&&(tI.domElement.checked=O),A.setValue(tI.id,{value:O})}}};this._dispatchEventFromSandbox(MI,uI)}),this._setEventListeners(Q,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],uI=>uI.target.checked)}return this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class i extends d{constructor(A){super(A,{ignoreBorder:A.data.hasAppearance})}render(){const A=super.render();A.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(A.title=this.data.alternativeText);const W=A.lastChild;return this.enableScripting&&this.hasJSActions&&W&&(this._setDefaultPropertiesFromJS(W),W.addEventListener("updatefromsandbox",L=>{this._dispatchEventFromSandbox({},L)})),A}}class I extends l{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const A=this.annotationStorage,W=this.data.id,L=A.getValue(W,{value:this.data.fieldValue}),S=document.createElement("select");p.add(S),S.setAttribute("data-element-id",W),S.disabled=this.data.readOnly,this._setRequired(S,this.data.required),S.name=this.data.fieldName,S.tabIndex=r;let Q=this.data.combo&&this.data.options.length>0;this.data.combo||(S.size=this.data.options.length,this.data.multiSelect&&(S.multiple=!0)),S.addEventListener("resetform",ZI=>{const WI=this.data.defaultFieldValue;for(const tI of S.options)tI.selected=tI.value===WI});for(const ZI of this.data.options){const WI=document.createElement("option");WI.textContent=ZI.displayValue,WI.value=ZI.exportValue,L.value.includes(ZI.exportValue)&&(WI.setAttribute("selected",!0),Q=!1),S.append(WI)}let lI=null;if(Q){const ZI=document.createElement("option");ZI.value=" ",ZI.setAttribute("hidden",!0),ZI.setAttribute("selected",!0),S.prepend(ZI),lI=()=>{ZI.remove(),S.removeEventListener("input",lI),lI=null},S.addEventListener("input",lI)}const uI=(ZI,WI)=>{const tI=WI?"value":"textContent",O=ZI.target.options;return ZI.target.multiple?Array.prototype.filter.call(O,f=>f.selected).map(f=>f[tI]):O.selectedIndex===-1?null:O[O.selectedIndex][tI]},MI=ZI=>{const WI=ZI.target.options;return Array.prototype.map.call(WI,tI=>({displayValue:tI.textContent,exportValue:tI.value}))};return this.enableScripting&&this.hasJSActions?(S.addEventListener("updatefromsandbox",ZI=>{const WI={value(tI){lI==null||lI();const O=tI.detail.value,f=new Set(Array.isArray(O)?O:[O]);for(const v of S.options)v.selected=f.has(v.value);A.setValue(W,{value:uI(tI,!0)})},multipleSelection(tI){S.multiple=!0},remove(tI){const O=S.options,f=tI.detail.remove;O[f].selected=!1,S.remove(f),O.length>0&&Array.prototype.findIndex.call(O,RI=>RI.selected)===-1&&(O[0].selected=!0),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},clear(tI){for(;S.length!==0;)S.remove(0);A.setValue(W,{value:null,items:[]})},insert(tI){const{index:O,displayValue:f,exportValue:v}=tI.detail.insert,RI=S.children[O],pI=document.createElement("option");pI.textContent=f,pI.value=v,RI?RI.before(pI):S.append(pI),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},items(tI){const{items:O}=tI.detail;for(;S.length!==0;)S.remove(0);for(const f of O){const{displayValue:v,exportValue:RI}=f,pI=document.createElement("option");pI.textContent=v,pI.value=RI,S.append(pI)}S.options.length>0&&(S.options[0].selected=!0),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},indices(tI){const O=new Set(tI.detail.indices);for(const f of tI.target.options)f.selected=O.has(f.index);A.setValue(W,{value:uI(tI,!0)})},editable(tI){tI.target.disabled=!tI.detail.editable}};this._dispatchEventFromSandbox(WI,ZI)}),S.addEventListener("input",ZI=>{var O;const WI=uI(ZI,!0),tI=uI(ZI,!1);A.setValue(W,{value:WI}),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:tI,changeEx:WI,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],ZI=>ZI.target.checked)):S.addEventListener("input",function(ZI){A.setValue(W,{value:uI(ZI,!0)})}),this.data.combo&&this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class g extends m{constructor(A){var L,S,Q;const W=!!((L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W})}render(){const A=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",A.includes(this.data.parentType))return this.container;const W=`[data-annotation-id="${this.data.parentId}"]`,L=this.layer.querySelectorAll(W);if(L.length===0)return this.container;const S=new o({container:this.container,trigger:Array.from(L),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Q=this.page,lI=h.Util.normalizeRect([this.data.parentRect[0],Q.view[3]-this.data.parentRect[1]+Q.view[1],this.data.parentRect[2],Q.view[3]-this.data.parentRect[3]+Q.view[1]]),uI=lI[0]+this.data.parentRect[2]-this.data.parentRect[0],MI=lI[1],[ZI,WI,tI,O]=this.viewport.viewBox,f=tI-ZI,v=O-WI;return this.container.style.left=`${100*(uI-ZI)/f}%`,this.container.style.top=`${100*(MI-WI)/v}%`,this.container.append(S.render()),this.container}}class o{constructor(A){this.container=A.container,this.trigger=A.trigger,this.color=A.color,this.titleObj=A.titleObj,this.modificationDate=A.modificationDate,this.contentsObj=A.contentsObj,this.richText=A.richText,this.hideWrapper=A.hideWrapper||!1,this.pinned=!1}render(){var uI,MI;const W=document.createElement("div");W.className="popupWrapper",this.hideElement=this.hideWrapper?W:this.container,this.hideElement.hidden=!0;const L=document.createElement("div");L.className="popup";const S=this.color;if(S){const ZI=.7*(255-S[0])+S[0],WI=.7*(255-S[1])+S[1],tI=.7*(255-S[2])+S[2];L.style.backgroundColor=h.Util.makeHexColor(ZI|0,WI|0,tI|0)}const Q=document.createElement("h1");Q.dir=this.titleObj.dir,Q.textContent=this.titleObj.str,L.append(Q);const lI=M.PDFDateString.toDateObject(this.modificationDate);if(lI){const ZI=document.createElement("span");ZI.className="popupDate",ZI.textContent="{{date}}, {{time}}",ZI.dataset.l10nId="annotation_date_string",ZI.dataset.l10nArgs=JSON.stringify({date:lI.toLocaleDateString(),time:lI.toLocaleTimeString()}),L.append(ZI)}if((uI=this.richText)!=null&&uI.str&&(!((MI=this.contentsObj)!=null&&MI.str)||this.contentsObj.str===this.richText.str))T.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:L}),L.lastChild.className="richText popupContent";else{const ZI=this._formatContents(this.contentsObj);L.append(ZI)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const ZI of this.trigger)ZI.addEventListener("click",this._toggle.bind(this)),ZI.addEventListener("mouseover",this._show.bind(this,!1)),ZI.addEventListener("mouseout",this._hide.bind(this,!1));return L.addEventListener("click",this._hide.bind(this,!0)),W.append(L),W}_formatContents({str:A,dir:W}){const L=document.createElement("p");L.className="popupContent",L.dir=W;const S=A.split(/(?:\r\n?|\n)/);for(let Q=0,lI=S.length;Q<lI;++Q){const uI=S[Q];L.append(document.createTextNode(uI)),Q<lI-1&&L.append(document.createElement("br"))}return L}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(A=!1){A&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(A=!0){A&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class X extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0}),this.textContent=A.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const A=document.createElement("div");A.className="annotationTextContent",A.setAttribute("role","comment");for(const W of this.textContent){const L=document.createElement("span");L.textContent=W,A.append(L)}this.container.append(A)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class b extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const A=this.data,{width:W,height:L}=j(A.rect),S=this.svgFactory.create(W,L,!0),Q=this.svgFactory.createElement("svg:line");return Q.setAttribute("x1",A.rect[2]-A.lineCoordinates[0]),Q.setAttribute("y1",A.rect[3]-A.lineCoordinates[1]),Q.setAttribute("x2",A.rect[2]-A.lineCoordinates[2]),Q.setAttribute("y2",A.rect[3]-A.lineCoordinates[3]),Q.setAttribute("stroke-width",A.borderStyle.width||1),Q.setAttribute("stroke","transparent"),Q.setAttribute("fill","transparent"),S.append(Q),this.container.append(S),this._createPopup(Q,A),this.container}}class N extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const A=this.data,{width:W,height:L}=j(A.rect),S=this.svgFactory.create(W,L,!0),Q=A.borderStyle.width,lI=this.svgFactory.createElement("svg:rect");return lI.setAttribute("x",Q/2),lI.setAttribute("y",Q/2),lI.setAttribute("width",W-Q),lI.setAttribute("height",L-Q),lI.setAttribute("stroke-width",Q||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class F extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const A=this.data,{width:W,height:L}=j(A.rect),S=this.svgFactory.create(W,L,!0),Q=A.borderStyle.width,lI=this.svgFactory.createElement("svg:ellipse");return lI.setAttribute("cx",W/2),lI.setAttribute("cy",L/2),lI.setAttribute("rx",W/2-Q/2),lI.setAttribute("ry",L/2-Q/2),lI.setAttribute("stroke-width",Q||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class hI extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const A=this.data,{width:W,height:L}=j(A.rect),S=this.svgFactory.create(W,L,!0);let Q=[];for(const uI of A.vertices){const MI=uI.x-A.rect[0],ZI=A.rect[3]-uI.y;Q.push(MI+","+ZI)}Q=Q.join(" ");const lI=this.svgFactory.createElement(this.svgElementName);return lI.setAttribute("points",Q),lI.setAttribute("stroke-width",A.borderStyle.width||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class YI extends hI{constructor(A){super(A),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class nI extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class gI extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const A=this.data,{width:W,height:L}=j(A.rect),S=this.svgFactory.create(W,L,!0);for(const Q of A.inkLists){let lI=[];for(const MI of Q){const ZI=MI.x-A.rect[0],WI=A.rect[3]-MI.y;lI.push(`${ZI},${WI}`)}lI=lI.join(" ");const uI=this.svgFactory.createElement(this.svgElementName);uI.setAttribute("points",lI),uI.setAttribute("stroke-width",A.borderStyle.width||1),uI.setAttribute("stroke","transparent"),uI.setAttribute("fill","transparent"),this._createPopup(uI,A),S.append(uI)}return this.container.append(S),this.container}}class U extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class II extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class q extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class mI extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class NI extends m{constructor(A){var L,S,Q;const W=!!(A.data.hasPopup||(L=A.data.titleObj)!=null&&L.str||(S=A.data.contentsObj)!=null&&S.str||(Q=A.data.richText)!=null&&Q.str);super(A,{isRenderable:W,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class BI extends m{constructor(A){var S;super(A,{isRenderable:!0});const{filename:W,content:L}=this.data.file;this.filename=(0,M.getFilenameFromUrl)(W),this.content=L,(S=this.linkService.eventBus)==null||S.dispatch("fileattachmentannotation",{source:this,filename:W,content:L})}render(){var W,L;this.container.className="fileAttachmentAnnotation";const A=document.createElement("div");return A.className="popupTriggerArea",A.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((W=this.data.titleObj)!=null&&W.str||(L=this.data.contentsObj)!=null&&L.str||this.data.richText)&&this._createPopup(A,this.data),this.container.append(A),this.container}_download(){var A;(A=this.downloadManager)==null||A.openOrDownloadData(this.container,this.content,this.filename)}}const aI=class{static render(A){var uI,MI;const{annotations:W,div:L,viewport:S,accessibilityManager:Q}=A;jI(this,x,xg).call(this,L,S);let lI=0;for(const ZI of W){if(ZI.annotationType!==h.AnnotationType.POPUP){const{width:tI,height:O}=j(ZI.rect);if(tI<=0||O<=0)continue}const WI=D.create({data:ZI,layer:L,page:A.page,viewport:S,linkService:A.linkService,downloadManager:A.downloadManager,imageResourcesPath:A.imageResourcesPath||"",renderForms:A.renderForms!==!1,svgFactory:new M.DOMSVGFactory,annotationStorage:A.annotationStorage||new _.AnnotationStorage,enableScripting:A.enableScripting,hasJSActions:A.hasJSActions,fieldObjects:A.fieldObjects,mouseState:A.mouseState||{isDown:!1}});if(WI.isRenderable){const tI=WI.render();if(ZI.hidden&&(tI.style.visibility="hidden"),Array.isArray(tI))for(const O of tI)O.style.zIndex=lI++,jI(uI=aI,e,jg).call(uI,O,ZI.id,L,Q);else tI.style.zIndex=lI++,WI instanceof g?L.prepend(tI):jI(MI=aI,e,jg).call(MI,tI,ZI.id,L,Q)}}jI(this,P,Qg).call(this,L,A.annotationCanvasMap)}static update(A){const{annotationCanvasMap:W,div:L,viewport:S}=A;jI(this,x,xg).call(this,L,S),jI(this,P,Qg).call(this,L,W),L.hidden=!1}};let J=aI;e=new WeakSet,jg=function(A,W,L,S){const Q=A.firstChild||A;Q.id=`${M.AnnotationPrefix}${W}`,L.append(A),S==null||S.moveElementInDOM(L,A,Q,!1)},x=new WeakSet,xg=function(A,{width:W,height:L,rotation:S}){const{style:Q}=A,lI=S%180!==0,uI=Math.floor(W)+"px",MI=Math.floor(L)+"px";Q.width=lI?MI:uI,Q.height=lI?uI:MI,A.setAttribute("data-main-rotation",S)},P=new WeakSet,Qg=function(A,W){if(W){for(const[L,S]of W){const Q=A.querySelector(`[data-annotation-id="${L}"]`);if(!Q)continue;const{firstChild:lI}=Q;lI?lI.nodeName==="CANVAS"?lI.replaceWith(S):lI.before(S):Q.append(S)}W.clear()}},zI(J,e),zI(J,x),zI(J,P),c.AnnotationLayer=J},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorConverters=void 0;function $(M){return Math.floor(Math.max(0,Math.min(1,M))*255).toString(16).padStart(2,"0")}class h{static CMYK_G([_,z,T,r]){return["G",1-Math.min(1,.3*_+.59*T+.11*z+r)]}static G_CMYK([_]){return["CMYK",0,0,0,1-_]}static G_RGB([_]){return["RGB",_,_,_]}static G_HTML([_]){const z=$(_);return`#${z}${z}${z}`}static RGB_G([_,z,T]){return["G",.3*_+.59*z+.11*T]}static RGB_HTML([_,z,T]){const r=$(_),Z=$(z),p=$(T);return`#${r}${Z}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([_,z,T,r]){return["RGB",1-Math.min(1,_+r),1-Math.min(1,T+r),1-Math.min(1,z+r)]}static CMYK_HTML(_){const z=this.CMYK_RGB(_).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([_,z,T]){const r=1-_,Z=1-z,p=1-T,j=Math.min(r,Z,p);return["CMYK",r,Z,p,j]}}c.ColorConverters=h},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaLayer=void 0;var h=$(20);class M{static setupStorage(z,T,r,Z,p){const j=Z.getValue(T,{value:null});switch(r.name){case"textarea":if(j.value!==null&&(z.textContent=j.value),p==="print")break;z.addEventListener("input",D=>{Z.setValue(T,{value:D.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(j.value===r.attributes.xfaOn?z.setAttribute("checked",!0):j.value===r.attributes.xfaOff&&z.removeAttribute("checked"),p==="print")break;z.addEventListener("change",D=>{Z.setValue(T,{value:D.target.checked?D.target.getAttribute("xfaOn"):D.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&z.setAttribute("value",j.value),p==="print")break;z.addEventListener("input",D=>{Z.setValue(T,{value:D.target.value})})}break;case"select":if(j.value!==null)for(const D of r.children)D.attributes.value===j.value&&(D.attributes.selected=!0);z.addEventListener("input",D=>{const m=D.target.options,d=m.selectedIndex===-1?"":m[m.selectedIndex].value;Z.setValue(T,{value:d})});break}}static setAttributes({html:z,element:T,storage:r=null,intent:Z,linkService:p}){const{attributes:j}=T,D=z instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${Z}`);for(const[m,d]of Object.entries(j))if(d!=null)switch(m){case"class":d.length&&z.setAttribute(m,d.join(" "));break;case"dataId":break;case"id":z.setAttribute("data-element-id",d);break;case"style":Object.assign(z.style,d);break;case"textContent":z.textContent=d;break;default:(!D||m!=="href"&&m!=="newWindow")&&z.setAttribute(m,d)}D&&p.addLinkAttributes(z,j.href,j.newWindow),r&&j.dataId&&this.setupStorage(z,j.dataId,T,r)}static render(z){var C;const T=z.annotationStorage,r=z.linkService,Z=z.xfaHtml,p=z.intent||"display",j=document.createElement(Z.name);Z.attributes&&this.setAttributes({html:j,element:Z,intent:p,linkService:r});const D=[[Z,-1,j]],m=z.div;if(m.append(j),z.viewport){const l=`matrix(${z.viewport.transform.join(",")})`;m.style.transform=l}p!=="richText"&&m.setAttribute("class","xfaLayer xfaFont");const d=[];for(;D.length>0;){const[l,B,Y]=D.at(-1);if(B+1===l.children.length){D.pop();continue}const a=l.children[++D.at(-1)[1]];if(a===null)continue;const{name:i}=a;if(i==="#text"){const g=document.createTextNode(a.value);d.push(g),Y.append(g);continue}let I;if((C=a==null?void 0:a.attributes)!=null&&C.xmlns?I=document.createElementNS(a.attributes.xmlns,i):I=document.createElement(i),Y.append(I),a.attributes&&this.setAttributes({html:I,element:a,storage:T,intent:p,linkService:r}),a.children&&a.children.length>0)D.push([a,-1,I]);else if(a.value){const g=document.createTextNode(a.value);h.XfaText.shouldBuildText(i)&&d.push(g),I.append(g)}}for(const l of m.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))l.setAttribute("readOnly",!0);return{textDivs:d}}static update(z){const T=`matrix(${z.viewport.transform.join(",")})`;z.div.style.transform=T,z.div.hidden=!1}}c.XfaLayer=M},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextLayerRenderTask=void 0,c.renderTextLayer=Y;var h=$(1),M=$(8);const _=1e5,z=30,T=.8,r=new Map,Z=/^\s+$/g;function p(a,i){const I=r.get(a);if(I)return I;i.save(),i.font=`${z}px ${a}`;const g=i.measureText("");let o=g.fontBoundingBoxAscent,X=Math.abs(g.fontBoundingBoxDescent);if(o){i.restore();const N=o/(o+X);return r.set(a,N),N}i.strokeStyle="red",i.clearRect(0,0,z,z),i.strokeText("g",0,0);let b=i.getImageData(0,0,z,z).data;X=0;for(let N=b.length-1-3;N>=0;N-=4)if(b[N]>0){X=Math.ceil(N/4/z);break}i.clearRect(0,0,z,z),i.strokeText("A",0,z),b=i.getImageData(0,0,z,z).data,o=0;for(let N=0,F=b.length;N<F;N+=4)if(b[N]>0){o=z-Math.floor(N/4/z);break}if(i.restore(),o){const N=o/(o+X);return r.set(a,N),N}return r.set(a,T),T}function j(a,i,I,g){const o=document.createElement("span"),X=a._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,fontSize:0};a._textDivs.push(o);const b=h.Util.transform(a._viewport.transform,i.transform);let N=Math.atan2(b[1],b[0]);const F=I[i.fontName];F.vertical&&(N+=Math.PI/2);const hI=Math.hypot(b[2],b[3]),YI=hI*p(F.fontFamily,g);let nI,gI;N===0?(nI=b[4],gI=b[5]-YI):(nI=b[4]+YI*Math.sin(N),gI=b[5]-YI*Math.cos(N)),o.style.left=`${nI}px`,o.style.top=`${gI}px`,o.style.fontSize=`${hI}px`,o.style.fontFamily=F.fontFamily,X.fontSize=hI,o.setAttribute("role","presentation"),o.textContent=i.str,o.dir=i.dir,a._fontInspectorEnabled&&(o.dataset.fontName=i.fontName),N!==0&&(X.angle=N*(180/Math.PI));let U=!1;if(i.str.length>1||a._enhanceTextSelection&&Z.test(i.str))U=!0;else if(i.str!==" "&&i.transform[0]!==i.transform[3]){const II=Math.abs(i.transform[0]),q=Math.abs(i.transform[3]);II!==q&&Math.max(II,q)/Math.min(II,q)>1.5&&(U=!0)}if(U&&(F.vertical?X.canvasWidth=i.height*a._viewport.scale:X.canvasWidth=i.width*a._viewport.scale),a._textDivProperties.set(o,X),a._textContentStream&&a._layoutText(o),a._enhanceTextSelection&&X.hasText){let II=1,q=0;N!==0&&(II=Math.cos(N),q=Math.sin(N));const mI=(F.vertical?i.height:i.width)*a._viewport.scale,NI=hI;let BI,J;N!==0?(BI=[II,q,-q,II,nI,gI],J=h.Util.getAxialAlignedBoundingBox([0,0,mI,NI],BI)):J=[nI,gI,nI+mI,gI+NI],a._bounds.push({left:J[0],top:J[1],right:J[2],bottom:J[3],div:o,size:[mI,NI],m:BI})}}function D(a){if(a._canceled)return;const i=a._textDivs,I=a._capability,g=i.length;if(g>_){a._renderingDone=!0,I.resolve();return}if(!a._textContentStream)for(let o=0;o<g;o++)a._layoutText(i[o]);a._renderingDone=!0,I.resolve()}function m(a,i,I){let g=0;for(let o=0;o<I;o++){const X=a[i++];X>0&&(g=g?Math.min(X,g):X)}return g}function d(a){const i=a._bounds,I=a._viewport,g=C(I.width,I.height,i);for(let o=0;o<g.length;o++){const X=i[o].div,b=a._textDivProperties.get(X);if(b.angle===0){b.paddingLeft=i[o].left-g[o].left,b.paddingTop=i[o].top-g[o].top,b.paddingRight=g[o].right-i[o].right,b.paddingBottom=g[o].bottom-i[o].bottom,a._textDivProperties.set(X,b);continue}const N=g[o],F=i[o],hI=F.m,YI=hI[0],nI=hI[1],gI=[[0,0],[0,F.size[1]],[F.size[0],0],F.size],U=new Float64Array(64);for(let q=0,mI=gI.length;q<mI;q++){const NI=h.Util.applyTransform(gI[q],hI);U[q+0]=YI&&(N.left-NI[0])/YI,U[q+4]=nI&&(N.top-NI[1])/nI,U[q+8]=YI&&(N.right-NI[0])/YI,U[q+12]=nI&&(N.bottom-NI[1])/nI,U[q+16]=nI&&(N.left-NI[0])/-nI,U[q+20]=YI&&(N.top-NI[1])/YI,U[q+24]=nI&&(N.right-NI[0])/-nI,U[q+28]=YI&&(N.bottom-NI[1])/YI,U[q+32]=YI&&(N.left-NI[0])/-YI,U[q+36]=nI&&(N.top-NI[1])/-nI,U[q+40]=YI&&(N.right-NI[0])/-YI,U[q+44]=nI&&(N.bottom-NI[1])/-nI,U[q+48]=nI&&(N.left-NI[0])/nI,U[q+52]=YI&&(N.top-NI[1])/-YI,U[q+56]=nI&&(N.right-NI[0])/nI,U[q+60]=YI&&(N.bottom-NI[1])/-YI}const II=1+Math.min(Math.abs(YI),Math.abs(nI));b.paddingLeft=m(U,32,16)/II,b.paddingTop=m(U,48,16)/II,b.paddingRight=m(U,0,16)/II,b.paddingBottom=m(U,16,16)/II,a._textDivProperties.set(X,b)}}function C(a,i,I){const g=I.map(function(X,b){return{x1:X.left,y1:X.top,x2:X.right,y2:X.bottom,index:b,x1New:void 0,x2New:void 0}});l(a,g);const o=new Array(I.length);for(const X of g){const b=X.index;o[b]={left:X.x1New,top:0,right:X.x2New,bottom:0}}I.map(function(X,b){const N=o[b],F=g[b];F.x1=X.top,F.y1=a-N.right,F.x2=X.bottom,F.y2=a-N.left,F.index=b,F.x1New=void 0,F.x2New=void 0}),l(i,g);for(const X of g){const b=X.index;o[b].top=X.x1New,o[b].bottom=X.x2New}return o}function l(a,i){i.sort(function(o,X){return o.x1-X.x1||o.index-X.index});const g=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const o of i){let X=0;for(;X<g.length&&g[X].end<=o.y1;)X++;let b=g.length-1;for(;b>=0&&g[b].start>=o.y2;)b--;let N,F,hI,YI,nI=-1/0;for(hI=X;hI<=b;hI++){N=g[hI],F=N.boundary;let II;F.x2>o.x1?II=F.index>o.index?F.x1New:o.x1:F.x2New===void 0?II=(F.x2+o.x1)/2:II=F.x2New,II>nI&&(nI=II)}for(o.x1New=nI,hI=X;hI<=b;hI++)N=g[hI],F=N.boundary,F.x2New===void 0?F.x2>o.x1?F.index>o.index&&(F.x2New=F.x2):F.x2New=nI:F.x2New>nI&&(F.x2New=Math.max(nI,F.x2));const gI=[];let U=null;for(hI=X;hI<=b;hI++){N=g[hI],F=N.boundary;const II=F.x2>o.x2?F:o;U===II?gI.at(-1).end=N.end:(gI.push({start:N.start,end:N.end,boundary:II}),U=II)}for(g[X].start<o.y1&&(gI[0].start=o.y1,gI.unshift({start:g[X].start,end:o.y1,boundary:g[X].boundary})),o.y2<g[b].end&&(gI.at(-1).end=o.y2,gI.push({start:o.y2,end:g[b].end,boundary:g[b].boundary})),hI=X;hI<=b;hI++){if(N=g[hI],F=N.boundary,F.x2New!==void 0)continue;let II=!1;for(YI=X-1;!II&&YI>=0&&g[YI].start>=F.y1;YI--)II=g[YI].boundary===F;for(YI=b+1;!II&&YI<g.length&&g[YI].end<=F.y2;YI++)II=g[YI].boundary===F;for(YI=0;!II&&YI<gI.length;YI++)II=gI[YI].boundary===F;II||(F.x2New=nI)}Array.prototype.splice.apply(g,[X,b-X+1,...gI])}for(const o of g){const X=o.boundary;X.x2New===void 0&&(X.x2New=Math.max(a,X.x2))}}class B{constructor({textContent:i,textContentStream:I,container:g,viewport:o,textDivs:X,textContentItemsStr:b,enhanceTextSelection:N}){var F;N&&(0,M.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=i,this._textContentStream=I,this._container=g,this._document=g.ownerDocument,this._viewport=o,this._textDivs=X||[],this._textContentItemsStr=b||[],this._enhanceTextSelection=!!N,this._fontInspectorEnabled=!!((F=globalThis.FontInspector)!=null&&F.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,h.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new h.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(i,I){for(let g=0,o=i.length;g<o;g++){if(i[g].str===void 0){if(i[g].type==="beginMarkedContentProps"||i[g].type==="beginMarkedContent"){const X=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),i[g].id!==null&&this._container.setAttribute("id",`${i[g].id}`),X.append(this._container)}else i[g].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(i[g].str),j(this,i[g],I,this._layoutTextCtx)}}_layoutText(i){const I=this._textDivProperties.get(i);let g="";if(I.canvasWidth!==0&&I.hasText){const{fontFamily:o}=i.style,{fontSize:X}=I;(X!==this._layoutTextLastFontSize||o!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${X*this._devicePixelRatio}px ${o}`,this._layoutTextLastFontSize=X,this._layoutTextLastFontFamily=o);const{width:b}=this._layoutTextCtx.measureText(i.textContent);if(b>0){const N=this._devicePixelRatio*I.canvasWidth/b;this._enhanceTextSelection&&(I.scale=N),g=`scaleX(${N})`}}if(I.angle!==0&&(g=`rotate(${I.angle}deg) ${g}`),g.length>0&&(this._enhanceTextSelection&&(I.originalTransform=g),i.style.transform=g),I.hasText&&this._container.append(i),I.hasEOL){const o=document.createElement("br");o.setAttribute("role","presentation"),this._container.append(o)}}_render(i=0){const I=(0,h.createPromiseCapability)();let g=Object.create(null);const o=this._document.createElement("canvas");if(o.height=o.width=z,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){const X=this._textContent.items,b=this._textContent.styles;this._processItems(X,b),I.resolve()}else if(this._textContentStream){const X=()=>{this._reader.read().then(({value:b,done:N})=>{if(N){I.resolve();return}Object.assign(g,b.styles),this._processItems(b.items,g),X()},I.reject)};this._reader=this._textContentStream.getReader(),X()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');I.promise.then(()=>{g=null,i?this._renderTimer=setTimeout(()=>{D(this),this._renderTimer=null},i):D(this)},this._capability.reject)}expandTextDivs(i=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(d(this),this._bounds=null);const I=[],g=[];for(let o=0,X=this._textDivs.length;o<X;o++){const b=this._textDivs[o],N=this._textDivProperties.get(b);N.hasText&&(i?(I.length=0,g.length=0,N.originalTransform&&I.push(N.originalTransform),N.paddingTop>0?(g.push(`${N.paddingTop}px`),I.push(`translateY(${-N.paddingTop}px)`)):g.push(0),N.paddingRight>0?g.push(`${N.paddingRight/N.scale}px`):g.push(0),N.paddingBottom>0?g.push(`${N.paddingBottom}px`):g.push(0),N.paddingLeft>0?(g.push(`${N.paddingLeft/N.scale}px`),I.push(`translateX(${-N.paddingLeft/N.scale}px)`)):g.push(0),b.style.padding=g.join(" "),I.length&&(b.style.transform=I.join(" "))):(b.style.padding=null,b.style.transform=N.originalTransform))}}}c.TextLayerRenderTask=B;function Y(a){const i=new B({textContent:a.textContent,textContentStream:a.textContentStream,container:a.container,viewport:a.viewport,textDivs:a.textDivs,textContentItemsStr:a.textContentItemsStr,enhanceTextSelection:a.enhanceTextSelection});return i._render(a.timeout),i}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SVGGraphics=void 0;var h=$(8),M=$(1),_=$(3);let z=class{constructor(){(0,M.unreachable)("Not implemented: SVGGraphics")}};c.SVGGraphics=z;{let C=function(I){let g=[];const o=[];for(const X of I){if(X.fn==="save"){g.push({fnId:92,fn:"group",items:[]}),o.push(g),g=g.at(-1).items;continue}X.fn==="restore"?g=o.pop():g.push(X)}return g},l=function(I){if(Number.isInteger(I))return I.toString();const g=I.toFixed(10);let o=g.length-1;if(g[o]!=="0")return g;do o--;while(g[o]==="0");return g.substring(0,g[o]==="."?o:o+1)},B=function(I){if(I[4]===0&&I[5]===0){if(I[1]===0&&I[2]===0)return I[0]===1&&I[3]===1?"":`scale(${l(I[0])} ${l(I[3])})`;if(I[0]===I[3]&&I[1]===-I[2]){const g=Math.acos(I[0])*180/Math.PI;return`rotate(${l(g)})`}}else if(I[0]===1&&I[1]===0&&I[2]===0&&I[3]===1)return`translate(${l(I[4])} ${l(I[5])})`;return`matrix(${l(I[0])} ${l(I[1])} ${l(I[2])} ${l(I[3])} ${l(I[4])} ${l(I[5])})`};const T={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},r="http://www.w3.org/XML/1998/namespace",Z="http://www.w3.org/1999/xlink",p=["butt","round","square"],j=["miter","round","bevel"],D=function(I,g="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([I],{type:g}));const X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b=`data:${g};base64,`;for(let N=0,F=I.length;N<F;N+=3){const hI=I[N]&255,YI=I[N+1]&255,nI=I[N+2]&255,gI=hI>>2,U=(hI&3)<<4|YI>>4,II=N+1<F?(YI&15)<<2|nI>>6:64,q=N+2<F?nI&63:64;b+=X[gI]+X[U]+X[II]+X[q]}return b},m=function(){const I=new Uint8Array([137,80,78,71,13,10,26,10]),g=12,o=new Int32Array(256);for(let nI=0;nI<256;nI++){let gI=nI;for(let U=0;U<8;U++)gI&1?gI=3988292384^gI>>1&2147483647:gI=gI>>1&2147483647;o[nI]=gI}function X(nI,gI,U){let II=-1;for(let q=gI;q<U;q++){const mI=(II^nI[q])&255,NI=o[mI];II=II>>>8^NI}return II^-1}function b(nI,gI,U,II){let q=II;const mI=gI.length;U[q]=mI>>24&255,U[q+1]=mI>>16&255,U[q+2]=mI>>8&255,U[q+3]=mI&255,q+=4,U[q]=nI.charCodeAt(0)&255,U[q+1]=nI.charCodeAt(1)&255,U[q+2]=nI.charCodeAt(2)&255,U[q+3]=nI.charCodeAt(3)&255,q+=4,U.set(gI,q),q+=gI.length;const NI=X(U,II+4,q);U[q]=NI>>24&255,U[q+1]=NI>>16&255,U[q+2]=NI>>8&255,U[q+3]=NI&255}function N(nI,gI,U){let II=1,q=0;for(let mI=gI;mI<U;++mI)II=(II+(nI[mI]&255))%65521,q=(q+II)%65521;return q<<16|II}function F(nI){if(!_.isNodeJS)return hI(nI);try{let gI;parseInt(process.versions.node)>=8?gI=nI:gI=Buffer.from(nI);const U=require$$5$1.deflateSync(gI,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(gI){(0,M.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+gI)}return hI(nI)}function hI(nI){let gI=nI.length;const U=65535,II=Math.ceil(gI/U),q=new Uint8Array(2+gI+II*5+4);let mI=0;q[mI++]=120,q[mI++]=156;let NI=0;for(;gI>U;)q[mI++]=0,q[mI++]=255,q[mI++]=255,q[mI++]=0,q[mI++]=0,q.set(nI.subarray(NI,NI+U),mI),mI+=U,NI+=U,gI-=U;q[mI++]=1,q[mI++]=gI&255,q[mI++]=gI>>8&255,q[mI++]=~gI&65535&255,q[mI++]=(~gI&65535)>>8&255,q.set(nI.subarray(NI),mI),mI+=nI.length-NI;const BI=N(nI,0,nI.length);return q[mI++]=BI>>24&255,q[mI++]=BI>>16&255,q[mI++]=BI>>8&255,q[mI++]=BI&255,q}function YI(nI,gI,U,II){const q=nI.width,mI=nI.height;let NI,BI,J;const e=nI.data;switch(gI){case M.ImageKind.GRAYSCALE_1BPP:BI=0,NI=1,J=q+7>>3;break;case M.ImageKind.RGB_24BPP:BI=2,NI=8,J=q*3;break;case M.ImageKind.RGBA_32BPP:BI=6,NI=8,J=q*4;break;default:throw new Error("invalid format")}const w=new Uint8Array((1+J)*mI);let x=0,E=0;for(let W=0;W<mI;++W)w[x++]=0,w.set(e.subarray(E,E+J),x),E+=J,x+=J;if(gI===M.ImageKind.GRAYSCALE_1BPP&&II){x=0;for(let W=0;W<mI;W++){x++;for(let L=0;L<J;L++)w[x++]^=255}}const P=new Uint8Array([q>>24&255,q>>16&255,q>>8&255,q&255,mI>>24&255,mI>>16&255,mI>>8&255,mI&255,NI,BI,0,0,0]),iI=F(w),aI=I.length+g*3+P.length+iI.length,eI=new Uint8Array(aI);let A=0;return eI.set(I,A),A+=I.length,b("IHDR",P,eI,A),A+=g+P.length,b("IDATA",iI,eI,A),A+=g+iI.length,b("IEND",new Uint8Array(0),eI,A),D(eI,"image/png",U)}return function(gI,U,II){const q=gI.kind===void 0?M.ImageKind.GRAYSCALE_1BPP:gI.kind;return YI(gI,q,U,II)}}();class d{constructor(){this.fontSizeScale=1,this.fontWeight=T.fontWeight,this.fontSize=0,this.textMatrix=M.IDENTITY_MATRIX,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=M.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=T.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(g,o){this.x=g,this.y=o}}let Y=0,a=0,i=0;c.SVGGraphics=z=class{constructor(I,g,o=!1){(0,h.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new h.DOMSVGFactory,this.current=new d,this.transformMatrix=M.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=I,this.objs=g,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const X in M.OPS)this._operatorIdMapping[M.OPS[X]]=X}save(){this.transformStack.push(this.transformMatrix);const I=this.current;this.extraStack.push(I),this.current=I.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(I){this.save(),this.executeOpTree(I),this.restore()}loadDependencies(I){const g=I.fnArray,o=I.argsArray;for(let X=0,b=g.length;X<b;X++)if(g[X]===M.OPS.dependency)for(const N of o[X]){const F=N.startsWith("g_")?this.commonObjs:this.objs,hI=new Promise(YI=>{F.get(N,YI)});this.current.dependencies.push(hI)}return Promise.all(this.current.dependencies)}transform(I,g,o,X,b,N){const F=[I,g,o,X,b,N];this.transformMatrix=M.Util.transform(this.transformMatrix,F),this.tgrp=null}getSVG(I,g){this.viewport=g;const o=this._initialize(g);return this.loadDependencies(I).then(()=>(this.transformMatrix=M.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(I)),o))}convertOpList(I){const g=this._operatorIdMapping,o=I.argsArray,X=I.fnArray,b=[];for(let N=0,F=X.length;N<F;N++){const hI=X[N];b.push({fnId:hI,fn:g[hI],args:o[N]})}return C(b)}executeOpTree(I){for(const g of I){const o=g.fn,X=g.fnId,b=g.args;switch(X|0){case M.OPS.beginText:this.beginText();break;case M.OPS.dependency:break;case M.OPS.setLeading:this.setLeading(b);break;case M.OPS.setLeadingMoveText:this.setLeadingMoveText(b[0],b[1]);break;case M.OPS.setFont:this.setFont(b);break;case M.OPS.showText:this.showText(b[0]);break;case M.OPS.showSpacedText:this.showText(b[0]);break;case M.OPS.endText:this.endText();break;case M.OPS.moveText:this.moveText(b[0],b[1]);break;case M.OPS.setCharSpacing:this.setCharSpacing(b[0]);break;case M.OPS.setWordSpacing:this.setWordSpacing(b[0]);break;case M.OPS.setHScale:this.setHScale(b[0]);break;case M.OPS.setTextMatrix:this.setTextMatrix(b[0],b[1],b[2],b[3],b[4],b[5]);break;case M.OPS.setTextRise:this.setTextRise(b[0]);break;case M.OPS.setTextRenderingMode:this.setTextRenderingMode(b[0]);break;case M.OPS.setLineWidth:this.setLineWidth(b[0]);break;case M.OPS.setLineJoin:this.setLineJoin(b[0]);break;case M.OPS.setLineCap:this.setLineCap(b[0]);break;case M.OPS.setMiterLimit:this.setMiterLimit(b[0]);break;case M.OPS.setFillRGBColor:this.setFillRGBColor(b[0],b[1],b[2]);break;case M.OPS.setStrokeRGBColor:this.setStrokeRGBColor(b[0],b[1],b[2]);break;case M.OPS.setStrokeColorN:this.setStrokeColorN(b);break;case M.OPS.setFillColorN:this.setFillColorN(b);break;case M.OPS.shadingFill:this.shadingFill(b[0]);break;case M.OPS.setDash:this.setDash(b[0],b[1]);break;case M.OPS.setRenderingIntent:this.setRenderingIntent(b[0]);break;case M.OPS.setFlatness:this.setFlatness(b[0]);break;case M.OPS.setGState:this.setGState(b[0]);break;case M.OPS.fill:this.fill();break;case M.OPS.eoFill:this.eoFill();break;case M.OPS.stroke:this.stroke();break;case M.OPS.fillStroke:this.fillStroke();break;case M.OPS.eoFillStroke:this.eoFillStroke();break;case M.OPS.clip:this.clip("nonzero");break;case M.OPS.eoClip:this.clip("evenodd");break;case M.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case M.OPS.paintImageXObject:this.paintImageXObject(b[0]);break;case M.OPS.paintInlineImageXObject:this.paintInlineImageXObject(b[0]);break;case M.OPS.paintImageMaskXObject:this.paintImageMaskXObject(b[0]);break;case M.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(b[0],b[1]);break;case M.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case M.OPS.closePath:this.closePath();break;case M.OPS.closeStroke:this.closeStroke();break;case M.OPS.closeFillStroke:this.closeFillStroke();break;case M.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case M.OPS.nextLine:this.nextLine();break;case M.OPS.transform:this.transform(b[0],b[1],b[2],b[3],b[4],b[5]);break;case M.OPS.constructPath:this.constructPath(b[0],b[1]);break;case M.OPS.endPath:this.endPath();break;case 92:this.group(g.items);break;default:(0,M.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(I){this.current.wordSpacing=I}setCharSpacing(I){this.current.charSpacing=I}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(I,g,o,X,b,N){const F=this.current;F.textMatrix=F.lineMatrix=[I,g,o,X,b,N],F.textMatrixScale=Math.hypot(I,g),F.x=F.lineX=0,F.y=F.lineY=0,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size",`${l(F.fontSize)}px`),F.tspan.setAttributeNS(null,"y",l(-F.y)),F.txtElement=this.svgFactory.createElement("svg:text"),F.txtElement.append(F.tspan)}beginText(){const I=this.current;I.x=I.lineX=0,I.y=I.lineY=0,I.textMatrix=M.IDENTITY_MATRIX,I.lineMatrix=M.IDENTITY_MATRIX,I.textMatrixScale=1,I.tspan=this.svgFactory.createElement("svg:tspan"),I.txtElement=this.svgFactory.createElement("svg:text"),I.txtgrp=this.svgFactory.createElement("svg:g"),I.xcoords=[],I.ycoords=[]}moveText(I,g){const o=this.current;o.x=o.lineX+=I,o.y=o.lineY+=g,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${l(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",l(-o.y))}showText(I){const g=this.current,o=g.font,X=g.fontSize;if(X===0)return;const b=g.fontSizeScale,N=g.charSpacing,F=g.wordSpacing,hI=g.fontDirection,YI=g.textHScale*hI,nI=o.vertical,gI=nI?1:-1,U=o.defaultVMetrics,II=X*g.fontMatrix[0];let q=0;for(const BI of I){if(BI===null){q+=hI*F;continue}else if(typeof BI=="number"){q+=gI*BI*X/1e3;continue}const J=(BI.isSpace?F:0)+N,e=BI.fontChar;let w,x,E=BI.width;if(nI){let iI;const aI=BI.vmetric||U;iI=BI.vmetric?aI[1]:E*.5,iI=-iI*II;const eI=aI[2]*II;E=aI?-aI[0]:E,w=iI/b,x=(q+eI)/b}else w=q/b,x=0;(BI.isInFont||o.missingFile)&&(g.xcoords.push(g.x+w),nI&&g.ycoords.push(-g.y+x),g.tspan.textContent+=e);let P;nI?P=E*II-J*hI:P=E*II+J*hI,q+=P}g.tspan.setAttributeNS(null,"x",g.xcoords.map(l).join(" ")),nI?g.tspan.setAttributeNS(null,"y",g.ycoords.map(l).join(" ")):g.tspan.setAttributeNS(null,"y",l(-g.y)),nI?g.y-=q:g.x+=q*YI,g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${l(g.fontSize)}px`),g.fontStyle!==T.fontStyle&&g.tspan.setAttributeNS(null,"font-style",g.fontStyle),g.fontWeight!==T.fontWeight&&g.tspan.setAttributeNS(null,"font-weight",g.fontWeight);const mI=g.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;if(mI===M.TextRenderingMode.FILL||mI===M.TextRenderingMode.FILL_STROKE?(g.fillColor!==T.fillColor&&g.tspan.setAttributeNS(null,"fill",g.fillColor),g.fillAlpha<1&&g.tspan.setAttributeNS(null,"fill-opacity",g.fillAlpha)):g.textRenderingMode===M.TextRenderingMode.ADD_TO_PATH?g.tspan.setAttributeNS(null,"fill","transparent"):g.tspan.setAttributeNS(null,"fill","none"),mI===M.TextRenderingMode.STROKE||mI===M.TextRenderingMode.FILL_STROKE){const BI=1/(g.textMatrixScale||1);this._setStrokeAttributes(g.tspan,BI)}let NI=g.textMatrix;g.textRise!==0&&(NI=NI.slice(),NI[5]+=g.textRise),g.txtElement.setAttributeNS(null,"transform",`${B(NI)} scale(${l(YI)}, -1)`),g.txtElement.setAttributeNS(r,"xml:space","preserve"),g.txtElement.append(g.tspan),g.txtgrp.append(g.txtElement),this._ensureTransformGroup().append(g.txtElement)}setLeadingMoveText(I,g){this.setLeading(-g),this.moveText(I,g)}addFontStyle(I){if(!I.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const g=D(I.data,I.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${I.loadedName}"; src: url(${g}); }
`}setFont(I){const g=this.current,o=this.commonObjs.get(I[0]);let X=I[1];g.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),g.fontMatrix=o.fontMatrix||M.FONT_IDENTITY_MATRIX;let b="normal";o.black?b="900":o.bold&&(b="bold");const N=o.italic?"italic":"normal";X<0?(X=-X,g.fontDirection=-1):g.fontDirection=1,g.fontSize=X,g.fontFamily=o.loadedName,g.fontWeight=b,g.fontStyle=N,g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"y",l(-g.y)),g.xcoords=[],g.ycoords=[]}endText(){var g;const I=this.current;I.textRenderingMode&M.TextRenderingMode.ADD_TO_PATH_FLAG&&((g=I.txtElement)!=null&&g.hasChildNodes())&&(I.element=I.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(I){I>0&&(this.current.lineWidth=I)}setLineCap(I){this.current.lineCap=p[I]}setLineJoin(I){this.current.lineJoin=j[I]}setMiterLimit(I){this.current.miterLimit=I}setStrokeAlpha(I){this.current.strokeAlpha=I}setStrokeRGBColor(I,g,o){this.current.strokeColor=M.Util.makeHexColor(I,g,o)}setFillAlpha(I){this.current.fillAlpha=I}setFillRGBColor(I,g,o){this.current.fillColor=M.Util.makeHexColor(I,g,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(I){this.current.strokeColor=this._makeColorN_Pattern(I)}setFillColorN(I){this.current.fillColor=this._makeColorN_Pattern(I)}shadingFill(I){const g=this.viewport.width,o=this.viewport.height,X=M.Util.inverseTransform(this.transformMatrix),b=M.Util.applyTransform([0,0],X),N=M.Util.applyTransform([0,o],X),F=M.Util.applyTransform([g,0],X),hI=M.Util.applyTransform([g,o],X),YI=Math.min(b[0],N[0],F[0],hI[0]),nI=Math.min(b[1],N[1],F[1],hI[1]),gI=Math.max(b[0],N[0],F[0],hI[0]),U=Math.max(b[1],N[1],F[1],hI[1]),II=this.svgFactory.createElement("svg:rect");II.setAttributeNS(null,"x",YI),II.setAttributeNS(null,"y",nI),II.setAttributeNS(null,"width",gI-YI),II.setAttributeNS(null,"height",U-nI),II.setAttributeNS(null,"fill",this._makeShadingPattern(I)),this.current.fillAlpha<1&&II.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(II)}_makeColorN_Pattern(I){return I[0]==="TilingPattern"?this._makeTilingPattern(I):this._makeShadingPattern(I)}_makeTilingPattern(I){const g=I[1],o=I[2],X=I[3]||M.IDENTITY_MATRIX,[b,N,F,hI]=I[4],YI=I[5],nI=I[6],gI=I[7],U=`shading${i++}`,[II,q,mI,NI]=M.Util.normalizeRect([...M.Util.applyTransform([b,N],X),...M.Util.applyTransform([F,hI],X)]),[BI,J]=M.Util.singularValueDecompose2dScale(X),e=YI*BI,w=nI*J,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",U),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",e),x.setAttributeNS(null,"height",w),x.setAttributeNS(null,"x",`${II}`),x.setAttributeNS(null,"y",`${q}`);const E=this.svg,P=this.transformMatrix,iI=this.current.fillColor,aI=this.current.strokeColor,eI=this.svgFactory.create(mI-II,NI-q);if(this.svg=eI,this.transformMatrix=X,gI===2){const A=M.Util.makeHexColor(...g);this.current.fillColor=A,this.current.strokeColor=A}return this.executeOpTree(this.convertOpList(o)),this.svg=E,this.transformMatrix=P,this.current.fillColor=iI,this.current.strokeColor=aI,x.append(eI.childNodes[0]),this.defs.append(x),`url(#${U})`}_makeShadingPattern(I){switch(typeof I=="string"&&(I=this.objs.get(I)),I[0]){case"RadialAxial":const g=`shading${i++}`,o=I[3];let X;switch(I[1]){case"axial":const b=I[4],N=I[5];X=this.svgFactory.createElement("svg:linearGradient"),X.setAttributeNS(null,"id",g),X.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),X.setAttributeNS(null,"x1",b[0]),X.setAttributeNS(null,"y1",b[1]),X.setAttributeNS(null,"x2",N[0]),X.setAttributeNS(null,"y2",N[1]);break;case"radial":const F=I[4],hI=I[5],YI=I[6],nI=I[7];X=this.svgFactory.createElement("svg:radialGradient"),X.setAttributeNS(null,"id",g),X.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),X.setAttributeNS(null,"cx",hI[0]),X.setAttributeNS(null,"cy",hI[1]),X.setAttributeNS(null,"r",nI),X.setAttributeNS(null,"fx",F[0]),X.setAttributeNS(null,"fy",F[1]),X.setAttributeNS(null,"fr",YI);break;default:throw new Error(`Unknown RadialAxial type: ${I[1]}`)}for(const b of o){const N=this.svgFactory.createElement("svg:stop");N.setAttributeNS(null,"offset",b[0]),N.setAttributeNS(null,"stop-color",b[1]),X.append(N)}return this.defs.append(X),`url(#${g})`;case"Mesh":return(0,M.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${I[0]}`)}}setDash(I,g){this.current.dashArray=I,this.current.dashPhase=g}constructPath(I,g){const o=this.current;let X=o.x,b=o.y,N=[],F=0;for(const hI of I)switch(hI|0){case M.OPS.rectangle:X=g[F++],b=g[F++];const YI=g[F++],nI=g[F++],gI=X+YI,U=b+nI;N.push("M",l(X),l(b),"L",l(gI),l(b),"L",l(gI),l(U),"L",l(X),l(U),"Z");break;case M.OPS.moveTo:X=g[F++],b=g[F++],N.push("M",l(X),l(b));break;case M.OPS.lineTo:X=g[F++],b=g[F++],N.push("L",l(X),l(b));break;case M.OPS.curveTo:X=g[F+4],b=g[F+5],N.push("C",l(g[F]),l(g[F+1]),l(g[F+2]),l(g[F+3]),l(X),l(b)),F+=6;break;case M.OPS.curveTo2:N.push("C",l(X),l(b),l(g[F]),l(g[F+1]),l(g[F+2]),l(g[F+3])),X=g[F+2],b=g[F+3],F+=4;break;case M.OPS.curveTo3:X=g[F+2],b=g[F+3],N.push("C",l(g[F]),l(g[F+1]),l(X),l(b),l(X),l(b)),F+=4;break;case M.OPS.closePath:N.push("Z");break}N=N.join(" "),o.path&&I.length>0&&I[0]!==M.OPS.rectangle&&I[0]!==M.OPS.moveTo?N=o.path.getAttributeNS(null,"d")+N:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",N),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(X,b)}endPath(){const I=this.current;if(I.path=null,!this.pendingClip)return;if(!I.element){this.pendingClip=null;return}const g=`clippath${Y++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",g),o.setAttributeNS(null,"transform",B(this.transformMatrix));const X=I.element.cloneNode(!0);if(this.pendingClip==="evenodd"?X.setAttributeNS(null,"clip-rule","evenodd"):X.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(X),this.defs.append(o),I.activeClipUrl){I.clipGroup=null;for(const b of this.extraStack)b.clipGroup=null;o.setAttributeNS(null,"clip-path",I.activeClipUrl)}I.activeClipUrl=`url(#${g})`,this.tgrp=null}clip(I){this.pendingClip=I}closePath(){const I=this.current;if(I.path){const g=`${I.path.getAttributeNS(null,"d")}Z`;I.path.setAttributeNS(null,"d",g)}}setLeading(I){this.current.leading=-I}setTextRise(I){this.current.textRise=I}setTextRenderingMode(I){this.current.textRenderingMode=I}setHScale(I){this.current.textHScale=I/100}setRenderingIntent(I){}setFlatness(I){}setGState(I){for(const[g,o]of I)switch(g){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,M.warn)(`Unimplemented graphic state operator ${g}`);break}}fill(){const I=this.current;I.element&&(I.element.setAttributeNS(null,"fill",I.fillColor),I.element.setAttributeNS(null,"fill-opacity",I.fillAlpha),this.endPath())}stroke(){const I=this.current;I.element&&(this._setStrokeAttributes(I.element),I.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(I,g=1){const o=this.current;let X=o.dashArray;g!==1&&X.length>0&&(X=X.map(function(b){return g*b})),I.setAttributeNS(null,"stroke",o.strokeColor),I.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),I.setAttributeNS(null,"stroke-miterlimit",l(o.miterLimit)),I.setAttributeNS(null,"stroke-linecap",o.lineCap),I.setAttributeNS(null,"stroke-linejoin",o.lineJoin),I.setAttributeNS(null,"stroke-width",l(g*o.lineWidth)+"px"),I.setAttributeNS(null,"stroke-dasharray",X.map(l).join(" ")),I.setAttributeNS(null,"stroke-dashoffset",l(g*o.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width","1px"),I.setAttributeNS(null,"height","1px"),I.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(I)}paintImageXObject(I){const g=I.startsWith("g_")?this.commonObjs.get(I):this.objs.get(I);if(!g){(0,M.warn)(`Dependent image with object ID ${I} is not ready yet`);return}this.paintInlineImageXObject(g)}paintInlineImageXObject(I,g){const o=I.width,X=I.height,b=m(I,this.forceDataSchema,!!g),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",l(o)),N.setAttributeNS(null,"height",l(X)),this.current.element=N,this.clip("nonzero");const F=this.svgFactory.createElement("svg:image");F.setAttributeNS(Z,"xlink:href",b),F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y",l(-X)),F.setAttributeNS(null,"width",l(o)+"px"),F.setAttributeNS(null,"height",l(X)+"px"),F.setAttributeNS(null,"transform",`scale(${l(1/o)} ${l(-1/X)})`),g?g.append(F):this._ensureTransformGroup().append(F)}paintImageMaskXObject(I){const g=this.current,o=I.width,X=I.height,b=g.fillColor;g.maskId=`mask${a++}`;const N=this.svgFactory.createElement("svg:mask");N.setAttributeNS(null,"id",g.maskId);const F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",l(o)),F.setAttributeNS(null,"height",l(X)),F.setAttributeNS(null,"fill",b),F.setAttributeNS(null,"mask",`url(#${g.maskId})`),this.defs.append(N),this._ensureTransformGroup().append(F),this.paintInlineImageXObject(I,N)}paintFormXObjectBegin(I,g){if(Array.isArray(I)&&I.length===6&&this.transform(I[0],I[1],I[2],I[3],I[4],I[5]),g){const o=g[2]-g[0],X=g[3]-g[1],b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x",g[0]),b.setAttributeNS(null,"y",g[1]),b.setAttributeNS(null,"width",l(o)),b.setAttributeNS(null,"height",l(X)),this.current.element=b,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(I){const g=this.svgFactory.create(I.width,I.height),o=this.svgFactory.createElement("svg:defs");g.append(o),this.defs=o;const X=this.svgFactory.createElement("svg:g");return X.setAttributeNS(null,"transform",B(I.transform)),g.append(X),this.svg=X,g}_ensureClipGroup(){if(!this.current.clipGroup){const I=this.svgFactory.createElement("svg:g");I.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(I),this.current.clipGroup=I}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",B(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNodeStream=void 0;var h=$(1),M=$(33);const _=require$$5$1,z=require$$5$1,T=require$$5$1,r=require$$5$1,Z=/^file:\/\/\/[a-zA-Z]:\//;function p(a){const i=r.parse(a);return i.protocol==="file:"||i.host?i:/^[a-z]:[/\\]/i.test(a)?r.parse(`file:///${a}`):(i.host||(i.protocol="file:"),i)}class j{constructor(i){this.source=i,this.url=p(i.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&i.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var i;return((i=this._fullRequestReader)==null?void 0:i._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new B(this):new C(this),this._fullRequestReader}getRangeReader(i,I){if(I<=this._progressiveDataLength)return null;const g=this.isFsUrl?new Y(this,i,I):new l(this,i,I);return this._rangeRequestReaders.push(g),g}cancelAllRequests(i){this._fullRequestReader&&this._fullRequestReader.cancel(i);for(const I of this._rangeRequestReaders.slice(0))I.cancel(i)}}c.PDFNodeStream=j;class D{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null;const I=i.source;this._contentLength=I.length,this._loaded=0,this._filename=null,this._disableRange=I.disableRange||!1,this._rangeChunkSize=I.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!I.disableStream,this._isRangeSupported=!I.disableRange,this._readableStream=null,this._readCapability=(0,h.createPromiseCapability)(),this._headersCapability=(0,h.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,h.createPromiseCapability)(),this.read()):(this._loaded+=i.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){if(!this._readableStream){this._error(i);return}this._readableStream.destroy(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",I=>{this._error(I)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new h.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class m{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,h.createPromiseCapability)();const I=i.source;this._isStreamingSupported=!I.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,h.createPromiseCapability)(),this.read()):(this._loaded+=i.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){if(!this._readableStream){this._error(i);return}this._readableStream.destroy(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",I=>{this._error(I)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(a,i){return{protocol:a.protocol,auth:a.auth,host:a.hostname,port:a.port,path:a.path,method:"GET",headers:i}}class C extends D{constructor(i){super(i);const I=g=>{if(g.statusCode===404){const N=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=N,this._headersCapability.reject(N);return}this._headersCapability.resolve(),this._setReadableStream(g);const o=N=>this._readableStream.headers[N.toLowerCase()],{allowRangeRequests:X,suggestedLength:b}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:i.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=X,this._contentLength=b||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(o)};this._request=null,this._url.protocol==="http:"?this._request=z.request(d(this._url,i.httpHeaders),I):this._request=T.request(d(this._url,i.httpHeaders),I),this._request.on("error",g=>{this._storedError=g,this._headersCapability.reject(g)}),this._request.end()}}class l extends m{constructor(i,I,g){super(i),this._httpHeaders={};for(const X in i.httpHeaders){const b=i.httpHeaders[X];typeof b>"u"||(this._httpHeaders[X]=b)}this._httpHeaders.Range=`bytes=${I}-${g-1}`;const o=X=>{if(X.statusCode===404){const b=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b;return}this._setReadableStream(X)};this._request=null,this._url.protocol==="http:"?this._request=z.request(d(this._url,this._httpHeaders),o):this._request=T.request(d(this._url,this._httpHeaders),o),this._request.on("error",X=>{this._storedError=X}),this._request.end()}}class B extends D{constructor(i){super(i);let I=decodeURIComponent(this._url.path);Z.test(this._url.href)&&(I=I.replace(/^\//,"")),_.lstat(I,(g,o)=>{if(g){g.code==="ENOENT"&&(g=new h.MissingPDFException(`Missing PDF "${I}".`)),this._storedError=g,this._headersCapability.reject(g);return}this._contentLength=o.size,this._setReadableStream(_.createReadStream(I)),this._headersCapability.resolve()})}}class Y extends m{constructor(i,I,g){super(i);let o=decodeURIComponent(this._url.path);Z.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(_.createReadStream(o,{start:I,end:g-1}))}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createResponseStatusError=r,c.extractFilenameFromHeader=T,c.validateRangeRequestCapabilities=z,c.validateResponseStatus=Z;var h=$(1),M=$(34),_=$(8);function z({getResponseHeader:p,isHttp:j,rangeChunkSize:D,disableRange:m}){const d={allowRangeRequests:!1,suggestedLength:void 0},C=parseInt(p("Content-Length"),10);return!Number.isInteger(C)||(d.suggestedLength=C,C<=2*D)||m||!j||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(d.allowRangeRequests=!0),d}function T(p){const j=p("Content-Disposition");if(j){let D=(0,M.getFilenameFromContentDispositionHeader)(j);if(D.includes("%"))try{D=decodeURIComponent(D)}catch{}if((0,_.isPdfFile)(D))return D}return null}function r(p,j){return p===404||p===0&&j.startsWith("file:")?new h.MissingPDFException('Missing PDF "'+j+'".'):new h.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${j}".`,p)}function Z(p){return p===200||p===206}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getFilenameFromContentDispositionHeader=M;var h=$(1);function M(_){let z=!0,T=r("filename\\*","i").exec(_);if(T){T=T[1];let C=D(T);return C=unescape(C),C=m(C),C=d(C),p(C)}if(T=j(_),T){const C=d(T);return p(C)}if(T=r("filename","i").exec(_),T){T=T[1];let C=D(T);return C=d(C),p(C)}function r(C,l){return new RegExp("(?:^|;)\\s*"+C+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',l)}function Z(C,l){if(C){if(!/^[\x00-\xFF]+$/.test(l))return l;try{const B=new TextDecoder(C,{fatal:!0}),Y=(0,h.stringToBytes)(l);l=B.decode(Y),z=!1}catch{}}return l}function p(C){return z&&/[\x80-\xff]/.test(C)&&(C=Z("utf-8",C),z&&(C=Z("iso-8859-1",C))),C}function j(C){const l=[];let B;const Y=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(B=Y.exec(C))!==null;){let[,i,I,g]=B;if(i=parseInt(i,10),i in l){if(i===0)break;continue}l[i]=[I,g]}const a=[];for(let i=0;i<l.length&&i in l;++i){let[I,g]=l[i];g=D(g),I&&(g=unescape(g),i===0&&(g=m(g))),a.push(g)}return a.join("")}function D(C){if(C.startsWith('"')){const l=C.slice(1).split('\\"');for(let B=0;B<l.length;++B){const Y=l[B].indexOf('"');Y!==-1&&(l[B]=l[B].slice(0,Y),l.length=B+1),l[B]=l[B].replace(/\\(.)/g,"$1")}C=l.join('"')}return C}function m(C){const l=C.indexOf("'");if(l===-1)return C;const B=C.slice(0,l),a=C.slice(l+1).replace(/^[^']*'/,"");return Z(B,a)}function d(C){return!C.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(C)?C:C.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(l,B,Y,a){if(Y==="q"||Y==="Q")return a=a.replace(/_/g," "),a=a.replace(/=([0-9a-fA-F]{2})/g,function(i,I){return String.fromCharCode(parseInt(I,16))}),Z(B,a);try{a=atob(a)}catch{}return Z(B,a)})}return""}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNetworkStream=void 0;var h=$(1),M=$(33);const _=200,z=206;function T(D){const m=D.response;return typeof m!="string"?m:(0,h.stringToBytes)(m).buffer}class r{constructor(m,d={}){this.url=m,this.isHttp=/^https?:/i.test(m),this.httpHeaders=this.isHttp&&d.httpHeaders||Object.create(null),this.withCredentials=d.withCredentials||!1,this.getXhr=d.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(m,d,C){const l={begin:m,end:d};for(const B in C)l[B]=C[B];return this.request(l)}requestFull(m){return this.request(m)}request(m){const d=this.getXhr(),C=this.currXhrId++,l=this.pendingRequests[C]={xhr:d};d.open("GET",this.url),d.withCredentials=this.withCredentials;for(const B in this.httpHeaders){const Y=this.httpHeaders[B];typeof Y>"u"||d.setRequestHeader(B,Y)}return this.isHttp&&"begin"in m&&"end"in m?(d.setRequestHeader("Range",`bytes=${m.begin}-${m.end-1}`),l.expectedStatus=z):l.expectedStatus=_,d.responseType="arraybuffer",m.onError&&(d.onerror=function(B){m.onError(d.status)}),d.onreadystatechange=this.onStateChange.bind(this,C),d.onprogress=this.onProgress.bind(this,C),l.onHeadersReceived=m.onHeadersReceived,l.onDone=m.onDone,l.onError=m.onError,l.onProgress=m.onProgress,d.send(null),C}onProgress(m,d){var l;const C=this.pendingRequests[m];C&&((l=C.onProgress)==null||l.call(C,d))}onStateChange(m,d){var i,I,g;const C=this.pendingRequests[m];if(!C)return;const l=C.xhr;if(l.readyState>=2&&C.onHeadersReceived&&(C.onHeadersReceived(),delete C.onHeadersReceived),l.readyState!==4||!(m in this.pendingRequests))return;if(delete this.pendingRequests[m],l.status===0&&this.isHttp){(i=C.onError)==null||i.call(C,l.status);return}const B=l.status||_;if(!(B===_&&C.expectedStatus===z)&&B!==C.expectedStatus){(I=C.onError)==null||I.call(C,l.status);return}const a=T(l);if(B===z){const o=l.getResponseHeader("Content-Range"),X=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);C.onDone({begin:parseInt(X[1],10),chunk:a})}else a?C.onDone({begin:0,chunk:a}):(g=C.onError)==null||g.call(C,l.status)}getRequestXhr(m){return this.pendingRequests[m].xhr}isPendingRequest(m){return m in this.pendingRequests}abortRequest(m){const d=this.pendingRequests[m].xhr;delete this.pendingRequests[m],d.abort()}}class Z{constructor(m){this._source=m,this._manager=new r(m.url,{httpHeaders:m.httpHeaders,withCredentials:m.withCredentials}),this._rangeChunkSize=m.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(m){const d=this._rangeRequestReaders.indexOf(m);d>=0&&this._rangeRequestReaders.splice(d,1)}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(m,d){const C=new j(this._manager,m,d);return C.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(C),C}cancelAllRequests(m){var d;(d=this._fullRequestReader)==null||d.cancel(m);for(const C of this._rangeRequestReaders.slice(0))C.cancel(m)}}c.PDFNetworkStream=Z;class p{constructor(m,d){this._manager=m;const C={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._fullRequestId=m.requestFull(C),this._headersReceivedCapability=(0,h.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._contentLength=d.length,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const m=this._fullRequestId,d=this._manager.getRequestXhr(m),C=Y=>d.getResponseHeader(Y),{allowRangeRequests:l,suggestedLength:B}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=B||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(C),this._isRangeSupported&&this._manager.abortRequest(m),this._headersReceivedCapability.resolve()}_onDone(m){if(m&&(this._requests.length>0?this._requests.shift().resolve({value:m.chunk,done:!1}):this._cachedChunks.push(m.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(m){this._storedError=(0,M.createResponseStatusError)(m,this._url),this._headersReceivedCapability.reject(this._storedError);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(m){var d;(d=this.onProgress)==null||d.call(this,{loaded:m.loaded,total:m.lengthComputable?m.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=(0,h.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0,this._headersReceivedCapability.reject(m);for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(m,d,C){this._manager=m;const l={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._requestId=m.requestRange(d,C,l),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var m;(m=this.onClosed)==null||m.call(this,this)}_onDone(m){const d=m.chunk;this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunk=d,this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(m){this._storedError=(0,M.createResponseStatusError)(m,this._url);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(m){var d;this.isStreamingSupported||(d=this.onProgress)==null||d.call(this,{loaded:m.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const m=(0,h.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFFetchStream=void 0;var h=$(1),M=$(33);function _(p,j,D){return{method:"GET",headers:p,signal:D.signal,mode:"cors",credentials:j?"include":"same-origin",redirect:"follow"}}function z(p){const j=new Headers;for(const D in p){const m=p[D];typeof m>"u"||j.append(D,m)}return j}class T{constructor(j){this.source=j,this.isHttp=/^https?:/i.test(j.url),this.httpHeaders=this.isHttp&&j.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var j;return((j=this._fullRequestReader)==null?void 0:j._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new r(this),this._fullRequestReader}getRangeReader(j,D){if(D<=this._progressiveDataLength)return null;const m=new Z(this,j,D);return this._rangeRequestReaders.push(m),m}cancelAllRequests(j){this._fullRequestReader&&this._fullRequestReader.cancel(j);for(const D of this._rangeRequestReaders.slice(0))D.cancel(j)}}c.PDFFetchStream=T;class r{constructor(j){this._stream=j,this._reader=null,this._loaded=0,this._filename=null;const D=j.source;this._withCredentials=D.withCredentials||!1,this._contentLength=D.length,this._headersCapability=(0,h.createPromiseCapability)(),this._disableRange=D.disableRange||!1,this._rangeChunkSize=D.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!D.disableStream,this._isRangeSupported=!D.disableRange,this._headers=z(this._stream.httpHeaders);const m=D.url;fetch(m,_(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,M.validateResponseStatus)(d.status))throw(0,M.createResponseStatusError)(d.status,m);this._reader=d.body.getReader(),this._headersCapability.resolve();const C=Y=>d.headers.get(Y),{allowRangeRequests:l,suggestedLength:B}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=B||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(C),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new h.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:j,done:D}=await this._reader.read();return D?{value:j,done:D}:(this._loaded+=j.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){this._reader&&this._reader.cancel(j),this._abortController.abort()}}class Z{constructor(j,D,m){this._stream=j,this._reader=null,this._loaded=0;const d=j.source;this._withCredentials=d.withCredentials||!1,this._readCapability=(0,h.createPromiseCapability)(),this._isStreamingSupported=!d.disableStream,this._abortController=new AbortController,this._headers=z(this._stream.httpHeaders),this._headers.append("Range",`bytes=${D}-${m-1}`);const C=d.url;fetch(C,_(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,M.validateResponseStatus)(l.status))throw(0,M.createResponseStatusError)(l.status,C);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:j,done:D}=await this._reader.read();return D?{value:j,done:D}:(this._loaded+=j.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){this._reader&&this._reader.cancel(j),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(wI){var c=__webpack_module_cache__[wI];if(c!==void 0)return c.exports;var $=__webpack_module_cache__[wI]={exports:{}};return __webpack_modules__[wI]($,$.exports,__w_pdfjs_require__),$.exports}var __webpack_exports__={};return(()=>{var wI=__webpack_exports__;Object.defineProperty(wI,"__esModule",{value:!0}),Object.defineProperty(wI,"AnnotationEditorLayer",{enumerable:!0,get:function(){return M.AnnotationEditorLayer}}),Object.defineProperty(wI,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return c.AnnotationEditorParamsType}}),Object.defineProperty(wI,"AnnotationEditorType",{enumerable:!0,get:function(){return c.AnnotationEditorType}}),Object.defineProperty(wI,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _.AnnotationEditorUIManager}}),Object.defineProperty(wI,"AnnotationLayer",{enumerable:!0,get:function(){return z.AnnotationLayer}}),Object.defineProperty(wI,"AnnotationMode",{enumerable:!0,get:function(){return c.AnnotationMode}}),Object.defineProperty(wI,"CMapCompressionType",{enumerable:!0,get:function(){return c.CMapCompressionType}}),Object.defineProperty(wI,"GlobalWorkerOptions",{enumerable:!0,get:function(){return T.GlobalWorkerOptions}}),Object.defineProperty(wI,"InvalidPDFException",{enumerable:!0,get:function(){return c.InvalidPDFException}}),Object.defineProperty(wI,"LoopbackPort",{enumerable:!0,get:function(){return $.LoopbackPort}}),Object.defineProperty(wI,"MissingPDFException",{enumerable:!0,get:function(){return c.MissingPDFException}}),Object.defineProperty(wI,"OPS",{enumerable:!0,get:function(){return c.OPS}}),Object.defineProperty(wI,"PDFDataRangeTransport",{enumerable:!0,get:function(){return $.PDFDataRangeTransport}}),Object.defineProperty(wI,"PDFDateString",{enumerable:!0,get:function(){return h.PDFDateString}}),Object.defineProperty(wI,"PDFWorker",{enumerable:!0,get:function(){return $.PDFWorker}}),Object.defineProperty(wI,"PasswordResponses",{enumerable:!0,get:function(){return c.PasswordResponses}}),Object.defineProperty(wI,"PermissionFlag",{enumerable:!0,get:function(){return c.PermissionFlag}}),Object.defineProperty(wI,"PixelsPerInch",{enumerable:!0,get:function(){return h.PixelsPerInch}}),Object.defineProperty(wI,"RenderingCancelledException",{enumerable:!0,get:function(){return h.RenderingCancelledException}}),Object.defineProperty(wI,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(wI,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return c.UNSUPPORTED_FEATURES}}),Object.defineProperty(wI,"UnexpectedResponseException",{enumerable:!0,get:function(){return c.UnexpectedResponseException}}),Object.defineProperty(wI,"Util",{enumerable:!0,get:function(){return c.Util}}),Object.defineProperty(wI,"VerbosityLevel",{enumerable:!0,get:function(){return c.VerbosityLevel}}),Object.defineProperty(wI,"XfaLayer",{enumerable:!0,get:function(){return j.XfaLayer}}),Object.defineProperty(wI,"build",{enumerable:!0,get:function(){return $.build}}),Object.defineProperty(wI,"createPromiseCapability",{enumerable:!0,get:function(){return c.createPromiseCapability}}),Object.defineProperty(wI,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return c.createValidAbsoluteUrl}}),Object.defineProperty(wI,"getDocument",{enumerable:!0,get:function(){return $.getDocument}}),Object.defineProperty(wI,"getFilenameFromUrl",{enumerable:!0,get:function(){return h.getFilenameFromUrl}}),Object.defineProperty(wI,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return h.getPdfFilenameFromUrl}}),Object.defineProperty(wI,"getXfaPageViewport",{enumerable:!0,get:function(){return h.getXfaPageViewport}}),Object.defineProperty(wI,"isPdfFile",{enumerable:!0,get:function(){return h.isPdfFile}}),Object.defineProperty(wI,"loadScript",{enumerable:!0,get:function(){return h.loadScript}}),Object.defineProperty(wI,"renderTextLayer",{enumerable:!0,get:function(){return Z.renderTextLayer}}),Object.defineProperty(wI,"shadow",{enumerable:!0,get:function(){return c.shadow}}),Object.defineProperty(wI,"version",{enumerable:!0,get:function(){return $.version}});var c=__w_pdfjs_require__(1),$=__w_pdfjs_require__(4),h=__w_pdfjs_require__(8),M=__w_pdfjs_require__(22),_=__w_pdfjs_require__(7),z=__w_pdfjs_require__(27),T=__w_pdfjs_require__(15),r=__w_pdfjs_require__(3),Z=__w_pdfjs_require__(30),p=__w_pdfjs_require__(31),j=__w_pdfjs_require__(29);if(r.isNodeJS){const{PDFNodeStream:D}=__w_pdfjs_require__(32);(0,$.setPDFNetworkStreamFactory)(m=>new D(m))}else{const{PDFNetworkStream:D}=__w_pdfjs_require__(35),{PDFFetchStream:m}=__w_pdfjs_require__(36);(0,$.setPDFNetworkStreamFactory)(d=>(0,h.isValidFetchUrl)(d.url)?new m(d):new D(d))}})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf_viewer$1="";var nC=Object.defineProperty,RC=(wI,c,$)=>c in wI?nC(wI,c,{enumerable:!0,configurable:!0,writable:!0,value:$}):wI[c]=$,QI=(wI,c,$)=>(RC(wI,typeof c!="symbol"?c+"":c,$),$),mg=(wI,c,$)=>{if(!c.has(wI))throw TypeError("Cannot "+$)},R=(wI,c,$)=>(mg(wI,c,"read from private field"),$?$.call(wI):c.get(wI)),GI=(wI,c,$)=>{if(c.has(wI))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(wI):c.set(wI,$)},XI=(wI,c,$,h)=>(mg(wI,c,"write to private field"),h?h.call(wI,$):c.set(wI,$),$),wg=(wI,c,$,h)=>({set _(M){XI(wI,c,M,$)},get _(){return R(wI,c,h)}}),bI=(wI,c,$)=>(mg(wI,c,"access private method"),$);function getAugmentedNamespace(wI){if(wI.__esModule)return wI;var c=wI.default;if(typeof c=="function"){var $=function h(){if(this instanceof h){var M=[null];M.push.apply(M,arguments);var _=Function.bind.apply(c,M);return new _}return c.apply(this,arguments)};$.prototype=c.prototype}else $={};return Object.defineProperty($,"__esModule",{value:!0}),Object.keys(wI).forEach(function(h){var M=Object.getOwnPropertyDescriptor(wI,h);Object.defineProperty($,h,M.get?M:{enumerable:!0,get:function(){return wI[h]}})}),$}var pdf_viewer={exports:{}};function commonjsRequire(wI){throw new Error('Could not dynamically require "'+wI+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(wI,c){module.exports=c()})(globalThis,()=>(()=>{var __webpack_modules__=[,(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.VerbosityLevel=c.Util=c.UnknownErrorException=c.UnexpectedResponseException=c.UNSUPPORTED_FEATURES=c.TextRenderingMode=c.StreamType=c.RenderingIntentFlag=c.PermissionFlag=c.PasswordResponses=c.PasswordException=c.PageActionEventType=c.OPS=c.MissingPDFException=c.LINE_FACTOR=c.LINE_DESCENT_FACTOR=c.InvalidPDFException=c.ImageKind=c.IDENTITY_MATRIX=c.FormatError=c.FontType=c.FeatureTest=c.FONT_IDENTITY_MATRIX=c.DocumentActionEventType=c.CMapCompressionType=c.BaseException=c.AnnotationType=c.AnnotationStateModelType=c.AnnotationReviewState=c.AnnotationReplyType=c.AnnotationMode=c.AnnotationMarkedState=c.AnnotationFlag=c.AnnotationFieldFlag=c.AnnotationEditorType=c.AnnotationEditorPrefix=c.AnnotationEditorParamsType=c.AnnotationBorderStyleType=c.AnnotationActionEventType=c.AbortException=void 0,c.arrayByteLength=uI,c.arraysToBytes=MI,c.assert=e,c.bytesToString=Q,c.createPromiseCapability=HI,c.createValidAbsoluteUrl=x,c.escapeString=TI,c.getModificationDate=yI,c.getVerbosityLevel=mI,c.info=NI,c.isArrayBuffer=SI,c.isArrayEqual=JI,c.isAscii=vI,c.objectFromMap=tI,c.objectSize=WI,c.setVerbosityLevel=q,c.shadow=E,c.string32=ZI,c.stringToBytes=lI,c.stringToPDFString=FI,c.stringToUTF16BEString=fI,c.stringToUTF8String=PI,c.unreachable=J,c.utf8StringToString=EI,c.warn=BI,$(2);const h=[1,0,0,1,0,0];c.IDENTITY_MATRIX=h;const M=[.001,0,0,.001,0,0];c.FONT_IDENTITY_MATRIX=M;const _=1.35;c.LINE_FACTOR=_;const z=.35;c.LINE_DESCENT_FACTOR=z;const T={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};c.RenderingIntentFlag=T;const r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};c.AnnotationMode=r;const Z="pdfjs_internal_editor_";c.AnnotationEditorPrefix=Z;const p={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};c.AnnotationEditorType=p;const j={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};c.AnnotationEditorParamsType=j;const D={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};c.PermissionFlag=D;const m={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};c.TextRenderingMode=m;const d={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};c.ImageKind=d;const C={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};c.AnnotationType=C;const l={MARKED:"Marked",REVIEW:"Review"};c.AnnotationStateModelType=l;const B={MARKED:"Marked",UNMARKED:"Unmarked"};c.AnnotationMarkedState=B;const Y={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};c.AnnotationReviewState=Y;const a={GROUP:"Group",REPLY:"R"};c.AnnotationReplyType=a;const i={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};c.AnnotationFlag=i;const I={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};c.AnnotationFieldFlag=I;const g={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};c.AnnotationBorderStyleType=g;const o={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};c.AnnotationActionEventType=o;const X={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};c.DocumentActionEventType=X;const b={O:"PageOpen",C:"PageClose"};c.PageActionEventType=b;const N={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};c.StreamType=N;const F={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};c.FontType=F;const hI={ERRORS:0,WARNINGS:1,INFOS:5};c.VerbosityLevel=hI;const YI={NONE:0,BINARY:1,STREAM:2};c.CMapCompressionType=YI;const nI={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};c.OPS=nI;const gI={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};c.UNSUPPORTED_FEATURES=gI;const U={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};c.PasswordResponses=U;let II=hI.WARNINGS;function q(cI){Number.isInteger(cI)&&(II=cI)}function mI(){return II}function NI(cI){II>=hI.INFOS&&console.log(`Info: ${cI}`)}function BI(cI){II>=hI.WARNINGS&&console.log(`Warning: ${cI}`)}function J(cI){throw new Error(cI)}function e(cI,CI){cI||J(CI)}function w(cI){if(!cI)return!1;switch(cI.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function x(cI,CI=null,AI=null){if(!cI)return null;try{if(AI&&typeof cI=="string"){if(AI.addDefaultProtocol&&cI.startsWith("www.")){const LI=cI.match(/\./g);LI&&LI.length>=2&&(cI=`http://${cI}`)}if(AI.tryConvertEncoding)try{cI=PI(cI)}catch{}}const KI=CI?new URL(cI,CI):new URL(cI);if(w(KI))return KI}catch{}return null}function E(cI,CI,AI){return Object.defineProperty(cI,CI,{value:AI,enumerable:!0,configurable:!0,writable:!1}),AI}const P=function(){function cI(CI,AI){this.constructor===cI&&J("Cannot initialize BaseException."),this.message=CI,this.name=AI}return cI.prototype=new Error,cI.constructor=cI,cI}();c.BaseException=P;class iI extends P{constructor(CI,AI){super(CI,"PasswordException"),this.code=AI}}c.PasswordException=iI;class aI extends P{constructor(CI,AI){super(CI,"UnknownErrorException"),this.details=AI}}c.UnknownErrorException=aI;class eI extends P{constructor(CI){super(CI,"InvalidPDFException")}}c.InvalidPDFException=eI;class A extends P{constructor(CI){super(CI,"MissingPDFException")}}c.MissingPDFException=A;class W extends P{constructor(CI,AI){super(CI,"UnexpectedResponseException"),this.status=AI}}c.UnexpectedResponseException=W;class L extends P{constructor(CI){super(CI,"FormatError")}}c.FormatError=L;class S extends P{constructor(CI){super(CI,"AbortException")}}c.AbortException=S;function Q(cI){(typeof cI!="object"||cI===null||cI.length===void 0)&&J("Invalid argument for bytesToString");const CI=cI.length,AI=8192;if(CI<AI)return String.fromCharCode.apply(null,cI);const KI=[];for(let LI=0;LI<CI;LI+=AI){const rI=Math.min(LI+AI,CI),kI=cI.subarray(LI,rI);KI.push(String.fromCharCode.apply(null,kI))}return KI.join("")}function lI(cI){typeof cI!="string"&&J("Invalid argument for stringToBytes");const CI=cI.length,AI=new Uint8Array(CI);for(let KI=0;KI<CI;++KI)AI[KI]=cI.charCodeAt(KI)&255;return AI}function uI(cI){if(cI.length!==void 0)return cI.length;if(cI.byteLength!==void 0)return cI.byteLength;J("Invalid argument for arrayByteLength")}function MI(cI){const CI=cI.length;if(CI===1&&cI[0]instanceof Uint8Array)return cI[0];let AI=0;for(let rI=0;rI<CI;rI++)AI+=uI(cI[rI]);let KI=0;const LI=new Uint8Array(AI);for(let rI=0;rI<CI;rI++){let kI=cI[rI];kI instanceof Uint8Array||(typeof kI=="string"?kI=lI(kI):kI=new Uint8Array(kI));const xI=kI.byteLength;LI.set(kI,KI),KI+=xI}return LI}function ZI(cI){return String.fromCharCode(cI>>24&255,cI>>16&255,cI>>8&255,cI&255)}function WI(cI){return Object.keys(cI).length}function tI(cI){const CI=Object.create(null);for(const[AI,KI]of cI)CI[AI]=KI;return CI}function O(){const cI=new Uint8Array(4);return cI[0]=1,new Uint32Array(cI.buffer,0,1)[0]===1}function f(){try{return new Function(""),!0}catch{return!1}}class v{static get isLittleEndian(){return E(this,"isLittleEndian",O())}static get isEvalSupported(){return E(this,"isEvalSupported",f())}static get isOffscreenCanvasSupported(){return E(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}c.FeatureTest=v;const RI=[...Array(256).keys()].map(cI=>cI.toString(16).padStart(2,"0"));class pI{static makeHexColor(CI,AI,KI){return`#${RI[CI]}${RI[AI]}${RI[KI]}`}static scaleMinMax(CI,AI){let KI;CI[0]?(CI[0]<0&&(KI=AI[0],AI[0]=AI[1],AI[1]=KI),AI[0]*=CI[0],AI[1]*=CI[0],CI[3]<0&&(KI=AI[2],AI[2]=AI[3],AI[3]=KI),AI[2]*=CI[3],AI[3]*=CI[3]):(KI=AI[0],AI[0]=AI[2],AI[2]=KI,KI=AI[1],AI[1]=AI[3],AI[3]=KI,CI[1]<0&&(KI=AI[2],AI[2]=AI[3],AI[3]=KI),AI[2]*=CI[1],AI[3]*=CI[1],CI[2]<0&&(KI=AI[0],AI[0]=AI[1],AI[1]=KI),AI[0]*=CI[2],AI[1]*=CI[2]),AI[0]+=CI[4],AI[1]+=CI[4],AI[2]+=CI[5],AI[3]+=CI[5]}static transform(CI,AI){return[CI[0]*AI[0]+CI[2]*AI[1],CI[1]*AI[0]+CI[3]*AI[1],CI[0]*AI[2]+CI[2]*AI[3],CI[1]*AI[2]+CI[3]*AI[3],CI[0]*AI[4]+CI[2]*AI[5]+CI[4],CI[1]*AI[4]+CI[3]*AI[5]+CI[5]]}static applyTransform(CI,AI){const KI=CI[0]*AI[0]+CI[1]*AI[2]+AI[4],LI=CI[0]*AI[1]+CI[1]*AI[3]+AI[5];return[KI,LI]}static applyInverseTransform(CI,AI){const KI=AI[0]*AI[3]-AI[1]*AI[2],LI=(CI[0]*AI[3]-CI[1]*AI[2]+AI[2]*AI[5]-AI[4]*AI[3])/KI,rI=(-CI[0]*AI[1]+CI[1]*AI[0]+AI[4]*AI[1]-AI[5]*AI[0])/KI;return[LI,rI]}static getAxialAlignedBoundingBox(CI,AI){const KI=pI.applyTransform(CI,AI),LI=pI.applyTransform(CI.slice(2,4),AI),rI=pI.applyTransform([CI[0],CI[3]],AI),kI=pI.applyTransform([CI[2],CI[1]],AI);return[Math.min(KI[0],LI[0],rI[0],kI[0]),Math.min(KI[1],LI[1],rI[1],kI[1]),Math.max(KI[0],LI[0],rI[0],kI[0]),Math.max(KI[1],LI[1],rI[1],kI[1])]}static inverseTransform(CI){const AI=CI[0]*CI[3]-CI[1]*CI[2];return[CI[3]/AI,-CI[1]/AI,-CI[2]/AI,CI[0]/AI,(CI[2]*CI[5]-CI[4]*CI[3])/AI,(CI[4]*CI[1]-CI[5]*CI[0])/AI]}static apply3dTransform(CI,AI){return[CI[0]*AI[0]+CI[1]*AI[1]+CI[2]*AI[2],CI[3]*AI[0]+CI[4]*AI[1]+CI[5]*AI[2],CI[6]*AI[0]+CI[7]*AI[1]+CI[8]*AI[2]]}static singularValueDecompose2dScale(CI){const AI=[CI[0],CI[2],CI[1],CI[3]],KI=CI[0]*AI[0]+CI[1]*AI[2],LI=CI[0]*AI[1]+CI[1]*AI[3],rI=CI[2]*AI[0]+CI[3]*AI[2],kI=CI[2]*AI[1]+CI[3]*AI[3],xI=(KI+kI)/2,_I=Math.sqrt((KI+kI)**2-4*(KI*kI-rI*LI))/2,$I=xI+_I||1,OI=xI-_I||1;return[Math.sqrt($I),Math.sqrt(OI)]}static normalizeRect(CI){const AI=CI.slice(0);return CI[0]>CI[2]&&(AI[0]=CI[2],AI[2]=CI[0]),CI[1]>CI[3]&&(AI[1]=CI[3],AI[3]=CI[1]),AI}static intersect(CI,AI){const KI=Math.max(Math.min(CI[0],CI[2]),Math.min(AI[0],AI[2])),LI=Math.min(Math.max(CI[0],CI[2]),Math.max(AI[0],AI[2]));if(KI>LI)return null;const rI=Math.max(Math.min(CI[1],CI[3]),Math.min(AI[1],AI[3])),kI=Math.min(Math.max(CI[1],CI[3]),Math.max(AI[1],AI[3]));return rI>kI?null:[KI,rI,LI,kI]}static bezierBoundingBox(CI,AI,KI,LI,rI,kI,xI,_I){const $I=[],OI=[[],[]];let gg,Ig,Ag,qI,lg,ig,og,Zg;for(let Gg=0;Gg<2;++Gg){if(Gg===0?(Ig=6*CI-12*KI+6*rI,gg=-3*CI+9*KI-9*rI+3*xI,Ag=3*KI-3*CI):(Ig=6*AI-12*LI+6*kI,gg=-3*AI+9*LI-9*kI+3*_I,Ag=3*LI-3*AI),Math.abs(gg)<1e-12){if(Math.abs(Ig)<1e-12)continue;qI=-Ag/Ig,0<qI&&qI<1&&$I.push(qI);continue}og=Ig*Ig-4*Ag*gg,Zg=Math.sqrt(og),!(og<0)&&(lg=(-Ig+Zg)/(2*gg),0<lg&&lg<1&&$I.push(lg),ig=(-Ig-Zg)/(2*gg),0<ig&&ig<1&&$I.push(ig))}let sg=$I.length,Cg;const dg=sg;for(;sg--;)qI=$I[sg],Cg=1-qI,OI[0][sg]=Cg*Cg*Cg*CI+3*Cg*Cg*qI*KI+3*Cg*qI*qI*rI+qI*qI*qI*xI,OI[1][sg]=Cg*Cg*Cg*AI+3*Cg*Cg*qI*LI+3*Cg*qI*qI*kI+qI*qI*qI*_I;return OI[0][dg]=CI,OI[1][dg]=AI,OI[0][dg+1]=xI,OI[1][dg+1]=_I,OI[0].length=OI[1].length=dg+2,[Math.min(...OI[0]),Math.min(...OI[1]),Math.max(...OI[0]),Math.max(...OI[1])]}}c.Util=pI;const DI=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function FI(cI){if(cI[0]>="ï"){let AI;if(cI[0]==="þ"&&cI[1]==="ÿ"?AI="utf-16be":cI[0]==="ÿ"&&cI[1]==="þ"?AI="utf-16le":cI[0]==="ï"&&cI[1]==="»"&&cI[2]==="¿"&&(AI="utf-8"),AI)try{const KI=new TextDecoder(AI,{fatal:!0}),LI=lI(cI);return KI.decode(LI)}catch(KI){BI(`stringToPDFString: "${KI}".`)}}const CI=[];for(let AI=0,KI=cI.length;AI<KI;AI++){const LI=DI[cI.charCodeAt(AI)];CI.push(LI?String.fromCharCode(LI):cI.charAt(AI))}return CI.join("")}function TI(cI){return cI.replace(/([()\\\n\r])/g,CI=>CI===`
`?"\\n":CI==="\r"?"\\r":`\\${CI}`)}function vI(cI){return/^[\x00-\x7F]*$/.test(cI)}function fI(cI){const CI=["þÿ"];for(let AI=0,KI=cI.length;AI<KI;AI++){const LI=cI.charCodeAt(AI);CI.push(String.fromCharCode(LI>>8&255),String.fromCharCode(LI&255))}return CI.join("")}function PI(cI){return decodeURIComponent(escape(cI))}function EI(cI){return unescape(encodeURIComponent(cI))}function SI(cI){return typeof cI=="object"&&cI!==null&&cI.byteLength!==void 0}function JI(cI,CI){if(cI.length!==CI.length)return!1;for(let AI=0,KI=cI.length;AI<KI;AI++)if(cI[AI]!==CI[AI])return!1;return!0}function yI(cI=new Date){return[cI.getUTCFullYear().toString(),(cI.getUTCMonth()+1).toString().padStart(2,"0"),cI.getUTCDate().toString().padStart(2,"0"),cI.getUTCHours().toString().padStart(2,"0"),cI.getUTCMinutes().toString().padStart(2,"0"),cI.getUTCSeconds().toString().padStart(2,"0")].join("")}function HI(){const cI=Object.create(null);let CI=!1;return Object.defineProperty(cI,"settled",{get(){return CI}}),cI.promise=new Promise(function(AI,KI){cI.resolve=function(LI){CI=!0,AI(LI)},cI.reject=function(LI){CI=!0,KI(LI)}}),cI}},(wI,c,$)=>{$(3)},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isNodeJS=void 0;const $=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");c.isNodeJS=$},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var oI,sI,K,t,dI,k,y,H,s,Wg,u,V;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:wI,NodeCMapReaderFactory:c,NodeStandardFontDataFactory:$}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=wI,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=c,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=$}let createPDFNetworkStream;function setPDFNetworkStreamFactory(wI){createPDFNetworkStream=wI}function getDocument(wI){const c=new PDFDocumentLoadingTask;let $;if(typeof wI=="string"||wI instanceof URL)$={url:wI};else if((0,_util.isArrayBuffer)(wI))$={data:wI};else if(wI instanceof PDFDataRangeTransport)$={range:wI};else{if(typeof wI!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!wI.url&&!wI.data&&!wI.range)throw new Error("Invalid parameter object: need either .data, .range or .url");$=wI}const h=Object.create(null);let M=null,_=null;for(const T in $){const r=$[T];switch(T){case"url":if(typeof window<"u")try{h[T]=new URL(r,window.location).href;continue}catch(Z){(0,_util.warn)(`Cannot create valid URL: "${Z}".`)}else if(typeof r=="string"||r instanceof URL){h[T]=r.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":M=r;continue;case"worker":_=r;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&r instanceof Buffer)h[T]=new Uint8Array(r);else{if(r instanceof Uint8Array)break;if(typeof r=="string")h[T]=(0,_util.stringToBytes)(r);else if(typeof r=="object"&&r!==null&&!isNaN(r.length))h[T]=new Uint8Array(r);else if((0,_util.isArrayBuffer)(r))h[T]=new Uint8Array(r);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}h[T]=r}if(h.CMapReaderFactory=h.CMapReaderFactory||DefaultCMapReaderFactory,h.StandardFontDataFactory=h.StandardFontDataFactory||DefaultStandardFontDataFactory,h.ignoreErrors=h.stopAtErrors!==!0,h.fontExtraProperties=h.fontExtraProperties===!0,h.pdfBug=h.pdfBug===!0,h.enableXfa=h.enableXfa===!0,(!Number.isInteger(h.rangeChunkSize)||h.rangeChunkSize<1)&&(h.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof h.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(h.docBaseUrl))&&(h.docBaseUrl=null),(!Number.isInteger(h.maxImageSize)||h.maxImageSize<-1)&&(h.maxImageSize=-1),typeof h.cMapUrl!="string"&&(h.cMapUrl=null),typeof h.standardFontDataUrl!="string"&&(h.standardFontDataUrl=null),typeof h.useWorkerFetch!="boolean"&&(h.useWorkerFetch=h.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&h.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof h.isEvalSupported!="boolean"&&(h.isEvalSupported=!0),typeof h.disableFontFace!="boolean"&&(h.disableFontFace=_is_node.isNodeJS),typeof h.useSystemFonts!="boolean"&&(h.useSystemFonts=!_is_node.isNodeJS&&!h.disableFontFace),(typeof h.ownerDocument!="object"||h.ownerDocument===null)&&(h.ownerDocument=globalThis.document),typeof h.disableRange!="boolean"&&(h.disableRange=!1),typeof h.disableStream!="boolean"&&(h.disableStream=!1),typeof h.disableAutoFetch!="boolean"&&(h.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(h.verbosity),!_){const T={verbosity:h.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};_=T.port?PDFWorker.fromPort(T):new PDFWorker(T),c._worker=_}const z=c.docId;return _.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const T=_fetchDocument(_,h,M,z),r=new Promise(function(Z){let p;M?p=new _transport_stream.PDFDataTransportStream({length:h.length,initialData:h.initialData,progressiveDone:h.progressiveDone,contentDispositionFilename:h.contentDispositionFilename,disableRange:h.disableRange,disableStream:h.disableStream},M):h.data||(p=createPDFNetworkStream({url:h.url,length:h.length,httpHeaders:h.httpHeaders,withCredentials:h.withCredentials,rangeChunkSize:h.rangeChunkSize,disableRange:h.disableRange,disableStream:h.disableStream})),Z(p)});return Promise.all([T,r]).then(function([Z,p]){if(c.destroyed)throw new Error("Loading aborted");const j=new _message_handler.MessageHandler(z,Z,_.port),D=new WorkerTransport(j,c,p,h);c._transport=D,j.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(wI,c,$,h){if(wI.destroyed)throw new Error("Worker was destroyed");$&&(c.length=$.length,c.initialData=$.initialData,c.progressiveDone=$.progressiveDone,c.contentDispositionFilename=$.contentDispositionFilename);const M=await wI.messageHandler.sendWithPromise("GetDocRequest",{docId:h,apiVersion:"2.16.105",source:{data:c.data,url:c.url,password:c.password,disableAutoFetch:c.disableAutoFetch,rangeChunkSize:c.rangeChunkSize,length:c.length},maxImageSize:c.maxImageSize,disableFontFace:c.disableFontFace,docBaseUrl:c.docBaseUrl,ignoreErrors:c.ignoreErrors,isEvalSupported:c.isEvalSupported,fontExtraProperties:c.fontExtraProperties,enableXfa:c.enableXfa,useSystemFonts:c.useSystemFonts,cMapUrl:c.useWorkerFetch?c.cMapUrl:null,standardFontDataUrl:c.useWorkerFetch?c.standardFontDataUrl:null});if(c.data&&(c.data=null),wI.destroyed)throw new Error("Worker was destroyed");return M}const n=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${wg(n,oI)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var wI;this.destroyed=!0,await((wI=this._transport)==null?void 0:wI.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=n;oI=new WeakMap,GI(PDFDocumentLoadingTask,oI,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,$,h=!1,M=null){this.length=c,this.initialData=$,this.progressiveDone=h,this.contentDispositionFilename=M,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,$){for(const h of this._rangeListeners)h(c,$)}onDataProgress(c,$){this._readyCapability.promise.then(()=>{for(const h of this._progressListeners)h(c,$)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const $ of this._progressiveReadListeners)$(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,$){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,$){this._pdfInfo=c,this._transport=$,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,$,h,M,_=!1){this._pageIndex=c,this._pageInfo=$,this._ownerDocument=M,this._transport=h,this._stats=_?new _display_utils.StatTimer:null,this._pdfBug=_,this.commonObjs=h.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:$=this.rotate,offsetX:h=0,offsetY:M=0,dontFlip:_=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:$,offsetX:h,offsetY:M,dontFlip:_})}getAnnotations({intent:c="display"}={}){const $=this._transport.getRenderingIntent(c);let h=this._annotationPromises.get($.cacheKey);return h||(h=this._transport.getAnnotations(this._pageIndex,$.renderingIntent),this._annotationPromises.set($.cacheKey,h),h=h.then(M=>{for(const _ of M)_.titleObj!==void 0&&Object.defineProperty(_,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),_.titleObj.str}}),_.contentsObj!==void 0&&Object.defineProperty(_,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),_.contentsObj.str}});return M})),h}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:$,intent:h="display",annotationMode:M=_util.AnnotationMode.ENABLE,transform:_=null,imageLayer:z=null,canvasFactory:T=null,background:r=null,optionalContentConfigPromise:Z=null,annotationCanvasMap:p=null,pageColors:j=null,printAnnotationStorage:D=null}){var m,d;((m=arguments[0])==null?void 0:m.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&M===_util.AnnotationMode.ENABLE&&(M=_util.AnnotationMode.ENABLE_FORMS)),((d=arguments[0])==null?void 0:d.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&M===_util.AnnotationMode.ENABLE&&(M=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const C=this._transport.getRenderingIntent(h,M,D);this.pendingCleanup=!1,Z||(Z=this._transport.getOptionalContentConfig());let l=this._intentStates.get(C.cacheKey);l||(l=Object.create(null),this._intentStates.set(C.cacheKey,l)),l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null);const B=T||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Y=!!(C.renderingIntent&_util.RenderingIntentFlag.PRINT);l.displayReadyCapability||(l.displayReadyCapability=(0,_util.createPromiseCapability)(),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(C));const a=g=>{l.renderTasks.delete(i),(this.cleanupAfterRender||Y)&&(this.pendingCleanup=!0),this._tryCleanup(),g?(i.capability.reject(g),this._abortOperatorList({intentState:l,reason:g instanceof Error?g:new Error(g)})):i.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},i=new InternalRenderTask({callback:a,params:{canvasContext:c,viewport:$,transform:_,imageLayer:z,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:p,operatorList:l.operatorList,pageIndex:this._pageIndex,canvasFactory:B,useRequestAnimationFrame:!Y,pdfBug:this._pdfBug,pageColors:j});(l.renderTasks||(l.renderTasks=new Set)).add(i);const I=i.task;return Promise.all([l.displayReadyCapability.promise,Z]).then(([g,o])=>{if(this.pendingCleanup){a();return}this._stats&&this._stats.time("Rendering"),i.initializeGraphics({transparency:g,optionalContentConfig:o}),i.operatorListChanged()}).catch(a),I}getOperatorList({intent:c="display",annotationMode:$=_util.AnnotationMode.ENABLE,printAnnotationStorage:h=null}={}){function M(){z.operatorList.lastChunk&&(z.opListReadCapability.resolve(z.operatorList),z.renderTasks.delete(T))}const _=this._transport.getRenderingIntent(c,$,h,!0);let z=this._intentStates.get(_.cacheKey);z||(z=Object.create(null),this._intentStates.set(_.cacheKey,z));let T;return z.opListReadCapability||(T=Object.create(null),T.operatorListChanged=M,z.opListReadCapability=(0,_util.createPromiseCapability)(),(z.renderTasks||(z.renderTasks=new Set)).add(T),z.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(_)),z.opListReadCapability.promise}streamTextContent({disableCombineTextItems:c=!1,includeMarkedContent:$=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:c!==!0,includeMarkedContent:$===!0},{highWaterMark:100,size(h){return h.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(h=>_xfa_text.XfaText.textContent(h));const $=this.streamTextContent(c);return new Promise(function(h,M){function _(){z.read().then(function({value:r,done:Z}){if(Z){h(T);return}Object.assign(T.styles,r.styles),T.items.push(...r.items),_()},M)}const z=$.getReader(),T={items:[],styles:Object.create(null)};_()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const c=[];for(const $ of this._intentStates.values())if(this._abortOperatorList({intentState:$,reason:new Error("Page was destroyed."),force:!0}),!$.opListReadCapability)for(const h of $.renderTasks)c.push(h.completed),h.cancel();this.objs.clear();for(const $ of this._bitmaps)$.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(c)}cleanup(c=!1){return this.pendingCleanup=!0,this._tryCleanup(c)}_tryCleanup(c=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:$,operatorList:h}of this._intentStates.values())if($.size>0||!h.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,c&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const $ of this._bitmaps)$.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(c,$){const h=this._intentStates.get($);h&&(this._stats&&this._stats.timeEnd("Page Request"),h.displayReadyCapability&&h.displayReadyCapability.resolve(c))}_renderPageChunk(c,$){for(let h=0,M=c.length;h<M;h++)$.operatorList.fnArray.push(c.fnArray[h]),$.operatorList.argsArray.push(c.argsArray[h]);$.operatorList.lastChunk=c.lastChunk,$.operatorList.separateAnnots=c.separateAnnots;for(const h of $.renderTasks)h.operatorListChanged();c.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:c,cacheKey:$,annotationStorageMap:h}){const M=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:$,annotationStorage:h}).getReader(),_=this._intentStates.get($);_.streamReader=M;const z=()=>{M.read().then(({value:T,done:r})=>{if(r){_.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(T,_),z())},T=>{if(_.streamReader=null,!this._transport.destroyed){if(_.operatorList){_.operatorList.lastChunk=!0;for(const r of _.renderTasks)r.operatorListChanged();this._tryCleanup()}if(_.displayReadyCapability)_.displayReadyCapability.reject(T);else if(_.opListReadCapability)_.opListReadCapability.reject(T);else throw T}})};z()}_abortOperatorList({intentState:c,reason:$,force:h=!1}){if(c.streamReader){if(!h){if(c.renderTasks.size>0)return;if($ instanceof _display_utils.RenderingCancelledException){c.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:c,reason:$,force:!0}),c.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(c.streamReader.cancel(new _util.AbortException($.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[M,_]of this._intentStates)if(_===c){this._intentStates.delete(M);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(c,$){const h={data:structuredClone(c,$)};this._deferred.then(()=>{for(const M of this._listeners)M.call(this,h)})}addEventListener(c,$){this._listeners.push($)}removeEventListener(c,$){const h=this._listeners.indexOf($);this._listeners.splice(h,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const wI=(sI=document==null?void 0:document.currentScript)==null?void 0:sI.src;wI&&(PDFWorkerUtil.fallbackWorkerSrc=wI.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(wI,c){let $;try{if($=new URL(wI),!$.origin||$.origin==="null")return!1}catch{return!1}const h=new URL(c,$);return $.origin===h.origin},PDFWorkerUtil.createCDNWrapper=function(wI){const c=`importScripts("${wI}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class{constructor({name:wI=null,port:c=null,verbosity:$=(0,_util.getVerbosityLevel)()}={}){if(c&&R(_PDFWorker,K).has(c))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=wI,this.destroyed=!1,this.verbosity=$,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,c){R(_PDFWorker,K).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(wI){this._port=wI,this._messageHandler=new _message_handler.MessageHandler("main","worker",wI),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:wI}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,wI)||(wI=PDFWorkerUtil.createCDNWrapper(new URL(wI,window.location).href));const c=new Worker(wI),$=new _message_handler.MessageHandler("main","worker",c),h=()=>{c.removeEventListener("error",M),$.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},M=()=>{this._webWorker||h()};c.addEventListener("error",M),$.on("test",z=>{if(c.removeEventListener("error",M),this.destroyed){h();return}z?(this._messageHandler=$,this._port=c,this._webWorker=c,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),$.destroy(),c.terminate())}),$.on("ready",z=>{if(c.removeEventListener("error",M),this.destroyed){h();return}try{_()}catch{this._setupFakeWorker()}});const _=()=>{const z=new Uint8Array;$.send("test",z,[z.buffer])};_();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(wI=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const $=`fake${PDFWorkerUtil.fakeWorkerId++}`,h=new _message_handler.MessageHandler($+"_worker",$,c);wI.setup(h,c);const M=new _message_handler.MessageHandler($,$+"_worker",c);this._messageHandler=M,this._readyCapability.resolve(),M.send("configure",{verbosity:this.verbosity})}).catch(wI=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${wI.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),R(_PDFWorker,K).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(wI){if(!(wI!=null&&wI.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return R(this,K).has(wI.port)?R(this,K).get(wI.port):new _PDFWorker(wI)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var wI;try{return((wI=globalThis.pdfjsWorker)==null?void 0:wI.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;K=new WeakMap,GI(PDFWorker,K,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(c,$,h,M){GI(this,t,null),GI(this,dI,new Map),GI(this,k,new Map),GI(this,y,null),this.messageHandler=c,this.loadingTask=$,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:$.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:M.ownerDocument,styleElement:M.styleElement}),this._params=M,M.useWorkerFetch||(this.CMapReaderFactory=new M.CMapReaderFactory({baseUrl:M.cMapUrl,isCompressed:M.cMapPacked}),this.StandardFontDataFactory=new M.StandardFontDataFactory({baseUrl:M.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=h,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return R(this,t)}getRenderingIntent(c,$=_util.AnnotationMode.ENABLE,h=null,M=!1){let _=_util.RenderingIntentFlag.DISPLAY,z=null;switch(c){case"any":_=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":_=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch($){case _util.AnnotationMode.DISABLE:_+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:_+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:_+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,z=(_&_util.RenderingIntentFlag.PRINT&&h instanceof _annotation_storage.PrintAnnotationStorage?h:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${$}`)}return M&&(_+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:_,cacheKey:`${_}_${_annotation_storage.AnnotationStorage.getHash(z)}`,annotationStorageMap:z}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const h of R(this,dI).values())c.push(h._destroy());R(this,dI).clear(),R(this,k).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const $=this.messageHandler.sendWithPromise("Terminate",null);return c.push($),Promise.all(c).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),XI(this,y,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:$}=this;c.on("GetReader",(h,M)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=_=>{this._lastProgress={loaded:_.loaded,total:_.total}},M.onPull=()=>{this._fullReader.read().then(function({value:_,done:z}){if(z){M.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(_),"GetReader - expected an ArrayBuffer."),M.enqueue(new Uint8Array(_),1,[_])}).catch(_=>{M.error(_)})},M.onCancel=_=>{this._fullReader.cancel(_),M.ready.catch(z=>{if(!this.destroyed)throw z})}}),c.on("ReaderHeadersReady",h=>{const M=(0,_util.createPromiseCapability)(),_=this._fullReader;return _.headersReady.then(()=>{var z;(!_.isStreamingSupported||!_.isRangeSupported)&&(this._lastProgress&&((z=$.onProgress)==null||z.call($,this._lastProgress)),_.onProgress=T=>{var r;(r=$.onProgress)==null||r.call($,{loaded:T.loaded,total:T.total})}),M.resolve({isStreamingSupported:_.isStreamingSupported,isRangeSupported:_.isRangeSupported,contentLength:_.contentLength})},M.reject),M.promise}),c.on("GetRangeReader",(h,M)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const _=this._networkStream.getRangeReader(h.begin,h.end);if(!_){M.close();return}M.onPull=()=>{_.read().then(function({value:z,done:T}){if(T){M.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(z),"GetRangeReader - expected an ArrayBuffer."),M.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{M.error(z)})},M.onCancel=z=>{_.cancel(z),M.ready.catch(T=>{if(!this.destroyed)throw T})}}),c.on("GetDoc",({pdfInfo:h})=>{this._numPages=h.numPages,this._htmlForXfa=h.htmlForXfa,delete h.htmlForXfa,$._capability.resolve(new PDFDocumentProxy(h,this))}),c.on("DocException",function(h){let M;switch(h.name){case"PasswordException":M=new _util.PasswordException(h.message,h.code);break;case"InvalidPDFException":M=new _util.InvalidPDFException(h.message);break;case"MissingPDFException":M=new _util.MissingPDFException(h.message);break;case"UnexpectedResponseException":M=new _util.UnexpectedResponseException(h.message,h.status);break;case"UnknownErrorException":M=new _util.UnknownErrorException(h.message,h.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}$._capability.reject(M)}),c.on("PasswordRequest",h=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),$.onPassword){const M=_=>{_ instanceof Error?this._passwordCapability.reject(_):this._passwordCapability.resolve({password:_})};try{$.onPassword(M,h.code)}catch(_){this._passwordCapability.reject(_)}}else this._passwordCapability.reject(new _util.PasswordException(h.message,h.code));return this._passwordCapability.promise}),c.on("DataLoaded",h=>{var M;(M=$.onProgress)==null||M.call($,{loaded:h.length,total:h.length}),this.downloadInfoCapability.resolve(h)}),c.on("StartRenderPage",h=>{this.destroyed||R(this,dI).get(h.pageIndex)._startRenderPage(h.transparency,h.cacheKey)}),c.on("commonobj",([h,M,_])=>{var z;if(!this.destroyed&&!this.commonObjs.has(h))switch(M){case"Font":const T=this._params;if("error"in _){const p=_.error;(0,_util.warn)(`Error during font loading: ${p}`),this.commonObjs.resolve(h,p);break}let r=null;T.pdfBug&&(z=globalThis.FontInspector)!=null&&z.enabled&&(r={registerFont(p,j){globalThis.FontInspector.fontAdded(p,j)}});const Z=new _font_loader.FontFaceObject(_,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(Z).catch(p=>c.sendWithPromise("FontFallback",{id:h})).finally(()=>{!T.fontExtraProperties&&Z.data&&(Z.data=null),this.commonObjs.resolve(h,Z)});break;case"FontPath":case"Image":this.commonObjs.resolve(h,_);break;default:throw new Error(`Got unknown common object type ${M}`)}}),c.on("obj",([h,M,_,z])=>{var T;if(this.destroyed)return;const r=R(this,dI).get(M);if(!r.objs.has(h))switch(_){case"Image":r.objs.resolve(h,z);const Z=8e6;if(z){let p;if(z.bitmap){const{bitmap:j,width:D,height:m}=z;p=D*m*4,r._bitmaps.add(j)}else p=((T=z.data)==null?void 0:T.length)||0;p>Z&&(r.cleanupAfterRender=!0)}break;case"Pattern":r.objs.resolve(h,z);break;default:throw new Error(`Got unknown object type ${_}`)}}),c.on("DocProgress",h=>{var M;this.destroyed||(M=$.onProgress)==null||M.call($,{loaded:h.loaded,total:h.total})}),c.on("DocStats",h=>{this.destroyed||XI(this,t,Object.freeze({streamTypes:Object.freeze(h.streamTypes),fontTypes:Object.freeze(h.fontTypes)}))}),c.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),c.on("FetchBuiltInCMap",h=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(h):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",h=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(h):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:c}){var $,h;this.destroyed||(h=($=this.loadingTask).onUnsupportedFeature)==null||h.call($,c)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const $=c-1,h=R(this,k).get($);if(h)return h;const M=this.messageHandler.sendWithPromise("GetPage",{pageIndex:$}).then(_=>{if(this.destroyed)throw new Error("Transport destroyed");const z=new PDFPageProxy($,_,this,this._params.ownerDocument,this._params.pdfBug);return R(this,dI).set($,z),z});return R(this,k).set($,M),M}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,$){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:$})}saveDocument(){var c;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((c=this._fullReader)==null?void 0:c.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return R(this,y)||XI(this,y,this.messageHandler.sendWithPromise("GetMetadata",null).then(c=>{var $,h;return{info:c[0],metadata:c[1]?new _metadata.Metadata(c[1]):null,contentDispositionFilename:(($=this._fullReader)==null?void 0:$.filename)??null,contentLength:((h=this._fullReader)==null?void 0:h.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const $ of R(this,dI).values())if(!$.cleanup())throw new Error(`startCleanup: Page ${$.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),XI(this,y,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const c=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c.disableAutoFetch,enableXfa:c.enableXfa})}}t=new WeakMap,dI=new WeakMap,k=new WeakMap,y=new WeakMap;class PDFObjects{constructor(){GI(this,s),GI(this,H,Object.create(null))}get(c,$=null){if($){const M=bI(this,s,Wg).call(this,c);return M.capability.promise.then(()=>$(M.data)),null}const h=R(this,H)[c];if(!(h!=null&&h.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return h.data}has(c){const $=R(this,H)[c];return($==null?void 0:$.capability.settled)||!1}resolve(c,$=null){const h=bI(this,s,Wg).call(this,c);h.data=$,h.capability.resolve()}clear(){XI(this,H,Object.create(null))}}H=new WeakMap,s=new WeakSet,Wg=function(wI){return R(this,H)[wI]||(R(this,H)[wI]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(c){GI(this,u,null),XI(this,u,c),this.onContinue=null}get promise(){return R(this,u).capability.promise}cancel(){R(this,u).cancel()}get separateAnnots(){const{separateAnnots:c}=R(this,u).operatorList;if(!c)return!1;const{annotationCanvasMap:$}=R(this,u);return c.form||c.canvas&&($==null?void 0:$.size)>0}}u=new WeakMap,exports.RenderTask=RenderTask;const G=class{constructor({callback:wI,params:c,objs:$,commonObjs:h,annotationCanvasMap:M,operatorList:_,pageIndex:z,canvasFactory:T,useRequestAnimationFrame:r=!1,pdfBug:Z=!1,pageColors:p=null}){this.callback=wI,this.params=c,this.objs=$,this.commonObjs=h,this.annotationCanvasMap=M,this.operatorListIdx=null,this.operatorList=_,this._pageIndex=z,this.canvasFactory=T,this._pdfBug=Z,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=r===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=c.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:wI=!1,optionalContentConfig:c}){var $;if(this.cancelled)return;if(this._canvas){if(R(G,V).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");R(G,V).add(this._canvas)}this._pdfBug&&($=globalThis.StepperManager)!=null&&$.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:h,viewport:M,transform:_,imageLayer:z,background:T}=this.params;this.gfx=new _canvas.CanvasGraphics(h,this.commonObjs,this.objs,this.canvasFactory,z,c,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:_,viewport:M,transparency:wI,background:T}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(wI=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&R(G,V).delete(this._canvas),this.callback(wI||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&R(G,V).delete(this._canvas),this.callback())))}};let InternalRenderTask=G;V=new WeakMap,GI(InternalRenderTask,V,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(wI,c,$)=>{var h,M,_;Object.defineProperty(c,"__esModule",{value:!0}),c.PrintAnnotationStorage=c.AnnotationStorage=void 0;var z=$(1),T=$(6),r=$(10);class Z{constructor(){GI(this,h),this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(D,m){const d=this._storage.get(D);return d===void 0?m:Object.assign(m,d)}getRawValue(D){return this._storage.get(D)}remove(D){if(this._storage.delete(D),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const m of this._storage.values())if(m instanceof T.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(D,m){const d=this._storage.get(D);let C=!1;if(d!==void 0)for(const[l,B]of Object.entries(m))d[l]!==B&&(C=!0,d[l]=B);else C=!0,this._storage.set(D,m);C&&bI(this,h,M).call(this),m instanceof T.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(m.constructor._type)}has(D){return this._storage.has(D)}getAll(){return this._storage.size>0?(0,z.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new p(this)}get serializable(){if(this._storage.size===0)return null;const D=new Map;for(const[m,d]of this._storage){const C=d instanceof T.AnnotationEditor?d.serialize():d;C&&D.set(m,C)}return D}static getHash(D){if(!D)return"";const m=new r.MurmurHash3_64;for(const[d,C]of D)m.update(`${d}:${JSON.stringify(C)}`);return m.hexdigest()}}h=new WeakSet,M=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},c.AnnotationStorage=Z;class p extends Z{constructor(D){super(),GI(this,_,null),XI(this,_,structuredClone(D.serializable))}get print(){(0,z.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return R(this,_)}}_=new WeakMap,c.PrintAnnotationStorage=p},(wI,c,$)=>{var h,M,_,z,T,r;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditor=void 0;var Z=$(7),p=$(1);const j=class{constructor(m){GI(this,h,this.focusin.bind(this)),GI(this,M,this.focusout.bind(this)),GI(this,_,!1),GI(this,z,!1),GI(this,T,!1),GI(this,r,j._zIndex++),this.constructor===j&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=m.parent,this.id=m.id,this.width=this.height=null,this.pageIndex=m.parent.pageIndex,this.name=m.name,this.div=null;const[d,C]=this.parent.viewportBaseDimensions;this.x=m.x/d,this.y=m.y/C,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=R(this,r)}focusin(m){R(this,_)?XI(this,_,!1):this.parent.setSelected(this)}focusout(m){if(!this.isAttachedToDOM)return;const d=m.relatedTarget;d!=null&&d.closest(`#${this.id}`)||(m.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(m){const d=this.parent.div.getBoundingClientRect();this.startX=m.clientX-d.x,this.startY=m.clientY-d.y,m.dataTransfer.setData("text/plain",this.id),m.dataTransfer.effectAllowed="move"}setAt(m,d,C,l){const[B,Y]=this.parent.viewportBaseDimensions;[C,l]=this.screenToPageTranslation(C,l),this.x=(m+C)/B,this.y=(d+l)/Y,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(m,d){const[C,l]=this.parent.viewportBaseDimensions;[m,d]=this.screenToPageTranslation(m,d),this.x+=m/C,this.y+=d/l,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(m,d){const{rotation:C}=this.parent.viewport;switch(C){case 90:return[d,-m];case 180:return[-m,-d];case 270:return[-d,m];default:return[m,d]}}setDims(m,d){const[C,l]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*m/C}%`,this.div.style.height=`${100*d/l}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",R(this,h)),this.div.addEventListener("focusout",R(this,M));const[m,d]=this.getInitialTranslation();return this.translate(m,d),(0,Z.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(m){const d=Z.KeyboardManager.platform.isMac;if(m.button!==0||m.ctrlKey&&d){m.preventDefault();return}m.ctrlKey&&!d||m.shiftKey||m.metaKey&&d?this.parent.toggleSelected(this):this.parent.setSelected(this),XI(this,_,!0)}getRect(m,d){const[C,l]=this.parent.viewportBaseDimensions,[B,Y]=this.parent.pageDimensions,a=B*m/C,i=Y*d/l,I=this.x*B,g=this.y*Y,o=this.width*B,X=this.height*Y;switch(this.rotation){case 0:return[I+a,Y-g-i-X,I+a+o,Y-g-i];case 90:return[I+i,Y-g+a,I+i+X,Y-g+a+o];case 180:return[I-a-o,Y-g+i,I-a,Y-g+i+X];case 270:return[I-i-X,Y-g-a-o,I-i,Y-g-a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(m,d){const[C,l,B,Y]=m,a=B-C,i=Y-l;switch(this.rotation){case 0:return[C,d-Y,a,i];case 90:return[C,d-l,i,a];case 180:return[B,d-l,a,i];case 270:return[B,d-Y,i,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){XI(this,T,!0)}disableEditMode(){XI(this,T,!1)}isInEditMode(){return R(this,T)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var m;(m=this.div)==null||m.addEventListener("focusin",R(this,h))}serialize(){(0,p.unreachable)("An editor must be serializable")}static deserialize(m,d){const C=new this.prototype.constructor({parent:d,id:d.getNextId()});C.rotation=m.rotation;const[l,B]=d.pageDimensions,[Y,a,i,I]=C.getRectInCurrentCoords(m.rect,B);return C.x=Y/l,C.y=a/B,C.width=i/l,C.height=I/B,C}remove(){this.div.removeEventListener("focusin",R(this,h)),this.div.removeEventListener("focusout",R(this,M)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var m;(m=this.div)==null||m.classList.add("selectedEditor")}unselect(){var m;(m=this.div)==null||m.classList.remove("selectedEditor")}updateParams(m,d){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return R(this,z)}set isEditing(m){XI(this,z,m),m?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let D=j;h=new WeakMap,M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,r=new WeakMap,QI(D,"_colorManager",new Z.ColorManager),QI(D,"_zIndex",1),c.AnnotationEditor=D},(wI,c,$)=>{var h,M,_,z,T,r,Z,p,j,D,m,d,C,l,B,Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI,NI,BI,J,e,w,x,E,P,iI,aI;Object.defineProperty(c,"__esModule",{value:!0}),c.KeyboardManager=c.CommandManager=c.ColorManager=c.AnnotationEditorUIManager=void 0,c.bindEvents=W,c.opacityToHex=L;var eI=$(1),A=$(8);function W(f,v,RI){for(const pI of RI)v.addEventListener(pI,f[pI].bind(f))}function L(f){return Math.round(Math.min(255,Math.max(1,255*f))).toString(16).padStart(2,"0")}class S{constructor(){GI(this,h,0)}getId(){return`${eI.AnnotationEditorPrefix}${wg(this,h)._++}`}}h=new WeakMap;class Q{constructor(v=128){GI(this,M,[]),GI(this,_,!1),GI(this,z,void 0),GI(this,T,-1),XI(this,z,v)}add({cmd:v,undo:RI,mustExec:pI,type:DI=NaN,overwriteIfSameType:FI=!1,keepUndo:TI=!1}){if(pI&&v(),R(this,_))return;const vI={cmd:v,undo:RI,type:DI};if(R(this,T)===-1){R(this,M).length>0&&(R(this,M).length=0),XI(this,T,0),R(this,M).push(vI);return}if(FI&&R(this,M)[R(this,T)].type===DI){TI&&(vI.undo=R(this,M)[R(this,T)].undo),R(this,M)[R(this,T)]=vI;return}const fI=R(this,T)+1;fI===R(this,z)?R(this,M).splice(0,1):(XI(this,T,fI),fI<R(this,M).length&&R(this,M).splice(fI)),R(this,M).push(vI)}undo(){R(this,T)!==-1&&(XI(this,_,!0),R(this,M)[R(this,T)].undo(),XI(this,_,!1),XI(this,T,R(this,T)-1))}redo(){R(this,T)<R(this,M).length-1&&(XI(this,T,R(this,T)+1),XI(this,_,!0),R(this,M)[R(this,T)].cmd(),XI(this,_,!1))}hasSomethingToUndo(){return R(this,T)!==-1}hasSomethingToRedo(){return R(this,T)<R(this,M).length-1}destroy(){XI(this,M,null)}}M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,c.CommandManager=Q;const lI=class{constructor(f){GI(this,r),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const v=lI.platform.isMac;for(const[RI,pI]of f)for(const DI of RI){const FI=DI.startsWith("mac+");v&&FI?(this.callbacks.set(DI.slice(4),pI),this.allKeys.add(DI.split("+").at(-1))):!v&&!FI&&(this.callbacks.set(DI,pI),this.allKeys.add(DI.split("+").at(-1)))}}static get platform(){const f=typeof navigator<"u"?navigator.platform:"";return(0,eI.shadow)(this,"platform",{isWin:f.includes("Win"),isMac:f.includes("Mac")})}exec(f,v){if(!this.allKeys.has(v.key))return;const RI=this.callbacks.get(bI(this,r,Z).call(this,v));RI&&(RI.bind(f)(),v.stopPropagation(),v.preventDefault())}};let uI=lI;r=new WeakSet,Z=function(f){f.altKey&&this.buffer.push("alt"),f.ctrlKey&&this.buffer.push("ctrl"),f.metaKey&&this.buffer.push("meta"),f.shiftKey&&this.buffer.push("shift"),this.buffer.push(f.key);const v=this.buffer.join("+");return this.buffer.length=0,v},c.KeyboardManager=uI;class MI{constructor(){GI(this,p,null)}copy(v){v&&(Array.isArray(v)?XI(this,p,v.map(RI=>RI.serialize())):XI(this,p,[v.serialize()]),XI(this,p,R(this,p).filter(RI=>!!RI)),R(this,p).length===0&&XI(this,p,null))}paste(){return R(this,p)}isEmpty(){return R(this,p)===null}destroy(){XI(this,p,null)}}p=new WeakMap;const ZI=class{get _colors(){const f=new Map([["CanvasText",null],["Canvas",null]]);return(0,A.getColorValues)(f),(0,eI.shadow)(this,"_colors",f)}convert(f){const v=(0,A.getRGB)(f);if(!window.matchMedia("(forced-colors: active)").matches)return v;for(const[RI,pI]of this._colors)if(pI.every((DI,FI)=>DI===v[FI]))return ZI._colorsMapping.get(RI);return v}getHexCode(f){const v=this._colors.get(f);return v?eI.Util.makeHexColor(...v):f}};let WI=ZI;QI(WI,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),c.ColorManager=WI;const tI=class{constructor(f,v){GI(this,hI),GI(this,nI),GI(this,U),GI(this,q),GI(this,NI),GI(this,J),GI(this,w),GI(this,E),GI(this,iI),GI(this,j,null),GI(this,D,new Map),GI(this,m,new Map),GI(this,d,new MI),GI(this,C,new Q),GI(this,l,0),GI(this,B,null),GI(this,Y,null),GI(this,a,new S),GI(this,i,!1),GI(this,I,eI.AnnotationEditorType.NONE),GI(this,g,new Set),GI(this,o,this.keydown.bind(this)),GI(this,X,this.onEditingAction.bind(this)),GI(this,b,this.onPageChanging.bind(this)),GI(this,N,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}),GI(this,F,null),XI(this,F,f),XI(this,Y,v),R(this,Y)._on("editingaction",R(this,X)),R(this,Y)._on("pagechanging",R(this,b))}destroy(){bI(this,nI,gI).call(this),R(this,Y)._off("editingaction",R(this,X)),R(this,Y)._off("pagechanging",R(this,b));for(const f of R(this,m).values())f.destroy();R(this,m).clear(),R(this,D).clear(),XI(this,j,null),R(this,g).clear(),R(this,d).destroy(),R(this,C).destroy()}onPageChanging({pageNumber:f}){XI(this,l,f-1)}focusMainContainer(){R(this,F).focus()}keydown(f){var v;(v=this.getActive())!=null&&v.shouldGetKeyboardEvents()||tI._keyboardManager.exec(this,f)}onEditingAction(f){["undo","redo","cut","copy","paste","delete","selectAll"].includes(f.name)&&this[f.name]()}setEditingState(f){f?(bI(this,hI,YI).call(this),bI(this,U,II).call(this,{isEditing:R(this,I)!==eI.AnnotationEditorType.NONE,isEmpty:bI(this,E,P).call(this),hasSomethingToUndo:R(this,C).hasSomethingToUndo(),hasSomethingToRedo:R(this,C).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:R(this,d).isEmpty()})):(bI(this,nI,gI).call(this),bI(this,U,II).call(this,{isEditing:!1}))}registerEditorTypes(f){XI(this,B,f);for(const v of R(this,B))bI(this,q,mI).call(this,v.defaultPropertiesToUpdate)}getId(){return R(this,a).getId()}addLayer(f){R(this,m).set(f.pageIndex,f),R(this,i)?f.enable():f.disable()}removeLayer(f){R(this,m).delete(f.pageIndex)}updateMode(f){if(XI(this,I,f),f===eI.AnnotationEditorType.NONE)this.setEditingState(!1),bI(this,J,e).call(this);else{this.setEditingState(!0),bI(this,NI,BI).call(this);for(const v of R(this,m).values())v.updateMode(f)}}updateToolbar(f){f!==R(this,I)&&R(this,Y).dispatch("switchannotationeditormode",{source:this,mode:f})}updateParams(f,v){for(const RI of R(this,g))RI.updateParams(f,v);for(const RI of R(this,B))RI.updateDefaultParams(f,v)}getEditors(f){const v=[];for(const RI of R(this,D).values())RI.pageIndex===f&&v.push(RI);return v}getEditor(f){return R(this,D).get(f)}addEditor(f){R(this,D).set(f.id,f)}removeEditor(f){R(this,D).delete(f.id),this.unselect(f)}setActiveEditor(f){R(this,j)!==f&&(XI(this,j,f),f&&bI(this,q,mI).call(this,f.propertiesToUpdate))}toggleSelected(f){if(R(this,g).has(f)){R(this,g).delete(f),f.unselect(),bI(this,U,II).call(this,{hasSelectedEditor:this.hasSelection});return}R(this,g).add(f),f.select(),bI(this,q,mI).call(this,f.propertiesToUpdate),bI(this,U,II).call(this,{hasSelectedEditor:!0})}setSelected(f){for(const v of R(this,g))v!==f&&v.unselect();R(this,g).clear(),R(this,g).add(f),f.select(),bI(this,q,mI).call(this,f.propertiesToUpdate),bI(this,U,II).call(this,{hasSelectedEditor:!0})}isSelected(f){return R(this,g).has(f)}unselect(f){f.unselect(),R(this,g).delete(f),bI(this,U,II).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return R(this,g).size!==0}undo(){R(this,C).undo(),bI(this,U,II).call(this,{hasSomethingToUndo:R(this,C).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:bI(this,E,P).call(this)})}redo(){R(this,C).redo(),bI(this,U,II).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:R(this,C).hasSomethingToRedo(),isEmpty:bI(this,E,P).call(this)})}addCommands(f){R(this,C).add(f),bI(this,U,II).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:bI(this,E,P).call(this)})}delete(){if(R(this,j)&&R(this,j).commitOrRemove(),!this.hasSelection)return;const f=[...R(this,g)],v=()=>{for(const pI of f)pI.remove()},RI=()=>{for(const pI of f)bI(this,w,x).call(this,pI)};this.addCommands({cmd:v,undo:RI,mustExec:!0})}copy(){if(R(this,j)&&R(this,j).commitOrRemove(),this.hasSelection){const f=[];for(const v of R(this,g))v.isEmpty()||f.push(v);if(f.length===0)return;R(this,d).copy(f),bI(this,U,II).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(R(this,d).isEmpty())return;this.unselectAll();const f=R(this,m).get(R(this,l)),v=R(this,d).paste().map(DI=>f.deserialize(DI)),RI=()=>{for(const DI of v)bI(this,w,x).call(this,DI);bI(this,iI,aI).call(this,v)},pI=()=>{for(const DI of v)DI.remove()};this.addCommands({cmd:RI,undo:pI,mustExec:!0})}selectAll(){for(const f of R(this,g))f.commit();bI(this,iI,aI).call(this,R(this,D).values())}unselectAll(){if(R(this,j)){R(this,j).commitOrRemove();return}if(bI(this,iI,aI).size!==0){for(const f of R(this,g))f.unselect();R(this,g).clear(),bI(this,U,II).call(this,{hasSelectedEditor:!1})}}isActive(f){return R(this,j)===f}getActive(){return R(this,j)}getMode(){return R(this,I)}};let O=tI;j=new WeakMap,D=new WeakMap,m=new WeakMap,d=new WeakMap,C=new WeakMap,l=new WeakMap,B=new WeakMap,Y=new WeakMap,a=new WeakMap,i=new WeakMap,I=new WeakMap,g=new WeakMap,o=new WeakMap,X=new WeakMap,b=new WeakMap,N=new WeakMap,F=new WeakMap,hI=new WeakSet,YI=function(){R(this,F).addEventListener("keydown",R(this,o))},nI=new WeakSet,gI=function(){R(this,F).removeEventListener("keydown",R(this,o))},U=new WeakSet,II=function(f){Object.entries(f).some(([v,RI])=>R(this,N)[v]!==RI)&&R(this,Y).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(R(this,N),f)})},q=new WeakSet,mI=function(f){R(this,Y).dispatch("annotationeditorparamschanged",{source:this,details:f})},NI=new WeakSet,BI=function(){if(!R(this,i)){XI(this,i,!0);for(const f of R(this,m).values())f.enable()}},J=new WeakSet,e=function(){if(this.unselectAll(),R(this,i)){XI(this,i,!1);for(const f of R(this,m).values())f.disable()}},w=new WeakSet,x=function(f){const v=R(this,m).get(f.pageIndex);v?v.addOrRebuild(f):this.addEditor(f)},E=new WeakSet,P=function(){if(R(this,D).size===0)return!0;if(R(this,D).size===1)for(const f of R(this,D).values())return f.isEmpty();return!1},iI=new WeakSet,aI=function(f){R(this,g).clear();for(const v of f)v.isEmpty()||(R(this,g).add(v),v.select());bI(this,U,II).call(this,{hasSelectedEditor:!0})},QI(O,"_keyboardManager",new uI([[["ctrl+a","mac+meta+a"],tI.prototype.selectAll],[["ctrl+c","mac+meta+c"],tI.prototype.copy],[["ctrl+v","mac+meta+v"],tI.prototype.paste],[["ctrl+x","mac+meta+x"],tI.prototype.cut],[["ctrl+z","mac+meta+z"],tI.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],tI.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],tI.prototype.delete],[["Escape","mac+Escape"],tI.prototype.unselectAll]])),c.AnnotationEditorUIManager=O},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.StatTimer=c.RenderingCancelledException=c.PixelsPerInch=c.PageViewport=c.PDFDateString=c.DOMStandardFontDataFactory=c.DOMSVGFactory=c.DOMCanvasFactory=c.DOMCMapReaderFactory=c.AnnotationPrefix=void 0,c.deprecated=o,c.getColorValues=hI,c.getCurrentTransform=YI,c.getCurrentTransformInverse=nI,c.getFilenameFromUrl=Y,c.getPdfFilenameFromUrl=a,c.getRGB=F,c.getXfaPageViewport=N,c.isDataScheme=l,c.isPdfFile=B,c.isValidFetchUrl=I,c.loadScript=g;var h=$(9),M=$(1);const _="http://www.w3.org/2000/svg",z="pdfjs_internal_id_";c.AnnotationPrefix=z;const T=class{};let r=T;QI(r,"CSS",96),QI(r,"PDF",72),QI(r,"PDF_TO_CSS_UNITS",T.CSS/T.PDF),c.PixelsPerInch=r;class Z extends h.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,II){const q=this._document.createElement("canvas");return q.width=U,q.height=II,q}}c.DOMCanvasFactory=Z;async function p(gI,U=!1){if(I(gI,document.baseURI)){const II=await fetch(gI);if(!II.ok)throw new Error(II.statusText);return U?new Uint8Array(await II.arrayBuffer()):(0,M.stringToBytes)(await II.text())}return new Promise((II,q)=>{const mI=new XMLHttpRequest;mI.open("GET",gI,!0),U&&(mI.responseType="arraybuffer"),mI.onreadystatechange=()=>{if(mI.readyState===XMLHttpRequest.DONE){if(mI.status===200||mI.status===0){let NI;if(U&&mI.response?NI=new Uint8Array(mI.response):!U&&mI.responseText&&(NI=(0,M.stringToBytes)(mI.responseText)),NI){II(NI);return}}q(new Error(mI.statusText))}},mI.send(null)})}class j extends h.BaseCMapReaderFactory{_fetchData(U,II){return p(U,this.isCompressed).then(q=>({cMapData:q,compressionType:II}))}}c.DOMCMapReaderFactory=j;class D extends h.BaseStandardFontDataFactory{_fetchData(U){return p(U,!0)}}c.DOMStandardFontDataFactory=D;class m extends h.BaseSVGFactory{_createSVG(U){return document.createElementNS(_,U)}}c.DOMSVGFactory=m;class d{constructor({viewBox:U,scale:II,rotation:q,offsetX:mI=0,offsetY:NI=0,dontFlip:BI=!1}){this.viewBox=U,this.scale=II,this.rotation=q,this.offsetX=mI,this.offsetY=NI;const J=(U[2]+U[0])/2,e=(U[3]+U[1])/2;let w,x,E,P;switch(q%=360,q<0&&(q+=360),q){case 180:w=-1,x=0,E=0,P=1;break;case 90:w=0,x=1,E=1,P=0;break;case 270:w=0,x=-1,E=-1,P=0;break;case 0:w=1,x=0,E=0,P=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}BI&&(E=-E,P=-P);let iI,aI,eI,A;w===0?(iI=Math.abs(e-U[1])*II+mI,aI=Math.abs(J-U[0])*II+NI,eI=Math.abs(U[3]-U[1])*II,A=Math.abs(U[2]-U[0])*II):(iI=Math.abs(J-U[0])*II+mI,aI=Math.abs(e-U[1])*II+NI,eI=Math.abs(U[2]-U[0])*II,A=Math.abs(U[3]-U[1])*II),this.transform=[w*II,x*II,E*II,P*II,iI-w*II*J-E*II*e,aI-x*II*J-P*II*e],this.width=eI,this.height=A}clone({scale:U=this.scale,rotation:II=this.rotation,offsetX:q=this.offsetX,offsetY:mI=this.offsetY,dontFlip:NI=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:U,rotation:II,offsetX:q,offsetY:mI,dontFlip:NI})}convertToViewportPoint(U,II){return M.Util.applyTransform([U,II],this.transform)}convertToViewportRectangle(U){const II=M.Util.applyTransform([U[0],U[1]],this.transform),q=M.Util.applyTransform([U[2],U[3]],this.transform);return[II[0],II[1],q[0],q[1]]}convertToPdfPoint(U,II){return M.Util.applyInverseTransform([U,II],this.transform)}}c.PageViewport=d;class C extends M.BaseException{constructor(U,II){super(U,"RenderingCancelledException"),this.type=II}}c.RenderingCancelledException=C;function l(gI){const U=gI.length;let II=0;for(;II<U&&gI[II].trim()==="";)II++;return gI.substring(II,II+5).toLowerCase()==="data:"}function B(gI){return typeof gI=="string"&&/\.pdf$/i.test(gI)}function Y(gI){const U=gI.indexOf("#"),II=gI.indexOf("?"),q=Math.min(U>0?U:gI.length,II>0?II:gI.length);return gI.substring(gI.lastIndexOf("/",q)+1,q)}function a(gI,U="document.pdf"){if(typeof gI!="string")return U;if(l(gI))return(0,M.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const II=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,mI=II.exec(gI);let NI=q.exec(mI[1])||q.exec(mI[2])||q.exec(mI[3]);if(NI&&(NI=NI[0],NI.includes("%")))try{NI=q.exec(decodeURIComponent(NI))[0]}catch{}return NI||U}class i{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,M.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,M.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let II=0;for(const q of this.times){const mI=q.name;mI.length>II&&(II=mI.length)}for(const q of this.times){const mI=q.end-q.start;U.push(`${q.name.padEnd(II)} ${mI}ms
`)}return U.join("")}}c.StatTimer=i;function I(gI,U){try{const{protocol:II}=U?new URL(gI,U):new URL(gI);return II==="http:"||II==="https:"}catch{return!1}}function g(gI,U=!1){return new Promise((II,q)=>{const mI=document.createElement("script");mI.src=gI,mI.onload=function(NI){U&&mI.remove(),II(NI)},mI.onerror=function(){q(new Error(`Cannot load script at: ${mI.src}`))},(document.head||document.documentElement).append(mI)})}function o(gI){console.log("Deprecated API usage: "+gI)}let X;class b{static toDateObject(U){if(!U||typeof U!="string")return null;X||(X=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const II=X.exec(U);if(!II)return null;const q=parseInt(II[1],10);let mI=parseInt(II[2],10);mI=mI>=1&&mI<=12?mI-1:0;let NI=parseInt(II[3],10);NI=NI>=1&&NI<=31?NI:1;let BI=parseInt(II[4],10);BI=BI>=0&&BI<=23?BI:0;let J=parseInt(II[5],10);J=J>=0&&J<=59?J:0;let e=parseInt(II[6],10);e=e>=0&&e<=59?e:0;const w=II[7]||"Z";let x=parseInt(II[8],10);x=x>=0&&x<=23?x:0;let E=parseInt(II[9],10)||0;return E=E>=0&&E<=59?E:0,w==="-"?(BI+=x,J+=E):w==="+"&&(BI-=x,J-=E),new Date(Date.UTC(q,mI,NI,BI,J,e))}}c.PDFDateString=b;function N(gI,{scale:U=1,rotation:II=0}){const{width:q,height:mI}=gI.attributes.style,NI=[0,0,parseInt(q),parseInt(mI)];return new d({viewBox:NI,scale:U,rotation:II})}function F(gI){if(gI.startsWith("#")){const U=parseInt(gI.slice(1),16);return[(U&16711680)>>16,(U&65280)>>8,U&255]}return gI.startsWith("rgb(")?gI.slice(4,-1).split(",").map(U=>parseInt(U)):gI.startsWith("rgba(")?gI.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,M.warn)(`Not a valid color format: "${gI}"`),[0,0,0])}function hI(gI){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const II of gI.keys()){U.style.color=II;const q=window.getComputedStyle(U).color;gI.set(II,F(q))}U.remove()}function YI(gI){const{a:U,b:II,c:q,d:mI,e:NI,f:BI}=gI.getTransform();return[U,II,q,mI,NI,BI]}function nI(gI){const{a:U,b:II,c:q,d:mI,e:NI,f:BI}=gI.getTransform().invertSelf();return[U,II,q,mI,NI,BI]}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseStandardFontDataFactory=c.BaseSVGFactory=c.BaseCanvasFactory=c.BaseCMapReaderFactory=void 0;var h=$(1);class M{constructor(){this.constructor===M&&(0,h.unreachable)("Cannot initialize BaseCanvasFactory.")}create(Z,p){if(Z<=0||p<=0)throw new Error("Invalid canvas size");const j=this._createCanvas(Z,p);return{canvas:j,context:j.getContext("2d")}}reset(Z,p,j){if(!Z.canvas)throw new Error("Canvas is not specified");if(p<=0||j<=0)throw new Error("Invalid canvas size");Z.canvas.width=p,Z.canvas.height=j}destroy(Z){if(!Z.canvas)throw new Error("Canvas is not specified");Z.canvas.width=0,Z.canvas.height=0,Z.canvas=null,Z.context=null}_createCanvas(Z,p){(0,h.unreachable)("Abstract method `_createCanvas` called.")}}c.BaseCanvasFactory=M;class _{constructor({baseUrl:Z=null,isCompressed:p=!1}){this.constructor===_&&(0,h.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=Z,this.isCompressed=p}async fetch({name:Z}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!Z)throw new Error("CMap name must be specified.");const p=this.baseUrl+Z+(this.isCompressed?".bcmap":""),j=this.isCompressed?h.CMapCompressionType.BINARY:h.CMapCompressionType.NONE;return this._fetchData(p,j).catch(D=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(Z,p){(0,h.unreachable)("Abstract method `_fetchData` called.")}}c.BaseCMapReaderFactory=_;class z{constructor({baseUrl:Z=null}){this.constructor===z&&(0,h.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=Z}async fetch({filename:Z}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!Z)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${Z}`;return this._fetchData(p).catch(j=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(Z){(0,h.unreachable)("Abstract method `_fetchData` called.")}}c.BaseStandardFontDataFactory=z;class T{constructor(){this.constructor===T&&(0,h.unreachable)("Cannot initialize BaseSVGFactory.")}create(Z,p,j=!1){if(Z<=0||p<=0)throw new Error("Invalid SVG dimensions");const D=this._createSVG("svg:svg");return D.setAttribute("version","1.1"),j||(D.setAttribute("width",`${Z}px`),D.setAttribute("height",`${p}px`)),D.setAttribute("preserveAspectRatio","none"),D.setAttribute("viewBox",`0 0 ${Z} ${p}`),D}createElement(Z){if(typeof Z!="string")throw new Error("Invalid SVG element type");return this._createSVG(Z)}_createSVG(Z){(0,h.unreachable)("Abstract method `_createSVG` called.")}}c.BaseSVGFactory=T},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MurmurHash3_64=void 0;var h=$(1);const M=3285377520,_=4294901760,z=65535;class T{constructor(Z){this.h1=Z?Z&4294967295:M,this.h2=Z?Z&4294967295:M}update(Z){let p,j;if(typeof Z=="string"){p=new Uint8Array(Z.length*2),j=0;for(let o=0,X=Z.length;o<X;o++){const b=Z.charCodeAt(o);b<=255?p[j++]=b:(p[j++]=b>>>8,p[j++]=b&255)}}else if((0,h.isArrayBuffer)(Z))p=Z.slice(),j=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const D=j>>2,m=j-D*4,d=new Uint32Array(p.buffer,0,D);let C=0,l=0,B=this.h1,Y=this.h2;const a=3432918353,i=461845907,I=a&z,g=i&z;for(let o=0;o<D;o++)o&1?(C=d[o],C=C*a&_|C*I&z,C=C<<15|C>>>17,C=C*i&_|C*g&z,B^=C,B=B<<13|B>>>19,B=B*5+3864292196):(l=d[o],l=l*a&_|l*I&z,l=l<<15|l>>>17,l=l*i&_|l*g&z,Y^=l,Y=Y<<13|Y>>>19,Y=Y*5+3864292196);switch(C=0,m){case 3:C^=p[D*4+2]<<16;case 2:C^=p[D*4+1]<<8;case 1:C^=p[D*4],C=C*a&_|C*I&z,C=C<<15|C>>>17,C=C*i&_|C*g&z,D&1?B^=C:Y^=C}this.h1=B,this.h2=Y}hexdigest(){let Z=this.h1,p=this.h2;Z^=p>>>1,Z=Z*3981806797&_|Z*36045&z,p=p*4283543511&_|((p<<16|Z>>>16)*2950163797&_)>>>16,Z^=p>>>1,Z=Z*444984403&_|Z*60499&z,p=p*3301882366&_|((p<<16|Z>>>16)*3120437893&_)>>>16,Z^=p>>>1;const j=(Z>>>0).toString(16),D=(p>>>0).toString(16);return j.padStart(8,"0")+D.padStart(8,"0")}}c.MurmurHash3_64=T},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FontLoader=c.FontFaceObject=void 0;var h=$(1);class M{constructor({docId:r,onUnsupportedFeature:Z,ownerDocument:p=globalThis.document,styleElement:j=null}){this.constructor===M&&(0,h.unreachable)("Cannot initialize BaseFontLoader."),this.docId=r,this._onUnsupportedFeature=Z,this._document=p,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(r){this.nativeFontFaces.push(r),this._document.fonts.add(r)}insertRule(r){let Z=this.styleElement;Z||(Z=this.styleElement=this._document.createElement("style"),Z.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(Z));const p=Z.sheet;p.insertRule(r,p.cssRules.length)}clear(){for(const r of this.nativeFontFaces)this._document.fonts.delete(r);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(r){if(r.attached||r.missingFile)return;if(r.attached=!0,this.isFontLoadingAPISupported){const p=r.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(j){throw this._onUnsupportedFeature({featureId:h.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,h.warn)(`Failed to load font '${p.family}': '${j}'.`),r.disableFontFace=!0,j}}return}const Z=r.createFontFaceRule();if(Z){if(this.insertRule(Z),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const j=this._queueLoadingCallback(p);this._prepareFontLoadEvent([Z],[r],j)})}}_queueLoadingCallback(r){(0,h.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var r;const Z=!!((r=this._document)!=null&&r.fonts);return(0,h.shadow)(this,"isFontLoadingAPISupported",Z)}get isSyncFontLoadingSupported(){(0,h.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,h.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(r,Z,p){(0,h.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let _;c.FontLoader=_,c.FontLoader=_=class extends M{constructor(T){super(T),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let T=!1;if(typeof navigator>"u")T=!0;else{const r=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(r==null?void 0:r[1])>=14&&(T=!0)}return(0,h.shadow)(this,"isSyncFontLoadingSupported",T)}_queueLoadingCallback(T){function r(){for((0,h.assert)(!p.done,"completeRequest() cannot be called twice."),p.done=!0;Z.requests.length>0&&Z.requests[0].done;){const j=Z.requests.shift();setTimeout(j.callback,0)}}const Z=this.loadingContext,p={id:`pdfjs-font-loading-${Z.nextRequestId++}`,done:!1,complete:r,callback:T};return Z.requests.push(p),p}get _loadTestFont(){const T=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,h.shadow)(this,"_loadTestFont",T())}_prepareFontLoadEvent(T,r,Z){function p(F,hI){return F.charCodeAt(hI)<<24|F.charCodeAt(hI+1)<<16|F.charCodeAt(hI+2)<<8|F.charCodeAt(hI+3)&255}function j(F,hI,YI,nI){const gI=F.substring(0,hI),U=F.substring(hI+YI);return gI+nI+U}let D,m;const d=this._document.createElement("canvas");d.width=1,d.height=1;const C=d.getContext("2d");let l=0;function B(F,hI){if(l++,l>30){(0,h.warn)("Load test font never loaded."),hI();return}if(C.font="30px "+F,C.fillText(".",0,20),C.getImageData(0,0,1,1).data[3]>0){hI();return}setTimeout(B.bind(null,F,hI))}const Y=`lt${Date.now()}${this.loadTestFontId++}`;let a=this._loadTestFont;a=j(a,976,Y.length,Y);const i=16,I=1482184792;let g=p(a,i);for(D=0,m=Y.length-3;D<m;D+=4)g=g-I+p(Y,D)|0;D<Y.length&&(g=g-I+p(Y+"XXX",D)|0),a=j(a,i,4,(0,h.string32)(g));const o=`url(data:font/opentype;base64,${btoa(a)});`,X=`@font-face {font-family:"${Y}";src:${o}}`;this.insertRule(X);const b=[];for(const F of r)b.push(F.loadedName);b.push(Y);const N=this._document.createElement("div");N.style.visibility="hidden",N.style.width=N.style.height="10px",N.style.position="absolute",N.style.top=N.style.left="0px";for(const F of b){const hI=this._document.createElement("span");hI.textContent="Hi",hI.style.fontFamily=F,N.append(hI)}this._document.body.append(N),B(Y,()=>{N.remove(),Z.complete()})}};class z{constructor(r,{isEvalSupported:Z=!0,disableFontFace:p=!1,ignoreErrors:j=!1,onUnsupportedFeature:D,fontRegistry:m=null}){this.compiledGlyphs=Object.create(null);for(const d in r)this[d]=r[d];this.isEvalSupported=Z!==!1,this.disableFontFace=p===!0,this.ignoreErrors=j===!0,this._onUnsupportedFeature=D,this.fontRegistry=m}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let r;if(!this.cssFontInfo)r=new FontFace(this.loadedName,this.data,{});else{const Z={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(Z.style=`oblique ${this.cssFontInfo.italicAngle}deg`),r=new FontFace(this.cssFontInfo.fontFamily,this.data,Z)}return this.fontRegistry&&this.fontRegistry.registerFont(this),r}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const r=(0,h.bytesToString)(this.data),Z=`url(data:${this.mimetype};base64,${btoa(r)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${Z}}`;else{let j=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(j+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${j}src:${Z}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,Z),p}getPathGenerator(r,Z){if(this.compiledGlyphs[Z]!==void 0)return this.compiledGlyphs[Z];let p;try{p=r.get(this.loadedName+"_path_"+Z)}catch(j){if(!this.ignoreErrors)throw j;return this._onUnsupportedFeature({featureId:h.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,h.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[Z]=function(D,m){}}if(this.isEvalSupported&&h.FeatureTest.isEvalSupported){const j=[];for(const D of p){const m=D.args!==void 0?D.args.join(","):"";j.push("c.",D.cmd,"(",m,`);
`)}return this.compiledGlyphs[Z]=new Function("c","size",j.join(""))}return this.compiledGlyphs[Z]=function(j,D){for(const m of p)m.cmd==="scale"&&(m.args=[D,-D]),j[m.cmd].apply(j,m.args)}}}c.FontFaceObject=z},(wI,c,$)=>{var h,M;Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasGraphics=void 0;var _=$(8),z=$(1),T=$(13),r=$(14),Z=$(3);const p=16,j=100,D=4096,m=15,d=10,C=Z.isNodeJS&&typeof Path2D>"u"?-1:1e3,l=16;function B(J,e){if(J._removeMirroring)throw new Error("Context is already forwarding operations.");J.__originalSave=J.save,J.__originalRestore=J.restore,J.__originalRotate=J.rotate,J.__originalScale=J.scale,J.__originalTranslate=J.translate,J.__originalTransform=J.transform,J.__originalSetTransform=J.setTransform,J.__originalResetTransform=J.resetTransform,J.__originalClip=J.clip,J.__originalMoveTo=J.moveTo,J.__originalLineTo=J.lineTo,J.__originalBezierCurveTo=J.bezierCurveTo,J.__originalRect=J.rect,J.__originalClosePath=J.closePath,J.__originalBeginPath=J.beginPath,J._removeMirroring=()=>{J.save=J.__originalSave,J.restore=J.__originalRestore,J.rotate=J.__originalRotate,J.scale=J.__originalScale,J.translate=J.__originalTranslate,J.transform=J.__originalTransform,J.setTransform=J.__originalSetTransform,J.resetTransform=J.__originalResetTransform,J.clip=J.__originalClip,J.moveTo=J.__originalMoveTo,J.lineTo=J.__originalLineTo,J.bezierCurveTo=J.__originalBezierCurveTo,J.rect=J.__originalRect,J.closePath=J.__originalClosePath,J.beginPath=J.__originalBeginPath,delete J._removeMirroring},J.save=function(){e.save(),this.__originalSave()},J.restore=function(){e.restore(),this.__originalRestore()},J.translate=function(w,x){e.translate(w,x),this.__originalTranslate(w,x)},J.scale=function(w,x){e.scale(w,x),this.__originalScale(w,x)},J.transform=function(w,x,E,P,iI,aI){e.transform(w,x,E,P,iI,aI),this.__originalTransform(w,x,E,P,iI,aI)},J.setTransform=function(w,x,E,P,iI,aI){e.setTransform(w,x,E,P,iI,aI),this.__originalSetTransform(w,x,E,P,iI,aI)},J.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},J.rotate=function(w){e.rotate(w),this.__originalRotate(w)},J.clip=function(w){e.clip(w),this.__originalClip(w)},J.moveTo=function(w,x){e.moveTo(w,x),this.__originalMoveTo(w,x)},J.lineTo=function(w,x){e.lineTo(w,x),this.__originalLineTo(w,x)},J.bezierCurveTo=function(w,x,E,P,iI,aI){e.bezierCurveTo(w,x,E,P,iI,aI),this.__originalBezierCurveTo(w,x,E,P,iI,aI)},J.rect=function(w,x,E,P){e.rect(w,x,E,P),this.__originalRect(w,x,E,P)},J.closePath=function(){e.closePath(),this.__originalClosePath()},J.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Y{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,w,x){let E;return this.cache[e]!==void 0?(E=this.cache[e],this.canvasFactory.reset(E,w,x)):(E=this.canvasFactory.create(w,x),this.cache[e]=E),E}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const w=this.cache[e];this.canvasFactory.destroy(w),delete this.cache[e]}}}function a(J,e,w,x,E,P,iI,aI,eI,A){const[W,L,S,Q,lI,uI]=(0,_.getCurrentTransform)(J);if(L===0&&S===0){const WI=iI*W+lI,tI=Math.round(WI),O=aI*Q+uI,f=Math.round(O),v=(iI+eI)*W+lI,RI=Math.abs(Math.round(v)-tI)||1,pI=(aI+A)*Q+uI,DI=Math.abs(Math.round(pI)-f)||1;return J.setTransform(Math.sign(W),0,0,Math.sign(Q),tI,f),J.drawImage(e,w,x,E,P,0,0,RI,DI),J.setTransform(W,L,S,Q,lI,uI),[RI,DI]}if(W===0&&Q===0){const WI=aI*S+lI,tI=Math.round(WI),O=iI*L+uI,f=Math.round(O),v=(aI+A)*S+lI,RI=Math.abs(Math.round(v)-tI)||1,pI=(iI+eI)*L+uI,DI=Math.abs(Math.round(pI)-f)||1;return J.setTransform(0,Math.sign(L),Math.sign(S),0,tI,f),J.drawImage(e,w,x,E,P,0,0,DI,RI),J.setTransform(W,L,S,Q,lI,uI),[DI,RI]}J.drawImage(e,w,x,E,P,iI,aI,eI,A);const MI=Math.hypot(W,L),ZI=Math.hypot(S,Q);return[MI*eI,ZI*A]}function i(J){const{width:e,height:w}=J;if(e>C||w>C)return null;const x=1e3,E=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),P=e+1;let iI=new Uint8Array(P*(w+1)),aI,eI,A;const W=e+7&-8;let L=new Uint8Array(W*w),S=0;for(const MI of J.data){let ZI=128;for(;ZI>0;)L[S++]=MI&ZI?0:255,ZI>>=1}let Q=0;for(S=0,L[S]!==0&&(iI[0]=1,++Q),eI=1;eI<e;eI++)L[S]!==L[S+1]&&(iI[eI]=L[S]?2:1,++Q),S++;for(L[S]!==0&&(iI[eI]=2,++Q),aI=1;aI<w;aI++){S=aI*W,A=aI*P,L[S-W]!==L[S]&&(iI[A]=L[S]?1:8,++Q);let MI=(L[S]?4:0)+(L[S-W]?8:0);for(eI=1;eI<e;eI++)MI=(MI>>2)+(L[S+1]?4:0)+(L[S-W+1]?8:0),E[MI]&&(iI[A+eI]=E[MI],++Q),S++;if(L[S-W]!==L[S]&&(iI[A+eI]=L[S]?2:4,++Q),Q>x)return null}for(S=W*(w-1),A=aI*P,L[S]!==0&&(iI[A]=8,++Q),eI=1;eI<e;eI++)L[S]!==L[S+1]&&(iI[A+eI]=L[S]?4:8,++Q),S++;if(L[S]!==0&&(iI[A+eI]=4,++Q),Q>x)return null;const lI=new Int32Array([0,P,-1,0,-P,0,0,0,1]),uI=new Path2D;for(aI=0;Q&&aI<=w;aI++){let MI=aI*P;const ZI=MI+e;for(;MI<ZI&&!iI[MI];)MI++;if(MI===ZI)continue;uI.moveTo(MI%P,aI);const WI=MI;let tI=iI[MI];do{const O=lI[tI];do MI+=O;while(!iI[MI]);const f=iI[MI];f!==5&&f!==10?(tI=f,iI[MI]=0):(tI=f&51*tI>>4,iI[MI]&=tI>>2|tI<<2),uI.lineTo(MI%P,MI/P|0),iI[MI]||--Q}while(WI!==MI);--aI}return L=null,iI=null,function(MI){MI.save(),MI.scale(1/e,-1/w),MI.translate(0,-w),MI.fill(uI),MI.beginPath(),MI.restore()}}class I{constructor(e,w){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=z.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=z.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=z.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,e,w])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,w){this.x=e,this.y=w}updatePathMinMax(e,w,x){[w,x]=z.Util.applyTransform([w,x],e),this.minX=Math.min(this.minX,w),this.minY=Math.min(this.minY,x),this.maxX=Math.max(this.maxX,w),this.maxY=Math.max(this.maxY,x)}updateRectMinMax(e,w){const x=z.Util.applyTransform(w,e),E=z.Util.applyTransform(w.slice(2),e);this.minX=Math.min(this.minX,x[0],E[0]),this.minY=Math.min(this.minY,x[1],E[1]),this.maxX=Math.max(this.maxX,x[0],E[0]),this.maxY=Math.max(this.maxY,x[1],E[1])}updateScalingPathMinMax(e,w){z.Util.scaleMinMax(e,w),this.minX=Math.min(this.minX,w[0]),this.maxX=Math.max(this.maxX,w[1]),this.minY=Math.min(this.minY,w[2]),this.maxY=Math.max(this.maxY,w[3])}updateCurvePathMinMax(e,w,x,E,P,iI,aI,eI,A,W){const L=z.Util.bezierBoundingBox(w,x,E,P,iI,aI,eI,A);if(W){W[0]=Math.min(W[0],L[0],L[2]),W[1]=Math.max(W[1],L[0],L[2]),W[2]=Math.min(W[2],L[1],L[3]),W[3]=Math.max(W[3],L[1],L[3]);return}this.updateRectMinMax(e,L)}getPathBoundingBox(e=T.PathType.FILL,w=null){const x=[this.minX,this.minY,this.maxX,this.maxY];if(e===T.PathType.STROKE){w||(0,z.unreachable)("Stroke bounding box must include transform.");const E=z.Util.singularValueDecompose2dScale(w),P=E[0]*this.lineWidth/2,iI=E[1]*this.lineWidth/2;x[0]-=P,x[1]-=iI,x[2]+=P,x[3]+=iI}return x}updateClipFromPath(){const e=z.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=T.PathType.FILL,w=null){return z.Util.intersect(this.clipBox,this.getPathBoundingBox(e,w))}}function g(J,e,w=null){if(typeof ImageData<"u"&&e instanceof ImageData){J.putImageData(e,0,0);return}const x=e.height,E=e.width,P=x%l,iI=(x-P)/l,aI=P===0?iI:iI+1,eI=J.createImageData(E,l);let A=0,W;const L=e.data,S=eI.data;let Q,lI,uI,MI,ZI,WI,tI,O;if(w)switch(w.length){case 1:ZI=w[0],WI=w[0],tI=w[0],O=w[0];break;case 4:ZI=w[0],WI=w[1],tI=w[2],O=w[3];break}if(e.kind===z.ImageKind.GRAYSCALE_1BPP){const f=L.byteLength,v=new Uint32Array(S.buffer,0,S.byteLength>>2),RI=v.length,pI=E+7>>3;let DI=4294967295,FI=z.FeatureTest.isLittleEndian?4278190080:255;for(O&&O[0]===255&&O[255]===0&&([DI,FI]=[FI,DI]),Q=0;Q<aI;Q++){for(uI=Q<iI?l:P,W=0,lI=0;lI<uI;lI++){const TI=f-A;let vI=0;const fI=TI>pI?E:TI*8-7,PI=fI&-8;let EI=0,SI=0;for(;vI<PI;vI+=8)SI=L[A++],v[W++]=SI&128?DI:FI,v[W++]=SI&64?DI:FI,v[W++]=SI&32?DI:FI,v[W++]=SI&16?DI:FI,v[W++]=SI&8?DI:FI,v[W++]=SI&4?DI:FI,v[W++]=SI&2?DI:FI,v[W++]=SI&1?DI:FI;for(;vI<fI;vI++)EI===0&&(SI=L[A++],EI=128),v[W++]=SI&EI?DI:FI,EI>>=1}for(;W<RI;)v[W++]=0;J.putImageData(eI,0,Q*l)}}else if(e.kind===z.ImageKind.RGBA_32BPP){const f=!!(ZI||WI||tI);for(lI=0,MI=E*l*4,Q=0;Q<iI;Q++){if(S.set(L.subarray(A,A+MI)),A+=MI,f)for(let v=0;v<MI;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,lI),lI+=l}if(Q<aI){if(MI=E*P*4,S.set(L.subarray(A,A+MI)),f)for(let v=0;v<MI;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,lI)}}else if(e.kind===z.ImageKind.RGB_24BPP){const f=!!(ZI||WI||tI);for(uI=l,MI=E*uI,Q=0;Q<aI;Q++){for(Q>=iI&&(uI=P,MI=E*uI),W=0,lI=MI;lI--;)S[W++]=L[A++],S[W++]=L[A++],S[W++]=L[A++],S[W++]=255;if(f)for(let v=0;v<W;v+=4)ZI&&(S[v+0]=ZI[S[v+0]]),WI&&(S[v+1]=WI[S[v+1]]),tI&&(S[v+2]=tI[S[v+2]]);J.putImageData(eI,0,Q*l)}}else throw new Error(`bad image kind: ${e.kind}`)}function o(J,e){if(e.bitmap){J.drawImage(e.bitmap,0,0);return}const w=e.height,x=e.width,E=w%l,P=(w-E)/l,iI=E===0?P:P+1,aI=J.createImageData(x,l);let eI=0;const A=e.data,W=aI.data;for(let L=0;L<iI;L++){const S=L<P?l:E;({srcPos:eI}=(0,r.applyMaskImageData)({src:A,srcPos:eI,dest:W,width:x,height:S})),J.putImageData(aI,0,L*l)}}function X(J,e){const w=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let x=0,E=w.length;x<E;x++){const P=w[x];J[P]!==void 0&&(e[P]=J[P])}J.setLineDash!==void 0&&(e.setLineDash(J.getLineDash()),e.lineDashOffset=J.lineDashOffset)}function b(J,e){J.strokeStyle=J.fillStyle=e||"#000000",J.fillRule="nonzero",J.globalAlpha=1,J.lineWidth=1,J.lineCap="butt",J.lineJoin="miter",J.miterLimit=10,J.globalCompositeOperation="source-over",J.font="10px sans-serif",J.setLineDash!==void 0&&(J.setLineDash([]),J.lineDashOffset=0)}function N(J,e,w,x){const E=J.length;for(let P=3;P<E;P+=4){const iI=J[P];if(iI===0)J[P-3]=e,J[P-2]=w,J[P-1]=x;else if(iI<255){const aI=255-iI;J[P-3]=J[P-3]*iI+e*aI>>8,J[P-2]=J[P-2]*iI+w*aI>>8,J[P-1]=J[P-1]*iI+x*aI>>8}}}function F(J,e,w){const x=J.length,E=1/255;for(let P=3;P<x;P+=4){const iI=w?w[J[P]]:J[P];e[P]=e[P]*iI*E|0}}function hI(J,e,w){const x=J.length;for(let E=3;E<x;E+=4){const P=J[E-3]*77+J[E-2]*152+J[E-1]*28;e[E]=w?e[E]*w[P>>8]>>8:e[E]*P>>16}}function YI(J,e,w,x,E,P,iI,aI,eI,A,W){const L=!!P,S=L?P[0]:0,Q=L?P[1]:0,lI=L?P[2]:0;let uI;E==="Luminosity"?uI=hI:uI=F;const MI=Math.min(x,Math.ceil(1048576/w));for(let ZI=0;ZI<x;ZI+=MI){const WI=Math.min(MI,x-ZI),tI=J.getImageData(aI-A,ZI+(eI-W),w,WI),O=e.getImageData(aI,ZI+eI,w,WI);L&&N(tI.data,S,Q,lI),uI(tI.data,O.data,iI),e.putImageData(O,aI,ZI+eI)}}function nI(J,e,w,x){const E=x[0],P=x[1],iI=x[2]-E,aI=x[3]-P;iI===0||aI===0||(YI(e.context,w,iI,aI,e.subtype,e.backdrop,e.transferMap,E,P,e.offsetX,e.offsetY),J.save(),J.globalAlpha=1,J.globalCompositeOperation="source-over",J.setTransform(1,0,0,1,0,0),J.drawImage(w.canvas,0,0),J.restore())}function gI(J,e){const w=z.Util.singularValueDecompose2dScale(J);w[0]=Math.fround(w[0]),w[1]=Math.fround(w[1]);const x=Math.fround((globalThis.devicePixelRatio||1)*_.PixelsPerInch.PDF_TO_CSS_UNITS);return e!==void 0?e:w[0]<=x||w[1]<=x}const U=["butt","round","square"],II=["miter","round","bevel"],q={},mI={},NI=class{constructor(J,e,w,x,E,P,iI,aI){GI(this,h),this.ctx=J,this.current=new I(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=w,this.canvasFactory=x,this.imageLayer=E,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=P,this.cachedCanvases=new Y(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=iI,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(aI==null?void 0:aI.background)||null,this.foregroundColor=(aI==null?void 0:aI.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(J,e=null){return typeof J=="string"?J.startsWith("g_")?this.commonObjs.get(J):this.objs.get(J):e}beginDrawing({transform:J,viewport:e,transparency:w=!1,background:x=null}){const E=this.ctx.canvas.width,P=this.ctx.canvas.height,iI=x||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const aI=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const eI=this.backgroundColor=this.ctx.fillStyle;let A=!0,W=iI;if(this.ctx.fillStyle=iI,W=this.ctx.fillStyle,A=typeof W=="string"&&/^#[0-9A-Fa-f]{6}$/.test(W),aI==="#000000"&&eI==="#ffffff"||aI===eI||!A)this.foregroundColor=this.backgroundColor=null;else{const[L,S,Q]=(0,_.getRGB)(W),lI=MI=>(MI/=255,MI<=.03928?MI/12.92:((MI+.055)/1.055)**2.4),uI=Math.round(.2126*lI(L)+.7152*lI(S)+.0722*lI(Q));this.selectColor=(MI,ZI,WI)=>{const tI=.2126*lI(MI)+.7152*lI(ZI)+.0722*lI(WI);return Math.round(tI)===uI?eI:aI}}}if(this.ctx.fillStyle=this.backgroundColor||iI,this.ctx.fillRect(0,0,E,P),this.ctx.restore(),w){const aI=this.cachedCanvases.getCanvas("transparent",E,P);this.compositeCtx=this.ctx,this.transparentCanvas=aI.canvas,this.ctx=aI.context,this.ctx.save(),this.ctx.transform(...(0,_.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),b(this.ctx,this.foregroundColor),J&&(this.ctx.transform(...J),this.outputScaleX=J[0],this.outputScaleY=J[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=(0,_.getCurrentTransform)(this.ctx),this.imageLayer&&((0,_.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(J,e,w,x){const E=J.argsArray,P=J.fnArray;let iI=e||0;const aI=E.length;if(aI===iI)return iI;const eI=aI-iI>d&&typeof w=="function",A=eI?Date.now()+m:0;let W=0;const L=this.commonObjs,S=this.objs;let Q;for(;;){if(x!==void 0&&iI===x.nextBreakPoint)return x.breakIt(iI,w),iI;if(Q=P[iI],Q!==z.OPS.dependency)this[Q].apply(this,E[iI]);else for(const lI of E[iI]){const uI=lI.startsWith("g_")?L:S;if(!uI.has(lI))return uI.get(lI,w),iI}if(iI++,iI===aI)return iI;if(eI&&++W>d){if(Date.now()>A)return w(),iI;W=0}}}endDrawing(){bI(this,h,M).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const J of this._cachedBitmapsMap.values()){for(const e of J.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);J.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(J,e){const w=J.width,x=J.height;let E=Math.max(Math.hypot(e[0],e[1]),1),P=Math.max(Math.hypot(e[2],e[3]),1),iI=w,aI=x,eI="prescale1",A,W;for(;E>2&&iI>1||P>2&&aI>1;){let L=iI,S=aI;E>2&&iI>1&&(L=Math.ceil(iI/2),E/=iI/L),P>2&&aI>1&&(S=Math.ceil(aI/2),P/=aI/S),A=this.cachedCanvases.getCanvas(eI,L,S),W=A.context,W.clearRect(0,0,L,S),W.drawImage(J,0,0,iI,aI,0,0,L,S),J=A.canvas,iI=L,aI=S,eI=eI==="prescale1"?"prescale2":"prescale1"}return{img:J,paintWidth:iI,paintHeight:aI}}_createMaskCanvas(J){const e=this.ctx,{width:w,height:x}=J,E=this.current.fillColor,P=this.current.patternFill,iI=(0,_.getCurrentTransform)(e);let aI,eI,A,W;if((J.bitmap||J.data)&&J.count>1){const v=J.bitmap||J.data.buffer,RI=iI.slice(0,4);eI=JSON.stringify(P?RI:[RI,E]),aI=this._cachedBitmapsMap.get(v),aI||(aI=new Map,this._cachedBitmapsMap.set(v,aI));const pI=aI.get(eI);if(pI&&!P){const DI=Math.round(Math.min(iI[0],iI[2])+iI[4]),FI=Math.round(Math.min(iI[1],iI[3])+iI[5]);return{canvas:pI,offsetX:DI,offsetY:FI}}A=pI}A||(W=this.cachedCanvases.getCanvas("maskCanvas",w,x),o(W.context,J));let L=z.Util.transform(iI,[1/w,0,0,-1/x,0,0]);L=z.Util.transform(L,[1,0,0,1,0,-x]);const S=z.Util.applyTransform([0,0],L),Q=z.Util.applyTransform([w,x],L),lI=z.Util.normalizeRect([S[0],S[1],Q[0],Q[1]]),uI=Math.round(lI[2]-lI[0])||1,MI=Math.round(lI[3]-lI[1])||1,ZI=this.cachedCanvases.getCanvas("fillCanvas",uI,MI),WI=ZI.context,tI=Math.min(S[0],Q[0]),O=Math.min(S[1],Q[1]);WI.translate(-tI,-O),WI.transform(...L),A||(A=this._scaleImage(W.canvas,(0,_.getCurrentTransformInverse)(WI)),A=A.img,aI&&P&&aI.set(eI,A)),WI.imageSmoothingEnabled=gI((0,_.getCurrentTransform)(WI),J.interpolate),a(WI,A,0,0,A.width,A.height,0,0,w,x),WI.globalCompositeOperation="source-in";const f=z.Util.transform((0,_.getCurrentTransformInverse)(WI),[1,0,0,1,-tI,-O]);return WI.fillStyle=P?E.getPattern(e,this,f,T.PathType.FILL):E,WI.fillRect(0,0,w,x),aI&&!P&&(this.cachedCanvases.delete("fillCanvas"),aI.set(eI,ZI.canvas)),{canvas:ZI.canvas,offsetX:Math.round(tI),offsetY:Math.round(O)}}setLineWidth(J){J!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=J,this.ctx.lineWidth=J}setLineCap(J){this.ctx.lineCap=U[J]}setLineJoin(J){this.ctx.lineJoin=II[J]}setMiterLimit(J){this.ctx.miterLimit=J}setDash(J,e){const w=this.ctx;w.setLineDash!==void 0&&(w.setLineDash(J),w.lineDashOffset=e)}setRenderingIntent(J){}setFlatness(J){}setGState(J){for(let e=0,w=J.length;e<w;e++){const x=J[e],E=x[0],P=x[1];switch(E){case"LW":this.setLineWidth(P);break;case"LC":this.setLineCap(P);break;case"LJ":this.setLineJoin(P);break;case"ML":this.setMiterLimit(P);break;case"D":this.setDash(P[0],P[1]);break;case"RI":this.setRenderingIntent(P);break;case"FL":this.setFlatness(P);break;case"Font":this.setFont(P[0],P[1]);break;case"CA":this.current.strokeAlpha=x[1];break;case"ca":this.current.fillAlpha=x[1],this.ctx.globalAlpha=x[1];break;case"BM":this.ctx.globalCompositeOperation=P;break;case"SMask":this.current.activeSMask=P?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=P}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const J=this.inSMaskMode;this.current.activeSMask&&!J?this.beginSMaskMode():!this.current.activeSMask&&J&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const J=this.ctx.canvas.width,e=this.ctx.canvas.height,w="smaskGroupAt"+this.groupLevel,x=this.cachedCanvases.getCanvas(w,J,e);this.suspendedCtx=this.ctx,this.ctx=x.context;const E=this.ctx;E.setTransform(...(0,_.getCurrentTransform)(this.suspendedCtx)),X(this.suspendedCtx,E),B(E,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),X(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(J){if(!this.current.activeSMask)return;J?(J[0]=Math.floor(J[0]),J[1]=Math.floor(J[1]),J[2]=Math.ceil(J[2]),J[3]=Math.ceil(J[3])):J=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,w=this.suspendedCtx;nI(w,e,this.ctx,J),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(X(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const J=this.current;this.stateStack.push(J),this.current=J.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),X(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(J,e,w,x,E,P){this.ctx.transform(J,e,w,x,E,P),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(J,e,w){const x=this.ctx,E=this.current;let P=E.x,iI=E.y,aI,eI;const A=(0,_.getCurrentTransform)(x),W=A[0]===0&&A[3]===0||A[1]===0&&A[2]===0,L=W?w.slice(0):null;for(let S=0,Q=0,lI=J.length;S<lI;S++)switch(J[S]|0){case z.OPS.rectangle:P=e[Q++],iI=e[Q++];const uI=e[Q++],MI=e[Q++],ZI=P+uI,WI=iI+MI;x.moveTo(P,iI),uI===0||MI===0?x.lineTo(ZI,WI):(x.lineTo(ZI,iI),x.lineTo(ZI,WI),x.lineTo(P,WI)),W||E.updateRectMinMax(A,[P,iI,ZI,WI]),x.closePath();break;case z.OPS.moveTo:P=e[Q++],iI=e[Q++],x.moveTo(P,iI),W||E.updatePathMinMax(A,P,iI);break;case z.OPS.lineTo:P=e[Q++],iI=e[Q++],x.lineTo(P,iI),W||E.updatePathMinMax(A,P,iI);break;case z.OPS.curveTo:aI=P,eI=iI,P=e[Q+4],iI=e[Q+5],x.bezierCurveTo(e[Q],e[Q+1],e[Q+2],e[Q+3],P,iI),E.updateCurvePathMinMax(A,aI,eI,e[Q],e[Q+1],e[Q+2],e[Q+3],P,iI,L),Q+=6;break;case z.OPS.curveTo2:aI=P,eI=iI,x.bezierCurveTo(P,iI,e[Q],e[Q+1],e[Q+2],e[Q+3]),E.updateCurvePathMinMax(A,aI,eI,P,iI,e[Q],e[Q+1],e[Q+2],e[Q+3],L),P=e[Q+2],iI=e[Q+3],Q+=4;break;case z.OPS.curveTo3:aI=P,eI=iI,P=e[Q+2],iI=e[Q+3],x.bezierCurveTo(e[Q],e[Q+1],P,iI,P,iI),E.updateCurvePathMinMax(A,aI,eI,e[Q],e[Q+1],P,iI,P,iI,L),Q+=4;break;case z.OPS.closePath:x.closePath();break}W&&E.updateScalingPathMinMax(A,L),E.setCurrentPoint(P,iI)}closePath(){this.ctx.closePath()}stroke(J){J=typeof J<"u"?J:!0;const e=this.ctx,w=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof w=="object"&&w!=null&&w.getPattern?(e.save(),e.strokeStyle=w.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),T.PathType.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),J&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(J){J=typeof J<"u"?J:!0;const e=this.ctx,w=this.current.fillColor,x=this.current.patternFill;let E=!1;x&&(e.save(),e.fillStyle=w.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),T.PathType.FILL),E=!0);const P=this.current.getClippedPathBoundingBox();this.contentVisible&&P!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),E&&e.restore(),J&&this.consumePath(P)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=mI}beginText(){this.current.textMatrix=z.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const J=this.pendingTextPaths,e=this.ctx;if(J===void 0){e.beginPath();return}e.save(),e.beginPath();for(const w of J)e.setTransform(...w.transform),e.translate(w.x,w.y),w.addToPath(e,w.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(J){this.current.charSpacing=J}setWordSpacing(J){this.current.wordSpacing=J}setHScale(J){this.current.textHScale=J/100}setLeading(J){this.current.leading=-J}setFont(J,e){const w=this.commonObjs.get(J),x=this.current;if(!w)throw new Error(`Can't find font for ${J}`);if(x.fontMatrix=w.fontMatrix||z.FONT_IDENTITY_MATRIX,(x.fontMatrix[0]===0||x.fontMatrix[3]===0)&&(0,z.warn)("Invalid font matrix for font "+J),e<0?(e=-e,x.fontDirection=-1):x.fontDirection=1,this.current.font=w,this.current.fontSize=e,w.isType3Font)return;const E=w.loadedName||"sans-serif";let P="normal";w.black?P="900":w.bold&&(P="bold");const iI=w.italic?"italic":"normal",aI=`"${E}", ${w.fallbackName}`;let eI=e;e<p?eI=p:e>j&&(eI=j),this.current.fontSizeScale=e/eI,this.ctx.font=`${iI} ${P} ${eI}px ${aI}`}setTextRenderingMode(J){this.current.textRenderingMode=J}setTextRise(J){this.current.textRise=J}moveText(J,e){this.current.x=this.current.lineX+=J,this.current.y=this.current.lineY+=e}setLeadingMoveText(J,e){this.setLeading(-e),this.moveText(J,e)}setTextMatrix(J,e,w,x,E,P){this.current.textMatrix=[J,e,w,x,E,P],this.current.textMatrixScale=Math.hypot(J,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(J,e,w,x){const E=this.ctx,P=this.current,iI=P.font,aI=P.textRenderingMode,eI=P.fontSize/P.fontSizeScale,A=aI&z.TextRenderingMode.FILL_STROKE_MASK,W=!!(aI&z.TextRenderingMode.ADD_TO_PATH_FLAG),L=P.patternFill&&!iI.missingFile;let S;(iI.disableFontFace||W||L)&&(S=iI.getPathGenerator(this.commonObjs,J)),iI.disableFontFace||L?(E.save(),E.translate(e,w),E.beginPath(),S(E,eI),x&&E.setTransform(...x),(A===z.TextRenderingMode.FILL||A===z.TextRenderingMode.FILL_STROKE)&&E.fill(),(A===z.TextRenderingMode.STROKE||A===z.TextRenderingMode.FILL_STROKE)&&E.stroke(),E.restore()):((A===z.TextRenderingMode.FILL||A===z.TextRenderingMode.FILL_STROKE)&&E.fillText(J,e,w),(A===z.TextRenderingMode.STROKE||A===z.TextRenderingMode.FILL_STROKE)&&E.strokeText(J,e,w)),W&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_.getCurrentTransform)(E),x:e,y:w,fontSize:eI,addToPath:S})}get isFontSubpixelAAEnabled(){const{context:J}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);J.scale(1.5,1),J.fillText("I",0,10);const e=J.getImageData(0,0,10,10).data;let w=!1;for(let x=3;x<e.length;x+=4)if(e[x]>0&&e[x]<255){w=!0;break}return(0,z.shadow)(this,"isFontSubpixelAAEnabled",w)}showText(J){const e=this.current,w=e.font;if(w.isType3Font)return this.showType3Text(J);const x=e.fontSize;if(x===0)return;const E=this.ctx,P=e.fontSizeScale,iI=e.charSpacing,aI=e.wordSpacing,eI=e.fontDirection,A=e.textHScale*eI,W=J.length,L=w.vertical,S=L?1:-1,Q=w.defaultVMetrics,lI=x*e.fontMatrix[0],uI=e.textRenderingMode===z.TextRenderingMode.FILL&&!w.disableFontFace&&!e.patternFill;E.save(),E.transform(...e.textMatrix),E.translate(e.x,e.y+e.textRise),eI>0?E.scale(A,-1):E.scale(A,1);let MI;if(e.patternFill){E.save();const f=e.fillColor.getPattern(E,this,(0,_.getCurrentTransformInverse)(E),T.PathType.FILL);MI=(0,_.getCurrentTransform)(E),E.restore(),E.fillStyle=f}let ZI=e.lineWidth;const WI=e.textMatrixScale;if(WI===0||ZI===0){const f=e.textRenderingMode&z.TextRenderingMode.FILL_STROKE_MASK;(f===z.TextRenderingMode.STROKE||f===z.TextRenderingMode.FILL_STROKE)&&(ZI=this.getSinglePixelWidth())}else ZI/=WI;P!==1&&(E.scale(P,P),ZI/=P),E.lineWidth=ZI;let tI=0,O;for(O=0;O<W;++O){const f=J[O];if(typeof f=="number"){tI+=S*f*x/1e3;continue}let v=!1;const RI=(f.isSpace?aI:0)+iI,pI=f.fontChar,DI=f.accent;let FI,TI,vI=f.width;if(L){const PI=f.vmetric||Q,EI=-(f.vmetric?PI[1]:vI*.5)*lI,SI=PI[2]*lI;vI=PI?-PI[0]:vI,FI=EI/P,TI=(tI+SI)/P}else FI=tI/P,TI=0;if(w.remeasure&&vI>0){const PI=E.measureText(pI).width*1e3/x*P;if(vI<PI&&this.isFontSubpixelAAEnabled){const EI=vI/PI;v=!0,E.save(),E.scale(EI,1),FI/=EI}else vI!==PI&&(FI+=(vI-PI)/2e3*x/P)}if(this.contentVisible&&(f.isInFont||w.missingFile)){if(uI&&!DI)E.fillText(pI,FI,TI);else if(this.paintChar(pI,FI,TI,MI),DI){const PI=FI+x*DI.offset.x/P,EI=TI-x*DI.offset.y/P;this.paintChar(DI.fontChar,PI,EI,MI)}}let fI;L?fI=vI*lI-RI*eI:fI=vI*lI+RI*eI,tI+=fI,v&&E.restore()}L?e.y-=tI:e.x+=tI*A,E.restore(),this.compose()}showType3Text(J){const e=this.ctx,w=this.current,x=w.font,E=w.fontSize,P=w.fontDirection,iI=x.vertical?1:-1,aI=w.charSpacing,eI=w.wordSpacing,A=w.textHScale*P,W=w.fontMatrix||z.FONT_IDENTITY_MATRIX,L=J.length,S=w.textRenderingMode===z.TextRenderingMode.INVISIBLE;let Q,lI,uI,MI;if(!(S||E===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...w.textMatrix),e.translate(w.x,w.y),e.scale(A,P),Q=0;Q<L;++Q){if(lI=J[Q],typeof lI=="number"){MI=iI*lI*E/1e3,this.ctx.translate(MI,0),w.x+=MI*A;continue}const ZI=(lI.isSpace?eI:0)+aI,WI=x.charProcOperatorList[lI.operatorListId];if(!WI){(0,z.warn)(`Type3 character "${lI.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=lI,this.save(),e.scale(E,E),e.transform(...W),this.executeOperatorList(WI),this.restore()),uI=z.Util.applyTransform([lI.width,0],W)[0]*E+ZI,e.translate(uI,0),w.x+=uI*A}e.restore(),this.processingType3=null}}setCharWidth(J,e){}setCharWidthAndBounds(J,e,w,x,E,P){this.ctx.rect(w,x,E-w,P-x),this.ctx.clip(),this.endPath()}getColorN_Pattern(J){let e;if(J[0]==="TilingPattern"){const w=J[1],x=this.baseTransform||(0,_.getCurrentTransform)(this.ctx),E={createCanvasGraphics:P=>new NI(P,this.commonObjs,this.objs,this.canvasFactory)};e=new T.TilingPattern(J,w,this.ctx,E,x)}else e=this._getPattern(J[1],J[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(J,e,w){var x;const E=((x=this.selectColor)==null?void 0:x.call(this,J,e,w))||z.Util.makeHexColor(J,e,w);this.ctx.strokeStyle=E,this.current.strokeColor=E}setFillRGBColor(J,e,w){var x;const E=((x=this.selectColor)==null?void 0:x.call(this,J,e,w))||z.Util.makeHexColor(J,e,w);this.ctx.fillStyle=E,this.current.fillColor=E,this.current.patternFill=!1}_getPattern(J,e=null){let w;return this.cachedPatterns.has(J)?w=this.cachedPatterns.get(J):(w=(0,T.getShadingPattern)(this.objs.get(J)),this.cachedPatterns.set(J,w)),e&&(w.matrix=e),w}shadingFill(J){if(!this.contentVisible)return;const e=this.ctx;this.save();const w=this._getPattern(J);e.fillStyle=w.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),T.PathType.SHADING);const x=(0,_.getCurrentTransformInverse)(e);if(x){const E=e.canvas,P=E.width,iI=E.height,aI=z.Util.applyTransform([0,0],x),eI=z.Util.applyTransform([0,iI],x),A=z.Util.applyTransform([P,0],x),W=z.Util.applyTransform([P,iI],x),L=Math.min(aI[0],eI[0],A[0],W[0]),S=Math.min(aI[1],eI[1],A[1],W[1]),Q=Math.max(aI[0],eI[0],A[0],W[0]),lI=Math.max(aI[1],eI[1],A[1],W[1]);this.ctx.fillRect(L,S,Q-L,lI-S)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,z.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,z.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(J,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(J)&&J.length===6&&this.transform(...J),this.baseTransform=(0,_.getCurrentTransform)(this.ctx),e)){const w=e[2]-e[0],x=e[3]-e[1];this.ctx.rect(e[0],e[1],w,x),this.current.updateRectMinMax((0,_.getCurrentTransform)(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(J){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;J.isolated||(0,z.info)("TODO: Support non-isolated groups."),J.knockout&&(0,z.warn)("Knockout groups not supported.");const w=(0,_.getCurrentTransform)(e);if(J.matrix&&e.transform(...J.matrix),!J.bbox)throw new Error("Bounding box is required.");let x=z.Util.getAxialAlignedBoundingBox(J.bbox,(0,_.getCurrentTransform)(e));const E=[0,0,e.canvas.width,e.canvas.height];x=z.Util.intersect(x,E)||[0,0,0,0];const P=Math.floor(x[0]),iI=Math.floor(x[1]);let aI=Math.max(Math.ceil(x[2])-P,1),eI=Math.max(Math.ceil(x[3])-iI,1),A=1,W=1;aI>D&&(A=aI/D,aI=D),eI>D&&(W=eI/D,eI=D),this.current.startNewPathAndClipBox([0,0,aI,eI]);let L="groupAt"+this.groupLevel;J.smask&&(L+="_smask_"+this.smaskCounter++%2);const S=this.cachedCanvases.getCanvas(L,aI,eI),Q=S.context;Q.scale(1/A,1/W),Q.translate(-P,-iI),Q.transform(...w),J.smask?this.smaskStack.push({canvas:S.canvas,context:Q,offsetX:P,offsetY:iI,scaleX:A,scaleY:W,subtype:J.smask.subtype,backdrop:J.smask.backdrop,transferMap:J.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(P,iI),e.scale(A,W),e.save()),X(e,Q),this.ctx=Q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(J){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,w=this.groupStack.pop();if(this.ctx=w,this.ctx.imageSmoothingEnabled=!1,J.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const x=(0,_.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...x);const E=z.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],x);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(E)}}beginAnnotation(J,e,w,x,E){if(bI(this,h,M).call(this),b(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(e)&&e.length===4){const P=e[2]-e[0],iI=e[3]-e[1];if(E&&this.annotationCanvasMap){w=w.slice(),w[4]-=e[0],w[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=P,e[3]=iI;const[aI,eI]=z.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(this.ctx)),{viewportScale:A}=this,W=Math.ceil(P*this.outputScaleX*A),L=Math.ceil(iI*this.outputScaleY*A);this.annotationCanvas=this.canvasFactory.create(W,L);const{canvas:S,context:Q}=this.annotationCanvas;this.annotationCanvasMap.set(J,S),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Q,this.ctx.setTransform(aI,0,0,-eI,0,iI*eI),b(this.ctx,this.foregroundColor)}else b(this.ctx,this.foregroundColor),this.ctx.rect(e[0],e[1],P,iI),this.ctx.clip(),this.endPath()}this.current=new I(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...w),this.transform(...x)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(J){if(!this.contentVisible)return;const e=J.count;J=this.getObject(J.data,J),J.count=e;const w=this.ctx,x=this.processingType3;if(x&&(x.compiled===void 0&&(x.compiled=i(J)),x.compiled)){x.compiled(w);return}const E=this._createMaskCanvas(J),P=E.canvas;w.save(),w.setTransform(1,0,0,1,0,0),w.drawImage(P,E.offsetX,E.offsetY),w.restore(),this.compose()}paintImageMaskXObjectRepeat(J,e,w=0,x=0,E,P){if(!this.contentVisible)return;J=this.getObject(J.data,J);const iI=this.ctx;iI.save();const aI=(0,_.getCurrentTransform)(iI);iI.transform(e,w,x,E,0,0);const eI=this._createMaskCanvas(J);iI.setTransform(1,0,0,1,0,0);for(let A=0,W=P.length;A<W;A+=2){const L=z.Util.transform(aI,[e,w,x,E,P[A],P[A+1]]),[S,Q]=z.Util.applyTransform([0,0],L);iI.drawImage(eI.canvas,S,Q)}iI.restore(),this.compose()}paintImageMaskXObjectGroup(J){if(!this.contentVisible)return;const e=this.ctx,w=this.current.fillColor,x=this.current.patternFill;for(const E of J){const{data:P,width:iI,height:aI,transform:eI}=E,A=this.cachedCanvases.getCanvas("maskCanvas",iI,aI),W=A.context;W.save();const L=this.getObject(P,E);o(W,L),W.globalCompositeOperation="source-in",W.fillStyle=x?w.getPattern(W,this,(0,_.getCurrentTransformInverse)(e),T.PathType.FILL):w,W.fillRect(0,0,iI,aI),W.restore(),e.save(),e.transform(...eI),e.scale(1,-1),a(e,A.canvas,0,0,iI,aI,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(J){if(!this.contentVisible)return;const e=this.getObject(J);if(!e){(0,z.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(J,e,w,x){if(!this.contentVisible)return;const E=this.getObject(J);if(!E){(0,z.warn)("Dependent image isn't ready yet");return}const P=E.width,iI=E.height,aI=[];for(let eI=0,A=x.length;eI<A;eI+=2)aI.push({transform:[e,0,0,w,x[eI],x[eI+1]],x:0,y:0,w:P,h:iI});this.paintInlineImageXObjectGroup(E,aI)}paintInlineImageXObject(J){if(!this.contentVisible)return;const e=J.width,w=J.height,x=this.ctx;this.save(),x.scale(1/e,-1/w);let E;if(typeof HTMLElement=="function"&&J instanceof HTMLElement||!J.data)E=J;else{const eI=this.cachedCanvases.getCanvas("inlineImage",e,w),A=eI.context;g(A,J,this.current.transferMaps),E=eI.canvas}const P=this._scaleImage(E,(0,_.getCurrentTransformInverse)(x));x.imageSmoothingEnabled=gI((0,_.getCurrentTransform)(x),J.interpolate);const[iI,aI]=a(x,P.img,0,0,P.paintWidth,P.paintHeight,0,-w,e,w);if(this.imageLayer){const[eI,A]=z.Util.applyTransform([0,-w],(0,_.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:J,left:eI,top:A,width:iI,height:aI})}this.compose(),this.restore()}paintInlineImageXObjectGroup(J,e){if(!this.contentVisible)return;const w=this.ctx,x=J.width,E=J.height,P=this.cachedCanvases.getCanvas("inlineImage",x,E),iI=P.context;g(iI,J,this.current.transferMaps);for(const aI of e){if(w.save(),w.transform(...aI.transform),w.scale(1,-1),a(w,P.canvas,aI.x,aI.y,aI.w,aI.h,0,-1,1,1),this.imageLayer){const[eI,A]=z.Util.applyTransform([aI.x,aI.y],(0,_.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:J,left:eI,top:A,width:x,height:E})}w.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(J){}markPointProps(J,e){}beginMarkedContent(J){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(J,e){J==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(J){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(J);const w=this.ctx;this.pendingClip&&(e||(this.pendingClip===mI?w.clip("evenodd"):w.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),w.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const J=(0,_.getCurrentTransform)(this.ctx);if(J[1]===0&&J[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(J[0]),Math.abs(J[3]));else{const e=Math.abs(J[0]*J[3]-J[2]*J[1]),w=Math.hypot(J[0],J[2]),x=Math.hypot(J[1],J[3]);this._cachedGetSinglePixelWidth=Math.max(w,x)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:J}=this.current,e=(0,_.getCurrentTransform)(this.ctx);let w,x;if(e[1]===0&&e[2]===0){const E=Math.abs(e[0]),P=Math.abs(e[3]);if(J===0)w=1/E,x=1/P;else{const iI=E*J,aI=P*J;w=iI<1?1/iI:1,x=aI<1?1/aI:1}}else{const E=Math.abs(e[0]*e[3]-e[2]*e[1]),P=Math.hypot(e[0],e[1]),iI=Math.hypot(e[2],e[3]);if(J===0)w=iI/E,x=P/E;else{const aI=J*E;w=iI>aI?iI/aI:1,x=P>aI?P/aI:1}}this._cachedScaleForStroking=[w,x]}return this._cachedScaleForStroking}rescaleAndStroke(J){const{ctx:e}=this,{lineWidth:w}=this.current,[x,E]=this.getScaleForStroking();if(e.lineWidth=w||1,x===1&&E===1){e.stroke();return}let P,iI,aI;J&&(P=(0,_.getCurrentTransform)(e),iI=e.getLineDash().slice(),aI=e.lineDashOffset),e.scale(x,E);const eI=Math.max(x,E);e.setLineDash(e.getLineDash().map(A=>A/eI)),e.lineDashOffset/=eI,e.stroke(),J&&(e.setTransform(...P),e.setLineDash(iI),e.lineDashOffset=aI)}isContentVisible(){for(let J=this.markedContentStack.length-1;J>=0;J--)if(!this.markedContentStack[J].visible)return!1;return!0}};let BI=NI;h=new WeakSet,M=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},c.CanvasGraphics=BI;for(const J in z.OPS)BI.prototype[J]!==void 0&&(BI.prototype[z.OPS[J]]=BI.prototype[J])},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TilingPattern=c.PathType=void 0,c.getShadingPattern=d;var h=$(1),M=$(8),_=$(3);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};c.PathType=z;function T(B,Y){if(!Y||_.isNodeJS)return;const a=Y[2]-Y[0],i=Y[3]-Y[1],I=new Path2D;I.rect(Y[0],Y[1],a,i),B.clip(I)}class r{constructor(){this.constructor===r&&(0,h.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,h.unreachable)("Abstract method `getPattern` called.")}}class Z extends r{constructor(Y){super(),this._type=Y[1],this._bbox=Y[2],this._colorStops=Y[3],this._p0=Y[4],this._p1=Y[5],this._r0=Y[6],this._r1=Y[7],this.matrix=null}_createGradient(Y){let a;this._type==="axial"?a=Y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(a=Y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)a.addColorStop(i[0],i[1]);return a}getPattern(Y,a,i,I){let g;if(I===z.STROKE||I===z.FILL){const o=a.current.getClippedPathBoundingBox(I,(0,M.getCurrentTransform)(Y))||[0,0,0,0],X=Math.ceil(o[2]-o[0])||1,b=Math.ceil(o[3]-o[1])||1,N=a.cachedCanvases.getCanvas("pattern",X,b,!0),F=N.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-o[0],-o[1]),i=h.Util.transform(i,[1,0,0,1,o[0],o[1]]),F.transform(...a.baseTransform),this.matrix&&F.transform(...this.matrix),T(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),g=Y.createPattern(N.canvas,"no-repeat");const hI=new DOMMatrix(i);try{g.setTransform(hI)}catch(YI){(0,h.warn)(`RadialAxialShadingPattern.getPattern: "${YI==null?void 0:YI.message}".`)}}else T(Y,this._bbox),g=this._createGradient(Y);return g}}function p(B,Y,a,i,I,g,o,X){const b=Y.coords,N=Y.colors,F=B.data,hI=B.width*4;let YI;b[a+1]>b[i+1]&&(YI=a,a=i,i=YI,YI=g,g=o,o=YI),b[i+1]>b[I+1]&&(YI=i,i=I,I=YI,YI=o,o=X,X=YI),b[a+1]>b[i+1]&&(YI=a,a=i,i=YI,YI=g,g=o,o=YI);const nI=(b[a]+Y.offsetX)*Y.scaleX,gI=(b[a+1]+Y.offsetY)*Y.scaleY,U=(b[i]+Y.offsetX)*Y.scaleX,II=(b[i+1]+Y.offsetY)*Y.scaleY,q=(b[I]+Y.offsetX)*Y.scaleX,mI=(b[I+1]+Y.offsetY)*Y.scaleY;if(gI>=mI)return;const NI=N[g],BI=N[g+1],J=N[g+2],e=N[o],w=N[o+1],x=N[o+2],E=N[X],P=N[X+1],iI=N[X+2],aI=Math.round(gI),eI=Math.round(mI);let A,W,L,S,Q,lI,uI,MI;for(let ZI=aI;ZI<=eI;ZI++){if(ZI<II){let v;ZI<gI?v=0:v=(gI-ZI)/(gI-II),A=nI-(nI-U)*v,W=NI-(NI-e)*v,L=BI-(BI-w)*v,S=J-(J-x)*v}else{let v;ZI>mI?v=1:II===mI?v=0:v=(II-ZI)/(II-mI),A=U-(U-q)*v,W=e-(e-E)*v,L=w-(w-P)*v,S=x-(x-iI)*v}let WI;ZI<gI?WI=0:ZI>mI?WI=1:WI=(gI-ZI)/(gI-mI),Q=nI-(nI-q)*WI,lI=NI-(NI-E)*WI,uI=BI-(BI-P)*WI,MI=J-(J-iI)*WI;const tI=Math.round(Math.min(A,Q)),O=Math.round(Math.max(A,Q));let f=hI*ZI+tI*4;for(let v=tI;v<=O;v++)WI=(A-v)/(A-Q),WI<0?WI=0:WI>1&&(WI=1),F[f++]=W-(W-lI)*WI|0,F[f++]=L-(L-uI)*WI|0,F[f++]=S-(S-MI)*WI|0,F[f++]=255}}function j(B,Y,a){const i=Y.coords,I=Y.colors;let g,o;switch(Y.type){case"lattice":const X=Y.verticesPerRow,b=Math.floor(i.length/X)-1,N=X-1;for(g=0;g<b;g++){let F=g*X;for(let hI=0;hI<N;hI++,F++)p(B,a,i[F],i[F+1],i[F+X],I[F],I[F+1],I[F+X]),p(B,a,i[F+X+1],i[F+1],i[F+X],I[F+X+1],I[F+1],I[F+X])}break;case"triangles":for(g=0,o=i.length;g<o;g+=3)p(B,a,i[g],i[g+1],i[g+2],I[g],I[g+1],I[g+2]);break;default:throw new Error("illegal figure")}}class D extends r{constructor(Y){super(),this._coords=Y[2],this._colors=Y[3],this._figures=Y[4],this._bounds=Y[5],this._bbox=Y[7],this._background=Y[8],this.matrix=null}_createMeshCanvas(Y,a,i){const I=Math.floor(this._bounds[0]),g=Math.floor(this._bounds[1]),o=Math.ceil(this._bounds[2])-I,X=Math.ceil(this._bounds[3])-g,b=Math.min(Math.ceil(Math.abs(o*Y[0]*1.1)),3e3),N=Math.min(Math.ceil(Math.abs(X*Y[1]*1.1)),3e3),F=o/b,hI=X/N,YI={coords:this._coords,colors:this._colors,offsetX:-I,offsetY:-g,scaleX:1/F,scaleY:1/hI},nI=b+2*2,gI=N+2*2,U=i.getCanvas("mesh",nI,gI,!1),II=U.context,q=II.createImageData(b,N);if(a){const mI=q.data;for(let NI=0,BI=mI.length;NI<BI;NI+=4)mI[NI]=a[0],mI[NI+1]=a[1],mI[NI+2]=a[2],mI[NI+3]=255}for(const mI of this._figures)j(q,mI,YI);return II.putImageData(q,2,2),{canvas:U.canvas,offsetX:I-2*F,offsetY:g-2*hI,scaleX:F,scaleY:hI}}getPattern(Y,a,i,I){T(Y,this._bbox);let g;if(I===z.SHADING)g=h.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(Y));else if(g=h.Util.singularValueDecompose2dScale(a.baseTransform),this.matrix){const X=h.Util.singularValueDecompose2dScale(this.matrix);g=[g[0]*X[0],g[1]*X[1]]}const o=this._createMeshCanvas(g,I===z.SHADING?null:this._background,a.cachedCanvases);return I!==z.SHADING&&(Y.setTransform(...a.baseTransform),this.matrix&&Y.transform(...this.matrix)),Y.translate(o.offsetX,o.offsetY),Y.scale(o.scaleX,o.scaleY),Y.createPattern(o.canvas,"no-repeat")}}class m extends r{getPattern(){return"hotpink"}}function d(B){switch(B[0]){case"RadialAxial":return new Z(B);case"Mesh":return new D(B);case"Dummy":return new m}throw new Error(`Unknown IR type: ${B[0]}`)}const C={COLORED:1,UNCOLORED:2};class l{static get MAX_PATTERN_SIZE(){return(0,h.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(Y,a,i,I,g){this.operatorList=Y[2],this.matrix=Y[3]||[1,0,0,1,0,0],this.bbox=Y[4],this.xstep=Y[5],this.ystep=Y[6],this.paintType=Y[7],this.tilingType=Y[8],this.color=a,this.ctx=i,this.canvasGraphicsFactory=I,this.baseTransform=g}createPatternCanvas(Y){const a=this.operatorList,i=this.bbox,I=this.xstep,g=this.ystep,o=this.paintType,X=this.tilingType,b=this.color,N=this.canvasGraphicsFactory;(0,h.info)("TilingType: "+X);const F=i[0],hI=i[1],YI=i[2],nI=i[3],gI=h.Util.singularValueDecompose2dScale(this.matrix),U=h.Util.singularValueDecompose2dScale(this.baseTransform),II=[gI[0]*U[0],gI[1]*U[1]],q=this.getSizeAndScale(I,this.ctx.canvas.width,II[0]),mI=this.getSizeAndScale(g,this.ctx.canvas.height,II[1]),NI=Y.cachedCanvases.getCanvas("pattern",q.size,mI.size,!0),BI=NI.context,J=N.createCanvasGraphics(BI);J.groupLevel=Y.groupLevel,this.setFillAndStrokeStyleToContext(J,o,b);let e=F,w=hI,x=YI,E=nI;return F<0&&(e=0,x+=Math.abs(F)),hI<0&&(w=0,E+=Math.abs(hI)),BI.translate(-(q.scale*e),-(mI.scale*w)),J.transform(q.scale,0,0,mI.scale,0,0),BI.save(),this.clipBbox(J,e,w,x,E),J.baseTransform=(0,M.getCurrentTransform)(J.ctx),J.executeOperatorList(a),J.endDrawing(),{canvas:NI.canvas,scaleX:q.scale,scaleY:mI.scale,offsetX:e,offsetY:w}}getSizeAndScale(Y,a,i){Y=Math.abs(Y);const I=Math.max(l.MAX_PATTERN_SIZE,a);let g=Math.ceil(Y*i);return g>=I?g=I:i=g/Y,{scale:i,size:g}}clipBbox(Y,a,i,I,g){const o=I-a,X=g-i;Y.ctx.rect(a,i,o,X),Y.current.updateRectMinMax((0,M.getCurrentTransform)(Y.ctx),[a,i,I,g]),Y.clip(),Y.endPath()}setFillAndStrokeStyleToContext(Y,a,i){const I=Y.ctx,g=Y.current;switch(a){case C.COLORED:const o=this.ctx;I.fillStyle=o.fillStyle,I.strokeStyle=o.strokeStyle,g.fillColor=o.fillStyle,g.strokeColor=o.strokeStyle;break;case C.UNCOLORED:const X=h.Util.makeHexColor(i[0],i[1],i[2]);I.fillStyle=X,I.strokeStyle=X,g.fillColor=X,g.strokeColor=X;break;default:throw new h.FormatError(`Unsupported paint type: ${a}`)}}getPattern(Y,a,i,I){let g=i;I!==z.SHADING&&(g=h.Util.transform(g,a.baseTransform),this.matrix&&(g=h.Util.transform(g,this.matrix)));const o=this.createPatternCanvas(a);let X=new DOMMatrix(g);X=X.translate(o.offsetX,o.offsetY),X=X.scale(1/o.scaleX,1/o.scaleY);const b=Y.createPattern(o.canvas,"repeat");try{b.setTransform(X)}catch(N){(0,h.warn)(`TilingPattern.getPattern: "${N==null?void 0:N.message}".`)}return b}}c.TilingPattern=l},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.applyMaskImageData=M;var h=$(1);function M({src:_,srcPos:z=0,dest:T,destPos:r=0,width:Z,height:p,inverseDecode:j=!1}){const D=h.FeatureTest.isLittleEndian?4278190080:255,[m,d]=j?[0,D]:[D,0],C=Z>>3,l=Z&7,B=_.length;T=new Uint32Array(T.buffer);for(let Y=0;Y<p;Y++){for(const i=z+C;z<i;z++){const I=z<B?_[z]:255;T[r++]=I&128?d:m,T[r++]=I&64?d:m,T[r++]=I&32?d:m,T[r++]=I&16?d:m,T[r++]=I&8?d:m,T[r++]=I&4?d:m,T[r++]=I&2?d:m,T[r++]=I&1?d:m}if(l===0)continue;const a=z<B?_[z++]:255;for(let i=0;i<l;i++)T[r++]=a&1<<7-i?d:m}return{srcPos:z,destPos:r}}},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GlobalWorkerOptions=void 0;const $=Object.create(null);c.GlobalWorkerOptions=$,$.workerPort=$.workerPort===void 0?null:$.workerPort,$.workerSrc=$.workerSrc===void 0?"":$.workerSrc},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MessageHandler=void 0;var h=$(1);const M={UNKNOWN:0,DATA:1,ERROR:2},_={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z(r){switch(r instanceof Error||typeof r=="object"&&r!==null||(0,h.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new h.AbortException(r.message);case"MissingPDFException":return new h.MissingPDFException(r.message);case"PasswordException":return new h.PasswordException(r.message,r.code);case"UnexpectedResponseException":return new h.UnexpectedResponseException(r.message,r.status);case"UnknownErrorException":return new h.UnknownErrorException(r.message,r.details);default:return new h.UnknownErrorException(r.message,r.toString())}}class T{constructor(Z,p,j){this.sourceName=Z,this.targetName=p,this.comObj=j,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=D=>{const m=D.data;if(m.targetName!==this.sourceName)return;if(m.stream){this._processStreamMessage(m);return}if(m.callback){const C=m.callbackId,l=this.callbackCapabilities[C];if(!l)throw new Error(`Cannot resolve callback ${C}`);if(delete this.callbackCapabilities[C],m.callback===M.DATA)l.resolve(m.data);else if(m.callback===M.ERROR)l.reject(z(m.reason));else throw new Error("Unexpected callback case");return}const d=this.actionHandler[m.action];if(!d)throw new Error(`Unknown action from worker: ${m.action}`);if(m.callbackId){const C=this.sourceName,l=m.sourceName;new Promise(function(B){B(d(m.data))}).then(function(B){j.postMessage({sourceName:C,targetName:l,callback:M.DATA,callbackId:m.callbackId,data:B})},function(B){j.postMessage({sourceName:C,targetName:l,callback:M.ERROR,callbackId:m.callbackId,reason:z(B)})});return}if(m.streamId){this._createStreamSink(m);return}d(m.data)},j.addEventListener("message",this._onComObjOnMessage)}on(Z,p){const j=this.actionHandler;if(j[Z])throw new Error(`There is already an actionName called "${Z}"`);j[Z]=p}send(Z,p,j){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Z,data:p},j)}sendWithPromise(Z,p,j){const D=this.callbackId++,m=(0,h.createPromiseCapability)();this.callbackCapabilities[D]=m;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Z,callbackId:D,data:p},j)}catch(d){m.reject(d)}return m.promise}sendWithStream(Z,p,j,D){const m=this.streamId++,d=this.sourceName,C=this.targetName,l=this.comObj;return new ReadableStream({start:B=>{const Y=(0,h.createPromiseCapability)();return this.streamControllers[m]={controller:B,startCall:Y,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:d,targetName:C,action:Z,streamId:m,data:p,desiredSize:B.desiredSize},D),Y.promise},pull:B=>{const Y=(0,h.createPromiseCapability)();return this.streamControllers[m].pullCall=Y,l.postMessage({sourceName:d,targetName:C,stream:_.PULL,streamId:m,desiredSize:B.desiredSize}),Y.promise},cancel:B=>{(0,h.assert)(B instanceof Error,"cancel must have a valid reason");const Y=(0,h.createPromiseCapability)();return this.streamControllers[m].cancelCall=Y,this.streamControllers[m].isClosed=!0,l.postMessage({sourceName:d,targetName:C,stream:_.CANCEL,streamId:m,reason:z(B)}),Y.promise}},j)}_createStreamSink(Z){const p=Z.streamId,j=this.sourceName,D=Z.sourceName,m=this.comObj,d=this,C=this.actionHandler[Z.action],l={enqueue(B,Y=1,a){if(this.isCancelled)return;const i=this.desiredSize;this.desiredSize-=Y,i>0&&this.desiredSize<=0&&(this.sinkCapability=(0,h.createPromiseCapability)(),this.ready=this.sinkCapability.promise),m.postMessage({sourceName:j,targetName:D,stream:_.ENQUEUE,streamId:p,chunk:B},a)},close(){this.isCancelled||(this.isCancelled=!0,m.postMessage({sourceName:j,targetName:D,stream:_.CLOSE,streamId:p}),delete d.streamSinks[p])},error(B){(0,h.assert)(B instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,m.postMessage({sourceName:j,targetName:D,stream:_.ERROR,streamId:p,reason:z(B)}))},sinkCapability:(0,h.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:Z.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[p]=l,new Promise(function(B){B(C(Z.data,l))}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.START_COMPLETE,streamId:p,success:!0})},function(B){m.postMessage({sourceName:j,targetName:D,stream:_.START_COMPLETE,streamId:p,reason:z(B)})})}_processStreamMessage(Z){const p=Z.streamId,j=this.sourceName,D=Z.sourceName,m=this.comObj,d=this.streamControllers[p],C=this.streamSinks[p];switch(Z.stream){case _.START_COMPLETE:Z.success?d.startCall.resolve():d.startCall.reject(z(Z.reason));break;case _.PULL_COMPLETE:Z.success?d.pullCall.resolve():d.pullCall.reject(z(Z.reason));break;case _.PULL:if(!C){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,success:!0});break}C.desiredSize<=0&&Z.desiredSize>0&&C.sinkCapability.resolve(),C.desiredSize=Z.desiredSize,new Promise(function(l){l(C.onPull&&C.onPull())}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,success:!0})},function(l){m.postMessage({sourceName:j,targetName:D,stream:_.PULL_COMPLETE,streamId:p,reason:z(l)})});break;case _.ENQUEUE:if((0,h.assert)(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(Z.chunk);break;case _.CLOSE:if((0,h.assert)(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this._deleteStreamController(d,p);break;case _.ERROR:(0,h.assert)(d,"error should have stream controller"),d.controller.error(z(Z.reason)),this._deleteStreamController(d,p);break;case _.CANCEL_COMPLETE:Z.success?d.cancelCall.resolve():d.cancelCall.reject(z(Z.reason)),this._deleteStreamController(d,p);break;case _.CANCEL:if(!C)break;new Promise(function(l){l(C.onCancel&&C.onCancel(z(Z.reason)))}).then(function(){m.postMessage({sourceName:j,targetName:D,stream:_.CANCEL_COMPLETE,streamId:p,success:!0})},function(l){m.postMessage({sourceName:j,targetName:D,stream:_.CANCEL_COMPLETE,streamId:p,reason:z(l)})}),C.sinkCapability.reject(z(Z.reason)),C.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(Z,p){await Promise.allSettled([Z.startCall&&Z.startCall.promise,Z.pullCall&&Z.pullCall.promise,Z.cancelCall&&Z.cancelCall.promise]),delete this.streamControllers[p]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}c.MessageHandler=T},(wI,c,$)=>{var h,M;Object.defineProperty(c,"__esModule",{value:!0}),c.Metadata=void 0;var _=$(1);class z{constructor({parsedData:r,rawData:Z}){GI(this,h,void 0),GI(this,M,void 0),XI(this,h,r),XI(this,M,Z)}getRaw(){return R(this,M)}get(r){return R(this,h).get(r)??null}getAll(){return(0,_.objectFromMap)(R(this,h))}has(r){return R(this,h).has(r)}}h=new WeakMap,M=new WeakMap,c.Metadata=z},(wI,c,$)=>{var h,M,_,z,T,r,Z;Object.defineProperty(c,"__esModule",{value:!0}),c.OptionalContentConfig=void 0;var p=$(1);const j=Symbol("INTERNAL");class D{constructor(C,l){GI(this,h,!0),this.name=C,this.intent=l}get visible(){return R(this,h)}_setVisible(C,l){C!==j&&(0,p.unreachable)("Internal method `_setVisible` called."),XI(this,h,l)}}h=new WeakMap;class m{constructor(C){if(GI(this,r),GI(this,M,!0),GI(this,_,new Map),GI(this,z,null),GI(this,T,null),this.name=null,this.creator=null,C!==null){this.name=C.name,this.creator=C.creator,XI(this,T,C.order);for(const l of C.groups)R(this,_).set(l.id,new D(l.name,l.intent));if(C.baseState==="OFF")for(const l of R(this,_).values())l._setVisible(j,!1);for(const l of C.on)R(this,_).get(l)._setVisible(j,!0);for(const l of C.off)R(this,_).get(l)._setVisible(j,!1);XI(this,z,new Map);for(const[l,B]of R(this,_))R(this,z).set(l,B.visible)}}isVisible(C){if(R(this,_).size===0)return!0;if(!C)return(0,p.warn)("Optional content group not defined."),!0;if(C.type==="OCG")return R(this,_).has(C.id)?R(this,_).get(C.id).visible:((0,p.warn)(`Optional content group not found: ${C.id}`),!0);if(C.type==="OCMD"){if(C.expression)return bI(this,r,Z).call(this,C.expression);if(!C.policy||C.policy==="AnyOn"){for(const l of C.ids){if(!R(this,_).has(l))return(0,p.warn)(`Optional content group not found: ${l}`),!0;if(R(this,_).get(l).visible)return!0}return!1}else if(C.policy==="AllOn"){for(const l of C.ids){if(!R(this,_).has(l))return(0,p.warn)(`Optional content group not found: ${l}`),!0;if(!R(this,_).get(l).visible)return!1}return!0}else if(C.policy==="AnyOff"){for(const l of C.ids){if(!R(this,_).has(l))return(0,p.warn)(`Optional content group not found: ${l}`),!0;if(!R(this,_).get(l).visible)return!0}return!1}else if(C.policy==="AllOff"){for(const l of C.ids){if(!R(this,_).has(l))return(0,p.warn)(`Optional content group not found: ${l}`),!0;if(R(this,_).get(l).visible)return!1}return!0}return(0,p.warn)(`Unknown optional content policy ${C.policy}.`),!0}return(0,p.warn)(`Unknown group type ${C.type}.`),!0}setVisibility(C,l=!0){if(!R(this,_).has(C)){(0,p.warn)(`Optional content group not found: ${C}`);return}R(this,_).get(C)._setVisible(j,!!l),XI(this,M,null)}get hasInitialVisibility(){if(R(this,M)!==null)return R(this,M);for(const[C,l]of R(this,_)){const B=R(this,z).get(C);if(l.visible!==B)return XI(this,M,!1)}return XI(this,M,!0)}getOrder(){return R(this,_).size?R(this,T)?R(this,T).slice():[...R(this,_).keys()]:null}getGroups(){return R(this,_).size>0?(0,p.objectFromMap)(R(this,_)):null}getGroup(C){return R(this,_).get(C)||null}}M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,r=new WeakSet,Z=function(d){const C=d.length;if(C<2)return!0;const l=d[0];for(let B=1;B<C;B++){const Y=d[B];let a;if(Array.isArray(Y))a=bI(this,r,Z).call(this,Y);else if(R(this,_).has(Y))a=R(this,_).get(Y).visible;else return(0,p.warn)(`Optional content group not found: ${Y}`),!0;switch(l){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return l==="And"},c.OptionalContentConfig=m},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFDataTransportStream=void 0;var h=$(1),M=$(8);class _{constructor(Z,p){(0,h.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=Z.progressiveDone||!1,this._contentDispositionFilename=Z.contentDispositionFilename||null;const j=Z.initialData;if((j==null?void 0:j.length)>0){const D=new Uint8Array(j).buffer;this._queuedChunks.push(D)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!Z.disableStream,this._isRangeSupported=!Z.disableRange,this._contentLength=Z.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((D,m)=>{this._onReceiveData({begin:D,chunk:m})}),this._pdfDataRangeTransport.addProgressListener((D,m)=>{this._onProgress({loaded:D,total:m})}),this._pdfDataRangeTransport.addProgressiveReadListener(D=>{this._onReceiveData({chunk:D})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(Z){const p=new Uint8Array(Z.chunk).buffer;if(Z.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const j=this._rangeReaders.some(function(D){return D._begin!==Z.begin?!1:(D._enqueue(p),!0)});(0,h.assert)(j,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var Z;return((Z=this._fullRequestReader)==null?void 0:Z._loaded)??0}_onProgress(Z){if(Z.total===void 0){const p=this._rangeReaders[0];p!=null&&p.onProgress&&p.onProgress({loaded:Z.loaded})}else{const p=this._fullRequestReader;p!=null&&p.onProgress&&p.onProgress({loaded:Z.loaded,total:Z.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(Z){const p=this._rangeReaders.indexOf(Z);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,h.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const Z=this._queuedChunks;return this._queuedChunks=null,new z(this,Z,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(Z,p){if(p<=this._progressiveDataLength)return null;const j=new T(this,Z,p);return this._pdfDataRangeTransport.requestDataRange(Z,p),this._rangeReaders.push(j),j}cancelAllRequests(Z){this._fullRequestReader&&this._fullRequestReader.cancel(Z);for(const p of this._rangeReaders.slice(0))p.cancel(Z);this._pdfDataRangeTransport.abort()}}c.PDFDataTransportStream=_;class z{constructor(Z,p,j=!1,D=null){this._stream=Z,this._done=j||!1,this._filename=(0,M.isPdfFile)(D)?D:null,this._queuedChunks=p||[],this._loaded=0;for(const m of this._queuedChunks)this._loaded+=m.byteLength;this._requests=[],this._headersReady=Promise.resolve(),Z._fullRequestReader=this,this.onProgress=null}_enqueue(Z){this._done||(this._requests.length>0?this._requests.shift().resolve({value:Z,done:!1}):this._queuedChunks.push(Z),this._loaded+=Z.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Z=(0,h.createPromiseCapability)();return this._requests.push(Z),Z.promise}cancel(Z){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class T{constructor(Z,p,j){this._stream=Z,this._begin=p,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(Z){if(!this._done){if(this._requests.length===0)this._queuedChunk=Z;else{this._requests.shift().resolve({value:Z,done:!1});for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const Z=(0,h.createPromiseCapability)();return this._requests.push(Z),Z.promise}cancel(Z){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaText=void 0;class ${static textContent(M){const _=[],z={items:_,styles:Object.create(null)};function T(r){var Z;if(!r)return;let p=null;const j=r.name;if(j==="#text")p=r.value;else if($.shouldBuildText(j))(Z=r==null?void 0:r.attributes)!=null&&Z.textContent?p=r.attributes.textContent:r.value&&(p=r.value);else return;if(p!==null&&_.push({str:p}),!!r.children)for(const D of r.children)T(D)}return T(M),z}static shouldBuildText(M){return!(M==="textarea"||M==="input"||M==="option"||M==="select")}}c.XfaText=$},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.NodeStandardFontDataFactory=c.NodeCanvasFactory=c.NodeCMapReaderFactory=void 0;var h=$(9);const M=function(r){return new Promise((Z,p)=>{require$$5.readFile(r,(j,D)=>{if(j||!D){p(new Error(j));return}Z(new Uint8Array(D))})})};class _ extends h.BaseCanvasFactory{_createCanvas(Z,p){return require$$5.createCanvas(Z,p)}}c.NodeCanvasFactory=_;class z extends h.BaseCMapReaderFactory{_fetchData(Z,p){return M(Z).then(j=>({cMapData:j,compressionType:p}))}}c.NodeCMapReaderFactory=z;class T extends h.BaseStandardFontDataFactory{_fetchData(Z){return M(Z)}}c.NodeStandardFontDataFactory=T},(wI,c,$)=>{var h,M,_,z,T,r,Z,p,j,D,m,d,C,l,B,Y;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditorLayer=void 0;var a=$(7),i=$(1),I=$(23),g=$(24);const o=class{constructor(b){GI(this,j),GI(this,m),GI(this,C),GI(this,B),GI(this,h,void 0),GI(this,M,!1),GI(this,_,this.pointerup.bind(this)),GI(this,z,this.pointerdown.bind(this)),GI(this,T,new Map),GI(this,r,!1),GI(this,Z,!1),GI(this,p,void 0),o._initialized||(o._initialized=!0,I.FreeTextEditor.initialize(b.l10n),g.InkEditor.initialize(b.l10n),b.uiManager.registerEditorTypes([I.FreeTextEditor,g.InkEditor])),XI(this,p,b.uiManager),this.annotationStorage=b.annotationStorage,this.pageIndex=b.pageIndex,this.div=b.div,XI(this,h,b.accessibilityManager),R(this,p).addLayer(this)}updateToolbar(b){R(this,p).updateToolbar(b)}updateMode(b=R(this,p).getMode()){bI(this,B,Y).call(this),b===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),R(this,p).unselectAll()}addInkEditorIfNeeded(b){if(!(!b&&R(this,p).getMode()!==i.AnnotationEditorType.INK)){if(!b){for(const N of R(this,T).values())if(N.isEmpty()){N.setInBackground();return}}bI(this,C,l).call(this,{offsetX:0,offsetY:0}).setInBackground()}}setEditingState(b){R(this,p).setEditingState(b)}addCommands(b){R(this,p).addCommands(b)}enable(){this.div.style.pointerEvents="auto";for(const b of R(this,T).values())b.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const b of R(this,T).values())b.disableEditing()}setActiveEditor(b){R(this,p).getActive()!==b&&R(this,p).setActiveEditor(b)}enableClick(){this.div.addEventListener("pointerdown",R(this,z)),this.div.addEventListener("pointerup",R(this,_))}disableClick(){this.div.removeEventListener("pointerdown",R(this,z)),this.div.removeEventListener("pointerup",R(this,_))}attach(b){R(this,T).set(b.id,b)}detach(b){var N;R(this,T).delete(b.id),(N=R(this,h))==null||N.removePointerInTextLayer(b.contentDiv)}remove(b){R(this,p).removeEditor(b),this.detach(b),this.annotationStorage.remove(b.id),b.div.style.display="none",setTimeout(()=>{b.div.style.display="",b.div.remove(),b.isAttachedToDOM=!1,document.activeElement===document.body&&R(this,p).focusMainContainer()},0),R(this,Z)||this.addInkEditorIfNeeded(!1)}add(b){if(bI(this,j,D).call(this,b),R(this,p).addEditor(b),this.attach(b),!b.isAttachedToDOM){const N=b.render();this.div.append(N),b.isAttachedToDOM=!0}this.moveEditorInDOM(b),b.onceAdded(),this.addToAnnotationStorage(b)}moveEditorInDOM(b){var N;(N=R(this,h))==null||N.moveElementInDOM(this.div,b.div,b.contentDiv,!0)}addToAnnotationStorage(b){!b.isEmpty()&&!this.annotationStorage.has(b.id)&&this.annotationStorage.setValue(b.id,b)}addOrRebuild(b){b.needsToBeRebuilt()?b.rebuild():this.add(b)}addANewEditor(b){const N=()=>{this.addOrRebuild(b)},F=()=>{b.remove()};this.addCommands({cmd:N,undo:F,mustExec:!0})}addUndoableEditor(b){const N=()=>{this.addOrRebuild(b)},F=()=>{b.remove()};this.addCommands({cmd:N,undo:F,mustExec:!1})}getNextId(){return R(this,p).getId()}deserialize(b){switch(b.annotationType){case i.AnnotationEditorType.FREETEXT:return I.FreeTextEditor.deserialize(b,this);case i.AnnotationEditorType.INK:return g.InkEditor.deserialize(b,this)}return null}setSelected(b){R(this,p).setSelected(b)}toggleSelected(b){R(this,p).toggleSelected(b)}isSelected(b){return R(this,p).isSelected(b)}unselect(b){R(this,p).unselect(b)}pointerup(b){const N=a.KeyboardManager.platform.isMac;if(!(b.button!==0||b.ctrlKey&&N)&&b.target===this.div&&R(this,r)){if(XI(this,r,!1),!R(this,M)){XI(this,M,!0);return}bI(this,C,l).call(this,b)}}pointerdown(b){const N=a.KeyboardManager.platform.isMac;if(b.button!==0||b.ctrlKey&&N||b.target!==this.div)return;XI(this,r,!0);const F=R(this,p).getActive();XI(this,M,!F||F.isEmpty())}drop(b){const N=b.dataTransfer.getData("text/plain"),F=R(this,p).getEditor(N);if(!F)return;b.preventDefault(),b.dataTransfer.dropEffect="move",bI(this,j,D).call(this,F);const hI=this.div.getBoundingClientRect(),YI=b.clientX-hI.x,nI=b.clientY-hI.y;F.translate(YI-F.startX,nI-F.startY),this.moveEditorInDOM(F),F.div.focus()}dragover(b){b.preventDefault()}destroy(){var b,N;((b=R(this,p).getActive())==null?void 0:b.parent)===this&&R(this,p).setActiveEditor(null);for(const F of R(this,T).values())(N=R(this,h))==null||N.removePointerInTextLayer(F.contentDiv),F.isAttachedToDOM=!1,F.div.remove(),F.parent=null;this.div=null,R(this,T).clear(),R(this,p).removeLayer(this)}render(b){this.viewport=b.viewport,(0,a.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const N of R(this,p).getEditors(this.pageIndex))this.add(N);this.updateMode()}update(b){this.viewport=b.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[b,N,F,hI]=this.viewport.viewBox,YI=F-b,nI=hI-N;return[YI,nI]}get viewportBaseDimensions(){const{width:b,height:N,rotation:F}=this.viewport;return F%180===0?[b,N]:[N,b]}setDimensions(){const{width:b,height:N,rotation:F}=this.viewport,hI=F%180!==0,YI=Math.floor(b)+"px",nI=Math.floor(N)+"px";this.div.style.width=hI?nI:YI,this.div.style.height=hI?YI:nI,this.div.setAttribute("data-main-rotation",F)}};let X=o;h=new WeakMap,M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakSet,D=function(b){var N;b.parent!==this&&(this.attach(b),b.pageIndex=this.pageIndex,(N=b.parent)==null||N.detach(b),b.parent=this,b.div&&b.isAttachedToDOM&&(b.div.remove(),this.div.append(b.div)))},m=new WeakSet,d=function(b){switch(R(this,p).getMode()){case i.AnnotationEditorType.FREETEXT:return new I.FreeTextEditor(b);case i.AnnotationEditorType.INK:return new g.InkEditor(b)}return null},C=new WeakSet,l=function(b){const N=this.getNextId(),F=bI(this,m,d).call(this,{parent:this,id:N,x:b.offsetX,y:b.offsetY});return F&&this.add(F),F},B=new WeakSet,Y=function(){XI(this,Z,!0);for(const b of R(this,T).values())b.isEmpty()&&b.remove();XI(this,Z,!1)},QI(X,"_initialized",!1),c.AnnotationEditorLayer=X},(wI,c,$)=>{var h,M,_,z,T,r,Z,p,j,D,m,d,C,l,B;Object.defineProperty(c,"__esModule",{value:!0}),c.FreeTextEditor=void 0;var Y=$(1),a=$(7),i=$(6);const I=class extends i.AnnotationEditor{constructor(o){super({...o,name:"freeTextEditor"}),GI(this,p),GI(this,D),GI(this,d),GI(this,l),GI(this,h,this.editorDivBlur.bind(this)),GI(this,M,this.editorDivFocus.bind(this)),GI(this,_,this.editorDivKeydown.bind(this)),GI(this,z,void 0),GI(this,T,""),GI(this,r,!1),GI(this,Z,void 0),XI(this,z,o.color||I._defaultColor||i.AnnotationEditor._defaultLineColor),XI(this,Z,o.fontSize||I._defaultFontSize)}static initialize(o){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(b=>[b,o.get(b)]));const X=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(X.getPropertyValue("--freetext-padding"))}static updateDefaultParams(o,X){switch(o){case Y.AnnotationEditorParamsType.FREETEXT_SIZE:I._defaultFontSize=X;break;case Y.AnnotationEditorParamsType.FREETEXT_COLOR:I._defaultColor=X;break}}updateParams(o,X){switch(o){case Y.AnnotationEditorParamsType.FREETEXT_SIZE:bI(this,p,j).call(this,X);break;case Y.AnnotationEditorParamsType.FREETEXT_COLOR:bI(this,D,m).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[Y.AnnotationEditorParamsType.FREETEXT_SIZE,I._defaultFontSize],[Y.AnnotationEditorParamsType.FREETEXT_COLOR,I._defaultColor||i.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[Y.AnnotationEditorParamsType.FREETEXT_SIZE,R(this,Z)],[Y.AnnotationEditorParamsType.FREETEXT_COLOR,R(this,z)]]}getInitialTranslation(){return[-I._internalPadding*this.parent.scaleFactor,-(I._internalPadding+R(this,Z))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(Y.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",R(this,_)),this.editorDiv.addEventListener("focus",R(this,M)),this.editorDiv.addEventListener("blur",R(this,h)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",R(this,_)),this.editorDiv.removeEventListener("focus",R(this,M)),this.editorDiv.removeEventListener("blur",R(this,h)),this.div.focus(),this.isEditing=!1)}focusin(o){super.focusin(o),o.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),R(this,r)||(XI(this,r,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),XI(this,T,bI(this,d,C).call(this).trimEnd()),bI(this,l,B).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(o){this.enableEditMode(),this.editorDiv.focus()}keydown(o){o.target===this.div&&o.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(o){I._keyboardManager.exec(this,o)}editorDivFocus(o){this.isEditing=!0}editorDivBlur(o){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let o,X;this.width&&(o=this.x,X=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),I._l10nPromise.get("editor_free_text_aria_label").then(N=>{var F;return(F=this.editorDiv)==null?void 0:F.setAttribute("aria-label",N)}),I._l10nPromise.get("free_text_default_content").then(N=>{var F;return(F=this.editorDiv)==null?void 0:F.setAttribute("default-content",N)}),this.editorDiv.contentEditable=!0;const{style:b}=this.editorDiv;if(b.fontSize=`calc(${R(this,Z)}px * var(--scale-factor))`,b.color=R(this,z),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[N,F]=this.parent.viewportBaseDimensions;this.setAt(o*N,X*F,this.width*N,this.height*F);for(const hI of R(this,T).split(`
`)){const YI=document.createElement("div");YI.append(hI?document.createTextNode(hI):document.createElement("br")),this.editorDiv.append(YI)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(o,X){const b=super.deserialize(o,X);return XI(b,Z,o.fontSize),XI(b,z,Y.Util.makeHexColor(...o.color)),XI(b,T,o.value),b}serialize(){if(this.isEmpty())return null;const o=I._internalPadding*this.parent.scaleFactor,X=this.getRect(o,o),b=i.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:Y.AnnotationEditorType.FREETEXT,color:b,fontSize:R(this,Z),value:R(this,T),pageIndex:this.parent.pageIndex,rect:X,rotation:this.rotation}}};let g=I;h=new WeakMap,M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,r=new WeakMap,Z=new WeakMap,p=new WeakSet,j=function(o){const X=N=>{this.editorDiv.style.fontSize=`calc(${N}px * var(--scale-factor))`,this.translate(0,-(N-R(this,Z))*this.parent.scaleFactor),XI(this,Z,N),bI(this,l,B).call(this)},b=R(this,Z);this.parent.addCommands({cmd:()=>{X(o)},undo:()=>{X(b)},mustExec:!0,type:Y.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},D=new WeakSet,m=function(o){const X=R(this,z);this.parent.addCommands({cmd:()=>{XI(this,z,o),this.editorDiv.style.color=o},undo:()=>{XI(this,z,X),this.editorDiv.style.color=X},mustExec:!0,type:Y.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},d=new WeakSet,C=function(){const o=this.editorDiv.getElementsByTagName("div");if(o.length===0)return this.editorDiv.innerText;const X=[];for(let b=0,N=o.length;b<N;b++){const F=o[b].firstChild;(F==null?void 0:F.nodeName)==="#text"?X.push(F.data):X.push("")}return X.join(`
`)},l=new WeakSet,B=function(){const[o,X]=this.parent.viewportBaseDimensions,b=this.div.getBoundingClientRect();this.width=b.width/o,this.height=b.height/X},QI(g,"_freeTextDefaultContent",""),QI(g,"_l10nPromise"),QI(g,"_internalPadding",0),QI(g,"_defaultColor",null),QI(g,"_defaultFontSize",10),QI(g,"_keyboardManager",new a.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],I.prototype.commitOrRemove]])),QI(g,"_type","freetext"),c.FreeTextEditor=g},(wI,c,$)=>{var h,M,_,z,T,r,Z,p,j,D,m,d,C,l,B,Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI,NI,BI,J,e,w,x,E,P,iI,aI,eI,A,W,L,S,Q,lI,uI,MI,ZI,WI,tI,O,f,v,RI,pI;Object.defineProperty(c,"__esModule",{value:!0}),c.InkEditor=void 0,Object.defineProperty(c,"fitCurve",{enumerable:!0,get:function(){return TI.fitCurve}});var DI=$(1),FI=$(6),TI=$(25),vI=$(7);const fI=16,PI=class extends FI.AnnotationEditor{constructor(SI){super({...SI,name:"inkEditor"}),GI(this,B),GI(this,a),GI(this,I),GI(this,o),GI(this,b),GI(this,F),GI(this,YI),GI(this,gI),GI(this,II),GI(this,mI),GI(this,BI),GI(this,e),GI(this,x),GI(this,P),GI(this,aI),GI(this,L),GI(this,Q),GI(this,uI),GI(this,ZI),GI(this,tI),GI(this,f),GI(this,RI),GI(this,h,0),GI(this,M,0),GI(this,_,0),GI(this,z,this.canvasPointermove.bind(this)),GI(this,T,this.canvasPointerleave.bind(this)),GI(this,r,this.canvasPointerup.bind(this)),GI(this,Z,this.canvasPointerdown.bind(this)),GI(this,p,!1),GI(this,j,!1),GI(this,D,null),GI(this,m,null),GI(this,d,0),GI(this,C,0),GI(this,l,null),this.color=SI.color||null,this.thickness=SI.thickness||null,this.opacity=SI.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(SI){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(JI=>[JI,SI.get(JI)]))}static updateDefaultParams(SI,JI){switch(SI){case DI.AnnotationEditorParamsType.INK_THICKNESS:PI._defaultThickness=JI;break;case DI.AnnotationEditorParamsType.INK_COLOR:PI._defaultColor=JI;break;case DI.AnnotationEditorParamsType.INK_OPACITY:PI._defaultOpacity=JI/100;break}}updateParams(SI,JI){switch(SI){case DI.AnnotationEditorParamsType.INK_THICKNESS:bI(this,B,Y).call(this,JI);break;case DI.AnnotationEditorParamsType.INK_COLOR:bI(this,a,i).call(this,JI);break;case DI.AnnotationEditorParamsType.INK_OPACITY:bI(this,I,g).call(this,JI);break}}static get defaultPropertiesToUpdate(){return[[DI.AnnotationEditorParamsType.INK_THICKNESS,PI._defaultThickness],[DI.AnnotationEditorParamsType.INK_COLOR,PI._defaultColor||FI.AnnotationEditor._defaultLineColor],[DI.AnnotationEditorParamsType.INK_OPACITY,Math.round(PI._defaultOpacity*100)]]}get propertiesToUpdate(){return[[DI.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||PI._defaultThickness],[DI.AnnotationEditorParamsType.INK_COLOR,this.color||PI._defaultColor||FI.AnnotationEditor._defaultLineColor],[DI.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??PI._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(bI(this,BI,J).call(this),bI(this,e,w).call(this)),this.isAttachedToDOM||(this.parent.add(this),bI(this,x,E).call(this)),bI(this,f,v).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,R(this,m).disconnect(),XI(this,m,null),super.remove())}enableEditMode(){R(this,p)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",R(this,Z)),this.canvas.addEventListener("pointerup",R(this,r)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",R(this,Z)),this.canvas.removeEventListener("pointerup",R(this,r)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){R(this,p)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),XI(this,p,!0),this.div.classList.add("disabled"),bI(this,f,v).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(SI){super.focusin(SI),this.enableEditMode()}canvasPointerdown(SI){SI.button!==0||!this.isInEditMode()||R(this,p)||(this.setInForeground(),SI.type!=="mouse"&&this.div.focus(),SI.stopPropagation(),this.canvas.addEventListener("pointerleave",R(this,T)),this.canvas.addEventListener("pointermove",R(this,z)),bI(this,F,hI).call(this,SI.offsetX,SI.offsetY))}canvasPointermove(SI){SI.stopPropagation(),bI(this,YI,nI).call(this,SI.offsetX,SI.offsetY)}canvasPointerup(SI){SI.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(SI.stopPropagation(),bI(this,mI,NI).call(this,SI),this.setInBackground())}canvasPointerleave(SI){bI(this,mI,NI).call(this,SI),this.setInBackground()}render(){if(this.div)return this.div;let SI,JI;this.width&&(SI=this.x,JI=this.y),super.render(),PI._l10nPromise.get("editor_ink_aria_label").then(AI=>{var KI;return(KI=this.div)==null?void 0:KI.setAttribute("aria-label",AI)});const[yI,HI,cI,CI]=bI(this,o,X).call(this);if(this.setAt(yI,HI,0,0),this.setDims(cI,CI),bI(this,BI,J).call(this),this.width){const[AI,KI]=this.parent.viewportBaseDimensions;this.setAt(SI*AI,JI*KI,this.width*AI,this.height*KI),XI(this,j,!0),bI(this,x,E).call(this),this.setDims(this.width*AI,this.height*KI),bI(this,II,q).call(this),bI(this,RI,pI).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return bI(this,e,w).call(this),this.div}setDimensions(SI,JI){const yI=Math.round(SI),HI=Math.round(JI);if(R(this,d)===yI&&R(this,C)===HI)return;XI(this,d,yI),XI(this,C,HI),this.canvas.style.visibility="hidden",R(this,h)&&Math.abs(R(this,h)-SI/JI)>.01&&(JI=Math.ceil(SI/R(this,h)),this.setDims(SI,JI));const[cI,CI]=this.parent.viewportBaseDimensions;this.width=SI/cI,this.height=JI/CI,R(this,p)&&bI(this,P,iI).call(this,SI,JI),bI(this,x,E).call(this),bI(this,II,q).call(this),this.canvas.style.visibility="visible"}static deserialize(SI,JI){var yI,HI;const cI=super.deserialize(SI,JI);cI.thickness=SI.thickness,cI.color=DI.Util.makeHexColor(...SI.color),cI.opacity=SI.opacity;const[CI,AI]=JI.pageDimensions,KI=cI.width*CI,LI=cI.height*AI,rI=JI.scaleFactor,kI=SI.thickness/2;XI(cI,h,KI/LI),XI(cI,p,!0),XI(cI,d,Math.round(KI)),XI(cI,C,Math.round(LI));for(const{bezier:_I}of SI.paths){const $I=[];cI.paths.push($I);let OI=rI*(_I[0]-kI),gg=rI*(LI-_I[1]-kI);for(let Ag=2,qI=_I.length;Ag<qI;Ag+=6){const lg=rI*(_I[Ag]-kI),ig=rI*(LI-_I[Ag+1]-kI),og=rI*(_I[Ag+2]-kI),Zg=rI*(LI-_I[Ag+3]-kI),sg=rI*(_I[Ag+4]-kI),Cg=rI*(LI-_I[Ag+5]-kI);$I.push([[OI,gg],[lg,ig],[og,Zg],[sg,Cg]]),OI=sg,gg=Cg}const Ig=bI(this,A,W).call(this,$I);cI.bezierPath2D.push(Ig)}const xI=bI(yI=cI,ZI,WI).call(yI);return XI(cI,_,Math.max(fI,xI[2]-xI[0])),XI(cI,M,Math.max(fI,xI[3]-xI[1])),bI(HI=cI,P,iI).call(HI,KI,LI),cI}serialize(){if(this.isEmpty())return null;const SI=this.getRect(0,0),JI=this.rotation%180===0?SI[3]-SI[1]:SI[2]-SI[0],yI=FI.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:DI.AnnotationEditorType.INK,color:yI,thickness:this.thickness,opacity:this.opacity,paths:bI(this,L,S).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,JI),pageIndex:this.parent.pageIndex,rect:SI,rotation:this.rotation}}};let EI=PI;h=new WeakMap,M=new WeakMap,_=new WeakMap,z=new WeakMap,T=new WeakMap,r=new WeakMap,Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakMap,d=new WeakMap,C=new WeakMap,l=new WeakMap,B=new WeakSet,Y=function(SI){const JI=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=SI,bI(this,f,v).call(this)},undo:()=>{this.thickness=JI,bI(this,f,v).call(this)},mustExec:!0,type:DI.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},a=new WeakSet,i=function(SI){const JI=this.color;this.parent.addCommands({cmd:()=>{this.color=SI,bI(this,II,q).call(this)},undo:()=>{this.color=JI,bI(this,II,q).call(this)},mustExec:!0,type:DI.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},I=new WeakSet,g=function(SI){SI/=100;const JI=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=SI,bI(this,II,q).call(this)},undo:()=>{this.opacity=JI,bI(this,II,q).call(this)},mustExec:!0,type:DI.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,X=function(){const{width:SI,height:JI,rotation:yI}=this.parent.viewport;switch(yI){case 90:return[0,SI,SI,JI];case 180:return[SI,JI,SI,JI];case 270:return[JI,0,SI,JI];default:return[0,0,SI,JI]}},b=new WeakSet,N=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,vI.opacityToHex)(this.opacity)}`},F=new WeakSet,hI=function(SI,JI){this.isEditing=!0,R(this,j)||(XI(this,j,!0),bI(this,x,E).call(this),this.thickness||(this.thickness=PI._defaultThickness),this.color||(this.color=PI._defaultColor||FI.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=PI._defaultOpacity)),this.currentPath.push([SI,JI]),XI(this,D,null),bI(this,b,N).call(this),this.ctx.beginPath(),this.ctx.moveTo(SI,JI),XI(this,l,()=>{R(this,l)&&(R(this,D)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):bI(this,II,q).call(this),this.ctx.lineTo(...R(this,D)),XI(this,D,null),this.ctx.stroke()),window.requestAnimationFrame(R(this,l)))}),window.requestAnimationFrame(R(this,l))},YI=new WeakSet,nI=function(SI,JI){const[yI,HI]=this.currentPath.at(-1);SI===yI&&JI===HI||(this.currentPath.push([SI,JI]),XI(this,D,[SI,JI]))},gI=new WeakSet,U=function(SI,JI){var yI;this.ctx.closePath(),XI(this,l,null),SI=Math.min(Math.max(SI,0),this.canvas.width),JI=Math.min(Math.max(JI,0),this.canvas.height);const[HI,cI]=this.currentPath.at(-1);(SI!==HI||JI!==cI)&&this.currentPath.push([SI,JI]);let CI;if(this.currentPath.length!==1)CI=(0,TI.fitCurve)(this.currentPath,30,null);else{const rI=[SI,JI];CI=[[rI,rI.slice(),rI.slice(),rI]]}const AI=bI(yI=PI,A,W).call(yI,CI);this.currentPath.length=0;const KI=()=>{this.paths.push(CI),this.bezierPath2D.push(AI),this.rebuild()},LI=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(bI(this,BI,J).call(this),bI(this,e,w).call(this)),bI(this,f,v).call(this))};this.parent.addCommands({cmd:KI,undo:LI,mustExec:!0})},II=new WeakSet,q=function(){if(this.isEmpty()){bI(this,aI,eI).call(this);return}bI(this,b,N).call(this);const{canvas:SI,ctx:JI}=this;JI.setTransform(1,0,0,1,0,0),JI.clearRect(0,0,SI.width,SI.height),bI(this,aI,eI).call(this);for(const yI of this.bezierPath2D)JI.stroke(yI)},mI=new WeakSet,NI=function(SI){bI(this,gI,U).call(this,SI.offsetX,SI.offsetY),this.canvas.removeEventListener("pointerleave",R(this,T)),this.canvas.removeEventListener("pointermove",R(this,z)),this.parent.addToAnnotationStorage(this)},BI=new WeakSet,J=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",PI._l10nPromise.get("editor_ink_canvas_aria_label").then(SI=>{var JI;return(JI=this.canvas)==null?void 0:JI.setAttribute("aria-label",SI)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},e=new WeakSet,w=function(){XI(this,m,new ResizeObserver(SI=>{const JI=SI[0].contentRect;JI.width&&JI.height&&this.setDimensions(JI.width,JI.height)})),R(this,m).observe(this.div)},x=new WeakSet,E=function(){if(!R(this,j))return;const[SI,JI]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*SI),this.canvas.height=Math.ceil(this.height*JI),bI(this,aI,eI).call(this)},P=new WeakSet,iI=function(SI,JI){const yI=bI(this,tI,O).call(this),HI=(SI-yI)/R(this,_),cI=(JI-yI)/R(this,M);this.scaleFactor=Math.min(HI,cI)},aI=new WeakSet,eI=function(){const SI=bI(this,tI,O).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+SI,this.translationY*this.scaleFactor+SI)},A=new WeakSet,W=function(SI){const JI=new Path2D;for(let yI=0,HI=SI.length;yI<HI;yI++){const[cI,CI,AI,KI]=SI[yI];yI===0&&JI.moveTo(...cI),JI.bezierCurveTo(CI[0],CI[1],AI[0],AI[1],KI[0],KI[1])}return JI},L=new WeakSet,S=function(SI,JI,yI,HI){const cI=[],CI=this.thickness/2;let AI,KI;for(const LI of this.paths){AI=[],KI=[];for(let rI=0,kI=LI.length;rI<kI;rI++){const[xI,_I,$I,OI]=LI[rI],gg=SI*(xI[0]+JI)+CI,Ig=HI-SI*(xI[1]+yI)-CI,Ag=SI*(_I[0]+JI)+CI,qI=HI-SI*(_I[1]+yI)-CI,lg=SI*($I[0]+JI)+CI,ig=HI-SI*($I[1]+yI)-CI,og=SI*(OI[0]+JI)+CI,Zg=HI-SI*(OI[1]+yI)-CI;rI===0&&(AI.push(gg,Ig),KI.push(gg,Ig)),AI.push(Ag,qI,lg,ig,og,Zg),bI(this,Q,lI).call(this,gg,Ig,Ag,qI,lg,ig,og,Zg,4,KI)}cI.push({bezier:AI,points:KI})}return cI},Q=new WeakSet,lI=function(SI,JI,yI,HI,cI,CI,AI,KI,LI,rI){if(bI(this,uI,MI).call(this,SI,JI,yI,HI,cI,CI,AI,KI)){rI.push(AI,KI);return}for(let kI=1;kI<LI-1;kI++){const xI=kI/LI,_I=1-xI;let $I=xI*SI+_I*yI,OI=xI*JI+_I*HI,gg=xI*yI+_I*cI,Ig=xI*HI+_I*CI;const Ag=xI*cI+_I*AI,qI=xI*CI+_I*KI;$I=xI*$I+_I*gg,OI=xI*OI+_I*Ig,gg=xI*gg+_I*Ag,Ig=xI*Ig+_I*qI,$I=xI*$I+_I*gg,OI=xI*OI+_I*Ig,rI.push($I,OI)}rI.push(AI,KI)},uI=new WeakSet,MI=function(SI,JI,yI,HI,cI,CI,AI,KI){const LI=(3*yI-2*SI-AI)**2,rI=(3*HI-2*JI-KI)**2,kI=(3*cI-SI-2*AI)**2,xI=(3*CI-JI-2*KI)**2;return Math.max(LI,kI)+Math.max(rI,xI)<=10},ZI=new WeakSet,WI=function(){let SI=1/0,JI=-1/0,yI=1/0,HI=-1/0;for(const cI of this.paths)for(const[CI,AI,KI,LI]of cI){const rI=DI.Util.bezierBoundingBox(...CI,...AI,...KI,...LI);SI=Math.min(SI,rI[0]),yI=Math.min(yI,rI[1]),JI=Math.max(JI,rI[2]),HI=Math.max(HI,rI[3])}return[SI,yI,JI,HI]},tI=new WeakSet,O=function(){return R(this,p)?Math.ceil(this.thickness*this.parent.scaleFactor):0},f=new WeakSet,v=function(SI=!1){if(this.isEmpty())return;if(!R(this,p)){bI(this,II,q).call(this);return}const JI=bI(this,ZI,WI).call(this),yI=bI(this,tI,O).call(this);XI(this,_,Math.max(fI,JI[2]-JI[0])),XI(this,M,Math.max(fI,JI[3]-JI[1]));const HI=Math.ceil(yI+R(this,_)*this.scaleFactor),cI=Math.ceil(yI+R(this,M)*this.scaleFactor),[CI,AI]=this.parent.viewportBaseDimensions;this.width=HI/CI,this.height=cI/AI,XI(this,h,HI/cI),bI(this,RI,pI).call(this);const KI=this.translationX,LI=this.translationY;this.translationX=-JI[0],this.translationY=-JI[1],bI(this,x,E).call(this),bI(this,II,q).call(this),XI(this,d,HI),XI(this,C,cI),this.setDims(HI,cI);const rI=SI?yI/this.scaleFactor/2:0;this.translate(KI-this.translationX-rI,LI-this.translationY-rI)},RI=new WeakSet,pI=function(){const{style:SI}=this.div;R(this,h)>=1?(SI.minHeight=`${fI}px`,SI.minWidth=`${Math.round(R(this,h)*fI)}px`):(SI.minWidth=`${fI}px`,SI.minHeight=`${Math.round(fI/R(this,h))}px`)},GI(EI,A),QI(EI,"_defaultColor",null),QI(EI,"_defaultOpacity",1),QI(EI,"_defaultThickness",1),QI(EI,"_l10nPromise"),QI(EI,"_type","ink"),c.InkEditor=EI},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.fitCurve=void 0;const h=$(26);c.fitCurve=h},wI=>{function c(d,C,l){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(i=>{if(!Array.isArray(i)||i.some(I=>typeof I!="number")||i.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),d=d.filter((i,I)=>I===0||!i.every((g,o)=>g===d[I-1][o])),d.length<2)return[];const B=d.length,Y=j(d[1],d[0]),a=j(d[B-2],d[B-1]);return $(d,Y,a,C,l)}function $(d,C,l,B,Y){var a,i,I,g,o,X,b,N,F,hI,YI,nI,gI;if(d.length===2)return nI=D.vectorLen(D.subtract(d[0],d[1]))/3,a=[d[0],D.addArrays(d[0],D.mulItems(C,nI)),D.addArrays(d[1],D.mulItems(l,nI)),d[1]],[a];if(i=T(d),[a,g,X]=h(d,i,i,C,l,Y),g===0||g<B)return[a];if(g<B*B)for(I=i,o=g,b=X,gI=0;gI<20;gI++){if(I=_(a,d,I),[a,g,X]=h(d,i,I,C,l,Y),g<B)return[a];if(X===b){let U=g/o;if(U>.9999&&U<1.0001)break}o=g,b=X}return YI=[],N=D.subtract(d[X-1],d[X+1]),N.every(U=>U===0)&&(N=D.subtract(d[X-1],d[X]),[N[0],N[1]]=[-N[1],N[0]]),F=D.normalize(N),hI=D.mulItems(F,-1),YI=YI.concat($(d.slice(0,X+1),C,F,B,Y)),YI=YI.concat($(d.slice(X),hI,l,B,Y)),YI}function h(d,C,l,B,Y,a){var i,I,g;return i=M(d,l,B,Y),[I,g]=r(d,i,C),a&&a({bez:i,points:d,params:C,maxErr:I,maxPoint:g}),[i,I,g]}function M(d,C,l,B){var Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI=d[0],NI=d[d.length-1];for(Y=[mI,null,null,NI],a=D.zeros_Xx2x2(C.length),nI=0,gI=C.length;nI<gI;nI++)II=C[nI],q=1-II,i=a[nI],i[0]=D.mulItems(l,3*II*(q*q)),i[1]=D.mulItems(B,3*q*(II*II));for(I=[[0,0],[0,0]],g=[0,0],nI=0,gI=d.length;nI<gI;nI++)II=C[nI],i=a[nI],I[0][0]+=D.dot(i[0],i[0]),I[0][1]+=D.dot(i[0],i[1]),I[1][0]+=D.dot(i[0],i[1]),I[1][1]+=D.dot(i[1],i[1]),U=D.subtract(d[nI],m.q([mI,mI,NI,NI],II)),g[0]+=D.dot(i[0],U),g[1]+=D.dot(i[1],U);return o=I[0][0]*I[1][1]-I[1][0]*I[0][1],X=I[0][0]*g[1]-I[1][0]*g[0],b=g[0]*I[1][1]-g[1]*I[0][1],N=o===0?0:b/o,F=o===0?0:X/o,YI=D.vectorLen(D.subtract(mI,NI)),hI=1e-6*YI,N<hI||F<hI?(Y[1]=D.addArrays(mI,D.mulItems(l,YI/3)),Y[2]=D.addArrays(NI,D.mulItems(B,YI/3))):(Y[1]=D.addArrays(mI,D.mulItems(l,N)),Y[2]=D.addArrays(NI,D.mulItems(B,F))),Y}function _(d,C,l){return l.map((B,Y)=>z(d,C[Y],B))}function z(d,C,l){var B=D.subtract(m.q(d,l),C),Y=m.qprime(d,l),a=D.mulMatrix(B,Y),i=D.sum(D.squareItems(Y))+2*D.mulMatrix(B,m.qprimeprime(d,l));return i===0?l:l-a/i}function T(d){var C=[],l,B,Y;return d.forEach((a,i)=>{l=i?B+D.vectorLen(D.subtract(a,Y)):0,C.push(l),B=l,Y=a}),C=C.map(a=>a/B),C}function r(d,C,l){var B,Y,a,i,I,g,o,X;Y=0,a=Math.floor(d.length/2);const b=Z(C,10);for(I=0,g=d.length;I<g;I++)o=d[I],X=p(C,l[I],b,10),i=D.subtract(m.q(C,X),o),B=i[0]*i[0]+i[1]*i[1],B>Y&&(Y=B,a=I);return[Y,a]}var Z=function(d,C){for(var l,B=[0],Y=d[0],a=0,i=1;i<=C;i++)l=m.q(d,i/C),a+=D.vectorLen(D.subtract(l,Y)),B.push(a),Y=l;return B=B.map(I=>I/a),B};function p(d,C,l,B){if(C<0)return 0;if(C>1)return 1;for(var Y,a,i,I,g,o=1;o<=B;o++)if(C<=l[o]){I=(o-1)/B,i=o/B,a=l[o-1],Y=l[o],g=(C-a)/(Y-a)*(i-I)+I;break}return g}function j(d,C){return D.normalize(D.subtract(d,C))}class D{static zeros_Xx2x2(C){for(var l=[];C--;)l.push([0,0]);return l}static mulItems(C,l){return C.map(B=>B*l)}static mulMatrix(C,l){return C.reduce((B,Y,a)=>B+Y*l[a],0)}static subtract(C,l){return C.map((B,Y)=>B-l[Y])}static addArrays(C,l){return C.map((B,Y)=>B+l[Y])}static addItems(C,l){return C.map(B=>B+l)}static sum(C){return C.reduce((l,B)=>l+B)}static dot(C,l){return D.mulMatrix(C,l)}static vectorLen(C){return Math.hypot(...C)}static divItems(C,l){return C.map(B=>B/l)}static squareItems(C){return C.map(l=>l*l)}static normalize(C){return this.divItems(C,this.vectorLen(C))}}class m{static q(C,l){var B=1-l,Y=D.mulItems(C[0],B*B*B),a=D.mulItems(C[1],3*B*B*l),i=D.mulItems(C[2],3*B*l*l),I=D.mulItems(C[3],l*l*l);return D.addArrays(D.addArrays(Y,a),D.addArrays(i,I))}static qprime(C,l){var B=1-l,Y=D.mulItems(D.subtract(C[1],C[0]),3*B*B),a=D.mulItems(D.subtract(C[2],C[1]),6*B*l),i=D.mulItems(D.subtract(C[3],C[2]),3*l*l);return D.addArrays(D.addArrays(Y,a),i)}static qprimeprime(C,l){return D.addArrays(D.mulItems(D.addArrays(D.subtract(C[2],D.mulItems(C[1],2)),C[0]),6*(1-l)),D.mulItems(D.addArrays(D.subtract(C[3],D.mulItems(C[2],2)),C[1]),6*l))}}wI.exports=c,wI.exports.fitCubic=$,wI.exports.createTangent=j},(wI,c,$)=>{var h,M,_,z,T,r;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationLayer=void 0;var Z=$(1),p=$(8),j=$(5),D=$(28),m=$(29);const d=1e3,C=9,l=new WeakSet;function B(eI){return{width:eI[2]-eI[0],height:eI[3]-eI[1]}}class Y{static create(A){switch(A.data.annotationType){case Z.AnnotationType.LINK:return new i(A);case Z.AnnotationType.TEXT:return new I(A);case Z.AnnotationType.WIDGET:switch(A.data.fieldType){case"Tx":return new o(A);case"Btn":return A.data.radioButton?new b(A):A.data.checkBox?new X(A):new N(A);case"Ch":return new F(A)}return new g(A);case Z.AnnotationType.POPUP:return new hI(A);case Z.AnnotationType.FREETEXT:return new nI(A);case Z.AnnotationType.LINE:return new gI(A);case Z.AnnotationType.SQUARE:return new U(A);case Z.AnnotationType.CIRCLE:return new II(A);case Z.AnnotationType.POLYLINE:return new q(A);case Z.AnnotationType.CARET:return new NI(A);case Z.AnnotationType.INK:return new BI(A);case Z.AnnotationType.POLYGON:return new mI(A);case Z.AnnotationType.HIGHLIGHT:return new J(A);case Z.AnnotationType.UNDERLINE:return new e(A);case Z.AnnotationType.SQUIGGLY:return new w(A);case Z.AnnotationType.STRIKEOUT:return new x(A);case Z.AnnotationType.STAMP:return new E(A);case Z.AnnotationType.FILEATTACHMENT:return new P(A);default:return new a(A)}}}class a{constructor(A,{isRenderable:W=!1,ignoreBorder:L=!1,createQuadrilaterals:S=!1}={}){this.isRenderable=W,this.data=A.data,this.layer=A.layer,this.page=A.page,this.viewport=A.viewport,this.linkService=A.linkService,this.downloadManager=A.downloadManager,this.imageResourcesPath=A.imageResourcesPath,this.renderForms=A.renderForms,this.svgFactory=A.svgFactory,this.annotationStorage=A.annotationStorage,this.enableScripting=A.enableScripting,this.hasJSActions=A.hasJSActions,this._fieldObjects=A.fieldObjects,this._mouseState=A.mouseState,W&&(this.container=this._createContainer(L)),S&&(this.quadrilaterals=this._createQuadrilaterals(L))}_createContainer(A=!1){const W=this.data,L=this.page,S=this.viewport,Q=document.createElement("section"),{width:lI,height:uI}=B(W.rect),[MI,ZI,WI,tI]=S.viewBox,O=WI-MI,f=tI-ZI;Q.setAttribute("data-annotation-id",W.id);const v=Z.Util.normalizeRect([W.rect[0],L.view[3]-W.rect[1]+L.view[1],W.rect[2],L.view[3]-W.rect[3]+L.view[1]]);if(!A&&W.borderStyle.width>0){Q.style.borderWidth=`${W.borderStyle.width}px`;const pI=W.borderStyle.horizontalCornerRadius,DI=W.borderStyle.verticalCornerRadius;if(pI>0||DI>0){const TI=`calc(${pI}px * var(--scale-factor)) / calc(${DI}px * var(--scale-factor))`;Q.style.borderRadius=TI}else if(this instanceof b){const TI=`calc(${lI}px * var(--scale-factor)) / calc(${uI}px * var(--scale-factor))`;Q.style.borderRadius=TI}switch(W.borderStyle.style){case Z.AnnotationBorderStyleType.SOLID:Q.style.borderStyle="solid";break;case Z.AnnotationBorderStyleType.DASHED:Q.style.borderStyle="dashed";break;case Z.AnnotationBorderStyleType.BEVELED:(0,Z.warn)("Unimplemented border style: beveled");break;case Z.AnnotationBorderStyleType.INSET:(0,Z.warn)("Unimplemented border style: inset");break;case Z.AnnotationBorderStyleType.UNDERLINE:Q.style.borderBottomStyle="solid";break}const FI=W.borderColor||null;FI?Q.style.borderColor=Z.Util.makeHexColor(FI[0]|0,FI[1]|0,FI[2]|0):Q.style.borderWidth=0}Q.style.left=`${100*(v[0]-MI)/O}%`,Q.style.top=`${100*(v[1]-ZI)/f}%`;const{rotation:RI}=W;return W.hasOwnCanvas||RI===0?(Q.style.width=`${100*lI/O}%`,Q.style.height=`${100*uI/f}%`):this.setRotation(RI,Q),Q}setRotation(A,W=this.container){const[L,S,Q,lI]=this.viewport.viewBox,uI=Q-L,MI=lI-S,{width:ZI,height:WI}=B(this.data.rect);let tI,O;A%180===0?(tI=100*ZI/uI,O=100*WI/MI):(tI=100*WI/uI,O=100*ZI/MI),W.style.width=`${tI}%`,W.style.height=`${O}%`,W.setAttribute("data-main-rotation",(360-A)%360)}get _commonActions(){const A=(W,L,S)=>{const Q=S.detail[W];S.target.style[L]=D.ColorConverters[`${Q[0]}_HTML`](Q.slice(1))};return(0,Z.shadow)(this,"_commonActions",{display:W=>{const L=W.detail.display%2===1;this.container.style.visibility=L?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:L,print:W.detail.display===0||W.detail.display===3})},print:W=>{this.annotationStorage.setValue(this.data.id,{print:W.detail.print})},hidden:W=>{this.container.style.visibility=W.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:W.detail.hidden})},focus:W=>{setTimeout(()=>W.target.focus({preventScroll:!1}),0)},userName:W=>{W.target.title=W.detail.userName},readonly:W=>{W.detail.readonly?W.target.setAttribute("readonly",""):W.target.removeAttribute("readonly")},required:W=>{this._setRequired(W.target,W.detail.required)},bgColor:W=>{A("bgColor","backgroundColor",W)},fillColor:W=>{A("fillColor","backgroundColor",W)},fgColor:W=>{A("fgColor","color",W)},textColor:W=>{A("textColor","color",W)},borderColor:W=>{A("borderColor","borderColor",W)},strokeColor:W=>{A("strokeColor","borderColor",W)},rotation:W=>{const L=W.detail.rotation;this.setRotation(L),this.annotationStorage.setValue(this.data.id,{rotation:L})}})}_dispatchEventFromSandbox(A,W){const L=this._commonActions;for(const S of Object.keys(W.detail)){const Q=A[S]||L[S];Q&&Q(W)}}_setDefaultPropertiesFromJS(A){if(!this.enableScripting)return;const W=this.annotationStorage.getRawValue(this.data.id);if(!W)return;const L=this._commonActions;for(const[S,Q]of Object.entries(W)){const lI=L[S];if(lI){const uI={detail:{[S]:Q},target:A};lI(uI),delete W[S]}}}_createQuadrilaterals(A=!1){if(!this.data.quadPoints)return null;const W=[],L=this.data.rect;for(const S of this.data.quadPoints)this.data.rect=[S[2].x,S[2].y,S[1].x,S[1].y],W.push(this._createContainer(A));return this.data.rect=L,W}_createPopup(A,W){let L=this.container;this.quadrilaterals&&(A=A||this.quadrilaterals,L=this.quadrilaterals[0]),A||(A=document.createElement("div"),A.className="popupTriggerArea",L.append(A));const S=new YI({container:L,trigger:A,color:W.color,titleObj:W.titleObj,modificationDate:W.modificationDate,contentsObj:W.contentsObj,richText:W.richText,hideWrapper:!0}).render();S.style.left="100%",L.append(S)}_renderQuadrilaterals(A){for(const W of this.quadrilaterals)W.className=A;return this.quadrilaterals}render(){(0,Z.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(A,W=null){const L=[];if(this._fieldObjects){const S=this._fieldObjects[A];if(S)for(const{page:Q,id:lI,exportValues:uI}of S){if(Q===-1||lI===W)continue;const MI=typeof uI=="string"?uI:null,ZI=document.querySelector(`[data-element-id="${lI}"]`);if(ZI&&!l.has(ZI)){(0,Z.warn)(`_getElementsByName - element not allowed: ${lI}`);continue}L.push({id:lI,exportValue:MI,domElement:ZI})}return L}for(const S of document.getElementsByName(A)){const{id:Q,exportValue:lI}=S;Q!==W&&l.has(S)&&L.push({id:Q,exportValue:lI,domElement:S})}return L}static get platform(){const A=typeof navigator<"u"?navigator.platform:"";return(0,Z.shadow)(this,"platform",{isWin:A.includes("Win"),isMac:A.includes("Mac")})}}class i extends a{constructor(A,W=null){super(A,{isRenderable:!0,ignoreBorder:!!(W!=null&&W.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=A.data.isTooltipOnly}render(){const{data:A,linkService:W}=this,L=document.createElement("a");L.setAttribute("data-element-id",A.id);let S=!1;return A.url?(W.addLinkAttributes(L,A.url,A.newWindow),S=!0):A.action?(this._bindNamedAction(L,A.action),S=!0):A.dest?(this._bindLink(L,A.dest),S=!0):(A.actions&&(A.actions.Action||A.actions["Mouse Up"]||A.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(L,A),S=!0),A.resetForm?(this._bindResetFormAction(L,A.resetForm),S=!0):this.isTooltipOnly&&!S&&(this._bindLink(L,""),S=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((Q,lI)=>{const uI=lI===0?L:L.cloneNode();return Q.append(uI),Q}):(this.container.className="linkAnnotation",S&&this.container.append(L),this.container)}_bindLink(A,W){A.href=this.linkService.getDestinationHash(W),A.onclick=()=>(W&&this.linkService.goToDestination(W),!1),(W||W==="")&&(A.className="internalLink")}_bindNamedAction(A,W){A.href=this.linkService.getAnchorUrl(""),A.onclick=()=>(this.linkService.executeNamedAction(W),!1),A.className="internalLink"}_bindJSAction(A,W){A.href=this.linkService.getAnchorUrl("");const L=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const S of Object.keys(W.actions)){const Q=L.get(S);Q&&(A[Q]=()=>{var lI;return(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W.id,name:S}}),!1})}A.onclick||(A.onclick=()=>!1),A.className="internalLink"}_bindResetFormAction(A,W){const L=A.onclick;if(L||(A.href=this.linkService.getAnchorUrl("")),A.className="internalLink",!this._fieldObjects){(0,Z.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),L||(A.onclick=()=>!1);return}A.onclick=()=>{var S;L&&L();const{fields:Q,refs:lI,include:uI}=W,MI=[];if(Q.length!==0||lI.length!==0){const tI=new Set(lI);for(const O of Q){const f=this._fieldObjects[O]||[];for(const{id:v}of f)tI.add(v)}for(const O of Object.values(this._fieldObjects))for(const f of O)tI.has(f.id)===uI&&MI.push(f)}else for(const tI of Object.values(this._fieldObjects))MI.push(...tI);const ZI=this.annotationStorage,WI=[];for(const tI of MI){const{id:O}=tI;switch(WI.push(O),tI.type){case"text":{const v=tI.defaultValue||"";ZI.setValue(O,{value:v});break}case"checkbox":case"radiobutton":{const v=tI.defaultValue===tI.exportValues;ZI.setValue(O,{value:v});break}case"combobox":case"listbox":{const v=tI.defaultValue||"";ZI.setValue(O,{value:v});break}default:continue}const f=document.querySelector(`[data-element-id="${O}"]`);if(f){if(!l.has(f)){(0,Z.warn)(`_bindResetFormAction - element not allowed: ${O}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:WI,name:"ResetForm"}})),!1}}}class I extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q})}render(){this.container.className="textAnnotation";const A=document.createElement("img");return A.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",A.alt="[{{type}} Annotation]",A.dataset.l10nId="text_annotation_type",A.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(A,this.data),this.container.append(A),this.container}}class g extends a{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(A){const{isWin:W,isMac:L}=a.platform;return W&&A.ctrlKey||L&&A.metaKey}_setEventListener(A,W,L,S){W.includes("mouse")?A.addEventListener(W,Q=>{var lI;(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:L,value:S(Q),shift:Q.shiftKey,modifier:this._getKeyModifier(Q)}})}):A.addEventListener(W,Q=>{var lI;(lI=this.linkService.eventBus)==null||lI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:L,value:S(Q)}})})}_setEventListeners(A,W,L){var S;for(const[Q,lI]of W)(lI==="Action"||(S=this.data.actions)!=null&&S[lI])&&this._setEventListener(A,Q,lI,L)}_setBackgroundColor(A){const W=this.data.backgroundColor||null;A.style.backgroundColor=W===null?"transparent":Z.Util.makeHexColor(W[0],W[1],W[2])}_setTextStyle(A){const W=["left","center","right"],{fontColor:L}=this.data.defaultAppearanceData,S=this.data.defaultAppearanceData.fontSize||C,Q=A.style;let lI;if(this.data.multiLine){const uI=Math.abs(this.data.rect[3]-this.data.rect[1]),MI=Math.round(uI/(Z.LINE_FACTOR*S))||1,ZI=uI/MI;lI=Math.min(S,Math.round(ZI/Z.LINE_FACTOR))}else{const uI=Math.abs(this.data.rect[3]-this.data.rect[1]);lI=Math.min(S,Math.round(uI/Z.LINE_FACTOR))}Q.fontSize=`calc(${lI}px * var(--scale-factor))`,Q.color=Z.Util.makeHexColor(L[0],L[1],L[2]),this.data.textAlignment!==null&&(Q.textAlign=W[this.data.textAlignment])}_setRequired(A,W){W?A.setAttribute("required",!0):A.removeAttribute("required"),A.setAttribute("aria-required",W)}}class o extends g{constructor(A){const W=A.renderForms||!A.data.hasAppearance&&!!A.data.fieldValue;super(A,{isRenderable:W})}setPropertyOnSiblings(A,W,L,S){const Q=this.annotationStorage;for(const lI of this._getElementsByName(A.name,A.id))lI.domElement&&(lI.domElement[W]=L),Q.setValue(lI.id,{[S]:L})}render(){var A;const W=this.annotationStorage,L=this.data.id;this.container.className="textWidgetAnnotation";let S=null;if(this.renderForms){const Q=W.getValue(L,{value:this.data.fieldValue});let lI=Q.formattedValue||Q.value||"";const uI=W.getValue(L,{charLimit:this.data.maxLen}).charLimit;uI&&lI.length>uI&&(lI=lI.slice(0,uI));const MI={userValue:lI,formattedValue:null,valueOnFocus:""};this.data.multiLine?(S=document.createElement("textarea"),S.textContent=lI,this.data.doNotScroll&&(S.style.overflowY="hidden")):(S=document.createElement("input"),S.type="text",S.setAttribute("value",lI),this.data.doNotScroll&&(S.style.overflowX="hidden")),l.add(S),S.setAttribute("data-element-id",L),S.disabled=this.data.readOnly,S.name=this.data.fieldName,S.tabIndex=d,this._setRequired(S,this.data.required),uI&&(S.maxLength=uI),S.addEventListener("input",WI=>{W.setValue(L,{value:WI.target.value}),this.setPropertyOnSiblings(S,"value",WI.target.value,"value")}),S.addEventListener("resetform",WI=>{const tI=this.data.defaultFieldValue??"";S.value=MI.userValue=tI,MI.formattedValue=null});let ZI=WI=>{const{formattedValue:tI}=MI;tI!=null&&(WI.target.value=tI),WI.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){S.addEventListener("focus",tI=>{MI.userValue&&(tI.target.value=MI.userValue),MI.valueOnFocus=tI.target.value}),S.addEventListener("updatefromsandbox",tI=>{const O={value(f){MI.userValue=f.detail.value??"",W.setValue(L,{value:MI.userValue.toString()}),f.target.value=MI.userValue},formattedValue(f){const{formattedValue:v}=f.detail;MI.formattedValue=v,v!=null&&f.target!==document.activeElement&&(f.target.value=v),W.setValue(L,{formattedValue:v})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{var v;const{charLimit:RI}=f.detail,{target:pI}=f;if(RI===0){pI.removeAttribute("maxLength");return}pI.setAttribute("maxLength",RI);let DI=MI.userValue;!DI||DI.length<=RI||(DI=DI.slice(0,RI),pI.value=MI.userValue=DI,W.setValue(L,{value:DI}),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:L,name:"Keystroke",value:DI,willCommit:!0,commitKey:1,selStart:pI.selectionStart,selEnd:pI.selectionEnd}}))}};this._dispatchEventFromSandbox(O,tI)}),S.addEventListener("keydown",tI=>{var O;let f=-1;if(tI.key==="Escape"?f=0:tI.key==="Enter"?f=2:tI.key==="Tab"&&(f=3),f===-1)return;const{value:v}=tI.target;MI.valueOnFocus!==v&&(MI.userValue=v,(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:L,name:"Keystroke",value:v,willCommit:!0,commitKey:f,selStart:tI.target.selectionStart,selEnd:tI.target.selectionEnd}}))});const WI=ZI;ZI=null,S.addEventListener("blur",tI=>{var O;const{value:f}=tI.target;MI.userValue=f,this._mouseState.isDown&&MI.valueOnFocus!==f&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:L,name:"Keystroke",value:f,willCommit:!0,commitKey:1,selStart:tI.target.selectionStart,selEnd:tI.target.selectionEnd}})),WI(tI)}),(A=this.data.actions)!=null&&A.Keystroke&&S.addEventListener("beforeinput",tI=>{var O;const{data:f,target:v}=tI,{value:RI,selectionStart:pI,selectionEnd:DI}=v;let FI=pI,TI=DI;switch(tI.inputType){case"deleteWordBackward":{const vI=RI.substring(0,pI).match(/\w*[^\w]*$/);vI&&(FI-=vI[0].length);break}case"deleteWordForward":{const vI=RI.substring(pI).match(/^[^\w]*\w*/);vI&&(TI+=vI[0].length);break}case"deleteContentBackward":pI===DI&&(FI-=1);break;case"deleteContentForward":pI===DI&&(TI+=1);break}tI.preventDefault(),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:L,name:"Keystroke",value:RI,change:f||"",willCommit:!1,selStart:FI,selEnd:TI}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],tI=>tI.target.value)}if(ZI&&S.addEventListener("blur",ZI),this.data.comb){const WI=(this.data.rect[2]-this.data.rect[0])/uI;S.classList.add("comb"),S.style.letterSpacing=`calc(${WI}px * var(--scale-factor) - 1ch)`}}else S=document.createElement("div"),S.textContent=this.data.fieldValue,S.style.verticalAlign="middle",S.style.display="table-cell";return this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class X extends g{constructor(A){super(A,{isRenderable:A.renderForms})}render(){const A=this.annotationStorage,W=this.data,L=W.id;let S=A.getValue(L,{value:W.exportValue===W.fieldValue}).value;typeof S=="string"&&(S=S!=="Off",A.setValue(L,{value:S})),this.container.className="buttonWidgetAnnotation checkBox";const Q=document.createElement("input");return l.add(Q),Q.setAttribute("data-element-id",L),Q.disabled=W.readOnly,this._setRequired(Q,this.data.required),Q.type="checkbox",Q.name=W.fieldName,S&&Q.setAttribute("checked",!0),Q.setAttribute("exportValue",W.exportValue),Q.tabIndex=d,Q.addEventListener("change",lI=>{const{name:uI,checked:MI}=lI.target;for(const ZI of this._getElementsByName(uI,L)){const WI=MI&&ZI.exportValue===W.exportValue;ZI.domElement&&(ZI.domElement.checked=WI),A.setValue(ZI.id,{value:WI})}A.setValue(L,{value:MI})}),Q.addEventListener("resetform",lI=>{const uI=W.defaultFieldValue||"Off";lI.target.checked=uI===W.exportValue}),this.enableScripting&&this.hasJSActions&&(Q.addEventListener("updatefromsandbox",lI=>{const uI={value(MI){MI.target.checked=MI.detail.value!=="Off",A.setValue(L,{value:MI.target.checked})}};this._dispatchEventFromSandbox(uI,lI)}),this._setEventListeners(Q,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],lI=>lI.target.checked)),this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class b extends g{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const A=this.annotationStorage,W=this.data,L=W.id;let S=A.getValue(L,{value:W.fieldValue===W.buttonValue}).value;typeof S=="string"&&(S=S!==W.buttonValue,A.setValue(L,{value:S}));const Q=document.createElement("input");if(l.add(Q),Q.setAttribute("data-element-id",L),Q.disabled=W.readOnly,this._setRequired(Q,this.data.required),Q.type="radio",Q.name=W.fieldName,S&&Q.setAttribute("checked",!0),Q.tabIndex=d,Q.addEventListener("change",lI=>{const{name:uI,checked:MI}=lI.target;for(const ZI of this._getElementsByName(uI,L))A.setValue(ZI.id,{value:!1});A.setValue(L,{value:MI})}),Q.addEventListener("resetform",lI=>{const uI=W.defaultFieldValue;lI.target.checked=uI!=null&&uI===W.buttonValue}),this.enableScripting&&this.hasJSActions){const lI=W.buttonValue;Q.addEventListener("updatefromsandbox",uI=>{const MI={value:ZI=>{const WI=lI===ZI.detail.value;for(const tI of this._getElementsByName(ZI.target.name)){const O=WI&&tI.id===L;tI.domElement&&(tI.domElement.checked=O),A.setValue(tI.id,{value:O})}}};this._dispatchEventFromSandbox(MI,uI)}),this._setEventListeners(Q,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],uI=>uI.target.checked)}return this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class N extends i{constructor(A){super(A,{ignoreBorder:A.data.hasAppearance})}render(){const A=super.render();A.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(A.title=this.data.alternativeText);const W=A.lastChild;return this.enableScripting&&this.hasJSActions&&W&&(this._setDefaultPropertiesFromJS(W),W.addEventListener("updatefromsandbox",L=>{this._dispatchEventFromSandbox({},L)})),A}}class F extends g{constructor(A){super(A,{isRenderable:A.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const A=this.annotationStorage,W=this.data.id,L=A.getValue(W,{value:this.data.fieldValue}),S=document.createElement("select");l.add(S),S.setAttribute("data-element-id",W),S.disabled=this.data.readOnly,this._setRequired(S,this.data.required),S.name=this.data.fieldName,S.tabIndex=d;let Q=this.data.combo&&this.data.options.length>0;this.data.combo||(S.size=this.data.options.length,this.data.multiSelect&&(S.multiple=!0)),S.addEventListener("resetform",ZI=>{const WI=this.data.defaultFieldValue;for(const tI of S.options)tI.selected=tI.value===WI});for(const ZI of this.data.options){const WI=document.createElement("option");WI.textContent=ZI.displayValue,WI.value=ZI.exportValue,L.value.includes(ZI.exportValue)&&(WI.setAttribute("selected",!0),Q=!1),S.append(WI)}let lI=null;if(Q){const ZI=document.createElement("option");ZI.value=" ",ZI.setAttribute("hidden",!0),ZI.setAttribute("selected",!0),S.prepend(ZI),lI=()=>{ZI.remove(),S.removeEventListener("input",lI),lI=null},S.addEventListener("input",lI)}const uI=(ZI,WI)=>{const tI=WI?"value":"textContent",O=ZI.target.options;return ZI.target.multiple?Array.prototype.filter.call(O,f=>f.selected).map(f=>f[tI]):O.selectedIndex===-1?null:O[O.selectedIndex][tI]},MI=ZI=>{const WI=ZI.target.options;return Array.prototype.map.call(WI,tI=>({displayValue:tI.textContent,exportValue:tI.value}))};return this.enableScripting&&this.hasJSActions?(S.addEventListener("updatefromsandbox",ZI=>{const WI={value(tI){lI==null||lI();const O=tI.detail.value,f=new Set(Array.isArray(O)?O:[O]);for(const v of S.options)v.selected=f.has(v.value);A.setValue(W,{value:uI(tI,!0)})},multipleSelection(tI){S.multiple=!0},remove(tI){const O=S.options,f=tI.detail.remove;O[f].selected=!1,S.remove(f),O.length>0&&Array.prototype.findIndex.call(O,v=>v.selected)===-1&&(O[0].selected=!0),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},clear(tI){for(;S.length!==0;)S.remove(0);A.setValue(W,{value:null,items:[]})},insert(tI){const{index:O,displayValue:f,exportValue:v}=tI.detail.insert,RI=S.children[O],pI=document.createElement("option");pI.textContent=f,pI.value=v,RI?RI.before(pI):S.append(pI),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},items(tI){const{items:O}=tI.detail;for(;S.length!==0;)S.remove(0);for(const f of O){const{displayValue:v,exportValue:RI}=f,pI=document.createElement("option");pI.textContent=v,pI.value=RI,S.append(pI)}S.options.length>0&&(S.options[0].selected=!0),A.setValue(W,{value:uI(tI,!0),items:MI(tI)})},indices(tI){const O=new Set(tI.detail.indices);for(const f of tI.target.options)f.selected=O.has(f.index);A.setValue(W,{value:uI(tI,!0)})},editable(tI){tI.target.disabled=!tI.detail.editable}};this._dispatchEventFromSandbox(WI,ZI)}),S.addEventListener("input",ZI=>{var WI;const tI=uI(ZI,!0),O=uI(ZI,!1);A.setValue(W,{value:tI}),(WI=this.linkService.eventBus)==null||WI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:W,name:"Keystroke",value:O,changeEx:tI,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],ZI=>ZI.target.checked)):S.addEventListener("input",function(ZI){A.setValue(W,{value:uI(ZI,!0)})}),this.data.combo&&this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class hI extends a{constructor(A){var W,L,S;const Q=!!((W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q})}render(){const A=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",A.includes(this.data.parentType))return this.container;const W=`[data-annotation-id="${this.data.parentId}"]`,L=this.layer.querySelectorAll(W);if(L.length===0)return this.container;const S=new YI({container:this.container,trigger:Array.from(L),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Q=this.page,lI=Z.Util.normalizeRect([this.data.parentRect[0],Q.view[3]-this.data.parentRect[1]+Q.view[1],this.data.parentRect[2],Q.view[3]-this.data.parentRect[3]+Q.view[1]]),uI=lI[0]+this.data.parentRect[2]-this.data.parentRect[0],MI=lI[1],[ZI,WI,tI,O]=this.viewport.viewBox,f=tI-ZI,v=O-WI;return this.container.style.left=`${100*(uI-ZI)/f}%`,this.container.style.top=`${100*(MI-WI)/v}%`,this.container.append(S.render()),this.container}}class YI{constructor(A){this.container=A.container,this.trigger=A.trigger,this.color=A.color,this.titleObj=A.titleObj,this.modificationDate=A.modificationDate,this.contentsObj=A.contentsObj,this.richText=A.richText,this.hideWrapper=A.hideWrapper||!1,this.pinned=!1}render(){var A,W;const L=document.createElement("div");L.className="popupWrapper",this.hideElement=this.hideWrapper?L:this.container,this.hideElement.hidden=!0;const S=document.createElement("div");S.className="popup";const Q=this.color;if(Q){const MI=.7*(255-Q[0])+Q[0],ZI=.7*(255-Q[1])+Q[1],WI=.7*(255-Q[2])+Q[2];S.style.backgroundColor=Z.Util.makeHexColor(MI|0,ZI|0,WI|0)}const lI=document.createElement("h1");lI.dir=this.titleObj.dir,lI.textContent=this.titleObj.str,S.append(lI);const uI=p.PDFDateString.toDateObject(this.modificationDate);if(uI){const MI=document.createElement("span");MI.className="popupDate",MI.textContent="{{date}}, {{time}}",MI.dataset.l10nId="annotation_date_string",MI.dataset.l10nArgs=JSON.stringify({date:uI.toLocaleDateString(),time:uI.toLocaleTimeString()}),S.append(MI)}if((A=this.richText)!=null&&A.str&&(!((W=this.contentsObj)!=null&&W.str)||this.contentsObj.str===this.richText.str))m.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:S}),S.lastChild.className="richText popupContent";else{const MI=this._formatContents(this.contentsObj);S.append(MI)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const MI of this.trigger)MI.addEventListener("click",this._toggle.bind(this)),MI.addEventListener("mouseover",this._show.bind(this,!1)),MI.addEventListener("mouseout",this._hide.bind(this,!1));return S.addEventListener("click",this._hide.bind(this,!0)),L.append(S),L}_formatContents({str:A,dir:W}){const L=document.createElement("p");L.className="popupContent",L.dir=W;const S=A.split(/(?:\r\n?|\n)/);for(let Q=0,lI=S.length;Q<lI;++Q){const uI=S[Q];L.append(document.createTextNode(uI)),Q<lI-1&&L.append(document.createElement("br"))}return L}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(A=!1){A&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(A=!0){A&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class nI extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0}),this.textContent=A.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const A=document.createElement("div");A.className="annotationTextContent",A.setAttribute("role","comment");for(const W of this.textContent){const L=document.createElement("span");L.textContent=W,A.append(L)}this.container.append(A)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class gI extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const A=this.data,{width:W,height:L}=B(A.rect),S=this.svgFactory.create(W,L,!0),Q=this.svgFactory.createElement("svg:line");return Q.setAttribute("x1",A.rect[2]-A.lineCoordinates[0]),Q.setAttribute("y1",A.rect[3]-A.lineCoordinates[1]),Q.setAttribute("x2",A.rect[2]-A.lineCoordinates[2]),Q.setAttribute("y2",A.rect[3]-A.lineCoordinates[3]),Q.setAttribute("stroke-width",A.borderStyle.width||1),Q.setAttribute("stroke","transparent"),Q.setAttribute("fill","transparent"),S.append(Q),this.container.append(S),this._createPopup(Q,A),this.container}}class U extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const A=this.data,{width:W,height:L}=B(A.rect),S=this.svgFactory.create(W,L,!0),Q=A.borderStyle.width,lI=this.svgFactory.createElement("svg:rect");return lI.setAttribute("x",Q/2),lI.setAttribute("y",Q/2),lI.setAttribute("width",W-Q),lI.setAttribute("height",L-Q),lI.setAttribute("stroke-width",Q||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class II extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const A=this.data,{width:W,height:L}=B(A.rect),S=this.svgFactory.create(W,L,!0),Q=A.borderStyle.width,lI=this.svgFactory.createElement("svg:ellipse");return lI.setAttribute("cx",W/2),lI.setAttribute("cy",L/2),lI.setAttribute("rx",W/2-Q/2),lI.setAttribute("ry",L/2-Q/2),lI.setAttribute("stroke-width",Q||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class q extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const A=this.data,{width:W,height:L}=B(A.rect),S=this.svgFactory.create(W,L,!0);let Q=[];for(const uI of A.vertices){const MI=uI.x-A.rect[0],ZI=A.rect[3]-uI.y;Q.push(MI+","+ZI)}Q=Q.join(" ");const lI=this.svgFactory.createElement(this.svgElementName);return lI.setAttribute("points",Q),lI.setAttribute("stroke-width",A.borderStyle.width||1),lI.setAttribute("stroke","transparent"),lI.setAttribute("fill","transparent"),S.append(lI),this.container.append(S),this._createPopup(lI,A),this.container}}class mI extends q{constructor(A){super(A),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class NI extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class BI extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const A=this.data,{width:W,height:L}=B(A.rect),S=this.svgFactory.create(W,L,!0);for(const Q of A.inkLists){let lI=[];for(const MI of Q){const ZI=MI.x-A.rect[0],WI=A.rect[3]-MI.y;lI.push(`${ZI},${WI}`)}lI=lI.join(" ");const uI=this.svgFactory.createElement(this.svgElementName);uI.setAttribute("points",lI),uI.setAttribute("stroke-width",A.borderStyle.width||1),uI.setAttribute("stroke","transparent"),uI.setAttribute("fill","transparent"),this._createPopup(uI,A),S.append(uI)}return this.container.append(S),this.container}}class J extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class e extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class w extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class x extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class E extends a{constructor(A){var W,L,S;const Q=!!(A.data.hasPopup||(W=A.data.titleObj)!=null&&W.str||(L=A.data.contentsObj)!=null&&L.str||(S=A.data.richText)!=null&&S.str);super(A,{isRenderable:Q,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class P extends a{constructor(A){var W;super(A,{isRenderable:!0});const{filename:L,content:S}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(L),this.content=S,(W=this.linkService.eventBus)==null||W.dispatch("fileattachmentannotation",{source:this,filename:L,content:S})}render(){var A,W;this.container.className="fileAttachmentAnnotation";const L=document.createElement("div");return L.className="popupTriggerArea",L.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((A=this.data.titleObj)!=null&&A.str||(W=this.data.contentsObj)!=null&&W.str||this.data.richText)&&this._createPopup(L,this.data),this.container.append(L),this.container}_download(){var A;(A=this.downloadManager)==null||A.openOrDownloadData(this.container,this.content,this.filename)}}const iI=class{static render(eI){var A,W;const{annotations:L,div:S,viewport:Q,accessibilityManager:lI}=eI;bI(this,_,z).call(this,S,Q);let uI=0;for(const MI of L){if(MI.annotationType!==Z.AnnotationType.POPUP){const{width:WI,height:tI}=B(MI.rect);if(WI<=0||tI<=0)continue}const ZI=Y.create({data:MI,layer:S,page:eI.page,viewport:Q,linkService:eI.linkService,downloadManager:eI.downloadManager,imageResourcesPath:eI.imageResourcesPath||"",renderForms:eI.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:eI.annotationStorage||new j.AnnotationStorage,enableScripting:eI.enableScripting,hasJSActions:eI.hasJSActions,fieldObjects:eI.fieldObjects,mouseState:eI.mouseState||{isDown:!1}});if(ZI.isRenderable){const WI=ZI.render();if(MI.hidden&&(WI.style.visibility="hidden"),Array.isArray(WI))for(const tI of WI)tI.style.zIndex=uI++,bI(A=iI,h,M).call(A,tI,MI.id,S,lI);else WI.style.zIndex=uI++,ZI instanceof hI?S.prepend(WI):bI(W=iI,h,M).call(W,WI,MI.id,S,lI)}}bI(this,T,r).call(this,S,eI.annotationCanvasMap)}static update(eI){const{annotationCanvasMap:A,div:W,viewport:L}=eI;bI(this,_,z).call(this,W,L),bI(this,T,r).call(this,W,A),W.hidden=!1}};let aI=iI;h=new WeakSet,M=function(eI,A,W,L){const S=eI.firstChild||eI;S.id=`${p.AnnotationPrefix}${A}`,W.append(eI),L==null||L.moveElementInDOM(W,eI,S,!1)},_=new WeakSet,z=function(eI,{width:A,height:W,rotation:L}){const{style:S}=eI,Q=L%180!==0,lI=Math.floor(A)+"px",uI=Math.floor(W)+"px";S.width=Q?uI:lI,S.height=Q?lI:uI,eI.setAttribute("data-main-rotation",L)},T=new WeakSet,r=function(eI,A){if(A){for(const[W,L]of A){const S=eI.querySelector(`[data-annotation-id="${W}"]`);if(!S)continue;const{firstChild:Q}=S;Q?Q.nodeName==="CANVAS"?Q.replaceWith(L):Q.before(L):S.append(L)}A.clear()}},GI(aI,h),GI(aI,_),GI(aI,T),c.AnnotationLayer=aI},(wI,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorConverters=void 0;function $(M){return Math.floor(Math.max(0,Math.min(1,M))*255).toString(16).padStart(2,"0")}class h{static CMYK_G([_,z,T,r]){return["G",1-Math.min(1,.3*_+.59*T+.11*z+r)]}static G_CMYK([_]){return["CMYK",0,0,0,1-_]}static G_RGB([_]){return["RGB",_,_,_]}static G_HTML([_]){const z=$(_);return`#${z}${z}${z}`}static RGB_G([_,z,T]){return["G",.3*_+.59*z+.11*T]}static RGB_HTML([_,z,T]){const r=$(_),Z=$(z),p=$(T);return`#${r}${Z}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([_,z,T,r]){return["RGB",1-Math.min(1,_+r),1-Math.min(1,T+r),1-Math.min(1,z+r)]}static CMYK_HTML(_){const z=this.CMYK_RGB(_).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([_,z,T]){const r=1-_,Z=1-z,p=1-T,j=Math.min(r,Z,p);return["CMYK",r,Z,p,j]}}c.ColorConverters=h},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaLayer=void 0;var h=$(20);class M{static setupStorage(z,T,r,Z,p){const j=Z.getValue(T,{value:null});switch(r.name){case"textarea":if(j.value!==null&&(z.textContent=j.value),p==="print")break;z.addEventListener("input",D=>{Z.setValue(T,{value:D.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(j.value===r.attributes.xfaOn?z.setAttribute("checked",!0):j.value===r.attributes.xfaOff&&z.removeAttribute("checked"),p==="print")break;z.addEventListener("change",D=>{Z.setValue(T,{value:D.target.checked?D.target.getAttribute("xfaOn"):D.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&z.setAttribute("value",j.value),p==="print")break;z.addEventListener("input",D=>{Z.setValue(T,{value:D.target.value})})}break;case"select":if(j.value!==null)for(const D of r.children)D.attributes.value===j.value&&(D.attributes.selected=!0);z.addEventListener("input",D=>{const m=D.target.options,d=m.selectedIndex===-1?"":m[m.selectedIndex].value;Z.setValue(T,{value:d})});break}}static setAttributes({html:z,element:T,storage:r=null,intent:Z,linkService:p}){const{attributes:j}=T,D=z instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${Z}`);for(const[m,d]of Object.entries(j))if(d!=null)switch(m){case"class":d.length&&z.setAttribute(m,d.join(" "));break;case"dataId":break;case"id":z.setAttribute("data-element-id",d);break;case"style":Object.assign(z.style,d);break;case"textContent":z.textContent=d;break;default:(!D||m!=="href"&&m!=="newWindow")&&z.setAttribute(m,d)}D&&p.addLinkAttributes(z,j.href,j.newWindow),r&&j.dataId&&this.setupStorage(z,j.dataId,T,r)}static render(z){var T;const r=z.annotationStorage,Z=z.linkService,p=z.xfaHtml,j=z.intent||"display",D=document.createElement(p.name);p.attributes&&this.setAttributes({html:D,element:p,intent:j,linkService:Z});const m=[[p,-1,D]],d=z.div;if(d.append(D),z.viewport){const l=`matrix(${z.viewport.transform.join(",")})`;d.style.transform=l}j!=="richText"&&d.setAttribute("class","xfaLayer xfaFont");const C=[];for(;m.length>0;){const[l,B,Y]=m.at(-1);if(B+1===l.children.length){m.pop();continue}const a=l.children[++m.at(-1)[1]];if(a===null)continue;const{name:i}=a;if(i==="#text"){const g=document.createTextNode(a.value);C.push(g),Y.append(g);continue}let I;if((T=a==null?void 0:a.attributes)!=null&&T.xmlns?I=document.createElementNS(a.attributes.xmlns,i):I=document.createElement(i),Y.append(I),a.attributes&&this.setAttributes({html:I,element:a,storage:r,intent:j,linkService:Z}),a.children&&a.children.length>0)m.push([a,-1,I]);else if(a.value){const g=document.createTextNode(a.value);h.XfaText.shouldBuildText(i)&&C.push(g),I.append(g)}}for(const l of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))l.setAttribute("readOnly",!0);return{textDivs:C}}static update(z){const T=`matrix(${z.viewport.transform.join(",")})`;z.div.style.transform=T,z.div.hidden=!1}}c.XfaLayer=M},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextLayerRenderTask=void 0,c.renderTextLayer=Y;var h=$(1),M=$(8);const _=1e5,z=30,T=.8,r=new Map,Z=/^\s+$/g;function p(a,i){const I=r.get(a);if(I)return I;i.save(),i.font=`${z}px ${a}`;const g=i.measureText("");let o=g.fontBoundingBoxAscent,X=Math.abs(g.fontBoundingBoxDescent);if(o){i.restore();const N=o/(o+X);return r.set(a,N),N}i.strokeStyle="red",i.clearRect(0,0,z,z),i.strokeText("g",0,0);let b=i.getImageData(0,0,z,z).data;X=0;for(let N=b.length-1-3;N>=0;N-=4)if(b[N]>0){X=Math.ceil(N/4/z);break}i.clearRect(0,0,z,z),i.strokeText("A",0,z),b=i.getImageData(0,0,z,z).data,o=0;for(let N=0,F=b.length;N<F;N+=4)if(b[N]>0){o=z-Math.floor(N/4/z);break}if(i.restore(),o){const N=o/(o+X);return r.set(a,N),N}return r.set(a,T),T}function j(a,i,I,g){const o=document.createElement("span"),X=a._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:i.str!=="",hasEOL:i.hasEOL,fontSize:0};a._textDivs.push(o);const b=h.Util.transform(a._viewport.transform,i.transform);let N=Math.atan2(b[1],b[0]);const F=I[i.fontName];F.vertical&&(N+=Math.PI/2);const hI=Math.hypot(b[2],b[3]),YI=hI*p(F.fontFamily,g);let nI,gI;N===0?(nI=b[4],gI=b[5]-YI):(nI=b[4]+YI*Math.sin(N),gI=b[5]-YI*Math.cos(N)),o.style.left=`${nI}px`,o.style.top=`${gI}px`,o.style.fontSize=`${hI}px`,o.style.fontFamily=F.fontFamily,X.fontSize=hI,o.setAttribute("role","presentation"),o.textContent=i.str,o.dir=i.dir,a._fontInspectorEnabled&&(o.dataset.fontName=i.fontName),N!==0&&(X.angle=N*(180/Math.PI));let U=!1;if(i.str.length>1||a._enhanceTextSelection&&Z.test(i.str))U=!0;else if(i.str!==" "&&i.transform[0]!==i.transform[3]){const II=Math.abs(i.transform[0]),q=Math.abs(i.transform[3]);II!==q&&Math.max(II,q)/Math.min(II,q)>1.5&&(U=!0)}if(U&&(F.vertical?X.canvasWidth=i.height*a._viewport.scale:X.canvasWidth=i.width*a._viewport.scale),a._textDivProperties.set(o,X),a._textContentStream&&a._layoutText(o),a._enhanceTextSelection&&X.hasText){let II=1,q=0;N!==0&&(II=Math.cos(N),q=Math.sin(N));const mI=(F.vertical?i.height:i.width)*a._viewport.scale,NI=hI;let BI,J;N!==0?(BI=[II,q,-q,II,nI,gI],J=h.Util.getAxialAlignedBoundingBox([0,0,mI,NI],BI)):J=[nI,gI,nI+mI,gI+NI],a._bounds.push({left:J[0],top:J[1],right:J[2],bottom:J[3],div:o,size:[mI,NI],m:BI})}}function D(a){if(a._canceled)return;const i=a._textDivs,I=a._capability,g=i.length;if(g>_){a._renderingDone=!0,I.resolve();return}if(!a._textContentStream)for(let o=0;o<g;o++)a._layoutText(i[o]);a._renderingDone=!0,I.resolve()}function m(a,i,I){let g=0;for(let o=0;o<I;o++){const X=a[i++];X>0&&(g=g?Math.min(X,g):X)}return g}function d(a){const i=a._bounds,I=a._viewport,g=C(I.width,I.height,i);for(let o=0;o<g.length;o++){const X=i[o].div,b=a._textDivProperties.get(X);if(b.angle===0){b.paddingLeft=i[o].left-g[o].left,b.paddingTop=i[o].top-g[o].top,b.paddingRight=g[o].right-i[o].right,b.paddingBottom=g[o].bottom-i[o].bottom,a._textDivProperties.set(X,b);continue}const N=g[o],F=i[o],hI=F.m,YI=hI[0],nI=hI[1],gI=[[0,0],[0,F.size[1]],[F.size[0],0],F.size],U=new Float64Array(64);for(let q=0,mI=gI.length;q<mI;q++){const NI=h.Util.applyTransform(gI[q],hI);U[q+0]=YI&&(N.left-NI[0])/YI,U[q+4]=nI&&(N.top-NI[1])/nI,U[q+8]=YI&&(N.right-NI[0])/YI,U[q+12]=nI&&(N.bottom-NI[1])/nI,U[q+16]=nI&&(N.left-NI[0])/-nI,U[q+20]=YI&&(N.top-NI[1])/YI,U[q+24]=nI&&(N.right-NI[0])/-nI,U[q+28]=YI&&(N.bottom-NI[1])/YI,U[q+32]=YI&&(N.left-NI[0])/-YI,U[q+36]=nI&&(N.top-NI[1])/-nI,U[q+40]=YI&&(N.right-NI[0])/-YI,U[q+44]=nI&&(N.bottom-NI[1])/-nI,U[q+48]=nI&&(N.left-NI[0])/nI,U[q+52]=YI&&(N.top-NI[1])/-YI,U[q+56]=nI&&(N.right-NI[0])/nI,U[q+60]=YI&&(N.bottom-NI[1])/-YI}const II=1+Math.min(Math.abs(YI),Math.abs(nI));b.paddingLeft=m(U,32,16)/II,b.paddingTop=m(U,48,16)/II,b.paddingRight=m(U,0,16)/II,b.paddingBottom=m(U,16,16)/II,a._textDivProperties.set(X,b)}}function C(a,i,I){const g=I.map(function(X,b){return{x1:X.left,y1:X.top,x2:X.right,y2:X.bottom,index:b,x1New:void 0,x2New:void 0}});l(a,g);const o=new Array(I.length);for(const X of g){const b=X.index;o[b]={left:X.x1New,top:0,right:X.x2New,bottom:0}}I.map(function(X,b){const N=o[b],F=g[b];F.x1=X.top,F.y1=a-N.right,F.x2=X.bottom,F.y2=a-N.left,F.index=b,F.x1New=void 0,F.x2New=void 0}),l(i,g);for(const X of g){const b=X.index;o[b].top=X.x1New,o[b].bottom=X.x2New}return o}function l(a,i){i.sort(function(g,o){return g.x1-o.x1||g.index-o.index});const I=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const g of i){let o=0;for(;o<I.length&&I[o].end<=g.y1;)o++;let X=I.length-1;for(;X>=0&&I[X].start>=g.y2;)X--;let b,N,F,hI,YI=-1/0;for(F=o;F<=X;F++){b=I[F],N=b.boundary;let U;N.x2>g.x1?U=N.index>g.index?N.x1New:g.x1:N.x2New===void 0?U=(N.x2+g.x1)/2:U=N.x2New,U>YI&&(YI=U)}for(g.x1New=YI,F=o;F<=X;F++)b=I[F],N=b.boundary,N.x2New===void 0?N.x2>g.x1?N.index>g.index&&(N.x2New=N.x2):N.x2New=YI:N.x2New>YI&&(N.x2New=Math.max(YI,N.x2));const nI=[];let gI=null;for(F=o;F<=X;F++){b=I[F],N=b.boundary;const U=N.x2>g.x2?N:g;gI===U?nI.at(-1).end=b.end:(nI.push({start:b.start,end:b.end,boundary:U}),gI=U)}for(I[o].start<g.y1&&(nI[0].start=g.y1,nI.unshift({start:I[o].start,end:g.y1,boundary:I[o].boundary})),g.y2<I[X].end&&(nI.at(-1).end=g.y2,nI.push({start:g.y2,end:I[X].end,boundary:I[X].boundary})),F=o;F<=X;F++){if(b=I[F],N=b.boundary,N.x2New!==void 0)continue;let U=!1;for(hI=o-1;!U&&hI>=0&&I[hI].start>=N.y1;hI--)U=I[hI].boundary===N;for(hI=X+1;!U&&hI<I.length&&I[hI].end<=N.y2;hI++)U=I[hI].boundary===N;for(hI=0;!U&&hI<nI.length;hI++)U=nI[hI].boundary===N;U||(N.x2New=YI)}Array.prototype.splice.apply(I,[o,X-o+1,...nI])}for(const g of I){const o=g.boundary;o.x2New===void 0&&(o.x2New=Math.max(a,o.x2))}}class B{constructor({textContent:i,textContentStream:I,container:g,viewport:o,textDivs:X,textContentItemsStr:b,enhanceTextSelection:N}){var F;N&&(0,M.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=i,this._textContentStream=I,this._container=g,this._document=g.ownerDocument,this._viewport=o,this._textDivs=X||[],this._textContentItemsStr=b||[],this._enhanceTextSelection=!!N,this._fontInspectorEnabled=!!((F=globalThis.FontInspector)!=null&&F.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,h.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new h.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(i,I){for(let g=0,o=i.length;g<o;g++){if(i[g].str===void 0){if(i[g].type==="beginMarkedContentProps"||i[g].type==="beginMarkedContent"){const X=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),i[g].id!==null&&this._container.setAttribute("id",`${i[g].id}`),X.append(this._container)}else i[g].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(i[g].str),j(this,i[g],I,this._layoutTextCtx)}}_layoutText(i){const I=this._textDivProperties.get(i);let g="";if(I.canvasWidth!==0&&I.hasText){const{fontFamily:o}=i.style,{fontSize:X}=I;(X!==this._layoutTextLastFontSize||o!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${X*this._devicePixelRatio}px ${o}`,this._layoutTextLastFontSize=X,this._layoutTextLastFontFamily=o);const{width:b}=this._layoutTextCtx.measureText(i.textContent);if(b>0){const N=this._devicePixelRatio*I.canvasWidth/b;this._enhanceTextSelection&&(I.scale=N),g=`scaleX(${N})`}}if(I.angle!==0&&(g=`rotate(${I.angle}deg) ${g}`),g.length>0&&(this._enhanceTextSelection&&(I.originalTransform=g),i.style.transform=g),I.hasText&&this._container.append(i),I.hasEOL){const o=document.createElement("br");o.setAttribute("role","presentation"),this._container.append(o)}}_render(i=0){const I=(0,h.createPromiseCapability)();let g=Object.create(null);const o=this._document.createElement("canvas");if(o.height=o.width=z,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){const X=this._textContent.items,b=this._textContent.styles;this._processItems(X,b),I.resolve()}else if(this._textContentStream){const X=()=>{this._reader.read().then(({value:b,done:N})=>{if(N){I.resolve();return}Object.assign(g,b.styles),this._processItems(b.items,g),X()},I.reject)};this._reader=this._textContentStream.getReader(),X()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');I.promise.then(()=>{g=null,i?this._renderTimer=setTimeout(()=>{D(this),this._renderTimer=null},i):D(this)},this._capability.reject)}expandTextDivs(i=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(d(this),this._bounds=null);const I=[],g=[];for(let o=0,X=this._textDivs.length;o<X;o++){const b=this._textDivs[o],N=this._textDivProperties.get(b);N.hasText&&(i?(I.length=0,g.length=0,N.originalTransform&&I.push(N.originalTransform),N.paddingTop>0?(g.push(`${N.paddingTop}px`),I.push(`translateY(${-N.paddingTop}px)`)):g.push(0),N.paddingRight>0?g.push(`${N.paddingRight/N.scale}px`):g.push(0),N.paddingBottom>0?g.push(`${N.paddingBottom}px`):g.push(0),N.paddingLeft>0?(g.push(`${N.paddingLeft/N.scale}px`),I.push(`translateX(${-N.paddingLeft/N.scale}px)`)):g.push(0),b.style.padding=g.join(" "),I.length&&(b.style.transform=I.join(" "))):(b.style.padding=null,b.style.transform=N.originalTransform))}}}c.TextLayerRenderTask=B;function Y(a){const i=new B({textContent:a.textContent,textContentStream:a.textContentStream,container:a.container,viewport:a.viewport,textDivs:a.textDivs,textContentItemsStr:a.textContentItemsStr,enhanceTextSelection:a.enhanceTextSelection});return i._render(a.timeout),i}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SVGGraphics=void 0;var h=$(8),M=$(1),_=$(3);let z=class{constructor(){(0,M.unreachable)("Not implemented: SVGGraphics")}};c.SVGGraphics=z;{let T=function(I){let g=[];const o=[];for(const X of I){if(X.fn==="save"){g.push({fnId:92,fn:"group",items:[]}),o.push(g),g=g.at(-1).items;continue}X.fn==="restore"?g=o.pop():g.push(X)}return g},r=function(I){if(Number.isInteger(I))return I.toString();const g=I.toFixed(10);let o=g.length-1;if(g[o]!=="0")return g;do o--;while(g[o]==="0");return g.substring(0,g[o]==="."?o:o+1)},Z=function(I){if(I[4]===0&&I[5]===0){if(I[1]===0&&I[2]===0)return I[0]===1&&I[3]===1?"":`scale(${r(I[0])} ${r(I[3])})`;if(I[0]===I[3]&&I[1]===-I[2]){const g=Math.acos(I[0])*180/Math.PI;return`rotate(${r(g)})`}}else if(I[0]===1&&I[1]===0&&I[2]===0&&I[3]===1)return`translate(${r(I[4])} ${r(I[5])})`;return`matrix(${r(I[0])} ${r(I[1])} ${r(I[2])} ${r(I[3])} ${r(I[4])} ${r(I[5])})`};const p={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},j="http://www.w3.org/XML/1998/namespace",D="http://www.w3.org/1999/xlink",m=["butt","round","square"],d=["miter","round","bevel"],C=function(I,g="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([I],{type:g}));const X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b=`data:${g};base64,`;for(let N=0,F=I.length;N<F;N+=3){const hI=I[N]&255,YI=I[N+1]&255,nI=I[N+2]&255,gI=hI>>2,U=(hI&3)<<4|YI>>4,II=N+1<F?(YI&15)<<2|nI>>6:64,q=N+2<F?nI&63:64;b+=X[gI]+X[U]+X[II]+X[q]}return b},l=function(){const I=new Uint8Array([137,80,78,71,13,10,26,10]),g=12,o=new Int32Array(256);for(let nI=0;nI<256;nI++){let gI=nI;for(let U=0;U<8;U++)gI&1?gI=3988292384^gI>>1&2147483647:gI=gI>>1&2147483647;o[nI]=gI}function X(nI,gI,U){let II=-1;for(let q=gI;q<U;q++){const mI=(II^nI[q])&255,NI=o[mI];II=II>>>8^NI}return II^-1}function b(nI,gI,U,II){let q=II;const mI=gI.length;U[q]=mI>>24&255,U[q+1]=mI>>16&255,U[q+2]=mI>>8&255,U[q+3]=mI&255,q+=4,U[q]=nI.charCodeAt(0)&255,U[q+1]=nI.charCodeAt(1)&255,U[q+2]=nI.charCodeAt(2)&255,U[q+3]=nI.charCodeAt(3)&255,q+=4,U.set(gI,q),q+=gI.length;const NI=X(U,II+4,q);U[q]=NI>>24&255,U[q+1]=NI>>16&255,U[q+2]=NI>>8&255,U[q+3]=NI&255}function N(nI,gI,U){let II=1,q=0;for(let mI=gI;mI<U;++mI)II=(II+(nI[mI]&255))%65521,q=(q+II)%65521;return q<<16|II}function F(nI){if(!_.isNodeJS)return hI(nI);try{let gI;parseInt(process.versions.node)>=8?gI=nI:gI=Buffer.from(nI);const U=require$$5.deflateSync(gI,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(gI){(0,M.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+gI)}return hI(nI)}function hI(nI){let gI=nI.length;const U=65535,II=Math.ceil(gI/U),q=new Uint8Array(2+gI+II*5+4);let mI=0;q[mI++]=120,q[mI++]=156;let NI=0;for(;gI>U;)q[mI++]=0,q[mI++]=255,q[mI++]=255,q[mI++]=0,q[mI++]=0,q.set(nI.subarray(NI,NI+U),mI),mI+=U,NI+=U,gI-=U;q[mI++]=1,q[mI++]=gI&255,q[mI++]=gI>>8&255,q[mI++]=~gI&65535&255,q[mI++]=(~gI&65535)>>8&255,q.set(nI.subarray(NI),mI),mI+=nI.length-NI;const BI=N(nI,0,nI.length);return q[mI++]=BI>>24&255,q[mI++]=BI>>16&255,q[mI++]=BI>>8&255,q[mI++]=BI&255,q}function YI(nI,gI,U,II){const q=nI.width,mI=nI.height;let NI,BI,J;const e=nI.data;switch(gI){case M.ImageKind.GRAYSCALE_1BPP:BI=0,NI=1,J=q+7>>3;break;case M.ImageKind.RGB_24BPP:BI=2,NI=8,J=q*3;break;case M.ImageKind.RGBA_32BPP:BI=6,NI=8,J=q*4;break;default:throw new Error("invalid format")}const w=new Uint8Array((1+J)*mI);let x=0,E=0;for(let W=0;W<mI;++W)w[x++]=0,w.set(e.subarray(E,E+J),x),E+=J,x+=J;if(gI===M.ImageKind.GRAYSCALE_1BPP&&II){x=0;for(let W=0;W<mI;W++){x++;for(let L=0;L<J;L++)w[x++]^=255}}const P=new Uint8Array([q>>24&255,q>>16&255,q>>8&255,q&255,mI>>24&255,mI>>16&255,mI>>8&255,mI&255,NI,BI,0,0,0]),iI=F(w),aI=I.length+g*3+P.length+iI.length,eI=new Uint8Array(aI);let A=0;return eI.set(I,A),A+=I.length,b("IHDR",P,eI,A),A+=g+P.length,b("IDATA",iI,eI,A),A+=g+iI.length,b("IEND",new Uint8Array(0),eI,A),C(eI,"image/png",U)}return function(nI,gI,U){const II=nI.kind===void 0?M.ImageKind.GRAYSCALE_1BPP:nI.kind;return YI(nI,II,gI,U)}}();class B{constructor(){this.fontSizeScale=1,this.fontWeight=p.fontWeight,this.fontSize=0,this.textMatrix=M.IDENTITY_MATRIX,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=M.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=p.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(g,o){this.x=g,this.y=o}}let Y=0,a=0,i=0;c.SVGGraphics=z=class{constructor(I,g,o=!1){(0,h.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new h.DOMSVGFactory,this.current=new B,this.transformMatrix=M.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=I,this.objs=g,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const X in M.OPS)this._operatorIdMapping[M.OPS[X]]=X}save(){this.transformStack.push(this.transformMatrix);const I=this.current;this.extraStack.push(I),this.current=I.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(I){this.save(),this.executeOpTree(I),this.restore()}loadDependencies(I){const g=I.fnArray,o=I.argsArray;for(let X=0,b=g.length;X<b;X++)if(g[X]===M.OPS.dependency)for(const N of o[X]){const F=N.startsWith("g_")?this.commonObjs:this.objs,hI=new Promise(YI=>{F.get(N,YI)});this.current.dependencies.push(hI)}return Promise.all(this.current.dependencies)}transform(I,g,o,X,b,N){const F=[I,g,o,X,b,N];this.transformMatrix=M.Util.transform(this.transformMatrix,F),this.tgrp=null}getSVG(I,g){this.viewport=g;const o=this._initialize(g);return this.loadDependencies(I).then(()=>(this.transformMatrix=M.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(I)),o))}convertOpList(I){const g=this._operatorIdMapping,o=I.argsArray,X=I.fnArray,b=[];for(let N=0,F=X.length;N<F;N++){const hI=X[N];b.push({fnId:hI,fn:g[hI],args:o[N]})}return T(b)}executeOpTree(I){for(const g of I){const o=g.fn,X=g.fnId,b=g.args;switch(X|0){case M.OPS.beginText:this.beginText();break;case M.OPS.dependency:break;case M.OPS.setLeading:this.setLeading(b);break;case M.OPS.setLeadingMoveText:this.setLeadingMoveText(b[0],b[1]);break;case M.OPS.setFont:this.setFont(b);break;case M.OPS.showText:this.showText(b[0]);break;case M.OPS.showSpacedText:this.showText(b[0]);break;case M.OPS.endText:this.endText();break;case M.OPS.moveText:this.moveText(b[0],b[1]);break;case M.OPS.setCharSpacing:this.setCharSpacing(b[0]);break;case M.OPS.setWordSpacing:this.setWordSpacing(b[0]);break;case M.OPS.setHScale:this.setHScale(b[0]);break;case M.OPS.setTextMatrix:this.setTextMatrix(b[0],b[1],b[2],b[3],b[4],b[5]);break;case M.OPS.setTextRise:this.setTextRise(b[0]);break;case M.OPS.setTextRenderingMode:this.setTextRenderingMode(b[0]);break;case M.OPS.setLineWidth:this.setLineWidth(b[0]);break;case M.OPS.setLineJoin:this.setLineJoin(b[0]);break;case M.OPS.setLineCap:this.setLineCap(b[0]);break;case M.OPS.setMiterLimit:this.setMiterLimit(b[0]);break;case M.OPS.setFillRGBColor:this.setFillRGBColor(b[0],b[1],b[2]);break;case M.OPS.setStrokeRGBColor:this.setStrokeRGBColor(b[0],b[1],b[2]);break;case M.OPS.setStrokeColorN:this.setStrokeColorN(b);break;case M.OPS.setFillColorN:this.setFillColorN(b);break;case M.OPS.shadingFill:this.shadingFill(b[0]);break;case M.OPS.setDash:this.setDash(b[0],b[1]);break;case M.OPS.setRenderingIntent:this.setRenderingIntent(b[0]);break;case M.OPS.setFlatness:this.setFlatness(b[0]);break;case M.OPS.setGState:this.setGState(b[0]);break;case M.OPS.fill:this.fill();break;case M.OPS.eoFill:this.eoFill();break;case M.OPS.stroke:this.stroke();break;case M.OPS.fillStroke:this.fillStroke();break;case M.OPS.eoFillStroke:this.eoFillStroke();break;case M.OPS.clip:this.clip("nonzero");break;case M.OPS.eoClip:this.clip("evenodd");break;case M.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case M.OPS.paintImageXObject:this.paintImageXObject(b[0]);break;case M.OPS.paintInlineImageXObject:this.paintInlineImageXObject(b[0]);break;case M.OPS.paintImageMaskXObject:this.paintImageMaskXObject(b[0]);break;case M.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(b[0],b[1]);break;case M.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case M.OPS.closePath:this.closePath();break;case M.OPS.closeStroke:this.closeStroke();break;case M.OPS.closeFillStroke:this.closeFillStroke();break;case M.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case M.OPS.nextLine:this.nextLine();break;case M.OPS.transform:this.transform(b[0],b[1],b[2],b[3],b[4],b[5]);break;case M.OPS.constructPath:this.constructPath(b[0],b[1]);break;case M.OPS.endPath:this.endPath();break;case 92:this.group(g.items);break;default:(0,M.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(I){this.current.wordSpacing=I}setCharSpacing(I){this.current.charSpacing=I}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(I,g,o,X,b,N){const F=this.current;F.textMatrix=F.lineMatrix=[I,g,o,X,b,N],F.textMatrixScale=Math.hypot(I,g),F.x=F.lineX=0,F.y=F.lineY=0,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size",`${r(F.fontSize)}px`),F.tspan.setAttributeNS(null,"y",r(-F.y)),F.txtElement=this.svgFactory.createElement("svg:text"),F.txtElement.append(F.tspan)}beginText(){const I=this.current;I.x=I.lineX=0,I.y=I.lineY=0,I.textMatrix=M.IDENTITY_MATRIX,I.lineMatrix=M.IDENTITY_MATRIX,I.textMatrixScale=1,I.tspan=this.svgFactory.createElement("svg:tspan"),I.txtElement=this.svgFactory.createElement("svg:text"),I.txtgrp=this.svgFactory.createElement("svg:g"),I.xcoords=[],I.ycoords=[]}moveText(I,g){const o=this.current;o.x=o.lineX+=I,o.y=o.lineY+=g,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${r(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",r(-o.y))}showText(I){const g=this.current,o=g.font,X=g.fontSize;if(X===0)return;const b=g.fontSizeScale,N=g.charSpacing,F=g.wordSpacing,hI=g.fontDirection,YI=g.textHScale*hI,nI=o.vertical,gI=nI?1:-1,U=o.defaultVMetrics,II=X*g.fontMatrix[0];let q=0;for(const BI of I){if(BI===null){q+=hI*F;continue}else if(typeof BI=="number"){q+=gI*BI*X/1e3;continue}const J=(BI.isSpace?F:0)+N,e=BI.fontChar;let w,x,E=BI.width;if(nI){let iI;const aI=BI.vmetric||U;iI=BI.vmetric?aI[1]:E*.5,iI=-iI*II;const eI=aI[2]*II;E=aI?-aI[0]:E,w=iI/b,x=(q+eI)/b}else w=q/b,x=0;(BI.isInFont||o.missingFile)&&(g.xcoords.push(g.x+w),nI&&g.ycoords.push(-g.y+x),g.tspan.textContent+=e);let P;nI?P=E*II-J*hI:P=E*II+J*hI,q+=P}g.tspan.setAttributeNS(null,"x",g.xcoords.map(r).join(" ")),nI?g.tspan.setAttributeNS(null,"y",g.ycoords.map(r).join(" ")):g.tspan.setAttributeNS(null,"y",r(-g.y)),nI?g.y-=q:g.x+=q*YI,g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${r(g.fontSize)}px`),g.fontStyle!==p.fontStyle&&g.tspan.setAttributeNS(null,"font-style",g.fontStyle),g.fontWeight!==p.fontWeight&&g.tspan.setAttributeNS(null,"font-weight",g.fontWeight);const mI=g.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;if(mI===M.TextRenderingMode.FILL||mI===M.TextRenderingMode.FILL_STROKE?(g.fillColor!==p.fillColor&&g.tspan.setAttributeNS(null,"fill",g.fillColor),g.fillAlpha<1&&g.tspan.setAttributeNS(null,"fill-opacity",g.fillAlpha)):g.textRenderingMode===M.TextRenderingMode.ADD_TO_PATH?g.tspan.setAttributeNS(null,"fill","transparent"):g.tspan.setAttributeNS(null,"fill","none"),mI===M.TextRenderingMode.STROKE||mI===M.TextRenderingMode.FILL_STROKE){const BI=1/(g.textMatrixScale||1);this._setStrokeAttributes(g.tspan,BI)}let NI=g.textMatrix;g.textRise!==0&&(NI=NI.slice(),NI[5]+=g.textRise),g.txtElement.setAttributeNS(null,"transform",`${Z(NI)} scale(${r(YI)}, -1)`),g.txtElement.setAttributeNS(j,"xml:space","preserve"),g.txtElement.append(g.tspan),g.txtgrp.append(g.txtElement),this._ensureTransformGroup().append(g.txtElement)}setLeadingMoveText(I,g){this.setLeading(-g),this.moveText(I,g)}addFontStyle(I){if(!I.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const g=C(I.data,I.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${I.loadedName}"; src: url(${g}); }
`}setFont(I){const g=this.current,o=this.commonObjs.get(I[0]);let X=I[1];g.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),g.fontMatrix=o.fontMatrix||M.FONT_IDENTITY_MATRIX;let b="normal";o.black?b="900":o.bold&&(b="bold");const N=o.italic?"italic":"normal";X<0?(X=-X,g.fontDirection=-1):g.fontDirection=1,g.fontSize=X,g.fontFamily=o.loadedName,g.fontWeight=b,g.fontStyle=N,g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"y",r(-g.y)),g.xcoords=[],g.ycoords=[]}endText(){var I;const g=this.current;g.textRenderingMode&M.TextRenderingMode.ADD_TO_PATH_FLAG&&(I=g.txtElement)!=null&&I.hasChildNodes()&&(g.element=g.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(I){I>0&&(this.current.lineWidth=I)}setLineCap(I){this.current.lineCap=m[I]}setLineJoin(I){this.current.lineJoin=d[I]}setMiterLimit(I){this.current.miterLimit=I}setStrokeAlpha(I){this.current.strokeAlpha=I}setStrokeRGBColor(I,g,o){this.current.strokeColor=M.Util.makeHexColor(I,g,o)}setFillAlpha(I){this.current.fillAlpha=I}setFillRGBColor(I,g,o){this.current.fillColor=M.Util.makeHexColor(I,g,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(I){this.current.strokeColor=this._makeColorN_Pattern(I)}setFillColorN(I){this.current.fillColor=this._makeColorN_Pattern(I)}shadingFill(I){const g=this.viewport.width,o=this.viewport.height,X=M.Util.inverseTransform(this.transformMatrix),b=M.Util.applyTransform([0,0],X),N=M.Util.applyTransform([0,o],X),F=M.Util.applyTransform([g,0],X),hI=M.Util.applyTransform([g,o],X),YI=Math.min(b[0],N[0],F[0],hI[0]),nI=Math.min(b[1],N[1],F[1],hI[1]),gI=Math.max(b[0],N[0],F[0],hI[0]),U=Math.max(b[1],N[1],F[1],hI[1]),II=this.svgFactory.createElement("svg:rect");II.setAttributeNS(null,"x",YI),II.setAttributeNS(null,"y",nI),II.setAttributeNS(null,"width",gI-YI),II.setAttributeNS(null,"height",U-nI),II.setAttributeNS(null,"fill",this._makeShadingPattern(I)),this.current.fillAlpha<1&&II.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(II)}_makeColorN_Pattern(I){return I[0]==="TilingPattern"?this._makeTilingPattern(I):this._makeShadingPattern(I)}_makeTilingPattern(I){const g=I[1],o=I[2],X=I[3]||M.IDENTITY_MATRIX,[b,N,F,hI]=I[4],YI=I[5],nI=I[6],gI=I[7],U=`shading${i++}`,[II,q,mI,NI]=M.Util.normalizeRect([...M.Util.applyTransform([b,N],X),...M.Util.applyTransform([F,hI],X)]),[BI,J]=M.Util.singularValueDecompose2dScale(X),e=YI*BI,w=nI*J,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",U),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",e),x.setAttributeNS(null,"height",w),x.setAttributeNS(null,"x",`${II}`),x.setAttributeNS(null,"y",`${q}`);const E=this.svg,P=this.transformMatrix,iI=this.current.fillColor,aI=this.current.strokeColor,eI=this.svgFactory.create(mI-II,NI-q);if(this.svg=eI,this.transformMatrix=X,gI===2){const A=M.Util.makeHexColor(...g);this.current.fillColor=A,this.current.strokeColor=A}return this.executeOpTree(this.convertOpList(o)),this.svg=E,this.transformMatrix=P,this.current.fillColor=iI,this.current.strokeColor=aI,x.append(eI.childNodes[0]),this.defs.append(x),`url(#${U})`}_makeShadingPattern(I){switch(typeof I=="string"&&(I=this.objs.get(I)),I[0]){case"RadialAxial":const g=`shading${i++}`,o=I[3];let X;switch(I[1]){case"axial":const b=I[4],N=I[5];X=this.svgFactory.createElement("svg:linearGradient"),X.setAttributeNS(null,"id",g),X.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),X.setAttributeNS(null,"x1",b[0]),X.setAttributeNS(null,"y1",b[1]),X.setAttributeNS(null,"x2",N[0]),X.setAttributeNS(null,"y2",N[1]);break;case"radial":const F=I[4],hI=I[5],YI=I[6],nI=I[7];X=this.svgFactory.createElement("svg:radialGradient"),X.setAttributeNS(null,"id",g),X.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),X.setAttributeNS(null,"cx",hI[0]),X.setAttributeNS(null,"cy",hI[1]),X.setAttributeNS(null,"r",nI),X.setAttributeNS(null,"fx",F[0]),X.setAttributeNS(null,"fy",F[1]),X.setAttributeNS(null,"fr",YI);break;default:throw new Error(`Unknown RadialAxial type: ${I[1]}`)}for(const b of o){const N=this.svgFactory.createElement("svg:stop");N.setAttributeNS(null,"offset",b[0]),N.setAttributeNS(null,"stop-color",b[1]),X.append(N)}return this.defs.append(X),`url(#${g})`;case"Mesh":return(0,M.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${I[0]}`)}}setDash(I,g){this.current.dashArray=I,this.current.dashPhase=g}constructPath(I,g){const o=this.current;let X=o.x,b=o.y,N=[],F=0;for(const hI of I)switch(hI|0){case M.OPS.rectangle:X=g[F++],b=g[F++];const YI=g[F++],nI=g[F++],gI=X+YI,U=b+nI;N.push("M",r(X),r(b),"L",r(gI),r(b),"L",r(gI),r(U),"L",r(X),r(U),"Z");break;case M.OPS.moveTo:X=g[F++],b=g[F++],N.push("M",r(X),r(b));break;case M.OPS.lineTo:X=g[F++],b=g[F++],N.push("L",r(X),r(b));break;case M.OPS.curveTo:X=g[F+4],b=g[F+5],N.push("C",r(g[F]),r(g[F+1]),r(g[F+2]),r(g[F+3]),r(X),r(b)),F+=6;break;case M.OPS.curveTo2:N.push("C",r(X),r(b),r(g[F]),r(g[F+1]),r(g[F+2]),r(g[F+3])),X=g[F+2],b=g[F+3],F+=4;break;case M.OPS.curveTo3:X=g[F+2],b=g[F+3],N.push("C",r(g[F]),r(g[F+1]),r(X),r(b),r(X),r(b)),F+=4;break;case M.OPS.closePath:N.push("Z");break}N=N.join(" "),o.path&&I.length>0&&I[0]!==M.OPS.rectangle&&I[0]!==M.OPS.moveTo?N=o.path.getAttributeNS(null,"d")+N:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",N),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(X,b)}endPath(){const I=this.current;if(I.path=null,!this.pendingClip)return;if(!I.element){this.pendingClip=null;return}const g=`clippath${Y++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",g),o.setAttributeNS(null,"transform",Z(this.transformMatrix));const X=I.element.cloneNode(!0);if(this.pendingClip==="evenodd"?X.setAttributeNS(null,"clip-rule","evenodd"):X.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(X),this.defs.append(o),I.activeClipUrl){I.clipGroup=null;for(const b of this.extraStack)b.clipGroup=null;o.setAttributeNS(null,"clip-path",I.activeClipUrl)}I.activeClipUrl=`url(#${g})`,this.tgrp=null}clip(I){this.pendingClip=I}closePath(){const I=this.current;if(I.path){const g=`${I.path.getAttributeNS(null,"d")}Z`;I.path.setAttributeNS(null,"d",g)}}setLeading(I){this.current.leading=-I}setTextRise(I){this.current.textRise=I}setTextRenderingMode(I){this.current.textRenderingMode=I}setHScale(I){this.current.textHScale=I/100}setRenderingIntent(I){}setFlatness(I){}setGState(I){for(const[g,o]of I)switch(g){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,M.warn)(`Unimplemented graphic state operator ${g}`);break}}fill(){const I=this.current;I.element&&(I.element.setAttributeNS(null,"fill",I.fillColor),I.element.setAttributeNS(null,"fill-opacity",I.fillAlpha),this.endPath())}stroke(){const I=this.current;I.element&&(this._setStrokeAttributes(I.element),I.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(I,g=1){const o=this.current;let X=o.dashArray;g!==1&&X.length>0&&(X=X.map(function(b){return g*b})),I.setAttributeNS(null,"stroke",o.strokeColor),I.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),I.setAttributeNS(null,"stroke-miterlimit",r(o.miterLimit)),I.setAttributeNS(null,"stroke-linecap",o.lineCap),I.setAttributeNS(null,"stroke-linejoin",o.lineJoin),I.setAttributeNS(null,"stroke-width",r(g*o.lineWidth)+"px"),I.setAttributeNS(null,"stroke-dasharray",X.map(r).join(" ")),I.setAttributeNS(null,"stroke-dashoffset",r(g*o.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width","1px"),I.setAttributeNS(null,"height","1px"),I.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(I)}paintImageXObject(I){const g=I.startsWith("g_")?this.commonObjs.get(I):this.objs.get(I);if(!g){(0,M.warn)(`Dependent image with object ID ${I} is not ready yet`);return}this.paintInlineImageXObject(g)}paintInlineImageXObject(I,g){const o=I.width,X=I.height,b=l(I,this.forceDataSchema,!!g),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",r(o)),N.setAttributeNS(null,"height",r(X)),this.current.element=N,this.clip("nonzero");const F=this.svgFactory.createElement("svg:image");F.setAttributeNS(D,"xlink:href",b),F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y",r(-X)),F.setAttributeNS(null,"width",r(o)+"px"),F.setAttributeNS(null,"height",r(X)+"px"),F.setAttributeNS(null,"transform",`scale(${r(1/o)} ${r(-1/X)})`),g?g.append(F):this._ensureTransformGroup().append(F)}paintImageMaskXObject(I){const g=this.current,o=I.width,X=I.height,b=g.fillColor;g.maskId=`mask${a++}`;const N=this.svgFactory.createElement("svg:mask");N.setAttributeNS(null,"id",g.maskId);const F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",r(o)),F.setAttributeNS(null,"height",r(X)),F.setAttributeNS(null,"fill",b),F.setAttributeNS(null,"mask",`url(#${g.maskId})`),this.defs.append(N),this._ensureTransformGroup().append(F),this.paintInlineImageXObject(I,N)}paintFormXObjectBegin(I,g){if(Array.isArray(I)&&I.length===6&&this.transform(I[0],I[1],I[2],I[3],I[4],I[5]),g){const o=g[2]-g[0],X=g[3]-g[1],b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x",g[0]),b.setAttributeNS(null,"y",g[1]),b.setAttributeNS(null,"width",r(o)),b.setAttributeNS(null,"height",r(X)),this.current.element=b,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(I){const g=this.svgFactory.create(I.width,I.height),o=this.svgFactory.createElement("svg:defs");g.append(o),this.defs=o;const X=this.svgFactory.createElement("svg:g");return X.setAttributeNS(null,"transform",Z(I.transform)),g.append(X),this.svg=X,g}_ensureClipGroup(){if(!this.current.clipGroup){const I=this.svgFactory.createElement("svg:g");I.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(I),this.current.clipGroup=I}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",Z(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNodeStream=void 0;var h=$(1),M=$(33);const _=require$$5,z=require$$5,T=require$$5,r=require$$5,Z=/^file:\/\/\/[a-zA-Z]:\//;function p(a){const i=r.parse(a);return i.protocol==="file:"||i.host?i:/^[a-z]:[/\\]/i.test(a)?r.parse(`file:///${a}`):(i.host||(i.protocol="file:"),i)}class j{constructor(i){this.source=i,this.url=p(i.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&i.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var i;return((i=this._fullRequestReader)==null?void 0:i._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new B(this):new C(this),this._fullRequestReader}getRangeReader(i,I){if(I<=this._progressiveDataLength)return null;const g=this.isFsUrl?new Y(this,i,I):new l(this,i,I);return this._rangeRequestReaders.push(g),g}cancelAllRequests(i){this._fullRequestReader&&this._fullRequestReader.cancel(i);for(const I of this._rangeRequestReaders.slice(0))I.cancel(i)}}c.PDFNodeStream=j;class D{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null;const I=i.source;this._contentLength=I.length,this._loaded=0,this._filename=null,this._disableRange=I.disableRange||!1,this._rangeChunkSize=I.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!I.disableStream,this._isRangeSupported=!I.disableRange,this._readableStream=null,this._readCapability=(0,h.createPromiseCapability)(),this._headersCapability=(0,h.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,h.createPromiseCapability)(),this.read()):(this._loaded+=i.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){if(!this._readableStream){this._error(i);return}this._readableStream.destroy(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",I=>{this._error(I)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new h.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class m{constructor(i){this._url=i.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,h.createPromiseCapability)();const I=i.source;this._isStreamingSupported=!I.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const i=this._readableStream.read();return i===null?(this._readCapability=(0,h.createPromiseCapability)(),this.read()):(this._loaded+=i.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(i).buffer,done:!1})}cancel(i){if(!this._readableStream){this._error(i);return}this._readableStream.destroy(i)}_error(i){this._storedError=i,this._readCapability.resolve()}_setReadableStream(i){this._readableStream=i,i.on("readable",()=>{this._readCapability.resolve()}),i.on("end",()=>{i.destroy(),this._done=!0,this._readCapability.resolve()}),i.on("error",I=>{this._error(I)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(a,i){return{protocol:a.protocol,auth:a.auth,host:a.hostname,port:a.port,path:a.path,method:"GET",headers:i}}class C extends D{constructor(i){super(i);const I=g=>{if(g.statusCode===404){const N=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=N,this._headersCapability.reject(N);return}this._headersCapability.resolve(),this._setReadableStream(g);const o=N=>this._readableStream.headers[N.toLowerCase()],{allowRangeRequests:X,suggestedLength:b}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:i.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=X,this._contentLength=b||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(o)};this._request=null,this._url.protocol==="http:"?this._request=z.request(d(this._url,i.httpHeaders),I):this._request=T.request(d(this._url,i.httpHeaders),I),this._request.on("error",g=>{this._storedError=g,this._headersCapability.reject(g)}),this._request.end()}}class l extends m{constructor(i,I,g){super(i),this._httpHeaders={};for(const X in i.httpHeaders){const b=i.httpHeaders[X];typeof b>"u"||(this._httpHeaders[X]=b)}this._httpHeaders.Range=`bytes=${I}-${g-1}`;const o=X=>{if(X.statusCode===404){const b=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b;return}this._setReadableStream(X)};this._request=null,this._url.protocol==="http:"?this._request=z.request(d(this._url,this._httpHeaders),o):this._request=T.request(d(this._url,this._httpHeaders),o),this._request.on("error",X=>{this._storedError=X}),this._request.end()}}class B extends D{constructor(i){super(i);let I=decodeURIComponent(this._url.path);Z.test(this._url.href)&&(I=I.replace(/^\//,"")),_.lstat(I,(g,o)=>{if(g){g.code==="ENOENT"&&(g=new h.MissingPDFException(`Missing PDF "${I}".`)),this._storedError=g,this._headersCapability.reject(g);return}this._contentLength=o.size,this._setReadableStream(_.createReadStream(I)),this._headersCapability.resolve()})}}class Y extends m{constructor(i,I,g){super(i);let o=decodeURIComponent(this._url.path);Z.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(_.createReadStream(o,{start:I,end:g-1}))}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createResponseStatusError=r,c.extractFilenameFromHeader=T,c.validateRangeRequestCapabilities=z,c.validateResponseStatus=Z;var h=$(1),M=$(34),_=$(8);function z({getResponseHeader:p,isHttp:j,rangeChunkSize:D,disableRange:m}){const d={allowRangeRequests:!1,suggestedLength:void 0},C=parseInt(p("Content-Length"),10);return!Number.isInteger(C)||(d.suggestedLength=C,C<=2*D)||m||!j||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(d.allowRangeRequests=!0),d}function T(p){const j=p("Content-Disposition");if(j){let D=(0,M.getFilenameFromContentDispositionHeader)(j);if(D.includes("%"))try{D=decodeURIComponent(D)}catch{}if((0,_.isPdfFile)(D))return D}return null}function r(p,j){return p===404||p===0&&j.startsWith("file:")?new h.MissingPDFException('Missing PDF "'+j+'".'):new h.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${j}".`,p)}function Z(p){return p===200||p===206}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getFilenameFromContentDispositionHeader=M;var h=$(1);function M(_){let z=!0,T=r("filename\\*","i").exec(_);if(T){T=T[1];let C=D(T);return C=unescape(C),C=m(C),C=d(C),p(C)}if(T=j(_),T){const C=d(T);return p(C)}if(T=r("filename","i").exec(_),T){T=T[1];let C=D(T);return C=d(C),p(C)}function r(C,l){return new RegExp("(?:^|;)\\s*"+C+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',l)}function Z(C,l){if(C){if(!/^[\x00-\xFF]+$/.test(l))return l;try{const B=new TextDecoder(C,{fatal:!0}),Y=(0,h.stringToBytes)(l);l=B.decode(Y),z=!1}catch{}}return l}function p(C){return z&&/[\x80-\xff]/.test(C)&&(C=Z("utf-8",C),z&&(C=Z("iso-8859-1",C))),C}function j(C){const l=[];let B;const Y=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(B=Y.exec(C))!==null;){let[,i,I,g]=B;if(i=parseInt(i,10),i in l){if(i===0)break;continue}l[i]=[I,g]}const a=[];for(let i=0;i<l.length&&i in l;++i){let[I,g]=l[i];g=D(g),I&&(g=unescape(g),i===0&&(g=m(g))),a.push(g)}return a.join("")}function D(C){if(C.startsWith('"')){const l=C.slice(1).split('\\"');for(let B=0;B<l.length;++B){const Y=l[B].indexOf('"');Y!==-1&&(l[B]=l[B].slice(0,Y),l.length=B+1),l[B]=l[B].replace(/\\(.)/g,"$1")}C=l.join('"')}return C}function m(C){const l=C.indexOf("'");if(l===-1)return C;const B=C.slice(0,l),Y=C.slice(l+1).replace(/^[^']*'/,"");return Z(B,Y)}function d(C){return!C.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(C)?C:C.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(l,B,Y,a){if(Y==="q"||Y==="Q")return a=a.replace(/_/g," "),a=a.replace(/=([0-9a-fA-F]{2})/g,function(i,I){return String.fromCharCode(parseInt(I,16))}),Z(B,a);try{a=atob(a)}catch{}return Z(B,a)})}return""}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNetworkStream=void 0;var h=$(1),M=$(33);const _=200,z=206;function T(D){const m=D.response;return typeof m!="string"?m:(0,h.stringToBytes)(m).buffer}class r{constructor(m,d={}){this.url=m,this.isHttp=/^https?:/i.test(m),this.httpHeaders=this.isHttp&&d.httpHeaders||Object.create(null),this.withCredentials=d.withCredentials||!1,this.getXhr=d.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(m,d,C){const l={begin:m,end:d};for(const B in C)l[B]=C[B];return this.request(l)}requestFull(m){return this.request(m)}request(m){const d=this.getXhr(),C=this.currXhrId++,l=this.pendingRequests[C]={xhr:d};d.open("GET",this.url),d.withCredentials=this.withCredentials;for(const B in this.httpHeaders){const Y=this.httpHeaders[B];typeof Y>"u"||d.setRequestHeader(B,Y)}return this.isHttp&&"begin"in m&&"end"in m?(d.setRequestHeader("Range",`bytes=${m.begin}-${m.end-1}`),l.expectedStatus=z):l.expectedStatus=_,d.responseType="arraybuffer",m.onError&&(d.onerror=function(B){m.onError(d.status)}),d.onreadystatechange=this.onStateChange.bind(this,C),d.onprogress=this.onProgress.bind(this,C),l.onHeadersReceived=m.onHeadersReceived,l.onDone=m.onDone,l.onError=m.onError,l.onProgress=m.onProgress,d.send(null),C}onProgress(m,d){var C;const l=this.pendingRequests[m];l&&((C=l.onProgress)==null||C.call(l,d))}onStateChange(m,d){var C,l,B;const Y=this.pendingRequests[m];if(!Y)return;const a=Y.xhr;if(a.readyState>=2&&Y.onHeadersReceived&&(Y.onHeadersReceived(),delete Y.onHeadersReceived),a.readyState!==4||!(m in this.pendingRequests))return;if(delete this.pendingRequests[m],a.status===0&&this.isHttp){(C=Y.onError)==null||C.call(Y,a.status);return}const i=a.status||_;if(!(i===_&&Y.expectedStatus===z)&&i!==Y.expectedStatus){(l=Y.onError)==null||l.call(Y,a.status);return}const I=T(a);if(i===z){const g=a.getResponseHeader("Content-Range"),o=/bytes (\d+)-(\d+)\/(\d+)/.exec(g);Y.onDone({begin:parseInt(o[1],10),chunk:I})}else I?Y.onDone({begin:0,chunk:I}):(B=Y.onError)==null||B.call(Y,a.status)}getRequestXhr(m){return this.pendingRequests[m].xhr}isPendingRequest(m){return m in this.pendingRequests}abortRequest(m){const d=this.pendingRequests[m].xhr;delete this.pendingRequests[m],d.abort()}}class Z{constructor(m){this._source=m,this._manager=new r(m.url,{httpHeaders:m.httpHeaders,withCredentials:m.withCredentials}),this._rangeChunkSize=m.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(m){const d=this._rangeRequestReaders.indexOf(m);d>=0&&this._rangeRequestReaders.splice(d,1)}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(m,d){const C=new j(this._manager,m,d);return C.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(C),C}cancelAllRequests(m){var d;(d=this._fullRequestReader)==null||d.cancel(m);for(const C of this._rangeRequestReaders.slice(0))C.cancel(m)}}c.PDFNetworkStream=Z;class p{constructor(m,d){this._manager=m;const C={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._fullRequestId=m.requestFull(C),this._headersReceivedCapability=(0,h.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._contentLength=d.length,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const m=this._fullRequestId,d=this._manager.getRequestXhr(m),C=Y=>d.getResponseHeader(Y),{allowRangeRequests:l,suggestedLength:B}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=B||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(C),this._isRangeSupported&&this._manager.abortRequest(m),this._headersReceivedCapability.resolve()}_onDone(m){if(m&&(this._requests.length>0?this._requests.shift().resolve({value:m.chunk,done:!1}):this._cachedChunks.push(m.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(m){this._storedError=(0,M.createResponseStatusError)(m,this._url),this._headersReceivedCapability.reject(this._storedError);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(m){var d;(d=this.onProgress)==null||d.call(this,{loaded:m.loaded,total:m.lengthComputable?m.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=(0,h.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0,this._headersReceivedCapability.reject(m);for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(m,d,C){this._manager=m;const l={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._requestId=m.requestRange(d,C,l),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var m;(m=this.onClosed)==null||m.call(this,this)}_onDone(m){const d=m.chunk;this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunk=d,this._done=!0;for(const C of this._requests)C.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(m){this._storedError=(0,M.createResponseStatusError)(m,this._url);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(m){var d;this.isStreamingSupported||(d=this.onProgress)==null||d.call(this,{loaded:m.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const m=(0,h.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(wI,c,$)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFFetchStream=void 0;var h=$(1),M=$(33);function _(p,j,D){return{method:"GET",headers:p,signal:D.signal,mode:"cors",credentials:j?"include":"same-origin",redirect:"follow"}}function z(p){const j=new Headers;for(const D in p){const m=p[D];typeof m>"u"||j.append(D,m)}return j}class T{constructor(j){this.source=j,this.isHttp=/^https?:/i.test(j.url),this.httpHeaders=this.isHttp&&j.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var j;return((j=this._fullRequestReader)==null?void 0:j._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new r(this),this._fullRequestReader}getRangeReader(j,D){if(D<=this._progressiveDataLength)return null;const m=new Z(this,j,D);return this._rangeRequestReaders.push(m),m}cancelAllRequests(j){this._fullRequestReader&&this._fullRequestReader.cancel(j);for(const D of this._rangeRequestReaders.slice(0))D.cancel(j)}}c.PDFFetchStream=T;class r{constructor(j){this._stream=j,this._reader=null,this._loaded=0,this._filename=null;const D=j.source;this._withCredentials=D.withCredentials||!1,this._contentLength=D.length,this._headersCapability=(0,h.createPromiseCapability)(),this._disableRange=D.disableRange||!1,this._rangeChunkSize=D.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!D.disableStream,this._isRangeSupported=!D.disableRange,this._headers=z(this._stream.httpHeaders);const m=D.url;fetch(m,_(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,M.validateResponseStatus)(d.status))throw(0,M.createResponseStatusError)(d.status,m);this._reader=d.body.getReader(),this._headersCapability.resolve();const C=Y=>d.headers.get(Y),{allowRangeRequests:l,suggestedLength:B}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=B||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(C),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new h.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:j,done:D}=await this._reader.read();return D?{value:j,done:D}:(this._loaded+=j.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){this._reader&&this._reader.cancel(j),this._abortController.abort()}}class Z{constructor(j,D,m){this._stream=j,this._reader=null,this._loaded=0;const d=j.source;this._withCredentials=d.withCredentials||!1,this._readCapability=(0,h.createPromiseCapability)(),this._isStreamingSupported=!d.disableStream,this._abortController=new AbortController,this._headers=z(this._stream.httpHeaders),this._headers.append("Range",`bytes=${D}-${m-1}`);const C=d.url;fetch(C,_(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,M.validateResponseStatus)(l.status))throw(0,M.createResponseStatusError)(l.status,C);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:j,done:D}=await this._reader.read();return D?{value:j,done:D}:(this._loaded+=j.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){this._reader&&this._reader.cancel(j),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(wI){var c=__webpack_module_cache__[wI];if(c!==void 0)return c.exports;var $=__webpack_module_cache__[wI]={exports:{}};return __webpack_modules__[wI]($,$.exports,__w_pdfjs_require__),$.exports}var __webpack_exports__={};return(()=>{var wI=__webpack_exports__;Object.defineProperty(wI,"__esModule",{value:!0}),Object.defineProperty(wI,"AnnotationEditorLayer",{enumerable:!0,get:function(){return M.AnnotationEditorLayer}}),Object.defineProperty(wI,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return c.AnnotationEditorParamsType}}),Object.defineProperty(wI,"AnnotationEditorType",{enumerable:!0,get:function(){return c.AnnotationEditorType}}),Object.defineProperty(wI,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _.AnnotationEditorUIManager}}),Object.defineProperty(wI,"AnnotationLayer",{enumerable:!0,get:function(){return z.AnnotationLayer}}),Object.defineProperty(wI,"AnnotationMode",{enumerable:!0,get:function(){return c.AnnotationMode}}),Object.defineProperty(wI,"CMapCompressionType",{enumerable:!0,get:function(){return c.CMapCompressionType}}),Object.defineProperty(wI,"GlobalWorkerOptions",{enumerable:!0,get:function(){return T.GlobalWorkerOptions}}),Object.defineProperty(wI,"InvalidPDFException",{enumerable:!0,get:function(){return c.InvalidPDFException}}),Object.defineProperty(wI,"LoopbackPort",{enumerable:!0,get:function(){return $.LoopbackPort}}),Object.defineProperty(wI,"MissingPDFException",{enumerable:!0,get:function(){return c.MissingPDFException}}),Object.defineProperty(wI,"OPS",{enumerable:!0,get:function(){return c.OPS}}),Object.defineProperty(wI,"PDFDataRangeTransport",{enumerable:!0,get:function(){return $.PDFDataRangeTransport}}),Object.defineProperty(wI,"PDFDateString",{enumerable:!0,get:function(){return h.PDFDateString}}),Object.defineProperty(wI,"PDFWorker",{enumerable:!0,get:function(){return $.PDFWorker}}),Object.defineProperty(wI,"PasswordResponses",{enumerable:!0,get:function(){return c.PasswordResponses}}),Object.defineProperty(wI,"PermissionFlag",{enumerable:!0,get:function(){return c.PermissionFlag}}),Object.defineProperty(wI,"PixelsPerInch",{enumerable:!0,get:function(){return h.PixelsPerInch}}),Object.defineProperty(wI,"RenderingCancelledException",{enumerable:!0,get:function(){return h.RenderingCancelledException}}),Object.defineProperty(wI,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(wI,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return c.UNSUPPORTED_FEATURES}}),Object.defineProperty(wI,"UnexpectedResponseException",{enumerable:!0,get:function(){return c.UnexpectedResponseException}}),Object.defineProperty(wI,"Util",{enumerable:!0,get:function(){return c.Util}}),Object.defineProperty(wI,"VerbosityLevel",{enumerable:!0,get:function(){return c.VerbosityLevel}}),Object.defineProperty(wI,"XfaLayer",{enumerable:!0,get:function(){return j.XfaLayer}}),Object.defineProperty(wI,"build",{enumerable:!0,get:function(){return $.build}}),Object.defineProperty(wI,"createPromiseCapability",{enumerable:!0,get:function(){return c.createPromiseCapability}}),Object.defineProperty(wI,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return c.createValidAbsoluteUrl}}),Object.defineProperty(wI,"getDocument",{enumerable:!0,get:function(){return $.getDocument}}),Object.defineProperty(wI,"getFilenameFromUrl",{enumerable:!0,get:function(){return h.getFilenameFromUrl}}),Object.defineProperty(wI,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return h.getPdfFilenameFromUrl}}),Object.defineProperty(wI,"getXfaPageViewport",{enumerable:!0,get:function(){return h.getXfaPageViewport}}),Object.defineProperty(wI,"isPdfFile",{enumerable:!0,get:function(){return h.isPdfFile}}),Object.defineProperty(wI,"loadScript",{enumerable:!0,get:function(){return h.loadScript}}),Object.defineProperty(wI,"renderTextLayer",{enumerable:!0,get:function(){return Z.renderTextLayer}}),Object.defineProperty(wI,"shadow",{enumerable:!0,get:function(){return c.shadow}}),Object.defineProperty(wI,"version",{enumerable:!0,get:function(){return $.version}});var c=__w_pdfjs_require__(1),$=__w_pdfjs_require__(4),h=__w_pdfjs_require__(8),M=__w_pdfjs_require__(22),_=__w_pdfjs_require__(7),z=__w_pdfjs_require__(27),T=__w_pdfjs_require__(15),r=__w_pdfjs_require__(3),Z=__w_pdfjs_require__(30),p=__w_pdfjs_require__(31),j=__w_pdfjs_require__(29);if(r.isNodeJS){const{PDFNodeStream:D}=__w_pdfjs_require__(32);(0,$.setPDFNetworkStreamFactory)(m=>new D(m))}else{const{PDFNetworkStream:D}=__w_pdfjs_require__(35),{PDFFetchStream:m}=__w_pdfjs_require__(36);(0,$.setPDFNetworkStreamFactory)(d=>(0,h.isValidFetchUrl)(d.url)?new m(d):new D(d))}})(),__webpack_exports__})())}(pdf)),pdf.exports}(function(wI,c){(function($,h){wI.exports=h()})(globalThis,()=>(()=>{var $=[,(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.DefaultXfaLayerFactory=T.DefaultTextLayerFactory=T.DefaultStructTreeLayerFactory=T.DefaultAnnotationLayerFactory=T.DefaultAnnotationEditorLayerFactory=void 0;var Z=r(2),p=r(5),j=r(4),D=r(6),m=r(8),d=r(9),C=r(10);class l{createAnnotationLayerBuilder({pageDiv:g,pdfPage:o,annotationStorage:X=null,imageResourcesPath:b="",renderForms:N=!0,l10n:F=j.NullL10n,enableScripting:hI=!1,hasJSActionsPromise:YI=null,mouseState:nI=null,fieldObjectsPromise:gI=null,annotationCanvasMap:U=null,accessibilityManager:II=null}){return new p.AnnotationLayerBuilder({pageDiv:g,pdfPage:o,imageResourcesPath:b,renderForms:N,linkService:new D.SimpleLinkService,l10n:F,annotationStorage:X,enableScripting:hI,hasJSActionsPromise:YI,fieldObjectsPromise:gI,mouseState:nI,annotationCanvasMap:U,accessibilityManager:II})}}T.DefaultAnnotationLayerFactory=l;class B{createAnnotationEditorLayerBuilder({uiManager:g=null,pageDiv:o,pdfPage:X,accessibilityManager:b=null,l10n:N,annotationStorage:F=null}){return new Z.AnnotationEditorLayerBuilder({uiManager:g,pageDiv:o,pdfPage:X,accessibilityManager:b,l10n:N,annotationStorage:F})}}T.DefaultAnnotationEditorLayerFactory=B;class Y{createStructTreeLayerBuilder({pdfPage:g}){return new m.StructTreeLayerBuilder({pdfPage:g})}}T.DefaultStructTreeLayerFactory=Y;class a{createTextLayerBuilder({textLayerDiv:g,pageIndex:o,viewport:X,enhanceTextSelection:b=!1,eventBus:N,highlighter:F,accessibilityManager:hI=null}){return new d.TextLayerBuilder({textLayerDiv:g,pageIndex:o,viewport:X,enhanceTextSelection:b,eventBus:N,highlighter:F,accessibilityManager:hI})}}T.DefaultTextLayerFactory=a;class i{createXfaLayerBuilder({pageDiv:g,pdfPage:o,annotationStorage:X=null}){return new C.XfaLayerBuilder({pageDiv:g,pdfPage:o,annotationStorage:X,linkService:new D.SimpleLinkService})}}T.DefaultXfaLayerFactory=i},(z,T,r)=>{var Z;Object.defineProperty(T,"__esModule",{value:!0}),T.AnnotationEditorLayerBuilder=void 0;var p=r(3),j=r(4);class D{constructor(d){GI(this,Z,void 0),this.pageDiv=d.pageDiv,this.pdfPage=d.pdfPage,this.annotationStorage=d.annotationStorage||null,this.accessibilityManager=d.accessibilityManager,this.l10n=d.l10n||j.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,XI(this,Z,d.uiManager)}async render(d,C="display"){if(C!=="display"||this._cancelled)return;const l=d.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:l}),this.show();return}this.div=document.createElement("div"),this.div.className="annotationEditorLayer",this.div.tabIndex=0,this.pageDiv.append(this.div),this.annotationEditorLayer=new p.AnnotationEditorLayer({uiManager:R(this,Z),div:this.div,annotationStorage:this.annotationStorage,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage._pageIndex,l10n:this.l10n,viewport:l});const B={viewport:l,div:this.div,annotations:null,intent:C};this.annotationEditorLayer.render(B)}cancel(){this._cancelled=!0,this.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){this.div&&(this.div.hidden=!1)}destroy(){this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}}Z=new WeakMap,T.AnnotationEditorLayerBuilder=D},z=>{let T;typeof window<"u"&&window["pdfjs-dist/build/pdf"]?T=window["pdfjs-dist/build/pdf"]:T=requirePdf(),z.exports=T},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.NullL10n=void 0,T.fixupLangCode=j,T.getL10nFallback=Z;const r={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading…",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text_default_content:"Enter text…",editor_free_text_aria_label:"FreeText Editor",editor_ink_aria_label:"Ink Editor",editor_ink_canvas_aria_label:"User-created image"};function Z(d,C){switch(d){case"find_match_count":d=`find_match_count[${C.total===1?"one":"other"}]`;break;case"find_match_count_limit":d=`find_match_count_limit[${C.limit===1?"one":"other"}]`;break}return r[d]||""}const p={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function j(d){return p[d==null?void 0:d.toLowerCase()]||d}function D(d,C){return C?d.replace(/\{\{\s*(\w+)\s*\}\}/g,(l,B)=>B in C?C[B]:"{{"+B+"}}"):d}const m={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(d,C=null,l=Z(d,C)){return D(l,C)},async translate(d){}};T.NullL10n=m},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.AnnotationLayerBuilder=void 0;var Z=r(3),p=r(4);class j{constructor({pageDiv:m,pdfPage:d,linkService:C,downloadManager:l,annotationStorage:B=null,imageResourcesPath:Y="",renderForms:a=!0,l10n:i=p.NullL10n,enableScripting:I=!1,hasJSActionsPromise:g=null,fieldObjectsPromise:o=null,mouseState:X=null,annotationCanvasMap:b=null,accessibilityManager:N=null}){this.pageDiv=m,this.pdfPage=d,this.linkService=C,this.downloadManager=l,this.imageResourcesPath=Y,this.renderForms=a,this.l10n=i,this.annotationStorage=B,this.enableScripting=I,this._hasJSActionsPromise=g,this._fieldObjectsPromise=o,this._mouseState=X,this._annotationCanvasMap=b,this._accessibilityManager=N,this.div=null,this._cancelled=!1}async render(m,d="display"){const[C,l=!1,B=null]=await Promise.all([this.pdfPage.getAnnotations({intent:d}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled||C.length===0)return;const Y={viewport:m.clone({dontFlip:!0}),div:this.div,annotations:C,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:l,fieldObjects:B,mouseState:this._mouseState,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager};this.div?Z.AnnotationLayer.update(Y):(this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div),Y.div=this.div,Z.AnnotationLayer.render(Y),this.l10n.translate(this.div))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}T.AnnotationLayerBuilder=j},(z,T,r)=>{var Z,p,j,D,m;Object.defineProperty(T,"__esModule",{value:!0}),T.SimpleLinkService=T.PDFLinkService=T.LinkTarget=void 0;var d=r(7);const C="noopener noreferrer nofollow",l={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};T.LinkTarget=l;function B(I,{url:g,target:o,rel:X,enabled:b=!0}={}){if(!g||typeof g!="string")throw new Error('A valid "url" parameter must provided.');const N=(0,d.removeNullCharacters)(g);b?I.href=I.title=N:(I.href="",I.title=`Disabled: ${N}`,I.onclick=()=>!1);let F="";switch(o){case l.NONE:break;case l.SELF:F="_self";break;case l.BLANK:F="_blank";break;case l.PARENT:F="_parent";break;case l.TOP:F="_top";break}I.target=F,I.rel=typeof X=="string"?X:C}const Y=class{constructor({eventBus:I,externalLinkTarget:g=null,externalLinkRel:o=null,ignoreDestinationZoom:X=!1}={}){GI(this,p),GI(this,Z,new Map),this.eventBus=I,this.externalLinkTarget=g,this.externalLinkRel=o,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=X,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(I,g=null){this.baseUrl=g,this.pdfDocument=I,R(this,Z).clear()}setViewer(I){this.pdfViewer=I}setHistory(I){this.pdfHistory=I}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(I){this.pdfViewer.currentPageNumber=I}get rotation(){return this.pdfViewer.pagesRotation}set rotation(I){this.pdfViewer.pagesRotation=I}async goToDestination(I){if(!this.pdfDocument)return;let g,o;if(typeof I=="string"?(g=I,o=await this.pdfDocument.getDestination(I)):(g=null,o=await I),!Array.isArray(o)){console.error(`PDFLinkService.goToDestination: "${o}" is not a valid destination array, for dest="${I}".`);return}bI(this,p,j).call(this,I,g,o)}goToPage(I){if(!this.pdfDocument)return;const g=typeof I=="string"&&this.pdfViewer.pageLabelToPageNumber(I)||I|0;if(!(Number.isInteger(g)&&g>0&&g<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${I}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(g)),this.pdfViewer.scrollPageIntoView({pageNumber:g})}addLinkAttributes(I,g,o=!1){B(I,{url:g,target:o?l.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(I){if(typeof I=="string"){if(I.length>0)return this.getAnchorUrl("#"+escape(I))}else if(Array.isArray(I)){const g=JSON.stringify(I);if(g.length>0)return this.getAnchorUrl("#"+escape(g))}return this.getAnchorUrl("")}getAnchorUrl(I){return(this.baseUrl||"")+I}setHash(I){var g;if(!this.pdfDocument)return;let o,X;if(I.includes("=")){const b=(0,d.parseQueryString)(I);if(b.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:b.get("search").replace(/"/g,""),phraseSearch:b.get("phrase")==="true"}),b.has("page")&&(o=b.get("page")|0||1),b.has("zoom")){const N=b.get("zoom").split(","),F=N[0],hI=parseFloat(F);F.includes("Fit")?F==="Fit"||F==="FitB"?X=[null,{name:F}]:F==="FitH"||F==="FitBH"||F==="FitV"||F==="FitBV"?X=[null,{name:F},N.length>1?N[1]|0:null]:F==="FitR"?N.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):X=[null,{name:F},N[1]|0,N[2]|0,N[3]|0,N[4]|0]:console.error(`PDFLinkService.setHash: "${F}" is not a valid zoom value.`):X=[null,{name:"XYZ"},N.length>1?N[1]|0:null,N.length>2?N[2]|0:null,hI?hI/100:F]}X?this.pdfViewer.scrollPageIntoView({pageNumber:o||this.page,destArray:X,allowNegativeOffset:!0}):o&&(this.page=o),b.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:b.get("pagemode")}),b.has("nameddest")&&this.goToDestination(b.get("nameddest"))}else{X=unescape(I);try{X=JSON.parse(X),Array.isArray(X)||(X=X.toString())}catch{}if(typeof X=="string"||bI(g=Y,D,m).call(g,X)){this.goToDestination(X);return}console.error(`PDFLinkService.setHash: "${unescape(I)}" is not a valid destination.`)}}executeNamedAction(I){var g,o;switch(I){case"GoBack":(g=this.pdfHistory)==null||g.back();break;case"GoForward":(o=this.pdfHistory)==null||o.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:I})}cachePageRef(I,g){if(!g)return;const o=g.gen===0?`${g.num}R`:`${g.num}R${g.gen}`;R(this,Z).set(o,I)}_cachedPageNumber(I){if(!I)return null;const g=I.gen===0?`${I.num}R`:`${I.num}R${I.gen}`;return R(this,Z).get(g)||null}isPageVisible(I){return this.pdfViewer.isPageVisible(I)}isPageCached(I){return this.pdfViewer.isPageCached(I)}};let a=Y;Z=new WeakMap,p=new WeakSet,j=function(I,g=null,o){const X=o[0];let b;if(typeof X=="object"&&X!==null){if(b=this._cachedPageNumber(X),!b){this.pdfDocument.getPageIndex(X).then(N=>{this.cachePageRef(N+1,X),bI(this,p,j).call(this,I,g,o)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${X}" is not a valid page reference, for dest="${I}".`)});return}}else if(Number.isInteger(X))b=X+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${X}" is not a valid destination reference, for dest="${I}".`);return}if(!b||b<1||b>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${b}" is not a valid page number, for dest="${I}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:g,explicitDest:o,pageNumber:b})),this.pdfViewer.scrollPageIntoView({pageNumber:b,destArray:o,ignoreDestinationZoom:this._ignoreDestinationZoom})},D=new WeakSet,m=function(I){if(!Array.isArray(I))return!1;const g=I.length;if(g<2)return!1;const o=I[0];if(!(typeof o=="object"&&Number.isInteger(o.num)&&Number.isInteger(o.gen))&&!(Number.isInteger(o)&&o>=0))return!1;const X=I[1];if(!(typeof X=="object"&&typeof X.name=="string"))return!1;let b=!0;switch(X.name){case"XYZ":if(g!==5)return!1;break;case"Fit":case"FitB":return g===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(g!==3)return!1;break;case"FitR":if(g!==6)return!1;b=!1;break;default:return!1}for(let N=2;N<g;N++){const F=I[N];if(!(typeof F=="number"||b&&F===null))return!1}return!0},GI(a,D),T.PDFLinkService=a;class i{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(g){}get rotation(){return 0}set rotation(g){}async goToDestination(g){}goToPage(g){}addLinkAttributes(g,o,X=!1){B(g,{url:o,enabled:this.externalLinkEnabled})}getDestinationHash(g){return"#"}getAnchorUrl(g){return"#"}setHash(g){}executeNamedAction(g){}cachePageRef(g,o){}isPageVisible(g){return!0}isPageCached(g){return!0}}T.SimpleLinkService=i},(z,T)=>{var r,Z,p;Object.defineProperty(T,"__esModule",{value:!0}),T.animationStarted=T.VERTICAL_PADDING=T.UNKNOWN_SCALE=T.TextLayerMode=T.SpreadMode=T.SidebarView=T.ScrollMode=T.SCROLLBAR_PADDING=T.RenderingStates=T.RendererType=T.ProgressBar=T.PresentationModeState=T.OutputScale=T.MIN_SCALE=T.MAX_SCALE=T.MAX_AUTO_SCALE=T.DEFAULT_SCALE_VALUE=T.DEFAULT_SCALE_DELTA=T.DEFAULT_SCALE=T.AutoPrintRegExp=void 0,T.apiPageLayoutToViewerModes=uI,T.apiPageModeToSidebarView=MI,T.approximateFraction=NI,T.backtrackBeforeAllVisibleElements=e,T.binarySearchFirstItem=mI,T.docStyle=void 0,T.getActiveOrFocusedElement=lI,T.getPageSizeInches=J,T.getVisibleElements=w,T.isPortraitOrientation=A,T.isValidRotation=iI,T.isValidScrollMode=aI,T.isValidSpreadMode=eI,T.noContextMenuHandler=x,T.normalizeWheelEventDelta=P,T.normalizeWheelEventDirection=E,T.parseQueryString=gI,T.removeNullCharacters=q,T.roundToDivide=BI,T.scrollIntoView=YI,T.watchScroll=nI;const j="auto";T.DEFAULT_SCALE_VALUE=j;const D=1;T.DEFAULT_SCALE=D;const m=1.1;T.DEFAULT_SCALE_DELTA=m;const d=.1;T.MIN_SCALE=d;const C=10;T.MAX_SCALE=C;const l=0;T.UNKNOWN_SCALE=l;const B=1.25;T.MAX_AUTO_SCALE=B;const Y=40;T.SCROLLBAR_PADDING=Y;const a=5;T.VERTICAL_PADDING=a;const i={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};T.RenderingStates=i;const I={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};T.PresentationModeState=I;const g={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};T.SidebarView=g;const o={CANVAS:"canvas",SVG:"svg"};T.RendererType=o;const X={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};T.TextLayerMode=X;const b={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};T.ScrollMode=b;const N={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};T.SpreadMode=N;const F=/\bprint\s*\(/;T.AutoPrintRegExp=F;class hI{constructor(){const WI=window.devicePixelRatio||1;this.sx=WI,this.sy=WI}get scaled(){return this.sx!==1||this.sy!==1}}T.OutputScale=hI;function YI(ZI,WI,tI=!1){let O=ZI.offsetParent;if(!O){console.error("offsetParent is not set -- cannot scroll");return}let f=ZI.offsetTop+ZI.clientTop,v=ZI.offsetLeft+ZI.clientLeft;for(;O.clientHeight===O.scrollHeight&&O.clientWidth===O.scrollWidth||tI&&(O.classList.contains("markedContent")||getComputedStyle(O).overflow==="hidden");)if(f+=O.offsetTop,v+=O.offsetLeft,O=O.offsetParent,!O)return;WI&&(WI.top!==void 0&&(f+=WI.top),WI.left!==void 0&&(v+=WI.left,O.scrollLeft=v)),O.scrollTop=f}function nI(ZI,WI){const tI=function(v){f||(f=window.requestAnimationFrame(function(){f=null;const RI=ZI.scrollLeft,pI=O.lastX;RI!==pI&&(O.right=RI>pI),O.lastX=RI;const DI=ZI.scrollTop,FI=O.lastY;DI!==FI&&(O.down=DI>FI),O.lastY=DI,WI(O)}))},O={right:!0,down:!0,lastX:ZI.scrollLeft,lastY:ZI.scrollTop,_eventHandler:tI};let f=null;return ZI.addEventListener("scroll",tI,!0),O}function gI(ZI){const WI=new Map;for(const[tI,O]of new URLSearchParams(ZI))WI.set(tI.toLowerCase(),O);return WI}const U=/\x00/g,II=/[\x01-\x1F]/g;function q(ZI,WI=!1){return typeof ZI!="string"?(console.error("The argument must be a string."),ZI):(WI&&(ZI=ZI.replace(II," ")),ZI.replace(U,""))}function mI(ZI,WI,tI=0){let O=tI,f=ZI.length-1;if(f<0||!WI(ZI[f]))return ZI.length;if(WI(ZI[O]))return O;for(;O<f;){const v=O+f>>1,RI=ZI[v];WI(RI)?f=v:O=v+1}return O}function NI(ZI){if(Math.floor(ZI)===ZI)return[ZI,1];const WI=1/ZI,tI=8;if(WI>tI)return[1,tI];if(Math.floor(WI)===WI)return[1,WI];const O=ZI>1?WI:ZI;let f=0,v=1,RI=1,pI=1;for(;;){const FI=f+RI,TI=v+pI;if(TI>tI)break;O<=FI/TI?(RI=FI,pI=TI):(f=FI,v=TI)}let DI;return O-f/v<RI/pI-O?DI=O===ZI?[f,v]:[v,f]:DI=O===ZI?[RI,pI]:[pI,RI],DI}function BI(ZI,WI){const tI=ZI%WI;return tI===0?ZI:Math.round(ZI-tI+WI)}function J({view:ZI,userUnit:WI,rotate:tI}){const[O,f,v,RI]=ZI,pI=tI%180!==0,DI=(v-O)/72*WI,FI=(RI-f)/72*WI;return{width:pI?FI:DI,height:pI?DI:FI}}function e(ZI,WI,tI){if(ZI<2)return ZI;let O=WI[ZI].div,f=O.offsetTop+O.clientTop;f>=tI&&(O=WI[ZI-1].div,f=O.offsetTop+O.clientTop);for(let v=ZI-2;v>=0&&(O=WI[v].div,!(O.offsetTop+O.clientTop+O.clientHeight<=f));--v)ZI=v;return ZI}function w({scrollEl:ZI,views:WI,sortByVisibility:tI=!1,horizontal:O=!1,rtl:f=!1}){const v=ZI.scrollTop,RI=v+ZI.clientHeight,pI=ZI.scrollLeft,DI=pI+ZI.clientWidth;function FI(HI){const cI=HI.div;return cI.offsetTop+cI.clientTop+cI.clientHeight>v}function TI(HI){const cI=HI.div,CI=cI.offsetLeft+cI.clientLeft,AI=CI+cI.clientWidth;return f?CI<DI:AI>pI}const vI=[],fI=new Set,PI=WI.length;let EI=mI(WI,O?TI:FI);EI>0&&EI<PI&&!O&&(EI=e(EI,WI,v));let SI=O?DI:-1;for(let HI=EI;HI<PI;HI++){const cI=WI[HI],CI=cI.div,AI=CI.offsetLeft+CI.clientLeft,KI=CI.offsetTop+CI.clientTop,LI=CI.clientWidth,rI=CI.clientHeight,kI=AI+LI,xI=KI+rI;if(SI===-1)xI>=RI&&(SI=xI);else if((O?AI:KI)>SI)break;if(xI<=v||KI>=RI||kI<=pI||AI>=DI)continue;const _I=Math.max(0,v-KI)+Math.max(0,xI-RI),$I=Math.max(0,pI-AI)+Math.max(0,kI-DI),OI=(rI-_I)/rI,gg=(LI-$I)/LI,Ig=OI*gg*100|0;vI.push({id:cI.id,x:AI,y:KI,view:cI,percent:Ig,widthPercent:gg*100|0}),fI.add(cI.id)}const JI=vI[0],yI=vI.at(-1);return tI&&vI.sort(function(HI,cI){const CI=HI.percent-cI.percent;return Math.abs(CI)>.001?-CI:HI.id-cI.id}),{first:JI,last:yI,views:vI,ids:fI}}function x(ZI){ZI.preventDefault()}function E(ZI){let WI=Math.hypot(ZI.deltaX,ZI.deltaY);const tI=Math.atan2(ZI.deltaY,ZI.deltaX);return-.25*Math.PI<tI&&tI<.75*Math.PI&&(WI=-WI),WI}function P(ZI){let WI=E(ZI);const tI=0,O=1,f=30,v=30;return ZI.deltaMode===tI?WI/=f*v:ZI.deltaMode===O&&(WI/=v),WI}function iI(ZI){return Number.isInteger(ZI)&&ZI%90===0}function aI(ZI){return Number.isInteger(ZI)&&Object.values(b).includes(ZI)&&ZI!==b.UNKNOWN}function eI(ZI){return Number.isInteger(ZI)&&Object.values(N).includes(ZI)&&ZI!==N.UNKNOWN}function A(ZI){return ZI.width<=ZI.height}const W=new Promise(function(ZI){window.requestAnimationFrame(ZI)});T.animationStarted=W;const L=document.documentElement.style;T.docStyle=L;function S(ZI,WI,tI){return Math.min(Math.max(ZI,WI),tI)}class Q{constructor(WI){if(GI(this,r,null),GI(this,Z,0),GI(this,p,!0),arguments.length>1)throw new Error("ProgressBar no longer accepts any additional options, please use CSS rules to modify its appearance instead.");const tI=document.getElementById(WI);XI(this,r,tI.classList)}get percent(){return R(this,Z)}set percent(WI){if(XI(this,Z,S(WI,0,100)),isNaN(WI)){R(this,r).add("indeterminate");return}R(this,r).remove("indeterminate"),L.setProperty("--progressBar-percent",`${R(this,Z)}%`)}setWidth(WI){if(!WI)return;const tI=WI.parentNode.offsetWidth-WI.offsetWidth;tI>0&&L.setProperty("--progressBar-end-offset",`${tI}px`)}hide(){R(this,p)&&(XI(this,p,!1),R(this,r).add("hidden"))}show(){R(this,p)||(XI(this,p,!0),R(this,r).remove("hidden"))}}r=new WeakMap,Z=new WeakMap,p=new WeakMap,T.ProgressBar=Q;function lI(){let ZI=document,WI=ZI.activeElement||ZI.querySelector(":focus");for(;WI!=null&&WI.shadowRoot;)ZI=WI.shadowRoot,WI=ZI.activeElement||ZI.querySelector(":focus");return WI}function uI(ZI){let WI=b.VERTICAL,tI=N.NONE;switch(ZI){case"SinglePage":WI=b.PAGE;break;case"OneColumn":break;case"TwoPageLeft":WI=b.PAGE;case"TwoColumnLeft":tI=N.ODD;break;case"TwoPageRight":WI=b.PAGE;case"TwoColumnRight":tI=N.EVEN;break}return{scrollMode:WI,spreadMode:tI}}function MI(ZI){switch(ZI){case"UseNone":return g.NONE;case"UseThumbs":return g.THUMBS;case"UseOutlines":return g.OUTLINE;case"UseAttachments":return g.ATTACHMENTS;case"UseOC":return g.LAYERS}return g.NONE}},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.StructTreeLayerBuilder=void 0;const r={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Z=/^H(\d+)$/;class p{constructor({pdfPage:D}){this.pdfPage=D}render(D){return this._walk(D)}_setAttributes(D,m){D.alt!==void 0&&m.setAttribute("aria-label",D.alt),D.id!==void 0&&m.setAttribute("aria-owns",D.id),D.lang!==void 0&&m.setAttribute("lang",D.lang)}_walk(D){if(!D)return null;const m=document.createElement("span");if("role"in D){const{role:d}=D,C=d.match(Z);C?(m.setAttribute("role","heading"),m.setAttribute("aria-level",C[1])):r[d]&&m.setAttribute("role",r[d])}if(this._setAttributes(D,m),D.children)if(D.children.length===1&&"id"in D.children[0])this._setAttributes(D.children[0],m);else for(const d of D.children)m.append(this._walk(d));return m}}T.StructTreeLayerBuilder=p},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.TextLayerBuilder=void 0;var Z=r(3);const p=300;class j{constructor({textLayerDiv:m,eventBus:d,pageIndex:C,viewport:l,highlighter:B=null,enhanceTextSelection:Y=!1,accessibilityManager:a=null}){this.textLayerDiv=m,this.eventBus=d,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=C+1,this.viewport=l,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=B,this.enhanceTextSelection=Y,this.accessibilityManager=a,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const m=document.createElement("div");m.className="endOfContent",this.textLayerDiv.append(m)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(m=0){var d,C;if(!(this.textContent||this.textContentStream)||this.renderingDone)return;this.cancel(),this.textDivs.length=0,(d=this.highlighter)==null||d.setTextMapping(this.textDivs,this.textContentItemsStr),(C=this.accessibilityManager)==null||C.setTextMapping(this.textDivs);const l=document.createDocumentFragment();this.textLayerRenderTask=(0,Z.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:l,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:m,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then(()=>{var B,Y;this.textLayerDiv.append(l),this._finishRendering(),(B=this.highlighter)==null||B.enable(),(Y=this.accessibilityManager)==null||Y.enable()},function(B){})}cancel(){var m,d;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),(m=this.highlighter)==null||m.disable(),(d=this.accessibilityManager)==null||d.disable()}setTextContentStream(m){this.cancel(),this.textContentStream=m}setTextContent(m){this.cancel(),this.textContent=m}_bindMouse(){const m=this.textLayerDiv;let d=null;m.addEventListener("mousedown",C=>{if(this.enhanceTextSelection&&this.textLayerRenderTask){this.textLayerRenderTask.expandTextDivs(!0),d&&(clearTimeout(d),d=null);return}const l=m.querySelector(".endOfContent");if(!l)return;let B=C.target!==m;if(B=B&&window.getComputedStyle(l).getPropertyValue("-moz-user-select")!=="none",B){const Y=m.getBoundingClientRect(),a=Math.max(0,(C.pageY-Y.top)/Y.height);l.style.top=(a*100).toFixed(2)+"%"}l.classList.add("active")}),m.addEventListener("mouseup",()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask){d=setTimeout(()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),d=null},p);return}const C=m.querySelector(".endOfContent");C&&(C.style.top="",C.classList.remove("active"))})}}T.TextLayerBuilder=j},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.XfaLayerBuilder=void 0;var Z=r(3);class p{constructor({pageDiv:D,pdfPage:m,annotationStorage:d=null,linkService:C,xfaHtml:l=null}){this.pageDiv=D,this.pdfPage=m,this.annotationStorage=d,this.linkService=C,this.xfaHtml=l,this.div=null,this._cancelled=!1}render(D,m="display"){if(m==="print"){const d={viewport:D.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:m},C=document.createElement("div");this.pageDiv.append(C),d.div=C;const l=Z.XfaLayer.render(d);return Promise.resolve(l)}return this.pdfPage.getXfa().then(d=>{if(this._cancelled||!d)return{textDivs:[]};const C={viewport:D.clone({dontFlip:!0}),div:this.div,xfaHtml:d,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:m};return this.div?Z.XfaLayer.update(C):(this.div=document.createElement("div"),this.pageDiv.append(this.div),C.div=this.div,Z.XfaLayer.render(C))}).catch(d=>{console.error(d)})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}T.XfaLayerBuilder=p},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.PDFViewer=T.PDFSinglePageViewer=void 0;var Z=r(7),p=r(12);class j extends p.BaseViewer{}T.PDFViewer=j;class D extends p.BaseViewer{_resetView(){super._resetView(),this._scrollMode=Z.ScrollMode.PAGE,this._spreadMode=Z.SpreadMode.NONE}set scrollMode(d){}_updateScrollMode(){}set spreadMode(d){}_updateSpreadMode(){}}T.PDFSinglePageViewer=D},(z,T,r)=>{var Z,p,j,D,m,d,C,l,B,Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI,NI,BI,J;Object.defineProperty(T,"__esModule",{value:!0}),T.PagesCountLimit=T.PDFPageViewBuffer=T.BaseViewer=void 0;var e=r(3),w=r(7),x=r(2),E=r(5),P=r(4),iI=r(13),aI=r(16),eI=r(6),A=r(8),W=r(17),L=r(9),S=r(10);const Q=10,lI="enablePermissions",uI={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};T.PagesCountLimit=uI;function MI(O){return Object.values(e.AnnotationEditorType).includes(O)&&O!==e.AnnotationEditorType.DISABLE}class ZI{constructor(f){GI(this,j),GI(this,Z,new Set),GI(this,p,0),XI(this,p,f)}push(f){const v=R(this,Z);v.has(f)&&v.delete(f),v.add(f),v.size>R(this,p)&&bI(this,j,D).call(this)}resize(f,v=null){XI(this,p,f);const RI=R(this,Z);if(v){const pI=RI.size;let DI=1;for(const FI of RI)if(v.has(FI.id)&&(RI.delete(FI),RI.add(FI)),++DI>pI)break}for(;RI.size>R(this,p);)bI(this,j,D).call(this)}has(f){return R(this,Z).has(f)}[Symbol.iterator](){return R(this,Z).keys()}}Z=new WeakMap,p=new WeakMap,j=new WeakSet,D=function(){const O=R(this,Z).keys().next().value;O==null||O.destroy(),R(this,Z).delete(O)},T.PDFPageViewBuffer=ZI;const WI=class{constructor(O){GI(this,I),GI(this,o),GI(this,b),GI(this,F),GI(this,YI),GI(this,gI),GI(this,II),GI(this,mI),GI(this,BI),GI(this,m,null),GI(this,d,e.AnnotationEditorType.DISABLE),GI(this,C,null),GI(this,l,e.AnnotationMode.ENABLE_FORMS),GI(this,B,!1),GI(this,Y,0),GI(this,a,null),GI(this,i,null);var f,v;if(this.constructor===WI)throw new Error("Cannot initialize BaseViewer.");const RI="2.16.105";if(e.version!==RI)throw new Error(`The API version "${e.version}" does not match the Viewer version "${RI}".`);if(this.container=O.container,this.viewer=O.viewer||O.container.firstElementChild,!(((f=this.container)==null?void 0:f.tagName.toUpperCase())==="DIV"&&((v=this.viewer)==null?void 0:v.tagName.toUpperCase())==="DIV"))throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.eventBus=O.eventBus,this.linkService=O.linkService||new eI.SimpleLinkService,this.downloadManager=O.downloadManager||null,this.findController=O.findController||null,this._scriptingManager=O.scriptingManager||null,this.removePageBorders=O.removePageBorders||!1,this.textLayerMode=O.textLayerMode??w.TextLayerMode.ENABLE,XI(this,l,O.annotationMode??e.AnnotationMode.ENABLE_FORMS),XI(this,d,O.annotationEditorMode??e.AnnotationEditorType.DISABLE),this.imageResourcesPath=O.imageResourcesPath||"",this.enablePrintAutoRotate=O.enablePrintAutoRotate||!1,this.renderer=O.renderer||w.RendererType.CANVAS,this.useOnlyCssZoom=O.useOnlyCssZoom||!1,this.maxCanvasPixels=O.maxCanvasPixels,this.l10n=O.l10n||P.NullL10n,XI(this,B,O.enablePermissions||!1),this.pageColors=O.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("BaseViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!O.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new aI.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=O.renderingQueue,this.scroll=(0,w.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=w.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.updateContainerHeightCss()}get pagesCount(){return this._pages.length}getPageView(O){return this._pages[O]}get pageViewsReady(){return this._pagesCapability.settled?this._pages.every(function(O){return O==null?void 0:O.pdfPage}):!1}get renderForms(){return R(this,l)===e.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(O){if(!Number.isInteger(O))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(O,!0)||console.error(`currentPageNumber: "${O}" is not a valid page.`))}_setCurrentPageNumber(O,f=!1){var v;if(this._currentPageNumber===O)return f&&bI(this,gI,U).call(this),!0;if(!(0<O&&O<=this.pagesCount))return!1;const RI=this._currentPageNumber;return this._currentPageNumber=O,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:O,pageLabel:((v=this._pageLabels)==null?void 0:v[O-1])??null,previous:RI}),f&&bI(this,gI,U).call(this),!0}get currentPageLabel(){var O;return((O=this._pageLabels)==null?void 0:O[this._currentPageNumber-1])??null}set currentPageLabel(O){if(!this.pdfDocument)return;let f=O|0;if(this._pageLabels){const v=this._pageLabels.indexOf(O);v>=0&&(f=v+1)}this._setCurrentPageNumber(f,!0)||console.error(`currentPageLabel: "${O}" is not a valid page.`)}get currentScale(){return this._currentScale!==w.UNKNOWN_SCALE?this._currentScale:w.DEFAULT_SCALE}set currentScale(O){if(isNaN(O))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(O,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(O){this.pdfDocument&&this._setScale(O,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(O){if(!(0,w.isValidRotation)(O))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(O%=360,O<0&&(O+=360),this._pagesRotation===O))return;this._pagesRotation=O;const f=this._currentPageNumber,v={rotation:O};for(const RI of this._pages)RI.update(v);this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:O,pageNumber:f}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}setDocument(O){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null),R(this,C)&&(R(this,C).destroy(),XI(this,C,null))),this.pdfDocument=O,!O)return;const f=O.isPureXfa,v=O.numPages,RI=O.getPage(1),pI=O.getOptionalContentConfig(),DI=R(this,B)?O.getPermissions():Promise.resolve();if(v>uI.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const FI=this._scrollMode=w.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:FI})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:v})},()=>{}),this._onBeforeDraw=FI=>{const TI=this._pages[FI.pageNumber-1];TI&&R(this,m).push(TI)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=FI=>{FI.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:FI.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,R(this,i)&&(document.removeEventListener("visibilitychange",R(this,i)),XI(this,i,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([RI,DI]).then(([FI,TI])=>{if(O!==this.pdfDocument)return;this._firstPageCapability.resolve(FI),this._optionalContentConfigPromise=pI;const{annotationEditorMode:vI,annotationMode:fI,textLayerMode:PI}=bI(this,I,g).call(this,TI);if(vI!==e.AnnotationEditorType.DISABLE){const KI=vI;f?console.warn("Warning: XFA-editing is not implemented."):MI(KI)?(XI(this,C,new e.AnnotationEditorUIManager(this.container,this.eventBus)),KI!==e.AnnotationEditorType.NONE&&R(this,C).updateMode(KI)):console.error(`Invalid AnnotationEditor mode: ${KI}`)}const EI=this._scrollMode===w.ScrollMode.PAGE?null:this.viewer,SI=this.currentScale,JI=FI.getViewport({scale:SI*e.PixelsPerInch.PDF_TO_CSS_UNITS}),yI=PI!==w.TextLayerMode.DISABLE&&!f?this:null,HI=fI!==e.AnnotationMode.DISABLE?this:null,cI=f?this:null,CI=R(this,C)?this:null;for(let KI=1;KI<=v;++KI){const LI=new iI.PDFPageView({container:EI,eventBus:this.eventBus,id:KI,scale:SI,defaultViewport:JI.clone(),optionalContentConfigPromise:pI,renderingQueue:this.renderingQueue,textLayerFactory:yI,textLayerMode:PI,annotationLayerFactory:HI,annotationMode:fI,xfaLayerFactory:cI,annotationEditorLayerFactory:CI,textHighlighterFactory:this,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n});this._pages.push(LI)}const AI=this._pages[0];AI&&(AI.setPdfPage(FI),this.linkService.cachePageRef(1,FI.ref)),this._scrollMode===w.ScrollMode.PAGE?bI(this,b,N).call(this):this._spreadMode!==w.SpreadMode.NONE&&this._updateSpreadMode(),bI(this,o,X).call(this).then(async()=>{if(this.findController&&this.findController.setDocument(O),this._scriptingManager&&this._scriptingManager.setDocument(O),R(this,C)&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:R(this,d)}),O.loadingParams.disableAutoFetch||v>uI.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let KI=v-1;if(KI<=0){this._pagesCapability.resolve();return}for(let LI=2;LI<=v;++LI){const rI=O.getPage(LI).then(kI=>{const xI=this._pages[LI-1];xI.pdfPage||xI.setPdfPage(kI),this.linkService.cachePageRef(LI,kI.ref),--KI===0&&this._pagesCapability.resolve()},kI=>{console.error(`Unable to get page ${LI} to initialize viewer`,kI),--KI===0&&this._pagesCapability.resolve()});LI%uI.PAUSE_EAGER_PAGE_INIT===0&&await rI}}),this.eventBus.dispatch("pagesinit",{source:this}),O.getMetadata().then(({info:KI})=>{O===this.pdfDocument&&KI.Language&&(this.viewer.lang=KI.Language)}),this.defaultRenderingQueue&&this.update()}).catch(FI=>{console.error("Unable to initialize viewer",FI),this._pagesCapability.reject(FI)})}setPageLabels(O){var f;if(this.pdfDocument){O?Array.isArray(O)&&this.pdfDocument.numPages===O.length?this._pageLabels=O:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let v=0,RI=this._pages.length;v<RI;v++)this._pages[v].setPageLabel(((f=this._pageLabels)==null?void 0:f[v])??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=w.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,XI(this,m,new ZI(Q)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,e.createPromiseCapability)(),this._onePageRenderedCapability=(0,e.createPromiseCapability)(),this._pagesCapability=(0,e.createPromiseCapability)(),this._scrollMode=w.ScrollMode.VERTICAL,this._previousScrollMode=w.ScrollMode.UNKNOWN,this._spreadMode=w.SpreadMode.NONE,XI(this,a,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),R(this,i)&&(document.removeEventListener("visibilitychange",R(this,i)),XI(this,i,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(lI)}_scrollUpdate(){this.pagesCount!==0&&this.update()}_setScaleUpdatePages(O,f,v=!1,RI=!1){if(this._currentScaleValue=f.toString(),bI(this,YI,nI).call(this,O)){RI&&this.eventBus.dispatch("scalechanging",{source:this,scale:O,presetValue:f});return}w.docStyle.setProperty("--scale-factor",O*e.PixelsPerInch.PDF_TO_CSS_UNITS);const pI={scale:O};for(const DI of this._pages)DI.update(pI);if(this._currentScale=O,!v){let DI=this._currentPageNumber,FI;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(DI=this._location.pageNumber,FI=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:DI,destArray:FI,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:O,presetValue:RI?f:void 0}),this.defaultRenderingQueue&&this.update(),this.updateContainerHeightCss()}get _pageWidthScaleFactor(){return this._spreadMode!==w.SpreadMode.NONE&&this._scrollMode!==w.ScrollMode.HORIZONTAL?2:1}_setScale(O,f=!1){let v=parseFloat(O);if(v>0)this._setScaleUpdatePages(v,O,f,!1);else{const RI=this._pages[this._currentPageNumber-1];if(!RI)return;let pI=w.SCROLLBAR_PADDING,DI=w.VERTICAL_PADDING;this.isInPresentationMode?pI=DI=4:this.removePageBorders?pI=DI=0:this._scrollMode===w.ScrollMode.HORIZONTAL&&([pI,DI]=[DI,pI]);const FI=(this.container.clientWidth-pI)/RI.width*RI.scale/this._pageWidthScaleFactor,TI=(this.container.clientHeight-DI)/RI.height*RI.scale;switch(O){case"page-actual":v=1;break;case"page-width":v=FI;break;case"page-height":v=TI;break;case"page-fit":v=Math.min(FI,TI);break;case"auto":const vI=(0,w.isPortraitOrientation)(RI)?FI:Math.min(TI,FI);v=Math.min(w.MAX_AUTO_SCALE,vI);break;default:console.error(`_setScale: "${O}" is an unknown zoom value.`);return}this._setScaleUpdatePages(v,O,f,!0)}}pageLabelToPageNumber(O){if(!this._pageLabels)return null;const f=this._pageLabels.indexOf(O);return f<0?null:f+1}scrollPageIntoView({pageNumber:O,destArray:f=null,allowNegativeOffset:v=!1,ignoreDestinationZoom:RI=!1}){if(!this.pdfDocument)return;const pI=Number.isInteger(O)&&this._pages[O-1];if(!pI){console.error(`scrollPageIntoView: "${O}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!f){this._setCurrentPageNumber(O,!0);return}let DI=0,FI=0,TI=0,vI=0,fI,PI;const EI=pI.rotation%180!==0,SI=(EI?pI.height:pI.width)/pI.scale/e.PixelsPerInch.PDF_TO_CSS_UNITS,JI=(EI?pI.width:pI.height)/pI.scale/e.PixelsPerInch.PDF_TO_CSS_UNITS;let yI=0;switch(f[1].name){case"XYZ":DI=f[2],FI=f[3],yI=f[4],DI=DI!==null?DI:0,FI=FI!==null?FI:JI;break;case"Fit":case"FitB":yI="page-fit";break;case"FitH":case"FitBH":FI=f[2],yI="page-width",FI===null&&this._location?(DI=this._location.left,FI=this._location.top):(typeof FI!="number"||FI<0)&&(FI=JI);break;case"FitV":case"FitBV":DI=f[2],TI=SI,vI=JI,yI="page-height";break;case"FitR":DI=f[2],FI=f[3],TI=f[4]-DI,vI=f[5]-FI;const AI=this.removePageBorders?0:w.SCROLLBAR_PADDING,KI=this.removePageBorders?0:w.VERTICAL_PADDING;fI=(this.container.clientWidth-AI)/TI/e.PixelsPerInch.PDF_TO_CSS_UNITS,PI=(this.container.clientHeight-KI)/vI/e.PixelsPerInch.PDF_TO_CSS_UNITS,yI=Math.min(Math.abs(fI),Math.abs(PI));break;default:console.error(`scrollPageIntoView: "${f[1].name}" is not a valid destination type.`);return}if(RI||(yI&&yI!==this._currentScale?this.currentScaleValue=yI:this._currentScale===w.UNKNOWN_SCALE&&(this.currentScaleValue=w.DEFAULT_SCALE_VALUE)),yI==="page-fit"&&!f[4]){bI(this,F,hI).call(this,pI);return}const HI=[pI.viewport.convertToViewportPoint(DI,FI),pI.viewport.convertToViewportPoint(DI+TI,FI+vI)];let cI=Math.min(HI[0][0],HI[1][0]),CI=Math.min(HI[0][1],HI[1][1]);v||(cI=Math.max(cI,0),CI=Math.max(CI,0)),bI(this,F,hI).call(this,pI,{left:cI,top:CI})}_updateLocation(O){const f=this._currentScale,v=this._currentScaleValue,RI=parseFloat(v)===f?Math.round(f*1e4)/100:v,pI=O.id,DI=this._pages[pI-1],FI=this.container,TI=DI.getPagePoint(FI.scrollLeft-O.x,FI.scrollTop-O.y),vI=Math.round(TI[0]),fI=Math.round(TI[1]);let PI=`#page=${pI}`;this.isInPresentationMode||(PI+=`&zoom=${RI},${vI},${fI}`),this._location={pageNumber:pI,scale:RI,top:fI,left:vI,rotation:this._pagesRotation,pdfOpenParams:PI}}update(){const O=this._getVisiblePages(),f=O.views,v=f.length;if(v===0)return;const RI=Math.max(Q,2*v+1);R(this,m).resize(RI,O.ids),this.renderingQueue.renderHighestPriority(O);const pI=this._spreadMode===w.SpreadMode.NONE&&(this._scrollMode===w.ScrollMode.PAGE||this._scrollMode===w.ScrollMode.VERTICAL),DI=this._currentPageNumber;let FI=!1;for(const TI of f){if(TI.percent<100)break;if(TI.id===DI&&pI){FI=!0;break}}this._setCurrentPageNumber(FI?DI:f[0].id),this._updateLocation(O.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(O){return this.container.contains(O)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===w.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===w.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const O=this._scrollMode===w.ScrollMode.PAGE?R(this,a).pages:this._pages,f=this._scrollMode===w.ScrollMode.HORIZONTAL,v=f&&this._isContainerRtl;return(0,w.getVisibleElements)({scrollEl:this.container,views:O,sortByVisibility:!0,horizontal:f,rtl:v})}isPageVisible(O){return this.pdfDocument?Number.isInteger(O)&&O>0&&O<=this.pagesCount?this._getVisiblePages().ids.has(O):(console.error(`isPageVisible: "${O}" is not a valid page.`),!1):!1}isPageCached(O){if(!this.pdfDocument)return!1;if(!(Number.isInteger(O)&&O>0&&O<=this.pagesCount))return console.error(`isPageCached: "${O}" is not a valid page.`),!1;const f=this._pages[O-1];return R(this,m).has(f)}cleanup(){for(const O of this._pages)O.renderingState!==w.RenderingStates.FINISHED&&O.reset()}_cancelRendering(){for(const O of this._pages)O.cancelRendering()}forceRendering(O){const f=O||this._getVisiblePages(),v=bI(this,mI,NI).call(this,f),RI=this._spreadMode!==w.SpreadMode.NONE&&this._scrollMode!==w.ScrollMode.HORIZONTAL,pI=this.renderingQueue.getHighestPriority(f,this._pages,v,RI);return bI(this,BI,J).call(this,f.ids),pI?(bI(this,II,q).call(this,pI).then(()=>{this.renderingQueue.renderView(pI)}),!0):!1}createTextLayerBuilder({textLayerDiv:O,pageIndex:f,viewport:v,enhanceTextSelection:RI=!1,eventBus:pI,highlighter:DI,accessibilityManager:FI=null}){return new L.TextLayerBuilder({textLayerDiv:O,eventBus:pI,pageIndex:f,viewport:v,enhanceTextSelection:this.isInPresentationMode?!1:RI,highlighter:DI,accessibilityManager:FI})}createTextHighlighter({pageIndex:O,eventBus:f}){return new W.TextHighlighter({eventBus:f,pageIndex:O,findController:this.isInPresentationMode?null:this.findController})}createAnnotationLayerBuilder({pageDiv:O,pdfPage:f,annotationStorage:v=(SI=>(SI=this.pdfDocument)==null?void 0:SI.annotationStorage)(),imageResourcesPath:RI="",renderForms:pI=!0,l10n:DI=P.NullL10n,enableScripting:FI=this.enableScripting,hasJSActionsPromise:TI=(SI=>(SI=this.pdfDocument)==null?void 0:SI.hasJSActions())(),mouseState:vI=(SI=>(SI=this._scriptingManager)==null?void 0:SI.mouseState)(),fieldObjectsPromise:fI=(SI=>(SI=this.pdfDocument)==null?void 0:SI.getFieldObjects())(),annotationCanvasMap:PI=null,accessibilityManager:EI=null}){return new E.AnnotationLayerBuilder({pageDiv:O,pdfPage:f,annotationStorage:v,imageResourcesPath:RI,renderForms:pI,linkService:this.linkService,downloadManager:this.downloadManager,l10n:DI,enableScripting:FI,hasJSActionsPromise:TI,mouseState:vI,fieldObjectsPromise:fI,annotationCanvasMap:PI,accessibilityManager:EI})}createAnnotationEditorLayerBuilder({uiManager:O=R(this,C),pageDiv:f,pdfPage:v,accessibilityManager:RI=null,l10n:pI,annotationStorage:DI=(FI=>(FI=this.pdfDocument)==null?void 0:FI.annotationStorage)()}){return new x.AnnotationEditorLayerBuilder({uiManager:O,pageDiv:f,pdfPage:v,annotationStorage:DI,accessibilityManager:RI,l10n:pI})}createXfaLayerBuilder({pageDiv:O,pdfPage:f,annotationStorage:v=(RI=>(RI=this.pdfDocument)==null?void 0:RI.annotationStorage)()}){return new S.XfaLayerBuilder({pageDiv:O,pdfPage:f,annotationStorage:v,linkService:this.linkService})}createStructTreeLayerBuilder({pdfPage:O}){return new A.StructTreeLayerBuilder({pdfPage:O})}get hasEqualPageSizes(){const O=this._pages[0];for(let f=1,v=this._pages.length;f<v;++f){const RI=this._pages[f];if(RI.width!==O.width||RI.height!==O.height)return!1}return!0}getPagesOverview(){return this._pages.map(O=>{const f=O.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,w.isPortraitOrientation)(f)?{width:f.width,height:f.height,rotation:f.rotation}:{width:f.height,height:f.width,rotation:(f.rotation-90)%360}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(O){if(!(O instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${O}`);if(!this.pdfDocument||!this._optionalContentConfigPromise)return;this._optionalContentConfigPromise=O;const f={optionalContentConfigPromise:O};for(const v of this._pages)v.update(f);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:O})}get scrollMode(){return this._scrollMode}set scrollMode(O){if(this._scrollMode!==O){if(!(0,w.isValidScrollMode)(O))throw new Error(`Invalid scroll mode: ${O}`);this.pagesCount>uI.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=O,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:O}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(O=null){const f=this._scrollMode,v=this.viewer;v.classList.toggle("scrollHorizontal",f===w.ScrollMode.HORIZONTAL),v.classList.toggle("scrollWrapped",f===w.ScrollMode.WRAPPED),!(!this.pdfDocument||!O)&&(f===w.ScrollMode.PAGE?bI(this,b,N).call(this):this._previousScrollMode===w.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(O,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(O){if(this._spreadMode!==O){if(!(0,w.isValidSpreadMode)(O))throw new Error(`Invalid spread mode: ${O}`);this._spreadMode=O,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:O}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(O=null){if(!this.pdfDocument)return;const f=this.viewer,v=this._pages;if(this._scrollMode===w.ScrollMode.PAGE)bI(this,b,N).call(this);else if(f.textContent="",this._spreadMode===w.SpreadMode.NONE)for(const RI of this._pages)f.append(RI.div);else{const RI=this._spreadMode-1;let pI=null;for(let DI=0,FI=v.length;DI<FI;++DI)pI===null?(pI=document.createElement("div"),pI.className="spread",f.append(pI)):DI%2===RI&&(pI=pI.cloneNode(!1),f.append(pI)),pI.append(v[DI].div)}O&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(O,!0),this.update())}_getPageAdvance(O,f=!1){switch(this._scrollMode){case w.ScrollMode.WRAPPED:{const{views:v}=this._getVisiblePages(),RI=new Map;for(const{id:pI,y:DI,percent:FI,widthPercent:TI}of v){if(FI===0||TI<100)continue;let vI=RI.get(DI);vI||RI.set(DI,vI||(vI=[])),vI.push(pI)}for(const pI of RI.values()){const DI=pI.indexOf(O);if(DI===-1)continue;const FI=pI.length;if(FI===1)break;if(f)for(let TI=DI-1,vI=0;TI>=vI;TI--){const fI=pI[TI],PI=pI[TI+1]-1;if(fI<PI)return O-PI}else for(let TI=DI+1,vI=FI;TI<vI;TI++){const fI=pI[TI],PI=pI[TI-1]+1;if(fI>PI)return PI-O}if(f){const TI=pI[0];if(TI<O)return O-TI+1}else{const TI=pI[FI-1];if(TI>O)return TI-O+1}break}break}case w.ScrollMode.HORIZONTAL:break;case w.ScrollMode.PAGE:case w.ScrollMode.VERTICAL:{if(this._spreadMode===w.SpreadMode.NONE)break;const v=this._spreadMode-1;if(f&&O%2!==v||!f&&O%2===v)break;const{views:RI}=this._getVisiblePages(),pI=f?O-1:O+1;for(const{id:DI,percent:FI,widthPercent:TI}of RI)if(DI===pI){if(FI>0&&TI===100)return 2;break}break}}return 1}nextPage(){const O=this._currentPageNumber,f=this.pagesCount;if(O>=f)return!1;const v=this._getPageAdvance(O,!1)||1;return this.currentPageNumber=Math.min(O+v,f),!0}previousPage(){const O=this._currentPageNumber;if(O<=1)return!1;const f=this._getPageAdvance(O,!0)||1;return this.currentPageNumber=Math.max(O-f,1),!0}increaseScale(O=1){let f=this._currentScale;do f=(f*w.DEFAULT_SCALE_DELTA).toFixed(2),f=Math.ceil(f*10)/10,f=Math.min(w.MAX_SCALE,f);while(--O>0&&f<w.MAX_SCALE);this.currentScaleValue=f}decreaseScale(O=1){let f=this._currentScale;do f=(f/w.DEFAULT_SCALE_DELTA).toFixed(2),f=Math.floor(f*10)/10,f=Math.max(w.MIN_SCALE,f);while(--O>0&&f>w.MIN_SCALE);this.currentScaleValue=f}updateContainerHeightCss(){const O=this.container.clientHeight;O!==R(this,Y)&&(XI(this,Y,O),w.docStyle.setProperty("--viewer-container-height",`${O}px`))}get annotationEditorMode(){return R(this,C)?R(this,d):e.AnnotationEditorType.DISABLE}set annotationEditorMode(O){if(!R(this,C))throw new Error("The AnnotationEditor is not enabled.");if(R(this,d)!==O){if(!MI(O))throw new Error(`Invalid AnnotationEditor mode: ${O}`);this.pdfDocument&&(XI(this,d,O),this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:O}),R(this,C).updateMode(O))}}set annotationEditorParams({type:O,value:f}){if(!R(this,C))throw new Error("The AnnotationEditor is not enabled.");R(this,C).updateParams(O,f)}refresh(){if(!this.pdfDocument)return;const O={};for(const f of this._pages)f.update(O);this.update()}};let tI=WI;m=new WeakMap,d=new WeakMap,C=new WeakMap,l=new WeakMap,B=new WeakMap,Y=new WeakMap,a=new WeakMap,i=new WeakMap,I=new WeakSet,g=function(O){const f={annotationEditorMode:R(this,d),annotationMode:R(this,l),textLayerMode:this.textLayerMode};return O&&(O.includes(e.PermissionFlag.COPY)||this.viewer.classList.add(lI),O.includes(e.PermissionFlag.MODIFY_CONTENTS)||(f.annotationEditorMode=e.AnnotationEditorType.DISABLE),!O.includes(e.PermissionFlag.MODIFY_ANNOTATIONS)&&!O.includes(e.PermissionFlag.FILL_INTERACTIVE_FORMS)&&R(this,l)===e.AnnotationMode.ENABLE_FORMS&&(f.annotationMode=e.AnnotationMode.ENABLE)),f},o=new WeakSet,X=function(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const O=new Promise(f=>{XI(this,i,()=>{document.visibilityState==="hidden"&&(f(),document.removeEventListener("visibilitychange",R(this,i)),XI(this,i,null))}),document.addEventListener("visibilitychange",R(this,i))});return Promise.race([this._onePageRenderedCapability.promise,O])},b=new WeakSet,N=function(){if(this._scrollMode!==w.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const O=this._currentPageNumber,f=R(this,a),v=this.viewer;if(v.textContent="",f.pages.length=0,this._spreadMode===w.SpreadMode.NONE&&!this.isInPresentationMode){const RI=this._pages[O-1];v.append(RI.div),f.pages.push(RI)}else{const RI=new Set,pI=this._spreadMode-1;pI===-1?RI.add(O-1):O%2!==pI?(RI.add(O-1),RI.add(O)):(RI.add(O-2),RI.add(O-1));const DI=document.createElement("div");if(DI.className="spread",this.isInPresentationMode){const FI=document.createElement("div");FI.className="dummyPage",DI.append(FI)}for(const FI of RI){const TI=this._pages[FI];TI&&(DI.append(TI.div),f.pages.push(TI))}v.append(DI)}f.scrollDown=O>=f.previousPageNumber,f.previousPageNumber=O},F=new WeakSet,hI=function(O,f=null){const{div:v,id:RI}=O;if(this._scrollMode===w.ScrollMode.PAGE&&(this._setCurrentPageNumber(RI),bI(this,b,N).call(this),this.update()),!f&&!this.isInPresentationMode){const pI=v.offsetLeft+v.clientLeft,DI=pI+v.clientWidth,{scrollLeft:FI,clientWidth:TI}=this.container;(this._scrollMode===w.ScrollMode.HORIZONTAL||pI<FI||DI>FI+TI)&&(f={left:0,top:0})}(0,w.scrollIntoView)(v,f)},YI=new WeakSet,nI=function(O){return O===this._currentScale||Math.abs(O-this._currentScale)<1e-15},gI=new WeakSet,U=function(){const O=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0),bI(this,F,hI).call(this,O)},II=new WeakSet,q=async function(O){var f,v;if(O.pdfPage)return O.pdfPage;try{const RI=await this.pdfDocument.getPage(O.id);return O.pdfPage||O.setPdfPage(RI),(v=(f=this.linkService)._cachedPageNumber)!=null&&v.call(f,RI.ref)||this.linkService.cachePageRef(O.id,RI.ref),RI}catch(RI){return console.error("Unable to get page for page view",RI),null}},mI=new WeakSet,NI=function(O){var f,v;if(((f=O.first)==null?void 0:f.id)===1)return!0;if(((v=O.last)==null?void 0:v.id)===this.pagesCount)return!1;switch(this._scrollMode){case w.ScrollMode.PAGE:return R(this,a).scrollDown;case w.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},BI=new WeakSet,J=function(O){for(const f of O){const v=this._pages[f-1];v==null||v.toggleLoadingIconSpinner(!0)}for(const f of R(this,m))O.has(f.id)||f.toggleLoadingIconSpinner(!1)},T.BaseViewer=tI},(z,T,r)=>{var Z,p;Object.defineProperty(T,"__esModule",{value:!0}),T.PDFPageView=void 0;var j=r(3),D=r(7),m=r(14),d=r(4),C=r(15);const l=m.compatibilityParams.maxCanvasPixels||16777216;class B{constructor(a){GI(this,Z,j.AnnotationMode.ENABLE_FORMS),GI(this,p,{initialOptionalContent:!0,regularAnnotations:!0});var i,I;const g=a.container,o=a.defaultViewport;this.id=a.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=a.scale||D.DEFAULT_SCALE,this.viewport=o,this.pdfPageRotate=o.rotation,this._optionalContentConfigPromise=a.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=a.textLayerMode??D.TextLayerMode.ENABLE,XI(this,Z,a.annotationMode??j.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=a.imageResourcesPath||"",this.useOnlyCssZoom=a.useOnlyCssZoom||!1,this.maxCanvasPixels=a.maxCanvasPixels||l,this.pageColors=a.pageColors||null,this.eventBus=a.eventBus,this.renderingQueue=a.renderingQueue,this.textLayerFactory=a.textLayerFactory,this.annotationLayerFactory=a.annotationLayerFactory,this.annotationEditorLayerFactory=a.annotationEditorLayerFactory,this.xfaLayerFactory=a.xfaLayerFactory,this.textHighlighter=(i=a.textHighlighterFactory)==null?void 0:i.createTextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus}),this.structTreeLayerFactory=a.structTreeLayerFactory,this.renderer=a.renderer||D.RendererType.CANVAS,this.l10n=a.l10n||d.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=D.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this._isStandalone=!((I=this.renderingQueue)!=null&&I.hasViewer()),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const X=document.createElement("div");if(X.className="page",X.style.width=Math.floor(this.viewport.width)+"px",X.style.height=Math.floor(this.viewport.height)+"px",X.setAttribute("data-page-number",this.id),X.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(b=>{X.setAttribute("aria-label",b)}),this.div=X,g==null||g.append(X),this._isStandalone){const{optionalContentConfigPromise:b}=a;b&&b.then(N=>{b===this._optionalContentConfigPromise&&(R(this,p).initialOptionalContent=N.hasInitialVisibility)})}}setPdfPage(a){this.pdfPage=a,this.pdfPageRotate=a.rotate;const i=(this.rotation+this.pdfPageRotate)%360;this.viewport=a.getViewport({scale:this.scale*j.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:i}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}async _renderAnnotationLayer(){let a=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(i){console.error(`_renderAnnotationLayer: "${i}".`),a=i}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:a})}}async _renderAnnotationEditorLayer(){let a=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(i){console.error(`_renderAnnotationEditorLayer: "${i}".`),a=i}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:a})}}async _renderXfaLayer(){let a=null;try{const i=await this.xfaLayer.render(this.viewport,"display");this.textHighlighter&&this._buildXfaTextContentItems(i.textDivs)}catch(i){console.error(`_renderXfaLayer: "${i}".`),a=i}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:a})}}async _buildXfaTextContentItems(a){const i=await this.pdfPage.getTextContent(),I=[];for(const g of i.items)I.push(g.str);this.textHighlighter.setTextMapping(a,I),this.textHighlighter.enable()}_resetZoomLayer(a=!1){if(!this.zoomLayer)return;const i=this.zoomLayer.firstChild;this.paintedViewportMap.delete(i),i.width=0,i.height=0,a&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:a=!1,keepAnnotationLayer:i=!1,keepAnnotationEditorLayer:I=!1,keepXfaLayer:g=!1}={}){var o,X,b,N;this.cancelRendering({keepAnnotationLayer:i,keepAnnotationEditorLayer:I,keepXfaLayer:g}),this.renderingState=D.RenderingStates.INITIAL;const F=this.div;F.style.width=Math.floor(this.viewport.width)+"px",F.style.height=Math.floor(this.viewport.height)+"px";const hI=F.childNodes,YI=a&&this.zoomLayer||null,nI=i&&((o=this.annotationLayer)==null?void 0:o.div)||null,gI=I&&((X=this.annotationEditorLayer)==null?void 0:X.div)||null,U=g&&((b=this.xfaLayer)==null?void 0:b.div)||null;for(let II=hI.length-1;II>=0;II--){const q=hI[II];switch(q){case YI:case nI:case gI:case U:continue}q.remove()}F.removeAttribute("data-loaded"),nI&&this.annotationLayer.hide(),gI?this.annotationEditorLayer.hide():(N=this.annotationEditorLayer)==null||N.destroy(),U&&this.xfaLayer.hide(),YI||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this._isStandalone&&this.toggleLoadingIconSpinner(!0),this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then(II=>{var q;(q=this.loadingIconDiv)==null||q.setAttribute("aria-label",II)}),F.append(this.loadingIconDiv)}update({scale:a=0,rotation:i=null,optionalContentConfigPromise:I=null}){this.scale=a||this.scale,typeof i=="number"&&(this.rotation=i),I instanceof Promise&&(this._optionalContentConfigPromise=I,I.then(X=>{I===this._optionalContentConfigPromise&&(R(this,p).initialOptionalContent=X.hasInitialVisibility)}));const g=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*j.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:g}),this._isStandalone&&D.docStyle.setProperty("--scale-factor",this.viewport.scale),this.svg){this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}let o=!1;if(this.canvas&&this.maxCanvasPixels>0){const X=this.outputScale;(Math.floor(this.viewport.width)*X.sx|0)*(Math.floor(this.viewport.height)*X.sy|0)>this.maxCanvasPixels&&(o=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&o){this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer:a=!1,keepAnnotationEditorLayer:i=!1,keepXfaLayer:I=!1}={}){var g;this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!a||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!i||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!I||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(g=this.textHighlighter)==null||g.disable()),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target:a,redrawAnnotationLayer:i=!1,redrawAnnotationEditorLayer:I=!1,redrawXfaLayer:g=!1}){const o=this.viewport.width,X=this.viewport.height,b=this.div;a.style.width=a.parentNode.style.width=b.style.width=Math.floor(o)+"px",a.style.height=a.parentNode.style.height=b.style.height=Math.floor(X)+"px";const N=this.viewport.rotation-this.paintedViewportMap.get(a).rotation,F=Math.abs(N);let hI=1,YI=1;if((F===90||F===270)&&(hI=X/o,YI=o/X),a.style.transform=`rotate(${N}deg) scale(${hI}, ${YI})`,this.textLayer){const nI=this.textLayer.viewport,gI=this.viewport.rotation-nI.rotation,U=Math.abs(gI);let II=o/nI.width;(U===90||U===270)&&(II=o/nI.height);const q=this.textLayer.textLayerDiv;let mI,NI;switch(U){case 0:mI=NI=0;break;case 90:mI=0,NI="-"+q.style.height;break;case 180:mI="-"+q.style.width,NI="-"+q.style.height;break;case 270:mI="-"+q.style.width,NI=0;break;default:console.error("Bad rotation value.");break}q.style.transform=`rotate(${U}deg) scale(${II}) translate(${mI}, ${NI})`,q.style.transformOrigin="0% 0%"}i&&this.annotationLayer&&this._renderAnnotationLayer(),I&&this.annotationEditorLayer&&this._renderAnnotationEditorLayer(),g&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(a,i){return this.viewport.convertToPdfPoint(a,i)}toggleLoadingIconSpinner(a=!1){var i;(i=this.loadingIconDiv)==null||i.classList.toggle("notVisible",!a)}draw(){var a,i,I;this.renderingState!==D.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:g,pdfPage:o}=this;if(!o)return this.renderingState=D.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=D.RenderingStates.RUNNING;const X=document.createElement("div");X.style.width=g.style.width,X.style.height=g.style.height,X.classList.add("canvasWrapper");const b=((a=this.annotationLayer)==null?void 0:a.div)||((i=this.annotationEditorLayer)==null?void 0:i.div);b?b.before(X):g.append(X);let N=null;if(this.textLayerMode!==D.TextLayerMode.DISABLE&&this.textLayerFactory){this._accessibilityManager||(this._accessibilityManager=new C.TextAccessibilityManager);const gI=document.createElement("div");gI.className="textLayer",gI.style.width=X.style.width,gI.style.height=X.style.height,b?b.before(gI):g.append(gI),N=this.textLayerFactory.createTextLayerBuilder({textLayerDiv:gI,pageIndex:this.id-1,viewport:this.viewport,enhanceTextSelection:this.textLayerMode===D.TextLayerMode.ENABLE_ENHANCE,eventBus:this.eventBus,highlighter:this.textHighlighter,accessibilityManager:this._accessibilityManager})}this.textLayer=N,R(this,Z)!==j.AnnotationMode.DISABLE&&this.annotationLayerFactory&&(this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer||(this.annotationLayer=this.annotationLayerFactory.createAnnotationLayerBuilder({pageDiv:g,pdfPage:o,imageResourcesPath:this.imageResourcesPath,renderForms:R(this,Z)===j.AnnotationMode.ENABLE_FORMS,l10n:this.l10n,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager}))),(I=this.xfaLayer)!=null&&I.div&&g.append(this.xfaLayer.div);let F=null;this.renderingQueue&&(F=gI=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=D.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=D.RenderingStates.RUNNING,gI()};return}gI()});const hI=async(gI=null)=>{if(YI===this.paintTask&&(this.paintTask=null),gI instanceof j.RenderingCancelledException){this._renderError=null;return}if(this._renderError=gI,this.renderingState=D.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),this._resetZoomLayer(!0),R(this,p).regularAnnotations=!YI.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),gI)throw gI},YI=this.renderer===D.RendererType.SVG?this.paintOnSvg(X):this.paintOnCanvas(X);YI.onRenderContinue=F,this.paintTask=YI;const nI=YI.promise.then(()=>hI(null).then(()=>{if(N){const gI=o.streamTextContent({includeMarkedContent:!0});N.setTextContentStream(gI),N.render()}this.annotationLayer&&this._renderAnnotationLayer().then(()=>{this.annotationEditorLayerFactory&&(this.annotationEditorLayer||(this.annotationEditorLayer=this.annotationEditorLayerFactory.createAnnotationEditorLayerBuilder({pageDiv:g,pdfPage:o,l10n:this.l10n,accessibilityManager:this._accessibilityManager})),this._renderAnnotationEditorLayer())})}),function(gI){return hI(gI)});return this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder({pageDiv:g,pdfPage:o})),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=gI=>{gI.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then(U=>{if(!U||!this.canvas)return;const II=this.structTreeLayer.render(U);II.classList.add("structTree"),this.canvas.append(II)}))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder({pdfPage:o})),g.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),nI}paintOnCanvas(a){const i=(0,j.createPromiseCapability)(),I={promise:i.promise,onRenderContinue(II){II()},cancel(){U.cancel()},get separateAnnots(){return U.separateAnnots}},g=this.viewport,o=document.createElement("canvas");o.setAttribute("role","presentation"),o.hidden=!0;let X=!0;const b=function(){X&&(o.hidden=!1,X=!1)};a.append(o),this.canvas=o;const N=o.getContext("2d",{alpha:!1}),F=this.outputScale=new D.OutputScale;if(this.useOnlyCssZoom){const II=g.clone({scale:j.PixelsPerInch.PDF_TO_CSS_UNITS});F.sx*=II.width/g.width,F.sy*=II.height/g.height}if(this.maxCanvasPixels>0){const II=g.width*g.height,q=Math.sqrt(this.maxCanvasPixels/II);F.sx>q||F.sy>q?(F.sx=q,F.sy=q,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const hI=(0,D.approximateFraction)(F.sx),YI=(0,D.approximateFraction)(F.sy);o.width=(0,D.roundToDivide)(g.width*F.sx,hI[0]),o.height=(0,D.roundToDivide)(g.height*F.sy,YI[0]),o.style.width=(0,D.roundToDivide)(g.width,hI[1])+"px",o.style.height=(0,D.roundToDivide)(g.height,YI[1])+"px",this.paintedViewportMap.set(o,g);const nI=F.scaled?[F.sx,0,0,F.sy,0,0]:null,gI={canvasContext:N,transform:nI,viewport:this.viewport,annotationMode:R(this,Z),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},U=this.pdfPage.render(gI);return U.onContinue=function(II){b(),I.onRenderContinue?I.onRenderContinue(II):II()},U.promise.then(function(){b(),i.resolve()},function(II){b(),i.reject(II)}),I}paintOnSvg(a){let i=!1;const I=()=>{if(i)throw new j.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},g=this.pdfPage,o=this.viewport.clone({scale:j.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:g.getOperatorList({annotationMode:R(this,Z)}).then(X=>(I(),new j.SVGGraphics(g.commonObjs,g.objs).getSVG(X,o).then(b=>{I(),this.svg=b,this.paintedViewportMap.set(b,o),b.style.width=a.style.width,b.style.height=a.style.height,this.renderingState=D.RenderingStates.FINISHED,a.append(b)}))),onRenderContinue(X){X()},cancel(){i=!0},get separateAnnots(){return!1}}}setPageLabel(a){this.pageLabel=typeof a=="string"?a:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent:a,regularAnnotations:i}=R(this,p);return a&&i?this.canvas:null}}Z=new WeakMap,p=new WeakMap,T.PDFPageView=B},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.compatibilityParams=T.OptionKind=T.AppOptions=void 0;const r=Object.create(null);T.compatibilityParams=r;{const m=navigator.userAgent||"",d=navigator.platform||"",C=navigator.maxTouchPoints||1,l=/Android/.test(m),B=/\b(iPad|iPhone|iPod)(?=;)/.test(m)||d==="MacIntel"&&C>1;(function(){(B||l)&&(r.maxCanvasPixels=5242880)})()}const Z={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};T.OptionKind=Z;const p={annotationEditorMode:{value:-1,kind:Z.VIEWER+Z.PREFERENCE},annotationMode:{value:2,kind:Z.VIEWER+Z.PREFERENCE},cursorToolOnLoad:{value:0,kind:Z.VIEWER+Z.PREFERENCE},defaultZoomValue:{value:"",kind:Z.VIEWER+Z.PREFERENCE},disableHistory:{value:!1,kind:Z.VIEWER},disablePageLabels:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},enablePermissions:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:Z.VIEWER+Z.PREFERENCE},enableScripting:{value:!0,kind:Z.VIEWER+Z.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:Z.VIEWER},externalLinkTarget:{value:0,kind:Z.VIEWER+Z.PREFERENCE},historyUpdateUrl:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},imageResourcesPath:{value:"./images/",kind:Z.VIEWER},maxCanvasPixels:{value:16777216,kind:Z.VIEWER},forcePageColors:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:Z.VIEWER+Z.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:Z.VIEWER+Z.PREFERENCE},pdfBugEnabled:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},printResolution:{value:150,kind:Z.VIEWER},sidebarViewOnLoad:{value:-1,kind:Z.VIEWER+Z.PREFERENCE},scrollModeOnLoad:{value:-1,kind:Z.VIEWER+Z.PREFERENCE},spreadModeOnLoad:{value:-1,kind:Z.VIEWER+Z.PREFERENCE},textLayerMode:{value:1,kind:Z.VIEWER+Z.PREFERENCE},useOnlyCssZoom:{value:!1,kind:Z.VIEWER+Z.PREFERENCE},viewerCssTheme:{value:0,kind:Z.VIEWER+Z.PREFERENCE},viewOnLoad:{value:0,kind:Z.VIEWER+Z.PREFERENCE},cMapPacked:{value:!0,kind:Z.API},cMapUrl:{value:"../web/cmaps/",kind:Z.API},disableAutoFetch:{value:!1,kind:Z.API+Z.PREFERENCE},disableFontFace:{value:!1,kind:Z.API+Z.PREFERENCE},disableRange:{value:!1,kind:Z.API+Z.PREFERENCE},disableStream:{value:!1,kind:Z.API+Z.PREFERENCE},docBaseUrl:{value:"",kind:Z.API},enableXfa:{value:!0,kind:Z.API+Z.PREFERENCE},fontExtraProperties:{value:!1,kind:Z.API},isEvalSupported:{value:!0,kind:Z.API},maxImageSize:{value:-1,kind:Z.API},pdfBug:{value:!1,kind:Z.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:Z.API},verbosity:{value:1,kind:Z.API},workerPort:{value:null,kind:Z.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:Z.WORKER}};p.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:Z.VIEWER},p.disablePreferences={value:!1,kind:Z.VIEWER},p.locale={value:navigator.language||"en-US",kind:Z.VIEWER},p.renderer={value:"canvas",kind:Z.VIEWER+Z.PREFERENCE},p.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:Z.VIEWER};const j=Object.create(null);class D{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(d){const C=j[d];if(C!==void 0)return C;const l=p[d];if(l!==void 0)return r[d]??l.value}static getAll(d=null){const C=Object.create(null);for(const l in p){const B=p[l];if(d){if(!(d&B.kind))continue;if(d===Z.PREFERENCE){const a=B.value,i=typeof a;if(i==="boolean"||i==="string"||i==="number"&&Number.isInteger(a)){C[l]=a;continue}throw new Error(`Invalid type for preference: ${l}`)}}const Y=j[l];C[l]=Y!==void 0?Y:r[l]??B.value}return C}static set(d,C){j[d]=C}static setAll(d){for(const C in d)j[C]=d[C]}static remove(d){delete j[d]}static _hasUserOptions(){return Object.keys(j).length>0}}T.AppOptions=D},(z,T,r)=>{var Z,p,j,D,m,d,C,l;Object.defineProperty(T,"__esModule",{value:!0}),T.TextAccessibilityManager=void 0;var B=r(7);const Y=class{constructor(){GI(this,C),GI(this,Z,!1),GI(this,p,null),GI(this,j,new Map),GI(this,D,new Map)}setTextMapping(i){XI(this,p,i)}enable(){if(R(this,Z))throw new Error("TextAccessibilityManager is already enabled.");if(!R(this,p))throw new Error("Text divs and strings have not been set.");if(XI(this,Z,!0),XI(this,p,R(this,p).slice()),R(this,p).sort(bI(Y,m,d)),R(this,j).size>0){const i=R(this,p);for(const[I,g]of R(this,j)){if(!document.getElementById(I)){R(this,j).delete(I);continue}bI(this,C,l).call(this,I,i[g])}}for(const[i,I]of R(this,D))this.addPointerInTextLayer(i,I);R(this,D).clear()}disable(){R(this,Z)&&(R(this,D).clear(),XI(this,p,null),XI(this,Z,!1))}removePointerInTextLayer(i){if(!R(this,Z)){R(this,D).delete(i);return}const I=R(this,p);if(!I||I.length===0)return;const{id:g}=i,o=R(this,j).get(g);if(o===void 0)return;const X=I[o];R(this,j).delete(g);let b=X.getAttribute("aria-owns");b!=null&&b.includes(g)&&(b=b.split(" ").filter(N=>N!==g).join(" "),b?X.setAttribute("aria-owns",b):(X.removeAttribute("aria-owns"),X.setAttribute("role","presentation")))}addPointerInTextLayer(i,I){const{id:g}=i;if(!g)return;if(!R(this,Z)){R(this,D).set(i,I);return}I&&this.removePointerInTextLayer(i);const o=R(this,p);if(!o||o.length===0)return;const X=(0,B.binarySearchFirstItem)(o,N=>{var F;return bI(F=Y,m,d).call(F,i,N)<0}),b=Math.max(0,X-1);bI(this,C,l).call(this,g,o[b]),R(this,j).set(g,b)}moveElementInDOM(i,I,g,o){if(this.addPointerInTextLayer(g,o),!i.hasChildNodes()){i.append(I);return}const X=Array.from(i.childNodes).filter(F=>F!==I);if(X.length===0)return;const b=g||I,N=(0,B.binarySearchFirstItem)(X,F=>{var hI;return bI(hI=Y,m,d).call(hI,b,F)<0});N===0?X[0].before(I):X[N-1].after(I)}};let a=Y;Z=new WeakMap,p=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakSet,d=function(i,I){const g=i.getBoundingClientRect(),o=I.getBoundingClientRect();if(g.width===0&&g.height===0)return 1;if(o.width===0&&o.height===0)return-1;const X=g.y,b=g.y+g.height,N=g.y+g.height/2,F=o.y,hI=o.y+o.height,YI=o.y+o.height/2;if(N<=F&&YI>=b)return-1;if(YI<=X&&N>=hI)return 1;const nI=g.x+g.width/2,gI=o.x+o.width/2;return nI-gI},C=new WeakSet,l=function(i,I){const g=I.getAttribute("aria-owns");g!=null&&g.includes(i)||I.setAttribute("aria-owns",g?`${g} ${i}`:i),I.removeAttribute("role")},GI(a,m),T.TextAccessibilityManager=a},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.PDFRenderingQueue=void 0;var Z=r(3),p=r(7);const j=3e4;class D{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(d){this.pdfViewer=d}setThumbnailViewer(d){this.pdfThumbnailViewer=d}isHighestPriority(d){return this.highestPriorityPage===d.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(d){var C;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(d)&&(this.isThumbnailViewEnabled&&(C=this.pdfThumbnailViewer)!=null&&C.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),j)))}getHighestPriority(d,C,l,B=!1){const Y=d.views,a=Y.length;if(a===0)return null;for(let X=0;X<a;X++){const b=Y[X].view;if(!this.isViewFinished(b))return b}const i=d.first.id,I=d.last.id;if(I-i+1>a){const X=d.ids;for(let b=1,N=I-i;b<N;b++){const F=l?i+b:I-b;if(X.has(F))continue;const hI=C[F-1];if(!this.isViewFinished(hI))return hI}}let g=l?I:i-2,o=C[g];return o&&!this.isViewFinished(o)||B&&(g+=l?1:-1,o=C[g],o&&!this.isViewFinished(o))?o:null}isViewFinished(d){return d.renderingState===p.RenderingStates.FINISHED}renderView(d){switch(d.renderingState){case p.RenderingStates.FINISHED:return!1;case p.RenderingStates.PAUSED:this.highestPriorityPage=d.renderingId,d.resume();break;case p.RenderingStates.RUNNING:this.highestPriorityPage=d.renderingId;break;case p.RenderingStates.INITIAL:this.highestPriorityPage=d.renderingId,d.draw().finally(()=>{this.renderHighestPriority()}).catch(C=>{C instanceof Z.RenderingCancelledException||console.error(`renderView: "${C}"`)});break}return!0}}T.PDFRenderingQueue=D},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.TextHighlighter=void 0;class r{constructor({findController:p,eventBus:j,pageIndex:D}){this.findController=p,this.matches=[],this.eventBus=j,this.pageIdx=D,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(p,j){this.textDivs=p,this.textContentItemsStr=j}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=p=>{(p.pageIndex===this.pageIdx||p.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null))}_convertMatches(p,j){if(!p)return[];const{textContentItemsStr:D}=this;let m=0,d=0;const C=D.length-1,l=[];for(let B=0,Y=p.length;B<Y;B++){let a=p[B];for(;m!==C&&a>=d+D[m].length;)d+=D[m].length,m++;m===D.length&&console.error("Could not find a matching mapping");const i={begin:{divIdx:m,offset:a-d}};for(a+=j[B];m!==C&&a>d+D[m].length;)d+=D[m].length,m++;i.end={divIdx:m,offset:a-d},l.push(i)}return l}_renderMatches(p){if(p.length===0)return;const{findController:j,pageIdx:D}=this,{textContentItemsStr:m,textDivs:d}=this,C=D===j.selected.pageIdx,l=j.selected.matchIdx,B=j.state.highlightAll;let Y=null;const a={divIdx:-1,offset:void 0};function i(X,b){const N=X.divIdx;return d[N].textContent="",I(N,0,X.offset,b)}function I(X,b,N,F){let hI=d[X];if(hI.nodeType===Node.TEXT_NODE){const gI=document.createElement("span");hI.before(gI),gI.append(hI),d[X]=gI,hI=gI}const YI=m[X].substring(b,N),nI=document.createTextNode(YI);if(F){const gI=document.createElement("span");return gI.className=`${F} appended`,gI.append(nI),hI.append(gI),F.includes("selected")?gI.offsetLeft:0}return hI.append(nI),0}let g=l,o=g+1;if(B)g=0,o=p.length;else if(!C)return;for(let X=g;X<o;X++){const b=p[X],N=b.begin,F=b.end,hI=C&&X===l,YI=hI?" selected":"";let nI=0;if(!Y||N.divIdx!==Y.divIdx?(Y!==null&&I(Y.divIdx,Y.offset,a.offset),i(N)):I(Y.divIdx,Y.offset,N.offset),N.divIdx===F.divIdx)nI=I(N.divIdx,N.offset,F.offset,"highlight"+YI);else{nI=I(N.divIdx,N.offset,a.offset,"highlight begin"+YI);for(let gI=N.divIdx+1,U=F.divIdx;gI<U;gI++)d[gI].className="highlight middle"+YI;i(F,"highlight end"+YI)}Y=F,hI&&j.scrollMatchIntoView({element:d[N.divIdx],selectedLeft:nI,pageIndex:D,matchIndex:l})}Y&&I(Y.divIdx,Y.offset,a.offset)}_updateMatches(){if(!this.enabled)return;const{findController:p,matches:j,pageIdx:D}=this,{textContentItemsStr:m,textDivs:d}=this;let C=-1;for(let Y=0,a=j.length;Y<a;Y++){const i=j[Y],I=Math.max(C,i.begin.divIdx);for(let g=I,o=i.end.divIdx;g<=o;g++){const X=d[g];X.textContent=m[g],X.className=""}C=i.end.divIdx+1}if(!(p!=null&&p.highlightMatches))return;const l=p.pageMatches[D]||null,B=p.pageMatchesLength[D]||null;this.matches=this._convertMatches(l,B),this._renderMatches(this.matches)}}T.TextHighlighter=r},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.DownloadManager=void 0;var Z=r(3);function p(D,m){const d=document.createElement("a");if(!d.click)throw new Error('DownloadManager: "a.click()" is not supported.');d.href=D,d.target="_parent","download"in d&&(d.download=m),(document.body||document.documentElement).append(d),d.click(),d.remove()}class j{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(m,d){if(!(0,Z.createValidAbsoluteUrl)(m,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${m}`);return}p(m+"#pdfjs.action=download",d)}downloadData(m,d,C){const l=URL.createObjectURL(new Blob([m],{type:C}));p(l,d)}openOrDownloadData(m,d,C){const l=(0,Z.isPdfFile)(C),B=l?"application/pdf":"";if(l){let Y=this._openBlobUrls.get(m);Y||(Y=URL.createObjectURL(new Blob([d],{type:B})),this._openBlobUrls.set(m,Y));let a;a="?file="+encodeURIComponent(Y+"#"+C);try{return window.open(a),!0}catch(i){console.error(`openOrDownloadData: ${i}`),URL.revokeObjectURL(Y),this._openBlobUrls.delete(m)}}return this.downloadData(d,C,B),!1}download(m,d,C){const l=URL.createObjectURL(m);p(l,C)}}T.DownloadManager=j},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.WaitOnType=T.EventBus=T.AutomationEventBus=void 0,T.waitOnEventOrTimeout=Z;const r={EVENT:"event",TIMEOUT:"timeout"};T.WaitOnType=r;function Z({target:D,name:m,delay:d=0}){return new Promise(function(C,l){if(typeof D!="object"||!(m&&typeof m=="string")||!(Number.isInteger(d)&&d>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function B(I){D instanceof p?D._off(m,Y):D.removeEventListener(m,Y),i&&clearTimeout(i),C(I)}const Y=B.bind(null,r.EVENT);D instanceof p?D._on(m,Y):D.addEventListener(m,Y);const a=B.bind(null,r.TIMEOUT),i=setTimeout(a,d)})}class p{constructor(){this._listeners=Object.create(null)}on(m,d,C=null){this._on(m,d,{external:!0,once:C==null?void 0:C.once})}off(m,d,C=null){this._off(m,d,{external:!0,once:C==null?void 0:C.once})}dispatch(m,d){const C=this._listeners[m];if(!C||C.length===0)return;let l;for(const{listener:B,external:Y,once:a}of C.slice(0)){if(a&&this._off(m,B),Y){(l||(l=[])).push(B);continue}B(d)}if(l){for(const B of l)B(d);l=null}}_on(m,d,C=null){var l;((l=this._listeners)[m]||(l[m]=[])).push({listener:d,external:(C==null?void 0:C.external)===!0,once:(C==null?void 0:C.once)===!0})}_off(m,d,C=null){const l=this._listeners[m];if(l){for(let B=0,Y=l.length;B<Y;B++)if(l[B].listener===d){l.splice(B,1);return}}}}T.EventBus=p;class j extends p{dispatch(m,d){throw new Error("Not implemented: AutomationEventBus.dispatch")}}T.AutomationEventBus=j},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.GenericL10n=void 0,r(21);var Z=r(4);const p=document.webL10n;class j{constructor(m){this._lang=m,this._ready=new Promise((d,C)=>{p.setLanguage((0,Z.fixupLangCode)(m),()=>{d(p)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(m,d=null,C=(0,Z.getL10nFallback)(m,d)){return(await this._ready).get(m,d,C)}async translate(m){return(await this._ready).translate(m)}}T.GenericL10n=j},()=>{document.webL10n=function(z,T,r){var Z={},p="",j="textContent",D="",m={},d="loading",C=!0;function l(){return T.querySelectorAll('link[type="application/l10n"]')}function B(){var gI=T.querySelector('script[type="application/l10n"]');return gI?JSON.parse(gI.innerHTML):null}function Y(gI){return gI?gI.querySelectorAll("*[data-l10n-id]"):[]}function a(gI){if(!gI)return{};var U=gI.getAttribute("data-l10n-id"),II=gI.getAttribute("data-l10n-args"),q={};if(II)try{q=JSON.parse(II)}catch{console.warn("could not parse arguments for #"+U)}return{id:U,args:q}}function i(gI,U,II){U=U||function(mI){},II=II||function(){};var q=new XMLHttpRequest;q.open("GET",gI,C),q.overrideMimeType&&q.overrideMimeType("text/plain; charset=utf-8"),q.onreadystatechange=function(){q.readyState==4&&(q.status==200||q.status===0?U(q.responseText):II())},q.onerror=II,q.ontimeout=II;try{q.send(null)}catch{II()}}function I(gI,U,II,q){var mI=gI.replace(/[^\/]*$/,"")||"./";function NI(J){return J.lastIndexOf("\\")<0?J:J.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function BI(J,e){var w={},x=/^\s*|\s*$/,E=/^\s*#|^\s*$/,P=/^\s*\[(.*)\]\s*$/,iI=/^\s*@import\s+url\((.*)\)\s*$/i,aI=/^([^=\s]*)\s*=\s*(.+)$/;function eI(W,L,S){var Q=W.replace(x,"").split(/[\r\n]+/),lI="*",uI=U.split("-",1)[0],MI=!1,ZI="";function WI(){for(;;){if(!Q.length){S();return}var tI=Q.shift();if(!E.test(tI)){if(L){if(ZI=P.exec(tI),ZI){lI=ZI[1].toLowerCase(),MI=lI!=="*"&&lI!==U&&lI!==uI;continue}else if(MI)continue;if(ZI=iI.exec(tI),ZI){A(mI+ZI[1],WI);return}}var O=tI.match(aI);O&&O.length==3&&(w[O[1]]=NI(O[2]))}}}WI()}function A(W,L){i(W,function(S){eI(S,!1,L)},function(){console.warn(W+" not found."),L()})}eI(J,!0,function(){e(w)})}i(gI,function(J){p+=J,BI(J,function(e){for(var w in e){var x,E,P=w.lastIndexOf(".");P>0?(x=w.substring(0,P),E=w.substring(P+1)):(x=w,E=j),Z[x]||(Z[x]={}),Z[x][E]=e[w]}II&&II()})},q)}function g(gI,U){gI&&(gI=gI.toLowerCase()),U=U||function(){},o(),D=gI;var II=l(),q=II.length;if(q===0){var mI=B();if(mI&&mI.locales&&mI.default_locale){if(console.log("using the embedded JSON directory, early way out"),Z=mI.locales[gI],!Z){var NI=mI.default_locale.toLowerCase();for(var BI in mI.locales)if(BI=BI.toLowerCase(),BI===gI){Z=mI.locales[gI];break}else BI===NI&&(Z=mI.locales[NI])}U()}else console.log("no resource to load, early way out");d="complete";return}var J=null,e=0;J=function(){e++,e>=q&&(U(),d="complete")};function w(P){var iI=P.href;this.load=function(aI,eI){I(iI,aI,eI,function(){console.warn(iI+" not found."),console.warn('"'+aI+'" resource not found'),D="",eI()})}}for(var x=0;x<q;x++){var E=new w(II[x]);E.load(gI,J)}}function o(){Z={},p="",D=""}function X(gI){var U={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function II(BI,J){return J.indexOf(BI)!==-1}function q(BI,J,e){return J<=BI&&BI<=e}var mI={0:function(BI){return"other"},1:function(BI){return q(BI%100,3,10)?"few":BI===0?"zero":q(BI%100,11,99)?"many":BI==2?"two":BI==1?"one":"other"},2:function(BI){return BI!==0&&BI%10===0?"many":BI==2?"two":BI==1?"one":"other"},3:function(BI){return BI==1?"one":"other"},4:function(BI){return q(BI,0,1)?"one":"other"},5:function(BI){return q(BI,0,2)&&BI!=2?"one":"other"},6:function(BI){return BI===0?"zero":BI%10==1&&BI%100!=11?"one":"other"},7:function(BI){return BI==2?"two":BI==1?"one":"other"},8:function(BI){return q(BI,3,6)?"few":q(BI,7,10)?"many":BI==2?"two":BI==1?"one":"other"},9:function(BI){return BI===0||BI!=1&&q(BI%100,1,19)?"few":BI==1?"one":"other"},10:function(BI){return q(BI%10,2,9)&&!q(BI%100,11,19)?"few":BI%10==1&&!q(BI%100,11,19)?"one":"other"},11:function(BI){return q(BI%10,2,4)&&!q(BI%100,12,14)?"few":BI%10===0||q(BI%10,5,9)||q(BI%100,11,14)?"many":BI%10==1&&BI%100!=11?"one":"other"},12:function(BI){return q(BI,2,4)?"few":BI==1?"one":"other"},13:function(BI){return q(BI%10,2,4)&&!q(BI%100,12,14)?"few":BI!=1&&q(BI%10,0,1)||q(BI%10,5,9)||q(BI%100,12,14)?"many":BI==1?"one":"other"},14:function(BI){return q(BI%100,3,4)?"few":BI%100==2?"two":BI%100==1?"one":"other"},15:function(BI){return BI===0||q(BI%100,2,10)?"few":q(BI%100,11,19)?"many":BI==1?"one":"other"},16:function(BI){return BI%10==1&&BI!=11?"one":"other"},17:function(BI){return BI==3?"few":BI===0?"zero":BI==6?"many":BI==2?"two":BI==1?"one":"other"},18:function(BI){return BI===0?"zero":q(BI,0,2)&&BI!==0&&BI!=2?"one":"other"},19:function(BI){return q(BI,2,10)?"few":q(BI,0,1)?"one":"other"},20:function(BI){return(q(BI%10,3,4)||BI%10==9)&&!(q(BI%100,10,19)||q(BI%100,70,79)||q(BI%100,90,99))?"few":BI%1e6===0&&BI!==0?"many":BI%10==2&&!II(BI%100,[12,72,92])?"two":BI%10==1&&!II(BI%100,[11,71,91])?"one":"other"},21:function(BI){return BI===0?"zero":BI==1?"one":"other"},22:function(BI){return q(BI,0,1)||q(BI,11,99)?"one":"other"},23:function(BI){return q(BI%10,1,2)||BI%20===0?"one":"other"},24:function(BI){return q(BI,3,10)||q(BI,13,19)?"few":II(BI,[2,12])?"two":II(BI,[1,11])?"one":"other"}},NI=U[gI.replace(/-.*$/,"")];return NI in mI?mI[NI]:(console.warn("plural form unknown for ["+gI+"]"),function(){return"other"})}m.plural=function(gI,U,II,q){var mI=parseFloat(U);if(isNaN(mI)||q!=j)return gI;m._pluralRules||(m._pluralRules=X(D));var NI="["+m._pluralRules(mI)+"]";return mI===0&&II+"[zero]"in Z?gI=Z[II+"[zero]"][q]:mI==1&&II+"[one]"in Z?gI=Z[II+"[one]"][q]:mI==2&&II+"[two]"in Z?gI=Z[II+"[two]"][q]:II+NI in Z?gI=Z[II+NI][q]:II+"[other]"in Z&&(gI=Z[II+"[other]"][q]),gI};function b(gI,U,II){var q=Z[gI];if(!q){if(console.warn("#"+gI+" is undefined."),!II)return null;q=II}var mI={};for(var NI in q){var BI=q[NI];BI=N(BI,U,gI,NI),BI=F(BI,U,gI),mI[NI]=BI}return mI}function N(gI,U,II,q){var mI=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,NI=mI.exec(gI);if(!NI||!NI.length)return gI;var BI=NI[1],J=NI[2],e;if(U&&J in U?e=U[J]:J in Z&&(e=Z[J]),BI in m){var w=m[BI];gI=w(gI,e,II,q)}return gI}function F(gI,U,II){var q=/\{\{\s*(.+?)\s*\}\}/g;return gI.replace(q,function(mI,NI){return U&&NI in U?U[NI]:NI in Z?Z[NI]:(console.log("argument {{"+NI+"}} for #"+II+" is undefined."),mI)})}function hI(gI){var U=a(gI);if(U.id){var II=b(U.id,U.args);if(!II){console.warn("#"+U.id+" is undefined.");return}if(II[j]){if(YI(gI)===0)gI[j]=II[j];else{for(var q=gI.childNodes,mI=!1,NI=0,BI=q.length;NI<BI;NI++)q[NI].nodeType===3&&/\S/.test(q[NI].nodeValue)&&(mI?q[NI].nodeValue="":(q[NI].nodeValue=II[j],mI=!0));if(!mI){var J=T.createTextNode(II[j]);gI.prepend(J)}}delete II[j]}for(var e in II)gI[e]=II[e]}}function YI(gI){if(gI.children)return gI.children.length;if(typeof gI.childElementCount<"u")return gI.childElementCount;for(var U=0,II=0;II<gI.childNodes.length;II++)U+=gI.nodeType===1?1:0;return U}function nI(gI){gI=gI||T.documentElement;for(var U=Y(gI),II=U.length,q=0;q<II;q++)hI(U[q]);hI(gI)}return{get:function(gI,U,II){var q=gI.lastIndexOf("."),mI=j;q>0&&(mI=gI.substring(q+1),gI=gI.substring(0,q));var NI;II&&(NI={},NI[mI]=II);var BI=b(gI,U,NI);return BI&&mI in BI?BI[mI]:"{{"+gI+"}}"},getData:function(){return Z},getText:function(){return p},getLanguage:function(){return D},setLanguage:function(gI,U){g(gI,function(){U&&U()})},getDirection:function(){var gI=["ar","he","fa","ps","ur"],U=D.split("-",1)[0];return gI.indexOf(U)>=0?"rtl":"ltr"},translate:nI,getReadyState:function(){return d},ready:function(gI){if(gI)d=="complete"||d=="interactive"?z.setTimeout(function(){gI()}):T.addEventListener&&T.addEventListener("localized",function U(){T.removeEventListener("localized",U),gI()});else return}}}(window,document)},(z,T,r)=>{var Z,p,j,D,m,d,C,l,B,Y,a,i,I,g,o,X,b,N,F,hI,YI,nI,gI,U,II,q,mI,NI,BI,J,e,w,x,E,P,iI,aI,eI,A,W;Object.defineProperty(T,"__esModule",{value:!0}),T.PDFFindController=T.FindState=void 0;var L=r(7),S=r(3),Q=r(23);const lI={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};T.FindState=lI;const uI=250,MI=-50,ZI=-400,WI={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},tI=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),O=[...tI.values()].map(JI=>String.fromCharCode(JI)).join(""),f=/\p{M}+/gu,v=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,RI=/([^\p{M}])\p{M}*$/u,pI=/^\p{M}*([^\p{M}])/u,DI=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,FI=new Map,TI="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]";let vI=null,fI=null;function PI(JI){const yI=[];let HI;for(;(HI=DI.exec(JI))!==null;){let{index:OI}=HI;for(const gg of HI[0]){let Ig=FI.get(gg);Ig||(Ig=gg.normalize("NFD").length,FI.set(gg,Ig)),yI.push([Ig,OI++])}}let cI;if(yI.length===0&&vI)cI=vI;else if(yI.length>0&&fI)cI=fI;else{const OI=`([${Object.keys(WI).join("")}])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(\\n)`;yI.length===0?cI=vI=new RegExp(OI+"|(\\u0000)","gum"):cI=fI=new RegExp(OI+`|(${TI})`,"gum")}const CI=[];for(;(HI=f.exec(JI))!==null;)CI.push([HI[0].length,HI.index]);let AI=JI.normalize("NFD");const KI=[[0,0]];let LI=0,rI=0,kI=0,xI=0,_I=0,$I=!1;return AI=AI.replace(cI,(OI,gg,Ig,Ag,qI,lg,ig)=>{var og,Zg;if(ig-=xI,gg){const sg=WI[OI],Cg=sg.length;for(let dg=1;dg<Cg;dg++)KI.push([ig-kI+dg,kI-dg]);return kI-=Cg-1,sg}if(Ig){const sg=Ig.endsWith(`
`),Cg=sg?Ig.length-2:Ig.length;$I=!0;let dg=Cg;ig+_I===((og=CI[LI])==null?void 0:og[1])&&(dg-=CI[LI][0],++LI);for(let Gg=1;Gg<=dg;Gg++)KI.push([ig-1-kI+Gg,kI-Gg]);return kI-=dg,xI+=dg,sg?(ig+=Cg-1,KI.push([ig-kI+1,1+kI]),kI+=1,xI+=1,_I+=1,Ig.slice(0,Cg)):Ig}if(Ag)return KI.push([ig-kI+1,1+kI]),kI+=1,xI+=1,_I+=1,Ag.charAt(0);if(qI)return KI.push([ig-kI+1,kI-1]),kI-=1,xI+=1,_I+=1," ";if(ig+_I===((Zg=yI[rI])==null?void 0:Zg[1])){const sg=yI[rI][0]-1;++rI;for(let Cg=1;Cg<=sg;Cg++)KI.push([ig-(kI-Cg),kI-Cg]);kI-=sg,xI+=sg}return lg}),KI.push([AI.length,kI]),[AI,KI,$I]}function EI(JI,yI,HI){if(!JI)return[yI,HI];const cI=yI,CI=yI+HI;let AI=(0,L.binarySearchFirstItem)(JI,LI=>LI[0]>=cI);JI[AI][0]>cI&&--AI;let KI=(0,L.binarySearchFirstItem)(JI,LI=>LI[0]>=CI,AI);return JI[KI][0]>CI&&--KI,[cI+JI[AI][1],HI+JI[KI][1]-JI[AI][1]]}class SI{constructor({linkService:yI,eventBus:HI}){GI(this,Z),GI(this,j),GI(this,m),GI(this,C),GI(this,B),GI(this,a),GI(this,I),GI(this,o),GI(this,b),GI(this,F),GI(this,YI),GI(this,gI),GI(this,II),GI(this,mI),GI(this,BI),GI(this,e),GI(this,x),GI(this,P),GI(this,aI),GI(this,A),this._linkService=yI,this._eventBus=HI,bI(this,j,D).call(this),HI._on("find",bI(this,Z,p).bind(this)),HI._on("findbarclose",bI(this,x,E).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(yI){this._pdfDocument&&bI(this,j,D).call(this),yI&&(this._pdfDocument=yI,this._firstPageCapability.resolve())}scrollMatchIntoView({element:yI=null,selectedLeft:HI=0,pageIndex:cI=-1,matchIndex:CI=-1}){if(!this._scrollMatches||!yI||CI===-1||CI!==this._selected.matchIdx||cI===-1||cI!==this._selected.pageIdx)return;this._scrollMatches=!1;const AI={top:MI,left:HI+ZI};(0,L.scrollIntoView)(yI,AI,!0)}}Z=new WeakSet,p=function(JI){if(!JI)return;const yI=this._pdfDocument,{type:HI}=JI;(this._state===null||bI(this,C,l).call(this,JI))&&(this._dirtyMatch=!0),this._state=JI,HI!=="highlightallchange"&&bI(this,A,W).call(this,lI.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||yI&&this._pdfDocument!==yI)return;bI(this,b,N).call(this);const cI=!this._highlightMatches,CI=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),HI?this._dirtyMatch?bI(this,gI,U).call(this):HI==="again"?(bI(this,gI,U).call(this),cI&&this._state.highlightAll&&bI(this,YI,nI).call(this)):HI==="highlightallchange"?(CI?bI(this,gI,U).call(this):this._highlightMatches=!0,bI(this,YI,nI).call(this)):bI(this,gI,U).call(this):this._findTimeout=setTimeout(()=>{bI(this,gI,U).call(this),this._findTimeout=null},uI)})},j=new WeakSet,D=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,S.createPromiseCapability)()},m=new WeakSet,d=function(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=PI(this._state.query)),this._normalizedQuery},C=new WeakSet,l=function(JI){if(JI.query!==this._state.query)return!0;switch(JI.type){case"again":const yI=this._selected.pageIdx+1,HI=this._linkService;return yI>=1&&yI<=HI.pagesCount&&yI!==HI.page&&!HI.isPageVisible(yI);case"highlightallchange":return!1}return!0},B=new WeakSet,Y=function(JI,yI,HI){let cI=JI.slice(0,yI).match(RI);if(cI){const CI=JI.charCodeAt(yI),AI=cI[1].charCodeAt(0);if((0,Q.getCharacterType)(CI)===(0,Q.getCharacterType)(AI))return!1}if(cI=JI.slice(yI+HI).match(pI),cI){const CI=JI.charCodeAt(yI+HI-1),AI=cI[1].charCodeAt(0);if((0,Q.getCharacterType)(CI)===(0,Q.getCharacterType)(AI))return!1}return!0},a=new WeakSet,i=function(JI,yI,HI,cI){const CI=[],AI=[],KI=this._pageDiffs[HI];let LI;for(;(LI=JI.exec(cI))!==null;){if(yI&&!bI(this,B,Y).call(this,cI,LI.index,LI[0].length))continue;const[rI,kI]=EI(KI,LI.index,LI[0].length);kI&&(CI.push(rI),AI.push(kI))}this._pageMatches[HI]=CI,this._pageMatchesLength[HI]=AI},I=new WeakSet,g=function(JI,yI){const{matchDiacritics:HI}=this._state;let cI=!1;JI=JI.replace(v,(AI,KI,LI,rI,kI,xI)=>KI?`[ ]*\\${KI}[ ]*`:LI?`[ ]*${LI}[ ]*`:rI?"[ ]+":HI?kI||xI:kI?tI.has(kI.charCodeAt(0))?kI:"":yI?(cI=!0,`${xI}\\p{M}*`):xI);const CI="[ ]*";return JI.endsWith(CI)&&(JI=JI.slice(0,JI.length-CI.length)),HI&&yI&&(cI=!0,JI=`${JI}(?=[${O}]|[^\\p{M}]|$)`),[cI,JI]},o=new WeakSet,X=function(JI){let yI=R(this,m,d);if(yI.length===0)return;const{caseSensitive:HI,entireWord:cI,phraseSearch:CI}=this._state,AI=this._pageContents[JI],KI=this._hasDiacritics[JI];let LI=!1;if(CI)[LI,yI]=bI(this,I,g).call(this,yI,KI);else{const xI=yI.match(/\S+/g);xI&&(yI=xI.sort().reverse().map(_I=>{const[$I,OI]=bI(this,I,g).call(this,_I,KI);return LI||(LI=$I),`(${OI})`}).join("|"))}const rI=`g${LI?"u":""}${HI?"":"i"}`;yI=new RegExp(yI,rI),bI(this,a,i).call(this,yI,cI,JI,AI),this._state.highlightAll&&bI(this,F,hI).call(this,JI),this._resumePageIdx===JI&&(this._resumePageIdx=null,bI(this,mI,NI).call(this));const kI=this._pageMatches[JI].length;kI>0&&(this._matchesCountTotal+=kI,bI(this,aI,eI).call(this))},b=new WeakSet,N=function(){if(this._extractTextPromises.length>0)return;let JI=Promise.resolve();for(let yI=0,HI=this._linkService.pagesCount;yI<HI;yI++){const cI=(0,S.createPromiseCapability)();this._extractTextPromises[yI]=cI.promise,JI=JI.then(()=>this._pdfDocument.getPage(yI+1).then(CI=>CI.getTextContent()).then(CI=>{const AI=[];for(const KI of CI.items)AI.push(KI.str),KI.hasEOL&&AI.push(`
`);[this._pageContents[yI],this._pageDiffs[yI],this._hasDiacritics[yI]]=PI(AI.join("")),cI.resolve()},CI=>{console.error(`Unable to get text content for page ${yI+1}`,CI),this._pageContents[yI]="",this._pageDiffs[yI]=null,this._hasDiacritics[yI]=!1,cI.resolve()}))}},F=new WeakSet,hI=function(JI){this._scrollMatches&&this._selected.pageIdx===JI&&(this._linkService.page=JI+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:JI})},YI=new WeakSet,nI=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},gI=new WeakSet,U=function(){const JI=this._state.findPrevious,yI=this._linkService.page-1,HI=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=yI,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,bI(this,YI,nI).call(this);for(let CI=0;CI<HI;CI++)this._pendingFindMatches.has(CI)||(this._pendingFindMatches.add(CI),this._extractTextPromises[CI].then(()=>{this._pendingFindMatches.delete(CI),bI(this,o,X).call(this,CI)}))}if(R(this,m,d)===""){bI(this,A,W).call(this,lI.FOUND);return}if(this._resumePageIdx)return;const cI=this._offset;if(this._pagesToSearch=HI,cI.matchIdx!==null){const CI=this._pageMatches[cI.pageIdx].length;if(!JI&&cI.matchIdx+1<CI||JI&&cI.matchIdx>0){cI.matchIdx=JI?cI.matchIdx-1:cI.matchIdx+1,bI(this,e,w).call(this,!0);return}bI(this,BI,J).call(this,JI)}bI(this,mI,NI).call(this)},II=new WeakSet,q=function(JI){const yI=this._offset,HI=JI.length,cI=this._state.findPrevious;return HI?(yI.matchIdx=cI?HI-1:0,bI(this,e,w).call(this,!0),!0):(bI(this,BI,J).call(this,cI),yI.wrapped&&(yI.matchIdx=null,this._pagesToSearch<0)?(bI(this,e,w).call(this,!1),!0):!1)},mI=new WeakSet,NI=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let JI=null;do{const yI=this._offset.pageIdx;if(JI=this._pageMatches[yI],!JI){this._resumePageIdx=yI;break}}while(!bI(this,II,q).call(this,JI))},BI=new WeakSet,J=function(JI){const yI=this._offset,HI=this._linkService.pagesCount;yI.pageIdx=JI?yI.pageIdx-1:yI.pageIdx+1,yI.matchIdx=null,this._pagesToSearch--,(yI.pageIdx>=HI||yI.pageIdx<0)&&(yI.pageIdx=JI?HI-1:0,yI.wrapped=!0)},e=new WeakSet,w=function(JI=!1){let yI=lI.NOT_FOUND;const HI=this._offset.wrapped;if(this._offset.wrapped=!1,JI){const cI=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,yI=HI?lI.WRAPPED:lI.FOUND,cI!==-1&&cI!==this._selected.pageIdx&&bI(this,F,hI).call(this,cI)}bI(this,A,W).call(this,yI,this._state.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,bI(this,F,hI).call(this,this._selected.pageIdx))},x=new WeakSet,E=function(JI){const yI=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||yI&&this._pdfDocument!==yI||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),bI(this,A,W).call(this,lI.FOUND),this._highlightMatches=!1,bI(this,YI,nI).call(this))})},P=new WeakSet,iI=function(){var JI;const{pageIdx:yI,matchIdx:HI}=this._selected;let cI=0,CI=this._matchesCountTotal;if(HI!==-1){for(let AI=0;AI<yI;AI++)cI+=((JI=this._pageMatches[AI])==null?void 0:JI.length)||0;cI+=HI+1}return(cI<1||cI>CI)&&(cI=CI=0),{current:cI,total:CI}},aI=new WeakSet,eI=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:bI(this,P,iI).call(this)})},A=new WeakSet,W=function(JI,yI=!1){var HI;this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:JI,previous:yI,matchesCount:bI(this,P,iI).call(this),rawQuery:((HI=this._state)==null?void 0:HI.query)??null})},T.PDFFindController=SI},(z,T)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.CharacterType=void 0,T.getCharacterType=a;const r={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};T.CharacterType=r;function Z(i){return i<11904}function p(i){return(i&65408)===0}function j(i){return i>=97&&i<=122||i>=65&&i<=90}function D(i){return i>=48&&i<=57}function m(i){return i===32||i===9||i===13||i===10}function d(i){return i>=13312&&i<=40959||i>=63744&&i<=64255}function C(i){return i>=12448&&i<=12543}function l(i){return i>=12352&&i<=12447}function B(i){return i>=65376&&i<=65439}function Y(i){return(i&65408)===3584}function a(i){return Z(i)?p(i)?m(i)?r.SPACE:j(i)||D(i)||i===95?r.ALPHA_LETTER:r.PUNCT:Y(i)?r.THAI_LETTER:i===160?r.SPACE:r.ALPHA_LETTER:d(i)?r.HAN_LETTER:C(i)?r.KATAKANA_LETTER:l(i)?r.HIRAGANA_LETTER:B(i)?r.HALFWIDTH_KATAKANA_LETTER:r.ALPHA_LETTER}},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.PDFHistory=void 0,T.isDestArraysEqual=B,T.isDestHashesEqual=l;var Z=r(7),p=r(19);const j=1e3,D=50,m=1e3;function d(){return document.location.hash}class C{constructor({linkService:a,eventBus:i}){this.linkService=a,this.eventBus=i,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",I=>{this._isPagesLoaded=!!I.pagesCount},{once:!0})})}initialize({fingerprint:a,resetHistory:i=!1,updateUrl:I=!1}){if(!a||typeof a!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const g=this._fingerprint!==""&&this._fingerprint!==a;this._fingerprint=a,this._updateUrl=I===!0,this._initialized=!0,this._bindEvents();const o=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=d(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(o,!0)||i){const{hash:b,page:N,rotation:F}=this._parseCurrentHash(!0);if(!b||g||i){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:b,page:N,rotation:F},!0);return}const X=o.destination;this._updateInternalState(X,o.uid,!0),X.rotation!==void 0&&(this._initialRotation=X.rotation),X.dest?(this._initialBookmark=JSON.stringify(X.dest),this._destination.page=null):X.hash?this._initialBookmark=X.hash:X.page&&(this._initialBookmark=`page=${X.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:a=null,explicitDest:i,pageNumber:I}){if(!this._initialized)return;if(a&&typeof a!="string"){console.error(`PDFHistory.push: "${a}" is not a valid namedDest parameter.`);return}else if(Array.isArray(i)){if(!this._isValidPage(I)&&(I!==null||this._destination)){console.error(`PDFHistory.push: "${I}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${i}" is not a valid explicitDest parameter.`);return}const g=a||JSON.stringify(i);if(!g)return;let o=!1;if(this._destination&&(l(this._destination.hash,g)||B(this._destination.dest,i))){if(this._destination.page)return;o=!0}this._popStateInProgress&&!o||(this._pushOrReplaceState({dest:i,hash:g,page:I,rotation:this.linkService.rotation},o),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(a){var i;if(this._initialized){if(!this._isValidPage(a)){console.error(`PDFHistory.pushPage: "${a}" is not a valid page number.`);return}((i=this._destination)==null?void 0:i.page)!==a&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${a}`,page:a,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const a=window.history.state;this._isValidState(a)&&a.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const a=window.history.state;this._isValidState(a)&&a.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(a,i=!1){const I=i||!this._destination,g={fingerprint:this._fingerprint,uid:I?this._uid:this._uid+1,destination:a};this._updateInternalState(a,g.uid);let o;if(this._updateUrl&&a!=null&&a.hash){const X=document.location.href.split("#")[0];X.startsWith("file://")||(o=`${X}#${a.hash}`)}I?window.history.replaceState(g,"",o):window.history.pushState(g,"",o)}_tryPushCurrentPosition(a=!1){if(!this._position)return;let i=this._position;if(a&&(i=Object.assign(Object.create(null),this._position),i.temporary=!0),!this._destination){this._pushOrReplaceState(i);return}if(this._destination.temporary){this._pushOrReplaceState(i,!0);return}if(this._destination.hash===i.hash||!this._destination.page&&this._numPositionUpdates<=D)return;let I=!1;if(this._destination.page>=i.first&&this._destination.page<=i.page){if(this._destination.dest!==void 0||!this._destination.first)return;I=!0}this._pushOrReplaceState(i,I)}_isValidPage(a){return Number.isInteger(a)&&a>0&&a<=this.linkService.pagesCount}_isValidState(a,i=!1){if(!a)return!1;if(a.fingerprint!==this._fingerprint)if(i){if(typeof a.fingerprint!="string"||a.fingerprint.length!==this._fingerprint.length)return!1;const[I]=performance.getEntriesByType("navigation");if((I==null?void 0:I.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(a.uid)||a.uid<0||a.destination===null||typeof a.destination!="object")}_updateInternalState(a,i,I=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),I&&a!=null&&a.temporary&&delete a.temporary,this._destination=a,this._uid=i,this._maxUid=Math.max(this._maxUid,i),this._numPositionUpdates=0}_parseCurrentHash(a=!1){const i=unescape(d()).substring(1),I=(0,Z.parseQueryString)(i),g=I.get("nameddest")||"";let o=I.get("page")|0;return(!this._isValidPage(o)||a&&g.length>0)&&(o=null),{hash:i,page:o,rotation:this.linkService.rotation}}_updateViewarea({location:a}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:a.pdfOpenParams.substring(1),page:this.linkService.page,first:a.pageNumber,rotation:a.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},m))}_popState({state:a}){const i=d(),I=this._currentHash!==i;if(this._currentHash=i,!a){this._uid++;const{hash:o,page:X,rotation:b}=this._parseCurrentHash();this._pushOrReplaceState({hash:o,page:X,rotation:b},!0);return}if(!this._isValidState(a))return;this._popStateInProgress=!0,I&&(this._blockHashChange++,(0,p.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:j}).then(()=>{this._blockHashChange--}));const g=a.destination;this._updateInternalState(g,a.uid,!0),(0,Z.isValidRotation)(g.rotation)&&(this.linkService.rotation=g.rotation),g.dest?this.linkService.goToDestination(g.dest):g.hash?this.linkService.setHash(g.hash):g.page&&(this.linkService.page=g.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}T.PDFHistory=C;function l(Y,a){return typeof Y!="string"||typeof a!="string"?!1:Y===a||(0,Z.parseQueryString)(Y).get("nameddest")===a}function B(Y,a){function i(I,g){if(typeof I!=typeof g||Array.isArray(I)||Array.isArray(g))return!1;if(I!==null&&typeof I=="object"&&g!==null){if(Object.keys(I).length!==Object.keys(g).length)return!1;for(const o in I)if(!i(I[o],g[o]))return!1;return!0}return I===g||Number.isNaN(I)&&Number.isNaN(g)}if(!(Array.isArray(Y)&&Array.isArray(a))||Y.length!==a.length)return!1;for(let I=0,g=Y.length;I<g;I++)if(!i(Y[I],a[I]))return!1;return!0}},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.PDFScriptingManager=void 0;var Z=r(7),p=r(3);class j{constructor({eventBus:m,sandboxBundleSrc:d=null,scriptingFactory:C=null,docPropertiesLookup:l=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=m,this._sandboxBundleSrc=d,this._scriptingFactory=C,this._docPropertiesLookup=l,this._scriptingFactory||window.addEventListener("updatefromsandbox",B=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:B.detail})})}setViewer(m){this._pdfViewer=m}async setDocument(m){var d;if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=m,!m)return;const[C,l,B]=await Promise.all([m.getFieldObjects(),m.getCalculationOrderIds(),m.getJSActions()]);if(!C&&!B){await this._destroyScripting();return}if(m===this._pdfDocument){try{this._scripting=this._createScripting()}catch(Y){console.error(`PDFScriptingManager.setDocument: "${Y==null?void 0:Y.message}".`),await this._destroyScripting();return}this._internalEvents.set("updatefromsandbox",Y=>{(Y==null?void 0:Y.source)===window&&this._updateFromSandbox(Y.detail)}),this._internalEvents.set("dispatcheventinsandbox",Y=>{var a;(a=this._scripting)==null||a.dispatchEventInSandbox(Y.detail)}),this._internalEvents.set("pagechanging",({pageNumber:Y,previous:a})=>{Y!==a&&(this._dispatchPageClose(a),this._dispatchPageOpen(Y))}),this._internalEvents.set("pagerendered",({pageNumber:Y})=>{this._pageOpenPending.has(Y)&&Y===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(Y)}),this._internalEvents.set("pagesdestroy",async Y=>{var a,i;await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await((a=this._scripting)==null?void 0:a.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(i=this._closeCapability)==null||i.resolve()}),this._domEvents.set("mousedown",Y=>{this._mouseState.isDown=!0}),this._domEvents.set("mouseup",Y=>{this._mouseState.isDown=!1});for(const[Y,a]of this._internalEvents)this._eventBus._on(Y,a);for(const[Y,a]of this._domEvents)window.addEventListener(Y,a,!0);try{const Y=await this._getDocProperties();if(m!==this._pdfDocument)return;await this._scripting.createSandbox({objects:C,calculationOrder:l,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...Y,actions:B}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(Y){console.error(`PDFScriptingManager.setDocument: "${Y==null?void 0:Y.message}".`),await this._destroyScripting();return}await((d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{m===this._pdfDocument&&(this._ready=!0)})}}async dispatchWillSave(m){var d;return(d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(m){var d;return(d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(m){var d;return(d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(m){var d;return(d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get mouseState(){return this._mouseState}get destroyPromise(){var m;return((m=this._destroyCapability)==null?void 0:m.promise)||null}get ready(){return this._ready}get _internalEvents(){return(0,p.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,p.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,p.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,p.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(m){var d;const C=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:l,siblings:B,command:Y,value:a}=m;if(!l){switch(Y){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(C)return;const I=(0,Z.apiPageLayoutToViewerModes)(a);this._pdfViewer.spreadMode=I.spreadMode;break;case"page-num":this._pdfViewer.currentPageNumber=a+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":if(C)return;this._pdfViewer.currentScaleValue=a;break;case"SaveAs":this._eventBus.dispatch("download",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(C)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(C)return;this._pdfViewer.decreaseScale();break}return}if(C&&m.focus)return;delete m.id,delete m.siblings;const i=B?[l,...B]:[l];for(const I of i){const g=document.querySelector(`[data-element-id="${I}"]`);g?g.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:m})):(d=this._pdfDocument)==null||d.annotationStorage.setValue(I,m)}}async _dispatchPageOpen(m,d=!1){const C=this._pdfDocument,l=this._visitedPages;if(d&&(this._closeCapability=(0,p.createPromiseCapability)()),!this._closeCapability)return;const B=this._pdfViewer.getPageView(m-1);if((B==null?void 0:B.renderingState)!==Z.RenderingStates.FINISHED){this._pageOpenPending.add(m);return}this._pageOpenPending.delete(m);const Y=(async()=>{var a,i;const I=await(l.has(m)?null:(a=B.pdfPage)==null?void 0:a.getJSActions());C===this._pdfDocument&&await((i=this._scripting)==null?void 0:i.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:m,actions:I}))})();l.set(m,Y)}async _dispatchPageClose(m){var d;const C=this._pdfDocument,l=this._visitedPages;if(!this._closeCapability||this._pageOpenPending.has(m))return;const B=l.get(m);B&&(l.set(m,null),await B,C===this._pdfDocument&&await((d=this._scripting)==null?void 0:d.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:m})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:m}=r(26);return m(this._pdfDocument)}_createScripting(){if(this._destroyCapability=(0,p.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:m}=r(26);return new m(this._sandboxBundleSrc)}async _destroyScripting(){var m,d;if(!this._scripting){this._pdfDocument=null,(m=this._destroyCapability)==null||m.resolve();return}this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise(C=>{setTimeout(C,1e3)})]).catch(C=>{}),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch{}for(const[C,l]of this._internalEvents)this._eventBus._off(C,l);this._internalEvents.clear();for(const[C,l]of this._domEvents)window.removeEventListener(C,l,!0);this._domEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,delete this._mouseState.isDown,this._ready=!1,(d=this._destroyCapability)==null||d.resolve()}}T.PDFScriptingManager=j},(z,T,r)=>{Object.defineProperty(T,"__esModule",{value:!0}),T.GenericScripting=void 0,T.docPropertiesLookup=p;var Z=r(3);async function p(D){const m="",d=m.split("#")[0];let{info:C,metadata:l,contentDispositionFilename:B,contentLength:Y}=await D.getMetadata();if(!Y){const{length:a}=await D.getDownloadInfo();Y=a}return{...C,baseURL:d,filesize:Y,filename:B||(0,Z.getPdfFilenameFromUrl)(m),metadata:l==null?void 0:l.getRaw(),authors:l==null?void 0:l.get("dc:creator"),numPages:D.numPages,URL:m}}class j{constructor(m){this._ready=(0,Z.loadScript)(m,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(m){(await this._ready).create(m)}async dispatchEventInSandbox(m){const d=await this._ready;setTimeout(()=>d.dispatchEvent(m),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}T.GenericScripting=j}],h={};function M(z){var T=h[z];if(T!==void 0)return T.exports;var r=h[z]={exports:{}};return $[z](r,r.exports,M),r.exports}var _={};return(()=>{var z=_;Object.defineProperty(z,"__esModule",{value:!0}),Object.defineProperty(z,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return j.AnnotationLayerBuilder}}),Object.defineProperty(z,"DefaultAnnotationLayerFactory",{enumerable:!0,get:function(){return T.DefaultAnnotationLayerFactory}}),Object.defineProperty(z,"DefaultStructTreeLayerFactory",{enumerable:!0,get:function(){return T.DefaultStructTreeLayerFactory}}),Object.defineProperty(z,"DefaultTextLayerFactory",{enumerable:!0,get:function(){return T.DefaultTextLayerFactory}}),Object.defineProperty(z,"DefaultXfaLayerFactory",{enumerable:!0,get:function(){return T.DefaultXfaLayerFactory}}),Object.defineProperty(z,"DownloadManager",{enumerable:!0,get:function(){return D.DownloadManager}}),Object.defineProperty(z,"EventBus",{enumerable:!0,get:function(){return m.EventBus}}),Object.defineProperty(z,"GenericL10n",{enumerable:!0,get:function(){return d.GenericL10n}}),Object.defineProperty(z,"LinkTarget",{enumerable:!0,get:function(){return r.LinkTarget}}),Object.defineProperty(z,"NullL10n",{enumerable:!0,get:function(){return C.NullL10n}}),Object.defineProperty(z,"PDFFindController",{enumerable:!0,get:function(){return l.PDFFindController}}),Object.defineProperty(z,"PDFHistory",{enumerable:!0,get:function(){return B.PDFHistory}}),Object.defineProperty(z,"PDFLinkService",{enumerable:!0,get:function(){return r.PDFLinkService}}),Object.defineProperty(z,"PDFPageView",{enumerable:!0,get:function(){return Y.PDFPageView}}),Object.defineProperty(z,"PDFScriptingManager",{enumerable:!0,get:function(){return a.PDFScriptingManager}}),Object.defineProperty(z,"PDFSinglePageViewer",{enumerable:!0,get:function(){return p.PDFSinglePageViewer}}),Object.defineProperty(z,"PDFViewer",{enumerable:!0,get:function(){return p.PDFViewer}}),Object.defineProperty(z,"ProgressBar",{enumerable:!0,get:function(){return Z.ProgressBar}}),Object.defineProperty(z,"RenderingStates",{enumerable:!0,get:function(){return Z.RenderingStates}}),Object.defineProperty(z,"ScrollMode",{enumerable:!0,get:function(){return Z.ScrollMode}}),Object.defineProperty(z,"SimpleLinkService",{enumerable:!0,get:function(){return r.SimpleLinkService}}),Object.defineProperty(z,"SpreadMode",{enumerable:!0,get:function(){return Z.SpreadMode}}),Object.defineProperty(z,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return i.StructTreeLayerBuilder}}),Object.defineProperty(z,"TextLayerBuilder",{enumerable:!0,get:function(){return I.TextLayerBuilder}}),Object.defineProperty(z,"XfaLayerBuilder",{enumerable:!0,get:function(){return g.XfaLayerBuilder}}),Object.defineProperty(z,"parseQueryString",{enumerable:!0,get:function(){return Z.parseQueryString}});var T=M(1),r=M(6),Z=M(7),p=M(11),j=M(5),D=M(18),m=M(19),d=M(20),C=M(4),l=M(22),B=M(24),Y=M(13),a=M(25),i=M(8),I=M(9),g=M(10)})(),_})())})(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;const INTERNAL_LINK="internal-link",LINK="link",FILE_ATTACHMENT="file-attachment",FORM_TEXT="form-text",FORM_SELECT="form-select",FORM_CHECKBOX="form-checkbox",FORM_RADIO="form-radio",FORM_BUTTON="form-button",EVENTS_TO_HANDLER=["click","dblclick","mouseover","input","change"];function getAnnotationsByKey(wI,c,$){const h=[];if($)for(const M of $)M[wI]===c&&h.push(M);return h}function buildAnnotationData(wI,c){return{type:wI,data:c}}function inputAnnotation(wI,c){switch(wI.type){case"textarea":case"text":return buildAnnotationData(FORM_TEXT,{fieldName:wI.name,value:wI.value});case"select-one":case"select-multiple":const $=[];for(const M of wI.options)$.push({value:M.value,label:M.label});const h=[];for(const M of wI.selectedOptions)h.push({value:M.value,label:M.label});return buildAnnotationData(FORM_SELECT,{fieldName:wI.name,value:h,options:$});case"checkbox":return buildAnnotationData(FORM_CHECKBOX,{fieldName:wI.name,checked:wI.checked});case"radio":return buildAnnotationData(FORM_RADIO,{fieldName:wI.name,...c});case"button":return buildAnnotationData(FORM_BUTTON,{fieldName:wI.name,...c})}}function fileAnnotation(wI){return buildAnnotationData(FILE_ATTACHMENT,wI.file)}async function linkAnnotation(wI,c){if(wI.dest){if(typeof wI.dest=="string")return buildAnnotationData(INTERNAL_LINK,{referencedPage:Number(wI.dest.substring(1,wI.dest.length)),offset:null});{const $=await c.getPageIndex(wI.dest[0]);return buildAnnotationData(INTERNAL_LINK,{referencedPage:$+1,offset:{left:wI.dest[2],bottom:wI.dest[3]}})}}else if(wI.url)return buildAnnotationData(LINK,{url:wI.url,unsafeUrl:wI.unsafeUrl})}function annotationEventsHandler(wI,c,$){var h;let M=wI.target.parentNode;if(M.tagName==="DIV"&&(M=M.firstChild),M.className==="linkAnnotation"&&wI.type==="click"){const _=(h=M.dataset)==null?void 0:h.annotationId;if(_)return linkAnnotation(getAnnotationsByKey("id",_,$)[0],c)}else if(["popupAnnotation","textAnnotation","fileAttachmentAnnotation"].includes(M.className)){for(const _ of M.getElementsByTagName("span")){let z=_.textContent;const T=JSON.parse(_.dataset.l10nArgs??"{}");if(z)for(const r in T)z=z.replace(`{{${r}}}`,T[r]);_.textContent=z}if(M.className==="fileAttachmentAnnotation"&&wI.type==="dblclick"){const _=M.dataset.annotationId;if(_)return fileAnnotation(getAnnotationsByKey("id",_,$)[0])}}else if(M.className==="textWidgetAnnotation"&&wI.type==="input"){let _=M.getElementsByTagName("input")[0];return _||(_=M.getElementsByTagName("textarea")[0]),inputAnnotation(_)}else{if(M.className==="choiceWidgetAnnotation"&&wI.type==="input")return inputAnnotation(M.getElementsByTagName("select")[0]);if(M.className==="buttonWidgetAnnotation checkBox"&&wI.type==="change")return inputAnnotation(M.getElementsByTagName("input")[0]);if(M.className==="buttonWidgetAnnotation radioButton"&&wI.type==="change"){const _=M.dataset.annotationId;if(_){const z=getAnnotationsByKey("id",_,$)[0],T=[];for(const r of getAnnotationsByKey("fieldName",z.fieldName,$))r.buttonValue&&T.push(r.buttonValue);return inputAnnotation(M.getElementsByTagName("input")[0],{value:z.buttonValue,defaultValue:z.fieldValue,options:T})}}else if(M.className==="buttonWidgetAnnotation pushButton"&&wI.type==="click"){const _=M.dataset.annotationId;if(_){const z=getAnnotationsByKey("id",_,$)[0];return z.resetForm?inputAnnotation({name:z.fieldName,type:"button"},{actions:z.actions,reset:!0}):inputAnnotation({name:z.fieldName,type:"button"},{actions:z.actions,reset:!1})}}}}const _sfc_main=defineComponent({__name:"VuePDF",props:{pdf:null,page:{default:1},scale:{default:1},rotation:null,fitParent:{type:Boolean},annotationsFilter:null,textLayer:{type:Boolean},annotationLayer:{type:Boolean}},emits:["annotation","loaded"],setup(wI,{expose:c,emit:$}){const h=wI,M=ref(),_=ref(),z=ref(),T=ref(),r=ref(),Z=ref(!0);let p=[],j=null,D=!1,m=!1,d={};function C(g){$("loaded",g)}function l(g){$("annotation",g)}function B(g){const o=annotationEventsHandler(g,j,p);Promise.resolve(o).then(X=>{X&&l(X)})}function Y(g){j==null||j.getPage(g).then(o=>{let X=!1,b=h.scale;if(h.fitParent){const nI=T.value.parentNode.clientWidth,gI=o.getViewport({scale:1}).width;b=nI/gI}const N={scale:b};typeof h.rotation=="number"&&h.rotation%90===0&&(N.rotation=h.rotation);const F=o.getViewport(N),hI=M.value.getContext("2d");M.value.width=F.width,M.value.height=F.height,M.value.style.width=`${F.width}px`,M.value.style.height=`${F.height}px`,r.value.style.width=`${F.width}px`,r.value.style.height=`${F.height}px`;const YI={canvasContext:hI,viewport:F};o.render(YI).promise.then(()=>{Z.value=!1,h.textLayer&&o.getTextContent().then(nI=>{_.value.style.height=`${M.value.offsetHeight}px`,_.value.style.width=`${M.value.offsetWidth}px`;const gI=new pdf_viewerExports.TextLayerBuilder({textLayerDiv:_.value,pageIndex:o._pageIndex,eventBus:new pdf_viewerExports.EventBus,viewport:F,enhanceTextSelection:!1});gI.setTextContent(nI),gI.render(),D=!0}),h.annotationLayer&&(X=!0,o.getAnnotations().then(nI=>{z.value.style.height=`${M.value.offsetHeight}px`,z.value.style.width=`${M.value.offsetWidth}px`,h.annotationsFilter&&(nI=nI.filter(U=>{const II=h.annotationsFilter,q=U.subtype,mI=U.fieldType?`${q}.${U.fieldType}`:null;return(II==null?void 0:II.includes(q))||mI!==null&&(II==null?void 0:II.includes(mI))}));const gI=new Map([]);for(const U of nI)if(U.subtype==="Widget"&&U.fieldType==="Btn"&&U.pushButton){const II=U.rect[2]-U.rect[0],q=U.rect[3]-U.rect[1],mI=document.createElement("canvas");mI.setAttribute("width",(II*b).toString()),mI.setAttribute("height",(q*b).toString()),gI.set(U.id,mI)}pdfExports.AnnotationLayer.render({annotations:nI,viewport:F.clone({dontFlip:!0}),page:o,linkService:new pdf_viewerExports.SimpleLinkService,div:z.value,enableScripting:!0,hasJSActions:!0,annotationCanvasMap:gI,fieldObjects:d}),p=nI,m=!0,C({...F,annotations:p});for(const U of EVENTS_TO_HANDLER)z.value.addEventListener(U,B)})),X||C(F)})})}function a(){var g,o,X,b,N,F;(o=(g=_.value).replaceChildren)==null||o.call(g),(b=(X=z.value).replaceChildren)==null||b.call(X);for(const hI of EVENTS_TO_HANDLER)(F=(N=z.value).removeEventListener)==null||F.call(N,hI,B)}function i(g){g.promise.then(o=>{j=o,j.getFieldObjects().then(X=>{X&&(d=X)}),Y(h.page)})}watch(()=>h.pdf,g=>{g!==void 0&&(a(),i(g))}),watch(()=>h.textLayer,g=>{g&&(D||Y(h.page))}),watch(()=>h.annotationLayer,g=>{g&&(m||Y(h.page))}),watch(()=>h.annotationsFilter,()=>{a(),Y(h.page)}),watch(()=>h.scale,g=>{a(),Y(h.page)}),watch(()=>h.rotation,g=>{a(),Y(h.page)}),watch(()=>h.page,g=>{a(),Y(g)}),onMounted(()=>{h.pdf!==void 0&&i(h.pdf)});function I(){a(),Y(h.page)}return c({reload:I}),(g,o)=>(openBlock(),createElementBlock("span",{ref_key:"ContainerREF",ref:T,style:{position:"relative",display:"inline-block"}},[createBaseVNode("canvas",{ref_key:"CanvasREF",ref:M,style:{display:"inline-block"}},null,512),withDirectives(createBaseVNode("div",{ref_key:"AnnotationlayerREF",ref:z,class:"annotationLayer",style:{display:"block"}},null,512),[[vShow,wI.annotationLayer]]),withDirectives(createBaseVNode("div",{ref_key:"TextlayerREF",ref:_,class:"textLayer",style:{display:"block"}},null,512),[[vShow,wI.textLayer]]),withDirectives(createBaseVNode("div",{ref_key:"LoadlayerREF",ref:r,style:{display:"block"},class:"loadingLayer"},[renderSlot(g.$slots,"default")],512),[[vShow,Z.value]])],512))}}),PDFWorker="data:application/javascript;base64,LyoqCiAqIEBsaWNzdGFydCBUaGUgZm9sbG93aW5nIGlzIHRoZSBlbnRpcmUgbGljZW5zZSBub3RpY2UgZm9yIHRoZQogKiBKYXZhU2NyaXB0IGNvZGUgaW4gdGhpcyBwYWdlCiAqCiAqIENvcHlyaWdodCAyMDIyIE1vemlsbGEgRm91bmRhdGlvbgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBAbGljZW5kIFRoZSBhYm92ZSBpcyB0aGUgZW50aXJlIGxpY2Vuc2Ugbm90aWNlIGZvciB0aGUKICogSmF2YVNjcmlwdCBjb2RlIGluIHRoaXMgcGFnZQogKi8KCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gcm9vdC5wZGZqc1dvcmtlciA9IGZhY3RvcnkoKTsKfSkoZ2xvYmFsVGhpcywgKCkgPT4gewpyZXR1cm4gLyoqKioqKi8gKCgpID0+IHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJInVzZSBzdHJpY3QiOwovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVzX18gPSAoWwovKiAwICovLAovKiAxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuV29ya2VyVGFzayA9IGV4cG9ydHMuV29ya2VyTWVzc2FnZUhhbmRsZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX3BkZl9tYW5hZ2VyID0gX193X3BkZmpzX3JlcXVpcmVfXyg4KTsKCnZhciBfY2xlYW51cF9oZWxwZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcxKTsKCnZhciBfd3JpdGVyID0gX193X3BkZmpzX3JlcXVpcmVfXyg2NSk7Cgp2YXIgX2lzX25vZGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQpOwoKdmFyIF9tZXNzYWdlX2hhbmRsZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMik7Cgp2YXIgX3dvcmtlcl9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMyk7CgpjbGFzcyBXb3JrZXJUYXNrIHsKICBjb25zdHJ1Y3RvcihuYW1lKSB7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy50ZXJtaW5hdGVkID0gZmFsc2U7CiAgICB0aGlzLl9jYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogIH0KCiAgZ2V0IGZpbmlzaGVkKCkgewogICAgcmV0dXJuIHRoaXMuX2NhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIGZpbmlzaCgpIHsKICAgIHRoaXMuX2NhcGFiaWxpdHkucmVzb2x2ZSgpOwogIH0KCiAgdGVybWluYXRlKCkgewogICAgdGhpcy50ZXJtaW5hdGVkID0gdHJ1ZTsKICB9CgogIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKSB7CiAgICBpZiAodGhpcy50ZXJtaW5hdGVkKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV29ya2VyIHRhc2sgd2FzIHRlcm1pbmF0ZWQiKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLldvcmtlclRhc2sgPSBXb3JrZXJUYXNrOwoKY2xhc3MgV29ya2VyTWVzc2FnZUhhbmRsZXIgewogIHN0YXRpYyBzZXR1cChoYW5kbGVyLCBwb3J0KSB7CiAgICBsZXQgdGVzdE1lc3NhZ2VQcm9jZXNzZWQgPSBmYWxzZTsKICAgIGhhbmRsZXIub24oInRlc3QiLCBmdW5jdGlvbiB3cGhTZXR1cFRlc3QoZGF0YSkgewogICAgICBpZiAodGVzdE1lc3NhZ2VQcm9jZXNzZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRlc3RNZXNzYWdlUHJvY2Vzc2VkID0gdHJ1ZTsKICAgICAgaGFuZGxlci5zZW5kKCJ0ZXN0IiwgZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJjb25maWd1cmUiLCBmdW5jdGlvbiB3cGhDb25maWd1cmUoZGF0YSkgewogICAgICAoMCwgX3V0aWwuc2V0VmVyYm9zaXR5TGV2ZWwpKGRhdGEudmVyYm9zaXR5KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RG9jUmVxdWVzdCIsIGZ1bmN0aW9uIHdwaFNldHVwRG9jKGRhdGEpIHsKICAgICAgcmV0dXJuIFdvcmtlck1lc3NhZ2VIYW5kbGVyLmNyZWF0ZURvY3VtZW50SGFuZGxlcihkYXRhLCBwb3J0KTsKICAgIH0pOwogIH0KCiAgc3RhdGljIGNyZWF0ZURvY3VtZW50SGFuZGxlcihkb2NQYXJhbXMsIHBvcnQpIHsKICAgIGxldCBwZGZNYW5hZ2VyOwogICAgbGV0IHRlcm1pbmF0ZWQgPSBmYWxzZTsKICAgIGxldCBjYW5jZWxYSFJzID0gbnVsbDsKICAgIGNvbnN0IFdvcmtlclRhc2tzID0gW107CiAgICBjb25zdCB2ZXJib3NpdHkgPSAoMCwgX3V0aWwuZ2V0VmVyYm9zaXR5TGV2ZWwpKCk7CiAgICBjb25zdCBhcGlWZXJzaW9uID0gZG9jUGFyYW1zLmFwaVZlcnNpb247CiAgICBjb25zdCB3b3JrZXJWZXJzaW9uID0gJzIuMTYuMTA1JzsKCiAgICBpZiAoYXBpVmVyc2lvbiAhPT0gd29ya2VyVmVyc2lvbikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBBUEkgdmVyc2lvbiAiJHthcGlWZXJzaW9ufSIgZG9lcyBub3QgbWF0Y2ggYCArIGB0aGUgV29ya2VyIHZlcnNpb24gIiR7d29ya2VyVmVyc2lvbn0iLmApOwogICAgfQoKICAgIGNvbnN0IGVudW1lcmFibGVQcm9wZXJ0aWVzID0gW107CgogICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBbXSkgewogICAgICBlbnVtZXJhYmxlUHJvcGVydGllcy5wdXNoKHByb3BlcnR5KTsKICAgIH0KCiAgICBpZiAoZW51bWVyYWJsZVByb3BlcnRpZXMubGVuZ3RoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlIGBBcnJheS5wcm90b3R5cGVgIGNvbnRhaW5zIHVuZXhwZWN0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0aWVzOiAiICsgZW51bWVyYWJsZVByb3BlcnRpZXMuam9pbigiLCAiKSArICI7IHRodXMgYnJlYWtpbmcgZS5nLiBgZm9yLi4uaW5gIGl0ZXJhdGlvbiBvZiBgQXJyYXlgcy4iKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIFJlYWRhYmxlU3RyZWFtID09PSAidW5kZWZpbmVkIikgewogICAgICBjb25zdCBwYXJ0aWFsTXNnID0gIlRoZSBicm93c2VyL2Vudmlyb25tZW50IGxhY2tzIG5hdGl2ZSBzdXBwb3J0IGZvciBjcml0aWNhbCAiICsgImZ1bmN0aW9uYWxpdHkgdXNlZCBieSB0aGUgUERGLmpzIGxpYnJhcnkgKGUuZy4gYFJlYWRhYmxlU3RyZWFtYCk7ICI7CgogICAgICBpZiAoX2lzX25vZGUuaXNOb2RlSlMpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IocGFydGlhbE1zZyArICJwbGVhc2UgdXNlIGEgYGxlZ2FjeWAtYnVpbGQgaW5zdGVhZC4iKTsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKHBhcnRpYWxNc2cgKyAicGxlYXNlIHVwZGF0ZSB0byBhIHN1cHBvcnRlZCBicm93c2VyLiIpOwogICAgfQoKICAgIGNvbnN0IGRvY0lkID0gZG9jUGFyYW1zLmRvY0lkOwogICAgY29uc3QgZG9jQmFzZVVybCA9IGRvY1BhcmFtcy5kb2NCYXNlVXJsOwogICAgY29uc3Qgd29ya2VySGFuZGxlck5hbWUgPSBkb2NQYXJhbXMuZG9jSWQgKyAiX3dvcmtlciI7CiAgICBsZXQgaGFuZGxlciA9IG5ldyBfbWVzc2FnZV9oYW5kbGVyLk1lc3NhZ2VIYW5kbGVyKHdvcmtlckhhbmRsZXJOYW1lLCBkb2NJZCwgcG9ydCk7CgogICAgZnVuY3Rpb24gZW5zdXJlTm90VGVybWluYXRlZCgpIHsKICAgICAgaWYgKHRlcm1pbmF0ZWQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIldvcmtlciB3YXMgdGVybWluYXRlZCIpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc3RhcnRXb3JrZXJUYXNrKHRhc2spIHsKICAgICAgV29ya2VyVGFza3MucHVzaCh0YXNrKTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5pc2hXb3JrZXJUYXNrKHRhc2spIHsKICAgICAgdGFzay5maW5pc2goKTsKICAgICAgY29uc3QgaSA9IFdvcmtlclRhc2tzLmluZGV4T2YodGFzayk7CiAgICAgIFdvcmtlclRhc2tzLnNwbGljZShpLCAxKTsKICAgIH0KCiAgICBhc3luYyBmdW5jdGlvbiBsb2FkRG9jdW1lbnQocmVjb3ZlcnlNb2RlKSB7CiAgICAgIGF3YWl0IHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJjaGVja0hlYWRlciIpOwogICAgICBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygicGFyc2VTdGFydFhSZWYiKTsKICAgICAgYXdhaXQgcGRmTWFuYWdlci5lbnN1cmVEb2MoInBhcnNlIiwgW3JlY292ZXJ5TW9kZV0pOwogICAgICBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiY2hlY2tGaXJzdFBhZ2UiLCBbcmVjb3ZlcnlNb2RlXSk7CiAgICAgIGF3YWl0IHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJjaGVja0xhc3RQYWdlIiwgW3JlY292ZXJ5TW9kZV0pOwogICAgICBjb25zdCBpc1B1cmVYZmEgPSBhd2FpdCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiaXNQdXJlWGZhIik7CgogICAgICBpZiAoaXNQdXJlWGZhKSB7CiAgICAgICAgY29uc3QgdGFzayA9IG5ldyBXb3JrZXJUYXNrKCJsb2FkWGZhRm9udHMiKTsKICAgICAgICBzdGFydFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIubG9hZFhmYUZvbnRzKGhhbmRsZXIsIHRhc2spLmNhdGNoKHJlYXNvbiA9PiB7fSkudGhlbigoKSA9PiBmaW5pc2hXb3JrZXJUYXNrKHRhc2spKSwgcGRmTWFuYWdlci5sb2FkWGZhSW1hZ2VzKCldKTsKICAgICAgfQoKICAgICAgY29uc3QgW251bVBhZ2VzLCBmaW5nZXJwcmludHNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIuZW5zdXJlRG9jKCJudW1QYWdlcyIpLCBwZGZNYW5hZ2VyLmVuc3VyZURvYygiZmluZ2VycHJpbnRzIildKTsKICAgICAgY29uc3QgaHRtbEZvclhmYSA9IGlzUHVyZVhmYSA/IGF3YWl0IHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJodG1sRm9yWGZhIikgOiBudWxsOwogICAgICByZXR1cm4gewogICAgICAgIG51bVBhZ2VzLAogICAgICAgIGZpbmdlcnByaW50cywKICAgICAgICBodG1sRm9yWGZhCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0UGRmTWFuYWdlcihkYXRhLCBldmFsdWF0b3JPcHRpb25zLCBlbmFibGVYZmEpIHsKICAgICAgY29uc3QgcGRmTWFuYWdlckNhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgICAgIGxldCBuZXdQZGZNYW5hZ2VyOwogICAgICBjb25zdCBzb3VyY2UgPSBkYXRhLnNvdXJjZTsKCiAgICAgIGlmIChzb3VyY2UuZGF0YSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBuZXdQZGZNYW5hZ2VyID0gbmV3IF9wZGZfbWFuYWdlci5Mb2NhbFBkZk1hbmFnZXIoZG9jSWQsIHNvdXJjZS5kYXRhLCBzb3VyY2UucGFzc3dvcmQsIGhhbmRsZXIsIGV2YWx1YXRvck9wdGlvbnMsIGVuYWJsZVhmYSwgZG9jQmFzZVVybCk7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZXNvbHZlKG5ld1BkZk1hbmFnZXIpOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0KCiAgICAgIGxldCBwZGZTdHJlYW0sCiAgICAgICAgICBjYWNoZWRDaHVua3MgPSBbXTsKCiAgICAgIHRyeSB7CiAgICAgICAgcGRmU3RyZWFtID0gbmV3IF93b3JrZXJfc3RyZWFtLlBERldvcmtlclN0cmVhbShoYW5kbGVyKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIHJldHVybiBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9CgogICAgICBjb25zdCBmdWxsUmVxdWVzdCA9IHBkZlN0cmVhbS5nZXRGdWxsUmVhZGVyKCk7CiAgICAgIGZ1bGxSZXF1ZXN0LmhlYWRlcnNSZWFkeS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWZ1bGxSZXF1ZXN0LmlzUmFuZ2VTdXBwb3J0ZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGRpc2FibGVBdXRvRmV0Y2ggPSBzb3VyY2UuZGlzYWJsZUF1dG9GZXRjaCB8fCBmdWxsUmVxdWVzdC5pc1N0cmVhbWluZ1N1cHBvcnRlZDsKICAgICAgICBuZXdQZGZNYW5hZ2VyID0gbmV3IF9wZGZfbWFuYWdlci5OZXR3b3JrUGRmTWFuYWdlcihkb2NJZCwgcGRmU3RyZWFtLCB7CiAgICAgICAgICBtc2dIYW5kbGVyOiBoYW5kbGVyLAogICAgICAgICAgcGFzc3dvcmQ6IHNvdXJjZS5wYXNzd29yZCwKICAgICAgICAgIGxlbmd0aDogZnVsbFJlcXVlc3QuY29udGVudExlbmd0aCwKICAgICAgICAgIGRpc2FibGVBdXRvRmV0Y2gsCiAgICAgICAgICByYW5nZUNodW5rU2l6ZTogc291cmNlLnJhbmdlQ2h1bmtTaXplCiAgICAgICAgfSwgZXZhbHVhdG9yT3B0aW9ucywgZW5hYmxlWGZhLCBkb2NCYXNlVXJsKTsKCiAgICAgICAgZm9yIChjb25zdCBjaHVuayBvZiBjYWNoZWRDaHVua3MpIHsKICAgICAgICAgIG5ld1BkZk1hbmFnZXIuc2VuZFByb2dyZXNzaXZlRGF0YShjaHVuayk7CiAgICAgICAgfQoKICAgICAgICBjYWNoZWRDaHVua3MgPSBbXTsKICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZXNvbHZlKG5ld1BkZk1hbmFnZXIpOwogICAgICAgIGNhbmNlbFhIUnMgPSBudWxsOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVqZWN0KHJlYXNvbik7CiAgICAgICAgY2FuY2VsWEhScyA9IG51bGw7CiAgICAgIH0pOwogICAgICBsZXQgbG9hZGVkID0gMDsKCiAgICAgIGNvbnN0IGZsdXNoQ2h1bmtzID0gZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnN0IHBkZkZpbGUgPSAoMCwgX3V0aWwuYXJyYXlzVG9CeXRlcykoY2FjaGVkQ2h1bmtzKTsKCiAgICAgICAgaWYgKHNvdXJjZS5sZW5ndGggJiYgcGRmRmlsZS5sZW5ndGggIT09IHNvdXJjZS5sZW5ndGgpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgicmVwb3J0ZWQgSFRUUCBsZW5ndGggaXMgZGlmZmVyZW50IGZyb20gYWN0dWFsIik7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgbmV3UGRmTWFuYWdlciA9IG5ldyBfcGRmX21hbmFnZXIuTG9jYWxQZGZNYW5hZ2VyKGRvY0lkLCBwZGZGaWxlLCBzb3VyY2UucGFzc3dvcmQsIGhhbmRsZXIsIGV2YWx1YXRvck9wdGlvbnMsIGVuYWJsZVhmYSwgZG9jQmFzZVVybCk7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZXNvbHZlKG5ld1BkZk1hbmFnZXIpOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIH0KCiAgICAgICAgY2FjaGVkQ2h1bmtzID0gW107CiAgICAgIH07CgogICAgICBjb25zdCByZWFkUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBjb25zdCByZWFkQ2h1bmsgPSBmdW5jdGlvbiAoewogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkb25lCiAgICAgICAgfSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwoKICAgICAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgICAgICBpZiAoIW5ld1BkZk1hbmFnZXIpIHsKICAgICAgICAgICAgICAgIGZsdXNoQ2h1bmtzKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxvYWRlZCArPSAoMCwgX3V0aWwuYXJyYXlCeXRlTGVuZ3RoKSh2YWx1ZSk7CgogICAgICAgICAgICBpZiAoIWZ1bGxSZXF1ZXN0LmlzU3RyZWFtaW5nU3VwcG9ydGVkKSB7CiAgICAgICAgICAgICAgaGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgICAgICAgICAgIGxvYWRlZCwKICAgICAgICAgICAgICAgIHRvdGFsOiBNYXRoLm1heChsb2FkZWQsIGZ1bGxSZXF1ZXN0LmNvbnRlbnRMZW5ndGggfHwgMCkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG5ld1BkZk1hbmFnZXIpIHsKICAgICAgICAgICAgICBuZXdQZGZNYW5hZ2VyLnNlbmRQcm9ncmVzc2l2ZURhdGEodmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNhY2hlZENodW5rcy5wdXNoKHZhbHVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVsbFJlcXVlc3QucmVhZCgpLnRoZW4ocmVhZENodW5rLCByZWplY3QpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgZnVsbFJlcXVlc3QucmVhZCgpLnRoZW4ocmVhZENodW5rLCByZWplY3QpOwogICAgICB9KTsKICAgICAgcmVhZFByb21pc2UuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZSk7CiAgICAgICAgY2FuY2VsWEhScyA9IG51bGw7CiAgICAgIH0pOwoKICAgICAgY2FuY2VsWEhScyA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBwZGZTdHJlYW0uY2FuY2VsQWxsUmVxdWVzdHMocmVhc29uKTsKICAgICAgfTsKCiAgICAgIHJldHVybiBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldHVwRG9jKGRhdGEpIHsKICAgICAgZnVuY3Rpb24gb25TdWNjZXNzKGRvYykgewogICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgICBoYW5kbGVyLnNlbmQoIkdldERvYyIsIHsKICAgICAgICAgIHBkZkluZm86IGRvYwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBvbkZhaWx1cmUoZXgpIHsKICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CgogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF91dGlsLlBhc3N3b3JkRXhjZXB0aW9uKSB7CiAgICAgICAgICBjb25zdCB0YXNrID0gbmV3IFdvcmtlclRhc2soYFBhc3N3b3JkRXhjZXB0aW9uOiByZXNwb25zZSAke2V4LmNvZGV9YCk7CiAgICAgICAgICBzdGFydFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgICBoYW5kbGVyLnNlbmRXaXRoUHJvbWlzZSgiUGFzc3dvcmRSZXF1ZXN0IiwgZXgpLnRoZW4oZnVuY3Rpb24gKHsKICAgICAgICAgICAgcGFzc3dvcmQKICAgICAgICAgIH0pIHsKICAgICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKICAgICAgICAgICAgcGRmTWFuYWdlci51cGRhdGVQYXNzd29yZChwYXNzd29yZCk7CiAgICAgICAgICAgIHBkZk1hbmFnZXJSZWFkeSgpOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgICBoYW5kbGVyLnNlbmQoIkRvY0V4Y2VwdGlvbiIsIGV4KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoZXggaW5zdGFuY2VvZiBfdXRpbC5JbnZhbGlkUERGRXhjZXB0aW9uIHx8IGV4IGluc3RhbmNlb2YgX3V0aWwuTWlzc2luZ1BERkV4Y2VwdGlvbiB8fCBleCBpbnN0YW5jZW9mIF91dGlsLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiB8fCBleCBpbnN0YW5jZW9mIF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbikgewogICAgICAgICAgaGFuZGxlci5zZW5kKCJEb2NFeGNlcHRpb24iLCBleCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhhbmRsZXIuc2VuZCgiRG9jRXhjZXB0aW9uIiwgbmV3IF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbihleC5tZXNzYWdlLCBleC50b1N0cmluZygpKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBwZGZNYW5hZ2VyUmVhZHkoKSB7CiAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICAgIGxvYWREb2N1bWVudChmYWxzZSkudGhlbihvblN1Y2Nlc3MsIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKCiAgICAgICAgICBpZiAoIShyZWFzb24gaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24pKSB7CiAgICAgICAgICAgIG9uRmFpbHVyZShyZWFzb24pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgcGRmTWFuYWdlci5yZXF1ZXN0TG9hZGVkU3RyZWFtKCk7CiAgICAgICAgICBwZGZNYW5hZ2VyLm9uTG9hZGVkU3RyZWFtKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgICAgICAgbG9hZERvY3VtZW50KHRydWUpLnRoZW4ob25TdWNjZXNzLCBvbkZhaWx1cmUpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgY29uc3QgZXZhbHVhdG9yT3B0aW9ucyA9IHsKICAgICAgICBtYXhJbWFnZVNpemU6IGRhdGEubWF4SW1hZ2VTaXplLAogICAgICAgIGRpc2FibGVGb250RmFjZTogZGF0YS5kaXNhYmxlRm9udEZhY2UsCiAgICAgICAgaWdub3JlRXJyb3JzOiBkYXRhLmlnbm9yZUVycm9ycywKICAgICAgICBpc0V2YWxTdXBwb3J0ZWQ6IGRhdGEuaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIGZvbnRFeHRyYVByb3BlcnRpZXM6IGRhdGEuZm9udEV4dHJhUHJvcGVydGllcywKICAgICAgICB1c2VTeXN0ZW1Gb250czogZGF0YS51c2VTeXN0ZW1Gb250cywKICAgICAgICBjTWFwVXJsOiBkYXRhLmNNYXBVcmwsCiAgICAgICAgc3RhbmRhcmRGb250RGF0YVVybDogZGF0YS5zdGFuZGFyZEZvbnREYXRhVXJsCiAgICAgIH07CiAgICAgIGdldFBkZk1hbmFnZXIoZGF0YSwgZXZhbHVhdG9yT3B0aW9ucywgZGF0YS5lbmFibGVYZmEpLnRoZW4oZnVuY3Rpb24gKG5ld1BkZk1hbmFnZXIpIHsKICAgICAgICBpZiAodGVybWluYXRlZCkgewogICAgICAgICAgbmV3UGRmTWFuYWdlci50ZXJtaW5hdGUobmV3IF91dGlsLkFib3J0RXhjZXB0aW9uKCJXb3JrZXIgd2FzIHRlcm1pbmF0ZWQuIikpOwogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJXb3JrZXIgd2FzIHRlcm1pbmF0ZWQiKTsKICAgICAgICB9CgogICAgICAgIHBkZk1hbmFnZXIgPSBuZXdQZGZNYW5hZ2VyOwogICAgICAgIHBkZk1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKS50aGVuKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICAgIGhhbmRsZXIuc2VuZCgiRGF0YUxvYWRlZCIsIHsKICAgICAgICAgICAgbGVuZ3RoOiBzdHJlYW0uYnl0ZXMuYnl0ZUxlbmd0aAogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLnRoZW4ocGRmTWFuYWdlclJlYWR5LCBvbkZhaWx1cmUpOwogICAgfQoKICAgIGhhbmRsZXIub24oIkdldFBhZ2UiLCBmdW5jdGlvbiB3cGhTZXR1cEdldFBhZ2UoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5nZXRQYWdlKGRhdGEucGFnZUluZGV4KS50aGVuKGZ1bmN0aW9uIChwYWdlKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmVuc3VyZShwYWdlLCAicm90YXRlIiksIHBkZk1hbmFnZXIuZW5zdXJlKHBhZ2UsICJyZWYiKSwgcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgInVzZXJVbml0IiksIHBkZk1hbmFnZXIuZW5zdXJlKHBhZ2UsICJ2aWV3IildKS50aGVuKGZ1bmN0aW9uIChbcm90YXRlLCByZWYsIHVzZXJVbml0LCB2aWV3XSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcm90YXRlLAogICAgICAgICAgICByZWYsCiAgICAgICAgICAgIHVzZXJVbml0LAogICAgICAgICAgICB2aWV3CiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0UGFnZUluZGV4IiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlSW5kZXgoZGF0YSkgewogICAgICBjb25zdCBwYWdlUmVmID0gX3ByaW1pdGl2ZXMuUmVmLmdldChkYXRhLm51bSwgZGF0YS5nZW4pOwoKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0UGFnZUluZGV4IiwgW3BhZ2VSZWZdKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb25zIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXREZXN0aW5hdGlvbnMoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJkZXN0aW5hdGlvbnMiKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb24iLCBmdW5jdGlvbiB3cGhTZXR1cEdldERlc3RpbmF0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0RGVzdGluYXRpb24iLCBbZGF0YS5pZF0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGFiZWxzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGFiZWxzKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxhYmVscyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGF5b3V0IiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGF5b3V0KGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxheW91dCIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTW9kZSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0UGFnZU1vZGUoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJwYWdlTW9kZSIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRWaWV3ZXJQcmVmZXJlbmNlcyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInZpZXdlclByZWZlcmVuY2VzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wZW5BY3Rpb24iLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJvcGVuQWN0aW9uIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEF0dGFjaG1lbnRzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRBdHRhY2htZW50cyhkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImF0dGFjaG1lbnRzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEphdmFTY3JpcHQiLCBmdW5jdGlvbiB3cGhTZXR1cEdldEphdmFTY3JpcHQoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJqYXZhU2NyaXB0Iik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldERvY0pTQWN0aW9ucyIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0RG9jSlNBY3Rpb25zKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygianNBY3Rpb25zIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldFBhZ2VKU0FjdGlvbnMiLCBmdW5jdGlvbiAoewogICAgICBwYWdlSW5kZXgKICAgIH0pIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZ2V0UGFnZShwYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgImpzQWN0aW9ucyIpOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0T3V0bGluZSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0T3V0bGluZShkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImRvY3VtZW50T3V0bGluZSIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRPcHRpb25hbENvbnRlbnRDb25maWciLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJvcHRpb25hbENvbnRlbnRDb25maWciKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0UGVybWlzc2lvbnMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJwZXJtaXNzaW9ucyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRNZXRhZGF0YSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0TWV0YWRhdGEoZGF0YSkgewogICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIuZW5zdXJlRG9jKCJkb2N1bWVudEluZm8iKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJtZXRhZGF0YSIpXSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE1hcmtJbmZvIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRNYXJrSW5mbyhkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coIm1hcmtJbmZvIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldERhdGEiLCBmdW5jdGlvbiB3cGhTZXR1cEdldERhdGEoZGF0YSkgewogICAgICBwZGZNYW5hZ2VyLnJlcXVlc3RMb2FkZWRTdHJlYW0oKTsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKS50aGVuKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICByZXR1cm4gc3RyZWFtLmJ5dGVzOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0QW5ub3RhdGlvbnMiLCBmdW5jdGlvbiAoewogICAgICBwYWdlSW5kZXgsCiAgICAgIGludGVudAogICAgfSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgV29ya2VyVGFzayhgR2V0QW5ub3RhdGlvbnM6IHBhZ2UgJHtwYWdlSW5kZXh9YCk7CiAgICAgICAgc3RhcnRXb3JrZXJUYXNrKHRhc2spOwogICAgICAgIHJldHVybiBwYWdlLmdldEFubm90YXRpb25zRGF0YShoYW5kbGVyLCB0YXNrLCBpbnRlbnQpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgfSwgcmVhc29uID0+IHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRGaWVsZE9iamVjdHMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVEb2MoImZpZWxkT2JqZWN0cyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJIYXNKU0FjdGlvbnMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVEb2MoImhhc0pTQWN0aW9ucyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRDYWxjdWxhdGlvbk9yZGVySWRzIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJjYWxjdWxhdGlvbk9yZGVySWRzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIlNhdmVEb2N1bWVudCIsIGZ1bmN0aW9uICh7CiAgICAgIGlzUHVyZVhmYSwKICAgICAgbnVtUGFnZXMsCiAgICAgIGFubm90YXRpb25TdG9yYWdlLAogICAgICBmaWxlbmFtZQogICAgfSkgewogICAgICBwZGZNYW5hZ2VyLnJlcXVlc3RMb2FkZWRTdHJlYW0oKTsKICAgICAgY29uc3QgbmV3QW5ub3RhdGlvbnNCeVBhZ2UgPSAhaXNQdXJlWGZhID8gKDAsIF9jb3JlX3V0aWxzLmdldE5ld0Fubm90YXRpb25zTWFwKShhbm5vdGF0aW9uU3RvcmFnZSkgOiBudWxsOwogICAgICBjb25zdCBwcm9taXNlcyA9IFtwZGZNYW5hZ2VyLm9uTG9hZGVkU3RyZWFtKCksIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiYWNyb0Zvcm0iKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJhY3JvRm9ybVJlZiIpLCBwZGZNYW5hZ2VyLmVuc3VyZURvYygieHJlZiIpLCBwZGZNYW5hZ2VyLmVuc3VyZURvYygic3RhcnRYUmVmIildOwoKICAgICAgaWYgKG5ld0Fubm90YXRpb25zQnlQYWdlKSB7CiAgICAgICAgZm9yIChjb25zdCBbcGFnZUluZGV4LCBhbm5vdGF0aW9uc10gb2YgbmV3QW5ub3RhdGlvbnNCeVBhZ2UpIHsKICAgICAgICAgIHByb21pc2VzLnB1c2gocGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihwYWdlID0+IHsKICAgICAgICAgICAgY29uc3QgdGFzayA9IG5ldyBXb3JrZXJUYXNrKGBTYXZlIChlZGl0b3IpOiBwYWdlICR7cGFnZUluZGV4fWApOwogICAgICAgICAgICByZXR1cm4gcGFnZS5zYXZlTmV3QW5ub3RhdGlvbnMoaGFuZGxlciwgdGFzaywgYW5ub3RhdGlvbnMpLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGlzUHVyZVhmYSkgewogICAgICAgIHByb21pc2VzLnB1c2gocGRmTWFuYWdlci5zZXJpYWxpemVYZmFEYXRhKGFubm90YXRpb25TdG9yYWdlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChsZXQgcGFnZUluZGV4ID0gMDsgcGFnZUluZGV4IDwgbnVtUGFnZXM7IHBhZ2VJbmRleCsrKSB7CiAgICAgICAgICBwcm9taXNlcy5wdXNoKHBkZk1hbmFnZXIuZ2V0UGFnZShwYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICAgICAgY29uc3QgdGFzayA9IG5ldyBXb3JrZXJUYXNrKGBTYXZlOiBwYWdlICR7cGFnZUluZGV4fWApOwogICAgICAgICAgICByZXR1cm4gcGFnZS5zYXZlKGhhbmRsZXIsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoW3N0cmVhbSwgYWNyb0Zvcm0sIGFjcm9Gb3JtUmVmLCB4cmVmLCBzdGFydFhSZWYsIC4uLnJlZnNdKSB7CiAgICAgICAgbGV0IG5ld1JlZnMgPSBbXTsKICAgICAgICBsZXQgeGZhRGF0YSA9IG51bGw7CgogICAgICAgIGlmIChpc1B1cmVYZmEpIHsKICAgICAgICAgIHhmYURhdGEgPSByZWZzWzBdOwoKICAgICAgICAgIGlmICgheGZhRGF0YSkgewogICAgICAgICAgICByZXR1cm4gc3RyZWFtLmJ5dGVzOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZXdSZWZzID0gcmVmcy5mbGF0KDIpOwoKICAgICAgICAgIGlmIChuZXdSZWZzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gc3RyZWFtLmJ5dGVzOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgeGZhID0gYWNyb0Zvcm0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIGFjcm9Gb3JtLmdldCgiWEZBIikgfHwgbnVsbDsKICAgICAgICBsZXQgeGZhRGF0YXNldHNSZWYgPSBudWxsOwogICAgICAgIGxldCBoYXNYZmFEYXRhc2V0c0VudHJ5ID0gZmFsc2U7CgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHhmYSkpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHhmYS5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgICAgICAgIGlmICh4ZmFbaV0gPT09ICJkYXRhc2V0cyIpIHsKICAgICAgICAgICAgICB4ZmFEYXRhc2V0c1JlZiA9IHhmYVtpICsgMV07CiAgICAgICAgICAgICAgYWNyb0Zvcm1SZWYgPSBudWxsOwogICAgICAgICAgICAgIGhhc1hmYURhdGFzZXRzRW50cnkgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHhmYURhdGFzZXRzUmVmID09PSBudWxsKSB7CiAgICAgICAgICAgIHhmYURhdGFzZXRzUmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHhmYSkgewogICAgICAgICAgYWNyb0Zvcm1SZWYgPSBudWxsOwogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCBYRkEgdHlwZS4iKTsKICAgICAgICB9CgogICAgICAgIGxldCBuZXdYcmVmSW5mbyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICAgIGlmICh4cmVmLnRyYWlsZXIpIHsKICAgICAgICAgIGNvbnN0IGluZm9PYmogPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgICAgY29uc3QgeHJlZkluZm8gPSB4cmVmLnRyYWlsZXIuZ2V0KCJJbmZvIikgfHwgbnVsbDsKCiAgICAgICAgICBpZiAoeHJlZkluZm8gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgIHhyZWZJbmZvLmZvckVhY2goKGtleSwgdmFsdWUpID0+IHsKICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICAgICAgICAgICAgaW5mb09ialtrZXldID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKSh2YWx1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBuZXdYcmVmSW5mbyA9IHsKICAgICAgICAgICAgcm9vdFJlZjogeHJlZi50cmFpbGVyLmdldFJhdygiUm9vdCIpIHx8IG51bGwsCiAgICAgICAgICAgIGVuY3J5cHRSZWY6IHhyZWYudHJhaWxlci5nZXRSYXcoIkVuY3J5cHQiKSB8fCBudWxsLAogICAgICAgICAgICBuZXdSZWY6IHhyZWYuZ2V0TmV3UmVmKCksCiAgICAgICAgICAgIGluZm9SZWY6IHhyZWYudHJhaWxlci5nZXRSYXcoIkluZm8iKSB8fCBudWxsLAogICAgICAgICAgICBpbmZvOiBpbmZvT2JqLAogICAgICAgICAgICBmaWxlSWRzOiB4cmVmLnRyYWlsZXIuZ2V0KCJJRCIpIHx8IG51bGwsCiAgICAgICAgICAgIHN0YXJ0WFJlZiwKICAgICAgICAgICAgZmlsZW5hbWUKICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICB4cmVmLnJlc2V0TmV3UmVmKCk7CiAgICAgICAgcmV0dXJuICgwLCBfd3JpdGVyLmluY3JlbWVudGFsVXBkYXRlKSh7CiAgICAgICAgICBvcmlnaW5hbERhdGE6IHN0cmVhbS5ieXRlcywKICAgICAgICAgIHhyZWZJbmZvOiBuZXdYcmVmSW5mbywKICAgICAgICAgIG5ld1JlZnMsCiAgICAgICAgICB4cmVmLAogICAgICAgICAgaGFzWGZhOiAhIXhmYSwKICAgICAgICAgIHhmYURhdGFzZXRzUmVmLAogICAgICAgICAgaGFzWGZhRGF0YXNldHNFbnRyeSwKICAgICAgICAgIGFjcm9Gb3JtUmVmLAogICAgICAgICAgYWNyb0Zvcm0sCiAgICAgICAgICB4ZmFEYXRhCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRPcGVyYXRvckxpc3QiLCBmdW5jdGlvbiB3cGhTZXR1cFJlbmRlclBhZ2UoZGF0YSwgc2luaykgewogICAgICBjb25zdCBwYWdlSW5kZXggPSBkYXRhLnBhZ2VJbmRleDsKICAgICAgcGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgV29ya2VyVGFzayhgR2V0T3BlcmF0b3JMaXN0OiBwYWdlICR7cGFnZUluZGV4fWApOwogICAgICAgIHN0YXJ0V29ya2VyVGFzayh0YXNrKTsKICAgICAgICBjb25zdCBzdGFydCA9IHZlcmJvc2l0eSA+PSBfdXRpbC5WZXJib3NpdHlMZXZlbC5JTkZPUyA/IERhdGUubm93KCkgOiAwOwogICAgICAgIHBhZ2UuZ2V0T3BlcmF0b3JMaXN0KHsKICAgICAgICAgIGhhbmRsZXIsCiAgICAgICAgICBzaW5rLAogICAgICAgICAgdGFzaywKICAgICAgICAgIGludGVudDogZGF0YS5pbnRlbnQsCiAgICAgICAgICBjYWNoZUtleTogZGF0YS5jYWNoZUtleSwKICAgICAgICAgIGFubm90YXRpb25TdG9yYWdlOiBkYXRhLmFubm90YXRpb25TdG9yYWdlCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAob3BlcmF0b3JMaXN0SW5mbykgewogICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKCiAgICAgICAgICBpZiAoc3RhcnQpIHsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKGBwYWdlPSR7cGFnZUluZGV4ICsgMX0gLSBnZXRPcGVyYXRvckxpc3Q6IHRpbWU9YCArIGAke0RhdGUubm93KCkgLSBzdGFydH1tcywgbGVuPSR7b3BlcmF0b3JMaXN0SW5mby5sZW5ndGh9YCk7CiAgICAgICAgICB9CgogICAgICAgICAgc2luay5jbG9zZSgpOwogICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CgogICAgICAgICAgaWYgKHRhc2sudGVybWluYXRlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JPcGVyYXRvckxpc3QKICAgICAgICAgIH0pOwogICAgICAgICAgc2luay5lcnJvcihyZWFzb24pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0VGV4dENvbnRlbnQiLCBmdW5jdGlvbiB3cGhFeHRyYWN0VGV4dChkYXRhLCBzaW5rKSB7CiAgICAgIGNvbnN0IHBhZ2VJbmRleCA9IGRhdGEucGFnZUluZGV4OwogICAgICBwZGZNYW5hZ2VyLmdldFBhZ2UocGFnZUluZGV4KS50aGVuKGZ1bmN0aW9uIChwYWdlKSB7CiAgICAgICAgY29uc3QgdGFzayA9IG5ldyBXb3JrZXJUYXNrKCJHZXRUZXh0Q29udGVudDogcGFnZSAiICsgcGFnZUluZGV4KTsKICAgICAgICBzdGFydFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgY29uc3Qgc3RhcnQgPSB2ZXJib3NpdHkgPj0gX3V0aWwuVmVyYm9zaXR5TGV2ZWwuSU5GT1MgPyBEYXRlLm5vdygpIDogMDsKICAgICAgICBwYWdlLmV4dHJhY3RUZXh0Q29udGVudCh7CiAgICAgICAgICBoYW5kbGVyLAogICAgICAgICAgdGFzaywKICAgICAgICAgIHNpbmssCiAgICAgICAgICBpbmNsdWRlTWFya2VkQ29udGVudDogZGF0YS5pbmNsdWRlTWFya2VkQ29udGVudCwKICAgICAgICAgIGNvbWJpbmVUZXh0SXRlbXM6IGRhdGEuY29tYmluZVRleHRJdGVtcwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKCiAgICAgICAgICBpZiAoc3RhcnQpIHsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKGBwYWdlPSR7cGFnZUluZGV4ICsgMX0gLSBnZXRUZXh0Q29udGVudDogdGltZT1gICsgYCR7RGF0ZS5ub3coKSAtIHN0YXJ0fW1zYCk7CiAgICAgICAgICB9CgogICAgICAgICAgc2luay5jbG9zZSgpOwogICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CgogICAgICAgICAgaWYgKHRhc2sudGVybWluYXRlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgc2luay5lcnJvcihyZWFzb24pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0U3RydWN0VHJlZSIsIGZ1bmN0aW9uIHdwaEdldFN0cnVjdFRyZWUoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5nZXRQYWdlKGRhdGEucGFnZUluZGV4KS50aGVuKGZ1bmN0aW9uIChwYWdlKSB7CiAgICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlKHBhZ2UsICJnZXRTdHJ1Y3RUcmVlIik7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJGb250RmFsbGJhY2siLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5mb250RmFsbGJhY2soZGF0YS5pZCwgaGFuZGxlcik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkNsZWFudXAiLCBmdW5jdGlvbiB3cGhDbGVhbnVwKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuY2xlYW51cCh0cnVlKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiVGVybWluYXRlIiwgZnVuY3Rpb24gd3BoVGVybWluYXRlKGRhdGEpIHsKICAgICAgdGVybWluYXRlZCA9IHRydWU7CiAgICAgIGNvbnN0IHdhaXRPbiA9IFtdOwoKICAgICAgaWYgKHBkZk1hbmFnZXIpIHsKICAgICAgICBwZGZNYW5hZ2VyLnRlcm1pbmF0ZShuZXcgX3V0aWwuQWJvcnRFeGNlcHRpb24oIldvcmtlciB3YXMgdGVybWluYXRlZC4iKSk7CiAgICAgICAgY29uc3QgY2xlYW51cFByb21pc2UgPSBwZGZNYW5hZ2VyLmNsZWFudXAoKTsKICAgICAgICB3YWl0T24ucHVzaChjbGVhbnVwUHJvbWlzZSk7CiAgICAgICAgcGRmTWFuYWdlciA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF9jbGVhbnVwX2hlbHBlci5jbGVhckdsb2JhbENhY2hlcykoKTsKICAgICAgfQoKICAgICAgaWYgKGNhbmNlbFhIUnMpIHsKICAgICAgICBjYW5jZWxYSFJzKG5ldyBfdXRpbC5BYm9ydEV4Y2VwdGlvbigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkLiIpKTsKICAgICAgfQoKICAgICAgZm9yIChjb25zdCB0YXNrIG9mIFdvcmtlclRhc2tzKSB7CiAgICAgICAgd2FpdE9uLnB1c2godGFzay5maW5pc2hlZCk7CiAgICAgICAgdGFzay50ZXJtaW5hdGUoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHdhaXRPbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgaGFuZGxlci5kZXN0cm95KCk7CiAgICAgICAgaGFuZGxlciA9IG51bGw7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJSZWFkeSIsIGZ1bmN0aW9uIHdwaFJlYWR5KGRhdGEpIHsKICAgICAgc2V0dXBEb2MoZG9jUGFyYW1zKTsKICAgICAgZG9jUGFyYW1zID0gbnVsbDsKICAgIH0pOwogICAgcmV0dXJuIHdvcmtlckhhbmRsZXJOYW1lOwogIH0KCiAgc3RhdGljIGluaXRpYWxpemVGcm9tUG9ydChwb3J0KSB7CiAgICBjb25zdCBoYW5kbGVyID0gbmV3IF9tZXNzYWdlX2hhbmRsZXIuTWVzc2FnZUhhbmRsZXIoIndvcmtlciIsICJtYWluIiwgcG9ydCk7CiAgICBXb3JrZXJNZXNzYWdlSGFuZGxlci5zZXR1cChoYW5kbGVyLCBwb3J0KTsKICAgIGhhbmRsZXIuc2VuZCgicmVhZHkiLCBudWxsKTsKICB9Cgp9CgpleHBvcnRzLldvcmtlck1lc3NhZ2VIYW5kbGVyID0gV29ya2VyTWVzc2FnZUhhbmRsZXI7CgpmdW5jdGlvbiBpc01lc3NhZ2VQb3J0KG1heWJlUG9ydCkgewogIHJldHVybiB0eXBlb2YgbWF5YmVQb3J0LnBvc3RNZXNzYWdlID09PSAiZnVuY3Rpb24iICYmICJvbm1lc3NhZ2UiIGluIG1heWJlUG9ydDsKfQoKaWYgKHR5cGVvZiB3aW5kb3cgPT09ICJ1bmRlZmluZWQiICYmICFfaXNfbm9kZS5pc05vZGVKUyAmJiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgJiYgaXNNZXNzYWdlUG9ydChzZWxmKSkgewogIFdvcmtlck1lc3NhZ2VIYW5kbGVyLmluaXRpYWxpemVGcm9tUG9ydChzZWxmKTsKfQoKLyoqKi8gfSksCi8qIDIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5WZXJib3NpdHlMZXZlbCA9IGV4cG9ydHMuVXRpbCA9IGV4cG9ydHMuVW5rbm93bkVycm9yRXhjZXB0aW9uID0gZXhwb3J0cy5VbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24gPSBleHBvcnRzLlVOU1VQUE9SVEVEX0ZFQVRVUkVTID0gZXhwb3J0cy5UZXh0UmVuZGVyaW5nTW9kZSA9IGV4cG9ydHMuU3RyZWFtVHlwZSA9IGV4cG9ydHMuUmVuZGVyaW5nSW50ZW50RmxhZyA9IGV4cG9ydHMuUGVybWlzc2lvbkZsYWcgPSBleHBvcnRzLlBhc3N3b3JkUmVzcG9uc2VzID0gZXhwb3J0cy5QYXNzd29yZEV4Y2VwdGlvbiA9IGV4cG9ydHMuUGFnZUFjdGlvbkV2ZW50VHlwZSA9IGV4cG9ydHMuT1BTID0gZXhwb3J0cy5NaXNzaW5nUERGRXhjZXB0aW9uID0gZXhwb3J0cy5MSU5FX0ZBQ1RPUiA9IGV4cG9ydHMuTElORV9ERVNDRU5UX0ZBQ1RPUiA9IGV4cG9ydHMuSW52YWxpZFBERkV4Y2VwdGlvbiA9IGV4cG9ydHMuSW1hZ2VLaW5kID0gZXhwb3J0cy5JREVOVElUWV9NQVRSSVggPSBleHBvcnRzLkZvcm1hdEVycm9yID0gZXhwb3J0cy5Gb250VHlwZSA9IGV4cG9ydHMuRmVhdHVyZVRlc3QgPSBleHBvcnRzLkZPTlRfSURFTlRJVFlfTUFUUklYID0gZXhwb3J0cy5Eb2N1bWVudEFjdGlvbkV2ZW50VHlwZSA9IGV4cG9ydHMuQ01hcENvbXByZXNzaW9uVHlwZSA9IGV4cG9ydHMuQmFzZUV4Y2VwdGlvbiA9IGV4cG9ydHMuQW5ub3RhdGlvblR5cGUgPSBleHBvcnRzLkFubm90YXRpb25TdGF0ZU1vZGVsVHlwZSA9IGV4cG9ydHMuQW5ub3RhdGlvblJldmlld1N0YXRlID0gZXhwb3J0cy5Bbm5vdGF0aW9uUmVwbHlUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uTW9kZSA9IGV4cG9ydHMuQW5ub3RhdGlvbk1hcmtlZFN0YXRlID0gZXhwb3J0cy5Bbm5vdGF0aW9uRmxhZyA9IGV4cG9ydHMuQW5ub3RhdGlvbkZpZWxkRmxhZyA9IGV4cG9ydHMuQW5ub3RhdGlvbkVkaXRvclR5cGUgPSBleHBvcnRzLkFubm90YXRpb25FZGl0b3JQcmVmaXggPSBleHBvcnRzLkFubm90YXRpb25FZGl0b3JQYXJhbXNUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uQWN0aW9uRXZlbnRUeXBlID0gZXhwb3J0cy5BYm9ydEV4Y2VwdGlvbiA9IHZvaWQgMDsKZXhwb3J0cy5hcnJheUJ5dGVMZW5ndGggPSBhcnJheUJ5dGVMZW5ndGg7CmV4cG9ydHMuYXJyYXlzVG9CeXRlcyA9IGFycmF5c1RvQnl0ZXM7CmV4cG9ydHMuYXNzZXJ0ID0gYXNzZXJ0OwpleHBvcnRzLmJ5dGVzVG9TdHJpbmcgPSBieXRlc1RvU3RyaW5nOwpleHBvcnRzLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5ID0gY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHk7CmV4cG9ydHMuY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCA9IGNyZWF0ZVZhbGlkQWJzb2x1dGVVcmw7CmV4cG9ydHMuZXNjYXBlU3RyaW5nID0gZXNjYXBlU3RyaW5nOwpleHBvcnRzLmdldE1vZGlmaWNhdGlvbkRhdGUgPSBnZXRNb2RpZmljYXRpb25EYXRlOwpleHBvcnRzLmdldFZlcmJvc2l0eUxldmVsID0gZ2V0VmVyYm9zaXR5TGV2ZWw7CmV4cG9ydHMuaW5mbyA9IGluZm87CmV4cG9ydHMuaXNBcnJheUJ1ZmZlciA9IGlzQXJyYXlCdWZmZXI7CmV4cG9ydHMuaXNBcnJheUVxdWFsID0gaXNBcnJheUVxdWFsOwpleHBvcnRzLmlzQXNjaWkgPSBpc0FzY2lpOwpleHBvcnRzLm9iamVjdEZyb21NYXAgPSBvYmplY3RGcm9tTWFwOwpleHBvcnRzLm9iamVjdFNpemUgPSBvYmplY3RTaXplOwpleHBvcnRzLnNldFZlcmJvc2l0eUxldmVsID0gc2V0VmVyYm9zaXR5TGV2ZWw7CmV4cG9ydHMuc2hhZG93ID0gc2hhZG93OwpleHBvcnRzLnN0cmluZzMyID0gc3RyaW5nMzI7CmV4cG9ydHMuc3RyaW5nVG9CeXRlcyA9IHN0cmluZ1RvQnl0ZXM7CmV4cG9ydHMuc3RyaW5nVG9QREZTdHJpbmcgPSBzdHJpbmdUb1BERlN0cmluZzsKZXhwb3J0cy5zdHJpbmdUb1VURjE2QkVTdHJpbmcgPSBzdHJpbmdUb1VURjE2QkVTdHJpbmc7CmV4cG9ydHMuc3RyaW5nVG9VVEY4U3RyaW5nID0gc3RyaW5nVG9VVEY4U3RyaW5nOwpleHBvcnRzLnVucmVhY2hhYmxlID0gdW5yZWFjaGFibGU7CmV4cG9ydHMudXRmOFN0cmluZ1RvU3RyaW5nID0gdXRmOFN0cmluZ1RvU3RyaW5nOwpleHBvcnRzLndhcm4gPSB3YXJuOwoKX193X3BkZmpzX3JlcXVpcmVfXygzKTsKCmNvbnN0IElERU5USVRZX01BVFJJWCA9IFsxLCAwLCAwLCAxLCAwLCAwXTsKZXhwb3J0cy5JREVOVElUWV9NQVRSSVggPSBJREVOVElUWV9NQVRSSVg7CmNvbnN0IEZPTlRfSURFTlRJVFlfTUFUUklYID0gWzAuMDAxLCAwLCAwLCAwLjAwMSwgMCwgMF07CmV4cG9ydHMuRk9OVF9JREVOVElUWV9NQVRSSVggPSBGT05UX0lERU5USVRZX01BVFJJWDsKY29uc3QgTElORV9GQUNUT1IgPSAxLjM1OwpleHBvcnRzLkxJTkVfRkFDVE9SID0gTElORV9GQUNUT1I7CmNvbnN0IExJTkVfREVTQ0VOVF9GQUNUT1IgPSAwLjM1OwpleHBvcnRzLkxJTkVfREVTQ0VOVF9GQUNUT1IgPSBMSU5FX0RFU0NFTlRfRkFDVE9SOwpjb25zdCBSZW5kZXJpbmdJbnRlbnRGbGFnID0gewogIEFOWTogMHgwMSwKICBESVNQTEFZOiAweDAyLAogIFBSSU5UOiAweDA0LAogIEFOTk9UQVRJT05TX0ZPUk1TOiAweDEwLAogIEFOTk9UQVRJT05TX1NUT1JBR0U6IDB4MjAsCiAgQU5OT1RBVElPTlNfRElTQUJMRTogMHg0MCwKICBPUExJU1Q6IDB4MTAwCn07CmV4cG9ydHMuUmVuZGVyaW5nSW50ZW50RmxhZyA9IFJlbmRlcmluZ0ludGVudEZsYWc7CmNvbnN0IEFubm90YXRpb25Nb2RlID0gewogIERJU0FCTEU6IDAsCiAgRU5BQkxFOiAxLAogIEVOQUJMRV9GT1JNUzogMiwKICBFTkFCTEVfU1RPUkFHRTogMwp9OwpleHBvcnRzLkFubm90YXRpb25Nb2RlID0gQW5ub3RhdGlvbk1vZGU7CmNvbnN0IEFubm90YXRpb25FZGl0b3JQcmVmaXggPSAicGRmanNfaW50ZXJuYWxfZWRpdG9yXyI7CmV4cG9ydHMuQW5ub3RhdGlvbkVkaXRvclByZWZpeCA9IEFubm90YXRpb25FZGl0b3JQcmVmaXg7CmNvbnN0IEFubm90YXRpb25FZGl0b3JUeXBlID0gewogIERJU0FCTEU6IC0xLAogIE5PTkU6IDAsCiAgRlJFRVRFWFQ6IDMsCiAgSU5LOiAxNQp9OwpleHBvcnRzLkFubm90YXRpb25FZGl0b3JUeXBlID0gQW5ub3RhdGlvbkVkaXRvclR5cGU7CmNvbnN0IEFubm90YXRpb25FZGl0b3JQYXJhbXNUeXBlID0gewogIEZSRUVURVhUX1NJWkU6IDEsCiAgRlJFRVRFWFRfQ09MT1I6IDIsCiAgRlJFRVRFWFRfT1BBQ0lUWTogMywKICBJTktfQ09MT1I6IDExLAogIElOS19USElDS05FU1M6IDEyLAogIElOS19PUEFDSVRZOiAxMwp9OwpleHBvcnRzLkFubm90YXRpb25FZGl0b3JQYXJhbXNUeXBlID0gQW5ub3RhdGlvbkVkaXRvclBhcmFtc1R5cGU7CmNvbnN0IFBlcm1pc3Npb25GbGFnID0gewogIFBSSU5UOiAweDA0LAogIE1PRElGWV9DT05URU5UUzogMHgwOCwKICBDT1BZOiAweDEwLAogIE1PRElGWV9BTk5PVEFUSU9OUzogMHgyMCwKICBGSUxMX0lOVEVSQUNUSVZFX0ZPUk1TOiAweDEwMCwKICBDT1BZX0ZPUl9BQ0NFU1NJQklMSVRZOiAweDIwMCwKICBBU1NFTUJMRTogMHg0MDAsCiAgUFJJTlRfSElHSF9RVUFMSVRZOiAweDgwMAp9OwpleHBvcnRzLlBlcm1pc3Npb25GbGFnID0gUGVybWlzc2lvbkZsYWc7CmNvbnN0IFRleHRSZW5kZXJpbmdNb2RlID0gewogIEZJTEw6IDAsCiAgU1RST0tFOiAxLAogIEZJTExfU1RST0tFOiAyLAogIElOVklTSUJMRTogMywKICBGSUxMX0FERF9UT19QQVRIOiA0LAogIFNUUk9LRV9BRERfVE9fUEFUSDogNSwKICBGSUxMX1NUUk9LRV9BRERfVE9fUEFUSDogNiwKICBBRERfVE9fUEFUSDogNywKICBGSUxMX1NUUk9LRV9NQVNLOiAzLAogIEFERF9UT19QQVRIX0ZMQUc6IDQKfTsKZXhwb3J0cy5UZXh0UmVuZGVyaW5nTW9kZSA9IFRleHRSZW5kZXJpbmdNb2RlOwpjb25zdCBJbWFnZUtpbmQgPSB7CiAgR1JBWVNDQUxFXzFCUFA6IDEsCiAgUkdCXzI0QlBQOiAyLAogIFJHQkFfMzJCUFA6IDMKfTsKZXhwb3J0cy5JbWFnZUtpbmQgPSBJbWFnZUtpbmQ7CmNvbnN0IEFubm90YXRpb25UeXBlID0gewogIFRFWFQ6IDEsCiAgTElOSzogMiwKICBGUkVFVEVYVDogMywKICBMSU5FOiA0LAogIFNRVUFSRTogNSwKICBDSVJDTEU6IDYsCiAgUE9MWUdPTjogNywKICBQT0xZTElORTogOCwKICBISUdITElHSFQ6IDksCiAgVU5ERVJMSU5FOiAxMCwKICBTUVVJR0dMWTogMTEsCiAgU1RSSUtFT1VUOiAxMiwKICBTVEFNUDogMTMsCiAgQ0FSRVQ6IDE0LAogIElOSzogMTUsCiAgUE9QVVA6IDE2LAogIEZJTEVBVFRBQ0hNRU5UOiAxNywKICBTT1VORDogMTgsCiAgTU9WSUU6IDE5LAogIFdJREdFVDogMjAsCiAgU0NSRUVOOiAyMSwKICBQUklOVEVSTUFSSzogMjIsCiAgVFJBUE5FVDogMjMsCiAgV0FURVJNQVJLOiAyNCwKICBUSFJFRUQ6IDI1LAogIFJFREFDVDogMjYKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uVHlwZSA9IEFubm90YXRpb25UeXBlOwpjb25zdCBBbm5vdGF0aW9uU3RhdGVNb2RlbFR5cGUgPSB7CiAgTUFSS0VEOiAiTWFya2VkIiwKICBSRVZJRVc6ICJSZXZpZXciCn07CmV4cG9ydHMuQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlID0gQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlOwpjb25zdCBBbm5vdGF0aW9uTWFya2VkU3RhdGUgPSB7CiAgTUFSS0VEOiAiTWFya2VkIiwKICBVTk1BUktFRDogIlVubWFya2VkIgp9OwpleHBvcnRzLkFubm90YXRpb25NYXJrZWRTdGF0ZSA9IEFubm90YXRpb25NYXJrZWRTdGF0ZTsKY29uc3QgQW5ub3RhdGlvblJldmlld1N0YXRlID0gewogIEFDQ0VQVEVEOiAiQWNjZXB0ZWQiLAogIFJFSkVDVEVEOiAiUmVqZWN0ZWQiLAogIENBTkNFTExFRDogIkNhbmNlbGxlZCIsCiAgQ09NUExFVEVEOiAiQ29tcGxldGVkIiwKICBOT05FOiAiTm9uZSIKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uUmV2aWV3U3RhdGUgPSBBbm5vdGF0aW9uUmV2aWV3U3RhdGU7CmNvbnN0IEFubm90YXRpb25SZXBseVR5cGUgPSB7CiAgR1JPVVA6ICJHcm91cCIsCiAgUkVQTFk6ICJSIgp9OwpleHBvcnRzLkFubm90YXRpb25SZXBseVR5cGUgPSBBbm5vdGF0aW9uUmVwbHlUeXBlOwpjb25zdCBBbm5vdGF0aW9uRmxhZyA9IHsKICBJTlZJU0lCTEU6IDB4MDEsCiAgSElEREVOOiAweDAyLAogIFBSSU5UOiAweDA0LAogIE5PWk9PTTogMHgwOCwKICBOT1JPVEFURTogMHgxMCwKICBOT1ZJRVc6IDB4MjAsCiAgUkVBRE9OTFk6IDB4NDAsCiAgTE9DS0VEOiAweDgwLAogIFRPR0dMRU5PVklFVzogMHgxMDAsCiAgTE9DS0VEQ09OVEVOVFM6IDB4MjAwCn07CmV4cG9ydHMuQW5ub3RhdGlvbkZsYWcgPSBBbm5vdGF0aW9uRmxhZzsKY29uc3QgQW5ub3RhdGlvbkZpZWxkRmxhZyA9IHsKICBSRUFET05MWTogMHgwMDAwMDAxLAogIFJFUVVJUkVEOiAweDAwMDAwMDIsCiAgTk9FWFBPUlQ6IDB4MDAwMDAwNCwKICBNVUxUSUxJTkU6IDB4MDAwMTAwMCwKICBQQVNTV09SRDogMHgwMDAyMDAwLAogIE5PVE9HR0xFVE9PRkY6IDB4MDAwNDAwMCwKICBSQURJTzogMHgwMDA4MDAwLAogIFBVU0hCVVRUT046IDB4MDAxMDAwMCwKICBDT01CTzogMHgwMDIwMDAwLAogIEVESVQ6IDB4MDA0MDAwMCwKICBTT1JUOiAweDAwODAwMDAsCiAgRklMRVNFTEVDVDogMHgwMTAwMDAwLAogIE1VTFRJU0VMRUNUOiAweDAyMDAwMDAsCiAgRE9OT1RTUEVMTENIRUNLOiAweDA0MDAwMDAsCiAgRE9OT1RTQ1JPTEw6IDB4MDgwMDAwMCwKICBDT01COiAweDEwMDAwMDAsCiAgUklDSFRFWFQ6IDB4MjAwMDAwMCwKICBSQURJT1NJTlVOSVNPTjogMHgyMDAwMDAwLAogIENPTU1JVE9OU0VMQ0hBTkdFOiAweDQwMDAwMDAKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uRmllbGRGbGFnID0gQW5ub3RhdGlvbkZpZWxkRmxhZzsKY29uc3QgQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZSA9IHsKICBTT0xJRDogMSwKICBEQVNIRUQ6IDIsCiAgQkVWRUxFRDogMywKICBJTlNFVDogNCwKICBVTkRFUkxJTkU6IDUKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlID0gQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZTsKY29uc3QgQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZSA9IHsKICBFOiAiTW91c2UgRW50ZXIiLAogIFg6ICJNb3VzZSBFeGl0IiwKICBEOiAiTW91c2UgRG93biIsCiAgVTogIk1vdXNlIFVwIiwKICBGbzogIkZvY3VzIiwKICBCbDogIkJsdXIiLAogIFBPOiAiUGFnZU9wZW4iLAogIFBDOiAiUGFnZUNsb3NlIiwKICBQVjogIlBhZ2VWaXNpYmxlIiwKICBQSTogIlBhZ2VJbnZpc2libGUiLAogIEs6ICJLZXlzdHJva2UiLAogIEY6ICJGb3JtYXQiLAogIFY6ICJWYWxpZGF0ZSIsCiAgQzogIkNhbGN1bGF0ZSIKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uQWN0aW9uRXZlbnRUeXBlID0gQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZTsKY29uc3QgRG9jdW1lbnRBY3Rpb25FdmVudFR5cGUgPSB7CiAgV0M6ICJXaWxsQ2xvc2UiLAogIFdTOiAiV2lsbFNhdmUiLAogIERTOiAiRGlkU2F2ZSIsCiAgV1A6ICJXaWxsUHJpbnQiLAogIERQOiAiRGlkUHJpbnQiCn07CmV4cG9ydHMuRG9jdW1lbnRBY3Rpb25FdmVudFR5cGUgPSBEb2N1bWVudEFjdGlvbkV2ZW50VHlwZTsKY29uc3QgUGFnZUFjdGlvbkV2ZW50VHlwZSA9IHsKICBPOiAiUGFnZU9wZW4iLAogIEM6ICJQYWdlQ2xvc2UiCn07CmV4cG9ydHMuUGFnZUFjdGlvbkV2ZW50VHlwZSA9IFBhZ2VBY3Rpb25FdmVudFR5cGU7CmNvbnN0IFN0cmVhbVR5cGUgPSB7CiAgVU5LTk9XTjogIlVOS05PV04iLAogIEZMQVRFOiAiRkxBVEUiLAogIExaVzogIkxaVyIsCiAgRENUOiAiRENUIiwKICBKUFg6ICJKUFgiLAogIEpCSUc6ICJKQklHIiwKICBBODU6ICJBODUiLAogIEFIWDogIkFIWCIsCiAgQ0NGOiAiQ0NGIiwKICBSTFg6ICJSTFgiCn07CmV4cG9ydHMuU3RyZWFtVHlwZSA9IFN0cmVhbVR5cGU7CmNvbnN0IEZvbnRUeXBlID0gewogIFVOS05PV046ICJVTktOT1dOIiwKICBUWVBFMTogIlRZUEUxIiwKICBUWVBFMVNUQU5EQVJEOiAiVFlQRTFTVEFOREFSRCIsCiAgVFlQRTFDOiAiVFlQRTFDIiwKICBDSURGT05UVFlQRTA6ICJDSURGT05UVFlQRTAiLAogIENJREZPTlRUWVBFMEM6ICJDSURGT05UVFlQRTBDIiwKICBUUlVFVFlQRTogIlRSVUVUWVBFIiwKICBDSURGT05UVFlQRTI6ICJDSURGT05UVFlQRTIiLAogIFRZUEUzOiAiVFlQRTMiLAogIE9QRU5UWVBFOiAiT1BFTlRZUEUiLAogIFRZUEUwOiAiVFlQRTAiLAogIE1NVFlQRTE6ICJNTVRZUEUxIgp9OwpleHBvcnRzLkZvbnRUeXBlID0gRm9udFR5cGU7CmNvbnN0IFZlcmJvc2l0eUxldmVsID0gewogIEVSUk9SUzogMCwKICBXQVJOSU5HUzogMSwKICBJTkZPUzogNQp9OwpleHBvcnRzLlZlcmJvc2l0eUxldmVsID0gVmVyYm9zaXR5TGV2ZWw7CmNvbnN0IENNYXBDb21wcmVzc2lvblR5cGUgPSB7CiAgTk9ORTogMCwKICBCSU5BUlk6IDEsCiAgU1RSRUFNOiAyCn07CmV4cG9ydHMuQ01hcENvbXByZXNzaW9uVHlwZSA9IENNYXBDb21wcmVzc2lvblR5cGU7CmNvbnN0IE9QUyA9IHsKICBkZXBlbmRlbmN5OiAxLAogIHNldExpbmVXaWR0aDogMiwKICBzZXRMaW5lQ2FwOiAzLAogIHNldExpbmVKb2luOiA0LAogIHNldE1pdGVyTGltaXQ6IDUsCiAgc2V0RGFzaDogNiwKICBzZXRSZW5kZXJpbmdJbnRlbnQ6IDcsCiAgc2V0RmxhdG5lc3M6IDgsCiAgc2V0R1N0YXRlOiA5LAogIHNhdmU6IDEwLAogIHJlc3RvcmU6IDExLAogIHRyYW5zZm9ybTogMTIsCiAgbW92ZVRvOiAxMywKICBsaW5lVG86IDE0LAogIGN1cnZlVG86IDE1LAogIGN1cnZlVG8yOiAxNiwKICBjdXJ2ZVRvMzogMTcsCiAgY2xvc2VQYXRoOiAxOCwKICByZWN0YW5nbGU6IDE5LAogIHN0cm9rZTogMjAsCiAgY2xvc2VTdHJva2U6IDIxLAogIGZpbGw6IDIyLAogIGVvRmlsbDogMjMsCiAgZmlsbFN0cm9rZTogMjQsCiAgZW9GaWxsU3Ryb2tlOiAyNSwKICBjbG9zZUZpbGxTdHJva2U6IDI2LAogIGNsb3NlRU9GaWxsU3Ryb2tlOiAyNywKICBlbmRQYXRoOiAyOCwKICBjbGlwOiAyOSwKICBlb0NsaXA6IDMwLAogIGJlZ2luVGV4dDogMzEsCiAgZW5kVGV4dDogMzIsCiAgc2V0Q2hhclNwYWNpbmc6IDMzLAogIHNldFdvcmRTcGFjaW5nOiAzNCwKICBzZXRIU2NhbGU6IDM1LAogIHNldExlYWRpbmc6IDM2LAogIHNldEZvbnQ6IDM3LAogIHNldFRleHRSZW5kZXJpbmdNb2RlOiAzOCwKICBzZXRUZXh0UmlzZTogMzksCiAgbW92ZVRleHQ6IDQwLAogIHNldExlYWRpbmdNb3ZlVGV4dDogNDEsCiAgc2V0VGV4dE1hdHJpeDogNDIsCiAgbmV4dExpbmU6IDQzLAogIHNob3dUZXh0OiA0NCwKICBzaG93U3BhY2VkVGV4dDogNDUsCiAgbmV4dExpbmVTaG93VGV4dDogNDYsCiAgbmV4dExpbmVTZXRTcGFjaW5nU2hvd1RleHQ6IDQ3LAogIHNldENoYXJXaWR0aDogNDgsCiAgc2V0Q2hhcldpZHRoQW5kQm91bmRzOiA0OSwKICBzZXRTdHJva2VDb2xvclNwYWNlOiA1MCwKICBzZXRGaWxsQ29sb3JTcGFjZTogNTEsCiAgc2V0U3Ryb2tlQ29sb3I6IDUyLAogIHNldFN0cm9rZUNvbG9yTjogNTMsCiAgc2V0RmlsbENvbG9yOiA1NCwKICBzZXRGaWxsQ29sb3JOOiA1NSwKICBzZXRTdHJva2VHcmF5OiA1NiwKICBzZXRGaWxsR3JheTogNTcsCiAgc2V0U3Ryb2tlUkdCQ29sb3I6IDU4LAogIHNldEZpbGxSR0JDb2xvcjogNTksCiAgc2V0U3Ryb2tlQ01ZS0NvbG9yOiA2MCwKICBzZXRGaWxsQ01ZS0NvbG9yOiA2MSwKICBzaGFkaW5nRmlsbDogNjIsCiAgYmVnaW5JbmxpbmVJbWFnZTogNjMsCiAgYmVnaW5JbWFnZURhdGE6IDY0LAogIGVuZElubGluZUltYWdlOiA2NSwKICBwYWludFhPYmplY3Q6IDY2LAogIG1hcmtQb2ludDogNjcsCiAgbWFya1BvaW50UHJvcHM6IDY4LAogIGJlZ2luTWFya2VkQ29udGVudDogNjksCiAgYmVnaW5NYXJrZWRDb250ZW50UHJvcHM6IDcwLAogIGVuZE1hcmtlZENvbnRlbnQ6IDcxLAogIGJlZ2luQ29tcGF0OiA3MiwKICBlbmRDb21wYXQ6IDczLAogIHBhaW50Rm9ybVhPYmplY3RCZWdpbjogNzQsCiAgcGFpbnRGb3JtWE9iamVjdEVuZDogNzUsCiAgYmVnaW5Hcm91cDogNzYsCiAgZW5kR3JvdXA6IDc3LAogIGJlZ2luQW5ub3RhdGlvbnM6IDc4LAogIGVuZEFubm90YXRpb25zOiA3OSwKICBiZWdpbkFubm90YXRpb246IDgwLAogIGVuZEFubm90YXRpb246IDgxLAogIHBhaW50SnBlZ1hPYmplY3Q6IDgyLAogIHBhaW50SW1hZ2VNYXNrWE9iamVjdDogODMsCiAgcGFpbnRJbWFnZU1hc2tYT2JqZWN0R3JvdXA6IDg0LAogIHBhaW50SW1hZ2VYT2JqZWN0OiA4NSwKICBwYWludElubGluZUltYWdlWE9iamVjdDogODYsCiAgcGFpbnRJbmxpbmVJbWFnZVhPYmplY3RHcm91cDogODcsCiAgcGFpbnRJbWFnZVhPYmplY3RSZXBlYXQ6IDg4LAogIHBhaW50SW1hZ2VNYXNrWE9iamVjdFJlcGVhdDogODksCiAgcGFpbnRTb2xpZENvbG9ySW1hZ2VNYXNrOiA5MCwKICBjb25zdHJ1Y3RQYXRoOiA5MQp9OwpleHBvcnRzLk9QUyA9IE9QUzsKY29uc3QgVU5TVVBQT1JURURfRkVBVFVSRVMgPSB7CiAgdW5rbm93bjogInVua25vd24iLAogIGZvcm1zOiAiZm9ybXMiLAogIGphdmFTY3JpcHQ6ICJqYXZhU2NyaXB0IiwKICBzaWduYXR1cmVzOiAic2lnbmF0dXJlcyIsCiAgc21hc2s6ICJzbWFzayIsCiAgc2hhZGluZ1BhdHRlcm46ICJzaGFkaW5nUGF0dGVybiIsCiAgZm9udDogImZvbnQiLAogIGVycm9yVGlsaW5nUGF0dGVybjogImVycm9yVGlsaW5nUGF0dGVybiIsCiAgZXJyb3JFeHRHU3RhdGU6ICJlcnJvckV4dEdTdGF0ZSIsCiAgZXJyb3JYT2JqZWN0OiAiZXJyb3JYT2JqZWN0IiwKICBlcnJvckZvbnRMb2FkVHlwZTM6ICJlcnJvckZvbnRMb2FkVHlwZTMiLAogIGVycm9yRm9udFN0YXRlOiAiZXJyb3JGb250U3RhdGUiLAogIGVycm9yRm9udE1pc3Npbmc6ICJlcnJvckZvbnRNaXNzaW5nIiwKICBlcnJvckZvbnRUcmFuc2xhdGU6ICJlcnJvckZvbnRUcmFuc2xhdGUiLAogIGVycm9yQ29sb3JTcGFjZTogImVycm9yQ29sb3JTcGFjZSIsCiAgZXJyb3JPcGVyYXRvckxpc3Q6ICJlcnJvck9wZXJhdG9yTGlzdCIsCiAgZXJyb3JGb250VG9Vbmljb2RlOiAiZXJyb3JGb250VG9Vbmljb2RlIiwKICBlcnJvckZvbnRMb2FkTmF0aXZlOiAiZXJyb3JGb250TG9hZE5hdGl2ZSIsCiAgZXJyb3JGb250QnVpbGRQYXRoOiAiZXJyb3JGb250QnVpbGRQYXRoIiwKICBlcnJvckZvbnRHZXRQYXRoOiAiZXJyb3JGb250R2V0UGF0aCIsCiAgZXJyb3JNYXJrZWRDb250ZW50OiAiZXJyb3JNYXJrZWRDb250ZW50IiwKICBlcnJvckNvbnRlbnRTdWJTdHJlYW06ICJlcnJvckNvbnRlbnRTdWJTdHJlYW0iCn07CmV4cG9ydHMuVU5TVVBQT1JURURfRkVBVFVSRVMgPSBVTlNVUFBPUlRFRF9GRUFUVVJFUzsKY29uc3QgUGFzc3dvcmRSZXNwb25zZXMgPSB7CiAgTkVFRF9QQVNTV09SRDogMSwKICBJTkNPUlJFQ1RfUEFTU1dPUkQ6IDIKfTsKZXhwb3J0cy5QYXNzd29yZFJlc3BvbnNlcyA9IFBhc3N3b3JkUmVzcG9uc2VzOwpsZXQgdmVyYm9zaXR5ID0gVmVyYm9zaXR5TGV2ZWwuV0FSTklOR1M7CgpmdW5jdGlvbiBzZXRWZXJib3NpdHlMZXZlbChsZXZlbCkgewogIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGxldmVsKSkgewogICAgdmVyYm9zaXR5ID0gbGV2ZWw7CiAgfQp9CgpmdW5jdGlvbiBnZXRWZXJib3NpdHlMZXZlbCgpIHsKICByZXR1cm4gdmVyYm9zaXR5Owp9CgpmdW5jdGlvbiBpbmZvKG1zZykgewogIGlmICh2ZXJib3NpdHkgPj0gVmVyYm9zaXR5TGV2ZWwuSU5GT1MpIHsKICAgIGNvbnNvbGUubG9nKGBJbmZvOiAke21zZ31gKTsKICB9Cn0KCmZ1bmN0aW9uIHdhcm4obXNnKSB7CiAgaWYgKHZlcmJvc2l0eSA+PSBWZXJib3NpdHlMZXZlbC5XQVJOSU5HUykgewogICAgY29uc29sZS5sb2coYFdhcm5pbmc6ICR7bXNnfWApOwogIH0KfQoKZnVuY3Rpb24gdW5yZWFjaGFibGUobXNnKSB7CiAgdGhyb3cgbmV3IEVycm9yKG1zZyk7Cn0KCmZ1bmN0aW9uIGFzc2VydChjb25kLCBtc2cpIHsKICBpZiAoIWNvbmQpIHsKICAgIHVucmVhY2hhYmxlKG1zZyk7CiAgfQp9CgpmdW5jdGlvbiBfaXNWYWxpZFByb3RvY29sKHVybCkgewogIGlmICghdXJsKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBzd2l0Y2ggKHVybC5wcm90b2NvbCkgewogICAgY2FzZSAiaHR0cDoiOgogICAgY2FzZSAiaHR0cHM6IjoKICAgIGNhc2UgImZ0cDoiOgogICAgY2FzZSAibWFpbHRvOiI6CiAgICBjYXNlICJ0ZWw6IjoKICAgICAgcmV0dXJuIHRydWU7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCh1cmwsIGJhc2VVcmwgPSBudWxsLCBvcHRpb25zID0gbnVsbCkgewogIGlmICghdXJsKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHRyeSB7CiAgICBpZiAob3B0aW9ucyAmJiB0eXBlb2YgdXJsID09PSAic3RyaW5nIikgewogICAgICBpZiAob3B0aW9ucy5hZGREZWZhdWx0UHJvdG9jb2wgJiYgdXJsLnN0YXJ0c1dpdGgoInd3dy4iKSkgewogICAgICAgIGNvbnN0IGRvdHMgPSB1cmwubWF0Y2goL1wuL2cpOwoKICAgICAgICBpZiAoZG90cyAmJiBkb3RzLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgICB1cmwgPSBgaHR0cDovLyR7dXJsfWA7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50cnlDb252ZXJ0RW5jb2RpbmcpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdXJsID0gc3RyaW5nVG9VVEY4U3RyaW5nKHVybCk7CiAgICAgICAgfSBjYXRjaCAoZXgpIHt9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBhYnNvbHV0ZVVybCA9IGJhc2VVcmwgPyBuZXcgVVJMKHVybCwgYmFzZVVybCkgOiBuZXcgVVJMKHVybCk7CgogICAgaWYgKF9pc1ZhbGlkUHJvdG9jb2woYWJzb2x1dGVVcmwpKSB7CiAgICAgIHJldHVybiBhYnNvbHV0ZVVybDsKICAgIH0KICB9IGNhdGNoIChleCkge30KCiAgcmV0dXJuIG51bGw7Cn0KCmZ1bmN0aW9uIHNoYWRvdyhvYmosIHByb3AsIHZhbHVlKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgcHJvcCwgewogICAgdmFsdWUsCiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgd3JpdGFibGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIHZhbHVlOwp9Cgpjb25zdCBCYXNlRXhjZXB0aW9uID0gZnVuY3Rpb24gQmFzZUV4Y2VwdGlvbkNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQmFzZUV4Y2VwdGlvbihtZXNzYWdlLCBuYW1lKSB7CiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gQmFzZUV4Y2VwdGlvbikgewogICAgICB1bnJlYWNoYWJsZSgiQ2Fubm90IGluaXRpYWxpemUgQmFzZUV4Y2VwdGlvbi4iKTsKICAgIH0KCiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgdGhpcy5uYW1lID0gbmFtZTsKICB9CgogIEJhc2VFeGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CiAgQmFzZUV4Y2VwdGlvbi5jb25zdHJ1Y3RvciA9IEJhc2VFeGNlcHRpb247CiAgcmV0dXJuIEJhc2VFeGNlcHRpb247Cn0oKTsKCmV4cG9ydHMuQmFzZUV4Y2VwdGlvbiA9IEJhc2VFeGNlcHRpb247CgpjbGFzcyBQYXNzd29yZEV4Y2VwdGlvbiBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZywgY29kZSkgewogICAgc3VwZXIobXNnLCAiUGFzc3dvcmRFeGNlcHRpb24iKTsKICAgIHRoaXMuY29kZSA9IGNvZGU7CiAgfQoKfQoKZXhwb3J0cy5QYXNzd29yZEV4Y2VwdGlvbiA9IFBhc3N3b3JkRXhjZXB0aW9uOwoKY2xhc3MgVW5rbm93bkVycm9yRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnLCBkZXRhaWxzKSB7CiAgICBzdXBlcihtc2csICJVbmtub3duRXJyb3JFeGNlcHRpb24iKTsKICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7CiAgfQoKfQoKZXhwb3J0cy5Vbmtub3duRXJyb3JFeGNlcHRpb24gPSBVbmtub3duRXJyb3JFeGNlcHRpb247CgpjbGFzcyBJbnZhbGlkUERGRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJJbnZhbGlkUERGRXhjZXB0aW9uIik7CiAgfQoKfQoKZXhwb3J0cy5JbnZhbGlkUERGRXhjZXB0aW9uID0gSW52YWxpZFBERkV4Y2VwdGlvbjsKCmNsYXNzIE1pc3NpbmdQREZFeGNlcHRpb24gZXh0ZW5kcyBCYXNlRXhjZXB0aW9uIHsKICBjb25zdHJ1Y3Rvcihtc2cpIHsKICAgIHN1cGVyKG1zZywgIk1pc3NpbmdQREZFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLk1pc3NpbmdQREZFeGNlcHRpb24gPSBNaXNzaW5nUERGRXhjZXB0aW9uOwoKY2xhc3MgVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uIGV4dGVuZHMgQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnLCBzdGF0dXMpIHsKICAgIHN1cGVyKG1zZywgIlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiIpOwogICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7CiAgfQoKfQoKZXhwb3J0cy5VbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24gPSBVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb247CgpjbGFzcyBGb3JtYXRFcnJvciBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiRm9ybWF0RXJyb3IiKTsKICB9Cgp9CgpleHBvcnRzLkZvcm1hdEVycm9yID0gRm9ybWF0RXJyb3I7CgpjbGFzcyBBYm9ydEV4Y2VwdGlvbiBleHRlbmRzIEJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiQWJvcnRFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLkFib3J0RXhjZXB0aW9uID0gQWJvcnRFeGNlcHRpb247CgpmdW5jdGlvbiBieXRlc1RvU3RyaW5nKGJ5dGVzKSB7CiAgaWYgKHR5cGVvZiBieXRlcyAhPT0gIm9iamVjdCIgfHwgYnl0ZXMgPT09IG51bGwgfHwgYnl0ZXMubGVuZ3RoID09PSB1bmRlZmluZWQpIHsKICAgIHVucmVhY2hhYmxlKCJJbnZhbGlkIGFyZ3VtZW50IGZvciBieXRlc1RvU3RyaW5nIik7CiAgfQoKICBjb25zdCBsZW5ndGggPSBieXRlcy5sZW5ndGg7CiAgY29uc3QgTUFYX0FSR1VNRU5UX0NPVU5UID0gODE5MjsKCiAgaWYgKGxlbmd0aCA8IE1BWF9BUkdVTUVOVF9DT1VOVCkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgYnl0ZXMpOwogIH0KCiAgY29uc3Qgc3RyQnVmID0gW107CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IE1BWF9BUkdVTUVOVF9DT1VOVCkgewogICAgY29uc3QgY2h1bmtFbmQgPSBNYXRoLm1pbihpICsgTUFYX0FSR1VNRU5UX0NPVU5ULCBsZW5ndGgpOwogICAgY29uc3QgY2h1bmsgPSBieXRlcy5zdWJhcnJheShpLCBjaHVua0VuZCk7CiAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKSk7CiAgfQoKICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb0J5dGVzKHN0cikgewogIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikgewogICAgdW5yZWFjaGFibGUoIkludmFsaWQgYXJndW1lbnQgZm9yIHN0cmluZ1RvQnl0ZXMiKTsKICB9CgogIGNvbnN0IGxlbmd0aCA9IHN0ci5sZW5ndGg7CiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICBieXRlc1tpXSA9IHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZjsKICB9CgogIHJldHVybiBieXRlczsKfQoKZnVuY3Rpb24gYXJyYXlCeXRlTGVuZ3RoKGFycikgewogIGlmIChhcnIubGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBhcnIubGVuZ3RoOwogIH0KCiAgaWYgKGFyci5ieXRlTGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBhcnIuYnl0ZUxlbmd0aDsKICB9CgogIHVucmVhY2hhYmxlKCJJbnZhbGlkIGFyZ3VtZW50IGZvciBhcnJheUJ5dGVMZW5ndGgiKTsKfQoKZnVuY3Rpb24gYXJyYXlzVG9CeXRlcyhhcnIpIHsKICBjb25zdCBsZW5ndGggPSBhcnIubGVuZ3RoOwoKICBpZiAobGVuZ3RoID09PSAxICYmIGFyclswXSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgIHJldHVybiBhcnJbMF07CiAgfQoKICBsZXQgcmVzdWx0TGVuZ3RoID0gMDsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgcmVzdWx0TGVuZ3RoICs9IGFycmF5Qnl0ZUxlbmd0aChhcnJbaV0pOwogIH0KCiAgbGV0IHBvcyA9IDA7CiAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KHJlc3VsdExlbmd0aCk7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGxldCBpdGVtID0gYXJyW2ldOwoKICAgIGlmICghKGl0ZW0gaW5zdGFuY2VvZiBVaW50OEFycmF5KSkgewogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgaXRlbSA9IHN0cmluZ1RvQnl0ZXMoaXRlbSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbSA9IG5ldyBVaW50OEFycmF5KGl0ZW0pOwogICAgICB9CiAgICB9CgogICAgY29uc3QgaXRlbUxlbmd0aCA9IGl0ZW0uYnl0ZUxlbmd0aDsKICAgIGRhdGEuc2V0KGl0ZW0sIHBvcyk7CiAgICBwb3MgKz0gaXRlbUxlbmd0aDsKICB9CgogIHJldHVybiBkYXRhOwp9CgpmdW5jdGlvbiBzdHJpbmczMih2YWx1ZSkgewogIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHZhbHVlID4+IDI0ICYgMHhmZiwgdmFsdWUgPj4gMTYgJiAweGZmLCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKfQoKZnVuY3Rpb24gb2JqZWN0U2l6ZShvYmopIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGg7Cn0KCmZ1bmN0aW9uIG9iamVjdEZyb21NYXAobWFwKSB7CiAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbWFwKSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gaXNMaXR0bGVFbmRpYW4oKSB7CiAgY29uc3QgYnVmZmVyOCA9IG5ldyBVaW50OEFycmF5KDQpOwogIGJ1ZmZlcjhbMF0gPSAxOwogIGNvbnN0IHZpZXczMiA9IG5ldyBVaW50MzJBcnJheShidWZmZXI4LmJ1ZmZlciwgMCwgMSk7CiAgcmV0dXJuIHZpZXczMlswXSA9PT0gMTsKfQoKZnVuY3Rpb24gaXNFdmFsU3VwcG9ydGVkKCkgewogIHRyeSB7CiAgICBuZXcgRnVuY3Rpb24oIiIpOwogICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKY2xhc3MgRmVhdHVyZVRlc3QgewogIHN0YXRpYyBnZXQgaXNMaXR0bGVFbmRpYW4oKSB7CiAgICByZXR1cm4gc2hhZG93KHRoaXMsICJpc0xpdHRsZUVuZGlhbiIsIGlzTGl0dGxlRW5kaWFuKCkpOwogIH0KCiAgc3RhdGljIGdldCBpc0V2YWxTdXBwb3J0ZWQoKSB7CiAgICByZXR1cm4gc2hhZG93KHRoaXMsICJpc0V2YWxTdXBwb3J0ZWQiLCBpc0V2YWxTdXBwb3J0ZWQoKSk7CiAgfQoKICBzdGF0aWMgZ2V0IGlzT2Zmc2NyZWVuQ2FudmFzU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIHNoYWRvdyh0aGlzLCAiaXNPZmZzY3JlZW5DYW52YXNTdXBwb3J0ZWQiLCB0eXBlb2YgT2Zmc2NyZWVuQ2FudmFzICE9PSAidW5kZWZpbmVkIik7CiAgfQoKfQoKZXhwb3J0cy5GZWF0dXJlVGVzdCA9IEZlYXR1cmVUZXN0Owpjb25zdCBoZXhOdW1iZXJzID0gWy4uLkFycmF5KDI1Nikua2V5cygpXS5tYXAobiA9PiBuLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpKTsKCmNsYXNzIFV0aWwgewogIHN0YXRpYyBtYWtlSGV4Q29sb3IociwgZywgYikgewogICAgcmV0dXJuIGAjJHtoZXhOdW1iZXJzW3JdfSR7aGV4TnVtYmVyc1tnXX0ke2hleE51bWJlcnNbYl19YDsKICB9CgogIHN0YXRpYyBzY2FsZU1pbk1heCh0cmFuc2Zvcm0sIG1pbk1heCkgewogICAgbGV0IHRlbXA7CgogICAgaWYgKHRyYW5zZm9ybVswXSkgewogICAgICBpZiAodHJhbnNmb3JtWzBdIDwgMCkgewogICAgICAgIHRlbXAgPSBtaW5NYXhbMF07CiAgICAgICAgbWluTWF4WzBdID0gbWluTWF4WzFdOwogICAgICAgIG1pbk1heFsxXSA9IHRlbXA7CiAgICAgIH0KCiAgICAgIG1pbk1heFswXSAqPSB0cmFuc2Zvcm1bMF07CiAgICAgIG1pbk1heFsxXSAqPSB0cmFuc2Zvcm1bMF07CgogICAgICBpZiAodHJhbnNmb3JtWzNdIDwgMCkgewogICAgICAgIHRlbXAgPSBtaW5NYXhbMl07CiAgICAgICAgbWluTWF4WzJdID0gbWluTWF4WzNdOwogICAgICAgIG1pbk1heFszXSA9IHRlbXA7CiAgICAgIH0KCiAgICAgIG1pbk1heFsyXSAqPSB0cmFuc2Zvcm1bM107CiAgICAgIG1pbk1heFszXSAqPSB0cmFuc2Zvcm1bM107CiAgICB9IGVsc2UgewogICAgICB0ZW1wID0gbWluTWF4WzBdOwogICAgICBtaW5NYXhbMF0gPSBtaW5NYXhbMl07CiAgICAgIG1pbk1heFsyXSA9IHRlbXA7CiAgICAgIHRlbXAgPSBtaW5NYXhbMV07CiAgICAgIG1pbk1heFsxXSA9IG1pbk1heFszXTsKICAgICAgbWluTWF4WzNdID0gdGVtcDsKCiAgICAgIGlmICh0cmFuc2Zvcm1bMV0gPCAwKSB7CiAgICAgICAgdGVtcCA9IG1pbk1heFsyXTsKICAgICAgICBtaW5NYXhbMl0gPSBtaW5NYXhbM107CiAgICAgICAgbWluTWF4WzNdID0gdGVtcDsKICAgICAgfQoKICAgICAgbWluTWF4WzJdICo9IHRyYW5zZm9ybVsxXTsKICAgICAgbWluTWF4WzNdICo9IHRyYW5zZm9ybVsxXTsKCiAgICAgIGlmICh0cmFuc2Zvcm1bMl0gPCAwKSB7CiAgICAgICAgdGVtcCA9IG1pbk1heFswXTsKICAgICAgICBtaW5NYXhbMF0gPSBtaW5NYXhbMV07CiAgICAgICAgbWluTWF4WzFdID0gdGVtcDsKICAgICAgfQoKICAgICAgbWluTWF4WzBdICo9IHRyYW5zZm9ybVsyXTsKICAgICAgbWluTWF4WzFdICo9IHRyYW5zZm9ybVsyXTsKICAgIH0KCiAgICBtaW5NYXhbMF0gKz0gdHJhbnNmb3JtWzRdOwogICAgbWluTWF4WzFdICs9IHRyYW5zZm9ybVs0XTsKICAgIG1pbk1heFsyXSArPSB0cmFuc2Zvcm1bNV07CiAgICBtaW5NYXhbM10gKz0gdHJhbnNmb3JtWzVdOwogIH0KCiAgc3RhdGljIHRyYW5zZm9ybShtMSwgbTIpIHsKICAgIHJldHVybiBbbTFbMF0gKiBtMlswXSArIG0xWzJdICogbTJbMV0sIG0xWzFdICogbTJbMF0gKyBtMVszXSAqIG0yWzFdLCBtMVswXSAqIG0yWzJdICsgbTFbMl0gKiBtMlszXSwgbTFbMV0gKiBtMlsyXSArIG0xWzNdICogbTJbM10sIG0xWzBdICogbTJbNF0gKyBtMVsyXSAqIG0yWzVdICsgbTFbNF0sIG0xWzFdICogbTJbNF0gKyBtMVszXSAqIG0yWzVdICsgbTFbNV1dOwogIH0KCiAgc3RhdGljIGFwcGx5VHJhbnNmb3JtKHAsIG0pIHsKICAgIGNvbnN0IHh0ID0gcFswXSAqIG1bMF0gKyBwWzFdICogbVsyXSArIG1bNF07CiAgICBjb25zdCB5dCA9IHBbMF0gKiBtWzFdICsgcFsxXSAqIG1bM10gKyBtWzVdOwogICAgcmV0dXJuIFt4dCwgeXRdOwogIH0KCiAgc3RhdGljIGFwcGx5SW52ZXJzZVRyYW5zZm9ybShwLCBtKSB7CiAgICBjb25zdCBkID0gbVswXSAqIG1bM10gLSBtWzFdICogbVsyXTsKICAgIGNvbnN0IHh0ID0gKHBbMF0gKiBtWzNdIC0gcFsxXSAqIG1bMl0gKyBtWzJdICogbVs1XSAtIG1bNF0gKiBtWzNdKSAvIGQ7CiAgICBjb25zdCB5dCA9ICgtcFswXSAqIG1bMV0gKyBwWzFdICogbVswXSArIG1bNF0gKiBtWzFdIC0gbVs1XSAqIG1bMF0pIC8gZDsKICAgIHJldHVybiBbeHQsIHl0XTsKICB9CgogIHN0YXRpYyBnZXRBeGlhbEFsaWduZWRCb3VuZGluZ0JveChyLCBtKSB7CiAgICBjb25zdCBwMSA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0ociwgbSk7CiAgICBjb25zdCBwMiA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oci5zbGljZSgyLCA0KSwgbSk7CiAgICBjb25zdCBwMyA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oW3JbMF0sIHJbM11dLCBtKTsKICAgIGNvbnN0IHA0ID0gVXRpbC5hcHBseVRyYW5zZm9ybShbclsyXSwgclsxXV0sIG0pOwogICAgcmV0dXJuIFtNYXRoLm1pbihwMVswXSwgcDJbMF0sIHAzWzBdLCBwNFswXSksIE1hdGgubWluKHAxWzFdLCBwMlsxXSwgcDNbMV0sIHA0WzFdKSwgTWF0aC5tYXgocDFbMF0sIHAyWzBdLCBwM1swXSwgcDRbMF0pLCBNYXRoLm1heChwMVsxXSwgcDJbMV0sIHAzWzFdLCBwNFsxXSldOwogIH0KCiAgc3RhdGljIGludmVyc2VUcmFuc2Zvcm0obSkgewogICAgY29uc3QgZCA9IG1bMF0gKiBtWzNdIC0gbVsxXSAqIG1bMl07CiAgICByZXR1cm4gW21bM10gLyBkLCAtbVsxXSAvIGQsIC1tWzJdIC8gZCwgbVswXSAvIGQsIChtWzJdICogbVs1XSAtIG1bNF0gKiBtWzNdKSAvIGQsIChtWzRdICogbVsxXSAtIG1bNV0gKiBtWzBdKSAvIGRdOwogIH0KCiAgc3RhdGljIGFwcGx5M2RUcmFuc2Zvcm0obSwgdikgewogICAgcmV0dXJuIFttWzBdICogdlswXSArIG1bMV0gKiB2WzFdICsgbVsyXSAqIHZbMl0sIG1bM10gKiB2WzBdICsgbVs0XSAqIHZbMV0gKyBtWzVdICogdlsyXSwgbVs2XSAqIHZbMF0gKyBtWzddICogdlsxXSArIG1bOF0gKiB2WzJdXTsKICB9CgogIHN0YXRpYyBzaW5ndWxhclZhbHVlRGVjb21wb3NlMmRTY2FsZShtKSB7CiAgICBjb25zdCB0cmFuc3Bvc2UgPSBbbVswXSwgbVsyXSwgbVsxXSwgbVszXV07CiAgICBjb25zdCBhID0gbVswXSAqIHRyYW5zcG9zZVswXSArIG1bMV0gKiB0cmFuc3Bvc2VbMl07CiAgICBjb25zdCBiID0gbVswXSAqIHRyYW5zcG9zZVsxXSArIG1bMV0gKiB0cmFuc3Bvc2VbM107CiAgICBjb25zdCBjID0gbVsyXSAqIHRyYW5zcG9zZVswXSArIG1bM10gKiB0cmFuc3Bvc2VbMl07CiAgICBjb25zdCBkID0gbVsyXSAqIHRyYW5zcG9zZVsxXSArIG1bM10gKiB0cmFuc3Bvc2VbM107CiAgICBjb25zdCBmaXJzdCA9IChhICsgZCkgLyAyOwogICAgY29uc3Qgc2Vjb25kID0gTWF0aC5zcXJ0KChhICsgZCkgKiogMiAtIDQgKiAoYSAqIGQgLSBjICogYikpIC8gMjsKICAgIGNvbnN0IHN4ID0gZmlyc3QgKyBzZWNvbmQgfHwgMTsKICAgIGNvbnN0IHN5ID0gZmlyc3QgLSBzZWNvbmQgfHwgMTsKICAgIHJldHVybiBbTWF0aC5zcXJ0KHN4KSwgTWF0aC5zcXJ0KHN5KV07CiAgfQoKICBzdGF0aWMgbm9ybWFsaXplUmVjdChyZWN0KSB7CiAgICBjb25zdCByID0gcmVjdC5zbGljZSgwKTsKCiAgICBpZiAocmVjdFswXSA+IHJlY3RbMl0pIHsKICAgICAgclswXSA9IHJlY3RbMl07CiAgICAgIHJbMl0gPSByZWN0WzBdOwogICAgfQoKICAgIGlmIChyZWN0WzFdID4gcmVjdFszXSkgewogICAgICByWzFdID0gcmVjdFszXTsKICAgICAgclszXSA9IHJlY3RbMV07CiAgICB9CgogICAgcmV0dXJuIHI7CiAgfQoKICBzdGF0aWMgaW50ZXJzZWN0KHJlY3QxLCByZWN0MikgewogICAgY29uc3QgeExvdyA9IE1hdGgubWF4KE1hdGgubWluKHJlY3QxWzBdLCByZWN0MVsyXSksIE1hdGgubWluKHJlY3QyWzBdLCByZWN0MlsyXSkpOwogICAgY29uc3QgeEhpZ2ggPSBNYXRoLm1pbihNYXRoLm1heChyZWN0MVswXSwgcmVjdDFbMl0pLCBNYXRoLm1heChyZWN0MlswXSwgcmVjdDJbMl0pKTsKCiAgICBpZiAoeExvdyA+IHhIaWdoKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHlMb3cgPSBNYXRoLm1heChNYXRoLm1pbihyZWN0MVsxXSwgcmVjdDFbM10pLCBNYXRoLm1pbihyZWN0MlsxXSwgcmVjdDJbM10pKTsKICAgIGNvbnN0IHlIaWdoID0gTWF0aC5taW4oTWF0aC5tYXgocmVjdDFbMV0sIHJlY3QxWzNdKSwgTWF0aC5tYXgocmVjdDJbMV0sIHJlY3QyWzNdKSk7CgogICAgaWYgKHlMb3cgPiB5SGlnaCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gW3hMb3csIHlMb3csIHhIaWdoLCB5SGlnaF07CiAgfQoKICBzdGF0aWMgYmV6aWVyQm91bmRpbmdCb3goeDAsIHkwLCB4MSwgeTEsIHgyLCB5MiwgeDMsIHkzKSB7CiAgICBjb25zdCB0dmFsdWVzID0gW10sCiAgICAgICAgICBib3VuZHMgPSBbW10sIFtdXTsKICAgIGxldCBhLCBiLCBjLCB0LCB0MSwgdDIsIGIyYWMsIHNxcnRiMmFjOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjsgKytpKSB7CiAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgYiA9IDYgKiB4MCAtIDEyICogeDEgKyA2ICogeDI7CiAgICAgICAgYSA9IC0zICogeDAgKyA5ICogeDEgLSA5ICogeDIgKyAzICogeDM7CiAgICAgICAgYyA9IDMgKiB4MSAtIDMgKiB4MDsKICAgICAgfSBlbHNlIHsKICAgICAgICBiID0gNiAqIHkwIC0gMTIgKiB5MSArIDYgKiB5MjsKICAgICAgICBhID0gLTMgKiB5MCArIDkgKiB5MSAtIDkgKiB5MiArIDMgKiB5MzsKICAgICAgICBjID0gMyAqIHkxIC0gMyAqIHkwOwogICAgICB9CgogICAgICBpZiAoTWF0aC5hYnMoYSkgPCAxZS0xMikgewogICAgICAgIGlmIChNYXRoLmFicyhiKSA8IDFlLTEyKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHQgPSAtYyAvIGI7CgogICAgICAgIGlmICgwIDwgdCAmJiB0IDwgMSkgewogICAgICAgICAgdHZhbHVlcy5wdXNoKHQpOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGIyYWMgPSBiICogYiAtIDQgKiBjICogYTsKICAgICAgc3FydGIyYWMgPSBNYXRoLnNxcnQoYjJhYyk7CgogICAgICBpZiAoYjJhYyA8IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdDEgPSAoLWIgKyBzcXJ0YjJhYykgLyAoMiAqIGEpOwoKICAgICAgaWYgKDAgPCB0MSAmJiB0MSA8IDEpIHsKICAgICAgICB0dmFsdWVzLnB1c2godDEpOwogICAgICB9CgogICAgICB0MiA9ICgtYiAtIHNxcnRiMmFjKSAvICgyICogYSk7CgogICAgICBpZiAoMCA8IHQyICYmIHQyIDwgMSkgewogICAgICAgIHR2YWx1ZXMucHVzaCh0Mik7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgaiA9IHR2YWx1ZXMubGVuZ3RoLAogICAgICAgIG10OwogICAgY29uc3QgamxlbiA9IGo7CgogICAgd2hpbGUgKGotLSkgewogICAgICB0ID0gdHZhbHVlc1tqXTsKICAgICAgbXQgPSAxIC0gdDsKICAgICAgYm91bmRzWzBdW2pdID0gbXQgKiBtdCAqIG10ICogeDAgKyAzICogbXQgKiBtdCAqIHQgKiB4MSArIDMgKiBtdCAqIHQgKiB0ICogeDIgKyB0ICogdCAqIHQgKiB4MzsKICAgICAgYm91bmRzWzFdW2pdID0gbXQgKiBtdCAqIG10ICogeTAgKyAzICogbXQgKiBtdCAqIHQgKiB5MSArIDMgKiBtdCAqIHQgKiB0ICogeTIgKyB0ICogdCAqIHQgKiB5MzsKICAgIH0KCiAgICBib3VuZHNbMF1bamxlbl0gPSB4MDsKICAgIGJvdW5kc1sxXVtqbGVuXSA9IHkwOwogICAgYm91bmRzWzBdW2psZW4gKyAxXSA9IHgzOwogICAgYm91bmRzWzFdW2psZW4gKyAxXSA9IHkzOwogICAgYm91bmRzWzBdLmxlbmd0aCA9IGJvdW5kc1sxXS5sZW5ndGggPSBqbGVuICsgMjsKICAgIHJldHVybiBbTWF0aC5taW4oLi4uYm91bmRzWzBdKSwgTWF0aC5taW4oLi4uYm91bmRzWzFdKSwgTWF0aC5tYXgoLi4uYm91bmRzWzBdKSwgTWF0aC5tYXgoLi4uYm91bmRzWzFdKV07CiAgfQoKfQoKZXhwb3J0cy5VdGlsID0gVXRpbDsKY29uc3QgUERGU3RyaW5nVHJhbnNsYXRlVGFibGUgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMHgyZDgsIDB4MmM3LCAweDJjNiwgMHgyZDksIDB4MmRkLCAweDJkYiwgMHgyZGEsIDB4MmRjLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAweDIwMjIsIDB4MjAyMCwgMHgyMDIxLCAweDIwMjYsIDB4MjAxNCwgMHgyMDEzLCAweDE5MiwgMHgyMDQ0LCAweDIwMzksIDB4MjAzYSwgMHgyMjEyLCAweDIwMzAsIDB4MjAxZSwgMHgyMDFjLCAweDIwMWQsIDB4MjAxOCwgMHgyMDE5LCAweDIwMWEsIDB4MjEyMiwgMHhmYjAxLCAweGZiMDIsIDB4MTQxLCAweDE1MiwgMHgxNjAsIDB4MTc4LCAweDE3ZCwgMHgxMzEsIDB4MTQyLCAweDE1MywgMHgxNjEsIDB4MTdlLCAwLCAweDIwYWNdOwoKZnVuY3Rpb24gc3RyaW5nVG9QREZTdHJpbmcoc3RyKSB7CiAgaWYgKHN0clswXSA+PSAiXHhFRiIpIHsKICAgIGxldCBlbmNvZGluZzsKCiAgICBpZiAoc3RyWzBdID09PSAiXHhGRSIgJiYgc3RyWzFdID09PSAiXHhGRiIpIHsKICAgICAgZW5jb2RpbmcgPSAidXRmLTE2YmUiOwogICAgfSBlbHNlIGlmIChzdHJbMF0gPT09ICJceEZGIiAmJiBzdHJbMV0gPT09ICJceEZFIikgewogICAgICBlbmNvZGluZyA9ICJ1dGYtMTZsZSI7CiAgICB9IGVsc2UgaWYgKHN0clswXSA9PT0gIlx4RUYiICYmIHN0clsxXSA9PT0gIlx4QkIiICYmIHN0clsyXSA9PT0gIlx4QkYiKSB7CiAgICAgIGVuY29kaW5nID0gInV0Zi04IjsKICAgIH0KCiAgICBpZiAoZW5jb2RpbmcpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKGVuY29kaW5nLCB7CiAgICAgICAgICBmYXRhbDogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGNvbnN0IGJ1ZmZlciA9IHN0cmluZ1RvQnl0ZXMoc3RyKTsKICAgICAgICByZXR1cm4gZGVjb2Rlci5kZWNvZGUoYnVmZmVyKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICB3YXJuKGBzdHJpbmdUb1BERlN0cmluZzogIiR7ZXh9Ii5gKTsKICAgICAgfQogICAgfQogIH0KCiAgY29uc3Qgc3RyQnVmID0gW107CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjb2RlID0gUERGU3RyaW5nVHJhbnNsYXRlVGFibGVbc3RyLmNoYXJDb2RlQXQoaSldOwogICAgc3RyQnVmLnB1c2goY29kZSA/IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkgOiBzdHIuY2hhckF0KGkpKTsKICB9CgogIHJldHVybiBzdHJCdWYuam9pbigiIik7Cn0KCmZ1bmN0aW9uIGVzY2FwZVN0cmluZyhzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbKClcXFxuXHJdKS9nLCBtYXRjaCA9PiB7CiAgICBpZiAobWF0Y2ggPT09ICJcbiIpIHsKICAgICAgcmV0dXJuICJcXG4iOwogICAgfSBlbHNlIGlmIChtYXRjaCA9PT0gIlxyIikgewogICAgICByZXR1cm4gIlxcciI7CiAgICB9CgogICAgcmV0dXJuIGBcXCR7bWF0Y2h9YDsKICB9KTsKfQoKZnVuY3Rpb24gaXNBc2NpaShzdHIpIHsKICByZXR1cm4gL15bXHgwMC1ceDdGXSokLy50ZXN0KHN0cik7Cn0KCmZ1bmN0aW9uIHN0cmluZ1RvVVRGMTZCRVN0cmluZyhzdHIpIHsKICBjb25zdCBidWYgPSBbIlx4RkVceEZGIl07CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICBidWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXIgPj4gOCAmIDB4ZmYpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXIgJiAweGZmKSk7CiAgfQoKICByZXR1cm4gYnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb1VURjhTdHJpbmcoc3RyKSB7CiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoc3RyKSk7Cn0KCmZ1bmN0aW9uIHV0ZjhTdHJpbmdUb1N0cmluZyhzdHIpIHsKICByZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpOwp9CgpmdW5jdGlvbiBpc0FycmF5QnVmZmVyKHYpIHsKICByZXR1cm4gdHlwZW9mIHYgPT09ICJvYmplY3QiICYmIHYgIT09IG51bGwgJiYgdi5ieXRlTGVuZ3RoICE9PSB1bmRlZmluZWQ7Cn0KCmZ1bmN0aW9uIGlzQXJyYXlFcXVhbChhcnIxLCBhcnIyKSB7CiAgaWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gYXJyMS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gZ2V0TW9kaWZpY2F0aW9uRGF0ZShkYXRlID0gbmV3IERhdGUoKSkgewogIGNvbnN0IGJ1ZmZlciA9IFtkYXRlLmdldFVUQ0Z1bGxZZWFyKCkudG9TdHJpbmcoKSwgKGRhdGUuZ2V0VVRDTW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKSwgZGF0ZS5nZXRVVENEYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpLCBkYXRlLmdldFVUQ0hvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAiMCIpLCBkYXRlLmdldFVUQ01pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIiksIGRhdGUuZ2V0VVRDU2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKV07CiAgcmV0dXJuIGJ1ZmZlci5qb2luKCIiKTsKfQoKZnVuY3Rpb24gY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkoKSB7CiAgY29uc3QgY2FwYWJpbGl0eSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgbGV0IGlzU2V0dGxlZCA9IGZhbHNlOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjYXBhYmlsaXR5LCAic2V0dGxlZCIsIHsKICAgIGdldCgpIHsKICAgICAgcmV0dXJuIGlzU2V0dGxlZDsKICAgIH0KCiAgfSk7CiAgY2FwYWJpbGl0eS5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgY2FwYWJpbGl0eS5yZXNvbHZlID0gZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgaXNTZXR0bGVkID0gdHJ1ZTsKICAgICAgcmVzb2x2ZShkYXRhKTsKICAgIH07CgogICAgY2FwYWJpbGl0eS5yZWplY3QgPSBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgIGlzU2V0dGxlZCA9IHRydWU7CiAgICAgIHJlamVjdChyZWFzb24pOwogICAgfTsKICB9KTsKICByZXR1cm4gY2FwYWJpbGl0eTsKfQoKLyoqKi8gfSksCi8qIDMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX191bnVzZWRfd2VicGFja19leHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCnZhciBfaXNfbm9kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNCk7Cgo7CgovKioqLyB9KSwKLyogNCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmlzTm9kZUpTID0gdm9pZCAwOwpjb25zdCBpc05vZGVKUyA9IHR5cGVvZiBwcm9jZXNzID09PSAib2JqZWN0IiAmJiBwcm9jZXNzICsgIiIgPT09ICJbb2JqZWN0IHByb2Nlc3NdIiAmJiAhcHJvY2Vzcy52ZXJzaW9ucy5udyAmJiAhKHByb2Nlc3MudmVyc2lvbnMuZWxlY3Ryb24gJiYgcHJvY2Vzcy50eXBlICYmIHByb2Nlc3MudHlwZSAhPT0gImJyb3dzZXIiKTsKZXhwb3J0cy5pc05vZGVKUyA9IGlzTm9kZUpTOwoKLyoqKi8gfSksCi8qIDUgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5SZWZTZXRDYWNoZSA9IGV4cG9ydHMuUmVmU2V0ID0gZXhwb3J0cy5SZWYgPSBleHBvcnRzLk5hbWUgPSBleHBvcnRzLkVPRiA9IGV4cG9ydHMuRGljdCA9IGV4cG9ydHMuQ21kID0gZXhwb3J0cy5DSVJDVUxBUl9SRUYgPSB2b2lkIDA7CmV4cG9ydHMuY2xlYXJQcmltaXRpdmVDYWNoZXMgPSBjbGVhclByaW1pdGl2ZUNhY2hlczsKZXhwb3J0cy5pc0NtZCA9IGlzQ21kOwpleHBvcnRzLmlzRGljdCA9IGlzRGljdDsKZXhwb3J0cy5pc05hbWUgPSBpc05hbWU7CmV4cG9ydHMuaXNSZWZzRXF1YWwgPSBpc1JlZnNFcXVhbDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgpjb25zdCBDSVJDVUxBUl9SRUYgPSBTeW1ib2woIkNJUkNVTEFSX1JFRiIpOwpleHBvcnRzLkNJUkNVTEFSX1JFRiA9IENJUkNVTEFSX1JFRjsKY29uc3QgRU9GID0gU3ltYm9sKCJFT0YiKTsKZXhwb3J0cy5FT0YgPSBFT0Y7Cgpjb25zdCBOYW1lID0gZnVuY3Rpb24gTmFtZUNsb3N1cmUoKSB7CiAgbGV0IG5hbWVDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGNsYXNzIE5hbWUgewogICAgY29uc3RydWN0b3IobmFtZSkgewogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgfQoKICAgIHN0YXRpYyBnZXQobmFtZSkgewogICAgICByZXR1cm4gbmFtZUNhY2hlW25hbWVdIHx8IChuYW1lQ2FjaGVbbmFtZV0gPSBuZXcgTmFtZShuYW1lKSk7CiAgICB9CgogICAgc3RhdGljIF9jbGVhckNhY2hlKCkgewogICAgICBuYW1lQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgfQoKICB9CgogIHJldHVybiBOYW1lOwp9KCk7CgpleHBvcnRzLk5hbWUgPSBOYW1lOwoKY29uc3QgQ21kID0gZnVuY3Rpb24gQ21kQ2xvc3VyZSgpIHsKICBsZXQgY21kQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICBjbGFzcyBDbWQgewogICAgY29uc3RydWN0b3IoY21kKSB7CiAgICAgIHRoaXMuY21kID0gY21kOwogICAgfQoKICAgIHN0YXRpYyBnZXQoY21kKSB7CiAgICAgIHJldHVybiBjbWRDYWNoZVtjbWRdIHx8IChjbWRDYWNoZVtjbWRdID0gbmV3IENtZChjbWQpKTsKICAgIH0KCiAgICBzdGF0aWMgX2NsZWFyQ2FjaGUoKSB7CiAgICAgIGNtZENhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgfQoKICByZXR1cm4gQ21kOwp9KCk7CgpleHBvcnRzLkNtZCA9IENtZDsKCmNvbnN0IG5vblNlcmlhbGl6YWJsZSA9IGZ1bmN0aW9uIG5vblNlcmlhbGl6YWJsZUNsb3N1cmUoKSB7CiAgcmV0dXJuIG5vblNlcmlhbGl6YWJsZTsKfTsKCmNsYXNzIERpY3QgewogIGNvbnN0cnVjdG9yKHhyZWYgPSBudWxsKSB7CiAgICB0aGlzLl9tYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMub2JqSWQgPSBudWxsOwogICAgdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24gPSBmYWxzZTsKICAgIHRoaXMuX19ub25TZXJpYWxpemFibGVfXyA9IG5vblNlcmlhbGl6YWJsZTsKICB9CgogIGFzc2lnblhyZWYobmV3WHJlZikgewogICAgdGhpcy54cmVmID0gbmV3WHJlZjsKICB9CgogIGdldCBzaXplKCkgewogICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX21hcCkubGVuZ3RoOwogIH0KCiAgZ2V0KGtleTEsIGtleTIsIGtleTMpIHsKICAgIGxldCB2YWx1ZSA9IHRoaXMuX21hcFtrZXkxXTsKCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkyICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFsdWUgPSB0aGlzLl9tYXBba2V5Ml07CgogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YWx1ZSA9IHRoaXMuX21hcFtrZXkzXTsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFJlZiAmJiB0aGlzLnhyZWYpIHsKICAgICAgcmV0dXJuIHRoaXMueHJlZi5mZXRjaCh2YWx1ZSwgdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CgogIGFzeW5jIGdldEFzeW5jKGtleTEsIGtleTIsIGtleTMpIHsKICAgIGxldCB2YWx1ZSA9IHRoaXMuX21hcFtrZXkxXTsKCiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkyICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFsdWUgPSB0aGlzLl9tYXBba2V5Ml07CgogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YWx1ZSA9IHRoaXMuX21hcFtrZXkzXTsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFJlZiAmJiB0aGlzLnhyZWYpIHsKICAgICAgcmV0dXJuIHRoaXMueHJlZi5mZXRjaEFzeW5jKHZhbHVlLCB0aGlzLnN1cHByZXNzRW5jcnlwdGlvbik7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgZ2V0QXJyYXkoa2V5MSwga2V5Miwga2V5MykgewogICAgbGV0IHZhbHVlID0gdGhpcy5fbWFwW2tleTFdOwoKICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGtleTIgIT09IHVuZGVmaW5lZCkgewogICAgICB2YWx1ZSA9IHRoaXMuX21hcFtrZXkyXTsKCiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGtleTMgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhbHVlID0gdGhpcy5fbWFwW2tleTNdOwogICAgICB9CiAgICB9CgogICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgUmVmICYmIHRoaXMueHJlZikgewogICAgICB2YWx1ZSA9IHRoaXMueHJlZi5mZXRjaCh2YWx1ZSwgdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfQoKICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKCk7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB2YWx1ZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgaWYgKHZhbHVlW2ldIGluc3RhbmNlb2YgUmVmICYmIHRoaXMueHJlZikgewogICAgICAgICAgdmFsdWVbaV0gPSB0aGlzLnhyZWYuZmV0Y2godmFsdWVbaV0sIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfQoKICBnZXRSYXcoa2V5KSB7CiAgICByZXR1cm4gdGhpcy5fbWFwW2tleV07CiAgfQoKICBnZXRLZXlzKCkgewogICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX21hcCk7CiAgfQoKICBnZXRSYXdWYWx1ZXMoKSB7CiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLl9tYXApOwogIH0KCiAgc2V0KGtleSwgdmFsdWUpIHsKICAgIHRoaXMuX21hcFtrZXldID0gdmFsdWU7CiAgfQoKICBoYXMoa2V5KSB7CiAgICByZXR1cm4gdGhpcy5fbWFwW2tleV0gIT09IHVuZGVmaW5lZDsKICB9CgogIGZvckVhY2goY2FsbGJhY2spIHsKICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX21hcCkgewogICAgICBjYWxsYmFjayhrZXksIHRoaXMuZ2V0KGtleSkpOwogICAgfQogIH0KCiAgc3RhdGljIGdldCBlbXB0eSgpIHsKICAgIGNvbnN0IGVtcHR5RGljdCA9IG5ldyBEaWN0KG51bGwpOwoKICAgIGVtcHR5RGljdC5zZXQgPSAoa2V5LCB2YWx1ZSkgPT4gewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJTaG91bGQgbm90IGNhbGwgYHNldGAgb24gdGhlIGVtcHR5IGRpY3Rpb25hcnkuIik7CiAgICB9OwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZW1wdHkiLCBlbXB0eURpY3QpOwogIH0KCiAgc3RhdGljIG1lcmdlKHsKICAgIHhyZWYsCiAgICBkaWN0QXJyYXksCiAgICBtZXJnZVN1YkRpY3RzID0gZmFsc2UKICB9KSB7CiAgICBjb25zdCBtZXJnZWREaWN0ID0gbmV3IERpY3QoeHJlZiksCiAgICAgICAgICBwcm9wZXJ0aWVzID0gbmV3IE1hcCgpOwoKICAgIGZvciAoY29uc3QgZGljdCBvZiBkaWN0QXJyYXkpIHsKICAgICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIERpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRpY3QuX21hcCkpIHsKICAgICAgICBsZXQgcHJvcGVydHkgPSBwcm9wZXJ0aWVzLmdldChrZXkpOwoKICAgICAgICBpZiAocHJvcGVydHkgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcHJvcGVydHkgPSBbXTsKICAgICAgICAgIHByb3BlcnRpZXMuc2V0KGtleSwgcHJvcGVydHkpOwogICAgICAgIH0gZWxzZSBpZiAoIW1lcmdlU3ViRGljdHMgfHwgISh2YWx1ZSBpbnN0YW5jZW9mIERpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHByb3BlcnR5LnB1c2godmFsdWUpOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVzXSBvZiBwcm9wZXJ0aWVzKSB7CiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxIHx8ICEodmFsdWVzWzBdIGluc3RhbmNlb2YgRGljdCkpIHsKICAgICAgICBtZXJnZWREaWN0Ll9tYXBbbmFtZV0gPSB2YWx1ZXNbMF07CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHN1YkRpY3QgPSBuZXcgRGljdCh4cmVmKTsKCiAgICAgIGZvciAoY29uc3QgZGljdCBvZiB2YWx1ZXMpIHsKICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkaWN0Ll9tYXApKSB7CiAgICAgICAgICBpZiAoc3ViRGljdC5fbWFwW2tleV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBzdWJEaWN0Ll9tYXBba2V5XSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHN1YkRpY3Quc2l6ZSA+IDApIHsKICAgICAgICBtZXJnZWREaWN0Ll9tYXBbbmFtZV0gPSBzdWJEaWN0OwogICAgICB9CiAgICB9CgogICAgcHJvcGVydGllcy5jbGVhcigpOwogICAgcmV0dXJuIG1lcmdlZERpY3Quc2l6ZSA+IDAgPyBtZXJnZWREaWN0IDogRGljdC5lbXB0eTsKICB9Cgp9CgpleHBvcnRzLkRpY3QgPSBEaWN0OwoKY29uc3QgUmVmID0gZnVuY3Rpb24gUmVmQ2xvc3VyZSgpIHsKICBsZXQgcmVmQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICBjbGFzcyBSZWYgewogICAgY29uc3RydWN0b3IobnVtLCBnZW4pIHsKICAgICAgdGhpcy5udW0gPSBudW07CiAgICAgIHRoaXMuZ2VuID0gZ2VuOwogICAgfQoKICAgIHRvU3RyaW5nKCkgewogICAgICBpZiAodGhpcy5nZW4gPT09IDApIHsKICAgICAgICByZXR1cm4gYCR7dGhpcy5udW19UmA7CiAgICAgIH0KCiAgICAgIHJldHVybiBgJHt0aGlzLm51bX1SJHt0aGlzLmdlbn1gOwogICAgfQoKICAgIHN0YXRpYyBnZXQobnVtLCBnZW4pIHsKICAgICAgY29uc3Qga2V5ID0gZ2VuID09PSAwID8gYCR7bnVtfVJgIDogYCR7bnVtfVIke2dlbn1gOwogICAgICByZXR1cm4gcmVmQ2FjaGVba2V5XSB8fCAocmVmQ2FjaGVba2V5XSA9IG5ldyBSZWYobnVtLCBnZW4pKTsKICAgIH0KCiAgICBzdGF0aWMgX2NsZWFyQ2FjaGUoKSB7CiAgICAgIHJlZkNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KCiAgfQoKICByZXR1cm4gUmVmOwp9KCk7CgpleHBvcnRzLlJlZiA9IFJlZjsKCmNsYXNzIFJlZlNldCB7CiAgY29uc3RydWN0b3IocGFyZW50ID0gbnVsbCkgewogICAgdGhpcy5fc2V0ID0gbmV3IFNldChwYXJlbnQgJiYgcGFyZW50Ll9zZXQpOwogIH0KCiAgaGFzKHJlZikgewogICAgcmV0dXJuIHRoaXMuX3NldC5oYXMocmVmLnRvU3RyaW5nKCkpOwogIH0KCiAgcHV0KHJlZikgewogICAgdGhpcy5fc2V0LmFkZChyZWYudG9TdHJpbmcoKSk7CiAgfQoKICByZW1vdmUocmVmKSB7CiAgICB0aGlzLl9zZXQuZGVsZXRlKHJlZi50b1N0cmluZygpKTsKICB9CgogIFtTeW1ib2wuaXRlcmF0b3JdKCkgewogICAgcmV0dXJuIHRoaXMuX3NldC52YWx1ZXMoKTsKICB9CgogIGNsZWFyKCkgewogICAgdGhpcy5fc2V0LmNsZWFyKCk7CiAgfQoKfQoKZXhwb3J0cy5SZWZTZXQgPSBSZWZTZXQ7CgpjbGFzcyBSZWZTZXRDYWNoZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLl9tYXAgPSBuZXcgTWFwKCk7CiAgfQoKICBnZXQgc2l6ZSgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuc2l6ZTsKICB9CgogIGdldChyZWYpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuZ2V0KHJlZi50b1N0cmluZygpKTsKICB9CgogIGhhcyhyZWYpIHsKICAgIHJldHVybiB0aGlzLl9tYXAuaGFzKHJlZi50b1N0cmluZygpKTsKICB9CgogIHB1dChyZWYsIG9iaikgewogICAgdGhpcy5fbWFwLnNldChyZWYudG9TdHJpbmcoKSwgb2JqKTsKICB9CgogIHB1dEFsaWFzKHJlZiwgYWxpYXNSZWYpIHsKICAgIHRoaXMuX21hcC5zZXQocmVmLnRvU3RyaW5nKCksIHRoaXMuZ2V0KGFsaWFzUmVmKSk7CiAgfQoKICBbU3ltYm9sLml0ZXJhdG9yXSgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAudmFsdWVzKCk7CiAgfQoKICBjbGVhcigpIHsKICAgIHRoaXMuX21hcC5jbGVhcigpOwogIH0KCn0KCmV4cG9ydHMuUmVmU2V0Q2FjaGUgPSBSZWZTZXRDYWNoZTsKCmZ1bmN0aW9uIGlzTmFtZSh2LCBuYW1lKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBOYW1lICYmIChuYW1lID09PSB1bmRlZmluZWQgfHwgdi5uYW1lID09PSBuYW1lKTsKfQoKZnVuY3Rpb24gaXNDbWQodiwgY21kKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBDbWQgJiYgKGNtZCA9PT0gdW5kZWZpbmVkIHx8IHYuY21kID09PSBjbWQpOwp9CgpmdW5jdGlvbiBpc0RpY3QodiwgdHlwZSkgewogIHJldHVybiB2IGluc3RhbmNlb2YgRGljdCAmJiAodHlwZSA9PT0gdW5kZWZpbmVkIHx8IGlzTmFtZSh2LmdldCgiVHlwZSIpLCB0eXBlKSk7Cn0KCmZ1bmN0aW9uIGlzUmVmc0VxdWFsKHYxLCB2MikgewogIHJldHVybiB2MS5udW0gPT09IHYyLm51bSAmJiB2MS5nZW4gPT09IHYyLmdlbjsKfQoKZnVuY3Rpb24gY2xlYXJQcmltaXRpdmVDYWNoZXMoKSB7CiAgQ21kLl9jbGVhckNhY2hlKCk7CgogIE5hbWUuX2NsZWFyQ2FjaGUoKTsKCiAgUmVmLl9jbGVhckNhY2hlKCk7Cn0KCi8qKiovIH0pLAovKiA2ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWFJlZlBhcnNlRXhjZXB0aW9uID0gZXhwb3J0cy5YUmVmRW50cnlFeGNlcHRpb24gPSBleHBvcnRzLlBhcnNlckVPRkV4Y2VwdGlvbiA9IGV4cG9ydHMuTWlzc2luZ0RhdGFFeGNlcHRpb24gPSBleHBvcnRzLkRvY1N0YXRzID0gdm9pZCAwOwpleHBvcnRzLmNvbGxlY3RBY3Rpb25zID0gY29sbGVjdEFjdGlvbnM7CmV4cG9ydHMuZW5jb2RlVG9YbWxTdHJpbmcgPSBlbmNvZGVUb1htbFN0cmluZzsKZXhwb3J0cy5lc2NhcGVQREZOYW1lID0gZXNjYXBlUERGTmFtZTsKZXhwb3J0cy5nZXRBcnJheUxvb2t1cFRhYmxlRmFjdG9yeSA9IGdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5OwpleHBvcnRzLmdldEluaGVyaXRhYmxlUHJvcGVydHkgPSBnZXRJbmhlcml0YWJsZVByb3BlcnR5OwpleHBvcnRzLmdldExvb2t1cFRhYmxlRmFjdG9yeSA9IGdldExvb2t1cFRhYmxlRmFjdG9yeTsKZXhwb3J0cy5nZXROZXdBbm5vdGF0aW9uc01hcCA9IGdldE5ld0Fubm90YXRpb25zTWFwOwpleHBvcnRzLmlzV2hpdGVTcGFjZSA9IGlzV2hpdGVTcGFjZTsKZXhwb3J0cy5sb2cyID0gbG9nMjsKZXhwb3J0cy5udW1iZXJUb1N0cmluZyA9IG51bWJlclRvU3RyaW5nOwpleHBvcnRzLnBhcnNlWEZBUGF0aCA9IHBhcnNlWEZBUGF0aDsKZXhwb3J0cy5yZWFkSW50OCA9IHJlYWRJbnQ4OwpleHBvcnRzLnJlYWRVaW50MTYgPSByZWFkVWludDE2OwpleHBvcnRzLnJlYWRVaW50MzIgPSByZWFkVWludDMyOwpleHBvcnRzLnJlY292ZXJKc1VSTCA9IHJlY292ZXJKc1VSTDsKZXhwb3J0cy50b1JvbWFuTnVtZXJhbHMgPSB0b1JvbWFuTnVtZXJhbHM7CmV4cG9ydHMudmFsaWRhdGVDU1NGb250ID0gdmFsaWRhdGVDU1NGb250OwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCmZ1bmN0aW9uIGdldExvb2t1cFRhYmxlRmFjdG9yeShpbml0aWFsaXplcikgewogIGxldCBsb29rdXA7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIGlmIChpbml0aWFsaXplcikgewogICAgICBsb29rdXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBpbml0aWFsaXplcihsb29rdXApOwogICAgICBpbml0aWFsaXplciA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIGxvb2t1cDsKICB9Owp9CgpmdW5jdGlvbiBnZXRBcnJheUxvb2t1cFRhYmxlRmFjdG9yeShpbml0aWFsaXplcikgewogIGxldCBsb29rdXA7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIGlmIChpbml0aWFsaXplcikgewogICAgICBsZXQgYXJyID0gaW5pdGlhbGl6ZXIoKTsKICAgICAgaW5pdGlhbGl6ZXIgPSBudWxsOwogICAgICBsb29rdXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYXJyLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgICBsb29rdXBbYXJyW2ldXSA9IGFycltpICsgMV07CiAgICAgIH0KCiAgICAgIGFyciA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIGxvb2t1cDsKICB9Owp9CgpjbGFzcyBNaXNzaW5nRGF0YUV4Y2VwdGlvbiBleHRlbmRzIF91dGlsLkJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKGJlZ2luLCBlbmQpIHsKICAgIHN1cGVyKGBNaXNzaW5nIGRhdGEgWyR7YmVnaW59LCAke2VuZH0pYCwgIk1pc3NpbmdEYXRhRXhjZXB0aW9uIik7CiAgICB0aGlzLmJlZ2luID0gYmVnaW47CiAgICB0aGlzLmVuZCA9IGVuZDsKICB9Cgp9CgpleHBvcnRzLk1pc3NpbmdEYXRhRXhjZXB0aW9uID0gTWlzc2luZ0RhdGFFeGNlcHRpb247CgpjbGFzcyBQYXJzZXJFT0ZFeGNlcHRpb24gZXh0ZW5kcyBfdXRpbC5CYXNlRXhjZXB0aW9uIHsKICBjb25zdHJ1Y3Rvcihtc2cpIHsKICAgIHN1cGVyKG1zZywgIlBhcnNlckVPRkV4Y2VwdGlvbiIpOwogIH0KCn0KCmV4cG9ydHMuUGFyc2VyRU9GRXhjZXB0aW9uID0gUGFyc2VyRU9GRXhjZXB0aW9uOwoKY2xhc3MgWFJlZkVudHJ5RXhjZXB0aW9uIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJYUmVmRW50cnlFeGNlcHRpb24iKTsKICB9Cgp9CgpleHBvcnRzLlhSZWZFbnRyeUV4Y2VwdGlvbiA9IFhSZWZFbnRyeUV4Y2VwdGlvbjsKCmNsYXNzIFhSZWZQYXJzZUV4Y2VwdGlvbiBleHRlbmRzIF91dGlsLkJhc2VFeGNlcHRpb24gewogIGNvbnN0cnVjdG9yKG1zZykgewogICAgc3VwZXIobXNnLCAiWFJlZlBhcnNlRXhjZXB0aW9uIik7CiAgfQoKfQoKZXhwb3J0cy5YUmVmUGFyc2VFeGNlcHRpb24gPSBYUmVmUGFyc2VFeGNlcHRpb247CgpjbGFzcyBEb2NTdGF0cyB7CiAgY29uc3RydWN0b3IoaGFuZGxlcikgewogICAgdGhpcy5faGFuZGxlciA9IGhhbmRsZXI7CiAgICB0aGlzLl9zdHJlYW1UeXBlcyA9IG5ldyBTZXQoKTsKICAgIHRoaXMuX2ZvbnRUeXBlcyA9IG5ldyBTZXQoKTsKICB9CgogIF9zZW5kKCkgewogICAgY29uc3Qgc3RyZWFtVHlwZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpLAogICAgICAgICAgZm9udFR5cGVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgdGhpcy5fc3RyZWFtVHlwZXMpIHsKICAgICAgc3RyZWFtVHlwZXNbdHlwZV0gPSB0cnVlOwogICAgfQoKICAgIGZvciAoY29uc3QgdHlwZSBvZiB0aGlzLl9mb250VHlwZXMpIHsKICAgICAgZm9udFR5cGVzW3R5cGVdID0gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLl9oYW5kbGVyLnNlbmQoIkRvY1N0YXRzIiwgewogICAgICBzdHJlYW1UeXBlcywKICAgICAgZm9udFR5cGVzCiAgICB9KTsKICB9CgogIGFkZFN0cmVhbVR5cGUodHlwZSkgewogICAgaWYgKHRoaXMuX3N0cmVhbVR5cGVzLmhhcyh0eXBlKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fc3RyZWFtVHlwZXMuYWRkKHR5cGUpOwoKICAgIHRoaXMuX3NlbmQoKTsKICB9CgogIGFkZEZvbnRUeXBlKHR5cGUpIHsKICAgIGlmICh0aGlzLl9mb250VHlwZXMuaGFzKHR5cGUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9mb250VHlwZXMuYWRkKHR5cGUpOwoKICAgIHRoaXMuX3NlbmQoKTsKICB9Cgp9CgpleHBvcnRzLkRvY1N0YXRzID0gRG9jU3RhdHM7CgpmdW5jdGlvbiBnZXRJbmhlcml0YWJsZVByb3BlcnR5KHsKICBkaWN0LAogIGtleSwKICBnZXRBcnJheSA9IGZhbHNlLAogIHN0b3BXaGVuRm91bmQgPSB0cnVlCn0pIHsKICBsZXQgdmFsdWVzOwogIGNvbnN0IHZpc2l0ZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CgogIHdoaWxlIChkaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiAhKGRpY3Qub2JqSWQgJiYgdmlzaXRlZC5oYXMoZGljdC5vYmpJZCkpKSB7CiAgICBpZiAoZGljdC5vYmpJZCkgewogICAgICB2aXNpdGVkLnB1dChkaWN0Lm9iaklkKTsKICAgIH0KCiAgICBjb25zdCB2YWx1ZSA9IGdldEFycmF5ID8gZGljdC5nZXRBcnJheShrZXkpIDogZGljdC5nZXQoa2V5KTsKCiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoc3RvcFdoZW5Gb3VuZCkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgfQoKICAgICAgaWYgKCF2YWx1ZXMpIHsKICAgICAgICB2YWx1ZXMgPSBbXTsKICAgICAgfQoKICAgICAgdmFsdWVzLnB1c2godmFsdWUpOwogICAgfQoKICAgIGRpY3QgPSBkaWN0LmdldCgiUGFyZW50Iik7CiAgfQoKICByZXR1cm4gdmFsdWVzOwp9Cgpjb25zdCBST01BTl9OVU1CRVJfTUFQID0gWyIiLCAiQyIsICJDQyIsICJDQ0MiLCAiQ0QiLCAiRCIsICJEQyIsICJEQ0MiLCAiRENDQyIsICJDTSIsICIiLCAiWCIsICJYWCIsICJYWFgiLCAiWEwiLCAiTCIsICJMWCIsICJMWFgiLCAiTFhYWCIsICJYQyIsICIiLCAiSSIsICJJSSIsICJJSUkiLCAiSVYiLCAiViIsICJWSSIsICJWSUkiLCAiVklJSSIsICJJWCJdOwoKZnVuY3Rpb24gdG9Sb21hbk51bWVyYWxzKG51bWJlciwgbG93ZXJDYXNlID0gZmFsc2UpIHsKICAoMCwgX3V0aWwuYXNzZXJ0KShOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikgJiYgbnVtYmVyID4gMCwgIlRoZSBudW1iZXIgc2hvdWxkIGJlIGEgcG9zaXRpdmUgaW50ZWdlci4iKTsKICBjb25zdCByb21hbkJ1ZiA9IFtdOwogIGxldCBwb3M7CgogIHdoaWxlIChudW1iZXIgPj0gMTAwMCkgewogICAgbnVtYmVyIC09IDEwMDA7CiAgICByb21hbkJ1Zi5wdXNoKCJNIik7CiAgfQoKICBwb3MgPSBudW1iZXIgLyAxMDAgfCAwOwogIG51bWJlciAlPSAxMDA7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQW3Bvc10pOwogIHBvcyA9IG51bWJlciAvIDEwIHwgMDsKICBudW1iZXIgJT0gMTA7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQWzEwICsgcG9zXSk7CiAgcm9tYW5CdWYucHVzaChST01BTl9OVU1CRVJfTUFQWzIwICsgbnVtYmVyXSk7CiAgY29uc3Qgcm9tYW5TdHIgPSByb21hbkJ1Zi5qb2luKCIiKTsKICByZXR1cm4gbG93ZXJDYXNlID8gcm9tYW5TdHIudG9Mb3dlckNhc2UoKSA6IHJvbWFuU3RyOwp9CgpmdW5jdGlvbiBsb2cyKHgpIHsKICBpZiAoeCA8PSAwKSB7CiAgICByZXR1cm4gMDsKICB9CgogIHJldHVybiBNYXRoLmNlaWwoTWF0aC5sb2cyKHgpKTsKfQoKZnVuY3Rpb24gcmVhZEludDgoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIGRhdGFbb2Zmc2V0XSA8PCAyNCA+PiAyNDsKfQoKZnVuY3Rpb24gcmVhZFVpbnQxNihkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDggfCBkYXRhW29mZnNldCArIDFdOwp9CgpmdW5jdGlvbiByZWFkVWludDMyKGRhdGEsIG9mZnNldCkgewogIHJldHVybiAoZGF0YVtvZmZzZXRdIDw8IDI0IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxNiB8IGRhdGFbb2Zmc2V0ICsgMl0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgM10pID4+PiAwOwp9CgpmdW5jdGlvbiBpc1doaXRlU3BhY2UoY2gpIHsKICByZXR1cm4gY2ggPT09IDB4MjAgfHwgY2ggPT09IDB4MDkgfHwgY2ggPT09IDB4MGQgfHwgY2ggPT09IDB4MGE7Cn0KCmZ1bmN0aW9uIHBhcnNlWEZBUGF0aChwYXRoKSB7CiAgY29uc3QgcG9zaXRpb25QYXR0ZXJuID0gLyguKylcWyhcZCspXF0kLzsKICByZXR1cm4gcGF0aC5zcGxpdCgiLiIpLm1hcChjb21wb25lbnQgPT4gewogICAgY29uc3QgbSA9IGNvbXBvbmVudC5tYXRjaChwb3NpdGlvblBhdHRlcm4pOwoKICAgIGlmIChtKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbVsxXSwKICAgICAgICBwb3M6IHBhcnNlSW50KG1bMl0sIDEwKQogICAgICB9OwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIG5hbWU6IGNvbXBvbmVudCwKICAgICAgcG9zOiAwCiAgICB9OwogIH0pOwp9CgpmdW5jdGlvbiBlc2NhcGVQREZOYW1lKHN0cikgewogIGNvbnN0IGJ1ZmZlciA9IFtdOwogIGxldCBzdGFydCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7CgogICAgaWYgKGNoYXIgPCAweDIxIHx8IGNoYXIgPiAweDdlIHx8IGNoYXIgPT09IDB4MjMgfHwgY2hhciA9PT0gMHgyOCB8fCBjaGFyID09PSAweDI5IHx8IGNoYXIgPT09IDB4M2MgfHwgY2hhciA9PT0gMHgzZSB8fCBjaGFyID09PSAweDViIHx8IGNoYXIgPT09IDB4NWQgfHwgY2hhciA9PT0gMHg3YiB8fCBjaGFyID09PSAweDdkIHx8IGNoYXIgPT09IDB4MmYgfHwgY2hhciA9PT0gMHgyNSkgewogICAgICBpZiAoc3RhcnQgPCBpKSB7CiAgICAgICAgYnVmZmVyLnB1c2goc3RyLnN1YnN0cmluZyhzdGFydCwgaSkpOwogICAgICB9CgogICAgICBidWZmZXIucHVzaChgIyR7Y2hhci50b1N0cmluZygxNil9YCk7CiAgICAgIHN0YXJ0ID0gaSArIDE7CiAgICB9CiAgfQoKICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIHN0cjsKICB9CgogIGlmIChzdGFydCA8IHN0ci5sZW5ndGgpIHsKICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIHN0ci5sZW5ndGgpKTsKICB9CgogIHJldHVybiBidWZmZXIuam9pbigiIik7Cn0KCmZ1bmN0aW9uIF9jb2xsZWN0SlMoZW50cnksIHhyZWYsIGxpc3QsIHBhcmVudHMpIHsKICBpZiAoIWVudHJ5KSB7CiAgICByZXR1cm47CiAgfQoKICBsZXQgcGFyZW50ID0gbnVsbDsKCiAgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICBpZiAocGFyZW50cy5oYXMoZW50cnkpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBwYXJlbnQgPSBlbnRyeTsKICAgIHBhcmVudHMucHV0KHBhcmVudCk7CiAgICBlbnRyeSA9IHhyZWYuZmV0Y2goZW50cnkpOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnkpKSB7CiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZW50cnkpIHsKICAgICAgX2NvbGxlY3RKUyhlbGVtZW50LCB4cmVmLCBsaXN0LCBwYXJlbnRzKTsKICAgIH0KICB9IGVsc2UgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGVudHJ5LmdldCgiUyIpLCAiSmF2YVNjcmlwdCIpKSB7CiAgICAgIGNvbnN0IGpzID0gZW50cnkuZ2V0KCJKUyIpOwogICAgICBsZXQgY29kZTsKCiAgICAgIGlmIChqcyBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgY29kZSA9IGpzLmdldFN0cmluZygpOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBqcyA9PT0gInN0cmluZyIpIHsKICAgICAgICBjb2RlID0ganM7CiAgICAgIH0KCiAgICAgIGNvZGUgPSBjb2RlICYmICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY29kZSkucmVwbGFjZSgvXHUwMDAwL2csICIiKTsKCiAgICAgIGlmIChjb2RlKSB7CiAgICAgICAgbGlzdC5wdXNoKGNvZGUpOwogICAgICB9CiAgICB9CgogICAgX2NvbGxlY3RKUyhlbnRyeS5nZXRSYXcoIk5leHQiKSwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CiAgfQoKICBpZiAocGFyZW50KSB7CiAgICBwYXJlbnRzLnJlbW92ZShwYXJlbnQpOwogIH0KfQoKZnVuY3Rpb24gY29sbGVjdEFjdGlvbnMoeHJlZiwgZGljdCwgZXZlbnRUeXBlKSB7CiAgY29uc3QgYWN0aW9ucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgY29uc3QgYWRkaXRpb25hbEFjdGlvbnNEaWN0cyA9IGdldEluaGVyaXRhYmxlUHJvcGVydHkoewogICAgZGljdCwKICAgIGtleTogIkFBIiwKICAgIHN0b3BXaGVuRm91bmQ6IGZhbHNlCiAgfSk7CgogIGlmIChhZGRpdGlvbmFsQWN0aW9uc0RpY3RzKSB7CiAgICBmb3IgKGxldCBpID0gYWRkaXRpb25hbEFjdGlvbnNEaWN0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICBjb25zdCBhZGRpdGlvbmFsQWN0aW9ucyA9IGFkZGl0aW9uYWxBY3Rpb25zRGljdHNbaV07CgogICAgICBpZiAoIShhZGRpdGlvbmFsQWN0aW9ucyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3Qga2V5IG9mIGFkZGl0aW9uYWxBY3Rpb25zLmdldEtleXMoKSkgewogICAgICAgIGNvbnN0IGFjdGlvbiA9IGV2ZW50VHlwZVtrZXldOwoKICAgICAgICBpZiAoIWFjdGlvbikgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBhY3Rpb25EaWN0ID0gYWRkaXRpb25hbEFjdGlvbnMuZ2V0UmF3KGtleSk7CiAgICAgICAgY29uc3QgcGFyZW50cyA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXQoKTsKICAgICAgICBjb25zdCBsaXN0ID0gW107CgogICAgICAgIF9jb2xsZWN0SlMoYWN0aW9uRGljdCwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CgogICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIGFjdGlvbnNbYWN0aW9uXSA9IGxpc3Q7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZGljdC5oYXMoIkEiKSkgewogICAgY29uc3QgYWN0aW9uRGljdCA9IGRpY3QuZ2V0KCJBIik7CiAgICBjb25zdCBwYXJlbnRzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgY29uc3QgbGlzdCA9IFtdOwoKICAgIF9jb2xsZWN0SlMoYWN0aW9uRGljdCwgeHJlZiwgbGlzdCwgcGFyZW50cyk7CgogICAgaWYgKGxpc3QubGVuZ3RoID4gMCkgewogICAgICBhY3Rpb25zLkFjdGlvbiA9IGxpc3Q7CiAgICB9CiAgfQoKICByZXR1cm4gKDAsIF91dGlsLm9iamVjdFNpemUpKGFjdGlvbnMpID4gMCA/IGFjdGlvbnMgOiBudWxsOwp9Cgpjb25zdCBYTUxFbnRpdGllcyA9IHsKICAweDNjOiAiJmx0OyIsCiAgMHgzZTogIiZndDsiLAogIDB4MjY6ICImYW1wOyIsCiAgMHgyMjogIiZxdW90OyIsCiAgMHgyNzogIiZhcG9zOyIKfTsKCmZ1bmN0aW9uIGVuY29kZVRvWG1sU3RyaW5nKHN0cikgewogIGNvbnN0IGJ1ZmZlciA9IFtdOwogIGxldCBzdGFydCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaGFyID0gc3RyLmNvZGVQb2ludEF0KGkpOwoKICAgIGlmICgweDIwIDw9IGNoYXIgJiYgY2hhciA8PSAweDdlKSB7CiAgICAgIGNvbnN0IGVudGl0eSA9IFhNTEVudGl0aWVzW2NoYXJdOwoKICAgICAgaWYgKGVudGl0eSkgewogICAgICAgIGlmIChzdGFydCA8IGkpIHsKICAgICAgICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpKTsKICAgICAgICB9CgogICAgICAgIGJ1ZmZlci5wdXNoKGVudGl0eSk7CiAgICAgICAgc3RhcnQgPSBpICsgMTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKHN0YXJ0IDwgaSkgewogICAgICAgIGJ1ZmZlci5wdXNoKHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpKTsKICAgICAgfQoKICAgICAgYnVmZmVyLnB1c2goYCYjeCR7Y2hhci50b1N0cmluZygxNikudG9VcHBlckNhc2UoKX07YCk7CgogICAgICBpZiAoY2hhciA+IDB4ZDdmZiAmJiAoY2hhciA8IDB4ZTAwMCB8fCBjaGFyID4gMHhmZmZkKSkgewogICAgICAgIGkrKzsKICAgICAgfQoKICAgICAgc3RhcnQgPSBpICsgMTsKICAgIH0KICB9CgogIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gc3RyOwogIH0KCiAgaWYgKHN0YXJ0IDwgc3RyLmxlbmd0aCkgewogICAgYnVmZmVyLnB1c2goc3RyLnN1YnN0cmluZyhzdGFydCwgc3RyLmxlbmd0aCkpOwogIH0KCiAgcmV0dXJuIGJ1ZmZlci5qb2luKCIiKTsKfQoKZnVuY3Rpb24gdmFsaWRhdGVDU1NGb250KGNzc0ZvbnRJbmZvKSB7CiAgY29uc3QgREVGQVVMVF9DU1NfRk9OVF9PQkxJUVVFID0gIjE0IjsKICBjb25zdCBERUZBVUxUX0NTU19GT05UX1dFSUdIVCA9ICI0MDAiOwogIGNvbnN0IENTU19GT05UX1dFSUdIVF9WQUxVRVMgPSBuZXcgU2V0KFsiMTAwIiwgIjIwMCIsICIzMDAiLCAiNDAwIiwgIjUwMCIsICI2MDAiLCAiNzAwIiwgIjgwMCIsICI5MDAiLCAiMTAwMCIsICJub3JtYWwiLCAiYm9sZCIsICJib2xkZXIiLCAibGlnaHRlciJdKTsKICBjb25zdCB7CiAgICBmb250RmFtaWx5LAogICAgZm9udFdlaWdodCwKICAgIGl0YWxpY0FuZ2xlCiAgfSA9IGNzc0ZvbnRJbmZvOwoKICBpZiAoL14iLioiJC8udGVzdChmb250RmFtaWx5KSkgewogICAgaWYgKC9bXlxcXSIvLnRlc3QoZm9udEZhbWlseS5zbGljZSgxLCBmb250RmFtaWx5Lmxlbmd0aCAtIDEpKSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEZvbnRGYW1pbHkgY29udGFpbnMgc29tZSB1bmVzY2FwZWQgIjogJHtmb250RmFtaWx5fS5gKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSBpZiAoL14nLionJC8udGVzdChmb250RmFtaWx5KSkgewogICAgaWYgKC9bXlxcXScvLnRlc3QoZm9udEZhbWlseS5zbGljZSgxLCBmb250RmFtaWx5Lmxlbmd0aCAtIDEpKSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEZvbnRGYW1pbHkgY29udGFpbnMgc29tZSB1bmVzY2FwZWQgJzogJHtmb250RmFtaWx5fS5gKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSB7CiAgICBmb3IgKGNvbnN0IGlkZW50IG9mIGZvbnRGYW1pbHkuc3BsaXQoL1sgXHRdKy8pKSB7CiAgICAgIGlmICgvXihcZHwoLShcZHwtKSkpLy50ZXN0KGlkZW50KSB8fCAhL15bXHctXFxdKyQvLnRlc3QoaWRlbnQpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBGb250RmFtaWx5IGNvbnRhaW5zIHNvbWUgaW52YWxpZCA8Y3VzdG9tLWlkZW50PjogJHtmb250RmFtaWx5fS5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CgogIGNvbnN0IHdlaWdodCA9IGZvbnRXZWlnaHQgPyBmb250V2VpZ2h0LnRvU3RyaW5nKCkgOiAiIjsKICBjc3NGb250SW5mby5mb250V2VpZ2h0ID0gQ1NTX0ZPTlRfV0VJR0hUX1ZBTFVFUy5oYXMod2VpZ2h0KSA/IHdlaWdodCA6IERFRkFVTFRfQ1NTX0ZPTlRfV0VJR0hUOwogIGNvbnN0IGFuZ2xlID0gcGFyc2VGbG9hdChpdGFsaWNBbmdsZSk7CiAgY3NzRm9udEluZm8uaXRhbGljQW5nbGUgPSBpc05hTihhbmdsZSkgfHwgYW5nbGUgPCAtOTAgfHwgYW5nbGUgPiA5MCA/IERFRkFVTFRfQ1NTX0ZPTlRfT0JMSVFVRSA6IGl0YWxpY0FuZ2xlLnRvU3RyaW5nKCk7CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIHJlY292ZXJKc1VSTChzdHIpIHsKICBjb25zdCBVUkxfT1BFTl9NRVRIT0RTID0gWyJhcHAubGF1bmNoVVJMIiwgIndpbmRvdy5vcGVuIiwgInhmYS5ob3N0LmdvdG9VUkwiXTsKICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoIl5cXHMqKCIgKyBVUkxfT1BFTl9NRVRIT0RTLmpvaW4oInwiKS5zcGxpdCgiLiIpLmpvaW4oIlxcLiIpICsgIilcXCgoPzonfFwiKShbXidcIl0qKSg/Oid8XCIpKD86LFxccyooXFx3KylcXCl8XFwpKSIsICJpIik7CiAgY29uc3QganNVcmwgPSByZWdleC5leGVjKHN0cik7CgogIGlmIChqc1VybCAmJiBqc1VybFsyXSkgewogICAgY29uc3QgdXJsID0ganNVcmxbMl07CiAgICBsZXQgbmV3V2luZG93ID0gZmFsc2U7CgogICAgaWYgKGpzVXJsWzNdID09PSAidHJ1ZSIgJiYganNVcmxbMV0gPT09ICJhcHAubGF1bmNoVVJMIikgewogICAgICBuZXdXaW5kb3cgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHVybCwKICAgICAgbmV3V2luZG93CiAgICB9OwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCmZ1bmN0aW9uIG51bWJlclRvU3RyaW5nKHZhbHVlKSB7CiAgaWYgKE51bWJlci5pc0ludGVnZXIodmFsdWUpKSB7CiAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTsKICB9CgogIGNvbnN0IHJvdW5kZWRWYWx1ZSA9IE1hdGgucm91bmQodmFsdWUgKiAxMDApOwoKICBpZiAocm91bmRlZFZhbHVlICUgMTAwID09PSAwKSB7CiAgICByZXR1cm4gKHJvdW5kZWRWYWx1ZSAvIDEwMCkudG9TdHJpbmcoKTsKICB9CgogIGlmIChyb3VuZGVkVmFsdWUgJSAxMCA9PT0gMCkgewogICAgcmV0dXJuIHZhbHVlLnRvRml4ZWQoMSk7CiAgfQoKICByZXR1cm4gdmFsdWUudG9GaXhlZCgyKTsKfQoKZnVuY3Rpb24gZ2V0TmV3QW5ub3RhdGlvbnNNYXAoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICBpZiAoIWFubm90YXRpb25TdG9yYWdlKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IG5ld0Fubm90YXRpb25zQnlQYWdlID0gbmV3IE1hcCgpOwoKICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgaWYgKCFrZXkuc3RhcnRzV2l0aChfdXRpbC5Bbm5vdGF0aW9uRWRpdG9yUHJlZml4KSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBsZXQgYW5ub3RhdGlvbnMgPSBuZXdBbm5vdGF0aW9uc0J5UGFnZS5nZXQodmFsdWUucGFnZUluZGV4KTsKCiAgICBpZiAoIWFubm90YXRpb25zKSB7CiAgICAgIGFubm90YXRpb25zID0gW107CiAgICAgIG5ld0Fubm90YXRpb25zQnlQYWdlLnNldCh2YWx1ZS5wYWdlSW5kZXgsIGFubm90YXRpb25zKTsKICAgIH0KCiAgICBhbm5vdGF0aW9ucy5wdXNoKHZhbHVlKTsKICB9CgogIHJldHVybiBuZXdBbm5vdGF0aW9uc0J5UGFnZS5zaXplID4gMCA/IG5ld0Fubm90YXRpb25zQnlQYWdlIDogbnVsbDsKfQoKLyoqKi8gfSksCi8qIDcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5CYXNlU3RyZWFtID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIEJhc2VTdHJlYW0gewogIGNvbnN0cnVjdG9yKCkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VTdHJlYW0pIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgQmFzZVN0cmVhbS4iKTsKICAgIH0KICB9CgogIGdldCBsZW5ndGgoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBnZXR0ZXIgYGxlbmd0aGAgYWNjZXNzZWQiKTsKICB9CgogIGdldCBpc0VtcHR5KCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgZ2V0dGVyIGBpc0VtcHR5YCBhY2Nlc3NlZCIpOwogIH0KCiAgZ2V0IGlzRGF0YUxvYWRlZCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiaXNEYXRhTG9hZGVkIiwgdHJ1ZSk7CiAgfQoKICBnZXRCeXRlKCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGBnZXRCeXRlYCBjYWxsZWQiKTsKICB9CgogIGdldEJ5dGVzKGxlbmd0aCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGBnZXRCeXRlc2AgY2FsbGVkIik7CiAgfQoKICBwZWVrQnl0ZSgpIHsKICAgIGNvbnN0IHBlZWtlZEJ5dGUgPSB0aGlzLmdldEJ5dGUoKTsKCiAgICBpZiAocGVla2VkQnl0ZSAhPT0gLTEpIHsKICAgICAgdGhpcy5wb3MtLTsKICAgIH0KCiAgICByZXR1cm4gcGVla2VkQnl0ZTsKICB9CgogIHBlZWtCeXRlcyhsZW5ndGgpIHsKICAgIGNvbnN0IGJ5dGVzID0gdGhpcy5nZXRCeXRlcyhsZW5ndGgpOwogICAgdGhpcy5wb3MgLT0gYnl0ZXMubGVuZ3RoOwogICAgcmV0dXJuIGJ5dGVzOwogIH0KCiAgZ2V0VWludDE2KCkgewogICAgY29uc3QgYjAgPSB0aGlzLmdldEJ5dGUoKTsKICAgIGNvbnN0IGIxID0gdGhpcy5nZXRCeXRlKCk7CgogICAgaWYgKGIwID09PSAtMSB8fCBiMSA9PT0gLTEpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfQoKICAgIHJldHVybiAoYjAgPDwgOCkgKyBiMTsKICB9CgogIGdldEludDMyKCkgewogICAgY29uc3QgYjAgPSB0aGlzLmdldEJ5dGUoKTsKICAgIGNvbnN0IGIxID0gdGhpcy5nZXRCeXRlKCk7CiAgICBjb25zdCBiMiA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgY29uc3QgYjMgPSB0aGlzLmdldEJ5dGUoKTsKICAgIHJldHVybiAoYjAgPDwgMjQpICsgKGIxIDw8IDE2KSArIChiMiA8PCA4KSArIGIzOwogIH0KCiAgZ2V0Qnl0ZVJhbmdlKGJlZ2luLCBlbmQpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZ2V0Qnl0ZVJhbmdlYCBjYWxsZWQiKTsKICB9CgogIGdldFN0cmluZyhsZW5ndGgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykodGhpcy5nZXRCeXRlcyhsZW5ndGgpKTsKICB9CgogIHNraXAobikgewogICAgdGhpcy5wb3MgKz0gbiB8fCAxOwogIH0KCiAgcmVzZXQoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYHJlc2V0YCBjYWxsZWQiKTsKICB9CgogIG1vdmVTdGFydCgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgbW92ZVN0YXJ0YCBjYWxsZWQiKTsKICB9CgogIG1ha2VTdWJTdHJlYW0oc3RhcnQsIGxlbmd0aCwgZGljdCA9IG51bGwpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgbWFrZVN1YlN0cmVhbWAgY2FsbGVkIik7CiAgfQoKICBnZXRCYXNlU3RyZWFtcygpIHsKICAgIHJldHVybiBudWxsOwogIH0KCn0KCmV4cG9ydHMuQmFzZVN0cmVhbSA9IEJhc2VTdHJlYW07CgovKioqLyB9KSwKLyogOCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk5ldHdvcmtQZGZNYW5hZ2VyID0gZXhwb3J0cy5Mb2NhbFBkZk1hbmFnZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jaHVua2VkX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oOSk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9kb2N1bWVudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCmZ1bmN0aW9uIHBhcnNlRG9jQmFzZVVybCh1cmwpIHsKICBpZiAodXJsKSB7CiAgICBjb25zdCBhYnNvbHV0ZVVybCA9ICgwLCBfdXRpbC5jcmVhdGVWYWxpZEFic29sdXRlVXJsKSh1cmwpOwoKICAgIGlmIChhYnNvbHV0ZVVybCkgewogICAgICByZXR1cm4gYWJzb2x1dGVVcmwuaHJlZjsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYEludmFsaWQgYWJzb2x1dGUgZG9jQmFzZVVybDogIiR7dXJsfSIuYCk7CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKY2xhc3MgQmFzZVBkZk1hbmFnZXIgewogIGNvbnN0cnVjdG9yKCkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VQZGZNYW5hZ2VyKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VQZGZNYW5hZ2VyLiIpOwogICAgfQogIH0KCiAgZ2V0IGRvY0lkKCkgewogICAgcmV0dXJuIHRoaXMuX2RvY0lkOwogIH0KCiAgZ2V0IHBhc3N3b3JkKCkgewogICAgcmV0dXJuIHRoaXMuX3Bhc3N3b3JkOwogIH0KCiAgZ2V0IGRvY0Jhc2VVcmwoKSB7CiAgICBjb25zdCBjYXRhbG9nID0gdGhpcy5wZGZEb2N1bWVudC5jYXRhbG9nOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkb2NCYXNlVXJsIiwgY2F0YWxvZy5iYXNlVXJsIHx8IHRoaXMuX2RvY0Jhc2VVcmwpOwogIH0KCiAgb25Mb2FkZWRTdHJlYW0oKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYG9uTG9hZGVkU3RyZWFtYCBjYWxsZWQiKTsKICB9CgogIGVuc3VyZURvYyhwcm9wLCBhcmdzKSB7CiAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudCwgcHJvcCwgYXJncyk7CiAgfQoKICBlbnN1cmVYUmVmKHByb3AsIGFyZ3MpIHsKICAgIHJldHVybiB0aGlzLmVuc3VyZSh0aGlzLnBkZkRvY3VtZW50LnhyZWYsIHByb3AsIGFyZ3MpOwogIH0KCiAgZW5zdXJlQ2F0YWxvZyhwcm9wLCBhcmdzKSB7CiAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudC5jYXRhbG9nLCBwcm9wLCBhcmdzKTsKICB9CgogIGdldFBhZ2UocGFnZUluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5nZXRQYWdlKHBhZ2VJbmRleCk7CiAgfQoKICBmb250RmFsbGJhY2soaWQsIGhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LmZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcik7CiAgfQoKICBsb2FkWGZhRm9udHMoaGFuZGxlciwgdGFzaykgewogICAgcmV0dXJuIHRoaXMucGRmRG9jdW1lbnQubG9hZFhmYUZvbnRzKGhhbmRsZXIsIHRhc2spOwogIH0KCiAgbG9hZFhmYUltYWdlcygpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LmxvYWRYZmFJbWFnZXMoKTsKICB9CgogIHNlcmlhbGl6ZVhmYURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIHJldHVybiB0aGlzLnBkZkRvY3VtZW50LnNlcmlhbGl6ZVhmYURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpOwogIH0KCiAgY2xlYW51cChtYW51YWxseVRyaWdnZXJlZCA9IGZhbHNlKSB7CiAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5jbGVhbnVwKG1hbnVhbGx5VHJpZ2dlcmVkKTsKICB9CgogIGFzeW5jIGVuc3VyZShvYmosIHByb3AsIGFyZ3MpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZW5zdXJlYCBjYWxsZWQiKTsKICB9CgogIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYHJlcXVlc3RSYW5nZWAgY2FsbGVkIik7CiAgfQoKICByZXF1ZXN0TG9hZGVkU3RyZWFtKCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGByZXF1ZXN0TG9hZGVkU3RyZWFtYCBjYWxsZWQiKTsKICB9CgogIHNlbmRQcm9ncmVzc2l2ZURhdGEoY2h1bmspIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgc2VuZFByb2dyZXNzaXZlRGF0YWAgY2FsbGVkIik7CiAgfQoKICB1cGRhdGVQYXNzd29yZChwYXNzd29yZCkgewogICAgdGhpcy5fcGFzc3dvcmQgPSBwYXNzd29yZDsKICB9CgogIHRlcm1pbmF0ZShyZWFzb24pIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgdGVybWluYXRlYCBjYWxsZWQiKTsKICB9Cgp9CgpjbGFzcyBMb2NhbFBkZk1hbmFnZXIgZXh0ZW5kcyBCYXNlUGRmTWFuYWdlciB7CiAgY29uc3RydWN0b3IoZG9jSWQsIGRhdGEsIHBhc3N3b3JkLCBtc2dIYW5kbGVyLCBldmFsdWF0b3JPcHRpb25zLCBlbmFibGVYZmEsIGRvY0Jhc2VVcmwpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9kb2NJZCA9IGRvY0lkOwogICAgdGhpcy5fcGFzc3dvcmQgPSBwYXNzd29yZDsKICAgIHRoaXMuX2RvY0Jhc2VVcmwgPSBwYXJzZURvY0Jhc2VVcmwoZG9jQmFzZVVybCk7CiAgICB0aGlzLm1zZ0hhbmRsZXIgPSBtc2dIYW5kbGVyOwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gZXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMuZW5hYmxlWGZhID0gZW5hYmxlWGZhOwogICAgY29uc3Qgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyZWFtKGRhdGEpOwogICAgdGhpcy5wZGZEb2N1bWVudCA9IG5ldyBfZG9jdW1lbnQuUERGRG9jdW1lbnQodGhpcywgc3RyZWFtKTsKICAgIHRoaXMuX2xvYWRlZFN0cmVhbVByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoc3RyZWFtKTsKICB9CgogIGFzeW5jIGVuc3VyZShvYmosIHByb3AsIGFyZ3MpIHsKICAgIGNvbnN0IHZhbHVlID0gb2JqW3Byb3BdOwoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIHZhbHVlLmFwcGx5KG9iaiwgYXJncyk7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgcmVxdWVzdFJhbmdlKGJlZ2luLCBlbmQpIHsKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICB9CgogIHJlcXVlc3RMb2FkZWRTdHJlYW0oKSB7fQoKICBvbkxvYWRlZFN0cmVhbSgpIHsKICAgIHJldHVybiB0aGlzLl9sb2FkZWRTdHJlYW1Qcm9taXNlOwogIH0KCiAgdGVybWluYXRlKHJlYXNvbikge30KCn0KCmV4cG9ydHMuTG9jYWxQZGZNYW5hZ2VyID0gTG9jYWxQZGZNYW5hZ2VyOwoKY2xhc3MgTmV0d29ya1BkZk1hbmFnZXIgZXh0ZW5kcyBCYXNlUGRmTWFuYWdlciB7CiAgY29uc3RydWN0b3IoZG9jSWQsIHBkZk5ldHdvcmtTdHJlYW0sIGFyZ3MsIGV2YWx1YXRvck9wdGlvbnMsIGVuYWJsZVhmYSwgZG9jQmFzZVVybCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX2RvY0lkID0gZG9jSWQ7CiAgICB0aGlzLl9wYXNzd29yZCA9IGFyZ3MucGFzc3dvcmQ7CiAgICB0aGlzLl9kb2NCYXNlVXJsID0gcGFyc2VEb2NCYXNlVXJsKGRvY0Jhc2VVcmwpOwogICAgdGhpcy5tc2dIYW5kbGVyID0gYXJncy5tc2dIYW5kbGVyOwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gZXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMuZW5hYmxlWGZhID0gZW5hYmxlWGZhOwogICAgdGhpcy5zdHJlYW1NYW5hZ2VyID0gbmV3IF9jaHVua2VkX3N0cmVhbS5DaHVua2VkU3RyZWFtTWFuYWdlcihwZGZOZXR3b3JrU3RyZWFtLCB7CiAgICAgIG1zZ0hhbmRsZXI6IGFyZ3MubXNnSGFuZGxlciwKICAgICAgbGVuZ3RoOiBhcmdzLmxlbmd0aCwKICAgICAgZGlzYWJsZUF1dG9GZXRjaDogYXJncy5kaXNhYmxlQXV0b0ZldGNoLAogICAgICByYW5nZUNodW5rU2l6ZTogYXJncy5yYW5nZUNodW5rU2l6ZQogICAgfSk7CiAgICB0aGlzLnBkZkRvY3VtZW50ID0gbmV3IF9kb2N1bWVudC5QREZEb2N1bWVudCh0aGlzLCB0aGlzLnN0cmVhbU1hbmFnZXIuZ2V0U3RyZWFtKCkpOwogIH0KCiAgYXN5bmMgZW5zdXJlKG9iaiwgcHJvcCwgYXJncykgewogICAgdHJ5IHsKICAgICAgY29uc3QgdmFsdWUgPSBvYmpbcHJvcF07CgogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlLmFwcGx5KG9iaiwgYXJncyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmICghKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgIGF3YWl0IHRoaXMucmVxdWVzdFJhbmdlKGV4LmJlZ2luLCBleC5lbmQpOwogICAgICByZXR1cm4gdGhpcy5lbnN1cmUob2JqLCBwcm9wLCBhcmdzKTsKICAgIH0KICB9CgogIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICByZXR1cm4gdGhpcy5zdHJlYW1NYW5hZ2VyLnJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKTsKICB9CgogIHJlcXVlc3RMb2FkZWRTdHJlYW0oKSB7CiAgICB0aGlzLnN0cmVhbU1hbmFnZXIucmVxdWVzdEFsbENodW5rcygpOwogIH0KCiAgc2VuZFByb2dyZXNzaXZlRGF0YShjaHVuaykgewogICAgdGhpcy5zdHJlYW1NYW5hZ2VyLm9uUmVjZWl2ZURhdGEoewogICAgICBjaHVuawogICAgfSk7CiAgfQoKICBvbkxvYWRlZFN0cmVhbSgpIHsKICAgIHJldHVybiB0aGlzLnN0cmVhbU1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKTsKICB9CgogIHRlcm1pbmF0ZShyZWFzb24pIHsKICAgIHRoaXMuc3RyZWFtTWFuYWdlci5hYm9ydChyZWFzb24pOwogIH0KCn0KCmV4cG9ydHMuTmV0d29ya1BkZk1hbmFnZXIgPSBOZXR3b3JrUGRmTWFuYWdlcjsKCi8qKiovIH0pLAovKiA5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQ2h1bmtlZFN0cmVhbU1hbmFnZXIgPSBleHBvcnRzLkNodW5rZWRTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CgpjbGFzcyBDaHVua2VkU3RyZWFtIGV4dGVuZHMgX3N0cmVhbS5TdHJlYW0gewogIGNvbnN0cnVjdG9yKGxlbmd0aCwgY2h1bmtTaXplLCBtYW5hZ2VyKSB7CiAgICBzdXBlcihuZXcgVWludDhBcnJheShsZW5ndGgpLCAwLCBsZW5ndGgsIG51bGwpOwogICAgdGhpcy5jaHVua1NpemUgPSBjaHVua1NpemU7CiAgICB0aGlzLl9sb2FkZWRDaHVua3MgPSBuZXcgU2V0KCk7CiAgICB0aGlzLm51bUNodW5rcyA9IE1hdGguY2VpbChsZW5ndGggLyBjaHVua1NpemUpOwogICAgdGhpcy5tYW5hZ2VyID0gbWFuYWdlcjsKICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gMDsKICAgIHRoaXMubGFzdFN1Y2Nlc3NmdWxFbnN1cmVCeXRlQ2h1bmsgPSAtMTsKICB9CgogIGdldE1pc3NpbmdDaHVua3MoKSB7CiAgICBjb25zdCBjaHVua3MgPSBbXTsKCiAgICBmb3IgKGxldCBjaHVuayA9IDAsIG4gPSB0aGlzLm51bUNodW5rczsgY2h1bmsgPCBuOyArK2NodW5rKSB7CiAgICAgIGlmICghdGhpcy5fbG9hZGVkQ2h1bmtzLmhhcyhjaHVuaykpIHsKICAgICAgICBjaHVua3MucHVzaChjaHVuayk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY2h1bmtzOwogIH0KCiAgZ2V0IG51bUNodW5rc0xvYWRlZCgpIHsKICAgIHJldHVybiB0aGlzLl9sb2FkZWRDaHVua3Muc2l6ZTsKICB9CgogIGdldCBpc0RhdGFMb2FkZWQoKSB7CiAgICByZXR1cm4gdGhpcy5udW1DaHVua3NMb2FkZWQgPT09IHRoaXMubnVtQ2h1bmtzOwogIH0KCiAgb25SZWNlaXZlRGF0YShiZWdpbiwgY2h1bmspIHsKICAgIGNvbnN0IGNodW5rU2l6ZSA9IHRoaXMuY2h1bmtTaXplOwoKICAgIGlmIChiZWdpbiAlIGNodW5rU2l6ZSAhPT0gMCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhZCBiZWdpbiBvZmZzZXQ6ICR7YmVnaW59YCk7CiAgICB9CgogICAgY29uc3QgZW5kID0gYmVnaW4gKyBjaHVuay5ieXRlTGVuZ3RoOwoKICAgIGlmIChlbmQgJSBjaHVua1NpemUgIT09IDAgJiYgZW5kICE9PSB0aGlzLmJ5dGVzLmxlbmd0aCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhZCBlbmQgb2Zmc2V0OiAke2VuZH1gKTsKICAgIH0KCiAgICB0aGlzLmJ5dGVzLnNldChuZXcgVWludDhBcnJheShjaHVuayksIGJlZ2luKTsKICAgIGNvbnN0IGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKGJlZ2luIC8gY2h1bmtTaXplKTsKICAgIGNvbnN0IGVuZENodW5rID0gTWF0aC5mbG9vcigoZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKCiAgICBmb3IgKGxldCBjdXJDaHVuayA9IGJlZ2luQ2h1bms7IGN1ckNodW5rIDwgZW5kQ2h1bms7ICsrY3VyQ2h1bmspIHsKICAgICAgdGhpcy5fbG9hZGVkQ2h1bmtzLmFkZChjdXJDaHVuayk7CiAgICB9CiAgfQoKICBvblJlY2VpdmVQcm9ncmVzc2l2ZURhdGEoZGF0YSkgewogICAgbGV0IHBvc2l0aW9uID0gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGg7CiAgICBjb25zdCBiZWdpbkNodW5rID0gTWF0aC5mbG9vcihwb3NpdGlvbiAvIHRoaXMuY2h1bmtTaXplKTsKICAgIHRoaXMuYnl0ZXMuc2V0KG5ldyBVaW50OEFycmF5KGRhdGEpLCBwb3NpdGlvbik7CiAgICBwb3NpdGlvbiArPSBkYXRhLmJ5dGVMZW5ndGg7CiAgICB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCA9IHBvc2l0aW9uOwogICAgY29uc3QgZW5kQ2h1bmsgPSBwb3NpdGlvbiA+PSB0aGlzLmVuZCA/IHRoaXMubnVtQ2h1bmtzIDogTWF0aC5mbG9vcihwb3NpdGlvbiAvIHRoaXMuY2h1bmtTaXplKTsKCiAgICBmb3IgKGxldCBjdXJDaHVuayA9IGJlZ2luQ2h1bms7IGN1ckNodW5rIDwgZW5kQ2h1bms7ICsrY3VyQ2h1bmspIHsKICAgICAgdGhpcy5fbG9hZGVkQ2h1bmtzLmFkZChjdXJDaHVuayk7CiAgICB9CiAgfQoKICBlbnN1cmVCeXRlKHBvcykgewogICAgaWYgKHBvcyA8IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjaHVuayA9IE1hdGguZmxvb3IocG9zIC8gdGhpcy5jaHVua1NpemUpOwoKICAgIGlmIChjaHVuayA+IHRoaXMubnVtQ2h1bmtzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoY2h1bmsgPT09IHRoaXMubGFzdFN1Y2Nlc3NmdWxFbnN1cmVCeXRlQ2h1bmspIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghdGhpcy5fbG9hZGVkQ2h1bmtzLmhhcyhjaHVuaykpIHsKICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKHBvcywgcG9zICsgMSk7CiAgICB9CgogICAgdGhpcy5sYXN0U3VjY2Vzc2Z1bEVuc3VyZUJ5dGVDaHVuayA9IGNodW5rOwogIH0KCiAgZW5zdXJlUmFuZ2UoYmVnaW4sIGVuZCkgewogICAgaWYgKGJlZ2luID49IGVuZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGVuZCA8PSB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CgogICAgaWYgKGJlZ2luQ2h1bmsgPiB0aGlzLm51bUNodW5rcykgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZW5kQ2h1bmsgPSBNYXRoLm1pbihNYXRoLmZsb29yKChlbmQgLSAxKSAvIHRoaXMuY2h1bmtTaXplKSArIDEsIHRoaXMubnVtQ2h1bmtzKTsKCiAgICBmb3IgKGxldCBjaHVuayA9IGJlZ2luQ2h1bms7IGNodW5rIDwgZW5kQ2h1bms7ICsrY2h1bmspIHsKICAgICAgaWYgKCF0aGlzLl9sb2FkZWRDaHVua3MuaGFzKGNodW5rKSkgewogICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbihiZWdpbiwgZW5kKTsKICAgICAgfQogICAgfQogIH0KCiAgbmV4dEVtcHR5Q2h1bmsoYmVnaW5DaHVuaykgewogICAgY29uc3QgbnVtQ2h1bmtzID0gdGhpcy5udW1DaHVua3M7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1DaHVua3M7ICsraSkgewogICAgICBjb25zdCBjaHVuayA9IChiZWdpbkNodW5rICsgaSkgJSBudW1DaHVua3M7CgogICAgICBpZiAoIXRoaXMuX2xvYWRlZENodW5rcy5oYXMoY2h1bmspKSB7CiAgICAgICAgcmV0dXJuIGNodW5rOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBoYXNDaHVuayhjaHVuaykgewogICAgcmV0dXJuIHRoaXMuX2xvYWRlZENodW5rcy5oYXMoY2h1bmspOwogIH0KCiAgZ2V0Qnl0ZSgpIHsKICAgIGNvbnN0IHBvcyA9IHRoaXMucG9zOwoKICAgIGlmIChwb3MgPj0gdGhpcy5lbmQpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfQoKICAgIGlmIChwb3MgPj0gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgdGhpcy5lbnN1cmVCeXRlKHBvcyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnl0ZXNbdGhpcy5wb3MrK107CiAgfQoKICBnZXRCeXRlcyhsZW5ndGgpIHsKICAgIGNvbnN0IGJ5dGVzID0gdGhpcy5ieXRlczsKICAgIGNvbnN0IHBvcyA9IHRoaXMucG9zOwogICAgY29uc3Qgc3RyRW5kID0gdGhpcy5lbmQ7CgogICAgaWYgKCFsZW5ndGgpIHsKICAgICAgaWYgKHN0ckVuZCA+IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgICAgdGhpcy5lbnN1cmVSYW5nZShwb3MsIHN0ckVuZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBieXRlcy5zdWJhcnJheShwb3MsIHN0ckVuZCk7CiAgICB9CgogICAgbGV0IGVuZCA9IHBvcyArIGxlbmd0aDsKCiAgICBpZiAoZW5kID4gc3RyRW5kKSB7CiAgICAgIGVuZCA9IHN0ckVuZDsKICAgIH0KCiAgICBpZiAoZW5kID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgdGhpcy5lbnN1cmVSYW5nZShwb3MsIGVuZCk7CiAgICB9CgogICAgdGhpcy5wb3MgPSBlbmQ7CiAgICByZXR1cm4gYnl0ZXMuc3ViYXJyYXkocG9zLCBlbmQpOwogIH0KCiAgZ2V0Qnl0ZVJhbmdlKGJlZ2luLCBlbmQpIHsKICAgIGlmIChiZWdpbiA8IDApIHsKICAgICAgYmVnaW4gPSAwOwogICAgfQoKICAgIGlmIChlbmQgPiB0aGlzLmVuZCkgewogICAgICBlbmQgPSB0aGlzLmVuZDsKICAgIH0KCiAgICBpZiAoZW5kID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgdGhpcy5lbnN1cmVSYW5nZShiZWdpbiwgZW5kKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5ieXRlcy5zdWJhcnJheShiZWdpbiwgZW5kKTsKICB9CgogIG1ha2VTdWJTdHJlYW0oc3RhcnQsIGxlbmd0aCwgZGljdCA9IG51bGwpIHsKICAgIGlmIChsZW5ndGgpIHsKICAgICAgaWYgKHN0YXJ0ICsgbGVuZ3RoID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICB0aGlzLmVuc3VyZVJhbmdlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChzdGFydCA+PSB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICAgIHRoaXMuZW5zdXJlQnl0ZShzdGFydCk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBDaHVua2VkU3RyZWFtU3Vic3RyZWFtKCkge30KCiAgICBDaHVua2VkU3RyZWFtU3Vic3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUodGhpcyk7CgogICAgQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUuZ2V0TWlzc2luZ0NodW5rcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgY2h1bmtTaXplID0gdGhpcy5jaHVua1NpemU7CiAgICAgIGNvbnN0IGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKHRoaXMuc3RhcnQgLyBjaHVua1NpemUpOwogICAgICBjb25zdCBlbmRDaHVuayA9IE1hdGguZmxvb3IoKHRoaXMuZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKICAgICAgY29uc3QgbWlzc2luZ0NodW5rcyA9IFtdOwoKICAgICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgaWYgKCF0aGlzLl9sb2FkZWRDaHVua3MuaGFzKGNodW5rKSkgewogICAgICAgICAgbWlzc2luZ0NodW5rcy5wdXNoKGNodW5rKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBtaXNzaW5nQ2h1bmtzOwogICAgfTsKCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUsICJpc0RhdGFMb2FkZWQiLCB7CiAgICAgIGdldCgpIHsKICAgICAgICBpZiAodGhpcy5udW1DaHVua3NMb2FkZWQgPT09IHRoaXMubnVtQ2h1bmtzKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLmdldE1pc3NpbmdDaHVua3MoKS5sZW5ndGggPT09IDA7CiAgICAgIH0sCgogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0pOwogICAgY29uc3Qgc3ViU3RyZWFtID0gbmV3IENodW5rZWRTdHJlYW1TdWJzdHJlYW0oKTsKICAgIHN1YlN0cmVhbS5wb3MgPSBzdWJTdHJlYW0uc3RhcnQgPSBzdGFydDsKICAgIHN1YlN0cmVhbS5lbmQgPSBzdGFydCArIGxlbmd0aCB8fCB0aGlzLmVuZDsKICAgIHN1YlN0cmVhbS5kaWN0ID0gZGljdDsKICAgIHJldHVybiBzdWJTdHJlYW07CiAgfQoKICBnZXRCYXNlU3RyZWFtcygpIHsKICAgIHJldHVybiBbdGhpc107CiAgfQoKfQoKZXhwb3J0cy5DaHVua2VkU3RyZWFtID0gQ2h1bmtlZFN0cmVhbTsKCmNsYXNzIENodW5rZWRTdHJlYW1NYW5hZ2VyIHsKICBjb25zdHJ1Y3RvcihwZGZOZXR3b3JrU3RyZWFtLCBhcmdzKSB7CiAgICB0aGlzLmxlbmd0aCA9IGFyZ3MubGVuZ3RoOwogICAgdGhpcy5jaHVua1NpemUgPSBhcmdzLnJhbmdlQ2h1bmtTaXplOwogICAgdGhpcy5zdHJlYW0gPSBuZXcgQ2h1bmtlZFN0cmVhbSh0aGlzLmxlbmd0aCwgdGhpcy5jaHVua1NpemUsIHRoaXMpOwogICAgdGhpcy5wZGZOZXR3b3JrU3RyZWFtID0gcGRmTmV0d29ya1N0cmVhbTsKICAgIHRoaXMuZGlzYWJsZUF1dG9GZXRjaCA9IGFyZ3MuZGlzYWJsZUF1dG9GZXRjaDsKICAgIHRoaXMubXNnSGFuZGxlciA9IGFyZ3MubXNnSGFuZGxlcjsKICAgIHRoaXMuY3VyclJlcXVlc3RJZCA9IDA7CiAgICB0aGlzLl9jaHVua3NOZWVkZWRCeVJlcXVlc3QgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdCA9IG5ldyBNYXAoKTsKICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gMDsKICAgIHRoaXMuYWJvcnRlZCA9IGZhbHNlOwogICAgdGhpcy5fbG9hZGVkU3RyZWFtQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICB9CgogIG9uTG9hZGVkU3RyZWFtKCkgewogICAgcmV0dXJuIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIHNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpIHsKICAgIGNvbnN0IHJhbmdlUmVhZGVyID0gdGhpcy5wZGZOZXR3b3JrU3RyZWFtLmdldFJhbmdlUmVhZGVyKGJlZ2luLCBlbmQpOwoKICAgIGlmICghcmFuZ2VSZWFkZXIuaXNTdHJlYW1pbmdTdXBwb3J0ZWQpIHsKICAgICAgcmFuZ2VSZWFkZXIub25Qcm9ncmVzcyA9IHRoaXMub25Qcm9ncmVzcy5iaW5kKHRoaXMpOwogICAgfQoKICAgIGxldCBjaHVua3MgPSBbXSwKICAgICAgICBsb2FkZWQgPSAwOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgY29uc3QgcmVhZENodW5rID0gY2h1bmsgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAoIWNodW5rLmRvbmUpIHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNodW5rLnZhbHVlOwogICAgICAgICAgICBjaHVua3MucHVzaChkYXRhKTsKICAgICAgICAgICAgbG9hZGVkICs9ICgwLCBfdXRpbC5hcnJheUJ5dGVMZW5ndGgpKGRhdGEpOwoKICAgICAgICAgICAgaWYgKHJhbmdlUmVhZGVyLmlzU3RyZWFtaW5nU3VwcG9ydGVkKSB7CiAgICAgICAgICAgICAgdGhpcy5vblByb2dyZXNzKHsKICAgICAgICAgICAgICAgIGxvYWRlZAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICByYW5nZVJlYWRlci5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBjaHVua0RhdGEgPSAoMCwgX3V0aWwuYXJyYXlzVG9CeXRlcykoY2h1bmtzKTsKICAgICAgICAgIGNodW5rcyA9IG51bGw7CiAgICAgICAgICByZXNvbHZlKGNodW5rRGF0YSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHJhbmdlUmVhZGVyLnJlYWQoKS50aGVuKHJlYWRDaHVuaywgcmVqZWN0KTsKICAgIH0pLnRoZW4oZGF0YSA9PiB7CiAgICAgIGlmICh0aGlzLmFib3J0ZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMub25SZWNlaXZlRGF0YSh7CiAgICAgICAgY2h1bms6IGRhdGEsCiAgICAgICAgYmVnaW4KICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJlcXVlc3RBbGxDaHVua3MoKSB7CiAgICBjb25zdCBtaXNzaW5nQ2h1bmtzID0gdGhpcy5zdHJlYW0uZ2V0TWlzc2luZ0NodW5rcygpOwoKICAgIHRoaXMuX3JlcXVlc3RDaHVua3MobWlzc2luZ0NodW5rcyk7CgogICAgcmV0dXJuIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIF9yZXF1ZXN0Q2h1bmtzKGNodW5rcykgewogICAgY29uc3QgcmVxdWVzdElkID0gdGhpcy5jdXJyUmVxdWVzdElkKys7CiAgICBjb25zdCBjaHVua3NOZWVkZWQgPSBuZXcgU2V0KCk7CgogICAgdGhpcy5fY2h1bmtzTmVlZGVkQnlSZXF1ZXN0LnNldChyZXF1ZXN0SWQsIGNodW5rc05lZWRlZCk7CgogICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHsKICAgICAgaWYgKCF0aGlzLnN0cmVhbS5oYXNDaHVuayhjaHVuaykpIHsKICAgICAgICBjaHVua3NOZWVkZWQuYWRkKGNodW5rKTsKICAgICAgfQogICAgfQoKICAgIGlmIChjaHVua3NOZWVkZWQuc2l6ZSA9PT0gMCkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICB9CgogICAgY29uc3QgY2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKCiAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdC5zZXQocmVxdWVzdElkLCBjYXBhYmlsaXR5KTsKCiAgICBjb25zdCBjaHVua3NUb1JlcXVlc3QgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGNodW5rIG9mIGNodW5rc05lZWRlZCkgewogICAgICBsZXQgcmVxdWVzdElkcyA9IHRoaXMuX3JlcXVlc3RzQnlDaHVuay5nZXQoY2h1bmspOwoKICAgICAgaWYgKCFyZXF1ZXN0SWRzKSB7CiAgICAgICAgcmVxdWVzdElkcyA9IFtdOwoKICAgICAgICB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsuc2V0KGNodW5rLCByZXF1ZXN0SWRzKTsKCiAgICAgICAgY2h1bmtzVG9SZXF1ZXN0LnB1c2goY2h1bmspOwogICAgICB9CgogICAgICByZXF1ZXN0SWRzLnB1c2gocmVxdWVzdElkKTsKICAgIH0KCiAgICBpZiAoY2h1bmtzVG9SZXF1ZXN0Lmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgZ3JvdXBlZENodW5rc1RvUmVxdWVzdCA9IHRoaXMuZ3JvdXBDaHVua3MoY2h1bmtzVG9SZXF1ZXN0KTsKCiAgICAgIGZvciAoY29uc3QgZ3JvdXBlZENodW5rIG9mIGdyb3VwZWRDaHVua3NUb1JlcXVlc3QpIHsKICAgICAgICBjb25zdCBiZWdpbiA9IGdyb3VwZWRDaHVuay5iZWdpbkNodW5rICogdGhpcy5jaHVua1NpemU7CiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oZ3JvdXBlZENodW5rLmVuZENodW5rICogdGhpcy5jaHVua1NpemUsIHRoaXMubGVuZ3RoKTsKICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpLmNhdGNoKGNhcGFiaWxpdHkucmVqZWN0KTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2UuY2F0Y2gocmVhc29uID0+IHsKICAgICAgaWYgKHRoaXMuYWJvcnRlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBnZXRTdHJlYW0oKSB7CiAgICByZXR1cm4gdGhpcy5zdHJlYW07CiAgfQoKICByZXF1ZXN0UmFuZ2UoYmVnaW4sIGVuZCkgewogICAgZW5kID0gTWF0aC5taW4oZW5kLCB0aGlzLmxlbmd0aCk7CiAgICBjb25zdCBiZWdpbkNodW5rID0gdGhpcy5nZXRCZWdpbkNodW5rKGJlZ2luKTsKICAgIGNvbnN0IGVuZENodW5rID0gdGhpcy5nZXRFbmRDaHVuayhlbmQpOwogICAgY29uc3QgY2h1bmtzID0gW107CgogICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgIGNodW5rcy5wdXNoKGNodW5rKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENodW5rcyhjaHVua3MpOwogIH0KCiAgcmVxdWVzdFJhbmdlcyhyYW5nZXMgPSBbXSkgewogICAgY29uc3QgY2h1bmtzVG9SZXF1ZXN0ID0gW107CgogICAgZm9yIChjb25zdCByYW5nZSBvZiByYW5nZXMpIHsKICAgICAgY29uc3QgYmVnaW5DaHVuayA9IHRoaXMuZ2V0QmVnaW5DaHVuayhyYW5nZS5iZWdpbik7CiAgICAgIGNvbnN0IGVuZENodW5rID0gdGhpcy5nZXRFbmRDaHVuayhyYW5nZS5lbmQpOwoKICAgICAgZm9yIChsZXQgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgaWYgKCFjaHVua3NUb1JlcXVlc3QuaW5jbHVkZXMoY2h1bmspKSB7CiAgICAgICAgICBjaHVua3NUb1JlcXVlc3QucHVzaChjaHVuayk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY2h1bmtzVG9SZXF1ZXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuIGEgLSBiOwogICAgfSk7CiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENodW5rcyhjaHVua3NUb1JlcXVlc3QpOwogIH0KCiAgZ3JvdXBDaHVua3MoY2h1bmtzKSB7CiAgICBjb25zdCBncm91cGVkQ2h1bmtzID0gW107CiAgICBsZXQgYmVnaW5DaHVuayA9IC0xOwogICAgbGV0IHByZXZDaHVuayA9IC0xOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IGNodW5rID0gY2h1bmtzW2ldOwoKICAgICAgaWYgKGJlZ2luQ2h1bmsgPCAwKSB7CiAgICAgICAgYmVnaW5DaHVuayA9IGNodW5rOwogICAgICB9CgogICAgICBpZiAocHJldkNodW5rID49IDAgJiYgcHJldkNodW5rICsgMSAhPT0gY2h1bmspIHsKICAgICAgICBncm91cGVkQ2h1bmtzLnB1c2goewogICAgICAgICAgYmVnaW5DaHVuaywKICAgICAgICAgIGVuZENodW5rOiBwcmV2Q2h1bmsgKyAxCiAgICAgICAgfSk7CiAgICAgICAgYmVnaW5DaHVuayA9IGNodW5rOwogICAgICB9CgogICAgICBpZiAoaSArIDEgPT09IGNodW5rcy5sZW5ndGgpIHsKICAgICAgICBncm91cGVkQ2h1bmtzLnB1c2goewogICAgICAgICAgYmVnaW5DaHVuaywKICAgICAgICAgIGVuZENodW5rOiBjaHVuayArIDEKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcHJldkNodW5rID0gY2h1bms7CiAgICB9CgogICAgcmV0dXJuIGdyb3VwZWRDaHVua3M7CiAgfQoKICBvblByb2dyZXNzKGFyZ3MpIHsKICAgIHRoaXMubXNnSGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgbG9hZGVkOiB0aGlzLnN0cmVhbS5udW1DaHVua3NMb2FkZWQgKiB0aGlzLmNodW5rU2l6ZSArIGFyZ3MubG9hZGVkLAogICAgICB0b3RhbDogdGhpcy5sZW5ndGgKICAgIH0pOwogIH0KCiAgb25SZWNlaXZlRGF0YShhcmdzKSB7CiAgICBjb25zdCBjaHVuayA9IGFyZ3MuY2h1bms7CiAgICBjb25zdCBpc1Byb2dyZXNzaXZlID0gYXJncy5iZWdpbiA9PT0gdW5kZWZpbmVkOwogICAgY29uc3QgYmVnaW4gPSBpc1Byb2dyZXNzaXZlID8gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggOiBhcmdzLmJlZ2luOwogICAgY29uc3QgZW5kID0gYmVnaW4gKyBjaHVuay5ieXRlTGVuZ3RoOwogICAgY29uc3QgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CiAgICBjb25zdCBlbmRDaHVuayA9IGVuZCA8IHRoaXMubGVuZ3RoID8gTWF0aC5mbG9vcihlbmQgLyB0aGlzLmNodW5rU2l6ZSkgOiBNYXRoLmNlaWwoZW5kIC8gdGhpcy5jaHVua1NpemUpOwoKICAgIGlmIChpc1Byb2dyZXNzaXZlKSB7CiAgICAgIHRoaXMuc3RyZWFtLm9uUmVjZWl2ZVByb2dyZXNzaXZlRGF0YShjaHVuayk7CiAgICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gZW5kOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdHJlYW0ub25SZWNlaXZlRGF0YShiZWdpbiwgY2h1bmspOwogICAgfQoKICAgIGlmICh0aGlzLnN0cmVhbS5pc0RhdGFMb2FkZWQpIHsKICAgICAgdGhpcy5fbG9hZGVkU3RyZWFtQ2FwYWJpbGl0eS5yZXNvbHZlKHRoaXMuc3RyZWFtKTsKICAgIH0KCiAgICBjb25zdCBsb2FkZWRSZXF1ZXN0cyA9IFtdOwoKICAgIGZvciAobGV0IGN1ckNodW5rID0gYmVnaW5DaHVuazsgY3VyQ2h1bmsgPCBlbmRDaHVuazsgKytjdXJDaHVuaykgewogICAgICBjb25zdCByZXF1ZXN0SWRzID0gdGhpcy5fcmVxdWVzdHNCeUNodW5rLmdldChjdXJDaHVuayk7CgogICAgICBpZiAoIXJlcXVlc3RJZHMpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdGhpcy5fcmVxdWVzdHNCeUNodW5rLmRlbGV0ZShjdXJDaHVuayk7CgogICAgICBmb3IgKGNvbnN0IHJlcXVlc3RJZCBvZiByZXF1ZXN0SWRzKSB7CiAgICAgICAgY29uc3QgY2h1bmtzTmVlZGVkID0gdGhpcy5fY2h1bmtzTmVlZGVkQnlSZXF1ZXN0LmdldChyZXF1ZXN0SWQpOwoKICAgICAgICBpZiAoY2h1bmtzTmVlZGVkLmhhcyhjdXJDaHVuaykpIHsKICAgICAgICAgIGNodW5rc05lZWRlZC5kZWxldGUoY3VyQ2h1bmspOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNodW5rc05lZWRlZC5zaXplID4gMCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsb2FkZWRSZXF1ZXN0cy5wdXNoKHJlcXVlc3RJZCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMuZGlzYWJsZUF1dG9GZXRjaCAmJiB0aGlzLl9yZXF1ZXN0c0J5Q2h1bmsuc2l6ZSA9PT0gMCkgewogICAgICBsZXQgbmV4dEVtcHR5Q2h1bms7CgogICAgICBpZiAodGhpcy5zdHJlYW0ubnVtQ2h1bmtzTG9hZGVkID09PSAxKSB7CiAgICAgICAgY29uc3QgbGFzdENodW5rID0gdGhpcy5zdHJlYW0ubnVtQ2h1bmtzIC0gMTsKCiAgICAgICAgaWYgKCF0aGlzLnN0cmVhbS5oYXNDaHVuayhsYXN0Q2h1bmspKSB7CiAgICAgICAgICBuZXh0RW1wdHlDaHVuayA9IGxhc3RDaHVuazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV4dEVtcHR5Q2h1bmsgPSB0aGlzLnN0cmVhbS5uZXh0RW1wdHlDaHVuayhlbmRDaHVuayk7CiAgICAgIH0KCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG5leHRFbXB0eUNodW5rKSkgewogICAgICAgIHRoaXMuX3JlcXVlc3RDaHVua3MoW25leHRFbXB0eUNodW5rXSk7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IHJlcXVlc3RJZCBvZiBsb2FkZWRSZXF1ZXN0cykgewogICAgICBjb25zdCBjYXBhYmlsaXR5ID0gdGhpcy5fcHJvbWlzZXNCeVJlcXVlc3QuZ2V0KHJlcXVlc3RJZCk7CgogICAgICB0aGlzLl9wcm9taXNlc0J5UmVxdWVzdC5kZWxldGUocmVxdWVzdElkKTsKCiAgICAgIGNhcGFiaWxpdHkucmVzb2x2ZSgpOwogICAgfQoKICAgIHRoaXMubXNnSGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgbG9hZGVkOiB0aGlzLnN0cmVhbS5udW1DaHVua3NMb2FkZWQgKiB0aGlzLmNodW5rU2l6ZSwKICAgICAgdG90YWw6IHRoaXMubGVuZ3RoCiAgICB9KTsKICB9CgogIG9uRXJyb3IoZXJyKSB7CiAgICB0aGlzLl9sb2FkZWRTdHJlYW1DYXBhYmlsaXR5LnJlamVjdChlcnIpOwogIH0KCiAgZ2V0QmVnaW5DaHVuayhiZWdpbikgewogICAgcmV0dXJuIE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CiAgfQoKICBnZXRFbmRDaHVuayhlbmQpIHsKICAgIHJldHVybiBNYXRoLmZsb29yKChlbmQgLSAxKSAvIHRoaXMuY2h1bmtTaXplKSArIDE7CiAgfQoKICBhYm9ydChyZWFzb24pIHsKICAgIHRoaXMuYWJvcnRlZCA9IHRydWU7CgogICAgaWYgKHRoaXMucGRmTmV0d29ya1N0cmVhbSkgewogICAgICB0aGlzLnBkZk5ldHdvcmtTdHJlYW0uY2FuY2VsQWxsUmVxdWVzdHMocmVhc29uKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNhcGFiaWxpdHkgb2YgdGhpcy5fcHJvbWlzZXNCeVJlcXVlc3QudmFsdWVzKCkpIHsKICAgICAgY2FwYWJpbGl0eS5yZWplY3QocmVhc29uKTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkNodW5rZWRTdHJlYW1NYW5hZ2VyID0gQ2h1bmtlZFN0cmVhbU1hbmFnZXI7CgovKioqLyB9KSwKLyogMTAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHJpbmdTdHJlYW0gPSBleHBvcnRzLlN0cmVhbSA9IGV4cG9ydHMuTnVsbFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIFN0cmVhbSBleHRlbmRzIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihhcnJheUJ1ZmZlciwgc3RhcnQsIGxlbmd0aCwgZGljdCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuYnl0ZXMgPSBhcnJheUJ1ZmZlciBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgPyBhcnJheUJ1ZmZlciA6IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTsKICAgIHRoaXMuc3RhcnQgPSBzdGFydCB8fCAwOwogICAgdGhpcy5wb3MgPSB0aGlzLnN0YXJ0OwogICAgdGhpcy5lbmQgPSBzdGFydCArIGxlbmd0aCB8fCB0aGlzLmJ5dGVzLmxlbmd0aDsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMuZW5kIC0gdGhpcy5zdGFydDsKICB9CgogIGdldCBpc0VtcHR5KCkgewogICAgcmV0dXJuIHRoaXMubGVuZ3RoID09PSAwOwogIH0KCiAgZ2V0Qnl0ZSgpIHsKICAgIGlmICh0aGlzLnBvcyA+PSB0aGlzLmVuZCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnl0ZXNbdGhpcy5wb3MrK107CiAgfQoKICBnZXRCeXRlcyhsZW5ndGgpIHsKICAgIGNvbnN0IGJ5dGVzID0gdGhpcy5ieXRlczsKICAgIGNvbnN0IHBvcyA9IHRoaXMucG9zOwogICAgY29uc3Qgc3RyRW5kID0gdGhpcy5lbmQ7CgogICAgaWYgKCFsZW5ndGgpIHsKICAgICAgcmV0dXJuIGJ5dGVzLnN1YmFycmF5KHBvcywgc3RyRW5kKTsKICAgIH0KCiAgICBsZXQgZW5kID0gcG9zICsgbGVuZ3RoOwoKICAgIGlmIChlbmQgPiBzdHJFbmQpIHsKICAgICAgZW5kID0gc3RyRW5kOwogICAgfQoKICAgIHRoaXMucG9zID0gZW5kOwogICAgcmV0dXJuIGJ5dGVzLnN1YmFycmF5KHBvcywgZW5kKTsKICB9CgogIGdldEJ5dGVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICBpZiAoYmVnaW4gPCAwKSB7CiAgICAgIGJlZ2luID0gMDsKICAgIH0KCiAgICBpZiAoZW5kID4gdGhpcy5lbmQpIHsKICAgICAgZW5kID0gdGhpcy5lbmQ7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnl0ZXMuc3ViYXJyYXkoYmVnaW4sIGVuZCk7CiAgfQoKICByZXNldCgpIHsKICAgIHRoaXMucG9zID0gdGhpcy5zdGFydDsKICB9CgogIG1vdmVTdGFydCgpIHsKICAgIHRoaXMuc3RhcnQgPSB0aGlzLnBvczsKICB9CgogIG1ha2VTdWJTdHJlYW0oc3RhcnQsIGxlbmd0aCwgZGljdCA9IG51bGwpIHsKICAgIHJldHVybiBuZXcgU3RyZWFtKHRoaXMuYnl0ZXMuYnVmZmVyLCBzdGFydCwgbGVuZ3RoLCBkaWN0KTsKICB9Cgp9CgpleHBvcnRzLlN0cmVhbSA9IFN0cmVhbTsKCmNsYXNzIFN0cmluZ1N0cmVhbSBleHRlbmRzIFN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyKSB7CiAgICBzdXBlcigoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc3RyKSk7CiAgfQoKfQoKZXhwb3J0cy5TdHJpbmdTdHJlYW0gPSBTdHJpbmdTdHJlYW07CgpjbGFzcyBOdWxsU3RyZWFtIGV4dGVuZHMgU3RyZWFtIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKG5ldyBVaW50OEFycmF5KDApKTsKICB9Cgp9CgpleHBvcnRzLk51bGxTdHJlYW0gPSBOdWxsU3RyZWFtOwoKLyoqKi8gfSksCi8qIDExICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGFnZSA9IGV4cG9ydHMuUERGRG9jdW1lbnQgPSB2b2lkIDA7Cgp2YXIgX2Fubm90YXRpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfeGZhX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1MSk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfY3J5cHRvID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Nyk7Cgp2YXIgX2NhdGFsb2cgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY5KTsKCnZhciBfY2xlYW51cF9oZWxwZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcxKTsKCnZhciBfZGF0YXNldF9yZWFkZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMCk7Cgp2YXIgX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCnZhciBfb2JqZWN0X2xvYWRlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNzUpOwoKdmFyIF9vcGVyYXRvcl9saXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7Cgp2YXIgX2V2YWx1YXRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUpOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7Cgp2YXIgX3N0cnVjdF90cmVlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3NCk7Cgp2YXIgX3dyaXRlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNjUpOwoKdmFyIF9mYWN0b3J5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nik7Cgp2YXIgX3hyZWYgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMSk7Cgpjb25zdCBERUZBVUxUX1VTRVJfVU5JVCA9IDEuMDsKY29uc3QgTEVUVEVSX1NJWkVfTUVESUFCT1ggPSBbMCwgMCwgNjEyLCA3OTJdOwoKY2xhc3MgUGFnZSB7CiAgY29uc3RydWN0b3IoewogICAgcGRmTWFuYWdlciwKICAgIHhyZWYsCiAgICBwYWdlSW5kZXgsCiAgICBwYWdlRGljdCwKICAgIHJlZiwKICAgIGdsb2JhbElkRmFjdG9yeSwKICAgIGZvbnRDYWNoZSwKICAgIGJ1aWx0SW5DTWFwQ2FjaGUsCiAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICBnbG9iYWxJbWFnZUNhY2hlLAogICAgbm9uQmxlbmRNb2Rlc1NldCwKICAgIHhmYUZhY3RvcnkKICB9KSB7CiAgICB0aGlzLnBkZk1hbmFnZXIgPSBwZGZNYW5hZ2VyOwogICAgdGhpcy5wYWdlSW5kZXggPSBwYWdlSW5kZXg7CiAgICB0aGlzLnBhZ2VEaWN0ID0gcGFnZURpY3Q7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5yZWYgPSByZWY7CiAgICB0aGlzLmZvbnRDYWNoZSA9IGZvbnRDYWNoZTsKICAgIHRoaXMuYnVpbHRJbkNNYXBDYWNoZSA9IGJ1aWx0SW5DTWFwQ2FjaGU7CiAgICB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZSA9IHN0YW5kYXJkRm9udERhdGFDYWNoZTsKICAgIHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZSA9IGdsb2JhbEltYWdlQ2FjaGU7CiAgICB0aGlzLm5vbkJsZW5kTW9kZXNTZXQgPSBub25CbGVuZE1vZGVzU2V0OwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gcGRmTWFuYWdlci5ldmFsdWF0b3JPcHRpb25zOwogICAgdGhpcy5yZXNvdXJjZXNQcm9taXNlID0gbnVsbDsKICAgIHRoaXMueGZhRmFjdG9yeSA9IHhmYUZhY3Rvcnk7CiAgICBjb25zdCBpZENvdW50ZXJzID0gewogICAgICBvYmo6IDAKICAgIH07CiAgICB0aGlzLl9sb2NhbElkRmFjdG9yeSA9IGNsYXNzIGV4dGVuZHMgZ2xvYmFsSWRGYWN0b3J5IHsKICAgICAgc3RhdGljIGNyZWF0ZU9iaklkKCkgewogICAgICAgIHJldHVybiBgcCR7cGFnZUluZGV4fV8keysraWRDb3VudGVycy5vYmp9YDsKICAgICAgfQoKICAgICAgc3RhdGljIGdldFBhZ2VPYmpJZCgpIHsKICAgICAgICByZXR1cm4gYHBhZ2Uke3JlZi50b1N0cmluZygpfWA7CiAgICAgIH0KCiAgICB9OwogIH0KCiAgX2dldEluaGVyaXRhYmxlUHJvcGVydHkoa2V5LCBnZXRBcnJheSA9IGZhbHNlKSB7CiAgICBjb25zdCB2YWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IHRoaXMucGFnZURpY3QsCiAgICAgIGtleSwKICAgICAgZ2V0QXJyYXksCiAgICAgIHN0b3BXaGVuRm91bmQ6IGZhbHNlCiAgICB9KTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KCiAgICBpZiAodmFsdWUubGVuZ3RoID09PSAxIHx8ICEodmFsdWVbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gdmFsdWVbMF07CiAgICB9CgogICAgcmV0dXJuIF9wcmltaXRpdmVzLkRpY3QubWVyZ2UoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGRpY3RBcnJheTogdmFsdWUKICAgIH0pOwogIH0KCiAgZ2V0IGNvbnRlbnQoKSB7CiAgICByZXR1cm4gdGhpcy5wYWdlRGljdC5nZXRBcnJheSgiQ29udGVudHMiKTsKICB9CgogIGdldCByZXNvdXJjZXMoKSB7CiAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLl9nZXRJbmhlcml0YWJsZVByb3BlcnR5KCJSZXNvdXJjZXMiKTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInJlc291cmNlcyIsIHJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgPyByZXNvdXJjZXMgOiBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5KTsKICB9CgogIF9nZXRCb3VuZGluZ0JveChuYW1lKSB7CiAgICBpZiAodGhpcy54ZmFEYXRhKSB7CiAgICAgIHJldHVybiB0aGlzLnhmYURhdGEuYmJveDsKICAgIH0KCiAgICBjb25zdCBib3ggPSB0aGlzLl9nZXRJbmhlcml0YWJsZVByb3BlcnR5KG5hbWUsIHRydWUpOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGJveCkgJiYgYm94Lmxlbmd0aCA9PT0gNCkgewogICAgICBpZiAoYm94WzJdIC0gYm94WzBdICE9PSAwICYmIGJveFszXSAtIGJveFsxXSAhPT0gMCkgewogICAgICAgIHJldHVybiBib3g7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKShgRW1wdHkgLyR7bmFtZX0gZW50cnkuYCk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBnZXQgbWVkaWFCb3goKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm1lZGlhQm94IiwgdGhpcy5fZ2V0Qm91bmRpbmdCb3goIk1lZGlhQm94IikgfHwgTEVUVEVSX1NJWkVfTUVESUFCT1gpOwogIH0KCiAgZ2V0IGNyb3BCb3goKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImNyb3BCb3giLCB0aGlzLl9nZXRCb3VuZGluZ0JveCgiQ3JvcEJveCIpIHx8IHRoaXMubWVkaWFCb3gpOwogIH0KCiAgZ2V0IHVzZXJVbml0KCkgewogICAgbGV0IG9iaiA9IHRoaXMucGFnZURpY3QuZ2V0KCJVc2VyVW5pdCIpOwoKICAgIGlmICh0eXBlb2Ygb2JqICE9PSAibnVtYmVyIiB8fCBvYmogPD0gMCkgewogICAgICBvYmogPSBERUZBVUxUX1VTRVJfVU5JVDsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInVzZXJVbml0Iiwgb2JqKTsKICB9CgogIGdldCB2aWV3KCkgewogICAgY29uc3QgewogICAgICBjcm9wQm94LAogICAgICBtZWRpYUJveAogICAgfSA9IHRoaXM7CiAgICBsZXQgdmlldzsKCiAgICBpZiAoY3JvcEJveCA9PT0gbWVkaWFCb3ggfHwgKDAsIF91dGlsLmlzQXJyYXlFcXVhbCkoY3JvcEJveCwgbWVkaWFCb3gpKSB7CiAgICAgIHZpZXcgPSBtZWRpYUJveDsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGJveCA9IF91dGlsLlV0aWwuaW50ZXJzZWN0KGNyb3BCb3gsIG1lZGlhQm94KTsKCiAgICAgIGlmIChib3ggJiYgYm94WzJdIC0gYm94WzBdICE9PSAwICYmIGJveFszXSAtIGJveFsxXSAhPT0gMCkgewogICAgICAgIHZpZXcgPSBib3g7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbXB0eSAvQ3JvcEJveCBhbmQgL01lZGlhQm94IGludGVyc2VjdGlvbi4iKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAidmlldyIsIHZpZXcgfHwgbWVkaWFCb3gpOwogIH0KCiAgZ2V0IHJvdGF0ZSgpIHsKICAgIGxldCByb3RhdGUgPSB0aGlzLl9nZXRJbmhlcml0YWJsZVByb3BlcnR5KCJSb3RhdGUiKSB8fCAwOwoKICAgIGlmIChyb3RhdGUgJSA5MCAhPT0gMCkgewogICAgICByb3RhdGUgPSAwOwogICAgfSBlbHNlIGlmIChyb3RhdGUgPj0gMzYwKSB7CiAgICAgIHJvdGF0ZSAlPSAzNjA7CiAgICB9IGVsc2UgaWYgKHJvdGF0ZSA8IDApIHsKICAgICAgcm90YXRlID0gKHJvdGF0ZSAlIDM2MCArIDM2MCkgJSAzNjA7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJyb3RhdGUiLCByb3RhdGUpOwogIH0KCiAgX29uU3ViU3RyZWFtRXJyb3IoaGFuZGxlciwgcmVhc29uLCBvYmpJZCkgewogICAgaWYgKHRoaXMuZXZhbHVhdG9yT3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckNvbnRlbnRTdWJTdHJlYW0KICAgICAgfSk7CiAgICAgICgwLCBfdXRpbC53YXJuKShgZ2V0Q29udGVudFN0cmVhbSAtIGlnbm9yaW5nIHN1Yi1zdHJlYW0gKCR7b2JqSWR9KTogIiR7cmVhc29ufSIuYCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aHJvdyByZWFzb247CiAgfQoKICBnZXRDb250ZW50U3RyZWFtKGhhbmRsZXIpIHsKICAgIHJldHVybiB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlKHRoaXMsICJjb250ZW50IikudGhlbihjb250ZW50ID0+IHsKICAgICAgaWYgKGNvbnRlbnQgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIHJldHVybiBjb250ZW50OwogICAgICB9CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShjb250ZW50KSkgewogICAgICAgIHJldHVybiBuZXcgX2RlY29kZV9zdHJlYW0uU3RyZWFtc1NlcXVlbmNlU3RyZWFtKGNvbnRlbnQsIHRoaXMuX29uU3ViU3RyZWFtRXJyb3IuYmluZCh0aGlzLCBoYW5kbGVyKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICB9KTsKICB9CgogIGdldCB4ZmFEYXRhKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFEYXRhIiwgdGhpcy54ZmFGYWN0b3J5ID8gewogICAgICBiYm94OiB0aGlzLnhmYUZhY3RvcnkuZ2V0Qm91bmRpbmdCb3godGhpcy5wYWdlSW5kZXgpCiAgICB9IDogbnVsbCk7CiAgfQoKICBhc3luYyBzYXZlTmV3QW5ub3RhdGlvbnMoaGFuZGxlciwgdGFzaywgYW5ub3RhdGlvbnMpIHsKICAgIGlmICh0aGlzLnhmYUZhY3RvcnkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJYRkE6IENhbm5vdCBzYXZlIG5ldyBhbm5vdGF0aW9ucy4iKTsKICAgIH0KCiAgICBjb25zdCBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaGFuZGxlciwKICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgaWRGYWN0b3J5OiB0aGlzLl9sb2NhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgfSk7CiAgICBjb25zdCBwYWdlRGljdCA9IHRoaXMucGFnZURpY3Q7CiAgICBjb25zdCBhbm5vdGF0aW9uc0FycmF5ID0gdGhpcy5hbm5vdGF0aW9ucy5zbGljZSgpOwogICAgY29uc3QgbmV3RGF0YSA9IGF3YWl0IF9hbm5vdGF0aW9uLkFubm90YXRpb25GYWN0b3J5LnNhdmVOZXdBbm5vdGF0aW9ucyhwYXJ0aWFsRXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9ucyk7CgogICAgZm9yIChjb25zdCB7CiAgICAgIHJlZgogICAgfSBvZiBuZXdEYXRhLmFubm90YXRpb25zKSB7CiAgICAgIGFubm90YXRpb25zQXJyYXkucHVzaChyZWYpOwogICAgfQoKICAgIGNvbnN0IHNhdmVkRGljdCA9IHBhZ2VEaWN0LmdldCgiQW5ub3RzIik7CiAgICBwYWdlRGljdC5zZXQoIkFubm90cyIsIGFubm90YXRpb25zQXJyYXkpOwogICAgY29uc3QgYnVmZmVyID0gW107CiAgICBsZXQgdHJhbnNmb3JtID0gbnVsbDsKCiAgICBpZiAodGhpcy54cmVmLmVuY3J5cHQpIHsKICAgICAgdHJhbnNmb3JtID0gdGhpcy54cmVmLmVuY3J5cHQuY3JlYXRlQ2lwaGVyVHJhbnNmb3JtKHRoaXMucmVmLm51bSwgdGhpcy5yZWYuZ2VuKTsKICAgIH0KCiAgICAoMCwgX3dyaXRlci53cml0ZU9iamVjdCkodGhpcy5yZWYsIHBhZ2VEaWN0LCBidWZmZXIsIHRyYW5zZm9ybSk7CgogICAgaWYgKHNhdmVkRGljdCkgewogICAgICBwYWdlRGljdC5zZXQoIkFubm90cyIsIHNhdmVkRGljdCk7CiAgICB9CgogICAgY29uc3Qgb2JqZWN0cyA9IG5ld0RhdGEuZGVwZW5kZW5jaWVzOwogICAgb2JqZWN0cy5wdXNoKHsKICAgICAgcmVmOiB0aGlzLnJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpCiAgICB9LCAuLi5uZXdEYXRhLmFubm90YXRpb25zKTsKICAgIHJldHVybiBvYmplY3RzOwogIH0KCiAgc2F2ZShoYW5kbGVyLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3QgcGFydGlhbEV2YWx1YXRvciA9IG5ldyBfZXZhbHVhdG9yLlBhcnRpYWxFdmFsdWF0b3IoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGhhbmRsZXIsCiAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXgsCiAgICAgIGlkRmFjdG9yeTogdGhpcy5fbG9jYWxJZEZhY3RvcnksCiAgICAgIGZvbnRDYWNoZTogdGhpcy5mb250Q2FjaGUsCiAgICAgIGJ1aWx0SW5DTWFwQ2FjaGU6IHRoaXMuYnVpbHRJbkNNYXBDYWNoZSwKICAgICAgc3RhbmRhcmRGb250RGF0YUNhY2hlOiB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZSwKICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogdGhpcy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICBvcHRpb25zOiB0aGlzLmV2YWx1YXRvck9wdGlvbnMKICAgIH0pOwogICAgcmV0dXJuIHRoaXMuX3BhcnNlZEFubm90YXRpb25zLnRoZW4oZnVuY3Rpb24gKGFubm90YXRpb25zKSB7CiAgICAgIGNvbnN0IG5ld1JlZnNQcm9taXNlcyA9IFtdOwoKICAgICAgZm9yIChjb25zdCBhbm5vdGF0aW9uIG9mIGFubm90YXRpb25zKSB7CiAgICAgICAgaWYgKCFhbm5vdGF0aW9uLm11c3RCZVByaW50ZWQoYW5ub3RhdGlvblN0b3JhZ2UpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIG5ld1JlZnNQcm9taXNlcy5wdXNoKGFubm90YXRpb24uc2F2ZShwYXJ0aWFsRXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJzYXZlIC0gaWdub3JpbmcgYW5ub3RhdGlvbiBkYXRhIGR1cmluZyAiICsgYCIke3Rhc2submFtZX0iIHRhc2s6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5hbGwobmV3UmVmc1Byb21pc2VzKS50aGVuKGZ1bmN0aW9uIChuZXdSZWZzKSB7CiAgICAgICAgcmV0dXJuIG5ld1JlZnMuZmlsdGVyKG5ld1JlZiA9PiAhIW5ld1JlZik7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBsb2FkUmVzb3VyY2VzKGtleXMpIHsKICAgIGlmICghdGhpcy5yZXNvdXJjZXNQcm9taXNlKSB7CiAgICAgIHRoaXMucmVzb3VyY2VzUHJvbWlzZSA9IHRoaXMucGRmTWFuYWdlci5lbnN1cmUodGhpcywgInJlc291cmNlcyIpOwogICAgfQoKICAgIHJldHVybiB0aGlzLnJlc291cmNlc1Byb21pc2UudGhlbigoKSA9PiB7CiAgICAgIGNvbnN0IG9iamVjdExvYWRlciA9IG5ldyBfb2JqZWN0X2xvYWRlci5PYmplY3RMb2FkZXIodGhpcy5yZXNvdXJjZXMsIGtleXMsIHRoaXMueHJlZik7CiAgICAgIHJldHVybiBvYmplY3RMb2FkZXIubG9hZCgpOwogICAgfSk7CiAgfQoKICBnZXRPcGVyYXRvckxpc3QoewogICAgaGFuZGxlciwKICAgIHNpbmssCiAgICB0YXNrLAogICAgaW50ZW50LAogICAgY2FjaGVLZXksCiAgICBhbm5vdGF0aW9uU3RvcmFnZSA9IG51bGwKICB9KSB7CiAgICBjb25zdCBjb250ZW50U3RyZWFtUHJvbWlzZSA9IHRoaXMuZ2V0Q29udGVudFN0cmVhbShoYW5kbGVyKTsKICAgIGNvbnN0IHJlc291cmNlc1Byb21pc2UgPSB0aGlzLmxvYWRSZXNvdXJjZXMoWyJDb2xvclNwYWNlIiwgIkV4dEdTdGF0ZSIsICJGb250IiwgIlBhdHRlcm4iLCAiUHJvcGVydGllcyIsICJTaGFkaW5nIiwgIlhPYmplY3QiXSk7CiAgICBjb25zdCBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgaGFuZGxlciwKICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgaWRGYWN0b3J5OiB0aGlzLl9sb2NhbElkRmFjdG9yeSwKICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgfSk7CiAgICBjb25zdCBuZXdBbm5vdGF0aW9uc0J5UGFnZSA9ICF0aGlzLnhmYUZhY3RvcnkgPyAoMCwgX2NvcmVfdXRpbHMuZ2V0TmV3QW5ub3RhdGlvbnNNYXApKGFubm90YXRpb25TdG9yYWdlKSA6IG51bGw7CiAgICBsZXQgbmV3QW5ub3RhdGlvbnNQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKG51bGwpOwoKICAgIGlmIChuZXdBbm5vdGF0aW9uc0J5UGFnZSkgewogICAgICBjb25zdCBuZXdBbm5vdGF0aW9ucyA9IG5ld0Fubm90YXRpb25zQnlQYWdlLmdldCh0aGlzLnBhZ2VJbmRleCk7CgogICAgICBpZiAobmV3QW5ub3RhdGlvbnMpIHsKICAgICAgICBuZXdBbm5vdGF0aW9uc1Byb21pc2UgPSBfYW5ub3RhdGlvbi5Bbm5vdGF0aW9uRmFjdG9yeS5wcmludE5ld0Fubm90YXRpb25zKHBhcnRpYWxFdmFsdWF0b3IsIHRhc2ssIG5ld0Fubm90YXRpb25zKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGRhdGFQcm9taXNlcyA9IFByb21pc2UuYWxsKFtjb250ZW50U3RyZWFtUHJvbWlzZSwgcmVzb3VyY2VzUHJvbWlzZV0pOwogICAgY29uc3QgcGFnZUxpc3RQcm9taXNlID0gZGF0YVByb21pc2VzLnRoZW4oKFtjb250ZW50U3RyZWFtXSkgPT4gewogICAgICBjb25zdCBvcExpc3QgPSBuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KGludGVudCwgc2luayk7CiAgICAgIGhhbmRsZXIuc2VuZCgiU3RhcnRSZW5kZXJQYWdlIiwgewogICAgICAgIHRyYW5zcGFyZW5jeTogcGFydGlhbEV2YWx1YXRvci5oYXNCbGVuZE1vZGVzKHRoaXMucmVzb3VyY2VzLCB0aGlzLm5vbkJsZW5kTW9kZXNTZXQpLAogICAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXgsCiAgICAgICAgY2FjaGVLZXkKICAgICAgfSk7CiAgICAgIHJldHVybiBwYXJ0aWFsRXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgICAgc3RyZWFtOiBjb250ZW50U3RyZWFtLAogICAgICAgIHRhc2ssCiAgICAgICAgcmVzb3VyY2VzOiB0aGlzLnJlc291cmNlcywKICAgICAgICBvcGVyYXRvckxpc3Q6IG9wTGlzdAogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gb3BMaXN0OwogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIFByb21pc2UuYWxsKFtwYWdlTGlzdFByb21pc2UsIHRoaXMuX3BhcnNlZEFubm90YXRpb25zLCBuZXdBbm5vdGF0aW9uc1Byb21pc2VdKS50aGVuKGZ1bmN0aW9uIChbcGFnZU9wTGlzdCwgYW5ub3RhdGlvbnMsIG5ld0Fubm90YXRpb25zXSkgewogICAgICBpZiAobmV3QW5ub3RhdGlvbnMpIHsKICAgICAgICBhbm5vdGF0aW9ucyA9IGFubm90YXRpb25zLmNvbmNhdChuZXdBbm5vdGF0aW9ucyk7CiAgICAgIH0KCiAgICAgIGlmIChhbm5vdGF0aW9ucy5sZW5ndGggPT09IDAgfHwgaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5BTk5PVEFUSU9OU19ESVNBQkxFKSB7CiAgICAgICAgcGFnZU9wTGlzdC5mbHVzaCh0cnVlKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbGVuZ3RoOiBwYWdlT3BMaXN0LnRvdGFsTGVuZ3RoCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgY29uc3QgcmVuZGVyRm9ybXMgPSAhIShpbnRlbnQgJiBfdXRpbC5SZW5kZXJpbmdJbnRlbnRGbGFnLkFOTk9UQVRJT05TX0ZPUk1TKSwKICAgICAgICAgICAgaW50ZW50QW55ID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5BTlkpLAogICAgICAgICAgICBpbnRlbnREaXNwbGF5ID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5ESVNQTEFZKSwKICAgICAgICAgICAgaW50ZW50UHJpbnQgPSAhIShpbnRlbnQgJiBfdXRpbC5SZW5kZXJpbmdJbnRlbnRGbGFnLlBSSU5UKTsKICAgICAgY29uc3Qgb3BMaXN0UHJvbWlzZXMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgYW5ub3RhdGlvbiBvZiBhbm5vdGF0aW9ucykgewogICAgICAgIGlmIChpbnRlbnRBbnkgfHwgaW50ZW50RGlzcGxheSAmJiBhbm5vdGF0aW9uLm11c3RCZVZpZXdlZChhbm5vdGF0aW9uU3RvcmFnZSkgfHwgaW50ZW50UHJpbnQgJiYgYW5ub3RhdGlvbi5tdXN0QmVQcmludGVkKGFubm90YXRpb25TdG9yYWdlKSkgewogICAgICAgICAgb3BMaXN0UHJvbWlzZXMucHVzaChhbm5vdGF0aW9uLmdldE9wZXJhdG9yTGlzdChwYXJ0aWFsRXZhbHVhdG9yLCB0YXNrLCBpbnRlbnQsIHJlbmRlckZvcm1zLCBhbm5vdGF0aW9uU3RvcmFnZSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoImdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIGFubm90YXRpb24gZGF0YSBkdXJpbmcgIiArIGAiJHt0YXNrLm5hbWV9IiB0YXNrOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5hbGwob3BMaXN0UHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKG9wTGlzdHMpIHsKICAgICAgICBsZXQgZm9ybSA9IGZhbHNlLAogICAgICAgICAgICBjYW52YXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChjb25zdCB7CiAgICAgICAgICBvcExpc3QsCiAgICAgICAgICBzZXBhcmF0ZUZvcm0sCiAgICAgICAgICBzZXBhcmF0ZUNhbnZhcwogICAgICAgIH0gb2Ygb3BMaXN0cykgewogICAgICAgICAgcGFnZU9wTGlzdC5hZGRPcExpc3Qob3BMaXN0KTsKCiAgICAgICAgICBpZiAoc2VwYXJhdGVGb3JtKSB7CiAgICAgICAgICAgIGZvcm0gPSBzZXBhcmF0ZUZvcm07CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHNlcGFyYXRlQ2FudmFzKSB7CiAgICAgICAgICAgIGNhbnZhcyA9IHNlcGFyYXRlQ2FudmFzOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcGFnZU9wTGlzdC5mbHVzaCh0cnVlLCB7CiAgICAgICAgICBmb3JtLAogICAgICAgICAgY2FudmFzCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGxlbmd0aDogcGFnZU9wTGlzdC50b3RhbExlbmd0aAogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBleHRyYWN0VGV4dENvbnRlbnQoewogICAgaGFuZGxlciwKICAgIHRhc2ssCiAgICBpbmNsdWRlTWFya2VkQ29udGVudCwKICAgIHNpbmssCiAgICBjb21iaW5lVGV4dEl0ZW1zCiAgfSkgewogICAgY29uc3QgY29udGVudFN0cmVhbVByb21pc2UgPSB0aGlzLmdldENvbnRlbnRTdHJlYW0oaGFuZGxlcik7CiAgICBjb25zdCByZXNvdXJjZXNQcm9taXNlID0gdGhpcy5sb2FkUmVzb3VyY2VzKFsiRXh0R1N0YXRlIiwgIkZvbnQiLCAiUHJvcGVydGllcyIsICJYT2JqZWN0Il0pOwogICAgY29uc3QgZGF0YVByb21pc2VzID0gUHJvbWlzZS5hbGwoW2NvbnRlbnRTdHJlYW1Qcm9taXNlLCByZXNvdXJjZXNQcm9taXNlXSk7CiAgICByZXR1cm4gZGF0YVByb21pc2VzLnRoZW4oKFtjb250ZW50U3RyZWFtXSkgPT4gewogICAgICBjb25zdCBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICAgIGhhbmRsZXIsCiAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgICBpZEZhY3Rvcnk6IHRoaXMuX2xvY2FsSWRGYWN0b3J5LAogICAgICAgIGZvbnRDYWNoZTogdGhpcy5mb250Q2FjaGUsCiAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZTogdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogdGhpcy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgICB9KTsKICAgICAgcmV0dXJuIHBhcnRpYWxFdmFsdWF0b3IuZ2V0VGV4dENvbnRlbnQoewogICAgICAgIHN0cmVhbTogY29udGVudFN0cmVhbSwKICAgICAgICB0YXNrLAogICAgICAgIHJlc291cmNlczogdGhpcy5yZXNvdXJjZXMsCiAgICAgICAgaW5jbHVkZU1hcmtlZENvbnRlbnQsCiAgICAgICAgY29tYmluZVRleHRJdGVtcywKICAgICAgICBzaW5rLAogICAgICAgIHZpZXdCb3g6IHRoaXMudmlldwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgYXN5bmMgZ2V0U3RydWN0VHJlZSgpIHsKICAgIGNvbnN0IHN0cnVjdFRyZWVSb290ID0gYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInN0cnVjdFRyZWVSb290Iik7CgogICAgaWYgKCFzdHJ1Y3RUcmVlUm9vdCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdHJ1Y3RUcmVlID0gYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZSh0aGlzLCAiX3BhcnNlU3RydWN0VHJlZSIsIFtzdHJ1Y3RUcmVlUm9vdF0pOwogICAgcmV0dXJuIHN0cnVjdFRyZWUuc2VyaWFsaXphYmxlOwogIH0KCiAgX3BhcnNlU3RydWN0VHJlZShzdHJ1Y3RUcmVlUm9vdCkgewogICAgY29uc3QgdHJlZSA9IG5ldyBfc3RydWN0X3RyZWUuU3RydWN0VHJlZVBhZ2Uoc3RydWN0VHJlZVJvb3QsIHRoaXMucGFnZURpY3QpOwogICAgdHJlZS5wYXJzZSgpOwogICAgcmV0dXJuIHRyZWU7CiAgfQoKICBhc3luYyBnZXRBbm5vdGF0aW9uc0RhdGEoaGFuZGxlciwgdGFzaywgaW50ZW50KSB7CiAgICBjb25zdCBhbm5vdGF0aW9ucyA9IGF3YWl0IHRoaXMuX3BhcnNlZEFubm90YXRpb25zOwoKICAgIGlmIChhbm5vdGF0aW9ucy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIFtdOwogICAgfQoKICAgIGNvbnN0IHRleHRDb250ZW50UHJvbWlzZXMgPSBbXTsKICAgIGNvbnN0IGFubm90YXRpb25zRGF0YSA9IFtdOwogICAgbGV0IHBhcnRpYWxFdmFsdWF0b3I7CiAgICBjb25zdCBpbnRlbnRBbnkgPSAhIShpbnRlbnQgJiBfdXRpbC5SZW5kZXJpbmdJbnRlbnRGbGFnLkFOWSksCiAgICAgICAgICBpbnRlbnREaXNwbGF5ID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5ESVNQTEFZKSwKICAgICAgICAgIGludGVudFByaW50ID0gISEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5QUklOVCk7CgogICAgZm9yIChjb25zdCBhbm5vdGF0aW9uIG9mIGFubm90YXRpb25zKSB7CiAgICAgIGNvbnN0IGlzVmlzaWJsZSA9IGludGVudEFueSB8fCBpbnRlbnREaXNwbGF5ICYmIGFubm90YXRpb24udmlld2FibGU7CgogICAgICBpZiAoaXNWaXNpYmxlIHx8IGludGVudFByaW50ICYmIGFubm90YXRpb24ucHJpbnRhYmxlKSB7CiAgICAgICAgYW5ub3RhdGlvbnNEYXRhLnB1c2goYW5ub3RhdGlvbi5kYXRhKTsKICAgICAgfQoKICAgICAgaWYgKGFubm90YXRpb24uaGFzVGV4dENvbnRlbnQgJiYgaXNWaXNpYmxlKSB7CiAgICAgICAgaWYgKCFwYXJ0aWFsRXZhbHVhdG9yKSB7CiAgICAgICAgICBwYXJ0aWFsRXZhbHVhdG9yID0gbmV3IF9ldmFsdWF0b3IuUGFydGlhbEV2YWx1YXRvcih7CiAgICAgICAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgICAgICAgaGFuZGxlciwKICAgICAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleCwKICAgICAgICAgICAgaWRGYWN0b3J5OiB0aGlzLl9sb2NhbElkRmFjdG9yeSwKICAgICAgICAgICAgZm9udENhY2hlOiB0aGlzLmZvbnRDYWNoZSwKICAgICAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogdGhpcy5idWlsdEluQ01hcENhY2hlLAogICAgICAgICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICAgICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuZXZhbHVhdG9yT3B0aW9ucwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0ZXh0Q29udGVudFByb21pc2VzLnB1c2goYW5ub3RhdGlvbi5leHRyYWN0VGV4dENvbnRlbnQocGFydGlhbEV2YWx1YXRvciwgdGFzaywgdGhpcy52aWV3KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGdldEFubm90YXRpb25zRGF0YSAtIGlnbm9yaW5nIHRleHRDb250ZW50IGR1cmluZyAiJHt0YXNrLm5hbWV9IiB0YXNrOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0KCiAgICBhd2FpdCBQcm9taXNlLmFsbCh0ZXh0Q29udGVudFByb21pc2VzKTsKICAgIHJldHVybiBhbm5vdGF0aW9uc0RhdGE7CiAgfQoKICBnZXQgYW5ub3RhdGlvbnMoKSB7CiAgICBjb25zdCBhbm5vdHMgPSB0aGlzLl9nZXRJbmhlcml0YWJsZVByb3BlcnR5KCJBbm5vdHMiKTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImFubm90YXRpb25zIiwgQXJyYXkuaXNBcnJheShhbm5vdHMpID8gYW5ub3RzIDogW10pOwogIH0KCiAgZ2V0IF9wYXJzZWRBbm5vdGF0aW9ucygpIHsKICAgIGNvbnN0IHBhcnNlZEFubm90YXRpb25zID0gdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZSh0aGlzLCAiYW5ub3RhdGlvbnMiKS50aGVuKCgpID0+IHsKICAgICAgY29uc3QgYW5ub3RhdGlvblByb21pc2VzID0gW107CgogICAgICBmb3IgKGNvbnN0IGFubm90YXRpb25SZWYgb2YgdGhpcy5hbm5vdGF0aW9ucykgewogICAgICAgIGFubm90YXRpb25Qcm9taXNlcy5wdXNoKF9hbm5vdGF0aW9uLkFubm90YXRpb25GYWN0b3J5LmNyZWF0ZSh0aGlzLnhyZWYsIGFubm90YXRpb25SZWYsIHRoaXMucGRmTWFuYWdlciwgdGhpcy5fbG9jYWxJZEZhY3RvcnksIGZhbHNlKS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYF9wYXJzZWRBbm5vdGF0aW9uczogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbChhbm5vdGF0aW9uUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKGFubm90YXRpb25zKSB7CiAgICAgICAgaWYgKGFubm90YXRpb25zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIGFubm90YXRpb25zOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc29ydGVkQW5ub3RhdGlvbnMgPSBbXTsKICAgICAgICBsZXQgcG9wdXBBbm5vdGF0aW9uczsKCiAgICAgICAgZm9yIChjb25zdCBhbm5vdGF0aW9uIG9mIGFubm90YXRpb25zKSB7CiAgICAgICAgICBpZiAoIWFubm90YXRpb24pIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGFubm90YXRpb24gaW5zdGFuY2VvZiBfYW5ub3RhdGlvbi5Qb3B1cEFubm90YXRpb24pIHsKICAgICAgICAgICAgaWYgKCFwb3B1cEFubm90YXRpb25zKSB7CiAgICAgICAgICAgICAgcG9wdXBBbm5vdGF0aW9ucyA9IFtdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwb3B1cEFubm90YXRpb25zLnB1c2goYW5ub3RhdGlvbik7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHNvcnRlZEFubm90YXRpb25zLnB1c2goYW5ub3RhdGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAocG9wdXBBbm5vdGF0aW9ucykgewogICAgICAgICAgc29ydGVkQW5ub3RhdGlvbnMucHVzaCguLi5wb3B1cEFubm90YXRpb25zKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzb3J0ZWRBbm5vdGF0aW9uczsKICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiX3BhcnNlZEFubm90YXRpb25zIiwgcGFyc2VkQW5ub3RhdGlvbnMpOwogIH0KCiAgZ2V0IGpzQWN0aW9ucygpIHsKICAgIGNvbnN0IGFjdGlvbnMgPSAoMCwgX2NvcmVfdXRpbHMuY29sbGVjdEFjdGlvbnMpKHRoaXMueHJlZiwgdGhpcy5wYWdlRGljdCwgX3V0aWwuUGFnZUFjdGlvbkV2ZW50VHlwZSk7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImpzQWN0aW9ucyIsIGFjdGlvbnMpOwogIH0KCn0KCmV4cG9ydHMuUGFnZSA9IFBhZ2U7CmNvbnN0IFBERl9IRUFERVJfU0lHTkFUVVJFID0gbmV3IFVpbnQ4QXJyYXkoWzB4MjUsIDB4NTAsIDB4NDQsIDB4NDYsIDB4MmRdKTsKY29uc3QgU1RBUlRYUkVGX1NJR05BVFVSRSA9IG5ldyBVaW50OEFycmF5KFsweDczLCAweDc0LCAweDYxLCAweDcyLCAweDc0LCAweDc4LCAweDcyLCAweDY1LCAweDY2XSk7CmNvbnN0IEVORE9CSl9TSUdOQVRVUkUgPSBuZXcgVWludDhBcnJheShbMHg2NSwgMHg2ZSwgMHg2NCwgMHg2ZiwgMHg2MiwgMHg2YV0pOwpjb25zdCBGSU5HRVJQUklOVF9GSVJTVF9CWVRFUyA9IDEwMjQ7CmNvbnN0IEVNUFRZX0ZJTkdFUlBSSU5UID0gIlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiOwpjb25zdCBQREZfSEVBREVSX1ZFUlNJT05fUkVHRVhQID0gL15bMS05XVwuXGQkLzsKCmZ1bmN0aW9uIGZpbmQoc3RyZWFtLCBzaWduYXR1cmUsIGxpbWl0ID0gMTAyNCwgYmFja3dhcmRzID0gZmFsc2UpIHsKICBjb25zdCBzaWduYXR1cmVMZW5ndGggPSBzaWduYXR1cmUubGVuZ3RoOwogIGNvbnN0IHNjYW5CeXRlcyA9IHN0cmVhbS5wZWVrQnl0ZXMobGltaXQpOwogIGNvbnN0IHNjYW5MZW5ndGggPSBzY2FuQnl0ZXMubGVuZ3RoIC0gc2lnbmF0dXJlTGVuZ3RoOwoKICBpZiAoc2Nhbkxlbmd0aCA8PSAwKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAoYmFja3dhcmRzKSB7CiAgICBjb25zdCBzaWduYXR1cmVFbmQgPSBzaWduYXR1cmVMZW5ndGggLSAxOwogICAgbGV0IHBvcyA9IHNjYW5CeXRlcy5sZW5ndGggLSAxOwoKICAgIHdoaWxlIChwb3MgPj0gc2lnbmF0dXJlRW5kKSB7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIHdoaWxlIChqIDwgc2lnbmF0dXJlTGVuZ3RoICYmIHNjYW5CeXRlc1twb3MgLSBqXSA9PT0gc2lnbmF0dXJlW3NpZ25hdHVyZUVuZCAtIGpdKSB7CiAgICAgICAgaisrOwogICAgICB9CgogICAgICBpZiAoaiA+PSBzaWduYXR1cmVMZW5ndGgpIHsKICAgICAgICBzdHJlYW0ucG9zICs9IHBvcyAtIHNpZ25hdHVyZUVuZDsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcG9zLS07CiAgICB9CiAgfSBlbHNlIHsKICAgIGxldCBwb3MgPSAwOwoKICAgIHdoaWxlIChwb3MgPD0gc2Nhbkxlbmd0aCkgewogICAgICBsZXQgaiA9IDA7CgogICAgICB3aGlsZSAoaiA8IHNpZ25hdHVyZUxlbmd0aCAmJiBzY2FuQnl0ZXNbcG9zICsgal0gPT09IHNpZ25hdHVyZVtqXSkgewogICAgICAgIGorKzsKICAgICAgfQoKICAgICAgaWYgKGogPj0gc2lnbmF0dXJlTGVuZ3RoKSB7CiAgICAgICAgc3RyZWFtLnBvcyArPSBwb3M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHBvcysrOwogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgpjbGFzcyBQREZEb2N1bWVudCB7CiAgY29uc3RydWN0b3IocGRmTWFuYWdlciwgc3RyZWFtKSB7CiAgICBpZiAoc3RyZWFtLmxlbmd0aCA8PSAwKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5JbnZhbGlkUERGRXhjZXB0aW9uKCJUaGUgUERGIGZpbGUgaXMgZW1wdHksIGkuZS4gaXRzIHNpemUgaXMgemVybyBieXRlcy4iKTsKICAgIH0KCiAgICB0aGlzLnBkZk1hbmFnZXIgPSBwZGZNYW5hZ2VyOwogICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07CiAgICB0aGlzLnhyZWYgPSBuZXcgX3hyZWYuWFJlZihzdHJlYW0sIHBkZk1hbmFnZXIpOwogICAgdGhpcy5fcGFnZVByb21pc2VzID0gbmV3IE1hcCgpOwogICAgdGhpcy5fdmVyc2lvbiA9IG51bGw7CiAgICBjb25zdCBpZENvdW50ZXJzID0gewogICAgICBmb250OiAwCiAgICB9OwogICAgdGhpcy5fZ2xvYmFsSWRGYWN0b3J5ID0gY2xhc3MgewogICAgICBzdGF0aWMgZ2V0RG9jSWQoKSB7CiAgICAgICAgcmV0dXJuIGBnXyR7cGRmTWFuYWdlci5kb2NJZH1gOwogICAgICB9CgogICAgICBzdGF0aWMgY3JlYXRlRm9udElkKCkgewogICAgICAgIHJldHVybiBgZiR7KytpZENvdW50ZXJzLmZvbnR9YDsKICAgICAgfQoKICAgICAgc3RhdGljIGNyZWF0ZU9iaklkKCkgewogICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgY3JlYXRlT2JqSWRgIGNhbGxlZC4iKTsKICAgICAgfQoKICAgICAgc3RhdGljIGdldFBhZ2VPYmpJZCgpIHsKICAgICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGdldFBhZ2VPYmpJZGAgY2FsbGVkLiIpOwogICAgICB9CgogICAgfTsKICB9CgogIHBhcnNlKHJlY292ZXJ5TW9kZSkgewogICAgdGhpcy54cmVmLnBhcnNlKHJlY292ZXJ5TW9kZSk7CiAgICB0aGlzLmNhdGFsb2cgPSBuZXcgX2NhdGFsb2cuQ2F0YWxvZyh0aGlzLnBkZk1hbmFnZXIsIHRoaXMueHJlZik7CgogICAgaWYgKHRoaXMuY2F0YWxvZy52ZXJzaW9uKSB7CiAgICAgIHRoaXMuX3ZlcnNpb24gPSB0aGlzLmNhdGFsb2cudmVyc2lvbjsKICAgIH0KICB9CgogIGdldCBsaW5lYXJpemF0aW9uKCkgewogICAgbGV0IGxpbmVhcml6YXRpb24gPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIGxpbmVhcml6YXRpb24gPSBfcGFyc2VyLkxpbmVhcml6YXRpb24uY3JlYXRlKHRoaXMuc3RyZWFtKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKShlcnIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibGluZWFyaXphdGlvbiIsIGxpbmVhcml6YXRpb24pOwogIH0KCiAgZ2V0IHN0YXJ0WFJlZigpIHsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgbGV0IHN0YXJ0WFJlZiA9IDA7CgogICAgaWYgKHRoaXMubGluZWFyaXphdGlvbikgewogICAgICBzdHJlYW0ucmVzZXQoKTsKCiAgICAgIGlmIChmaW5kKHN0cmVhbSwgRU5ET0JKX1NJR05BVFVSRSkpIHsKICAgICAgICBzdGFydFhSZWYgPSBzdHJlYW0ucG9zICsgNiAtIHN0cmVhbS5zdGFydDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29uc3Qgc3RlcCA9IDEwMjQ7CiAgICAgIGNvbnN0IHN0YXJ0WFJlZkxlbmd0aCA9IFNUQVJUWFJFRl9TSUdOQVRVUkUubGVuZ3RoOwogICAgICBsZXQgZm91bmQgPSBmYWxzZSwKICAgICAgICAgIHBvcyA9IHN0cmVhbS5lbmQ7CgogICAgICB3aGlsZSAoIWZvdW5kICYmIHBvcyA+IDApIHsKICAgICAgICBwb3MgLT0gc3RlcCAtIHN0YXJ0WFJlZkxlbmd0aDsKCiAgICAgICAgaWYgKHBvcyA8IDApIHsKICAgICAgICAgIHBvcyA9IDA7CiAgICAgICAgfQoKICAgICAgICBzdHJlYW0ucG9zID0gcG9zOwogICAgICAgIGZvdW5kID0gZmluZChzdHJlYW0sIFNUQVJUWFJFRl9TSUdOQVRVUkUsIHN0ZXAsIHRydWUpOwogICAgICB9CgogICAgICBpZiAoZm91bmQpIHsKICAgICAgICBzdHJlYW0uc2tpcCg5KTsKICAgICAgICBsZXQgY2g7CgogICAgICAgIGRvIHsKICAgICAgICAgIGNoID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICB9IHdoaWxlICgoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpOwoKICAgICAgICBsZXQgc3RyID0gIiI7CgogICAgICAgIHdoaWxlIChjaCA+PSAweDIwICYmIGNoIDw9IDB4MzkpIHsKICAgICAgICAgIHN0ciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgICAgIGNoID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICB9CgogICAgICAgIHN0YXJ0WFJlZiA9IHBhcnNlSW50KHN0ciwgMTApOwoKICAgICAgICBpZiAoaXNOYU4oc3RhcnRYUmVmKSkgewogICAgICAgICAgc3RhcnRYUmVmID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInN0YXJ0WFJlZiIsIHN0YXJ0WFJlZik7CiAgfQoKICBjaGVja0hlYWRlcigpIHsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgc3RyZWFtLnJlc2V0KCk7CgogICAgaWYgKCFmaW5kKHN0cmVhbSwgUERGX0hFQURFUl9TSUdOQVRVUkUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzdHJlYW0ubW92ZVN0YXJ0KCk7CiAgICBjb25zdCBNQVhfUERGX1ZFUlNJT05fTEVOR1RIID0gMTI7CiAgICBsZXQgdmVyc2lvbiA9ICIiLAogICAgICAgIGNoOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSA+IDB4MjApIHsKICAgICAgaWYgKHZlcnNpb24ubGVuZ3RoID49IE1BWF9QREZfVkVSU0lPTl9MRU5HVEgpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdmVyc2lvbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgIH0KCiAgICBpZiAoIXRoaXMuX3ZlcnNpb24pIHsKICAgICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb24uc3Vic3RyaW5nKDUpOwogICAgfQogIH0KCiAgcGFyc2VTdGFydFhSZWYoKSB7CiAgICB0aGlzLnhyZWYuc2V0U3RhcnRYUmVmKHRoaXMuc3RhcnRYUmVmKTsKICB9CgogIGdldCBudW1QYWdlcygpIHsKICAgIGxldCBudW0gPSAwOwoKICAgIGlmICh0aGlzLmNhdGFsb2cuaGFzQWN0dWFsTnVtUGFnZXMpIHsKICAgICAgbnVtID0gdGhpcy5jYXRhbG9nLm51bVBhZ2VzOwogICAgfSBlbHNlIGlmICh0aGlzLnhmYUZhY3RvcnkpIHsKICAgICAgbnVtID0gdGhpcy54ZmFGYWN0b3J5LmdldE51bVBhZ2VzKCk7CiAgICB9IGVsc2UgaWYgKHRoaXMubGluZWFyaXphdGlvbikgewogICAgICBudW0gPSB0aGlzLmxpbmVhcml6YXRpb24ubnVtUGFnZXM7CiAgICB9IGVsc2UgewogICAgICBudW0gPSB0aGlzLmNhdGFsb2cubnVtUGFnZXM7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJudW1QYWdlcyIsIG51bSk7CiAgfQoKICBfaGFzT25seURvY3VtZW50U2lnbmF0dXJlcyhmaWVsZHMsIHJlY3Vyc2lvbkRlcHRoID0gMCkgewogICAgY29uc3QgUkVDVVJTSU9OX0xJTUlUID0gMTA7CgogICAgaWYgKCFBcnJheS5pc0FycmF5KGZpZWxkcykpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiBmaWVsZHMuZXZlcnkoZmllbGQgPT4gewogICAgICBmaWVsZCA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGZpZWxkKTsKCiAgICAgIGlmICghKGZpZWxkIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChmaWVsZC5oYXMoIktpZHMiKSkgewogICAgICAgIGlmICgrK3JlY3Vyc2lvbkRlcHRoID4gUkVDVVJTSU9OX0xJTUlUKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIl9oYXNPbmx5RG9jdW1lbnRTaWduYXR1cmVzOiBtYXhpbXVtIHJlY3Vyc2lvbiBkZXB0aCByZWFjaGVkIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5faGFzT25seURvY3VtZW50U2lnbmF0dXJlcyhmaWVsZC5nZXQoIktpZHMiKSwgcmVjdXJzaW9uRGVwdGgpOwogICAgICB9CgogICAgICBjb25zdCBpc1NpZ25hdHVyZSA9ICgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZpZWxkLmdldCgiRlQiKSwgIlNpZyIpOwogICAgICBjb25zdCByZWN0YW5nbGUgPSBmaWVsZC5nZXQoIlJlY3QiKTsKICAgICAgY29uc3QgaXNJbnZpc2libGUgPSBBcnJheS5pc0FycmF5KHJlY3RhbmdsZSkgJiYgcmVjdGFuZ2xlLmV2ZXJ5KHZhbHVlID0+IHZhbHVlID09PSAwKTsKICAgICAgcmV0dXJuIGlzU2lnbmF0dXJlICYmIGlzSW52aXNpYmxlOwogICAgfSk7CiAgfQoKICBnZXQgX3hmYVN0cmVhbXMoKSB7CiAgICBjb25zdCBhY3JvRm9ybSA9IHRoaXMuY2F0YWxvZy5hY3JvRm9ybTsKCiAgICBpZiAoIWFjcm9Gb3JtKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHhmYSA9IGFjcm9Gb3JtLmdldCgiWEZBIik7CiAgICBjb25zdCBlbnRyaWVzID0gewogICAgICAieGRwOnhkcCI6ICIiLAogICAgICB0ZW1wbGF0ZTogIiIsCiAgICAgIGRhdGFzZXRzOiAiIiwKICAgICAgY29uZmlnOiAiIiwKICAgICAgY29ubmVjdGlvblNldDogIiIsCiAgICAgIGxvY2FsZVNldDogIiIsCiAgICAgIHN0eWxlc2hlZXQ6ICIiLAogICAgICAiL3hkcDp4ZHAiOiAiIgogICAgfTsKCiAgICBpZiAoeGZhIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gJiYgIXhmYS5pc0VtcHR5KSB7CiAgICAgIGVudHJpZXNbInhkcDp4ZHAiXSA9IHhmYTsKICAgICAgcmV0dXJuIGVudHJpZXM7CiAgICB9CgogICAgaWYgKCFBcnJheS5pc0FycmF5KHhmYSkgfHwgeGZhLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB4ZmEubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikgewogICAgICBsZXQgbmFtZTsKCiAgICAgIGlmIChpID09PSAwKSB7CiAgICAgICAgbmFtZSA9ICJ4ZHA6eGRwIjsKICAgICAgfSBlbHNlIGlmIChpID09PSBpaSAtIDIpIHsKICAgICAgICBuYW1lID0gIi94ZHA6eGRwIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBuYW1lID0geGZhW2ldOwogICAgICB9CgogICAgICBpZiAoIWVudHJpZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHRoaXMueHJlZi5mZXRjaElmUmVmKHhmYVtpICsgMV0pOwoKICAgICAgaWYgKCEoZGF0YSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB8fCBkYXRhLmlzRW1wdHkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZW50cmllc1tuYW1lXSA9IGRhdGE7CiAgICB9CgogICAgcmV0dXJuIGVudHJpZXM7CiAgfQoKICBnZXQgeGZhRGF0YXNldHMoKSB7CiAgICBjb25zdCBzdHJlYW1zID0gdGhpcy5feGZhU3RyZWFtczsKCiAgICBpZiAoIXN0cmVhbXMpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFEYXRhc2V0cyIsIG51bGwpOwogICAgfQoKICAgIGZvciAoY29uc3Qga2V5IG9mIFsiZGF0YXNldHMiLCAieGRwOnhkcCJdKSB7CiAgICAgIGNvbnN0IHN0cmVhbSA9IHN0cmVhbXNba2V5XTsKCiAgICAgIGlmICghc3RyZWFtKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgc3RyID0gKDAsIF91dGlsLnN0cmluZ1RvVVRGOFN0cmluZykoc3RyZWFtLmdldFN0cmluZygpKTsKICAgICAgICBjb25zdCBkYXRhID0gewogICAgICAgICAgW2tleV06IHN0cgogICAgICAgIH07CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFEYXRhc2V0cyIsIG5ldyBfZGF0YXNldF9yZWFkZXIuRGF0YXNldFJlYWRlcihkYXRhKSk7CiAgICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIEludmFsaWQgdXRmLTggc3RyaW5nLiIpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFEYXRhc2V0cyIsIG51bGwpOwogIH0KCiAgZ2V0IHhmYURhdGEoKSB7CiAgICBjb25zdCBzdHJlYW1zID0gdGhpcy5feGZhU3RyZWFtczsKCiAgICBpZiAoIXN0cmVhbXMpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgZGF0YSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgZm9yIChjb25zdCBba2V5LCBzdHJlYW1dIG9mIE9iamVjdC5lbnRyaWVzKHN0cmVhbXMpKSB7CiAgICAgIGlmICghc3RyZWFtKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgZGF0YVtrZXldID0gKDAsIF91dGlsLnN0cmluZ1RvVVRGOFN0cmluZykoc3RyZWFtLmdldFN0cmluZygpKTsKICAgICAgfSBjYXRjaCAoXykgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiWEZBIC0gSW52YWxpZCB1dGYtOCBzdHJpbmcuIik7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIGdldCB4ZmFGYWN0b3J5KCkgewogICAgbGV0IGRhdGE7CgogICAgaWYgKHRoaXMucGRmTWFuYWdlci5lbmFibGVYZmEgJiYgdGhpcy5jYXRhbG9nLm5lZWRzUmVuZGVyaW5nICYmIHRoaXMuZm9ybUluZm8uaGFzWGZhICYmICF0aGlzLmZvcm1JbmZvLmhhc0Fjcm9Gb3JtKSB7CiAgICAgIGRhdGEgPSB0aGlzLnhmYURhdGE7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ4ZmFGYWN0b3J5IiwgZGF0YSA/IG5ldyBfZmFjdG9yeS5YRkFGYWN0b3J5KGRhdGEpIDogbnVsbCk7CiAgfQoKICBnZXQgaXNQdXJlWGZhKCkgewogICAgcmV0dXJuIHRoaXMueGZhRmFjdG9yeSA/IHRoaXMueGZhRmFjdG9yeS5pc1ZhbGlkKCkgOiBmYWxzZTsKICB9CgogIGdldCBodG1sRm9yWGZhKCkgewogICAgcmV0dXJuIHRoaXMueGZhRmFjdG9yeSA/IHRoaXMueGZhRmFjdG9yeS5nZXRQYWdlcygpIDogbnVsbDsKICB9CgogIGFzeW5jIGxvYWRYZmFJbWFnZXMoKSB7CiAgICBjb25zdCB4ZmFJbWFnZXNEaWN0ID0gYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInhmYUltYWdlcyIpOwoKICAgIGlmICgheGZhSW1hZ2VzRGljdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qga2V5cyA9IHhmYUltYWdlc0RpY3QuZ2V0S2V5cygpOwogICAgY29uc3Qgb2JqZWN0TG9hZGVyID0gbmV3IF9vYmplY3RfbG9hZGVyLk9iamVjdExvYWRlcih4ZmFJbWFnZXNEaWN0LCBrZXlzLCB0aGlzLnhyZWYpOwogICAgYXdhaXQgb2JqZWN0TG9hZGVyLmxvYWQoKTsKICAgIGNvbnN0IHhmYUltYWdlcyA9IG5ldyBNYXAoKTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7CiAgICAgIGNvbnN0IHN0cmVhbSA9IHhmYUltYWdlc0RpY3QuZ2V0KGtleSk7CgogICAgICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICB4ZmFJbWFnZXMuc2V0KGtleSwgc3RyZWFtLmdldEJ5dGVzKCkpOwogICAgICB9CiAgICB9CgogICAgdGhpcy54ZmFGYWN0b3J5LnNldEltYWdlcyh4ZmFJbWFnZXMpOwogIH0KCiAgYXN5bmMgbG9hZFhmYUZvbnRzKGhhbmRsZXIsIHRhc2spIHsKICAgIGNvbnN0IGFjcm9Gb3JtID0gYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImFjcm9Gb3JtIik7CgogICAgaWYgKCFhY3JvRm9ybSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcmVzb3VyY2VzID0gYXdhaXQgYWNyb0Zvcm0uZ2V0QXN5bmMoIkRSIik7CgogICAgaWYgKCEocmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG9iamVjdExvYWRlciA9IG5ldyBfb2JqZWN0X2xvYWRlci5PYmplY3RMb2FkZXIocmVzb3VyY2VzLCBbIkZvbnQiXSwgdGhpcy54cmVmKTsKICAgIGF3YWl0IG9iamVjdExvYWRlci5sb2FkKCk7CiAgICBjb25zdCBmb250UmVzID0gcmVzb3VyY2VzLmdldCgiRm9udCIpOwoKICAgIGlmICghKGZvbnRSZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShudWxsKSwgdGhpcy5wZGZNYW5hZ2VyLmV2YWx1YXRvck9wdGlvbnMpOwogICAgb3B0aW9ucy51c2VTeXN0ZW1Gb250cyA9IGZhbHNlOwogICAgY29uc3QgcGFydGlhbEV2YWx1YXRvciA9IG5ldyBfZXZhbHVhdG9yLlBhcnRpYWxFdmFsdWF0b3IoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGhhbmRsZXIsCiAgICAgIHBhZ2VJbmRleDogLTEsCiAgICAgIGlkRmFjdG9yeTogdGhpcy5fZ2xvYmFsSWRGYWN0b3J5LAogICAgICBmb250Q2FjaGU6IHRoaXMuY2F0YWxvZy5mb250Q2FjaGUsCiAgICAgIGJ1aWx0SW5DTWFwQ2FjaGU6IHRoaXMuY2F0YWxvZy5idWlsdEluQ01hcENhY2hlLAogICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IHRoaXMuY2F0YWxvZy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgIG9wdGlvbnMKICAgIH0pOwogICAgY29uc3Qgb3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgY29uc3QgcGRmRm9udHMgPSBbXTsKICAgIGNvbnN0IGluaXRpYWxTdGF0ZSA9IHsKICAgICAgZ2V0IGZvbnQoKSB7CiAgICAgICAgcmV0dXJuIHBkZkZvbnRzLmF0KC0xKTsKICAgICAgfSwKCiAgICAgIHNldCBmb250KGZvbnQpIHsKICAgICAgICBwZGZGb250cy5wdXNoKGZvbnQpOwogICAgICB9LAoKICAgICAgY2xvbmUoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICB9OwogICAgY29uc3QgZm9udHMgPSBuZXcgTWFwKCk7CiAgICBmb250UmVzLmZvckVhY2goKGZvbnROYW1lLCBmb250KSA9PiB7CiAgICAgIGZvbnRzLnNldChmb250TmFtZSwgZm9udCk7CiAgICB9KTsKICAgIGNvbnN0IHByb21pc2VzID0gW107CgogICAgZm9yIChjb25zdCBbZm9udE5hbWUsIGZvbnRdIG9mIGZvbnRzKSB7CiAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBmb250LmdldCgiRm9udERlc2NyaXB0b3IiKTsKCiAgICAgIGlmICghKGRlc2NyaXB0b3IgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgZm9udEZhbWlseSA9IGRlc2NyaXB0b3IuZ2V0KCJGb250RmFtaWx5Iik7CiAgICAgIGZvbnRGYW1pbHkgPSBmb250RmFtaWx5LnJlcGxhY2UoL1sgXSsoXGQpL2csICIkMSIpOwogICAgICBjb25zdCBmb250V2VpZ2h0ID0gZGVzY3JpcHRvci5nZXQoIkZvbnRXZWlnaHQiKTsKICAgICAgY29uc3QgaXRhbGljQW5nbGUgPSAtZGVzY3JpcHRvci5nZXQoIkl0YWxpY0FuZ2xlIik7CiAgICAgIGNvbnN0IGNzc0ZvbnRJbmZvID0gewogICAgICAgIGZvbnRGYW1pbHksCiAgICAgICAgZm9udFdlaWdodCwKICAgICAgICBpdGFsaWNBbmdsZQogICAgICB9OwoKICAgICAgaWYgKCEoMCwgX2NvcmVfdXRpbHMudmFsaWRhdGVDU1NGb250KShjc3NGb250SW5mbykpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgcHJvbWlzZXMucHVzaChwYXJ0aWFsRXZhbHVhdG9yLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBbX3ByaW1pdGl2ZXMuTmFtZS5nZXQoZm9udE5hbWUpLCAxXSwgbnVsbCwgb3BlcmF0b3JMaXN0LCB0YXNrLCBpbml0aWFsU3RhdGUsIG51bGwsIGNzc0ZvbnRJbmZvKS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBsb2FkWGZhRm9udHM6ICIke3JlYXNvbn0iLmApOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9KSk7CiAgICB9CgogICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpOwogICAgY29uc3QgbWlzc2luZ0ZvbnRzID0gdGhpcy54ZmFGYWN0b3J5LnNldEZvbnRzKHBkZkZvbnRzKTsKCiAgICBpZiAoIW1pc3NpbmdGb250cykgewogICAgICByZXR1cm47CiAgICB9CgogICAgb3B0aW9ucy5pZ25vcmVFcnJvcnMgPSB0cnVlOwogICAgcHJvbWlzZXMubGVuZ3RoID0gMDsKICAgIHBkZkZvbnRzLmxlbmd0aCA9IDA7CiAgICBjb25zdCByZWFsbHlNaXNzaW5nRm9udHMgPSBuZXcgU2V0KCk7CgogICAgZm9yIChjb25zdCBtaXNzaW5nIG9mIG1pc3NpbmdGb250cykgewogICAgICBpZiAoISgwLCBfeGZhX2ZvbnRzLmdldFhmYUZvbnROYW1lKShgJHttaXNzaW5nfS1SZWd1bGFyYCkpIHsKICAgICAgICByZWFsbHlNaXNzaW5nRm9udHMuYWRkKG1pc3NpbmcpOwogICAgICB9CiAgICB9CgogICAgaWYgKHJlYWxseU1pc3NpbmdGb250cy5zaXplKSB7CiAgICAgIG1pc3NpbmdGb250cy5wdXNoKCJQZGZKUy1GYWxsYmFjayIpOwogICAgfQoKICAgIGZvciAoY29uc3QgbWlzc2luZyBvZiBtaXNzaW5nRm9udHMpIHsKICAgICAgaWYgKHJlYWxseU1pc3NpbmdGb250cy5oYXMobWlzc2luZykpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChjb25zdCBmb250SW5mbyBvZiBbewogICAgICAgIG5hbWU6ICJSZWd1bGFyIiwKICAgICAgICBmb250V2VpZ2h0OiA0MDAsCiAgICAgICAgaXRhbGljQW5nbGU6IDAKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJCb2xkIiwKICAgICAgICBmb250V2VpZ2h0OiA3MDAsCiAgICAgICAgaXRhbGljQW5nbGU6IDAKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJJdGFsaWMiLAogICAgICAgIGZvbnRXZWlnaHQ6IDQwMCwKICAgICAgICBpdGFsaWNBbmdsZTogMTIKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJCb2xkSXRhbGljIiwKICAgICAgICBmb250V2VpZ2h0OiA3MDAsCiAgICAgICAgaXRhbGljQW5nbGU6IDEyCiAgICAgIH1dKSB7CiAgICAgICAgY29uc3QgbmFtZSA9IGAke21pc3Npbmd9LSR7Zm9udEluZm8ubmFtZX1gOwogICAgICAgIGNvbnN0IGRpY3QgPSAoMCwgX3hmYV9mb250cy5nZXRYZmFGb250RGljdCkobmFtZSk7CiAgICAgICAgcHJvbWlzZXMucHVzaChwYXJ0aWFsRXZhbHVhdG9yLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBbX3ByaW1pdGl2ZXMuTmFtZS5nZXQobmFtZSksIDFdLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIGluaXRpYWxTdGF0ZSwgZGljdCwgewogICAgICAgICAgZm9udEZhbWlseTogbWlzc2luZywKICAgICAgICAgIGZvbnRXZWlnaHQ6IGZvbnRJbmZvLmZvbnRXZWlnaHQsCiAgICAgICAgICBpdGFsaWNBbmdsZTogZm9udEluZm8uaXRhbGljQW5nbGUKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGxvYWRYZmFGb250czogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0KCiAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7CiAgICB0aGlzLnhmYUZhY3RvcnkuYXBwZW5kRm9udHMocGRmRm9udHMsIHJlYWxseU1pc3NpbmdGb250cyk7CiAgfQoKICBhc3luYyBzZXJpYWxpemVYZmFEYXRhKGFubm90YXRpb25TdG9yYWdlKSB7CiAgICByZXR1cm4gdGhpcy54ZmFGYWN0b3J5ID8gdGhpcy54ZmFGYWN0b3J5LnNlcmlhbGl6ZURhdGEoYW5ub3RhdGlvblN0b3JhZ2UpIDogbnVsbDsKICB9CgogIGdldCBmb3JtSW5mbygpIHsKICAgIGNvbnN0IGZvcm1JbmZvID0gewogICAgICBoYXNGaWVsZHM6IGZhbHNlLAogICAgICBoYXNBY3JvRm9ybTogZmFsc2UsCiAgICAgIGhhc1hmYTogZmFsc2UsCiAgICAgIGhhc1NpZ25hdHVyZXM6IGZhbHNlCiAgICB9OwogICAgY29uc3QgYWNyb0Zvcm0gPSB0aGlzLmNhdGFsb2cuYWNyb0Zvcm07CgogICAgaWYgKCFhY3JvRm9ybSkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImZvcm1JbmZvIiwgZm9ybUluZm8pOwogICAgfQoKICAgIHRyeSB7CiAgICAgIGNvbnN0IGZpZWxkcyA9IGFjcm9Gb3JtLmdldCgiRmllbGRzIik7CiAgICAgIGNvbnN0IGhhc0ZpZWxkcyA9IEFycmF5LmlzQXJyYXkoZmllbGRzKSAmJiBmaWVsZHMubGVuZ3RoID4gMDsKICAgICAgZm9ybUluZm8uaGFzRmllbGRzID0gaGFzRmllbGRzOwogICAgICBjb25zdCB4ZmEgPSBhY3JvRm9ybS5nZXQoIlhGQSIpOwogICAgICBmb3JtSW5mby5oYXNYZmEgPSBBcnJheS5pc0FycmF5KHhmYSkgJiYgeGZhLmxlbmd0aCA+IDAgfHwgeGZhIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gJiYgIXhmYS5pc0VtcHR5OwogICAgICBjb25zdCBzaWdGbGFncyA9IGFjcm9Gb3JtLmdldCgiU2lnRmxhZ3MiKTsKICAgICAgY29uc3QgaGFzU2lnbmF0dXJlcyA9ICEhKHNpZ0ZsYWdzICYgMHgxKTsKCiAgICAgIGNvbnN0IGhhc09ubHlEb2N1bWVudFNpZ25hdHVyZXMgPSBoYXNTaWduYXR1cmVzICYmIHRoaXMuX2hhc09ubHlEb2N1bWVudFNpZ25hdHVyZXMoZmllbGRzKTsKCiAgICAgIGZvcm1JbmZvLmhhc0Fjcm9Gb3JtID0gaGFzRmllbGRzICYmICFoYXNPbmx5RG9jdW1lbnRTaWduYXR1cmVzOwogICAgICBmb3JtSW5mby5oYXNTaWduYXR1cmVzID0gaGFzU2lnbmF0dXJlczsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKShgQ2Fubm90IGZldGNoIGZvcm0gaW5mb3JtYXRpb246ICIke2V4fSIuYCk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmb3JtSW5mbyIsIGZvcm1JbmZvKTsKICB9CgogIGdldCBkb2N1bWVudEluZm8oKSB7CiAgICBsZXQgdmVyc2lvbiA9IHRoaXMuX3ZlcnNpb247CgogICAgaWYgKHR5cGVvZiB2ZXJzaW9uICE9PSAic3RyaW5nIiB8fCAhUERGX0hFQURFUl9WRVJTSU9OX1JFR0VYUC50ZXN0KHZlcnNpb24pKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgSW52YWxpZCBQREYgaGVhZGVyIHZlcnNpb24gbnVtYmVyOiAke3ZlcnNpb259YCk7CiAgICAgIHZlcnNpb24gPSBudWxsOwogICAgfQoKICAgIGNvbnN0IGRvY0luZm8gPSB7CiAgICAgIFBERkZvcm1hdFZlcnNpb246IHZlcnNpb24sCiAgICAgIExhbmd1YWdlOiB0aGlzLmNhdGFsb2cubGFuZywKICAgICAgRW5jcnlwdEZpbHRlck5hbWU6IHRoaXMueHJlZi5lbmNyeXB0ID8gdGhpcy54cmVmLmVuY3J5cHQuZmlsdGVyTmFtZSA6IG51bGwsCiAgICAgIElzTGluZWFyaXplZDogISF0aGlzLmxpbmVhcml6YXRpb24sCiAgICAgIElzQWNyb0Zvcm1QcmVzZW50OiB0aGlzLmZvcm1JbmZvLmhhc0Fjcm9Gb3JtLAogICAgICBJc1hGQVByZXNlbnQ6IHRoaXMuZm9ybUluZm8uaGFzWGZhLAogICAgICBJc0NvbGxlY3Rpb25QcmVzZW50OiAhIXRoaXMuY2F0YWxvZy5jb2xsZWN0aW9uLAogICAgICBJc1NpZ25hdHVyZXNQcmVzZW50OiB0aGlzLmZvcm1JbmZvLmhhc1NpZ25hdHVyZXMKICAgIH07CiAgICBsZXQgaW5mb0RpY3Q7CgogICAgdHJ5IHsKICAgICAgaW5mb0RpY3QgPSB0aGlzLnhyZWYudHJhaWxlci5nZXQoIkluZm8iKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKSgiVGhlIGRvY3VtZW50IGluZm9ybWF0aW9uIGRpY3Rpb25hcnkgaXMgaW52YWxpZC4iKTsKICAgIH0KCiAgICBpZiAoIShpbmZvRGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZG9jdW1lbnRJbmZvIiwgZG9jSW5mbyk7CiAgICB9CgogICAgZm9yIChjb25zdCBrZXkgb2YgaW5mb0RpY3QuZ2V0S2V5cygpKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaW5mb0RpY3QuZ2V0KGtleSk7CgogICAgICBzd2l0Y2ggKGtleSkgewogICAgICAgIGNhc2UgIlRpdGxlIjoKICAgICAgICBjYXNlICJBdXRob3IiOgogICAgICAgIGNhc2UgIlN1YmplY3QiOgogICAgICAgIGNhc2UgIktleXdvcmRzIjoKICAgICAgICBjYXNlICJDcmVhdG9yIjoKICAgICAgICBjYXNlICJQcm9kdWNlciI6CiAgICAgICAgY2FzZSAiQ3JlYXRpb25EYXRlIjoKICAgICAgICBjYXNlICJNb2REYXRlIjoKICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgIGRvY0luZm9ba2V5XSA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykodmFsdWUpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiVHJhcHBlZCI6CiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIGRvY0luZm9ba2V5XSA9IHZhbHVlOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGxldCBjdXN0b21WYWx1ZTsKCiAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkgewogICAgICAgICAgICBjYXNlICJzdHJpbmciOgogICAgICAgICAgICAgIGN1c3RvbVZhbHVlID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKSh2YWx1ZSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJudW1iZXIiOgogICAgICAgICAgICBjYXNlICJib29sZWFuIjoKICAgICAgICAgICAgICBjdXN0b21WYWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgICAgICBjdXN0b21WYWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGN1c3RvbVZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBCYWQgdmFsdWUsIGZvciBjdXN0b20ga2V5ICIke2tleX0iLCBpbiBJbmZvOiAke3ZhbHVlfS5gKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFkb2NJbmZvLkN1c3RvbSkgewogICAgICAgICAgICBkb2NJbmZvLkN1c3RvbSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgZG9jSW5mby5DdXN0b21ba2V5XSA9IGN1c3RvbVZhbHVlOwogICAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKShgQmFkIHZhbHVlLCBmb3Iga2V5ICIke2tleX0iLCBpbiBJbmZvOiAke3ZhbHVlfS5gKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImRvY3VtZW50SW5mbyIsIGRvY0luZm8pOwogIH0KCiAgZ2V0IGZpbmdlcnByaW50cygpIHsKICAgIGZ1bmN0aW9uIHZhbGlkYXRlKGRhdGEpIHsKICAgICAgcmV0dXJuIHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiAmJiBkYXRhLmxlbmd0aCA+IDAgJiYgZGF0YSAhPT0gRU1QVFlfRklOR0VSUFJJTlQ7CiAgICB9CgogICAgZnVuY3Rpb24gaGV4U3RyaW5nKGhhc2gpIHsKICAgICAgY29uc3QgYnVmID0gW107CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBoYXNoLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCBoZXggPSBoYXNoW2ldLnRvU3RyaW5nKDE2KTsKICAgICAgICBidWYucHVzaChoZXgucGFkU3RhcnQoMiwgIjAiKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBidWYuam9pbigiIik7CiAgICB9CgogICAgY29uc3QgaWRBcnJheSA9IHRoaXMueHJlZi50cmFpbGVyLmdldCgiSUQiKTsKICAgIGxldCBoYXNoT3JpZ2luYWwsIGhhc2hNb2RpZmllZDsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShpZEFycmF5KSAmJiB2YWxpZGF0ZShpZEFycmF5WzBdKSkgewogICAgICBoYXNoT3JpZ2luYWwgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoaWRBcnJheVswXSk7CgogICAgICBpZiAoaWRBcnJheVsxXSAhPT0gaWRBcnJheVswXSAmJiB2YWxpZGF0ZShpZEFycmF5WzFdKSkgewogICAgICAgIGhhc2hNb2RpZmllZCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShpZEFycmF5WzFdKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaGFzaE9yaWdpbmFsID0gKDAsIF9jcnlwdG8uY2FsY3VsYXRlTUQ1KSh0aGlzLnN0cmVhbS5nZXRCeXRlUmFuZ2UoMCwgRklOR0VSUFJJTlRfRklSU1RfQllURVMpLCAwLCBGSU5HRVJQUklOVF9GSVJTVF9CWVRFUyk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmaW5nZXJwcmludHMiLCBbaGV4U3RyaW5nKGhhc2hPcmlnaW5hbCksIGhhc2hNb2RpZmllZCA/IGhleFN0cmluZyhoYXNoTW9kaWZpZWQpIDogbnVsbF0pOwogIH0KCiAgYXN5bmMgX2dldExpbmVhcml6YXRpb25QYWdlKHBhZ2VJbmRleCkgewogICAgY29uc3QgewogICAgICBjYXRhbG9nLAogICAgICBsaW5lYXJpemF0aW9uLAogICAgICB4cmVmCiAgICB9ID0gdGhpczsKCiAgICBjb25zdCByZWYgPSBfcHJpbWl0aXZlcy5SZWYuZ2V0KGxpbmVhcml6YXRpb24ub2JqZWN0TnVtYmVyRmlyc3QsIDApOwoKICAgIHRyeSB7CiAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyhyZWYpOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBsZXQgdHlwZSA9IG9iai5nZXRSYXcoIlR5cGUiKTsKCiAgICAgICAgaWYgKHR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgIHR5cGUgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmModHlwZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSwgIlBhZ2UiKSB8fCAhb2JqLmhhcygiVHlwZSIpICYmICFvYmouaGFzKCJLaWRzIikpIHsKICAgICAgICAgIGlmICghY2F0YWxvZy5wYWdlS2lkc0NvdW50Q2FjaGUuaGFzKHJlZikpIHsKICAgICAgICAgICAgY2F0YWxvZy5wYWdlS2lkc0NvdW50Q2FjaGUucHV0KHJlZiwgMSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFjYXRhbG9nLnBhZ2VJbmRleENhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgICAgIGNhdGFsb2cucGFnZUluZGV4Q2FjaGUucHV0KHJlZiwgMCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIFtvYmosIHJlZl07CiAgICAgICAgfQogICAgICB9CgogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlRoZSBMaW5lYXJpemF0aW9uIGRpY3Rpb25hcnkgZG9lc24ndCBwb2ludCB0byBhIHZhbGlkIFBhZ2UgZGljdGlvbmFyeS4iKTsKICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICAoMCwgX3V0aWwud2FybikoYF9nZXRMaW5lYXJpemF0aW9uUGFnZTogIiR7cmVhc29uLm1lc3NhZ2V9Ii5gKTsKICAgICAgcmV0dXJuIGNhdGFsb2cuZ2V0UGFnZURpY3QocGFnZUluZGV4KTsKICAgIH0KICB9CgogIGdldFBhZ2UocGFnZUluZGV4KSB7CiAgICBjb25zdCBjYWNoZWRQcm9taXNlID0gdGhpcy5fcGFnZVByb21pc2VzLmdldChwYWdlSW5kZXgpOwoKICAgIGlmIChjYWNoZWRQcm9taXNlKSB7CiAgICAgIHJldHVybiBjYWNoZWRQcm9taXNlOwogICAgfQoKICAgIGNvbnN0IHsKICAgICAgY2F0YWxvZywKICAgICAgbGluZWFyaXphdGlvbiwKICAgICAgeGZhRmFjdG9yeQogICAgfSA9IHRoaXM7CiAgICBsZXQgcHJvbWlzZTsKCiAgICBpZiAoeGZhRmFjdG9yeSkgewogICAgICBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKFtfcHJpbWl0aXZlcy5EaWN0LmVtcHR5LCBudWxsXSk7CiAgICB9IGVsc2UgaWYgKGxpbmVhcml6YXRpb24gJiYgbGluZWFyaXphdGlvbi5wYWdlRmlyc3QgPT09IHBhZ2VJbmRleCkgewogICAgICBwcm9taXNlID0gdGhpcy5fZ2V0TGluZWFyaXphdGlvblBhZ2UocGFnZUluZGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIHByb21pc2UgPSBjYXRhbG9nLmdldFBhZ2VEaWN0KHBhZ2VJbmRleCk7CiAgICB9CgogICAgcHJvbWlzZSA9IHByb21pc2UudGhlbigoW3BhZ2VEaWN0LCByZWZdKSA9PiB7CiAgICAgIHJldHVybiBuZXcgUGFnZSh7CiAgICAgICAgcGRmTWFuYWdlcjogdGhpcy5wZGZNYW5hZ2VyLAogICAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgICBwYWdlSW5kZXgsCiAgICAgICAgcGFnZURpY3QsCiAgICAgICAgcmVmLAogICAgICAgIGdsb2JhbElkRmFjdG9yeTogdGhpcy5fZ2xvYmFsSWRGYWN0b3J5LAogICAgICAgIGZvbnRDYWNoZTogY2F0YWxvZy5mb250Q2FjaGUsCiAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogY2F0YWxvZy5idWlsdEluQ01hcENhY2hlLAogICAgICAgIHN0YW5kYXJkRm9udERhdGFDYWNoZTogY2F0YWxvZy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogY2F0YWxvZy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgIG5vbkJsZW5kTW9kZXNTZXQ6IGNhdGFsb2cubm9uQmxlbmRNb2Rlc1NldCwKICAgICAgICB4ZmFGYWN0b3J5CiAgICAgIH0pOwogICAgfSk7CgogICAgdGhpcy5fcGFnZVByb21pc2VzLnNldChwYWdlSW5kZXgsIHByb21pc2UpOwoKICAgIHJldHVybiBwcm9taXNlOwogIH0KCiAgYXN5bmMgY2hlY2tGaXJzdFBhZ2UocmVjb3ZlcnlNb2RlID0gZmFsc2UpIHsKICAgIGlmIChyZWNvdmVyeU1vZGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRyeSB7CiAgICAgIGF3YWl0IHRoaXMuZ2V0UGFnZSgwKTsKICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uKSB7CiAgICAgICAgdGhpcy5fcGFnZVByb21pc2VzLmRlbGV0ZSgwKTsKCiAgICAgICAgYXdhaXQgdGhpcy5jbGVhbnVwKCk7CiAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZQYXJzZUV4Y2VwdGlvbigpOwogICAgICB9CiAgICB9CiAgfQoKICBhc3luYyBjaGVja0xhc3RQYWdlKHJlY292ZXJ5TW9kZSA9IGZhbHNlKSB7CiAgICBjb25zdCB7CiAgICAgIGNhdGFsb2csCiAgICAgIHBkZk1hbmFnZXIKICAgIH0gPSB0aGlzOwogICAgY2F0YWxvZy5zZXRBY3R1YWxOdW1QYWdlcygpOwogICAgbGV0IG51bVBhZ2VzOwoKICAgIHRyeSB7CiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmVuc3VyZURvYygieGZhRmFjdG9yeSIpLCBwZGZNYW5hZ2VyLmVuc3VyZURvYygibGluZWFyaXphdGlvbiIpLCBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coIm51bVBhZ2VzIildKTsKCiAgICAgIGlmICh0aGlzLnhmYUZhY3RvcnkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5saW5lYXJpemF0aW9uKSB7CiAgICAgICAgbnVtUGFnZXMgPSB0aGlzLmxpbmVhcml6YXRpb24ubnVtUGFnZXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbnVtUGFnZXMgPSBjYXRhbG9nLm51bVBhZ2VzOwogICAgICB9CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIobnVtUGFnZXMpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlIGNvdW50IGlzIG5vdCBhbiBpbnRlZ2VyLiIpOwogICAgICB9IGVsc2UgaWYgKG51bVBhZ2VzIDw9IDEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGF3YWl0IHRoaXMuZ2V0UGFnZShudW1QYWdlcyAtIDEpOwogICAgfSBjYXRjaCAocmVhc29uKSB7CiAgICAgIHRoaXMuX3BhZ2VQcm9taXNlcy5kZWxldGUobnVtUGFnZXMgLSAxKTsKCiAgICAgIGF3YWl0IHRoaXMuY2xlYW51cCgpOwoKICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbiAmJiAhcmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZQYXJzZUV4Y2VwdGlvbigpOwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYGNoZWNrTGFzdFBhZ2UgLSBpbnZhbGlkIC9QYWdlcyB0cmVlIC9Db3VudDogJHtudW1QYWdlc30uYCk7CiAgICAgIGxldCBwYWdlc1RyZWU7CgogICAgICB0cnkgewogICAgICAgIHBhZ2VzVHJlZSA9IGF3YWl0IGNhdGFsb2cuZ2V0QWxsUGFnZURpY3RzKHJlY292ZXJ5TW9kZSk7CiAgICAgIH0gY2F0Y2ggKHJlYXNvbkFsbCkgewogICAgICAgIGlmIChyZWFzb25BbGwgaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24gJiYgIXJlY292ZXJ5TW9kZSkgewogICAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZQYXJzZUV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgY2F0YWxvZy5zZXRBY3R1YWxOdW1QYWdlcygxKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGZvciAoY29uc3QgW3BhZ2VJbmRleCwgW3BhZ2VEaWN0LCByZWZdXSBvZiBwYWdlc1RyZWUpIHsKICAgICAgICBsZXQgcHJvbWlzZTsKCiAgICAgICAgaWYgKHBhZ2VEaWN0IGluc3RhbmNlb2YgRXJyb3IpIHsKICAgICAgICAgIHByb21pc2UgPSBQcm9taXNlLnJlamVjdChwYWdlRGljdCk7CiAgICAgICAgICBwcm9taXNlLmNhdGNoKCgpID0+IHt9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShuZXcgUGFnZSh7CiAgICAgICAgICAgIHBkZk1hbmFnZXIsCiAgICAgICAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgICAgICAgcGFnZUluZGV4LAogICAgICAgICAgICBwYWdlRGljdCwKICAgICAgICAgICAgcmVmLAogICAgICAgICAgICBnbG9iYWxJZEZhY3Rvcnk6IHRoaXMuX2dsb2JhbElkRmFjdG9yeSwKICAgICAgICAgICAgZm9udENhY2hlOiBjYXRhbG9nLmZvbnRDYWNoZSwKICAgICAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogY2F0YWxvZy5idWlsdEluQ01hcENhY2hlLAogICAgICAgICAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGU6IGNhdGFsb2cuc3RhbmRhcmRGb250RGF0YUNhY2hlLAogICAgICAgICAgICBnbG9iYWxJbWFnZUNhY2hlOiBjYXRhbG9nLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgICAgICAgIG5vbkJsZW5kTW9kZXNTZXQ6IGNhdGFsb2cubm9uQmxlbmRNb2Rlc1NldCwKICAgICAgICAgICAgeGZhRmFjdG9yeTogbnVsbAogICAgICAgICAgfSkpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fcGFnZVByb21pc2VzLnNldChwYWdlSW5kZXgsIHByb21pc2UpOwogICAgICB9CgogICAgICBjYXRhbG9nLnNldEFjdHVhbE51bVBhZ2VzKHBhZ2VzVHJlZS5zaXplKTsKICAgIH0KICB9CgogIGZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcikgewogICAgcmV0dXJuIHRoaXMuY2F0YWxvZy5mb250RmFsbGJhY2soaWQsIGhhbmRsZXIpOwogIH0KCiAgYXN5bmMgY2xlYW51cChtYW51YWxseVRyaWdnZXJlZCA9IGZhbHNlKSB7CiAgICByZXR1cm4gdGhpcy5jYXRhbG9nID8gdGhpcy5jYXRhbG9nLmNsZWFudXAobWFudWFsbHlUcmlnZ2VyZWQpIDogKDAsIF9jbGVhbnVwX2hlbHBlci5jbGVhckdsb2JhbENhY2hlcykoKTsKICB9CgogIF9jb2xsZWN0RmllbGRPYmplY3RzKG5hbWUsIGZpZWxkUmVmLCBwcm9taXNlcykgewogICAgY29uc3QgZmllbGQgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihmaWVsZFJlZik7CgogICAgaWYgKGZpZWxkLmhhcygiVCIpKSB7CiAgICAgIGNvbnN0IHBhcnROYW1lID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShmaWVsZC5nZXQoIlQiKSk7CgogICAgICBpZiAobmFtZSA9PT0gIiIpIHsKICAgICAgICBuYW1lID0gcGFydE5hbWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmFtZSA9IGAke25hbWV9LiR7cGFydE5hbWV9YDsKICAgICAgfQogICAgfQoKICAgIGlmICghcHJvbWlzZXMuaGFzKG5hbWUpKSB7CiAgICAgIHByb21pc2VzLnNldChuYW1lLCBbXSk7CiAgICB9CgogICAgcHJvbWlzZXMuZ2V0KG5hbWUpLnB1c2goX2Fubm90YXRpb24uQW5ub3RhdGlvbkZhY3RvcnkuY3JlYXRlKHRoaXMueHJlZiwgZmllbGRSZWYsIHRoaXMucGRmTWFuYWdlciwgdGhpcy5fbG9jYWxJZEZhY3RvcnksIHRydWUpLnRoZW4oYW5ub3RhdGlvbiA9PiBhbm5vdGF0aW9uICYmIGFubm90YXRpb24uZ2V0RmllbGRPYmplY3QoKSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAoMCwgX3V0aWwud2FybikoYF9jb2xsZWN0RmllbGRPYmplY3RzOiAiJHtyZWFzb259Ii5gKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9KSk7CgogICAgaWYgKGZpZWxkLmhhcygiS2lkcyIpKSB7CiAgICAgIGNvbnN0IGtpZHMgPSBmaWVsZC5nZXQoIktpZHMiKTsKCiAgICAgIGZvciAoY29uc3Qga2lkIG9mIGtpZHMpIHsKICAgICAgICB0aGlzLl9jb2xsZWN0RmllbGRPYmplY3RzKG5hbWUsIGtpZCwgcHJvbWlzZXMpOwogICAgICB9CiAgICB9CiAgfQoKICBnZXQgZmllbGRPYmplY3RzKCkgewogICAgaWYgKCF0aGlzLmZvcm1JbmZvLmhhc0ZpZWxkcykgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImZpZWxkT2JqZWN0cyIsIFByb21pc2UucmVzb2x2ZShudWxsKSk7CiAgICB9CgogICAgY29uc3QgYWxsRmllbGRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGNvbnN0IGZpZWxkUHJvbWlzZXMgPSBuZXcgTWFwKCk7CgogICAgZm9yIChjb25zdCBmaWVsZFJlZiBvZiB0aGlzLmNhdGFsb2cuYWNyb0Zvcm0uZ2V0KCJGaWVsZHMiKSkgewogICAgICB0aGlzLl9jb2xsZWN0RmllbGRPYmplY3RzKCIiLCBmaWVsZFJlZiwgZmllbGRQcm9taXNlcyk7CiAgICB9CgogICAgY29uc3QgYWxsUHJvbWlzZXMgPSBbXTsKCiAgICBmb3IgKGNvbnN0IFtuYW1lLCBwcm9taXNlc10gb2YgZmllbGRQcm9taXNlcykgewogICAgICBhbGxQcm9taXNlcy5wdXNoKFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZpZWxkcyA9PiB7CiAgICAgICAgZmllbGRzID0gZmllbGRzLmZpbHRlcihmaWVsZCA9PiAhIWZpZWxkKTsKCiAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBhbGxGaWVsZHNbbmFtZV0gPSBmaWVsZHM7CiAgICAgICAgfQogICAgICB9KSk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmaWVsZE9iamVjdHMiLCBQcm9taXNlLmFsbChhbGxQcm9taXNlcykudGhlbigoKSA9PiBhbGxGaWVsZHMpKTsKICB9CgogIGdldCBoYXNKU0FjdGlvbnMoKSB7CiAgICBjb25zdCBwcm9taXNlID0gdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZURvYygiX3BhcnNlSGFzSlNBY3Rpb25zIik7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImhhc0pTQWN0aW9ucyIsIHByb21pc2UpOwogIH0KCiAgYXN5bmMgX3BhcnNlSGFzSlNBY3Rpb25zKCkgewogICAgY29uc3QgW2NhdGFsb2dKc0FjdGlvbnMsIGZpZWxkT2JqZWN0c10gPSBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy5wZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImpzQWN0aW9ucyIpLCB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlRG9jKCJmaWVsZE9iamVjdHMiKV0pOwoKICAgIGlmIChjYXRhbG9nSnNBY3Rpb25zKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmIChmaWVsZE9iamVjdHMpIHsKICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoZmllbGRPYmplY3RzKS5zb21lKGZpZWxkT2JqZWN0ID0+IGZpZWxkT2JqZWN0LnNvbWUob2JqZWN0ID0+IG9iamVjdC5hY3Rpb25zICE9PSBudWxsKSk7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZ2V0IGNhbGN1bGF0aW9uT3JkZXJJZHMoKSB7CiAgICBjb25zdCBhY3JvRm9ybSA9IHRoaXMuY2F0YWxvZy5hY3JvRm9ybTsKCiAgICBpZiAoIWFjcm9Gb3JtIHx8ICFhY3JvRm9ybS5oYXMoIkNPIikpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjYWxjdWxhdGlvbk9yZGVySWRzIiwgbnVsbCk7CiAgICB9CgogICAgY29uc3QgY2FsY3VsYXRpb25PcmRlciA9IGFjcm9Gb3JtLmdldCgiQ08iKTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkoY2FsY3VsYXRpb25PcmRlcikgfHwgY2FsY3VsYXRpb25PcmRlci5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjYWxjdWxhdGlvbk9yZGVySWRzIiwgbnVsbCk7CiAgICB9CgogICAgY29uc3QgaWRzID0gW107CgogICAgZm9yIChjb25zdCBpZCBvZiBjYWxjdWxhdGlvbk9yZGVyKSB7CiAgICAgIGlmIChpZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGlkcy5wdXNoKGlkLnRvU3RyaW5nKCkpOwogICAgICB9CiAgICB9CgogICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjYWxjdWxhdGlvbk9yZGVySWRzIiwgbnVsbCk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjYWxjdWxhdGlvbk9yZGVySWRzIiwgaWRzKTsKICB9Cgp9CgpleHBvcnRzLlBERkRvY3VtZW50ID0gUERGRG9jdW1lbnQ7CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Qb3B1cEFubm90YXRpb24gPSBleHBvcnRzLk1hcmt1cEFubm90YXRpb24gPSBleHBvcnRzLkFubm90YXRpb25GYWN0b3J5ID0gZXhwb3J0cy5Bbm5vdGF0aW9uQm9yZGVyU3R5bGUgPSBleHBvcnRzLkFubm90YXRpb24gPSB2b2lkIDA7CmV4cG9ydHMuZ2V0UXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHM7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfZGVmYXVsdF9hcHBlYXJhbmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF93cml0ZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY1KTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9iaWRpID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MCk7Cgp2YXIgX2NhdGFsb2cgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY5KTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQpOwoKdmFyIF9maWxlX3NwZWMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcyKTsKCnZhciBfb2JqZWN0X2xvYWRlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNzUpOwoKdmFyIF9vcGVyYXRvcl9saXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwoKdmFyIF9mYWN0b3J5ID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nik7CgpjbGFzcyBBbm5vdGF0aW9uRmFjdG9yeSB7CiAgc3RhdGljIGNyZWF0ZSh4cmVmLCByZWYsIHBkZk1hbmFnZXIsIGlkRmFjdG9yeSwgY29sbGVjdEZpZWxkcykgewogICAgcmV0dXJuIFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImFjcm9Gb3JtIiksIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiYmFzZVVybCIpLCBwZGZNYW5hZ2VyLmVuc3VyZURvYygieGZhRGF0YXNldHMiKSwgY29sbGVjdEZpZWxkcyA/IHRoaXMuX2dldFBhZ2VJbmRleCh4cmVmLCByZWYsIHBkZk1hbmFnZXIpIDogLTFdKS50aGVuKChbYWNyb0Zvcm0sIGJhc2VVcmwsIHhmYURhdGFzZXRzLCBwYWdlSW5kZXhdKSA9PiBwZGZNYW5hZ2VyLmVuc3VyZSh0aGlzLCAiX2NyZWF0ZSIsIFt4cmVmLCByZWYsIHBkZk1hbmFnZXIsIGlkRmFjdG9yeSwgYWNyb0Zvcm0sIHhmYURhdGFzZXRzLCBjb2xsZWN0RmllbGRzLCBwYWdlSW5kZXhdKSk7CiAgfQoKICBzdGF0aWMgX2NyZWF0ZSh4cmVmLCByZWYsIHBkZk1hbmFnZXIsIGlkRmFjdG9yeSwgYWNyb0Zvcm0sIHhmYURhdGFzZXRzLCBjb2xsZWN0RmllbGRzLCBwYWdlSW5kZXggPSAtMSkgewogICAgY29uc3QgZGljdCA9IHhyZWYuZmV0Y2hJZlJlZihyZWYpOwoKICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIGNvbnN0IGlkID0gcmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8gcmVmLnRvU3RyaW5nKCkgOiBgYW5ub3RfJHtpZEZhY3RvcnkuY3JlYXRlT2JqSWQoKX1gOwogICAgbGV0IHN1YnR5cGUgPSBkaWN0LmdldCgiU3VidHlwZSIpOwogICAgc3VidHlwZSA9IHN1YnR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gc3VidHlwZS5uYW1lIDogbnVsbDsKICAgIGNvbnN0IHBhcmFtZXRlcnMgPSB7CiAgICAgIHhyZWYsCiAgICAgIHJlZiwKICAgICAgZGljdCwKICAgICAgc3VidHlwZSwKICAgICAgaWQsCiAgICAgIHBkZk1hbmFnZXIsCiAgICAgIGFjcm9Gb3JtOiBhY3JvRm9ybSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgPyBhY3JvRm9ybSA6IF9wcmltaXRpdmVzLkRpY3QuZW1wdHksCiAgICAgIHhmYURhdGFzZXRzLAogICAgICBjb2xsZWN0RmllbGRzLAogICAgICBwYWdlSW5kZXgKICAgIH07CgogICAgc3dpdGNoIChzdWJ0eXBlKSB7CiAgICAgIGNhc2UgIkxpbmsiOgogICAgICAgIHJldHVybiBuZXcgTGlua0Fubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJUZXh0IjoKICAgICAgICByZXR1cm4gbmV3IFRleHRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiV2lkZ2V0IjoKICAgICAgICBsZXQgZmllbGRUeXBlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgICAgIGRpY3QsCiAgICAgICAgICBrZXk6ICJGVCIKICAgICAgICB9KTsKICAgICAgICBmaWVsZFR5cGUgPSBmaWVsZFR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gZmllbGRUeXBlLm5hbWUgOiBudWxsOwoKICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkgewogICAgICAgICAgY2FzZSAiVHgiOgogICAgICAgICAgICByZXR1cm4gbmV3IFRleHRXaWRnZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgICAgIGNhc2UgIkJ0biI6CiAgICAgICAgICAgIHJldHVybiBuZXcgQnV0dG9uV2lkZ2V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgICBjYXNlICJDaCI6CiAgICAgICAgICAgIHJldHVybiBuZXcgQ2hvaWNlV2lkZ2V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgICBjYXNlICJTaWciOgogICAgICAgICAgICByZXR1cm4gbmV3IFNpZ25hdHVyZVdpZGdldEFubm90YXRpb24ocGFyYW1ldGVycyk7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoYFVuaW1wbGVtZW50ZWQgd2lkZ2V0IGZpZWxkIHR5cGUgIiR7ZmllbGRUeXBlfSIsIGAgKyAiZmFsbGluZyBiYWNrIHRvIGJhc2UgZmllbGQgdHlwZS4iKTsKICAgICAgICByZXR1cm4gbmV3IFdpZGdldEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJQb3B1cCI6CiAgICAgICAgcmV0dXJuIG5ldyBQb3B1cEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJGcmVlVGV4dCI6CiAgICAgICAgcmV0dXJuIG5ldyBGcmVlVGV4dEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJMaW5lIjoKICAgICAgICByZXR1cm4gbmV3IExpbmVBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiU3F1YXJlIjoKICAgICAgICByZXR1cm4gbmV3IFNxdWFyZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJDaXJjbGUiOgogICAgICAgIHJldHVybiBuZXcgQ2lyY2xlQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIlBvbHlMaW5lIjoKICAgICAgICByZXR1cm4gbmV3IFBvbHlsaW5lQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIlBvbHlnb24iOgogICAgICAgIHJldHVybiBuZXcgUG9seWdvbkFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJDYXJldCI6CiAgICAgICAgcmV0dXJuIG5ldyBDYXJldEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJJbmsiOgogICAgICAgIHJldHVybiBuZXcgSW5rQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIkhpZ2hsaWdodCI6CiAgICAgICAgcmV0dXJuIG5ldyBIaWdobGlnaHRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgY2FzZSAiVW5kZXJsaW5lIjoKICAgICAgICByZXR1cm4gbmV3IFVuZGVybGluZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJTcXVpZ2dseSI6CiAgICAgICAgcmV0dXJuIG5ldyBTcXVpZ2dseUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICBjYXNlICJTdHJpa2VPdXQiOgogICAgICAgIHJldHVybiBuZXcgU3RyaWtlT3V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIlN0YW1wIjoKICAgICAgICByZXR1cm4gbmV3IFN0YW1wQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGNhc2UgIkZpbGVBdHRhY2htZW50IjoKICAgICAgICByZXR1cm4gbmV3IEZpbGVBdHRhY2htZW50QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgaWYgKCFjb2xsZWN0RmllbGRzKSB7CiAgICAgICAgICBpZiAoIXN1YnR5cGUpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJBbm5vdGF0aW9uIGlzIG1pc3NpbmcgdGhlIHJlcXVpcmVkIC9TdWJ0eXBlLiIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBVbmltcGxlbWVudGVkIGFubm90YXRpb24gdHlwZSAiJHtzdWJ0eXBlfSIsIGAgKyAiZmFsbGluZyBiYWNrIHRvIGJhc2UgYW5ub3RhdGlvbi4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcgQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKICAgIH0KICB9CgogIHN0YXRpYyBhc3luYyBfZ2V0UGFnZUluZGV4KHhyZWYsIHJlZiwgcGRmTWFuYWdlcikgewogICAgdHJ5IHsKICAgICAgY29uc3QgYW5ub3REaWN0ID0gYXdhaXQgeHJlZi5mZXRjaElmUmVmQXN5bmMocmVmKTsKCiAgICAgIGlmICghKGFubm90RGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICBjb25zdCBwYWdlUmVmID0gYW5ub3REaWN0LmdldFJhdygiUCIpOwoKICAgICAgaWYgKCEocGFnZVJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBhZ2VJbmRleCA9IGF3YWl0IHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0UGFnZUluZGV4IiwgW3BhZ2VSZWZdKTsKICAgICAgcmV0dXJuIHBhZ2VJbmRleDsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgX2dldFBhZ2VJbmRleDogIiR7ZXh9Ii5gKTsKICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0KCiAgc3RhdGljIGFzeW5jIHNhdmVOZXdBbm5vdGF0aW9ucyhldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25zKSB7CiAgICBjb25zdCB4cmVmID0gZXZhbHVhdG9yLnhyZWY7CiAgICBsZXQgYmFzZUZvbnRSZWY7CiAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBbXTsKICAgIGNvbnN0IHByb21pc2VzID0gW107CgogICAgZm9yIChjb25zdCBhbm5vdGF0aW9uIG9mIGFubm90YXRpb25zKSB7CiAgICAgIHN3aXRjaCAoYW5ub3RhdGlvbi5hbm5vdGF0aW9uVHlwZSkgewogICAgICAgIGNhc2UgX3V0aWwuQW5ub3RhdGlvbkVkaXRvclR5cGUuRlJFRVRFWFQ6CiAgICAgICAgICBpZiAoIWJhc2VGb250UmVmKSB7CiAgICAgICAgICAgIGNvbnN0IGJhc2VGb250ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgICAgICAgIGJhc2VGb250LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSGVsdmV0aWNhIikpOwogICAgICAgICAgICBiYXNlRm9udC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRm9udCIpKTsKICAgICAgICAgICAgYmFzZUZvbnQuc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlR5cGUxIikpOwogICAgICAgICAgICBiYXNlRm9udC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIldpbkFuc2lFbmNvZGluZyIpKTsKICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gW107CiAgICAgICAgICAgIGJhc2VGb250UmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgICAgICAgICAgKDAsIF93cml0ZXIud3JpdGVPYmplY3QpKGJhc2VGb250UmVmLCBiYXNlRm9udCwgYnVmZmVyLCBudWxsKTsKICAgICAgICAgICAgZGVwZW5kZW5jaWVzLnB1c2goewogICAgICAgICAgICAgIHJlZjogYmFzZUZvbnRSZWYsCiAgICAgICAgICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHByb21pc2VzLnB1c2goRnJlZVRleHRBbm5vdGF0aW9uLmNyZWF0ZU5ld0Fubm90YXRpb24oeHJlZiwgYW5ub3RhdGlvbiwgZGVwZW5kZW5jaWVzLCB7CiAgICAgICAgICAgIGV2YWx1YXRvciwKICAgICAgICAgICAgdGFzaywKICAgICAgICAgICAgYmFzZUZvbnRSZWYKICAgICAgICAgIH0pKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIF91dGlsLkFubm90YXRpb25FZGl0b3JUeXBlLklOSzoKICAgICAgICAgIHByb21pc2VzLnB1c2goSW5rQW5ub3RhdGlvbi5jcmVhdGVOZXdBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIGRlcGVuZGVuY2llcykpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgYW5ub3RhdGlvbnM6IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKSwKICAgICAgZGVwZW5kZW5jaWVzCiAgICB9OwogIH0KCiAgc3RhdGljIGFzeW5jIHByaW50TmV3QW5ub3RhdGlvbnMoZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9ucykgewogICAgaWYgKCFhbm5vdGF0aW9ucykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCB4cmVmID0gZXZhbHVhdG9yLnhyZWY7CiAgICBjb25zdCBwcm9taXNlcyA9IFtdOwoKICAgIGZvciAoY29uc3QgYW5ub3RhdGlvbiBvZiBhbm5vdGF0aW9ucykgewogICAgICBzd2l0Y2ggKGFubm90YXRpb24uYW5ub3RhdGlvblR5cGUpIHsKICAgICAgICBjYXNlIF91dGlsLkFubm90YXRpb25FZGl0b3JUeXBlLkZSRUVURVhUOgogICAgICAgICAgcHJvbWlzZXMucHVzaChGcmVlVGV4dEFubm90YXRpb24uY3JlYXRlTmV3UHJpbnRBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIHsKICAgICAgICAgICAgZXZhbHVhdG9yLAogICAgICAgICAgICB0YXNrCiAgICAgICAgICB9KSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBfdXRpbC5Bbm5vdGF0aW9uRWRpdG9yVHlwZS5JTks6CiAgICAgICAgICBwcm9taXNlcy5wdXNoKElua0Fubm90YXRpb24uY3JlYXRlTmV3UHJpbnRBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24pKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTsKICB9Cgp9CgpleHBvcnRzLkFubm90YXRpb25GYWN0b3J5ID0gQW5ub3RhdGlvbkZhY3Rvcnk7CgpmdW5jdGlvbiBnZXRSZ2JDb2xvcihjb2xvciwgZGVmYXVsdENvbG9yID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KDMpKSB7CiAgaWYgKCFBcnJheS5pc0FycmF5KGNvbG9yKSkgewogICAgcmV0dXJuIGRlZmF1bHRDb2xvcjsKICB9CgogIGNvbnN0IHJnYkNvbG9yID0gZGVmYXVsdENvbG9yIHx8IG5ldyBVaW50OENsYW1wZWRBcnJheSgzKTsKCiAgc3dpdGNoIChjb2xvci5sZW5ndGgpIHsKICAgIGNhc2UgMDoKICAgICAgcmV0dXJuIG51bGw7CgogICAgY2FzZSAxOgogICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheS5nZXRSZ2JJdGVtKGNvbG9yLCAwLCByZ2JDb2xvciwgMCk7CgogICAgICByZXR1cm4gcmdiQ29sb3I7CgogICAgY2FzZSAzOgogICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYkl0ZW0oY29sb3IsIDAsIHJnYkNvbG9yLCAwKTsKCiAgICAgIHJldHVybiByZ2JDb2xvcjsKCiAgICBjYXNlIDQ6CiAgICAgIF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5jbXlrLmdldFJnYkl0ZW0oY29sb3IsIDAsIHJnYkNvbG9yLCAwKTsKCiAgICAgIHJldHVybiByZ2JDb2xvcjsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gZGVmYXVsdENvbG9yOwogIH0KfQoKZnVuY3Rpb24gZ2V0UXVhZFBvaW50cyhkaWN0LCByZWN0KSB7CiAgaWYgKCFkaWN0LmhhcygiUXVhZFBvaW50cyIpKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IHF1YWRQb2ludHMgPSBkaWN0LmdldEFycmF5KCJRdWFkUG9pbnRzIik7CgogIGlmICghQXJyYXkuaXNBcnJheShxdWFkUG9pbnRzKSB8fCBxdWFkUG9pbnRzLmxlbmd0aCA9PT0gMCB8fCBxdWFkUG9pbnRzLmxlbmd0aCAlIDggPiAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IHF1YWRQb2ludHNMaXN0cyA9IFtdOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBxdWFkUG9pbnRzLmxlbmd0aCAvIDg7IGkgPCBpaTsgaSsrKSB7CiAgICBxdWFkUG9pbnRzTGlzdHMucHVzaChbXSk7CgogICAgZm9yIChsZXQgaiA9IGkgKiA4LCBqaiA9IGkgKiA4ICsgODsgaiA8IGpqOyBqICs9IDIpIHsKICAgICAgY29uc3QgeCA9IHF1YWRQb2ludHNbal07CiAgICAgIGNvbnN0IHkgPSBxdWFkUG9pbnRzW2ogKyAxXTsKCiAgICAgIGlmIChyZWN0ICE9PSBudWxsICYmICh4IDwgcmVjdFswXSB8fCB4ID4gcmVjdFsyXSB8fCB5IDwgcmVjdFsxXSB8fCB5ID4gcmVjdFszXSkpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcXVhZFBvaW50c0xpc3RzW2ldLnB1c2goewogICAgICAgIHgsCiAgICAgICAgeQogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiBxdWFkUG9pbnRzTGlzdHMubWFwKHF1YWRQb2ludHNMaXN0ID0+IHsKICAgIGNvbnN0IFttaW5YLCBtYXhYLCBtaW5ZLCBtYXhZXSA9IHF1YWRQb2ludHNMaXN0LnJlZHVjZSgoW21YLCBNWCwgbVksIE1ZXSwgcXVhZFBvaW50KSA9PiBbTWF0aC5taW4obVgsIHF1YWRQb2ludC54KSwgTWF0aC5tYXgoTVgsIHF1YWRQb2ludC54KSwgTWF0aC5taW4obVksIHF1YWRQb2ludC55KSwgTWF0aC5tYXgoTVksIHF1YWRQb2ludC55KV0sIFtOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUlOX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUlOX1ZBTFVFXSk7CiAgICByZXR1cm4gW3sKICAgICAgeDogbWluWCwKICAgICAgeTogbWF4WQogICAgfSwgewogICAgICB4OiBtYXhYLAogICAgICB5OiBtYXhZCiAgICB9LCB7CiAgICAgIHg6IG1pblgsCiAgICAgIHk6IG1pblkKICAgIH0sIHsKICAgICAgeDogbWF4WCwKICAgICAgeTogbWluWQogICAgfV07CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldFRyYW5zZm9ybU1hdHJpeChyZWN0LCBiYm94LCBtYXRyaXgpIHsKICBjb25zdCBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gPSBfdXRpbC5VdGlsLmdldEF4aWFsQWxpZ25lZEJvdW5kaW5nQm94KGJib3gsIG1hdHJpeCk7CgogIGlmIChtaW5YID09PSBtYXhYIHx8IG1pblkgPT09IG1heFkpIHsKICAgIHJldHVybiBbMSwgMCwgMCwgMSwgcmVjdFswXSwgcmVjdFsxXV07CiAgfQoKICBjb25zdCB4UmF0aW8gPSAocmVjdFsyXSAtIHJlY3RbMF0pIC8gKG1heFggLSBtaW5YKTsKICBjb25zdCB5UmF0aW8gPSAocmVjdFszXSAtIHJlY3RbMV0pIC8gKG1heFkgLSBtaW5ZKTsKICByZXR1cm4gW3hSYXRpbywgMCwgMCwgeVJhdGlvLCByZWN0WzBdIC0gbWluWCAqIHhSYXRpbywgcmVjdFsxXSAtIG1pblkgKiB5UmF0aW9dOwp9CgpjbGFzcyBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIHRoaXMuc2V0VGl0bGUoZGljdC5nZXQoIlQiKSk7CiAgICB0aGlzLnNldENvbnRlbnRzKGRpY3QuZ2V0KCJDb250ZW50cyIpKTsKICAgIHRoaXMuc2V0TW9kaWZpY2F0aW9uRGF0ZShkaWN0LmdldCgiTSIpKTsKICAgIHRoaXMuc2V0RmxhZ3MoZGljdC5nZXQoIkYiKSk7CiAgICB0aGlzLnNldFJlY3RhbmdsZShkaWN0LmdldEFycmF5KCJSZWN0IikpOwogICAgdGhpcy5zZXRDb2xvcihkaWN0LmdldEFycmF5KCJDIikpOwogICAgdGhpcy5zZXRCb3JkZXJTdHlsZShkaWN0KTsKICAgIHRoaXMuc2V0QXBwZWFyYW5jZShkaWN0KTsKICAgIHRoaXMuc2V0T3B0aW9uYWxDb250ZW50KGRpY3QpOwogICAgY29uc3QgTUsgPSBkaWN0LmdldCgiTUsiKTsKICAgIHRoaXMuc2V0Qm9yZGVyQW5kQmFja2dyb3VuZENvbG9ycyhNSyk7CiAgICB0aGlzLnNldFJvdGF0aW9uKE1LKTsKICAgIHRoaXMuX3N0cmVhbXMgPSBbXTsKCiAgICBpZiAodGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuX3N0cmVhbXMucHVzaCh0aGlzLmFwcGVhcmFuY2UpOwogICAgfQoKICAgIHRoaXMuZGF0YSA9IHsKICAgICAgYW5ub3RhdGlvbkZsYWdzOiB0aGlzLmZsYWdzLAogICAgICBib3JkZXJTdHlsZTogdGhpcy5ib3JkZXJTdHlsZSwKICAgICAgY29sb3I6IHRoaXMuY29sb3IsCiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5iYWNrZ3JvdW5kQ29sb3IsCiAgICAgIGJvcmRlckNvbG9yOiB0aGlzLmJvcmRlckNvbG9yLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgY29udGVudHNPYmo6IHRoaXMuX2NvbnRlbnRzLAogICAgICBoYXNBcHBlYXJhbmNlOiAhIXRoaXMuYXBwZWFyYW5jZSwKICAgICAgaWQ6IHBhcmFtcy5pZCwKICAgICAgbW9kaWZpY2F0aW9uRGF0ZTogdGhpcy5tb2RpZmljYXRpb25EYXRlLAogICAgICByZWN0OiB0aGlzLnJlY3RhbmdsZSwKICAgICAgc3VidHlwZTogcGFyYW1zLnN1YnR5cGUsCiAgICAgIGhhc093bkNhbnZhczogZmFsc2UKICAgIH07CgogICAgaWYgKHBhcmFtcy5jb2xsZWN0RmllbGRzKSB7CiAgICAgIGNvbnN0IGtpZHMgPSBkaWN0LmdldCgiS2lkcyIpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoa2lkcykpIHsKICAgICAgICBjb25zdCBraWRJZHMgPSBbXTsKCiAgICAgICAgZm9yIChjb25zdCBraWQgb2Yga2lkcykgewogICAgICAgICAgaWYgKGtpZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICBraWRJZHMucHVzaChraWQudG9TdHJpbmcoKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoa2lkSWRzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgdGhpcy5kYXRhLmtpZElkcyA9IGtpZElkczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YS5hY3Rpb25zID0gKDAsIF9jb3JlX3V0aWxzLmNvbGxlY3RBY3Rpb25zKShwYXJhbXMueHJlZiwgZGljdCwgX3V0aWwuQW5ub3RhdGlvbkFjdGlvbkV2ZW50VHlwZSk7CiAgICAgIHRoaXMuZGF0YS5maWVsZE5hbWUgPSB0aGlzLl9jb25zdHJ1Y3RGaWVsZE5hbWUoZGljdCk7CiAgICAgIHRoaXMuZGF0YS5wYWdlSW5kZXggPSBwYXJhbXMucGFnZUluZGV4OwogICAgfQoKICAgIHRoaXMuX2ZhbGxiYWNrRm9udERpY3QgPSBudWxsOwogIH0KCiAgX2hhc0ZsYWcoZmxhZ3MsIGZsYWcpIHsKICAgIHJldHVybiAhIShmbGFncyAmIGZsYWcpOwogIH0KCiAgX2lzVmlld2FibGUoZmxhZ3MpIHsKICAgIHJldHVybiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSU5WSVNJQkxFKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuTk9WSUVXKTsKICB9CgogIF9pc1ByaW50YWJsZShmbGFncykgewogICAgcmV0dXJuIHRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLlBSSU5UKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSU5WSVNJQkxFKTsKICB9CgogIG11c3RCZVZpZXdlZChhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3Qgc3RvcmFnZUVudHJ5ID0gYW5ub3RhdGlvblN0b3JhZ2UgJiYgYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCk7CgogICAgaWYgKHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkuaGlkZGVuICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuICFzdG9yYWdlRW50cnkuaGlkZGVuOwogICAgfQoKICAgIHJldHVybiB0aGlzLnZpZXdhYmxlICYmICF0aGlzLl9oYXNGbGFnKHRoaXMuZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLkhJRERFTik7CiAgfQoKICBtdXN0QmVQcmludGVkKGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSAmJiBhbm5vdGF0aW9uU3RvcmFnZS5nZXQodGhpcy5kYXRhLmlkKTsKCiAgICBpZiAoc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5wcmludCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBzdG9yYWdlRW50cnkucHJpbnQ7CiAgICB9CgogICAgcmV0dXJuIHRoaXMucHJpbnRhYmxlOwogIH0KCiAgZ2V0IHZpZXdhYmxlKCkgewogICAgaWYgKHRoaXMuZGF0YS5xdWFkUG9pbnRzID09PSBudWxsKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5mbGFncyA9PT0gMCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5faXNWaWV3YWJsZSh0aGlzLmZsYWdzKTsKICB9CgogIGdldCBwcmludGFibGUoKSB7CiAgICBpZiAodGhpcy5kYXRhLnF1YWRQb2ludHMgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLmZsYWdzID09PSAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5faXNQcmludGFibGUodGhpcy5mbGFncyk7CiAgfQoKICBfcGFyc2VTdHJpbmdIZWxwZXIoZGF0YSkgewogICAgY29uc3Qgc3RyID0gdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkYXRhKSA6ICIiOwogICAgY29uc3QgZGlyID0gc3RyICYmICgwLCBfYmlkaS5iaWRpKShzdHIpLmRpciA9PT0gInJ0bCIgPyAicnRsIiA6ICJsdHIiOwogICAgcmV0dXJuIHsKICAgICAgc3RyLAogICAgICBkaXIKICAgIH07CiAgfQoKICBzZXRUaXRsZSh0aXRsZSkgewogICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wYXJzZVN0cmluZ0hlbHBlcih0aXRsZSk7CiAgfQoKICBzZXRDb250ZW50cyhjb250ZW50cykgewogICAgdGhpcy5fY29udGVudHMgPSB0aGlzLl9wYXJzZVN0cmluZ0hlbHBlcihjb250ZW50cyk7CiAgfQoKICBzZXRNb2RpZmljYXRpb25EYXRlKG1vZGlmaWNhdGlvbkRhdGUpIHsKICAgIHRoaXMubW9kaWZpY2F0aW9uRGF0ZSA9IHR5cGVvZiBtb2RpZmljYXRpb25EYXRlID09PSAic3RyaW5nIiA/IG1vZGlmaWNhdGlvbkRhdGUgOiBudWxsOwogIH0KCiAgc2V0RmxhZ3MoZmxhZ3MpIHsKICAgIHRoaXMuZmxhZ3MgPSBOdW1iZXIuaXNJbnRlZ2VyKGZsYWdzKSAmJiBmbGFncyA+IDAgPyBmbGFncyA6IDA7CiAgfQoKICBoYXNGbGFnKGZsYWcpIHsKICAgIHJldHVybiB0aGlzLl9oYXNGbGFnKHRoaXMuZmxhZ3MsIGZsYWcpOwogIH0KCiAgc2V0UmVjdGFuZ2xlKHJlY3RhbmdsZSkgewogICAgaWYgKEFycmF5LmlzQXJyYXkocmVjdGFuZ2xlKSAmJiByZWN0YW5nbGUubGVuZ3RoID09PSA0KSB7CiAgICAgIHRoaXMucmVjdGFuZ2xlID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KHJlY3RhbmdsZSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlY3RhbmdsZSA9IFswLCAwLCAwLCAwXTsKICAgIH0KICB9CgogIHNldENvbG9yKGNvbG9yKSB7CiAgICB0aGlzLmNvbG9yID0gZ2V0UmdiQ29sb3IoY29sb3IpOwogIH0KCiAgc2V0TGluZUVuZGluZ3MobGluZUVuZGluZ3MpIHsKICAgIHRoaXMubGluZUVuZGluZ3MgPSBbIk5vbmUiLCAiTm9uZSJdOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmVFbmRpbmdzKSAmJiBsaW5lRW5kaW5ncy5sZW5ndGggPT09IDIpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICBjb25zdCBvYmogPSBsaW5lRW5kaW5nc1tpXTsKCiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIHN3aXRjaCAob2JqLm5hbWUpIHsKICAgICAgICAgICAgY2FzZSAiTm9uZSI6CiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBjYXNlICJTcXVhcmUiOgogICAgICAgICAgICBjYXNlICJDaXJjbGUiOgogICAgICAgICAgICBjYXNlICJEaWFtb25kIjoKICAgICAgICAgICAgY2FzZSAiT3BlbkFycm93IjoKICAgICAgICAgICAgY2FzZSAiQ2xvc2VkQXJyb3ciOgogICAgICAgICAgICBjYXNlICJCdXR0IjoKICAgICAgICAgICAgY2FzZSAiUk9wZW5BcnJvdyI6CiAgICAgICAgICAgIGNhc2UgIlJDbG9zZWRBcnJvdyI6CiAgICAgICAgICAgIGNhc2UgIlNsYXNoIjoKICAgICAgICAgICAgICB0aGlzLmxpbmVFbmRpbmdzW2ldID0gb2JqLm5hbWU7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoYElnbm9yaW5nIGludmFsaWQgbGluZUVuZGluZzogJHtvYmp9YCk7CiAgICAgIH0KICAgIH0KICB9CgogIHNldFJvdGF0aW9uKG1rKSB7CiAgICB0aGlzLnJvdGF0aW9uID0gMDsKCiAgICBpZiAobWsgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIGxldCBhbmdsZSA9IG1rLmdldCgiUiIpIHx8IDA7CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihhbmdsZSkgJiYgYW5nbGUgIT09IDApIHsKICAgICAgICBhbmdsZSAlPSAzNjA7CgogICAgICAgIGlmIChhbmdsZSA8IDApIHsKICAgICAgICAgIGFuZ2xlICs9IDM2MDsKICAgICAgICB9CgogICAgICAgIGlmIChhbmdsZSAlIDkwID09PSAwKSB7CiAgICAgICAgICB0aGlzLnJvdGF0aW9uID0gYW5nbGU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBzZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQ29sb3JzKG1rKSB7CiAgICBpZiAobWsgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBnZXRSZ2JDb2xvcihtay5nZXRBcnJheSgiQkMiKSwgbnVsbCk7CiAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gZ2V0UmdiQ29sb3IobWsuZ2V0QXJyYXkoIkJHIiksIG51bGwpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IHRoaXMuYmFja2dyb3VuZENvbG9yID0gbnVsbDsKICAgIH0KICB9CgogIHNldEJvcmRlclN0eWxlKGJvcmRlclN0eWxlKSB7CiAgICB0aGlzLmJvcmRlclN0eWxlID0gbmV3IEFubm90YXRpb25Cb3JkZXJTdHlsZSgpOwoKICAgIGlmICghKGJvcmRlclN0eWxlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChib3JkZXJTdHlsZS5oYXMoIkJTIikpIHsKICAgICAgY29uc3QgZGljdCA9IGJvcmRlclN0eWxlLmdldCgiQlMiKTsKICAgICAgY29uc3QgZGljdFR5cGUgPSBkaWN0LmdldCgiVHlwZSIpOwoKICAgICAgaWYgKCFkaWN0VHlwZSB8fCAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShkaWN0VHlwZSwgIkJvcmRlciIpKSB7CiAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRXaWR0aChkaWN0LmdldCgiVyIpLCB0aGlzLnJlY3RhbmdsZSk7CiAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRTdHlsZShkaWN0LmdldCgiUyIpKTsKICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldERhc2hBcnJheShkaWN0LmdldEFycmF5KCJEIikpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGJvcmRlclN0eWxlLmhhcygiQm9yZGVyIikpIHsKICAgICAgY29uc3QgYXJyYXkgPSBib3JkZXJTdHlsZS5nZXRBcnJheSgiQm9yZGVyIik7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnJheSkgJiYgYXJyYXkubGVuZ3RoID49IDMpIHsKICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldEhvcml6b250YWxDb3JuZXJSYWRpdXMoYXJyYXlbMF0pOwogICAgICAgIHRoaXMuYm9yZGVyU3R5bGUuc2V0VmVydGljYWxDb3JuZXJSYWRpdXMoYXJyYXlbMV0pOwogICAgICAgIHRoaXMuYm9yZGVyU3R5bGUuc2V0V2lkdGgoYXJyYXlbMl0sIHRoaXMucmVjdGFuZ2xlKTsKCiAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gNCkgewogICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXREYXNoQXJyYXkoYXJyYXlbM10sIHRydWUpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRXaWR0aCgwKTsKICAgIH0KICB9CgogIHNldEFwcGVhcmFuY2UoZGljdCkgewogICAgdGhpcy5hcHBlYXJhbmNlID0gbnVsbDsKICAgIGNvbnN0IGFwcGVhcmFuY2VTdGF0ZXMgPSBkaWN0LmdldCgiQVAiKTsKCiAgICBpZiAoIShhcHBlYXJhbmNlU3RhdGVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSA9IGFwcGVhcmFuY2VTdGF0ZXMuZ2V0KCJOIik7CgogICAgaWYgKG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgIHRoaXMuYXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghKG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBhcyA9IGRpY3QuZ2V0KCJBUyIpOwoKICAgIGlmICghKGFzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgfHwgIW5vcm1hbEFwcGVhcmFuY2VTdGF0ZS5oYXMoYXMubmFtZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuYXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZS5nZXQoYXMubmFtZSk7CiAgfQoKICBzZXRPcHRpb25hbENvbnRlbnQoZGljdCkgewogICAgdGhpcy5vYyA9IG51bGw7CiAgICBjb25zdCBvYyA9IGRpY3QuZ2V0KCJPQyIpOwoKICAgIGlmIChvYyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJzZXRPcHRpb25hbENvbnRlbnQ6IFN1cHBvcnQgZm9yIC9OYW1lLWVudHJ5IGlzIG5vdCBpbXBsZW1lbnRlZC4iKTsKICAgIH0gZWxzZSBpZiAob2MgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHRoaXMub2MgPSBvYzsKICAgIH0KICB9CgogIGxvYWRSZXNvdXJjZXMoa2V5cywgYXBwZWFyYW5jZSkgewogICAgcmV0dXJuIGFwcGVhcmFuY2UuZGljdC5nZXRBc3luYygiUmVzb3VyY2VzIikudGhlbihyZXNvdXJjZXMgPT4gewogICAgICBpZiAoIXJlc291cmNlcykgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIGNvbnN0IG9iamVjdExvYWRlciA9IG5ldyBfb2JqZWN0X2xvYWRlci5PYmplY3RMb2FkZXIocmVzb3VyY2VzLCBrZXlzLCByZXNvdXJjZXMueHJlZik7CiAgICAgIHJldHVybiBvYmplY3RMb2FkZXIubG9hZCgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiByZXNvdXJjZXM7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBhc3luYyBnZXRPcGVyYXRvckxpc3QoZXZhbHVhdG9yLCB0YXNrLCBpbnRlbnQsIHJlbmRlckZvcm1zLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgIGxldCBhcHBlYXJhbmNlID0gdGhpcy5hcHBlYXJhbmNlOwogICAgY29uc3QgaXNVc2luZ093bkNhbnZhcyA9ICEhKHRoaXMuZGF0YS5oYXNPd25DYW52YXMgJiYgaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5ESVNQTEFZKTsKCiAgICBpZiAoIWFwcGVhcmFuY2UpIHsKICAgICAgaWYgKCFpc1VzaW5nT3duQ2FudmFzKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG9wTGlzdDogbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpLAogICAgICAgICAgc2VwYXJhdGVGb3JtOiBmYWxzZSwKICAgICAgICAgIHNlcGFyYXRlQ2FudmFzOiBmYWxzZQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGFwcGVhcmFuY2UgPSBuZXcgX3N0cmVhbS5TdHJpbmdTdHJlYW0oIiIpOwogICAgICBhcHBlYXJhbmNlLmRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCgpOwogICAgfQoKICAgIGNvbnN0IGFwcGVhcmFuY2VEaWN0ID0gYXBwZWFyYW5jZS5kaWN0OwogICAgY29uc3QgcmVzb3VyY2VzID0gYXdhaXQgdGhpcy5sb2FkUmVzb3VyY2VzKFsiRXh0R1N0YXRlIiwgIkNvbG9yU3BhY2UiLCAiUGF0dGVybiIsICJTaGFkaW5nIiwgIlhPYmplY3QiLCAiRm9udCJdLCBhcHBlYXJhbmNlKTsKICAgIGNvbnN0IGJib3ggPSBhcHBlYXJhbmNlRGljdC5nZXRBcnJheSgiQkJveCIpIHx8IFswLCAwLCAxLCAxXTsKICAgIGNvbnN0IG1hdHJpeCA9IGFwcGVhcmFuY2VEaWN0LmdldEFycmF5KCJNYXRyaXgiKSB8fCBbMSwgMCwgMCwgMSwgMCwgMF07CiAgICBjb25zdCB0cmFuc2Zvcm0gPSBnZXRUcmFuc2Zvcm1NYXRyaXgoZGF0YS5yZWN0LCBiYm94LCBtYXRyaXgpOwogICAgY29uc3Qgb3BMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgbGV0IG9wdGlvbmFsQ29udGVudDsKCiAgICBpZiAodGhpcy5vYykgewogICAgICBvcHRpb25hbENvbnRlbnQgPSBhd2FpdCBldmFsdWF0b3IucGFyc2VNYXJrZWRDb250ZW50UHJvcHModGhpcy5vYywgbnVsbCk7CiAgICB9CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHMsIFsiT0MiLCBvcHRpb25hbENvbnRlbnRdKTsKICAgIH0KCiAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luQW5ub3RhdGlvbiwgW2RhdGEuaWQsIGRhdGEucmVjdCwgdHJhbnNmb3JtLCBtYXRyaXgsIGlzVXNpbmdPd25DYW52YXNdKTsKICAgIGF3YWl0IGV2YWx1YXRvci5nZXRPcGVyYXRvckxpc3QoewogICAgICBzdHJlYW06IGFwcGVhcmFuY2UsCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlcywKICAgICAgb3BlcmF0b3JMaXN0OiBvcExpc3QsCiAgICAgIGZhbGxiYWNrRm9udERpY3Q6IHRoaXMuX2ZhbGxiYWNrRm9udERpY3QKICAgIH0pOwogICAgb3BMaXN0LmFkZE9wKF91dGlsLk9QUy5lbmRBbm5vdGF0aW9uLCBbXSk7CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kTWFya2VkQ29udGVudCwgW10pOwogICAgfQoKICAgIHRoaXMucmVzZXQoKTsKICAgIHJldHVybiB7CiAgICAgIG9wTGlzdCwKICAgICAgc2VwYXJhdGVGb3JtOiBmYWxzZSwKICAgICAgc2VwYXJhdGVDYW52YXM6IGlzVXNpbmdPd25DYW52YXMKICAgIH07CiAgfQoKICBhc3luYyBzYXZlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgZ2V0IGhhc1RleHRDb250ZW50KCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgYXN5bmMgZXh0cmFjdFRleHRDb250ZW50KGV2YWx1YXRvciwgdGFzaywgdmlld0JveCkgewogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJlc291cmNlcyA9IGF3YWl0IHRoaXMubG9hZFJlc291cmNlcyhbIkV4dEdTdGF0ZSIsICJGb250IiwgIlByb3BlcnRpZXMiLCAiWE9iamVjdCJdLCB0aGlzLmFwcGVhcmFuY2UpOwogICAgY29uc3QgdGV4dCA9IFtdOwogICAgY29uc3QgYnVmZmVyID0gW107CiAgICBjb25zdCBzaW5rID0gewogICAgICBkZXNpcmVkU2l6ZTogTWF0aC5JbmZpbml0eSwKICAgICAgcmVhZHk6IHRydWUsCgogICAgICBlbnF1ZXVlKGNodW5rLCBzaXplKSB7CiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGNodW5rLml0ZW1zKSB7CiAgICAgICAgICBidWZmZXIucHVzaChpdGVtLnN0cik7CgogICAgICAgICAgaWYgKGl0ZW0uaGFzRU9MKSB7CiAgICAgICAgICAgIHRleHQucHVzaChidWZmZXIuam9pbigiIikpOwogICAgICAgICAgICBidWZmZXIubGVuZ3RoID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICB9OwogICAgYXdhaXQgZXZhbHVhdG9yLmdldFRleHRDb250ZW50KHsKICAgICAgc3RyZWFtOiB0aGlzLmFwcGVhcmFuY2UsCiAgICAgIHRhc2ssCiAgICAgIHJlc291cmNlcywKICAgICAgaW5jbHVkZU1hcmtlZENvbnRlbnQ6IHRydWUsCiAgICAgIGNvbWJpbmVUZXh0SXRlbXM6IHRydWUsCiAgICAgIHNpbmssCiAgICAgIHZpZXdCb3gKICAgIH0pOwogICAgdGhpcy5yZXNldCgpOwoKICAgIGlmIChidWZmZXIubGVuZ3RoKSB7CiAgICAgIHRleHQucHVzaChidWZmZXIuam9pbigiIikpOwogICAgfQoKICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHsKICAgICAgdGhpcy5kYXRhLnRleHRDb250ZW50ID0gdGV4dDsKICAgIH0KICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgaWYgKHRoaXMuZGF0YS5raWRJZHMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogdGhpcy5kYXRhLmlkLAogICAgICAgIGFjdGlvbnM6IHRoaXMuZGF0YS5hY3Rpb25zLAogICAgICAgIG5hbWU6IHRoaXMuZGF0YS5maWVsZE5hbWUsCiAgICAgICAgc3Ryb2tlQ29sb3I6IHRoaXMuZGF0YS5ib3JkZXJDb2xvciwKICAgICAgICBmaWxsQ29sb3I6IHRoaXMuZGF0YS5iYWNrZ3JvdW5kQ29sb3IsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAga2lkSWRzOiB0aGlzLmRhdGEua2lkSWRzLAogICAgICAgIHBhZ2U6IHRoaXMuZGF0YS5wYWdlSW5kZXgsCiAgICAgICAgcm90YXRpb246IHRoaXMucm90YXRpb24KICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIHJlc2V0KCkgewogICAgZm9yIChjb25zdCBzdHJlYW0gb2YgdGhpcy5fc3RyZWFtcykgewogICAgICBzdHJlYW0ucmVzZXQoKTsKICAgIH0KICB9CgogIF9jb25zdHJ1Y3RGaWVsZE5hbWUoZGljdCkgewogICAgaWYgKCFkaWN0LmhhcygiVCIpICYmICFkaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmtub3duIGZpZWxkIG5hbWUsIGZhbGxpbmcgYmFjayB0byBlbXB0eSBmaWVsZCBuYW1lLiIpOwogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgaWYgKCFkaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGljdC5nZXQoIlQiKSk7CiAgICB9CgogICAgY29uc3QgZmllbGROYW1lID0gW107CgogICAgaWYgKGRpY3QuaGFzKCJUIikpIHsKICAgICAgZmllbGROYW1lLnVuc2hpZnQoKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpKSk7CiAgICB9CgogICAgbGV0IGxvb3BEaWN0ID0gZGljdDsKICAgIGNvbnN0IHZpc2l0ZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CgogICAgaWYgKGRpY3Qub2JqSWQpIHsKICAgICAgdmlzaXRlZC5wdXQoZGljdC5vYmpJZCk7CiAgICB9CgogICAgd2hpbGUgKGxvb3BEaWN0LmhhcygiUGFyZW50IikpIHsKICAgICAgbG9vcERpY3QgPSBsb29wRGljdC5nZXQoIlBhcmVudCIpOwoKICAgICAgaWYgKCEobG9vcERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB8fCBsb29wRGljdC5vYmpJZCAmJiB2aXNpdGVkLmhhcyhsb29wRGljdC5vYmpJZCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKGxvb3BEaWN0Lm9iaklkKSB7CiAgICAgICAgdmlzaXRlZC5wdXQobG9vcERpY3Qub2JqSWQpOwogICAgICB9CgogICAgICBpZiAobG9vcERpY3QuaGFzKCJUIikpIHsKICAgICAgICBmaWVsZE5hbWUudW5zaGlmdCgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxvb3BEaWN0LmdldCgiVCIpKSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmllbGROYW1lLmpvaW4oIi4iKTsKICB9Cgp9CgpleHBvcnRzLkFubm90YXRpb24gPSBBbm5vdGF0aW9uOwoKY2xhc3MgQW5ub3RhdGlvbkJvcmRlclN0eWxlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMud2lkdGggPSAxOwogICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuU09MSUQ7CiAgICB0aGlzLmRhc2hBcnJheSA9IFszXTsKICAgIHRoaXMuaG9yaXpvbnRhbENvcm5lclJhZGl1cyA9IDA7CiAgICB0aGlzLnZlcnRpY2FsQ29ybmVyUmFkaXVzID0gMDsKICB9CgogIHNldFdpZHRoKHdpZHRoLCByZWN0ID0gWzAsIDAsIDAsIDBdKSB7CiAgICBpZiAod2lkdGggaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHRoaXMud2lkdGggPSAwOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHR5cGVvZiB3aWR0aCA9PT0gIm51bWJlciIpIHsKICAgICAgaWYgKHdpZHRoID4gMCkgewogICAgICAgIGNvbnN0IG1heFdpZHRoID0gKHJlY3RbMl0gLSByZWN0WzBdKSAvIDI7CiAgICAgICAgY29uc3QgbWF4SGVpZ2h0ID0gKHJlY3RbM10gLSByZWN0WzFdKSAvIDI7CgogICAgICAgIGlmIChtYXhXaWR0aCA+IDAgJiYgbWF4SGVpZ2h0ID4gMCAmJiAod2lkdGggPiBtYXhXaWR0aCB8fCB3aWR0aCA+IG1heEhlaWdodCkpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgQW5ub3RhdGlvbkJvcmRlclN0eWxlLnNldFdpZHRoIC0gaWdub3Jpbmcgd2lkdGg6ICR7d2lkdGh9YCk7CiAgICAgICAgICB3aWR0aCA9IDE7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICB9CiAgfQoKICBzZXRTdHlsZShzdHlsZSkgewogICAgaWYgKCEoc3R5bGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoIChzdHlsZS5uYW1lKSB7CiAgICAgIGNhc2UgIlMiOgogICAgICAgIHRoaXMuc3R5bGUgPSBfdXRpbC5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlLlNPTElEOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiRCI6CiAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuREFTSEVEOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiQiI6CiAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuQkVWRUxFRDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIkkiOgogICAgICAgIHRoaXMuc3R5bGUgPSBfdXRpbC5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlLklOU0VUOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiVSI6CiAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuVU5ERVJMSU5FOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHNldERhc2hBcnJheShkYXNoQXJyYXksIGZvcmNlU3R5bGUgPSBmYWxzZSkgewogICAgaWYgKEFycmF5LmlzQXJyYXkoZGFzaEFycmF5KSAmJiBkYXNoQXJyYXkubGVuZ3RoID4gMCkgewogICAgICBsZXQgaXNWYWxpZCA9IHRydWU7CiAgICAgIGxldCBhbGxaZXJvcyA9IHRydWU7CgogICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZGFzaEFycmF5KSB7CiAgICAgICAgY29uc3QgdmFsaWROdW1iZXIgPSArZWxlbWVudCA+PSAwOwoKICAgICAgICBpZiAoIXZhbGlkTnVtYmVyKSB7CiAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQgPiAwKSB7CiAgICAgICAgICBhbGxaZXJvcyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGlzVmFsaWQgJiYgIWFsbFplcm9zKSB7CiAgICAgICAgdGhpcy5kYXNoQXJyYXkgPSBkYXNoQXJyYXk7CgogICAgICAgIGlmIChmb3JjZVN0eWxlKSB7CiAgICAgICAgICB0aGlzLnNldFN0eWxlKF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJEIikpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLndpZHRoID0gMDsKICAgICAgfQogICAgfSBlbHNlIGlmIChkYXNoQXJyYXkpIHsKICAgICAgdGhpcy53aWR0aCA9IDA7CiAgICB9CiAgfQoKICBzZXRIb3Jpem9udGFsQ29ybmVyUmFkaXVzKHJhZGl1cykgewogICAgaWYgKE51bWJlci5pc0ludGVnZXIocmFkaXVzKSkgewogICAgICB0aGlzLmhvcml6b250YWxDb3JuZXJSYWRpdXMgPSByYWRpdXM7CiAgICB9CiAgfQoKICBzZXRWZXJ0aWNhbENvcm5lclJhZGl1cyhyYWRpdXMpIHsKICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHJhZGl1cykpIHsKICAgICAgdGhpcy52ZXJ0aWNhbENvcm5lclJhZGl1cyA9IHJhZGl1czsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkFubm90YXRpb25Cb3JkZXJTdHlsZSA9IEFubm90YXRpb25Cb3JkZXJTdHlsZTsKCmNsYXNzIE1hcmt1cEFubm90YXRpb24gZXh0ZW5kcyBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbWV0ZXJzLmRpY3Q7CgogICAgaWYgKGRpY3QuaGFzKCJJUlQiKSkgewogICAgICBjb25zdCByYXdJUlQgPSBkaWN0LmdldFJhdygiSVJUIik7CiAgICAgIHRoaXMuZGF0YS5pblJlcGx5VG8gPSByYXdJUlQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgPyByYXdJUlQudG9TdHJpbmcoKSA6IG51bGw7CiAgICAgIGNvbnN0IHJ0ID0gZGljdC5nZXQoIlJUIik7CiAgICAgIHRoaXMuZGF0YS5yZXBseVR5cGUgPSBydCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUgPyBydC5uYW1lIDogX3V0aWwuQW5ub3RhdGlvblJlcGx5VHlwZS5SRVBMWTsKICAgIH0KCiAgICBpZiAodGhpcy5kYXRhLnJlcGx5VHlwZSA9PT0gX3V0aWwuQW5ub3RhdGlvblJlcGx5VHlwZS5HUk9VUCkgewogICAgICBjb25zdCBwYXJlbnQgPSBkaWN0LmdldCgiSVJUIik7CiAgICAgIHRoaXMuc2V0VGl0bGUocGFyZW50LmdldCgiVCIpKTsKICAgICAgdGhpcy5kYXRhLnRpdGxlT2JqID0gdGhpcy5fdGl0bGU7CiAgICAgIHRoaXMuc2V0Q29udGVudHMocGFyZW50LmdldCgiQ29udGVudHMiKSk7CiAgICAgIHRoaXMuZGF0YS5jb250ZW50c09iaiA9IHRoaXMuX2NvbnRlbnRzOwoKICAgICAgaWYgKCFwYXJlbnQuaGFzKCJDcmVhdGlvbkRhdGUiKSkgewogICAgICAgIHRoaXMuZGF0YS5jcmVhdGlvbkRhdGUgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2V0Q3JlYXRpb25EYXRlKHBhcmVudC5nZXQoIkNyZWF0aW9uRGF0ZSIpKTsKICAgICAgICB0aGlzLmRhdGEuY3JlYXRpb25EYXRlID0gdGhpcy5jcmVhdGlvbkRhdGU7CiAgICAgIH0KCiAgICAgIGlmICghcGFyZW50LmhhcygiTSIpKSB7CiAgICAgICAgdGhpcy5kYXRhLm1vZGlmaWNhdGlvbkRhdGUgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2V0TW9kaWZpY2F0aW9uRGF0ZShwYXJlbnQuZ2V0KCJNIikpOwogICAgICAgIHRoaXMuZGF0YS5tb2RpZmljYXRpb25EYXRlID0gdGhpcy5tb2RpZmljYXRpb25EYXRlOwogICAgICB9CgogICAgICB0aGlzLmRhdGEuaGFzUG9wdXAgPSBwYXJlbnQuaGFzKCJQb3B1cCIpOwoKICAgICAgaWYgKCFwYXJlbnQuaGFzKCJDIikpIHsKICAgICAgICB0aGlzLmRhdGEuY29sb3IgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2V0Q29sb3IocGFyZW50LmdldEFycmF5KCJDIikpOwogICAgICAgIHRoaXMuZGF0YS5jb2xvciA9IHRoaXMuY29sb3I7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS50aXRsZU9iaiA9IHRoaXMuX3RpdGxlOwogICAgICB0aGlzLnNldENyZWF0aW9uRGF0ZShkaWN0LmdldCgiQ3JlYXRpb25EYXRlIikpOwogICAgICB0aGlzLmRhdGEuY3JlYXRpb25EYXRlID0gdGhpcy5jcmVhdGlvbkRhdGU7CiAgICAgIHRoaXMuZGF0YS5oYXNQb3B1cCA9IGRpY3QuaGFzKCJQb3B1cCIpOwoKICAgICAgaWYgKCFkaWN0LmhhcygiQyIpKSB7CiAgICAgICAgdGhpcy5kYXRhLmNvbG9yID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmIChkaWN0LmhhcygiUkMiKSkgewogICAgICB0aGlzLmRhdGEucmljaFRleHQgPSBfZmFjdG9yeS5YRkFGYWN0b3J5LmdldFJpY2hUZXh0QXNIdG1sKGRpY3QuZ2V0KCJSQyIpKTsKICAgIH0KICB9CgogIHNldENyZWF0aW9uRGF0ZShjcmVhdGlvbkRhdGUpIHsKICAgIHRoaXMuY3JlYXRpb25EYXRlID0gdHlwZW9mIGNyZWF0aW9uRGF0ZSA9PT0gInN0cmluZyIgPyBjcmVhdGlvbkRhdGUgOiBudWxsOwogIH0KCiAgX3NldERlZmF1bHRBcHBlYXJhbmNlKHsKICAgIHhyZWYsCiAgICBleHRyYSwKICAgIHN0cm9rZUNvbG9yLAogICAgZmlsbENvbG9yLAogICAgYmxlbmRNb2RlLAogICAgc3Ryb2tlQWxwaGEsCiAgICBmaWxsQWxwaGEsCiAgICBwb2ludHNDYWxsYmFjawogIH0pIHsKICAgIGxldCBtaW5YID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtaW5ZID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtYXhYID0gTnVtYmVyLk1JTl9WQUxVRTsKICAgIGxldCBtYXhZID0gTnVtYmVyLk1JTl9WQUxVRTsKICAgIGNvbnN0IGJ1ZmZlciA9IFsicSJdOwoKICAgIGlmIChleHRyYSkgewogICAgICBidWZmZXIucHVzaChleHRyYSk7CiAgICB9CgogICAgaWYgKHN0cm9rZUNvbG9yKSB7CiAgICAgIGJ1ZmZlci5wdXNoKGAke3N0cm9rZUNvbG9yWzBdfSAke3N0cm9rZUNvbG9yWzFdfSAke3N0cm9rZUNvbG9yWzJdfSBSR2ApOwogICAgfQoKICAgIGlmIChmaWxsQ29sb3IpIHsKICAgICAgYnVmZmVyLnB1c2goYCR7ZmlsbENvbG9yWzBdfSAke2ZpbGxDb2xvclsxXX0gJHtmaWxsQ29sb3JbMl19IHJnYCk7CiAgICB9CgogICAgbGV0IHBvaW50c0FycmF5ID0gdGhpcy5kYXRhLnF1YWRQb2ludHM7CgogICAgaWYgKCFwb2ludHNBcnJheSkgewogICAgICBwb2ludHNBcnJheSA9IFtbewogICAgICAgIHg6IHRoaXMucmVjdGFuZ2xlWzBdLAogICAgICAgIHk6IHRoaXMucmVjdGFuZ2xlWzNdCiAgICAgIH0sIHsKICAgICAgICB4OiB0aGlzLnJlY3RhbmdsZVsyXSwKICAgICAgICB5OiB0aGlzLnJlY3RhbmdsZVszXQogICAgICB9LCB7CiAgICAgICAgeDogdGhpcy5yZWN0YW5nbGVbMF0sCiAgICAgICAgeTogdGhpcy5yZWN0YW5nbGVbMV0KICAgICAgfSwgewogICAgICAgIHg6IHRoaXMucmVjdGFuZ2xlWzJdLAogICAgICAgIHk6IHRoaXMucmVjdGFuZ2xlWzFdCiAgICAgIH1dXTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IHBvaW50cyBvZiBwb2ludHNBcnJheSkgewogICAgICBjb25zdCBbbVgsIE1YLCBtWSwgTVldID0gcG9pbnRzQ2FsbGJhY2soYnVmZmVyLCBwb2ludHMpOwogICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgbVgpOwogICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgTVgpOwogICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgbVkpOwogICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgTVkpOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKCJRIik7CiAgICBjb25zdCBmb3JtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgY29uc3QgYXBwZWFyYW5jZVN0cmVhbURpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiU3VidHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJGb3JtIikpOwogICAgY29uc3QgYXBwZWFyYW5jZVN0cmVhbSA9IG5ldyBfc3RyZWFtLlN0cmluZ1N0cmVhbShidWZmZXIuam9pbigiICIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW0uZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwogICAgZm9ybURpY3Quc2V0KCJGbTAiLCBhcHBlYXJhbmNlU3RyZWFtKTsKICAgIGNvbnN0IGdzRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwoKICAgIGlmIChibGVuZE1vZGUpIHsKICAgICAgZ3NEaWN0LnNldCgiQk0iLCBfcHJpbWl0aXZlcy5OYW1lLmdldChibGVuZE1vZGUpKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIHN0cm9rZUFscGhhID09PSAibnVtYmVyIikgewogICAgICBnc0RpY3Quc2V0KCJDQSIsIHN0cm9rZUFscGhhKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGZpbGxBbHBoYSA9PT0gIm51bWJlciIpIHsKICAgICAgZ3NEaWN0LnNldCgiY2EiLCBmaWxsQWxwaGEpOwogICAgfQoKICAgIGNvbnN0IHN0YXRlRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgc3RhdGVEaWN0LnNldCgiR1MwIiwgZ3NEaWN0KTsKICAgIGNvbnN0IHJlc291cmNlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgcmVzb3VyY2VzLnNldCgiRXh0R1N0YXRlIiwgc3RhdGVEaWN0KTsKICAgIHJlc291cmNlcy5zZXQoIlhPYmplY3QiLCBmb3JtRGljdCk7CiAgICBjb25zdCBhcHBlYXJhbmNlRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJSZXNvdXJjZXMiLCByZXNvdXJjZXMpOwogICAgY29uc3QgYmJveCA9IHRoaXMuZGF0YS5yZWN0ID0gW21pblgsIG1pblksIG1heFgsIG1heFldOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJCQm94IiwgYmJveCk7CiAgICB0aGlzLmFwcGVhcmFuY2UgPSBuZXcgX3N0cmVhbS5TdHJpbmdTdHJlYW0oIi9HUzAgZ3MgL0ZtMCBEbyIpOwogICAgdGhpcy5hcHBlYXJhbmNlLmRpY3QgPSBhcHBlYXJhbmNlRGljdDsKCiAgICB0aGlzLl9zdHJlYW1zLnB1c2godGhpcy5hcHBlYXJhbmNlLCBhcHBlYXJhbmNlU3RyZWFtKTsKICB9CgogIHN0YXRpYyBhc3luYyBjcmVhdGVOZXdBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIGRlcGVuZGVuY2llcywgcGFyYW1zKSB7CiAgICBjb25zdCBhbm5vdGF0aW9uUmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgIGNvbnN0IGFwUmVmID0geHJlZi5nZXROZXdSZWYoKTsKICAgIGNvbnN0IGFubm90YXRpb25EaWN0ID0gdGhpcy5jcmVhdGVOZXdEaWN0KGFubm90YXRpb24sIHhyZWYsIHsKICAgICAgYXBSZWYKICAgIH0pOwogICAgY29uc3QgYXAgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKTsKICAgIGNvbnN0IGJ1ZmZlciA9IFtdOwogICAgbGV0IHRyYW5zZm9ybSA9IHhyZWYuZW5jcnlwdCA/IHhyZWYuZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0oYXBSZWYubnVtLCBhcFJlZi5nZW4pIDogbnVsbDsKICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KShhcFJlZiwgYXAsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICAgIGRlcGVuZGVuY2llcy5wdXNoKHsKICAgICAgcmVmOiBhcFJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpCiAgICB9KTsKICAgIGJ1ZmZlci5sZW5ndGggPSAwOwogICAgdHJhbnNmb3JtID0geHJlZi5lbmNyeXB0ID8geHJlZi5lbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShhbm5vdGF0aW9uUmVmLm51bSwgYW5ub3RhdGlvblJlZi5nZW4pIDogbnVsbDsKICAgICgwLCBfd3JpdGVyLndyaXRlT2JqZWN0KShhbm5vdGF0aW9uUmVmLCBhbm5vdGF0aW9uRGljdCwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogICAgcmV0dXJuIHsKICAgICAgcmVmOiBhbm5vdGF0aW9uUmVmLAogICAgICBkYXRhOiBidWZmZXIuam9pbigiIikKICAgIH07CiAgfQoKICBzdGF0aWMgYXN5bmMgY3JlYXRlTmV3UHJpbnRBbm5vdGF0aW9uKHhyZWYsIGFubm90YXRpb24sIHBhcmFtcykgewogICAgY29uc3QgYXAgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKTsKICAgIGNvbnN0IGFubm90YXRpb25EaWN0ID0gdGhpcy5jcmVhdGVOZXdEaWN0KGFubm90YXRpb24sIHhyZWYsIHsKICAgICAgYXAKICAgIH0pOwogICAgcmV0dXJuIG5ldyB0aGlzLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcih7CiAgICAgIGRpY3Q6IGFubm90YXRpb25EaWN0LAogICAgICB4cmVmCiAgICB9KTsKICB9Cgp9CgpleHBvcnRzLk1hcmt1cEFubm90YXRpb24gPSBNYXJrdXBBbm5vdGF0aW9uOwoKY2xhc3MgV2lkZ2V0QW5ub3RhdGlvbiBleHRlbmRzIEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtcykgewogICAgc3VwZXIocGFyYW1zKTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICB0aGlzLnJlZiA9IHBhcmFtcy5yZWY7CiAgICBkYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuV0lER0VUOwoKICAgIGlmIChkYXRhLmZpZWxkTmFtZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGRhdGEuZmllbGROYW1lID0gdGhpcy5fY29uc3RydWN0RmllbGROYW1lKGRpY3QpOwogICAgfQoKICAgIGlmIChkYXRhLmFjdGlvbnMgPT09IHVuZGVmaW5lZCkgewogICAgICBkYXRhLmFjdGlvbnMgPSAoMCwgX2NvcmVfdXRpbHMuY29sbGVjdEFjdGlvbnMpKHBhcmFtcy54cmVmLCBkaWN0LCBfdXRpbC5Bbm5vdGF0aW9uQWN0aW9uRXZlbnRUeXBlKTsKICAgIH0KCiAgICBsZXQgZmllbGRWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIlYiLAogICAgICBnZXRBcnJheTogdHJ1ZQogICAgfSk7CiAgICBkYXRhLmZpZWxkVmFsdWUgPSB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoZmllbGRWYWx1ZSk7CiAgICBjb25zdCBkZWZhdWx0RmllbGRWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIkRWIiwKICAgICAgZ2V0QXJyYXk6IHRydWUKICAgIH0pOwogICAgZGF0YS5kZWZhdWx0RmllbGRWYWx1ZSA9IHRoaXMuX2RlY29kZUZvcm1WYWx1ZShkZWZhdWx0RmllbGRWYWx1ZSk7CgogICAgaWYgKGZpZWxkVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBwYXJhbXMueGZhRGF0YXNldHMpIHsKICAgICAgY29uc3QgcGF0aCA9IHRoaXMuX3RpdGxlLnN0cjsKCiAgICAgIGlmIChwYXRoKSB7CiAgICAgICAgdGhpcy5faGFzVmFsdWVGcm9tWEZBID0gdHJ1ZTsKICAgICAgICBkYXRhLmZpZWxkVmFsdWUgPSBmaWVsZFZhbHVlID0gcGFyYW1zLnhmYURhdGFzZXRzLmdldFZhbHVlKHBhdGgpOwogICAgICB9CiAgICB9CgogICAgaWYgKGZpZWxkVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBkYXRhLmRlZmF1bHRGaWVsZFZhbHVlICE9PSBudWxsKSB7CiAgICAgIGRhdGEuZmllbGRWYWx1ZSA9IGRhdGEuZGVmYXVsdEZpZWxkVmFsdWU7CiAgICB9CgogICAgZGF0YS5hbHRlcm5hdGl2ZVRleHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGRpY3QuZ2V0KCJUVSIpIHx8ICIiKTsKICAgIGNvbnN0IGRlZmF1bHRBcHBlYXJhbmNlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiREEiCiAgICB9KSB8fCBwYXJhbXMuYWNyb0Zvcm0uZ2V0KCJEQSIpOwogICAgdGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UgPSB0eXBlb2YgZGVmYXVsdEFwcGVhcmFuY2UgPT09ICJzdHJpbmciID8gZGVmYXVsdEFwcGVhcmFuY2UgOiAiIjsKICAgIGRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhID0gKDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSkodGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UpOwogICAgY29uc3QgZmllbGRUeXBlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRlQiCiAgICB9KTsKICAgIGRhdGEuZmllbGRUeXBlID0gZmllbGRUeXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGZpZWxkVHlwZS5uYW1lIDogbnVsbDsKICAgIGNvbnN0IGxvY2FsUmVzb3VyY2VzID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRFIiCiAgICB9KTsKICAgIGNvbnN0IGFjcm9Gb3JtUmVzb3VyY2VzID0gcGFyYW1zLmFjcm9Gb3JtLmdldCgiRFIiKTsKICAgIGNvbnN0IGFwcGVhcmFuY2VSZXNvdXJjZXMgPSB0aGlzLmFwcGVhcmFuY2UgJiYgdGhpcy5hcHBlYXJhbmNlLmRpY3QuZ2V0KCJSZXNvdXJjZXMiKTsKICAgIHRoaXMuX2ZpZWxkUmVzb3VyY2VzID0gewogICAgICBsb2NhbFJlc291cmNlcywKICAgICAgYWNyb0Zvcm1SZXNvdXJjZXMsCiAgICAgIGFwcGVhcmFuY2VSZXNvdXJjZXMsCiAgICAgIG1lcmdlZFJlc291cmNlczogX3ByaW1pdGl2ZXMuRGljdC5tZXJnZSh7CiAgICAgICAgeHJlZjogcGFyYW1zLnhyZWYsCiAgICAgICAgZGljdEFycmF5OiBbbG9jYWxSZXNvdXJjZXMsIGFwcGVhcmFuY2VSZXNvdXJjZXMsIGFjcm9Gb3JtUmVzb3VyY2VzXSwKICAgICAgICBtZXJnZVN1YkRpY3RzOiB0cnVlCiAgICAgIH0pCiAgICB9OwogICAgZGF0YS5maWVsZEZsYWdzID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdCwKICAgICAga2V5OiAiRmYiCiAgICB9KTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZGF0YS5maWVsZEZsYWdzKSB8fCBkYXRhLmZpZWxkRmxhZ3MgPCAwKSB7CiAgICAgIGRhdGEuZmllbGRGbGFncyA9IDA7CiAgICB9CgogICAgZGF0YS5yZWFkT25seSA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkVBRE9OTFkpOwogICAgZGF0YS5yZXF1aXJlZCA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkVRVUlSRUQpOwogICAgZGF0YS5oaWRkZW4gPSB0aGlzLl9oYXNGbGFnKGRhdGEuYW5ub3RhdGlvbkZsYWdzLCBfdXRpbC5Bbm5vdGF0aW9uRmxhZy5ISURERU4pOwogIH0KCiAgX2RlY29kZUZvcm1WYWx1ZShmb3JtVmFsdWUpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGZvcm1WYWx1ZSkpIHsKICAgICAgcmV0dXJuIGZvcm1WYWx1ZS5maWx0ZXIoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gInN0cmluZyIpLm1hcChpdGVtID0+ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoaXRlbSkpOwogICAgfSBlbHNlIGlmIChmb3JtVmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGZvcm1WYWx1ZS5uYW1lKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGZvcm1WYWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZm9ybVZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGhhc0ZpZWxkRmxhZyhmbGFnKSB7CiAgICByZXR1cm4gISEodGhpcy5kYXRhLmZpZWxkRmxhZ3MgJiBmbGFnKTsKICB9CgogIHN0YXRpYyBfZ2V0Um90YXRpb25NYXRyaXgocm90YXRpb24sIHdpZHRoLCBoZWlnaHQpIHsKICAgIHN3aXRjaCAocm90YXRpb24pIHsKICAgICAgY2FzZSA5MDoKICAgICAgICByZXR1cm4gWzAsIDEsIC0xLCAwLCB3aWR0aCwgMF07CgogICAgICBjYXNlIDE4MDoKICAgICAgICByZXR1cm4gWy0xLCAwLCAwLCAtMSwgd2lkdGgsIGhlaWdodF07CgogICAgICBjYXNlIDI3MDoKICAgICAgICByZXR1cm4gWzAsIC0xLCAxLCAwLCAwLCBoZWlnaHRdOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgcm90YXRpb24iKTsKICAgIH0KICB9CgogIGdldFJvdGF0aW9uTWF0cml4KGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHJvdGF0aW9uID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5yb3RhdGlvbjsKCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgICByb3RhdGlvbiA9IHRoaXMucm90YXRpb247CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSAwKSB7CiAgICAgIHJldHVybiBfdXRpbC5JREVOVElUWV9NQVRSSVg7CiAgICB9CgogICAgY29uc3Qgd2lkdGggPSB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdOwogICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIHJldHVybiBXaWRnZXRBbm5vdGF0aW9uLl9nZXRSb3RhdGlvbk1hdHJpeChyb3RhdGlvbiwgd2lkdGgsIGhlaWdodCk7CiAgfQoKICBnZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQXBwZWFyYW5jZXMoYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IHN0b3JhZ2VFbnRyeSA9IGFubm90YXRpb25TdG9yYWdlID8gYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCkgOiB1bmRlZmluZWQ7CiAgICBsZXQgcm90YXRpb24gPSBzdG9yYWdlRW50cnkgJiYgc3RvcmFnZUVudHJ5LnJvdGF0aW9uOwoKICAgIGlmIChyb3RhdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbjsKICAgIH0KCiAgICBpZiAoIXRoaXMuYmFja2dyb3VuZENvbG9yICYmICF0aGlzLmJvcmRlckNvbG9yKSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBjb25zdCB3aWR0aCA9IHRoaXMuZGF0YS5yZWN0WzJdIC0gdGhpcy5kYXRhLnJlY3RbMF07CiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdOwogICAgY29uc3QgcmVjdCA9IHJvdGF0aW9uID09PSAwIHx8IHJvdGF0aW9uID09PSAxODAgPyBgMCAwICR7d2lkdGh9ICR7aGVpZ2h0fSByZWAgOiBgMCAwICR7aGVpZ2h0fSAke3dpZHRofSByZWA7CiAgICBsZXQgc3RyID0gIiI7CgogICAgaWYgKHRoaXMuYmFja2dyb3VuZENvbG9yKSB7CiAgICAgIHN0ciA9IGAkeygwLCBfZGVmYXVsdF9hcHBlYXJhbmNlLmdldFBkZkNvbG9yKSh0aGlzLmJhY2tncm91bmRDb2xvciwgdHJ1ZSl9ICR7cmVjdH0gZiBgOwogICAgfQoKICAgIGlmICh0aGlzLmJvcmRlckNvbG9yKSB7CiAgICAgIGNvbnN0IGJvcmRlcldpZHRoID0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCB8fCAxOwogICAgICBzdHIgKz0gYCR7Ym9yZGVyV2lkdGh9IHcgJHsoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5nZXRQZGZDb2xvcikodGhpcy5ib3JkZXJDb2xvciwgZmFsc2UpfSAke3JlY3R9IFMgYDsKICAgIH0KCiAgICByZXR1cm4gc3RyOwogIH0KCiAgYXN5bmMgZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmIChyZW5kZXJGb3JtcyAmJiAhKHRoaXMgaW5zdGFuY2VvZiBTaWduYXR1cmVXaWRnZXRBbm5vdGF0aW9uKSkgewogICAgICByZXR1cm4gewogICAgICAgIG9wTGlzdDogbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpLAogICAgICAgIHNlcGFyYXRlRm9ybTogdHJ1ZSwKICAgICAgICBzZXBhcmF0ZUNhbnZhczogZmFsc2UKICAgICAgfTsKICAgIH0KCiAgICBpZiAoIXRoaXMuX2hhc1RleHQpIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5fZ2V0QXBwZWFyYW5jZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKTsKCiAgICBpZiAodGhpcy5hcHBlYXJhbmNlICYmIGNvbnRlbnQgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHN1cGVyLmdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIGludGVudCwgcmVuZGVyRm9ybXMsIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBjb25zdCBvcExpc3QgPSBuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KCk7CgogICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSB8fCBjb250ZW50ID09PSBudWxsKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgb3BMaXN0LAogICAgICAgIHNlcGFyYXRlRm9ybTogZmFsc2UsCiAgICAgICAgc2VwYXJhdGVDYW52YXM6IGZhbHNlCiAgICAgIH07CiAgICB9CgogICAgY29uc3QgbWF0cml4ID0gWzEsIDAsIDAsIDEsIDAsIDBdOwogICAgY29uc3QgYmJveCA9IFswLCAwLCB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdLCB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdXTsKICAgIGNvbnN0IHRyYW5zZm9ybSA9IGdldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmRhdGEucmVjdCwgYmJveCwgbWF0cml4KTsKICAgIGxldCBvcHRpb25hbENvbnRlbnQ7CgogICAgaWYgKHRoaXMub2MpIHsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gYXdhaXQgZXZhbHVhdG9yLnBhcnNlTWFya2VkQ29udGVudFByb3BzKHRoaXMub2MsIG51bGwpOwogICAgfQoKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudFByb3BzLCBbIk9DIiwgb3B0aW9uYWxDb250ZW50XSk7CiAgICB9CgogICAgb3BMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbkFubm90YXRpb24sIFt0aGlzLmRhdGEuaWQsIHRoaXMuZGF0YS5yZWN0LCB0cmFuc2Zvcm0sIHRoaXMuZ2V0Um90YXRpb25NYXRyaXgoYW5ub3RhdGlvblN0b3JhZ2UpLCBmYWxzZV0pOwogICAgY29uc3Qgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGNvbnRlbnQpOwogICAgYXdhaXQgZXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgIHN0cmVhbSwKICAgICAgdGFzaywKICAgICAgcmVzb3VyY2VzOiB0aGlzLl9maWVsZFJlc291cmNlcy5tZXJnZWRSZXNvdXJjZXMsCiAgICAgIG9wZXJhdG9yTGlzdDogb3BMaXN0CiAgICB9KTsKICAgIG9wTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kQW5ub3RhdGlvbiwgW10pOwoKICAgIGlmIChvcHRpb25hbENvbnRlbnQgIT09IHVuZGVmaW5lZCkgewogICAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsIFtdKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBvcExpc3QsCiAgICAgIHNlcGFyYXRlRm9ybTogZmFsc2UsCiAgICAgIHNlcGFyYXRlQ2FudmFzOiBmYWxzZQogICAgfTsKICB9CgogIF9nZXRNS0RpY3Qocm90YXRpb24pIHsKICAgIGNvbnN0IG1rID0gbmV3IF9wcmltaXRpdmVzLkRpY3QobnVsbCk7CgogICAgaWYgKHJvdGF0aW9uKSB7CiAgICAgIG1rLnNldCgiUiIsIHJvdGF0aW9uKTsKICAgIH0KCiAgICBpZiAodGhpcy5ib3JkZXJDb2xvcikgewogICAgICBtay5zZXQoIkJDIiwgQXJyYXkuZnJvbSh0aGlzLmJvcmRlckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSk7CiAgICB9CgogICAgaWYgKHRoaXMuYmFja2dyb3VuZENvbG9yKSB7CiAgICAgIG1rLnNldCgiQkciLCBBcnJheS5mcm9tKHRoaXMuYmFja2dyb3VuZENvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSk7CiAgICB9CgogICAgcmV0dXJuIG1rLnNpemUgPiAwID8gbWsgOiBudWxsOwogIH0KCiAgYXN5bmMgc2F2ZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHZhbHVlID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS52YWx1ZTsKICAgIGxldCByb3RhdGlvbiA9IHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkucm90YXRpb247CgogICAgaWYgKHZhbHVlID09PSB0aGlzLmRhdGEuZmllbGRWYWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICghdGhpcy5faGFzVmFsdWVGcm9tWEZBICYmIHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFsdWUgPSB2YWx1ZSB8fCB0aGlzLmRhdGEuZmllbGRWYWx1ZTsKICAgIH0KCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCAmJiAhdGhpcy5faGFzVmFsdWVGcm9tWEZBICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIEFycmF5LmlzQXJyYXkodGhpcy5kYXRhLmZpZWxkVmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gdGhpcy5kYXRhLmZpZWxkVmFsdWUubGVuZ3RoICYmIHZhbHVlLmV2ZXJ5KCh4LCBpKSA9PiB4ID09PSB0aGlzLmRhdGEuZmllbGRWYWx1ZVtpXSkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGxldCBhcHBlYXJhbmNlID0gYXdhaXQgdGhpcy5fZ2V0QXBwZWFyYW5jZShldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKTsKCiAgICBpZiAoYXBwZWFyYW5jZSA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCB7CiAgICAgIHhyZWYKICAgIH0gPSBldmFsdWF0b3I7CiAgICBjb25zdCBkaWN0ID0geHJlZi5mZXRjaElmUmVmKHRoaXMucmVmKTsKCiAgICBpZiAoIShkaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgYmJveCA9IFswLCAwLCB0aGlzLmRhdGEucmVjdFsyXSAtIHRoaXMuZGF0YS5yZWN0WzBdLCB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdXTsKICAgIGNvbnN0IHhmYSA9IHsKICAgICAgcGF0aDogKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpIHx8ICIiKSwKICAgICAgdmFsdWUKICAgIH07CiAgICBjb25zdCBuZXdSZWYgPSB4cmVmLmdldE5ld1JlZigpOwogICAgY29uc3QgQVAgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIEFQLnNldCgiTiIsIG5ld1JlZik7CiAgICBjb25zdCBlbmNyeXB0ID0geHJlZi5lbmNyeXB0OwogICAgbGV0IG9yaWdpbmFsVHJhbnNmb3JtID0gbnVsbDsKICAgIGxldCBuZXdUcmFuc2Zvcm0gPSBudWxsOwoKICAgIGlmIChlbmNyeXB0KSB7CiAgICAgIG9yaWdpbmFsVHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5yZWYubnVtLCB0aGlzLnJlZi5nZW4pOwogICAgICBuZXdUcmFuc2Zvcm0gPSBlbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShuZXdSZWYubnVtLCBuZXdSZWYuZ2VuKTsKICAgICAgYXBwZWFyYW5jZSA9IG5ld1RyYW5zZm9ybS5lbmNyeXB0U3RyaW5nKGFwcGVhcmFuY2UpOwogICAgfQoKICAgIGNvbnN0IGVuY29kZXIgPSB2YWwgPT4gKDAsIF91dGlsLmlzQXNjaWkpKHZhbCkgPyB2YWwgOiAoMCwgX3V0aWwuc3RyaW5nVG9VVEYxNkJFU3RyaW5nKSh2YWwpOwoKICAgIGRpY3Quc2V0KCJWIiwgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZS5tYXAoZW5jb2RlcikgOiBlbmNvZGVyKHZhbHVlKSk7CiAgICBkaWN0LnNldCgiQVAiLCBBUCk7CiAgICBkaWN0LnNldCgiTSIsIGBEOiR7KDAsIF91dGlsLmdldE1vZGlmaWNhdGlvbkRhdGUpKCl9YCk7CgogICAgY29uc3QgbWF5YmVNSyA9IHRoaXMuX2dldE1LRGljdChyb3RhdGlvbik7CgogICAgaWYgKG1heWJlTUspIHsKICAgICAgZGljdC5zZXQoIk1LIiwgbWF5YmVNSyk7CiAgICB9CgogICAgY29uc3QgYXBwZWFyYW5jZURpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIGFwcGVhcmFuY2VEaWN0LnNldCgiTGVuZ3RoIiwgYXBwZWFyYW5jZS5sZW5ndGgpOwogICAgYXBwZWFyYW5jZURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlRGljdC5zZXQoIlJlc291cmNlcyIsIHRoaXMuX2dldFNhdmVGaWVsZFJlc291cmNlcyh4cmVmKSk7CiAgICBhcHBlYXJhbmNlRGljdC5zZXQoIkJCb3giLCBiYm94KTsKICAgIGNvbnN0IHJvdGF0aW9uTWF0cml4ID0gdGhpcy5nZXRSb3RhdGlvbk1hdHJpeChhbm5vdGF0aW9uU3RvcmFnZSk7CgogICAgaWYgKHJvdGF0aW9uTWF0cml4ICE9PSBfdXRpbC5JREVOVElUWV9NQVRSSVgpIHsKICAgICAgYXBwZWFyYW5jZURpY3Quc2V0KCJNYXRyaXgiLCByb3RhdGlvbk1hdHJpeCk7CiAgICB9CgogICAgY29uc3QgYnVmZmVyT3JpZ2luYWwgPSBbYCR7dGhpcy5yZWYubnVtfSAke3RoaXMucmVmLmdlbn0gb2JqXG5gXTsKICAgICgwLCBfd3JpdGVyLndyaXRlRGljdCkoZGljdCwgYnVmZmVyT3JpZ2luYWwsIG9yaWdpbmFsVHJhbnNmb3JtKTsKICAgIGJ1ZmZlck9yaWdpbmFsLnB1c2goIlxuZW5kb2JqXG4iKTsKICAgIGNvbnN0IGJ1ZmZlck5ldyA9IFtgJHtuZXdSZWYubnVtfSAke25ld1JlZi5nZW59IG9ialxuYF07CiAgICAoMCwgX3dyaXRlci53cml0ZURpY3QpKGFwcGVhcmFuY2VEaWN0LCBidWZmZXJOZXcsIG5ld1RyYW5zZm9ybSk7CiAgICBidWZmZXJOZXcucHVzaCgiIHN0cmVhbVxuIiwgYXBwZWFyYW5jZSwgIlxuZW5kc3RyZWFtXG5lbmRvYmpcbiIpOwogICAgcmV0dXJuIFt7CiAgICAgIHJlZjogdGhpcy5yZWYsCiAgICAgIGRhdGE6IGJ1ZmZlck9yaWdpbmFsLmpvaW4oIiIpLAogICAgICB4ZmEKICAgIH0sIHsKICAgICAgcmVmOiBuZXdSZWYsCiAgICAgIGRhdGE6IGJ1ZmZlck5ldy5qb2luKCIiKSwKICAgICAgeGZhOiBudWxsCiAgICB9XTsKICB9CgogIGFzeW5jIF9nZXRBcHBlYXJhbmNlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IGlzUGFzc3dvcmQgPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLlBBU1NXT1JEKTsKCiAgICBpZiAoaXNQYXNzd29yZCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZSA/IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpIDogdW5kZWZpbmVkOwogICAgbGV0IHZhbHVlLCByb3RhdGlvbjsKCiAgICBpZiAoc3RvcmFnZUVudHJ5KSB7CiAgICAgIHZhbHVlID0gc3RvcmFnZUVudHJ5LmZvcm1hdHRlZFZhbHVlIHx8IHN0b3JhZ2VFbnRyeS52YWx1ZTsKICAgICAgcm90YXRpb24gPSBzdG9yYWdlRW50cnkucm90YXRpb247CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQgJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoIXRoaXMuX2hhc1ZhbHVlRnJvbVhGQSB8fCB0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWU7CgogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9CgogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMSkgewogICAgICB2YWx1ZSA9IHZhbHVlWzBdOwogICAgfQoKICAgICgwLCBfdXRpbC5hc3NlcnQpKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIsICJFeHBlY3RlZCBgdmFsdWVgIHRvIGJlIGEgc3RyaW5nLiIpOwogICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7CgogICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGxldCBsaW5lQ291bnQgPSAtMTsKCiAgICBpZiAodGhpcy5kYXRhLm11bHRpTGluZSkgewogICAgICBsaW5lQ291bnQgPSB2YWx1ZS5zcGxpdCgvXHJcbnxccnxcbi8pLmxlbmd0aDsKICAgIH0KCiAgICBjb25zdCBkZWZhdWx0UGFkZGluZyA9IDI7CiAgICBjb25zdCBoUGFkZGluZyA9IGRlZmF1bHRQYWRkaW5nOwogICAgbGV0IHRvdGFsSGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIGxldCB0b3RhbFdpZHRoID0gdGhpcy5kYXRhLnJlY3RbMl0gLSB0aGlzLmRhdGEucmVjdFswXTsKCiAgICBpZiAocm90YXRpb24gPT09IDkwIHx8IHJvdGF0aW9uID09PSAyNzApIHsKICAgICAgW3RvdGFsV2lkdGgsIHRvdGFsSGVpZ2h0XSA9IFt0b3RhbEhlaWdodCwgdG90YWxXaWR0aF07CiAgICB9CgogICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSkgewogICAgICB0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhID0gKDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UucGFyc2VEZWZhdWx0QXBwZWFyYW5jZSkodGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UgPSAiL0hlbHZldGljYSAwIFRmIDAgZyIpOwogICAgfQoKICAgIGNvbnN0IGZvbnQgPSBhd2FpdCBXaWRnZXRBbm5vdGF0aW9uLl9nZXRGb250RGF0YShldmFsdWF0b3IsIHRhc2ssIHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEsIHRoaXMuX2ZpZWxkUmVzb3VyY2VzLm1lcmdlZFJlc291cmNlcyk7CgogICAgY29uc3QgW2RlZmF1bHRBcHBlYXJhbmNlLCBmb250U2l6ZV0gPSB0aGlzLl9jb21wdXRlRm9udFNpemUodG90YWxIZWlnaHQgLSBkZWZhdWx0UGFkZGluZywgdG90YWxXaWR0aCAtIDIgKiBoUGFkZGluZywgdmFsdWUsIGZvbnQsIGxpbmVDb3VudCk7CgogICAgbGV0IGRlc2NlbnQgPSBmb250LmRlc2NlbnQ7CgogICAgaWYgKGlzTmFOKGRlc2NlbnQpKSB7CiAgICAgIGRlc2NlbnQgPSAwOwogICAgfQoKICAgIGNvbnN0IGRlZmF1bHRWUGFkZGluZyA9IE1hdGgubWluKE1hdGguZmxvb3IoKHRvdGFsSGVpZ2h0IC0gZm9udFNpemUpIC8gMiksIGRlZmF1bHRQYWRkaW5nKTsKICAgIGNvbnN0IHZQYWRkaW5nID0gZGVmYXVsdFZQYWRkaW5nICsgTWF0aC5hYnMoZGVzY2VudCkgKiBmb250U2l6ZTsKICAgIGNvbnN0IGFsaWdubWVudCA9IHRoaXMuZGF0YS50ZXh0QWxpZ25tZW50OwoKICAgIGlmICh0aGlzLmRhdGEubXVsdGlMaW5lKSB7CiAgICAgIHJldHVybiB0aGlzLl9nZXRNdWx0aWxpbmVBcHBlYXJhbmNlKGRlZmF1bHRBcHBlYXJhbmNlLCB2YWx1ZSwgZm9udCwgZm9udFNpemUsIHRvdGFsV2lkdGgsIHRvdGFsSGVpZ2h0LCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIGNvbnN0IGVuY29kZWRTdHJpbmcgPSBmb250LmVuY29kZVN0cmluZyh2YWx1ZSkuam9pbigiIik7CgogICAgaWYgKHRoaXMuZGF0YS5jb21iKSB7CiAgICAgIHJldHVybiB0aGlzLl9nZXRDb21iQXBwZWFyYW5jZShkZWZhdWx0QXBwZWFyYW5jZSwgZm9udCwgZW5jb2RlZFN0cmluZywgdG90YWxXaWR0aCwgaFBhZGRpbmcsIHZQYWRkaW5nLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICB9CgogICAgY29uc3QgY29sb3JzID0gdGhpcy5nZXRCb3JkZXJBbmRCYWNrZ3JvdW5kQXBwZWFyYW5jZXMoYW5ub3RhdGlvblN0b3JhZ2UpOwoKICAgIGlmIChhbGlnbm1lbnQgPT09IDAgfHwgYWxpZ25tZW50ID4gMikgewogICAgICByZXR1cm4gYC9UeCBCTUMgcSAke2NvbG9yc31CVCBgICsgZGVmYXVsdEFwcGVhcmFuY2UgKyBgIDEgMCAwIDEgJHtoUGFkZGluZ30gJHt2UGFkZGluZ30gVG0gKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykoZW5jb2RlZFN0cmluZyl9KSBUamAgKyAiIEVUIFEgRU1DIjsKICAgIH0KCiAgICBjb25zdCByZW5kZXJlZFRleHQgPSB0aGlzLl9yZW5kZXJUZXh0KGVuY29kZWRTdHJpbmcsIGZvbnQsIGZvbnRTaXplLCB0b3RhbFdpZHRoLCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZyk7CgogICAgcmV0dXJuIGAvVHggQk1DIHEgJHtjb2xvcnN9QlQgYCArIGRlZmF1bHRBcHBlYXJhbmNlICsgYCAxIDAgMCAxIDAgMCBUbSAke3JlbmRlcmVkVGV4dH1gICsgIiBFVCBRIEVNQyI7CiAgfQoKICBzdGF0aWMgYXN5bmMgX2dldEZvbnREYXRhKGV2YWx1YXRvciwgdGFzaywgYXBwZWFyYW5jZURhdGEsIHJlc291cmNlcykgewogICAgY29uc3Qgb3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgY29uc3QgaW5pdGlhbFN0YXRlID0gewogICAgICBmb250OiBudWxsLAoKICAgICAgY2xvbmUoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICB9OwogICAgY29uc3QgewogICAgICBmb250TmFtZSwKICAgICAgZm9udFNpemUKICAgIH0gPSBhcHBlYXJhbmNlRGF0YTsKICAgIGF3YWl0IGV2YWx1YXRvci5oYW5kbGVTZXRGb250KHJlc291cmNlcywgW2ZvbnROYW1lICYmIF9wcmltaXRpdmVzLk5hbWUuZ2V0KGZvbnROYW1lKSwgZm9udFNpemVdLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIGluaXRpYWxTdGF0ZSwgbnVsbCk7CiAgICByZXR1cm4gaW5pdGlhbFN0YXRlLmZvbnQ7CiAgfQoKICBfZ2V0VGV4dFdpZHRoKHRleHQsIGZvbnQpIHsKICAgIHJldHVybiBmb250LmNoYXJzVG9HbHlwaHModGV4dCkucmVkdWNlKCh3aWR0aCwgZ2x5cGgpID0+IHdpZHRoICsgZ2x5cGgud2lkdGgsIDApIC8gMTAwMDsKICB9CgogIF9jb21wdXRlRm9udFNpemUoaGVpZ2h0LCB3aWR0aCwgdGV4dCwgZm9udCwgbGluZUNvdW50KSB7CiAgICBsZXQgewogICAgICBmb250U2l6ZQogICAgfSA9IHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGE7CgogICAgaWYgKCFmb250U2l6ZSkgewogICAgICBjb25zdCByb3VuZFdpdGhUd29EaWdpdHMgPSB4ID0+IE1hdGguZmxvb3IoeCAqIDEwMCkgLyAxMDA7CgogICAgICBpZiAobGluZUNvdW50ID09PSAtMSkgewogICAgICAgIGNvbnN0IHRleHRXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aCh0ZXh0LCBmb250KTsKCiAgICAgICAgZm9udFNpemUgPSByb3VuZFdpdGhUd29EaWdpdHMoTWF0aC5taW4oaGVpZ2h0IC8gX3V0aWwuTElORV9GQUNUT1IsIHdpZHRoIC8gdGV4dFdpZHRoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9cclxuP3xcbi8pOwogICAgICAgIGNvbnN0IGNhY2hlZExpbmVzID0gW107CgogICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgewogICAgICAgICAgY29uc3QgZW5jb2RlZCA9IGZvbnQuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgICAgICAgY29uc3QgZ2x5cGhzID0gZm9udC5jaGFyc1RvR2x5cGhzKGVuY29kZWQpOwogICAgICAgICAgY29uc3QgcG9zaXRpb25zID0gZm9udC5nZXRDaGFyUG9zaXRpb25zKGVuY29kZWQpOwogICAgICAgICAgY2FjaGVkTGluZXMucHVzaCh7CiAgICAgICAgICAgIGxpbmU6IGVuY29kZWQsCiAgICAgICAgICAgIGdseXBocywKICAgICAgICAgICAgcG9zaXRpb25zCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlzVG9vQmlnID0gZnNpemUgPT4gewogICAgICAgICAgbGV0IHRvdGFsSGVpZ2h0ID0gMDsKCiAgICAgICAgICBmb3IgKGNvbnN0IGNhY2hlIG9mIGNhY2hlZExpbmVzKSB7CiAgICAgICAgICAgIGNvbnN0IGNodW5rcyA9IHRoaXMuX3NwbGl0TGluZShudWxsLCBmb250LCBmc2l6ZSwgd2lkdGgsIGNhY2hlKTsKCiAgICAgICAgICAgIHRvdGFsSGVpZ2h0ICs9IGNodW5rcy5sZW5ndGggKiBmc2l6ZTsKCiAgICAgICAgICAgIGlmICh0b3RhbEhlaWdodCA+IGhlaWdodCkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH07CgogICAgICAgIGZvbnRTaXplID0gMTI7CiAgICAgICAgbGV0IGxpbmVIZWlnaHQgPSBmb250U2l6ZSAqIF91dGlsLkxJTkVfRkFDVE9SOwogICAgICAgIGxldCBudW1iZXJPZkxpbmVzID0gTWF0aC5yb3VuZChoZWlnaHQgLyBsaW5lSGVpZ2h0KTsKICAgICAgICBudW1iZXJPZkxpbmVzID0gTWF0aC5tYXgobnVtYmVyT2ZMaW5lcywgbGluZUNvdW50KTsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgIGxpbmVIZWlnaHQgPSBoZWlnaHQgLyBudW1iZXJPZkxpbmVzOwogICAgICAgICAgZm9udFNpemUgPSByb3VuZFdpdGhUd29EaWdpdHMobGluZUhlaWdodCAvIF91dGlsLkxJTkVfRkFDVE9SKTsKCiAgICAgICAgICBpZiAoaXNUb29CaWcoZm9udFNpemUpKSB7CiAgICAgICAgICAgIG51bWJlck9mTGluZXMrKzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB7CiAgICAgICAgZm9udE5hbWUsCiAgICAgICAgZm9udENvbG9yCiAgICAgIH0gPSB0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2VEYXRhOwogICAgICB0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSA9ICgwLCBfZGVmYXVsdF9hcHBlYXJhbmNlLmNyZWF0ZURlZmF1bHRBcHBlYXJhbmNlKSh7CiAgICAgICAgZm9udFNpemUsCiAgICAgICAgZm9udE5hbWUsCiAgICAgICAgZm9udENvbG9yCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBbdGhpcy5fZGVmYXVsdEFwcGVhcmFuY2UsIGZvbnRTaXplXTsKICB9CgogIF9yZW5kZXJUZXh0KHRleHQsIGZvbnQsIGZvbnRTaXplLCB0b3RhbFdpZHRoLCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZykgewogICAgbGV0IHNoaWZ0OwoKICAgIGlmIChhbGlnbm1lbnQgPT09IDEpIHsKICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLl9nZXRUZXh0V2lkdGgodGV4dCwgZm9udCkgKiBmb250U2l6ZTsKICAgICAgc2hpZnQgPSAodG90YWxXaWR0aCAtIHdpZHRoKSAvIDI7CiAgICB9IGVsc2UgaWYgKGFsaWdubWVudCA9PT0gMikgewogICAgICBjb25zdCB3aWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aCh0ZXh0LCBmb250KSAqIGZvbnRTaXplOwogICAgICBzaGlmdCA9IHRvdGFsV2lkdGggLSB3aWR0aCAtIGhQYWRkaW5nOwogICAgfSBlbHNlIHsKICAgICAgc2hpZnQgPSBoUGFkZGluZzsKICAgIH0KCiAgICBzaGlmdCA9ICgwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoc2hpZnQpOwogICAgdlBhZGRpbmcgPSAoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKHZQYWRkaW5nKTsKICAgIHJldHVybiBgJHtzaGlmdH0gJHt2UGFkZGluZ30gVGQgKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykodGV4dCl9KSBUamA7CiAgfQoKICBfZ2V0U2F2ZUZpZWxkUmVzb3VyY2VzKHhyZWYpIHsKICAgIGNvbnN0IHsKICAgICAgbG9jYWxSZXNvdXJjZXMsCiAgICAgIGFwcGVhcmFuY2VSZXNvdXJjZXMsCiAgICAgIGFjcm9Gb3JtUmVzb3VyY2VzCiAgICB9ID0gdGhpcy5fZmllbGRSZXNvdXJjZXM7CiAgICBjb25zdCBmb250TmFtZSA9IHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEgJiYgdGhpcy5kYXRhLmRlZmF1bHRBcHBlYXJhbmNlRGF0YS5mb250TmFtZTsKCiAgICBpZiAoIWZvbnROYW1lKSB7CiAgICAgIHJldHVybiBsb2NhbFJlc291cmNlcyB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwogICAgfQoKICAgIGZvciAoY29uc3QgcmVzb3VyY2VzIG9mIFtsb2NhbFJlc291cmNlcywgYXBwZWFyYW5jZVJlc291cmNlc10pIHsKICAgICAgaWYgKHJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBjb25zdCBsb2NhbEZvbnQgPSByZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICAgIGlmIChsb2NhbEZvbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIGxvY2FsRm9udC5oYXMoZm9udE5hbWUpKSB7CiAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChhY3JvRm9ybVJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgYWNyb0Zvcm1Gb250ID0gYWNyb0Zvcm1SZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICBpZiAoYWNyb0Zvcm1Gb250IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBhY3JvRm9ybUZvbnQuaGFzKGZvbnROYW1lKSkgewogICAgICAgIGNvbnN0IHN1YkZvbnREaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgICAgc3ViRm9udERpY3Quc2V0KGZvbnROYW1lLCBhY3JvRm9ybUZvbnQuZ2V0UmF3KGZvbnROYW1lKSk7CiAgICAgICAgY29uc3Qgc3ViUmVzb3VyY2VzRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICAgIHN1YlJlc291cmNlc0RpY3Quc2V0KCJGb250Iiwgc3ViRm9udERpY3QpOwogICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5EaWN0Lm1lcmdlKHsKICAgICAgICAgIHhyZWYsCiAgICAgICAgICBkaWN0QXJyYXk6IFtzdWJSZXNvdXJjZXNEaWN0LCBsb2NhbFJlc291cmNlc10sCiAgICAgICAgICBtZXJnZVN1YkRpY3RzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbG9jYWxSZXNvdXJjZXMgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKY2xhc3MgVGV4dFdpZGdldEFubm90YXRpb24gZXh0ZW5kcyBXaWRnZXRBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLl9oYXNUZXh0ID0gdHJ1ZTsKICAgIGNvbnN0IGRpY3QgPSBwYXJhbXMuZGljdDsKCiAgICBpZiAodHlwZW9mIHRoaXMuZGF0YS5maWVsZFZhbHVlICE9PSAic3RyaW5nIikgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9ICIiOwogICAgfQoKICAgIGxldCBhbGlnbm1lbnQgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSkoewogICAgICBkaWN0LAogICAgICBrZXk6ICJRIgogICAgfSk7CgogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGFsaWdubWVudCkgfHwgYWxpZ25tZW50IDwgMCB8fCBhbGlnbm1lbnQgPiAyKSB7CiAgICAgIGFsaWdubWVudCA9IG51bGw7CiAgICB9CgogICAgdGhpcy5kYXRhLnRleHRBbGlnbm1lbnQgPSBhbGlnbm1lbnQ7CiAgICBsZXQgbWF4aW11bUxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3QsCiAgICAgIGtleTogIk1heExlbiIKICAgIH0pOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihtYXhpbXVtTGVuZ3RoKSB8fCBtYXhpbXVtTGVuZ3RoIDwgMCkgewogICAgICBtYXhpbXVtTGVuZ3RoID0gMDsKICAgIH0KCiAgICB0aGlzLmRhdGEubWF4TGVuID0gbWF4aW11bUxlbmd0aDsKICAgIHRoaXMuZGF0YS5tdWx0aUxpbmUgPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLk1VTFRJTElORSk7CiAgICB0aGlzLmRhdGEuY29tYiA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuQ09NQikgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuTVVMVElMSU5FKSAmJiAhdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QQVNTV09SRCkgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuRklMRVNFTEVDVCkgJiYgdGhpcy5kYXRhLm1heExlbiAhPT0gMDsKICAgIHRoaXMuZGF0YS5kb05vdFNjcm9sbCA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuRE9OT1RTQ1JPTEwpOwogIH0KCiAgX2dldENvbWJBcHBlYXJhbmNlKGRlZmF1bHRBcHBlYXJhbmNlLCBmb250LCB0ZXh0LCB3aWR0aCwgaFBhZGRpbmcsIHZQYWRkaW5nLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgY29uc3QgY29tYldpZHRoID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKSh3aWR0aCAvIHRoaXMuZGF0YS5tYXhMZW4pOwogICAgY29uc3QgYnVmID0gW107CiAgICBjb25zdCBwb3NpdGlvbnMgPSBmb250LmdldENoYXJQb3NpdGlvbnModGV4dCk7CgogICAgZm9yIChjb25zdCBbc3RhcnQsIGVuZF0gb2YgcG9zaXRpb25zKSB7CiAgICAgIGJ1Zi5wdXNoKGAoJHsoMCwgX3V0aWwuZXNjYXBlU3RyaW5nKSh0ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKSl9KSBUamApOwogICAgfQoKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuZ2V0Qm9yZGVyQW5kQmFja2dyb3VuZEFwcGVhcmFuY2VzKGFubm90YXRpb25TdG9yYWdlKTsKICAgIGNvbnN0IHJlbmRlcmVkQ29tYiA9IGJ1Zi5qb2luKGAgJHtjb21iV2lkdGh9IDAgVGQgYCk7CiAgICByZXR1cm4gYC9UeCBCTUMgcSAke2NvbG9yc31CVCBgICsgZGVmYXVsdEFwcGVhcmFuY2UgKyBgIDEgMCAwIDEgJHtoUGFkZGluZ30gJHt2UGFkZGluZ30gVG0gJHtyZW5kZXJlZENvbWJ9YCArICIgRVQgUSBFTUMiOwogIH0KCiAgX2dldE11bHRpbGluZUFwcGVhcmFuY2UoZGVmYXVsdEFwcGVhcmFuY2UsIHRleHQsIGZvbnQsIGZvbnRTaXplLCB3aWR0aCwgaGVpZ2h0LCBhbGlnbm1lbnQsIGhQYWRkaW5nLCB2UGFkZGluZywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgvXHJcbj98XG4vKTsKICAgIGNvbnN0IGJ1ZiA9IFtdOwogICAgY29uc3QgdG90YWxXaWR0aCA9IHdpZHRoIC0gMiAqIGhQYWRkaW5nOwoKICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgewogICAgICBjb25zdCBjaHVua3MgPSB0aGlzLl9zcGxpdExpbmUobGluZSwgZm9udCwgZm9udFNpemUsIHRvdGFsV2lkdGgpOwoKICAgICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHsKICAgICAgICBjb25zdCBwYWRkaW5nID0gYnVmLmxlbmd0aCA9PT0gMCA/IGhQYWRkaW5nIDogMDsKICAgICAgICBidWYucHVzaCh0aGlzLl9yZW5kZXJUZXh0KGNodW5rLCBmb250LCBmb250U2l6ZSwgd2lkdGgsIGFsaWdubWVudCwgcGFkZGluZywgLWZvbnRTaXplKSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByZW5kZXJlZFRleHQgPSBidWYuam9pbigiXG4iKTsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuZ2V0Qm9yZGVyQW5kQmFja2dyb3VuZEFwcGVhcmFuY2VzKGFubm90YXRpb25TdG9yYWdlKTsKICAgIHJldHVybiBgL1R4IEJNQyBxICR7Y29sb3JzfUJUIGAgKyBkZWZhdWx0QXBwZWFyYW5jZSArIGAgMSAwIDAgMSAwICR7aGVpZ2h0fSBUbSAke3JlbmRlcmVkVGV4dH1gICsgIiBFVCBRIEVNQyI7CiAgfQoKICBfc3BsaXRMaW5lKGxpbmUsIGZvbnQsIGZvbnRTaXplLCB3aWR0aCwgY2FjaGUgPSB7fSkgewogICAgbGluZSA9IGNhY2hlLmxpbmUgfHwgZm9udC5lbmNvZGVTdHJpbmcobGluZSkuam9pbigiIik7CiAgICBjb25zdCBnbHlwaHMgPSBjYWNoZS5nbHlwaHMgfHwgZm9udC5jaGFyc1RvR2x5cGhzKGxpbmUpOwoKICAgIGlmIChnbHlwaHMubGVuZ3RoIDw9IDEpIHsKICAgICAgcmV0dXJuIFtsaW5lXTsKICAgIH0KCiAgICBjb25zdCBwb3NpdGlvbnMgPSBjYWNoZS5wb3NpdGlvbnMgfHwgZm9udC5nZXRDaGFyUG9zaXRpb25zKGxpbmUpOwogICAgY29uc3Qgc2NhbGUgPSBmb250U2l6ZSAvIDEwMDA7CiAgICBjb25zdCBjaHVua3MgPSBbXTsKICAgIGxldCBsYXN0U3BhY2VQb3NJblN0cmluZ1N0YXJ0ID0gLTEsCiAgICAgICAgbGFzdFNwYWNlUG9zSW5TdHJpbmdFbmQgPSAtMSwKICAgICAgICBsYXN0U3BhY2VQb3MgPSAtMSwKICAgICAgICBzdGFydENodW5rID0gMCwKICAgICAgICBjdXJyZW50V2lkdGggPSAwOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGdseXBocy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IHBvc2l0aW9uc1tpXTsKICAgICAgY29uc3QgZ2x5cGggPSBnbHlwaHNbaV07CiAgICAgIGNvbnN0IGdseXBoV2lkdGggPSBnbHlwaC53aWR0aCAqIHNjYWxlOwoKICAgICAgaWYgKGdseXBoLnVuaWNvZGUgPT09ICIgIikgewogICAgICAgIGlmIChjdXJyZW50V2lkdGggKyBnbHlwaFdpZHRoID4gd2lkdGgpIHsKICAgICAgICAgIGNodW5rcy5wdXNoKGxpbmUuc3Vic3RyaW5nKHN0YXJ0Q2h1bmssIHN0YXJ0KSk7CiAgICAgICAgICBzdGFydENodW5rID0gc3RhcnQ7CiAgICAgICAgICBjdXJyZW50V2lkdGggPSBnbHlwaFdpZHRoOwogICAgICAgICAgbGFzdFNwYWNlUG9zSW5TdHJpbmdTdGFydCA9IC0xOwogICAgICAgICAgbGFzdFNwYWNlUG9zID0gLTE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRXaWR0aCArPSBnbHlwaFdpZHRoOwogICAgICAgICAgbGFzdFNwYWNlUG9zSW5TdHJpbmdTdGFydCA9IHN0YXJ0OwogICAgICAgICAgbGFzdFNwYWNlUG9zSW5TdHJpbmdFbmQgPSBlbmQ7CiAgICAgICAgICBsYXN0U3BhY2VQb3MgPSBpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoY3VycmVudFdpZHRoICsgZ2x5cGhXaWR0aCA+IHdpZHRoKSB7CiAgICAgICAgICBpZiAobGFzdFNwYWNlUG9zSW5TdHJpbmdTdGFydCAhPT0gLTEpIHsKICAgICAgICAgICAgY2h1bmtzLnB1c2gobGluZS5zdWJzdHJpbmcoc3RhcnRDaHVuaywgbGFzdFNwYWNlUG9zSW5TdHJpbmdFbmQpKTsKICAgICAgICAgICAgc3RhcnRDaHVuayA9IGxhc3RTcGFjZVBvc0luU3RyaW5nRW5kOwogICAgICAgICAgICBpID0gbGFzdFNwYWNlUG9zICsgMTsKICAgICAgICAgICAgbGFzdFNwYWNlUG9zSW5TdHJpbmdTdGFydCA9IC0xOwogICAgICAgICAgICBjdXJyZW50V2lkdGggPSAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2h1bmtzLnB1c2gobGluZS5zdWJzdHJpbmcoc3RhcnRDaHVuaywgc3RhcnQpKTsKICAgICAgICAgICAgc3RhcnRDaHVuayA9IHN0YXJ0OwogICAgICAgICAgICBjdXJyZW50V2lkdGggPSBnbHlwaFdpZHRoOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50V2lkdGggKz0gZ2x5cGhXaWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc3RhcnRDaHVuayA8IGxpbmUubGVuZ3RoKSB7CiAgICAgIGNodW5rcy5wdXNoKGxpbmUuc3Vic3RyaW5nKHN0YXJ0Q2h1bmssIGxpbmUubGVuZ3RoKSk7CiAgICB9CgogICAgcmV0dXJuIGNodW5rczsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgcmV0dXJuIHsKICAgICAgaWQ6IHRoaXMuZGF0YS5pZCwKICAgICAgdmFsdWU6IHRoaXMuZGF0YS5maWVsZFZhbHVlLAogICAgICBkZWZhdWx0VmFsdWU6IHRoaXMuZGF0YS5kZWZhdWx0RmllbGRWYWx1ZSB8fCAiIiwKICAgICAgbXVsdGlsaW5lOiB0aGlzLmRhdGEubXVsdGlMaW5lLAogICAgICBwYXNzd29yZDogdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QQVNTV09SRCksCiAgICAgIGNoYXJMaW1pdDogdGhpcy5kYXRhLm1heExlbiwKICAgICAgY29tYjogdGhpcy5kYXRhLmNvbWIsCiAgICAgIGVkaXRhYmxlOiAhdGhpcy5kYXRhLnJlYWRPbmx5LAogICAgICBoaWRkZW46IHRoaXMuZGF0YS5oaWRkZW4sCiAgICAgIG5hbWU6IHRoaXMuZGF0YS5maWVsZE5hbWUsCiAgICAgIHJlY3Q6IHRoaXMuZGF0YS5yZWN0LAogICAgICBhY3Rpb25zOiB0aGlzLmRhdGEuYWN0aW9ucywKICAgICAgcGFnZTogdGhpcy5kYXRhLnBhZ2VJbmRleCwKICAgICAgc3Ryb2tlQ29sb3I6IHRoaXMuZGF0YS5ib3JkZXJDb2xvciwKICAgICAgZmlsbENvbG9yOiB0aGlzLmRhdGEuYmFja2dyb3VuZENvbG9yLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgdHlwZTogInRleHQiCiAgICB9OwogIH0KCn0KCmNsYXNzIEJ1dHRvbldpZGdldEFubm90YXRpb24gZXh0ZW5kcyBXaWRnZXRBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbXMpIHsKICAgIHN1cGVyKHBhcmFtcyk7CiAgICB0aGlzLmNoZWNrZWRBcHBlYXJhbmNlID0gbnVsbDsKICAgIHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSA9IG51bGw7CiAgICB0aGlzLmRhdGEuY2hlY2tCb3ggPSAhdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5SQURJTykgJiYgIXRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUFVTSEJVVFRPTik7CiAgICB0aGlzLmRhdGEucmFkaW9CdXR0b24gPSB0aGlzLmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLlJBRElPKSAmJiAhdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QVVNIQlVUVE9OKTsKICAgIHRoaXMuZGF0YS5wdXNoQnV0dG9uID0gdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QVVNIQlVUVE9OKTsKICAgIHRoaXMuZGF0YS5pc1Rvb2x0aXBPbmx5ID0gZmFsc2U7CgogICAgaWYgKHRoaXMuZGF0YS5jaGVja0JveCkgewogICAgICB0aGlzLl9wcm9jZXNzQ2hlY2tCb3gocGFyYW1zKTsKICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhLnJhZGlvQnV0dG9uKSB7CiAgICAgIHRoaXMuX3Byb2Nlc3NSYWRpb0J1dHRvbihwYXJhbXMpOwogICAgfSBlbHNlIGlmICh0aGlzLmRhdGEucHVzaEJ1dHRvbikgewogICAgICB0aGlzLmRhdGEuaGFzT3duQ2FudmFzID0gdHJ1ZTsKCiAgICAgIHRoaXMuX3Byb2Nlc3NQdXNoQnV0dG9uKHBhcmFtcyk7CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgZmllbGQgZmxhZ3MgZm9yIGJ1dHRvbiB3aWRnZXQgYW5ub3RhdGlvbiIpOwogICAgfQogIH0KCiAgYXN5bmMgZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmICh0aGlzLmRhdGEucHVzaEJ1dHRvbikgewogICAgICByZXR1cm4gc3VwZXIuZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCBmYWxzZSwgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIGxldCB2YWx1ZSA9IG51bGw7CiAgICBsZXQgcm90YXRpb24gPSBudWxsOwoKICAgIGlmIChhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZS5nZXQodGhpcy5kYXRhLmlkKTsKICAgICAgdmFsdWUgPSBzdG9yYWdlRW50cnkgPyBzdG9yYWdlRW50cnkudmFsdWUgOiBudWxsOwogICAgICByb3RhdGlvbiA9IHN0b3JhZ2VFbnRyeSA/IHN0b3JhZ2VFbnRyeS5yb3RhdGlvbiA6IG51bGw7CiAgICB9CgogICAgaWYgKHZhbHVlID09PSBudWxsICYmIHRoaXMuYXBwZWFyYW5jZSkgewogICAgICByZXR1cm4gc3VwZXIuZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgaW50ZW50LCByZW5kZXJGb3JtcywgYW5ub3RhdGlvblN0b3JhZ2UpOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICh0aGlzLmRhdGEuY2hlY2tCb3gpIHsKICAgICAgICB2YWx1ZSA9IHRoaXMuZGF0YS5maWVsZFZhbHVlID09PSB0aGlzLmRhdGEuZXhwb3J0VmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9PT0gdGhpcy5kYXRhLmJ1dHRvblZhbHVlOwogICAgICB9CiAgICB9CgogICAgY29uc3QgYXBwZWFyYW5jZSA9IHZhbHVlID8gdGhpcy5jaGVja2VkQXBwZWFyYW5jZSA6IHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZTsKCiAgICBpZiAoYXBwZWFyYW5jZSkgewogICAgICBjb25zdCBzYXZlZEFwcGVhcmFuY2UgPSB0aGlzLmFwcGVhcmFuY2U7CgogICAgICBjb25zdCBzYXZlZE1hdHJpeCA9IGFwcGVhcmFuY2UuZGljdC5nZXRBcnJheSgiTWF0cml4IikgfHwgX3V0aWwuSURFTlRJVFlfTUFUUklYOwoKICAgICAgaWYgKHJvdGF0aW9uKSB7CiAgICAgICAgYXBwZWFyYW5jZS5kaWN0LnNldCgiTWF0cml4IiwgdGhpcy5nZXRSb3RhdGlvbk1hdHJpeChhbm5vdGF0aW9uU3RvcmFnZSkpOwogICAgICB9CgogICAgICB0aGlzLmFwcGVhcmFuY2UgPSBhcHBlYXJhbmNlOwogICAgICBjb25zdCBvcGVyYXRvckxpc3QgPSBzdXBlci5nZXRPcGVyYXRvckxpc3QoZXZhbHVhdG9yLCB0YXNrLCBpbnRlbnQsIHJlbmRlckZvcm1zLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICAgIHRoaXMuYXBwZWFyYW5jZSA9IHNhdmVkQXBwZWFyYW5jZTsKICAgICAgYXBwZWFyYW5jZS5kaWN0LnNldCgiTWF0cml4Iiwgc2F2ZWRNYXRyaXgpOwogICAgICByZXR1cm4gb3BlcmF0b3JMaXN0OwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIG9wTGlzdDogbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpLAogICAgICBzZXBhcmF0ZUZvcm06IGZhbHNlLAogICAgICBzZXBhcmF0ZUNhbnZhczogZmFsc2UKICAgIH07CiAgfQoKICBhc3luYyBzYXZlKGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmICh0aGlzLmRhdGEuY2hlY2tCb3gpIHsKICAgICAgcmV0dXJuIHRoaXMuX3NhdmVDaGVja2JveChldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKTsKICAgIH0KCiAgICBpZiAodGhpcy5kYXRhLnJhZGlvQnV0dG9uKSB7CiAgICAgIHJldHVybiB0aGlzLl9zYXZlUmFkaW9CdXR0b24oZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBhc3luYyBfc2F2ZUNoZWNrYm94KGV2YWx1YXRvciwgdGFzaywgYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgIGlmICghYW5ub3RhdGlvblN0b3JhZ2UpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgc3RvcmFnZUVudHJ5ID0gYW5ub3RhdGlvblN0b3JhZ2UuZ2V0KHRoaXMuZGF0YS5pZCk7CiAgICBsZXQgcm90YXRpb24gPSBzdG9yYWdlRW50cnkgJiYgc3RvcmFnZUVudHJ5LnJvdGF0aW9uOwogICAgbGV0IHZhbHVlID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS52YWx1ZTsKCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9PT0gdGhpcy5kYXRhLmV4cG9ydFZhbHVlOwoKICAgICAgaWYgKGRlZmF1bHRWYWx1ZSA9PT0gdmFsdWUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGRpY3QgPSBldmFsdWF0b3IueHJlZi5mZXRjaElmUmVmKHRoaXMucmVmKTsKCiAgICBpZiAoIShkaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgPT09IHRoaXMuZGF0YS5leHBvcnRWYWx1ZTsKICAgIH0KCiAgICBjb25zdCB4ZmEgPSB7CiAgICAgIHBhdGg6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGljdC5nZXQoIlQiKSB8fCAiIiksCiAgICAgIHZhbHVlOiB2YWx1ZSA/IHRoaXMuZGF0YS5leHBvcnRWYWx1ZSA6ICIiCiAgICB9OwoKICAgIGNvbnN0IG5hbWUgPSBfcHJpbWl0aXZlcy5OYW1lLmdldCh2YWx1ZSA/IHRoaXMuZGF0YS5leHBvcnRWYWx1ZSA6ICJPZmYiKTsKCiAgICBkaWN0LnNldCgiViIsIG5hbWUpOwogICAgZGljdC5zZXQoIkFTIiwgbmFtZSk7CiAgICBkaWN0LnNldCgiTSIsIGBEOiR7KDAsIF91dGlsLmdldE1vZGlmaWNhdGlvbkRhdGUpKCl9YCk7CgogICAgY29uc3QgbWF5YmVNSyA9IHRoaXMuX2dldE1LRGljdChyb3RhdGlvbik7CgogICAgaWYgKG1heWJlTUspIHsKICAgICAgZGljdC5zZXQoIk1LIiwgbWF5YmVNSyk7CiAgICB9CgogICAgY29uc3QgZW5jcnlwdCA9IGV2YWx1YXRvci54cmVmLmVuY3J5cHQ7CiAgICBsZXQgb3JpZ2luYWxUcmFuc2Zvcm0gPSBudWxsOwoKICAgIGlmIChlbmNyeXB0KSB7CiAgICAgIG9yaWdpbmFsVHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5yZWYubnVtLCB0aGlzLnJlZi5nZW4pOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlciA9IFtgJHt0aGlzLnJlZi5udW19ICR7dGhpcy5yZWYuZ2VufSBvYmpcbmBdOwogICAgKDAsIF93cml0ZXIud3JpdGVEaWN0KShkaWN0LCBidWZmZXIsIG9yaWdpbmFsVHJhbnNmb3JtKTsKICAgIGJ1ZmZlci5wdXNoKCJcbmVuZG9ialxuIik7CiAgICByZXR1cm4gW3sKICAgICAgcmVmOiB0aGlzLnJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpLAogICAgICB4ZmEKICAgIH1dOwogIH0KCiAgYXN5bmMgX3NhdmVSYWRpb0J1dHRvbihldmFsdWF0b3IsIHRhc2ssIGFubm90YXRpb25TdG9yYWdlKSB7CiAgICBpZiAoIWFubm90YXRpb25TdG9yYWdlKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHN0b3JhZ2VFbnRyeSA9IGFubm90YXRpb25TdG9yYWdlLmdldCh0aGlzLmRhdGEuaWQpOwogICAgbGV0IHJvdGF0aW9uID0gc3RvcmFnZUVudHJ5ICYmIHN0b3JhZ2VFbnRyeS5yb3RhdGlvbjsKICAgIGxldCB2YWx1ZSA9IHN0b3JhZ2VFbnRyeSAmJiBzdG9yYWdlRW50cnkudmFsdWU7CgogICAgaWYgKHJvdGF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgPT09IHRoaXMuZGF0YS5idXR0b25WYWx1ZTsKCiAgICAgIGlmIChkZWZhdWx0VmFsdWUgPT09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBkaWN0ID0gZXZhbHVhdG9yLnhyZWYuZmV0Y2hJZlJlZih0aGlzLnJlZik7CgogICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhbHVlID0gdGhpcy5kYXRhLmZpZWxkVmFsdWUgPT09IHRoaXMuZGF0YS5idXR0b25WYWx1ZTsKICAgIH0KCiAgICBpZiAocm90YXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgICByb3RhdGlvbiA9IHRoaXMucm90YXRpb247CiAgICB9CgogICAgY29uc3QgeGZhID0gewogICAgICBwYXRoOiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGRpY3QuZ2V0KCJUIikgfHwgIiIpLAogICAgICB2YWx1ZTogdmFsdWUgPyB0aGlzLmRhdGEuYnV0dG9uVmFsdWUgOiAiIgogICAgfTsKCiAgICBjb25zdCBuYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQodmFsdWUgPyB0aGlzLmRhdGEuYnV0dG9uVmFsdWUgOiAiT2ZmIik7CgogICAgbGV0IHBhcmVudEJ1ZmZlciA9IG51bGw7CiAgICBjb25zdCBlbmNyeXB0ID0gZXZhbHVhdG9yLnhyZWYuZW5jcnlwdDsKCiAgICBpZiAodmFsdWUpIHsKICAgICAgaWYgKHRoaXMucGFyZW50IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgY29uc3QgcGFyZW50ID0gZXZhbHVhdG9yLnhyZWYuZmV0Y2godGhpcy5wYXJlbnQpOwogICAgICAgIGxldCBwYXJlbnRUcmFuc2Zvcm0gPSBudWxsOwoKICAgICAgICBpZiAoZW5jcnlwdCkgewogICAgICAgICAgcGFyZW50VHJhbnNmb3JtID0gZW5jcnlwdC5jcmVhdGVDaXBoZXJUcmFuc2Zvcm0odGhpcy5wYXJlbnQubnVtLCB0aGlzLnBhcmVudC5nZW4pOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50LnNldCgiViIsIG5hbWUpOwogICAgICAgIHBhcmVudEJ1ZmZlciA9IFtgJHt0aGlzLnBhcmVudC5udW19ICR7dGhpcy5wYXJlbnQuZ2VufSBvYmpcbmBdOwogICAgICAgICgwLCBfd3JpdGVyLndyaXRlRGljdCkocGFyZW50LCBwYXJlbnRCdWZmZXIsIHBhcmVudFRyYW5zZm9ybSk7CiAgICAgICAgcGFyZW50QnVmZmVyLnB1c2goIlxuZW5kb2JqXG4iKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnBhcmVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICB0aGlzLnBhcmVudC5zZXQoIlYiLCBuYW1lKTsKICAgICAgfQogICAgfQoKICAgIGRpY3Quc2V0KCJBUyIsIG5hbWUpOwogICAgZGljdC5zZXQoIk0iLCBgRDokeygwLCBfdXRpbC5nZXRNb2RpZmljYXRpb25EYXRlKSgpfWApOwoKICAgIGNvbnN0IG1heWJlTUsgPSB0aGlzLl9nZXRNS0RpY3Qocm90YXRpb24pOwoKICAgIGlmIChtYXliZU1LKSB7CiAgICAgIGRpY3Quc2V0KCJNSyIsIG1heWJlTUspOwogICAgfQoKICAgIGxldCBvcmlnaW5hbFRyYW5zZm9ybSA9IG51bGw7CgogICAgaWYgKGVuY3J5cHQpIHsKICAgICAgb3JpZ2luYWxUcmFuc2Zvcm0gPSBlbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybSh0aGlzLnJlZi5udW0sIHRoaXMucmVmLmdlbik7CiAgICB9CgogICAgY29uc3QgYnVmZmVyID0gW2Ake3RoaXMucmVmLm51bX0gJHt0aGlzLnJlZi5nZW59IG9ialxuYF07CiAgICAoMCwgX3dyaXRlci53cml0ZURpY3QpKGRpY3QsIGJ1ZmZlciwgb3JpZ2luYWxUcmFuc2Zvcm0pOwogICAgYnVmZmVyLnB1c2goIlxuZW5kb2JqXG4iKTsKICAgIGNvbnN0IG5ld1JlZnMgPSBbewogICAgICByZWY6IHRoaXMucmVmLAogICAgICBkYXRhOiBidWZmZXIuam9pbigiIiksCiAgICAgIHhmYQogICAgfV07CgogICAgaWYgKHBhcmVudEJ1ZmZlciAhPT0gbnVsbCkgewogICAgICBuZXdSZWZzLnB1c2goewogICAgICAgIHJlZjogdGhpcy5wYXJlbnQsCiAgICAgICAgZGF0YTogcGFyZW50QnVmZmVyLmpvaW4oIiIpLAogICAgICAgIHhmYTogbnVsbAogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gbmV3UmVmczsKICB9CgogIF9nZXREZWZhdWx0Q2hlY2tlZEFwcGVhcmFuY2UocGFyYW1zLCB0eXBlKSB7CiAgICBjb25zdCB3aWR0aCA9IHRoaXMuZGF0YS5yZWN0WzJdIC0gdGhpcy5kYXRhLnJlY3RbMF07CiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLmRhdGEucmVjdFszXSAtIHRoaXMuZGF0YS5yZWN0WzFdOwogICAgY29uc3QgYmJveCA9IFswLCAwLCB3aWR0aCwgaGVpZ2h0XTsKICAgIGNvbnN0IEZPTlRfUkFUSU8gPSAwLjg7CiAgICBjb25zdCBmb250U2l6ZSA9IE1hdGgubWluKHdpZHRoLCBoZWlnaHQpICogRk9OVF9SQVRJTzsKICAgIGxldCBtZXRyaWNzLCBjaGFyOwoKICAgIGlmICh0eXBlID09PSAiY2hlY2siKSB7CiAgICAgIG1ldHJpY3MgPSB7CiAgICAgICAgd2lkdGg6IDAuNzU1ICogZm9udFNpemUsCiAgICAgICAgaGVpZ2h0OiAwLjcwNSAqIGZvbnRTaXplCiAgICAgIH07CiAgICAgIGNoYXIgPSAiXHgzMyI7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJkaXNjIikgewogICAgICBtZXRyaWNzID0gewogICAgICAgIHdpZHRoOiAwLjc5MSAqIGZvbnRTaXplLAogICAgICAgIGhlaWdodDogMC43MDUgKiBmb250U2l6ZQogICAgICB9OwogICAgICBjaGFyID0gIlx4NkMiOwogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKShgX2dldERlZmF1bHRDaGVja2VkQXBwZWFyYW5jZSAtIHVuc3VwcG9ydGVkIHR5cGU6ICR7dHlwZX1gKTsKICAgIH0KCiAgICBjb25zdCB4U2hpZnQgPSAoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKCh3aWR0aCAtIG1ldHJpY3Mud2lkdGgpIC8gMik7CiAgICBjb25zdCB5U2hpZnQgPSAoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKChoZWlnaHQgLSBtZXRyaWNzLmhlaWdodCkgLyAyKTsKICAgIGNvbnN0IGFwcGVhcmFuY2UgPSBgcSBCVCAvUGRmSnNaYURiICR7Zm9udFNpemV9IFRmIDAgZyAke3hTaGlmdH0gJHt5U2hpZnR9IFRkICgke2NoYXJ9KSBUaiBFVCBRYDsKICAgIGNvbnN0IGFwcGVhcmFuY2VTdHJlYW1EaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QocGFyYW1zLnhyZWYpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJGb3JtVHlwZSIsIDEpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWE9iamVjdCIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiQkJveCIsIGJib3gpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJNYXRyaXgiLCBbMSwgMCwgMCwgMSwgMCwgMF0pOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJMZW5ndGgiLCBhcHBlYXJhbmNlLmxlbmd0aCk7CiAgICBjb25zdCByZXNvdXJjZXMgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdChwYXJhbXMueHJlZik7CiAgICBjb25zdCBmb250ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QocGFyYW1zLnhyZWYpOwogICAgZm9udC5zZXQoIlBkZkpzWmFEYiIsIHRoaXMuZmFsbGJhY2tGb250RGljdCk7CiAgICByZXNvdXJjZXMuc2V0KCJGb250IiwgZm9udCk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlJlc291cmNlcyIsIHJlc291cmNlcyk7CiAgICB0aGlzLmNoZWNrZWRBcHBlYXJhbmNlID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGFwcGVhcmFuY2UpOwogICAgdGhpcy5jaGVja2VkQXBwZWFyYW5jZS5kaWN0ID0gYXBwZWFyYW5jZVN0cmVhbURpY3Q7CgogICAgdGhpcy5fc3RyZWFtcy5wdXNoKHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UpOwogIH0KCiAgX3Byb2Nlc3NDaGVja0JveChwYXJhbXMpIHsKICAgIGNvbnN0IGN1c3RvbUFwcGVhcmFuY2UgPSBwYXJhbXMuZGljdC5nZXQoIkFQIik7CgogICAgaWYgKCEoY3VzdG9tQXBwZWFyYW5jZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBub3JtYWxBcHBlYXJhbmNlID0gY3VzdG9tQXBwZWFyYW5jZS5nZXQoIk4iKTsKCiAgICBpZiAoIShub3JtYWxBcHBlYXJhbmNlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGFzVmFsdWUgPSB0aGlzLl9kZWNvZGVGb3JtVmFsdWUocGFyYW1zLmRpY3QuZ2V0KCJBUyIpKTsKCiAgICBpZiAodHlwZW9mIGFzVmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICAgIHRoaXMuZGF0YS5maWVsZFZhbHVlID0gYXNWYWx1ZTsKICAgIH0KCiAgICBjb25zdCB5ZXMgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZSAhPT0gbnVsbCAmJiB0aGlzLmRhdGEuZmllbGRWYWx1ZSAhPT0gIk9mZiIgPyB0aGlzLmRhdGEuZmllbGRWYWx1ZSA6ICJZZXMiOwogICAgY29uc3QgZXhwb3J0VmFsdWVzID0gbm9ybWFsQXBwZWFyYW5jZS5nZXRLZXlzKCk7CgogICAgaWYgKGV4cG9ydFZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgZXhwb3J0VmFsdWVzLnB1c2goIk9mZiIsIHllcyk7CiAgICB9IGVsc2UgaWYgKGV4cG9ydFZhbHVlcy5sZW5ndGggPT09IDEpIHsKICAgICAgaWYgKGV4cG9ydFZhbHVlc1swXSA9PT0gIk9mZiIpIHsKICAgICAgICBleHBvcnRWYWx1ZXMucHVzaCh5ZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGV4cG9ydFZhbHVlcy51bnNoaWZ0KCJPZmYiKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChleHBvcnRWYWx1ZXMuaW5jbHVkZXMoeWVzKSkgewogICAgICBleHBvcnRWYWx1ZXMubGVuZ3RoID0gMDsKICAgICAgZXhwb3J0VmFsdWVzLnB1c2goIk9mZiIsIHllcyk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBvdGhlclllcyA9IGV4cG9ydFZhbHVlcy5maW5kKHYgPT4gdiAhPT0gIk9mZiIpOwogICAgICBleHBvcnRWYWx1ZXMubGVuZ3RoID0gMDsKICAgICAgZXhwb3J0VmFsdWVzLnB1c2goIk9mZiIsIG90aGVyWWVzKTsKICAgIH0KCiAgICBpZiAoIWV4cG9ydFZhbHVlcy5pbmNsdWRlcyh0aGlzLmRhdGEuZmllbGRWYWx1ZSkpIHsKICAgICAgdGhpcy5kYXRhLmZpZWxkVmFsdWUgPSAiT2ZmIjsKICAgIH0KCiAgICB0aGlzLmRhdGEuZXhwb3J0VmFsdWUgPSBleHBvcnRWYWx1ZXNbMV07CiAgICB0aGlzLmNoZWNrZWRBcHBlYXJhbmNlID0gbm9ybWFsQXBwZWFyYW5jZS5nZXQodGhpcy5kYXRhLmV4cG9ydFZhbHVlKSB8fCBudWxsOwogICAgdGhpcy51bmNoZWNrZWRBcHBlYXJhbmNlID0gbm9ybWFsQXBwZWFyYW5jZS5nZXQoIk9mZiIpIHx8IG51bGw7CgogICAgaWYgKHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UpIHsKICAgICAgdGhpcy5fc3RyZWFtcy5wdXNoKHRoaXMuY2hlY2tlZEFwcGVhcmFuY2UpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5fZ2V0RGVmYXVsdENoZWNrZWRBcHBlYXJhbmNlKHBhcmFtcywgImNoZWNrIik7CiAgICB9CgogICAgaWYgKHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSkgewogICAgICB0aGlzLl9zdHJlYW1zLnB1c2godGhpcy51bmNoZWNrZWRBcHBlYXJhbmNlKTsKICAgIH0KCiAgICB0aGlzLl9mYWxsYmFja0ZvbnREaWN0ID0gdGhpcy5mYWxsYmFja0ZvbnREaWN0OwogIH0KCiAgX3Byb2Nlc3NSYWRpb0J1dHRvbihwYXJhbXMpIHsKICAgIHRoaXMuZGF0YS5maWVsZFZhbHVlID0gdGhpcy5kYXRhLmJ1dHRvblZhbHVlID0gbnVsbDsKICAgIGNvbnN0IGZpZWxkUGFyZW50ID0gcGFyYW1zLmRpY3QuZ2V0KCJQYXJlbnQiKTsKCiAgICBpZiAoZmllbGRQYXJlbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHRoaXMucGFyZW50ID0gcGFyYW1zLmRpY3QuZ2V0UmF3KCJQYXJlbnQiKTsKICAgICAgY29uc3QgZmllbGRQYXJlbnRWYWx1ZSA9IGZpZWxkUGFyZW50LmdldCgiViIpOwoKICAgICAgaWYgKGZpZWxkUGFyZW50VmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgdGhpcy5kYXRhLmZpZWxkVmFsdWUgPSB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoZmllbGRQYXJlbnRWYWx1ZSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBhcHBlYXJhbmNlU3RhdGVzID0gcGFyYW1zLmRpY3QuZ2V0KCJBUCIpOwoKICAgIGlmICghKGFwcGVhcmFuY2VTdGF0ZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgbm9ybWFsQXBwZWFyYW5jZSA9IGFwcGVhcmFuY2VTdGF0ZXMuZ2V0KCJOIik7CgogICAgaWYgKCEobm9ybWFsQXBwZWFyYW5jZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGtleSBvZiBub3JtYWxBcHBlYXJhbmNlLmdldEtleXMoKSkgewogICAgICBpZiAoa2V5ICE9PSAiT2ZmIikgewogICAgICAgIHRoaXMuZGF0YS5idXR0b25WYWx1ZSA9IHRoaXMuX2RlY29kZUZvcm1WYWx1ZShrZXkpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgdGhpcy5jaGVja2VkQXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2UuZ2V0KHRoaXMuZGF0YS5idXR0b25WYWx1ZSkgfHwgbnVsbDsKICAgIHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2UuZ2V0KCJPZmYiKSB8fCBudWxsOwoKICAgIGlmICh0aGlzLmNoZWNrZWRBcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuX3N0cmVhbXMucHVzaCh0aGlzLmNoZWNrZWRBcHBlYXJhbmNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2dldERlZmF1bHRDaGVja2VkQXBwZWFyYW5jZShwYXJhbXMsICJkaXNjIik7CiAgICB9CgogICAgaWYgKHRoaXMudW5jaGVja2VkQXBwZWFyYW5jZSkgewogICAgICB0aGlzLl9zdHJlYW1zLnB1c2godGhpcy51bmNoZWNrZWRBcHBlYXJhbmNlKTsKICAgIH0KCiAgICB0aGlzLl9mYWxsYmFja0ZvbnREaWN0ID0gdGhpcy5mYWxsYmFja0ZvbnREaWN0OwogIH0KCiAgX3Byb2Nlc3NQdXNoQnV0dG9uKHBhcmFtcykgewogICAgaWYgKCFwYXJhbXMuZGljdC5oYXMoIkEiKSAmJiAhcGFyYW1zLmRpY3QuaGFzKCJBQSIpICYmICF0aGlzLmRhdGEuYWx0ZXJuYXRpdmVUZXh0KSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiUHVzaCBidXR0b25zIHdpdGhvdXQgYWN0aW9uIGRpY3Rpb25hcmllcyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5kYXRhLmlzVG9vbHRpcE9ubHkgPSAhcGFyYW1zLmRpY3QuaGFzKCJBIikgJiYgIXBhcmFtcy5kaWN0LmhhcygiQUEiKTsKCiAgICBfY2F0YWxvZy5DYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICBkZXN0RGljdDogcGFyYW1zLmRpY3QsCiAgICAgIHJlc3VsdE9iajogdGhpcy5kYXRhLAogICAgICBkb2NCYXNlVXJsOiBwYXJhbXMucGRmTWFuYWdlci5kb2NCYXNlVXJsCiAgICB9KTsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgbGV0IHR5cGUgPSAiYnV0dG9uIjsKICAgIGxldCBleHBvcnRWYWx1ZXM7CgogICAgaWYgKHRoaXMuZGF0YS5jaGVja0JveCkgewogICAgICB0eXBlID0gImNoZWNrYm94IjsKICAgICAgZXhwb3J0VmFsdWVzID0gdGhpcy5kYXRhLmV4cG9ydFZhbHVlOwogICAgfSBlbHNlIGlmICh0aGlzLmRhdGEucmFkaW9CdXR0b24pIHsKICAgICAgdHlwZSA9ICJyYWRpb2J1dHRvbiI7CiAgICAgIGV4cG9ydFZhbHVlcyA9IHRoaXMuZGF0YS5idXR0b25WYWx1ZTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBpZDogdGhpcy5kYXRhLmlkLAogICAgICB2YWx1ZTogdGhpcy5kYXRhLmZpZWxkVmFsdWUgfHwgIk9mZiIsCiAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5kYXRhLmRlZmF1bHRGaWVsZFZhbHVlLAogICAgICBleHBvcnRWYWx1ZXMsCiAgICAgIGVkaXRhYmxlOiAhdGhpcy5kYXRhLnJlYWRPbmx5LAogICAgICBuYW1lOiB0aGlzLmRhdGEuZmllbGROYW1lLAogICAgICByZWN0OiB0aGlzLmRhdGEucmVjdCwKICAgICAgaGlkZGVuOiB0aGlzLmRhdGEuaGlkZGVuLAogICAgICBhY3Rpb25zOiB0aGlzLmRhdGEuYWN0aW9ucywKICAgICAgcGFnZTogdGhpcy5kYXRhLnBhZ2VJbmRleCwKICAgICAgc3Ryb2tlQ29sb3I6IHRoaXMuZGF0YS5ib3JkZXJDb2xvciwKICAgICAgZmlsbENvbG9yOiB0aGlzLmRhdGEuYmFja2dyb3VuZENvbG9yLAogICAgICByb3RhdGlvbjogdGhpcy5yb3RhdGlvbiwKICAgICAgdHlwZQogICAgfTsKICB9CgogIGdldCBmYWxsYmFja0ZvbnREaWN0KCkgewogICAgY29uc3QgZGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KCk7CiAgICBkaWN0LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWmFwZkRpbmdiYXRzIikpOwogICAgZGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlphcGZEaW5nYmF0c0VuY29kaW5nIikpOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJmYWxsYmFja0ZvbnREaWN0IiwgZGljdCk7CiAgfQoKfQoKY2xhc3MgQ2hvaWNlV2lkZ2V0QW5ub3RhdGlvbiBleHRlbmRzIFdpZGdldEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtcykgewogICAgc3VwZXIocGFyYW1zKTsKICAgIHRoaXMuZGF0YS5vcHRpb25zID0gW107CiAgICBjb25zdCBvcHRpb25zID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdDogcGFyYW1zLmRpY3QsCiAgICAgIGtleTogIk9wdCIKICAgIH0pOwoKICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMpKSB7CiAgICAgIGNvbnN0IHhyZWYgPSBwYXJhbXMueHJlZjsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IG9wdGlvbnMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IG9wdGlvbiA9IHhyZWYuZmV0Y2hJZlJlZihvcHRpb25zW2ldKTsKICAgICAgICBjb25zdCBpc09wdGlvbkFycmF5ID0gQXJyYXkuaXNBcnJheShvcHRpb24pOwogICAgICAgIHRoaXMuZGF0YS5vcHRpb25zW2ldID0gewogICAgICAgICAgZXhwb3J0VmFsdWU6IHRoaXMuX2RlY29kZUZvcm1WYWx1ZShpc09wdGlvbkFycmF5ID8geHJlZi5mZXRjaElmUmVmKG9wdGlvblswXSkgOiBvcHRpb24pLAogICAgICAgICAgZGlzcGxheVZhbHVlOiB0aGlzLl9kZWNvZGVGb3JtVmFsdWUoaXNPcHRpb25BcnJheSA/IHhyZWYuZmV0Y2hJZlJlZihvcHRpb25bMV0pIDogb3B0aW9uKQogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZW9mIHRoaXMuZGF0YS5maWVsZFZhbHVlID09PSAic3RyaW5nIikgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IFt0aGlzLmRhdGEuZmllbGRWYWx1ZV07CiAgICB9IGVsc2UgaWYgKCF0aGlzLmRhdGEuZmllbGRWYWx1ZSkgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IFtdOwogICAgfQoKICAgIHRoaXMuZGF0YS5jb21ibyA9IHRoaXMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuQ09NQk8pOwogICAgdGhpcy5kYXRhLm11bHRpU2VsZWN0ID0gdGhpcy5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5NVUxUSVNFTEVDVCk7CiAgICB0aGlzLl9oYXNUZXh0ID0gdHJ1ZTsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgY29uc3QgdHlwZSA9IHRoaXMuZGF0YS5jb21ibyA/ICJjb21ib2JveCIgOiAibGlzdGJveCI7CiAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5maWVsZFZhbHVlLmxlbmd0aCA+IDAgPyB0aGlzLmRhdGEuZmllbGRWYWx1ZVswXSA6IG51bGw7CiAgICByZXR1cm4gewogICAgICBpZDogdGhpcy5kYXRhLmlkLAogICAgICB2YWx1ZSwKICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLmRhdGEuZGVmYXVsdEZpZWxkVmFsdWUsCiAgICAgIGVkaXRhYmxlOiAhdGhpcy5kYXRhLnJlYWRPbmx5LAogICAgICBuYW1lOiB0aGlzLmRhdGEuZmllbGROYW1lLAogICAgICByZWN0OiB0aGlzLmRhdGEucmVjdCwKICAgICAgbnVtSXRlbXM6IHRoaXMuZGF0YS5maWVsZFZhbHVlLmxlbmd0aCwKICAgICAgbXVsdGlwbGVTZWxlY3Rpb246IHRoaXMuZGF0YS5tdWx0aVNlbGVjdCwKICAgICAgaGlkZGVuOiB0aGlzLmRhdGEuaGlkZGVuLAogICAgICBhY3Rpb25zOiB0aGlzLmRhdGEuYWN0aW9ucywKICAgICAgaXRlbXM6IHRoaXMuZGF0YS5vcHRpb25zLAogICAgICBwYWdlOiB0aGlzLmRhdGEucGFnZUluZGV4LAogICAgICBzdHJva2VDb2xvcjogdGhpcy5kYXRhLmJvcmRlckNvbG9yLAogICAgICBmaWxsQ29sb3I6IHRoaXMuZGF0YS5iYWNrZ3JvdW5kQ29sb3IsCiAgICAgIHJvdGF0aW9uOiB0aGlzLnJvdGF0aW9uLAogICAgICB0eXBlCiAgICB9OwogIH0KCiAgYXN5bmMgX2dldEFwcGVhcmFuY2UoZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgaWYgKHRoaXMuZGF0YS5jb21ibykgewogICAgICByZXR1cm4gc3VwZXIuX2dldEFwcGVhcmFuY2UoZXZhbHVhdG9yLCB0YXNrLCBhbm5vdGF0aW9uU3RvcmFnZSk7CiAgICB9CgogICAgaWYgKCFhbm5vdGF0aW9uU3RvcmFnZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBhbm5vdGF0aW9uU3RvcmFnZS5nZXQodGhpcy5kYXRhLmlkKTsKCiAgICBpZiAoIXN0b3JhZ2VFbnRyeSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCByb3RhdGlvbiA9IHN0b3JhZ2VFbnRyeS5yb3RhdGlvbjsKICAgIGxldCBleHBvcnRlZFZhbHVlID0gc3RvcmFnZUVudHJ5LnZhbHVlOwoKICAgIGlmIChyb3RhdGlvbiA9PT0gdW5kZWZpbmVkICYmIGV4cG9ydGVkVmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAoZXhwb3J0ZWRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGV4cG9ydGVkVmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZTsKICAgIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoZXhwb3J0ZWRWYWx1ZSkpIHsKICAgICAgZXhwb3J0ZWRWYWx1ZSA9IFtleHBvcnRlZFZhbHVlXTsKICAgIH0KCiAgICBjb25zdCBkZWZhdWx0UGFkZGluZyA9IDI7CiAgICBjb25zdCBoUGFkZGluZyA9IGRlZmF1bHRQYWRkaW5nOwogICAgbGV0IHRvdGFsSGVpZ2h0ID0gdGhpcy5kYXRhLnJlY3RbM10gLSB0aGlzLmRhdGEucmVjdFsxXTsKICAgIGxldCB0b3RhbFdpZHRoID0gdGhpcy5kYXRhLnJlY3RbMl0gLSB0aGlzLmRhdGEucmVjdFswXTsKCiAgICBpZiAocm90YXRpb24gPT09IDkwIHx8IHJvdGF0aW9uID09PSAyNzApIHsKICAgICAgW3RvdGFsV2lkdGgsIHRvdGFsSGVpZ2h0XSA9IFt0b3RhbEhlaWdodCwgdG90YWxXaWR0aF07CiAgICB9CgogICAgY29uc3QgbGluZUNvdW50ID0gdGhpcy5kYXRhLm9wdGlvbnMubGVuZ3RoOwogICAgY29uc3QgdmFsdWVJbmRpY2VzID0gW107CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lQ291bnQ7IGkrKykgewogICAgICBjb25zdCB7CiAgICAgICAgZXhwb3J0VmFsdWUKICAgICAgfSA9IHRoaXMuZGF0YS5vcHRpb25zW2ldOwoKICAgICAgaWYgKGV4cG9ydGVkVmFsdWUuaW5jbHVkZXMoZXhwb3J0VmFsdWUpKSB7CiAgICAgICAgdmFsdWVJbmRpY2VzLnB1c2goaSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMuX2RlZmF1bHRBcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZURhdGEgPSAoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5wYXJzZURlZmF1bHRBcHBlYXJhbmNlKSh0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZSA9ICIvSGVsdmV0aWNhIDAgVGYgMCBnIik7CiAgICB9CgogICAgY29uc3QgZm9udCA9IGF3YWl0IFdpZGdldEFubm90YXRpb24uX2dldEZvbnREYXRhKGV2YWx1YXRvciwgdGFzaywgdGhpcy5kYXRhLmRlZmF1bHRBcHBlYXJhbmNlRGF0YSwgdGhpcy5fZmllbGRSZXNvdXJjZXMubWVyZ2VkUmVzb3VyY2VzKTsKICAgIGxldCBkZWZhdWx0QXBwZWFyYW5jZTsKICAgIGxldCB7CiAgICAgIGZvbnRTaXplCiAgICB9ID0gdGhpcy5kYXRhLmRlZmF1bHRBcHBlYXJhbmNlRGF0YTsKCiAgICBpZiAoIWZvbnRTaXplKSB7CiAgICAgIGNvbnN0IGxpbmVIZWlnaHQgPSAodG90YWxIZWlnaHQgLSBkZWZhdWx0UGFkZGluZykgLyBsaW5lQ291bnQ7CiAgICAgIGxldCBsaW5lV2lkdGggPSAtMTsKICAgICAgbGV0IHZhbHVlOwoKICAgICAgZm9yIChjb25zdCB7CiAgICAgICAgZGlzcGxheVZhbHVlCiAgICAgIH0gb2YgdGhpcy5kYXRhLm9wdGlvbnMpIHsKICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aChkaXNwbGF5VmFsdWUsIGZvbnQpOwoKICAgICAgICBpZiAod2lkdGggPiBsaW5lV2lkdGgpIHsKICAgICAgICAgIGxpbmVXaWR0aCA9IHdpZHRoOwogICAgICAgICAgdmFsdWUgPSBkaXNwbGF5VmFsdWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBbZGVmYXVsdEFwcGVhcmFuY2UsIGZvbnRTaXplXSA9IHRoaXMuX2NvbXB1dGVGb250U2l6ZShsaW5lSGVpZ2h0LCB0b3RhbFdpZHRoIC0gMiAqIGhQYWRkaW5nLCB2YWx1ZSwgZm9udCwgLTEpOwogICAgfSBlbHNlIHsKICAgICAgZGVmYXVsdEFwcGVhcmFuY2UgPSB0aGlzLl9kZWZhdWx0QXBwZWFyYW5jZTsKICAgIH0KCiAgICBjb25zdCBsaW5lSGVpZ2h0ID0gZm9udFNpemUgKiBfdXRpbC5MSU5FX0ZBQ1RPUjsKICAgIGNvbnN0IHZQYWRkaW5nID0gKGxpbmVIZWlnaHQgLSBmb250U2l6ZSkgLyAyOwogICAgY29uc3QgbnVtYmVyT2ZWaXNpYmxlTGluZXMgPSBNYXRoLmZsb29yKHRvdGFsSGVpZ2h0IC8gbGluZUhlaWdodCk7CiAgICBsZXQgZmlyc3RJbmRleDsKCiAgICBpZiAodmFsdWVJbmRpY2VzLmxlbmd0aCA9PT0gMSkgewogICAgICBjb25zdCB2YWx1ZVBvc2l0aW9uID0gdmFsdWVJbmRpY2VzWzBdOwogICAgICBjb25zdCBpbmRleEluUGFnZSA9IHZhbHVlUG9zaXRpb24gJSBudW1iZXJPZlZpc2libGVMaW5lczsKICAgICAgZmlyc3RJbmRleCA9IHZhbHVlUG9zaXRpb24gLSBpbmRleEluUGFnZTsKICAgIH0gZWxzZSB7CiAgICAgIGZpcnN0SW5kZXggPSB2YWx1ZUluZGljZXMubGVuZ3RoID8gdmFsdWVJbmRpY2VzWzBdIDogMDsKICAgIH0KCiAgICBjb25zdCBlbmQgPSBNYXRoLm1pbihmaXJzdEluZGV4ICsgbnVtYmVyT2ZWaXNpYmxlTGluZXMgKyAxLCBsaW5lQ291bnQpOwogICAgY29uc3QgYnVmID0gWyIvVHggQk1DIHEiLCBgMSAxICR7dG90YWxXaWR0aH0gJHt0b3RhbEhlaWdodH0gcmUgVyBuYF07CgogICAgaWYgKHZhbHVlSW5kaWNlcy5sZW5ndGgpIHsKICAgICAgYnVmLnB1c2goIjAuNjAwMDA2IDAuNzU2ODY2IDAuODU0OTA0IHJnIik7CgogICAgICBmb3IgKGNvbnN0IGluZGV4IG9mIHZhbHVlSW5kaWNlcykgewogICAgICAgIGlmIChmaXJzdEluZGV4IDw9IGluZGV4ICYmIGluZGV4IDwgZW5kKSB7CiAgICAgICAgICBidWYucHVzaChgMSAke3RvdGFsSGVpZ2h0IC0gKGluZGV4IC0gZmlyc3RJbmRleCArIDEpICogbGluZUhlaWdodH0gJHt0b3RhbFdpZHRofSAke2xpbmVIZWlnaHR9IHJlIGZgKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBidWYucHVzaCgiQlQiLCBkZWZhdWx0QXBwZWFyYW5jZSwgYDEgMCAwIDEgMCAke3RvdGFsSGVpZ2h0fSBUbWApOwoKICAgIGZvciAobGV0IGkgPSBmaXJzdEluZGV4OyBpIDwgZW5kOyBpKyspIHsKICAgICAgY29uc3QgewogICAgICAgIGRpc3BsYXlWYWx1ZQogICAgICB9ID0gdGhpcy5kYXRhLm9wdGlvbnNbaV07CiAgICAgIGNvbnN0IGhwYWRkaW5nID0gaSA9PT0gZmlyc3RJbmRleCA/IGhQYWRkaW5nIDogMDsKICAgICAgY29uc3QgdnBhZGRpbmcgPSBpID09PSBmaXJzdEluZGV4ID8gdlBhZGRpbmcgOiAwOwogICAgICBidWYucHVzaCh0aGlzLl9yZW5kZXJUZXh0KGRpc3BsYXlWYWx1ZSwgZm9udCwgZm9udFNpemUsIHRvdGFsV2lkdGgsIDAsIGhwYWRkaW5nLCAtbGluZUhlaWdodCArIHZwYWRkaW5nKSk7CiAgICB9CgogICAgYnVmLnB1c2goIkVUIFEgRU1DIik7CiAgICByZXR1cm4gYnVmLmpvaW4oIlxuIik7CiAgfQoKfQoKY2xhc3MgU2lnbmF0dXJlV2lkZ2V0QW5ub3RhdGlvbiBleHRlbmRzIFdpZGdldEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtcykgewogICAgc3VwZXIocGFyYW1zKTsKICAgIHRoaXMuZGF0YS5maWVsZFZhbHVlID0gbnVsbDsKICB9CgogIGdldEZpZWxkT2JqZWN0KCkgewogICAgcmV0dXJuIHsKICAgICAgaWQ6IHRoaXMuZGF0YS5pZCwKICAgICAgdmFsdWU6IG51bGwsCiAgICAgIHBhZ2U6IHRoaXMuZGF0YS5wYWdlSW5kZXgsCiAgICAgIHR5cGU6ICJzaWduYXR1cmUiCiAgICB9OwogIH0KCn0KCmNsYXNzIFRleHRBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgY29uc3QgREVGQVVMVF9JQ09OX1NJWkUgPSAyMjsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgY29uc3QgZGljdCA9IHBhcmFtZXRlcnMuZGljdDsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlRFWFQ7CgogICAgaWYgKHRoaXMuZGF0YS5oYXNBcHBlYXJhbmNlKSB7CiAgICAgIHRoaXMuZGF0YS5uYW1lID0gIk5vSWNvbiI7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEucmVjdFsxXSA9IHRoaXMuZGF0YS5yZWN0WzNdIC0gREVGQVVMVF9JQ09OX1NJWkU7CiAgICAgIHRoaXMuZGF0YS5yZWN0WzJdID0gdGhpcy5kYXRhLnJlY3RbMF0gKyBERUZBVUxUX0lDT05fU0laRTsKICAgICAgdGhpcy5kYXRhLm5hbWUgPSBkaWN0LmhhcygiTmFtZSIpID8gZGljdC5nZXQoIk5hbWUiKS5uYW1lIDogIk5vdGUiOwogICAgfQoKICAgIGlmIChkaWN0LmhhcygiU3RhdGUiKSkgewogICAgICB0aGlzLmRhdGEuc3RhdGUgPSBkaWN0LmdldCgiU3RhdGUiKSB8fCBudWxsOwogICAgICB0aGlzLmRhdGEuc3RhdGVNb2RlbCA9IGRpY3QuZ2V0KCJTdGF0ZU1vZGVsIikgfHwgbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS5zdGF0ZSA9IG51bGw7CiAgICAgIHRoaXMuZGF0YS5zdGF0ZU1vZGVsID0gbnVsbDsKICAgIH0KICB9Cgp9CgpjbGFzcyBMaW5rQW5ub3RhdGlvbiBleHRlbmRzIEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtcykgewogICAgc3VwZXIocGFyYW1zKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLkxJTks7CiAgICBjb25zdCBxdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbXMuZGljdCwgdGhpcy5yZWN0YW5nbGUpOwoKICAgIGlmIChxdWFkUG9pbnRzKSB7CiAgICAgIHRoaXMuZGF0YS5xdWFkUG9pbnRzID0gcXVhZFBvaW50czsKICAgIH0KCiAgICB0aGlzLmRhdGEuYm9yZGVyQ29sb3IgPSB0aGlzLmRhdGEuYm9yZGVyQ29sb3IgfHwgdGhpcy5kYXRhLmNvbG9yOwoKICAgIF9jYXRhbG9nLkNhdGFsb2cucGFyc2VEZXN0RGljdGlvbmFyeSh7CiAgICAgIGRlc3REaWN0OiBwYXJhbXMuZGljdCwKICAgICAgcmVzdWx0T2JqOiB0aGlzLmRhdGEsCiAgICAgIGRvY0Jhc2VVcmw6IHBhcmFtcy5wZGZNYW5hZ2VyLmRvY0Jhc2VVcmwKICAgIH0pOwogIH0KCn0KCmNsYXNzIFBvcHVwQW5ub3RhdGlvbiBleHRlbmRzIEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuUE9QVVA7CiAgICBsZXQgcGFyZW50SXRlbSA9IHBhcmFtZXRlcnMuZGljdC5nZXQoIlBhcmVudCIpOwoKICAgIGlmICghcGFyZW50SXRlbSkgewogICAgICAoMCwgX3V0aWwud2FybikoIlBvcHVwIGFubm90YXRpb24gaGFzIGEgbWlzc2luZyBvciBpbnZhbGlkIHBhcmVudCBhbm5vdGF0aW9uLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcGFyZW50U3VidHlwZSA9IHBhcmVudEl0ZW0uZ2V0KCJTdWJ0eXBlIik7CiAgICB0aGlzLmRhdGEucGFyZW50VHlwZSA9IHBhcmVudFN1YnR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gcGFyZW50U3VidHlwZS5uYW1lIDogbnVsbDsKICAgIGNvbnN0IHJhd1BhcmVudCA9IHBhcmFtZXRlcnMuZGljdC5nZXRSYXcoIlBhcmVudCIpOwogICAgdGhpcy5kYXRhLnBhcmVudElkID0gcmF3UGFyZW50IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8gcmF3UGFyZW50LnRvU3RyaW5nKCkgOiBudWxsOwogICAgY29uc3QgcGFyZW50UmVjdCA9IHBhcmVudEl0ZW0uZ2V0QXJyYXkoIlJlY3QiKTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJlbnRSZWN0KSAmJiBwYXJlbnRSZWN0Lmxlbmd0aCA9PT0gNCkgewogICAgICB0aGlzLmRhdGEucGFyZW50UmVjdCA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdChwYXJlbnRSZWN0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS5wYXJlbnRSZWN0ID0gWzAsIDAsIDAsIDBdOwogICAgfQoKICAgIGNvbnN0IHJ0ID0gcGFyZW50SXRlbS5nZXQoIlJUIik7CgogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHJ0LCBfdXRpbC5Bbm5vdGF0aW9uUmVwbHlUeXBlLkdST1VQKSkgewogICAgICBwYXJlbnRJdGVtID0gcGFyZW50SXRlbS5nZXQoIklSVCIpOwogICAgfQoKICAgIGlmICghcGFyZW50SXRlbS5oYXMoIk0iKSkgewogICAgICB0aGlzLmRhdGEubW9kaWZpY2F0aW9uRGF0ZSA9IG51bGw7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnNldE1vZGlmaWNhdGlvbkRhdGUocGFyZW50SXRlbS5nZXQoIk0iKSk7CiAgICAgIHRoaXMuZGF0YS5tb2RpZmljYXRpb25EYXRlID0gdGhpcy5tb2RpZmljYXRpb25EYXRlOwogICAgfQoKICAgIGlmICghcGFyZW50SXRlbS5oYXMoIkMiKSkgewogICAgICB0aGlzLmRhdGEuY29sb3IgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zZXRDb2xvcihwYXJlbnRJdGVtLmdldEFycmF5KCJDIikpOwogICAgICB0aGlzLmRhdGEuY29sb3IgPSB0aGlzLmNvbG9yOwogICAgfQoKICAgIGlmICghdGhpcy52aWV3YWJsZSkgewogICAgICBjb25zdCBwYXJlbnRGbGFncyA9IHBhcmVudEl0ZW0uZ2V0KCJGIik7CgogICAgICBpZiAodGhpcy5faXNWaWV3YWJsZShwYXJlbnRGbGFncykpIHsKICAgICAgICB0aGlzLnNldEZsYWdzKHBhcmVudEZsYWdzKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuc2V0VGl0bGUocGFyZW50SXRlbS5nZXQoIlQiKSk7CiAgICB0aGlzLmRhdGEudGl0bGVPYmogPSB0aGlzLl90aXRsZTsKICAgIHRoaXMuc2V0Q29udGVudHMocGFyZW50SXRlbS5nZXQoIkNvbnRlbnRzIikpOwogICAgdGhpcy5kYXRhLmNvbnRlbnRzT2JqID0gdGhpcy5fY29udGVudHM7CgogICAgaWYgKHBhcmVudEl0ZW0uaGFzKCJSQyIpKSB7CiAgICAgIHRoaXMuZGF0YS5yaWNoVGV4dCA9IF9mYWN0b3J5LlhGQUZhY3RvcnkuZ2V0UmljaFRleHRBc0h0bWwocGFyZW50SXRlbS5nZXQoIlJDIikpOwogICAgfQogIH0KCn0KCmV4cG9ydHMuUG9wdXBBbm5vdGF0aW9uID0gUG9wdXBBbm5vdGF0aW9uOwoKY2xhc3MgRnJlZVRleHRBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5GUkVFVEVYVDsKICB9CgogIGdldCBoYXNUZXh0Q29udGVudCgpIHsKICAgIHJldHVybiAhIXRoaXMuYXBwZWFyYW5jZTsKICB9CgogIHN0YXRpYyBjcmVhdGVOZXdEaWN0KGFubm90YXRpb24sIHhyZWYsIHsKICAgIGFwUmVmLAogICAgYXAKICB9KSB7CiAgICBjb25zdCB7CiAgICAgIGNvbG9yLAogICAgICBmb250U2l6ZSwKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24sCiAgICAgIHVzZXIsCiAgICAgIHZhbHVlCiAgICB9ID0gYW5ub3RhdGlvbjsKICAgIGNvbnN0IGZyZWV0ZXh0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBmcmVldGV4dC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiQW5ub3QiKSk7CiAgICBmcmVldGV4dC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRnJlZVRleHQiKSk7CiAgICBmcmVldGV4dC5zZXQoIkNyZWF0aW9uRGF0ZSIsIGBEOiR7KDAsIF91dGlsLmdldE1vZGlmaWNhdGlvbkRhdGUpKCl9YCk7CiAgICBmcmVldGV4dC5zZXQoIlJlY3QiLCByZWN0KTsKICAgIGNvbnN0IGRhID0gYC9IZWx2ICR7Zm9udFNpemV9IFRmICR7KDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UuZ2V0UGRmQ29sb3IpKGNvbG9yLCB0cnVlKX1gOwogICAgZnJlZXRleHQuc2V0KCJEQSIsIGRhKTsKICAgIGZyZWV0ZXh0LnNldCgiQ29udGVudHMiLCB2YWx1ZSk7CiAgICBmcmVldGV4dC5zZXQoIkYiLCA0KTsKICAgIGZyZWV0ZXh0LnNldCgiQm9yZGVyIiwgWzAsIDAsIDBdKTsKICAgIGZyZWV0ZXh0LnNldCgiUm90YXRlIiwgcm90YXRpb24pOwoKICAgIGlmICh1c2VyKSB7CiAgICAgIGZyZWV0ZXh0LnNldCgiVCIsICgwLCBfdXRpbC5zdHJpbmdUb1VURjhTdHJpbmcpKHVzZXIpKTsKICAgIH0KCiAgICBjb25zdCBuID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICBmcmVldGV4dC5zZXQoIkFQIiwgbik7CgogICAgaWYgKGFwUmVmKSB7CiAgICAgIG4uc2V0KCJOIiwgYXBSZWYpOwogICAgfSBlbHNlIHsKICAgICAgbi5zZXQoIk4iLCBhcCk7CiAgICB9CgogICAgcmV0dXJuIGZyZWV0ZXh0OwogIH0KCiAgc3RhdGljIGFzeW5jIGNyZWF0ZU5ld0FwcGVhcmFuY2VTdHJlYW0oYW5ub3RhdGlvbiwgeHJlZiwgcGFyYW1zKSB7CiAgICBjb25zdCB7CiAgICAgIGJhc2VGb250UmVmLAogICAgICBldmFsdWF0b3IsCiAgICAgIHRhc2sKICAgIH0gPSBwYXJhbXM7CiAgICBjb25zdCB7CiAgICAgIGNvbG9yLAogICAgICBmb250U2l6ZSwKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24sCiAgICAgIHZhbHVlCiAgICB9ID0gYW5ub3RhdGlvbjsKICAgIGNvbnN0IHJlc291cmNlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgY29uc3QgZm9udCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwoKICAgIGlmIChiYXNlRm9udFJlZikgewogICAgICBmb250LnNldCgiSGVsdiIsIGJhc2VGb250UmVmKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGJhc2VGb250ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QoeHJlZik7CiAgICAgIGJhc2VGb250LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSGVsdmV0aWNhIikpOwogICAgICBiYXNlRm9udC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRm9udCIpKTsKICAgICAgYmFzZUZvbnQuc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlR5cGUxIikpOwogICAgICBiYXNlRm9udC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIldpbkFuc2lFbmNvZGluZyIpKTsKICAgICAgZm9udC5zZXQoIkhlbHYiLCBiYXNlRm9udCk7CiAgICB9CgogICAgcmVzb3VyY2VzLnNldCgiRm9udCIsIGZvbnQpOwogICAgY29uc3QgaGVsdiA9IGF3YWl0IFdpZGdldEFubm90YXRpb24uX2dldEZvbnREYXRhKGV2YWx1YXRvciwgdGFzaywgewogICAgICBmb250TmFtZTogIkhlbHZldGljYSIsCiAgICAgIGZvbnRTaXplCiAgICB9LCByZXNvdXJjZXMpOwogICAgY29uc3QgW3gxLCB5MSwgeDIsIHkyXSA9IHJlY3Q7CiAgICBsZXQgdyA9IHgyIC0geDE7CiAgICBsZXQgaCA9IHkyIC0geTE7CgogICAgaWYgKHJvdGF0aW9uICUgMTgwICE9PSAwKSB7CiAgICAgIFt3LCBoXSA9IFtoLCB3XTsKICAgIH0KCiAgICBjb25zdCBsaW5lcyA9IHZhbHVlLnNwbGl0KCJcbiIpOwogICAgY29uc3Qgc2NhbGUgPSBmb250U2l6ZSAvIDEwMDA7CiAgICBsZXQgdG90YWxXaWR0aCA9IC1JbmZpbml0eTsKICAgIGNvbnN0IGVuY29kZWRMaW5lcyA9IFtdOwoKICAgIGZvciAobGV0IGxpbmUgb2YgbGluZXMpIHsKICAgICAgbGluZSA9IGhlbHYuZW5jb2RlU3RyaW5nKGxpbmUpLmpvaW4oIiIpOwogICAgICBlbmNvZGVkTGluZXMucHVzaChsaW5lKTsKICAgICAgbGV0IGxpbmVXaWR0aCA9IDA7CiAgICAgIGNvbnN0IGdseXBocyA9IGhlbHYuY2hhcnNUb0dseXBocyhsaW5lKTsKCiAgICAgIGZvciAoY29uc3QgZ2x5cGggb2YgZ2x5cGhzKSB7CiAgICAgICAgbGluZVdpZHRoICs9IGdseXBoLndpZHRoICogc2NhbGU7CiAgICAgIH0KCiAgICAgIHRvdGFsV2lkdGggPSBNYXRoLm1heCh0b3RhbFdpZHRoLCBsaW5lV2lkdGgpOwogICAgfQoKICAgIGxldCBoc2NhbGUgPSAxOwoKICAgIGlmICh0b3RhbFdpZHRoID4gdykgewogICAgICBoc2NhbGUgPSB3IC8gdG90YWxXaWR0aDsKICAgIH0KCiAgICBsZXQgdnNjYWxlID0gMTsKICAgIGNvbnN0IGxpbmVIZWlnaHQgPSBfdXRpbC5MSU5FX0ZBQ1RPUiAqIGZvbnRTaXplOwogICAgY29uc3QgbGluZURlc2NlbnQgPSBfdXRpbC5MSU5FX0RFU0NFTlRfRkFDVE9SICogZm9udFNpemU7CiAgICBjb25zdCB0b3RhbEhlaWdodCA9IGxpbmVIZWlnaHQgKiBsaW5lcy5sZW5ndGg7CgogICAgaWYgKHRvdGFsSGVpZ2h0ID4gaCkgewogICAgICB2c2NhbGUgPSBoIC8gdG90YWxIZWlnaHQ7CiAgICB9CgogICAgY29uc3QgZnNjYWxlID0gTWF0aC5taW4oaHNjYWxlLCB2c2NhbGUpOwogICAgY29uc3QgbmV3Rm9udFNpemUgPSBmb250U2l6ZSAqIGZzY2FsZTsKICAgIGNvbnN0IGJ1ZmZlciA9IFsicSIsIGAwIDAgJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKHcpfSAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoaCl9IHJlIFcgbmAsIGBCVGAsIGAxIDAgMCAxIDAgJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKGggKyBsaW5lRGVzY2VudCl9IFRtIDAgVGMgJHsoMCwgX2RlZmF1bHRfYXBwZWFyYW5jZS5nZXRQZGZDb2xvcikoY29sb3IsIHRydWUpfWAsIGAvSGVsdiAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykobmV3Rm9udFNpemUpfSBUZmBdOwogICAgY29uc3QgdlNoaWZ0ID0gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKShsaW5lSGVpZ2h0KTsKCiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZW5jb2RlZExpbmVzKSB7CiAgICAgIGJ1ZmZlci5wdXNoKGAwIC0ke3ZTaGlmdH0gVGQgKCR7KDAsIF91dGlsLmVzY2FwZVN0cmluZykobGluZSl9KSBUamApOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKCJFVCIsICJRIik7CiAgICBjb25zdCBhcHBlYXJhbmNlID0gYnVmZmVyLmpvaW4oIlxuIik7CiAgICBjb25zdCBhcHBlYXJhbmNlU3RyZWFtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJGb3JtVHlwZSIsIDEpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWE9iamVjdCIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiQkJveCIsIFswLCAwLCB3LCBoXSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIkxlbmd0aCIsIGFwcGVhcmFuY2UubGVuZ3RoKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiUmVzb3VyY2VzIiwgcmVzb3VyY2VzKTsKCiAgICBpZiAocm90YXRpb24pIHsKICAgICAgY29uc3QgbWF0cml4ID0gV2lkZ2V0QW5ub3RhdGlvbi5fZ2V0Um90YXRpb25NYXRyaXgocm90YXRpb24sIHcsIGgpOwoKICAgICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJNYXRyaXgiLCBtYXRyaXgpOwogICAgfQoKICAgIGNvbnN0IGFwID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGFwcGVhcmFuY2UpOwogICAgYXAuZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwogICAgcmV0dXJuIGFwOwogIH0KCn0KCmNsYXNzIExpbmVBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICBjb25zdCB7CiAgICAgIGRpY3QKICAgIH0gPSBwYXJhbWV0ZXJzOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuTElORTsKICAgIGNvbnN0IGxpbmVDb29yZGluYXRlcyA9IGRpY3QuZ2V0QXJyYXkoIkwiKTsKICAgIHRoaXMuZGF0YS5saW5lQ29vcmRpbmF0ZXMgPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QobGluZUNvb3JkaW5hdGVzKTsKICAgIHRoaXMuc2V0TGluZUVuZGluZ3MoZGljdC5nZXRBcnJheSgiTEUiKSk7CiAgICB0aGlzLmRhdGEubGluZUVuZGluZ3MgPSB0aGlzLmxpbmVFbmRpbmdzOwoKICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgIGNvbnN0IHN0cm9rZUFscGhhID0gZGljdC5nZXQoIkNBIik7CiAgICAgIGxldCBmaWxsQ29sb3IgPSBudWxsLAogICAgICAgICAgaW50ZXJpb3JDb2xvciA9IGRpY3QuZ2V0QXJyYXkoIklDIik7CgogICAgICBpZiAoaW50ZXJpb3JDb2xvcikgewogICAgICAgIGludGVyaW9yQ29sb3IgPSBnZXRSZ2JDb2xvcihpbnRlcmlvckNvbG9yLCBudWxsKTsKICAgICAgICBmaWxsQ29sb3IgPSBpbnRlcmlvckNvbG9yID8gQXJyYXkuZnJvbShpbnRlcmlvckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZpbGxBbHBoYSA9IGZpbGxDb2xvciA/IHN0cm9rZUFscGhhIDogbnVsbDsKICAgICAgY29uc3QgYm9yZGVyV2lkdGggPSB0aGlzLmJvcmRlclN0eWxlLndpZHRoIHx8IDEsCiAgICAgICAgICAgIGJvcmRlckFkanVzdCA9IDIgKiBib3JkZXJXaWR0aDsKICAgICAgY29uc3QgYmJveCA9IFt0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzBdIC0gYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzFdIC0gYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzJdICsgYm9yZGVyQWRqdXN0LCB0aGlzLmRhdGEubGluZUNvb3JkaW5hdGVzWzNdICsgYm9yZGVyQWRqdXN0XTsKCiAgICAgIGlmICghX3V0aWwuVXRpbC5pbnRlcnNlY3QodGhpcy5yZWN0YW5nbGUsIGJib3gpKSB7CiAgICAgICAgdGhpcy5yZWN0YW5nbGUgPSBiYm94OwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHtib3JkZXJXaWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgZmlsbENvbG9yLAogICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgIGZpbGxBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBidWZmZXIucHVzaChgJHtsaW5lQ29vcmRpbmF0ZXNbMF19ICR7bGluZUNvb3JkaW5hdGVzWzFdfSBtYCwgYCR7bGluZUNvb3JkaW5hdGVzWzJdfSAke2xpbmVDb29yZGluYXRlc1szXX0gbGAsICJTIik7CiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54IC0gYm9yZGVyV2lkdGgsIHBvaW50c1sxXS54ICsgYm9yZGVyV2lkdGgsIHBvaW50c1szXS55IC0gYm9yZGVyV2lkdGgsIHBvaW50c1sxXS55ICsgYm9yZGVyV2lkdGhdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQoKfQoKY2xhc3MgU3F1YXJlQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuU1FVQVJFOwoKICAgIGlmICghdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgIGNvbnN0IHN0cm9rZUFscGhhID0gcGFyYW1ldGVycy5kaWN0LmdldCgiQ0EiKTsKICAgICAgbGV0IGZpbGxDb2xvciA9IG51bGwsCiAgICAgICAgICBpbnRlcmlvckNvbG9yID0gcGFyYW1ldGVycy5kaWN0LmdldEFycmF5KCJJQyIpOwoKICAgICAgaWYgKGludGVyaW9yQ29sb3IpIHsKICAgICAgICBpbnRlcmlvckNvbG9yID0gZ2V0UmdiQ29sb3IoaW50ZXJpb3JDb2xvciwgbnVsbCk7CiAgICAgICAgZmlsbENvbG9yID0gaW50ZXJpb3JDb2xvciA/IEFycmF5LmZyb20oaW50ZXJpb3JDb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBmaWxsQWxwaGEgPSBmaWxsQ29sb3IgPyBzdHJva2VBbHBoYSA6IG51bGw7CgogICAgICBpZiAodGhpcy5ib3JkZXJTdHlsZS53aWR0aCA9PT0gMCAmJiAhZmlsbENvbG9yKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHt0aGlzLmJvcmRlclN0eWxlLndpZHRofSB3YCwKICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICBmaWxsQ29sb3IsCiAgICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgICAgZmlsbEFscGhhLAogICAgICAgIHBvaW50c0NhbGxiYWNrOiAoYnVmZmVyLCBwb2ludHMpID0+IHsKICAgICAgICAgIGNvbnN0IHggPSBwb2ludHNbMl0ueCArIHRoaXMuYm9yZGVyU3R5bGUud2lkdGggLyAyOwogICAgICAgICAgY29uc3QgeSA9IHBvaW50c1syXS55ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB3aWR0aCA9IHBvaW50c1szXS54IC0gcG9pbnRzWzJdLnggLSB0aGlzLmJvcmRlclN0eWxlLndpZHRoOwogICAgICAgICAgY29uc3QgaGVpZ2h0ID0gcG9pbnRzWzFdLnkgLSBwb2ludHNbM10ueSAtIHRoaXMuYm9yZGVyU3R5bGUud2lkdGg7CiAgICAgICAgICBidWZmZXIucHVzaChgJHt4fSAke3l9ICR7d2lkdGh9ICR7aGVpZ2h0fSByZWApOwoKICAgICAgICAgIGlmIChmaWxsQ29sb3IpIHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goIkIiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKCJTIik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cgp9CgpjbGFzcyBDaXJjbGVBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5DSVJDTEU7CgogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwogICAgICBsZXQgZmlsbENvbG9yID0gbnVsbDsKICAgICAgbGV0IGludGVyaW9yQ29sb3IgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0QXJyYXkoIklDIik7CgogICAgICBpZiAoaW50ZXJpb3JDb2xvcikgewogICAgICAgIGludGVyaW9yQ29sb3IgPSBnZXRSZ2JDb2xvcihpbnRlcmlvckNvbG9yLCBudWxsKTsKICAgICAgICBmaWxsQ29sb3IgPSBpbnRlcmlvckNvbG9yID8gQXJyYXkuZnJvbShpbnRlcmlvckNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZpbGxBbHBoYSA9IGZpbGxDb2xvciA/IHN0cm9rZUFscGhhIDogbnVsbDsKCiAgICAgIGlmICh0aGlzLmJvcmRlclN0eWxlLndpZHRoID09PSAwICYmICFmaWxsQ29sb3IpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGNvbnRyb2xQb2ludHNEaXN0YW5jZSA9IDQgLyAzICogTWF0aC50YW4oTWF0aC5QSSAvICgyICogNCkpOwoKICAgICAgdGhpcy5fc2V0RGVmYXVsdEFwcGVhcmFuY2UoewogICAgICAgIHhyZWY6IHBhcmFtZXRlcnMueHJlZiwKICAgICAgICBleHRyYTogYCR7dGhpcy5ib3JkZXJTdHlsZS53aWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgZmlsbENvbG9yLAogICAgICAgIHN0cm9rZUFscGhhLAogICAgICAgIGZpbGxBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBjb25zdCB4MCA9IHBvaW50c1swXS54ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB5MCA9IHBvaW50c1swXS55IC0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB4MSA9IHBvaW50c1szXS54IC0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB5MSA9IHBvaW50c1szXS55ICsgdGhpcy5ib3JkZXJTdHlsZS53aWR0aCAvIDI7CiAgICAgICAgICBjb25zdCB4TWlkID0geDAgKyAoeDEgLSB4MCkgLyAyOwogICAgICAgICAgY29uc3QgeU1pZCA9IHkwICsgKHkxIC0geTApIC8gMjsKICAgICAgICAgIGNvbnN0IHhPZmZzZXQgPSAoeDEgLSB4MCkgLyAyICogY29udHJvbFBvaW50c0Rpc3RhbmNlOwogICAgICAgICAgY29uc3QgeU9mZnNldCA9ICh5MSAtIHkwKSAvIDIgKiBjb250cm9sUG9pbnRzRGlzdGFuY2U7CiAgICAgICAgICBidWZmZXIucHVzaChgJHt4TWlkfSAke3kxfSBtYCwgYCR7eE1pZCArIHhPZmZzZXR9ICR7eTF9ICR7eDF9ICR7eU1pZCArIHlPZmZzZXR9ICR7eDF9ICR7eU1pZH0gY2AsIGAke3gxfSAke3lNaWQgLSB5T2Zmc2V0fSAke3hNaWQgKyB4T2Zmc2V0fSAke3kwfSAke3hNaWR9ICR7eTB9IGNgLCBgJHt4TWlkIC0geE9mZnNldH0gJHt5MH0gJHt4MH0gJHt5TWlkIC0geU9mZnNldH0gJHt4MH0gJHt5TWlkfSBjYCwgYCR7eDB9ICR7eU1pZCArIHlPZmZzZXR9ICR7eE1pZCAtIHhPZmZzZXR9ICR7eTF9ICR7eE1pZH0gJHt5MX0gY2AsICJoIik7CgogICAgICAgICAgaWYgKGZpbGxDb2xvcikgewogICAgICAgICAgICBidWZmZXIucHVzaCgiQiIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goIlMiKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54LCBwb2ludHNbMV0ueCwgcG9pbnRzWzNdLnksIHBvaW50c1sxXS55XTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCn0KCmNsYXNzIFBvbHlsaW5lQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgY29uc3QgewogICAgICBkaWN0CiAgICB9ID0gcGFyYW1ldGVyczsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlBPTFlMSU5FOwogICAgdGhpcy5kYXRhLnZlcnRpY2VzID0gW107CgogICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFBvbHlnb25Bbm5vdGF0aW9uKSkgewogICAgICB0aGlzLnNldExpbmVFbmRpbmdzKGRpY3QuZ2V0QXJyYXkoIkxFIikpOwogICAgICB0aGlzLmRhdGEubGluZUVuZGluZ3MgPSB0aGlzLmxpbmVFbmRpbmdzOwogICAgfQoKICAgIGNvbnN0IHJhd1ZlcnRpY2VzID0gZGljdC5nZXRBcnJheSgiVmVydGljZXMiKTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkocmF3VmVydGljZXMpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSByYXdWZXJ0aWNlcy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgIHRoaXMuZGF0YS52ZXJ0aWNlcy5wdXNoKHsKICAgICAgICB4OiByYXdWZXJ0aWNlc1tpXSwKICAgICAgICB5OiByYXdWZXJ0aWNlc1tpICsgMV0KICAgICAgfSk7CiAgICB9CgogICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgY29uc3Qgc3Ryb2tlQ29sb3IgPSB0aGlzLmNvbG9yID8gQXJyYXkuZnJvbSh0aGlzLmNvbG9yKS5tYXAoYyA9PiBjIC8gMjU1KSA6IFswLCAwLCAwXTsKICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBkaWN0LmdldCgiQ0EiKTsKICAgICAgY29uc3QgYm9yZGVyV2lkdGggPSB0aGlzLmJvcmRlclN0eWxlLndpZHRoIHx8IDEsCiAgICAgICAgICAgIGJvcmRlckFkanVzdCA9IDIgKiBib3JkZXJXaWR0aDsKICAgICAgY29uc3QgYmJveCA9IFtJbmZpbml0eSwgSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5XTsKCiAgICAgIGZvciAoY29uc3QgdmVydGV4IG9mIHRoaXMuZGF0YS52ZXJ0aWNlcykgewogICAgICAgIGJib3hbMF0gPSBNYXRoLm1pbihiYm94WzBdLCB2ZXJ0ZXgueCAtIGJvcmRlckFkanVzdCk7CiAgICAgICAgYmJveFsxXSA9IE1hdGgubWluKGJib3hbMV0sIHZlcnRleC55IC0gYm9yZGVyQWRqdXN0KTsKICAgICAgICBiYm94WzJdID0gTWF0aC5tYXgoYmJveFsyXSwgdmVydGV4LnggKyBib3JkZXJBZGp1c3QpOwogICAgICAgIGJib3hbM10gPSBNYXRoLm1heChiYm94WzNdLCB2ZXJ0ZXgueSArIGJvcmRlckFkanVzdCk7CiAgICAgIH0KCiAgICAgIGlmICghX3V0aWwuVXRpbC5pbnRlcnNlY3QodGhpcy5yZWN0YW5nbGUsIGJib3gpKSB7CiAgICAgICAgdGhpcy5yZWN0YW5nbGUgPSBiYm94OwogICAgICB9CgogICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgIGV4dHJhOiBgJHtib3JkZXJXaWR0aH0gd2AsCiAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgICAgcG9pbnRzQ2FsbGJhY2s6IChidWZmZXIsIHBvaW50cykgPT4gewogICAgICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLmRhdGEudmVydGljZXM7CgogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmVydGljZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICBidWZmZXIucHVzaChgJHt2ZXJ0aWNlc1tpXS54fSAke3ZlcnRpY2VzW2ldLnl9ICR7aSA9PT0gMCA/ICJtIiA6ICJsIn1gKTsKICAgICAgICAgIH0KCiAgICAgICAgICBidWZmZXIucHVzaCgiUyIpOwogICAgICAgICAgcmV0dXJuIFtwb2ludHNbMF0ueCwgcG9pbnRzWzFdLngsIHBvaW50c1szXS55LCBwb2ludHNbMV0ueV07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cgp9CgpjbGFzcyBQb2x5Z29uQW5ub3RhdGlvbiBleHRlbmRzIFBvbHlsaW5lQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5QT0xZR09OOwogIH0KCn0KCmNsYXNzIENhcmV0QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuQ0FSRVQ7CiAgfQoKfQoKY2xhc3MgSW5rQW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgdGhpcy5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuSU5LOwogICAgdGhpcy5kYXRhLmlua0xpc3RzID0gW107CiAgICBjb25zdCByYXdJbmtMaXN0cyA9IHBhcmFtZXRlcnMuZGljdC5nZXRBcnJheSgiSW5rTGlzdCIpOwoKICAgIGlmICghQXJyYXkuaXNBcnJheShyYXdJbmtMaXN0cykpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSBwYXJhbWV0ZXJzLnhyZWY7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcmF3SW5rTGlzdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICB0aGlzLmRhdGEuaW5rTGlzdHMucHVzaChbXSk7CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSByYXdJbmtMaXN0c1tpXS5sZW5ndGg7IGogPCBqajsgaiArPSAyKSB7CiAgICAgICAgdGhpcy5kYXRhLmlua0xpc3RzW2ldLnB1c2goewogICAgICAgICAgeDogeHJlZi5mZXRjaElmUmVmKHJhd0lua0xpc3RzW2ldW2pdKSwKICAgICAgICAgIHk6IHhyZWYuZmV0Y2hJZlJlZihyYXdJbmtMaXN0c1tpXVtqICsgMV0pCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICBjb25zdCBzdHJva2VDb2xvciA9IHRoaXMuY29sb3IgPyBBcnJheS5mcm9tKHRoaXMuY29sb3IpLm1hcChjID0+IGMgLyAyNTUpIDogWzAsIDAsIDBdOwogICAgICBjb25zdCBzdHJva2VBbHBoYSA9IHBhcmFtZXRlcnMuZGljdC5nZXQoIkNBIik7CiAgICAgIGNvbnN0IGJvcmRlcldpZHRoID0gdGhpcy5ib3JkZXJTdHlsZS53aWR0aCB8fCAxLAogICAgICAgICAgICBib3JkZXJBZGp1c3QgPSAyICogYm9yZGVyV2lkdGg7CiAgICAgIGNvbnN0IGJib3ggPSBbSW5maW5pdHksIEluZmluaXR5LCAtSW5maW5pdHksIC1JbmZpbml0eV07CgogICAgICBmb3IgKGNvbnN0IGlua0xpc3RzIG9mIHRoaXMuZGF0YS5pbmtMaXN0cykgewogICAgICAgIGZvciAoY29uc3QgdmVydGV4IG9mIGlua0xpc3RzKSB7CiAgICAgICAgICBiYm94WzBdID0gTWF0aC5taW4oYmJveFswXSwgdmVydGV4LnggLSBib3JkZXJBZGp1c3QpOwogICAgICAgICAgYmJveFsxXSA9IE1hdGgubWluKGJib3hbMV0sIHZlcnRleC55IC0gYm9yZGVyQWRqdXN0KTsKICAgICAgICAgIGJib3hbMl0gPSBNYXRoLm1heChiYm94WzJdLCB2ZXJ0ZXgueCArIGJvcmRlckFkanVzdCk7CiAgICAgICAgICBiYm94WzNdID0gTWF0aC5tYXgoYmJveFszXSwgdmVydGV4LnkgKyBib3JkZXJBZGp1c3QpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFfdXRpbC5VdGlsLmludGVyc2VjdCh0aGlzLnJlY3RhbmdsZSwgYmJveCkpIHsKICAgICAgICB0aGlzLnJlY3RhbmdsZSA9IGJib3g7CiAgICAgIH0KCiAgICAgIHRoaXMuX3NldERlZmF1bHRBcHBlYXJhbmNlKHsKICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgZXh0cmE6IGAke2JvcmRlcldpZHRofSB3YCwKICAgICAgICBzdHJva2VDb2xvciwKICAgICAgICBzdHJva2VBbHBoYSwKICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICBmb3IgKGNvbnN0IGlua0xpc3Qgb2YgdGhpcy5kYXRhLmlua0xpc3RzKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGlua0xpc3QubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGAke2lua0xpc3RbaV0ueH0gJHtpbmtMaXN0W2ldLnl9ICR7aSA9PT0gMCA/ICJtIiA6ICJsIn1gKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnVmZmVyLnB1c2goIlMiKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54LCBwb2ludHNbMV0ueCwgcG9pbnRzWzNdLnksIHBvaW50c1sxXS55XTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgc3RhdGljIGNyZWF0ZU5ld0RpY3QoYW5ub3RhdGlvbiwgeHJlZiwgewogICAgYXBSZWYsCiAgICBhcAogIH0pIHsKICAgIGNvbnN0IHsKICAgICAgcGF0aHMsCiAgICAgIHJlY3QsCiAgICAgIHJvdGF0aW9uCiAgICB9ID0gYW5ub3RhdGlvbjsKICAgIGNvbnN0IGluayA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgaW5rLnNldCgiVHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJBbm5vdCIpKTsKICAgIGluay5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSW5rIikpOwogICAgaW5rLnNldCgiQ3JlYXRpb25EYXRlIiwgYEQ6JHsoMCwgX3V0aWwuZ2V0TW9kaWZpY2F0aW9uRGF0ZSkoKX1gKTsKICAgIGluay5zZXQoIlJlY3QiLCByZWN0KTsKICAgIGluay5zZXQoIklua0xpc3QiLCBwYXRocy5tYXAocCA9PiBwLnBvaW50cykpOwogICAgaW5rLnNldCgiRiIsIDQpOwogICAgaW5rLnNldCgiQm9yZGVyIiwgWzAsIDAsIDBdKTsKICAgIGluay5zZXQoIlJvdGF0ZSIsIHJvdGF0aW9uKTsKICAgIGNvbnN0IG4gPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgIGluay5zZXQoIkFQIiwgbik7CgogICAgaWYgKGFwUmVmKSB7CiAgICAgIG4uc2V0KCJOIiwgYXBSZWYpOwogICAgfSBlbHNlIHsKICAgICAgbi5zZXQoIk4iLCBhcCk7CiAgICB9CgogICAgcmV0dXJuIGluazsKICB9CgogIHN0YXRpYyBhc3luYyBjcmVhdGVOZXdBcHBlYXJhbmNlU3RyZWFtKGFubm90YXRpb24sIHhyZWYsIHBhcmFtcykgewogICAgY29uc3QgewogICAgICBjb2xvciwKICAgICAgcmVjdCwKICAgICAgcm90YXRpb24sCiAgICAgIHBhdGhzLAogICAgICB0aGlja25lc3MsCiAgICAgIG9wYWNpdHkKICAgIH0gPSBhbm5vdGF0aW9uOwogICAgY29uc3QgW3gxLCB5MSwgeDIsIHkyXSA9IHJlY3Q7CiAgICBsZXQgdyA9IHgyIC0geDE7CiAgICBsZXQgaCA9IHkyIC0geTE7CgogICAgaWYgKHJvdGF0aW9uICUgMTgwICE9PSAwKSB7CiAgICAgIFt3LCBoXSA9IFtoLCB3XTsKICAgIH0KCiAgICBjb25zdCBhcHBlYXJhbmNlQnVmZmVyID0gW2Ake3RoaWNrbmVzc30gdyAxIEogMSBqYCwgYCR7KDAsIF9kZWZhdWx0X2FwcGVhcmFuY2UuZ2V0UGRmQ29sb3IpKGNvbG9yLCBmYWxzZSl9YF07CgogICAgaWYgKG9wYWNpdHkgIT09IDEpIHsKICAgICAgYXBwZWFyYW5jZUJ1ZmZlci5wdXNoKCIvUjAgZ3MiKTsKICAgIH0KCiAgICBjb25zdCBidWZmZXIgPSBbXTsKCiAgICBmb3IgKGNvbnN0IHsKICAgICAgYmV6aWVyCiAgICB9IG9mIHBhdGhzKSB7CiAgICAgIGJ1ZmZlci5sZW5ndGggPSAwOwogICAgICBidWZmZXIucHVzaChgJHsoMCwgX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpKGJlemllclswXSl9ICR7KDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKShiZXppZXJbMV0pfSBtYCk7CgogICAgICBmb3IgKGxldCBpID0gMiwgaWkgPSBiZXppZXIubGVuZ3RoOyBpIDwgaWk7IGkgKz0gNikgewogICAgICAgIGNvbnN0IGN1cnZlID0gYmV6aWVyLnNsaWNlKGksIGkgKyA2KS5tYXAoX2NvcmVfdXRpbHMubnVtYmVyVG9TdHJpbmcpLmpvaW4oIiAiKTsKICAgICAgICBidWZmZXIucHVzaChgJHtjdXJ2ZX0gY2ApOwogICAgICB9CgogICAgICBidWZmZXIucHVzaCgiUyIpOwogICAgICBhcHBlYXJhbmNlQnVmZmVyLnB1c2goYnVmZmVyLmpvaW4oIlxuIikpOwogICAgfQoKICAgIGNvbnN0IGFwcGVhcmFuY2UgPSBhcHBlYXJhbmNlQnVmZmVyLmpvaW4oIlxuIik7CiAgICBjb25zdCBhcHBlYXJhbmNlU3RyZWFtRGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJGb3JtVHlwZSIsIDEpOwogICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZvcm0iKSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWE9iamVjdCIpKTsKICAgIGFwcGVhcmFuY2VTdHJlYW1EaWN0LnNldCgiQkJveCIsIFswLCAwLCB3LCBoXSk7CiAgICBhcHBlYXJhbmNlU3RyZWFtRGljdC5zZXQoIkxlbmd0aCIsIGFwcGVhcmFuY2UubGVuZ3RoKTsKCiAgICBpZiAocm90YXRpb24pIHsKICAgICAgY29uc3QgbWF0cml4ID0gV2lkZ2V0QW5ub3RhdGlvbi5fZ2V0Um90YXRpb25NYXRyaXgocm90YXRpb24sIHcsIGgpOwoKICAgICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJNYXRyaXgiLCBtYXRyaXgpOwogICAgfQoKICAgIGlmIChvcGFjaXR5ICE9PSAxKSB7CiAgICAgIGNvbnN0IHJlc291cmNlcyA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHhyZWYpOwogICAgICBjb25zdCBleHRHU3RhdGUgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgICAgY29uc3QgcjAgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh4cmVmKTsKICAgICAgcjAuc2V0KCJDQSIsIG9wYWNpdHkpOwogICAgICByMC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRXh0R1N0YXRlIikpOwogICAgICBleHRHU3RhdGUuc2V0KCJSMCIsIHIwKTsKICAgICAgcmVzb3VyY2VzLnNldCgiRXh0R1N0YXRlIiwgZXh0R1N0YXRlKTsKICAgICAgYXBwZWFyYW5jZVN0cmVhbURpY3Quc2V0KCJSZXNvdXJjZXMiLCByZXNvdXJjZXMpOwogICAgfQoKICAgIGNvbnN0IGFwID0gbmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKGFwcGVhcmFuY2UpOwogICAgYXAuZGljdCA9IGFwcGVhcmFuY2VTdHJlYW1EaWN0OwogICAgcmV0dXJuIGFwOwogIH0KCn0KCmNsYXNzIEhpZ2hsaWdodEFubm90YXRpb24gZXh0ZW5kcyBNYXJrdXBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLkhJR0hMSUdIVDsKICAgIGNvbnN0IHF1YWRQb2ludHMgPSB0aGlzLmRhdGEucXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBudWxsKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLmFwcGVhcmFuY2UgJiYgdGhpcy5hcHBlYXJhbmNlLmRpY3QuZ2V0KCJSZXNvdXJjZXMiKTsKCiAgICAgIGlmICghdGhpcy5hcHBlYXJhbmNlIHx8ICEocmVzb3VyY2VzICYmIHJlc291cmNlcy5oYXMoIkV4dEdTdGF0ZSIpKSkgewogICAgICAgIGlmICh0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSGlnaGxpZ2h0QW5ub3RhdGlvbiAtIGlnbm9yaW5nIGJ1aWx0LWluIGFwcGVhcmFuY2Ugc3RyZWFtLiIpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgZmlsbENvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMSwgMSwgMF07CiAgICAgICAgY29uc3QgZmlsbEFscGhhID0gcGFyYW1ldGVycy5kaWN0LmdldCgiQ0EiKTsKCiAgICAgICAgdGhpcy5fc2V0RGVmYXVsdEFwcGVhcmFuY2UoewogICAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgICAgZmlsbENvbG9yLAogICAgICAgICAgYmxlbmRNb2RlOiAiTXVsdGlwbHkiLAogICAgICAgICAgZmlsbEFscGhhLAogICAgICAgICAgcG9pbnRzQ2FsbGJhY2s6IChidWZmZXIsIHBvaW50cykgPT4gewogICAgICAgICAgICBidWZmZXIucHVzaChgJHtwb2ludHNbMF0ueH0gJHtwb2ludHNbMF0ueX0gbWAsIGAke3BvaW50c1sxXS54fSAke3BvaW50c1sxXS55fSBsYCwgYCR7cG9pbnRzWzNdLnh9ICR7cG9pbnRzWzNdLnl9IGxgLCBgJHtwb2ludHNbMl0ueH0gJHtwb2ludHNbMl0ueX0gbGAsICJmIik7CiAgICAgICAgICAgIHJldHVybiBbcG9pbnRzWzBdLngsIHBvaW50c1sxXS54LCBwb2ludHNbM10ueSwgcG9pbnRzWzFdLnldOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEuaGFzUG9wdXAgPSBmYWxzZTsKICAgIH0KICB9Cgp9CgpjbGFzcyBVbmRlcmxpbmVBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5VTkRFUkxJTkU7CiAgICBjb25zdCBxdWFkUG9pbnRzID0gdGhpcy5kYXRhLnF1YWRQb2ludHMgPSBnZXRRdWFkUG9pbnRzKHBhcmFtZXRlcnMuZGljdCwgbnVsbCk7CgogICAgaWYgKHF1YWRQb2ludHMpIHsKICAgICAgaWYgKCF0aGlzLmFwcGVhcmFuY2UpIHsKICAgICAgICBjb25zdCBzdHJva2VDb2xvciA9IHRoaXMuY29sb3IgPyBBcnJheS5mcm9tKHRoaXMuY29sb3IpLm1hcChjID0+IGMgLyAyNTUpIDogWzAsIDAsIDBdOwogICAgICAgIGNvbnN0IHN0cm9rZUFscGhhID0gcGFyYW1ldGVycy5kaWN0LmdldCgiQ0EiKTsKCiAgICAgICAgdGhpcy5fc2V0RGVmYXVsdEFwcGVhcmFuY2UoewogICAgICAgICAgeHJlZjogcGFyYW1ldGVycy54cmVmLAogICAgICAgICAgZXh0cmE6ICJbXSAwIGQgMSB3IiwKICAgICAgICAgIHN0cm9rZUNvbG9yLAogICAgICAgICAgc3Ryb2tlQWxwaGEsCiAgICAgICAgICBwb2ludHNDYWxsYmFjazogKGJ1ZmZlciwgcG9pbnRzKSA9PiB7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGAke3BvaW50c1syXS54fSAke3BvaW50c1syXS55fSBtYCwgYCR7cG9pbnRzWzNdLnh9ICR7cG9pbnRzWzNdLnl9IGxgLCAiUyIpOwogICAgICAgICAgICByZXR1cm4gW3BvaW50c1swXS54LCBwb2ludHNbMV0ueCwgcG9pbnRzWzNdLnksIHBvaW50c1sxXS55XTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5kYXRhLmhhc1BvcHVwID0gZmFsc2U7CiAgICB9CiAgfQoKfQoKY2xhc3MgU3F1aWdnbHlBbm5vdGF0aW9uIGV4dGVuZHMgTWFya3VwQW5ub3RhdGlvbiB7CiAgY29uc3RydWN0b3IocGFyYW1ldGVycykgewogICAgc3VwZXIocGFyYW1ldGVycyk7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5TUVVJR0dMWTsKICAgIGNvbnN0IHF1YWRQb2ludHMgPSB0aGlzLmRhdGEucXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBudWxsKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwoKICAgICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgICBleHRyYTogIltdIDAgZCAxIHciLAogICAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgICBzdHJva2VBbHBoYSwKICAgICAgICAgIHBvaW50c0NhbGxiYWNrOiAoYnVmZmVyLCBwb2ludHMpID0+IHsKICAgICAgICAgICAgY29uc3QgZHkgPSAocG9pbnRzWzBdLnkgLSBwb2ludHNbMl0ueSkgLyA2OwogICAgICAgICAgICBsZXQgc2hpZnQgPSBkeTsKICAgICAgICAgICAgbGV0IHggPSBwb2ludHNbMl0ueDsKICAgICAgICAgICAgY29uc3QgeSA9IHBvaW50c1syXS55OwogICAgICAgICAgICBjb25zdCB4RW5kID0gcG9pbnRzWzNdLng7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGAke3h9ICR7eSArIHNoaWZ0fSBtYCk7CgogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgeCArPSAyOwogICAgICAgICAgICAgIHNoaWZ0ID0gc2hpZnQgPT09IDAgPyBkeSA6IDA7CiAgICAgICAgICAgICAgYnVmZmVyLnB1c2goYCR7eH0gJHt5ICsgc2hpZnR9IGxgKTsKICAgICAgICAgICAgfSB3aGlsZSAoeCA8IHhFbmQpOwoKICAgICAgICAgICAgYnVmZmVyLnB1c2goIlMiKTsKICAgICAgICAgICAgcmV0dXJuIFtwb2ludHNbMl0ueCwgeEVuZCwgeSAtIDIgKiBkeSwgeSArIDIgKiBkeV07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZGF0YS5oYXNQb3B1cCA9IGZhbHNlOwogICAgfQogIH0KCn0KCmNsYXNzIFN0cmlrZU91dEFubm90YXRpb24gZXh0ZW5kcyBNYXJrdXBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlNUUklLRU9VVDsKICAgIGNvbnN0IHF1YWRQb2ludHMgPSB0aGlzLmRhdGEucXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBudWxsKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gdGhpcy5jb2xvciA/IEFycmF5LmZyb20odGhpcy5jb2xvcikubWFwKGMgPT4gYyAvIDI1NSkgOiBbMCwgMCwgMF07CiAgICAgICAgY29uc3Qgc3Ryb2tlQWxwaGEgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJDQSIpOwoKICAgICAgICB0aGlzLl9zZXREZWZhdWx0QXBwZWFyYW5jZSh7CiAgICAgICAgICB4cmVmOiBwYXJhbWV0ZXJzLnhyZWYsCiAgICAgICAgICBleHRyYTogIltdIDAgZCAxIHciLAogICAgICAgICAgc3Ryb2tlQ29sb3IsCiAgICAgICAgICBzdHJva2VBbHBoYSwKICAgICAgICAgIHBvaW50c0NhbGxiYWNrOiAoYnVmZmVyLCBwb2ludHMpID0+IHsKICAgICAgICAgICAgYnVmZmVyLnB1c2goYCR7KHBvaW50c1swXS54ICsgcG9pbnRzWzJdLngpIC8gMn0gYCArIGAkeyhwb2ludHNbMF0ueSArIHBvaW50c1syXS55KSAvIDJ9IG1gLCBgJHsocG9pbnRzWzFdLnggKyBwb2ludHNbM10ueCkgLyAyfSBgICsgYCR7KHBvaW50c1sxXS55ICsgcG9pbnRzWzNdLnkpIC8gMn0gbGAsICJTIik7CiAgICAgICAgICAgIHJldHVybiBbcG9pbnRzWzBdLngsIHBvaW50c1sxXS54LCBwb2ludHNbM10ueSwgcG9pbnRzWzFdLnldOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEuaGFzUG9wdXAgPSBmYWxzZTsKICAgIH0KICB9Cgp9CgpjbGFzcyBTdGFtcEFubm90YXRpb24gZXh0ZW5kcyBNYXJrdXBBbm5vdGF0aW9uIHsKICBjb25zdHJ1Y3RvcihwYXJhbWV0ZXJzKSB7CiAgICBzdXBlcihwYXJhbWV0ZXJzKTsKICAgIHRoaXMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlNUQU1QOwogIH0KCn0KCmNsYXNzIEZpbGVBdHRhY2htZW50QW5ub3RhdGlvbiBleHRlbmRzIE1hcmt1cEFubm90YXRpb24gewogIGNvbnN0cnVjdG9yKHBhcmFtZXRlcnMpIHsKICAgIHN1cGVyKHBhcmFtZXRlcnMpOwogICAgY29uc3QgZmlsZSA9IG5ldyBfZmlsZV9zcGVjLkZpbGVTcGVjKHBhcmFtZXRlcnMuZGljdC5nZXQoIkZTIiksIHBhcmFtZXRlcnMueHJlZik7CiAgICB0aGlzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5GSUxFQVRUQUNITUVOVDsKICAgIHRoaXMuZGF0YS5maWxlID0gZmlsZS5zZXJpYWxpemFibGU7CiAgfQoKfQoKLyoqKi8gfSksCi8qIDEzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuY3JlYXRlRGVmYXVsdEFwcGVhcmFuY2UgPSBjcmVhdGVEZWZhdWx0QXBwZWFyYW5jZTsKZXhwb3J0cy5nZXRQZGZDb2xvciA9IGdldFBkZkNvbG9yOwpleHBvcnRzLnBhcnNlRGVmYXVsdEFwcGVhcmFuY2UgPSBwYXJzZURlZmF1bHRBcHBlYXJhbmNlOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvbG9yc3BhY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKCnZhciBfZXZhbHVhdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCmNsYXNzIERlZmF1bHRBcHBlYXJhbmNlRXZhbHVhdG9yIGV4dGVuZHMgX2V2YWx1YXRvci5FdmFsdWF0b3JQcmVwcm9jZXNzb3IgewogIGNvbnN0cnVjdG9yKHN0cikgewogICAgc3VwZXIobmV3IF9zdHJlYW0uU3RyaW5nU3RyZWFtKHN0cikpOwogIH0KCiAgcGFyc2UoKSB7CiAgICBjb25zdCBvcGVyYXRpb24gPSB7CiAgICAgIGZuOiAwLAogICAgICBhcmdzOiBbXQogICAgfTsKICAgIGNvbnN0IHJlc3VsdCA9IHsKICAgICAgZm9udFNpemU6IDAsCiAgICAgIGZvbnROYW1lOiAiIiwKICAgICAgZm9udENvbG9yOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoMykKICAgIH07CgogICAgdHJ5IHsKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBvcGVyYXRpb24uYXJncy5sZW5ndGggPSAwOwoKICAgICAgICBpZiAoIXRoaXMucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnNhdmVkU3RhdGVzRGVwdGggIT09IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgewogICAgICAgICAgZm4sCiAgICAgICAgICBhcmdzCiAgICAgICAgfSA9IG9wZXJhdGlvbjsKCiAgICAgICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZvbnQ6CiAgICAgICAgICAgIGNvbnN0IFtmb250TmFtZSwgZm9udFNpemVdID0gYXJnczsKCiAgICAgICAgICAgIGlmIChmb250TmFtZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICByZXN1bHQuZm9udE5hbWUgPSBmb250TmFtZS5uYW1lOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIGZvbnRTaXplID09PSAibnVtYmVyIiAmJiBmb250U2l6ZSA+IDApIHsKICAgICAgICAgICAgICByZXN1bHQuZm9udFNpemUgPSBmb250U2l6ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOgogICAgICAgICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYkl0ZW0oYXJncywgMCwgcmVzdWx0LmZvbnRDb2xvciwgMCk7CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsR3JheToKICAgICAgICAgICAgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiSXRlbShhcmdzLCAwLCByZXN1bHQuZm9udENvbG9yLCAwKTsKCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDb2xvclNwYWNlOgogICAgICAgICAgICBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2JJdGVtKGFyZ3MsIDAsIHJlc3VsdC5mb250Q29sb3IsIDApOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChyZWFzb24pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBwYXJzZURlZmF1bHRBcHBlYXJhbmNlIC0gaWdub3JpbmcgZXJyb3JzOiAiJHtyZWFzb259Ii5gKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCn0KCmZ1bmN0aW9uIHBhcnNlRGVmYXVsdEFwcGVhcmFuY2Uoc3RyKSB7CiAgcmV0dXJuIG5ldyBEZWZhdWx0QXBwZWFyYW5jZUV2YWx1YXRvcihzdHIpLnBhcnNlKCk7Cn0KCmZ1bmN0aW9uIGdldFBkZkNvbG9yKGNvbG9yLCBpc0ZpbGwpIHsKICBpZiAoY29sb3JbMF0gPT09IGNvbG9yWzFdICYmIGNvbG9yWzFdID09PSBjb2xvclsyXSkgewogICAgY29uc3QgZ3JheSA9IGNvbG9yWzBdIC8gMjU1OwogICAgcmV0dXJuIGAkeygwLCBfY29yZV91dGlscy5udW1iZXJUb1N0cmluZykoZ3JheSl9ICR7aXNGaWxsID8gImciIDogIkcifWA7CiAgfQoKICByZXR1cm4gQXJyYXkuZnJvbShjb2xvcikubWFwKGMgPT4gKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKShjIC8gMjU1KSkuam9pbigiICIpICsgYCAke2lzRmlsbCA/ICJyZyIgOiAiUkcifWA7Cn0KCmZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRBcHBlYXJhbmNlKHsKICBmb250U2l6ZSwKICBmb250TmFtZSwKICBmb250Q29sb3IKfSkgewogIHJldHVybiBgLyR7KDAsIF9jb3JlX3V0aWxzLmVzY2FwZVBERk5hbWUpKGZvbnROYW1lKX0gJHtmb250U2l6ZX0gVGYgJHtnZXRQZGZDb2xvcihmb250Q29sb3IsIHRydWUpfWA7Cn0KCi8qKiovIH0pLAovKiAxNCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNvbG9yU3BhY2UgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCmZ1bmN0aW9uIHJlc2l6ZVJnYkltYWdlKHNyYywgZGVzdCwgdzEsIGgxLCB3MiwgaDIsIGFscGhhMDEpIHsKICBjb25zdCBDT01QT05FTlRTID0gMzsKICBhbHBoYTAxID0gYWxwaGEwMSAhPT0gMSA/IDAgOiBhbHBoYTAxOwogIGNvbnN0IHhSYXRpbyA9IHcxIC8gdzI7CiAgY29uc3QgeVJhdGlvID0gaDEgLyBoMjsKICBsZXQgbmV3SW5kZXggPSAwLAogICAgICBvbGRJbmRleDsKICBjb25zdCB4U2NhbGVkID0gbmV3IFVpbnQxNkFycmF5KHcyKTsKICBjb25zdCB3MVNjYW5saW5lID0gdzEgKiBDT01QT05FTlRTOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IHcyOyBpKyspIHsKICAgIHhTY2FsZWRbaV0gPSBNYXRoLmZsb29yKGkgKiB4UmF0aW8pICogQ09NUE9ORU5UUzsKICB9CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaDI7IGkrKykgewogICAgY29uc3QgcHkgPSBNYXRoLmZsb29yKGkgKiB5UmF0aW8pICogdzFTY2FubGluZTsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHcyOyBqKyspIHsKICAgICAgb2xkSW5kZXggPSBweSArIHhTY2FsZWRbal07CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIGRlc3RbbmV3SW5kZXgrK10gPSBzcmNbb2xkSW5kZXgrK107CiAgICAgIG5ld0luZGV4ICs9IGFscGhhMDE7CiAgICB9CiAgfQp9CgpjbGFzcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcihuYW1lLCBudW1Db21wcykgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IENvbG9yU3BhY2UpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgQ29sb3JTcGFjZS4iKTsKICAgIH0KCiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5udW1Db21wcyA9IG51bUNvbXBzOwogIH0KCiAgZ2V0UmdiKHNyYywgc3JjT2Zmc2V0KSB7CiAgICBjb25zdCByZ2IgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CiAgICB0aGlzLmdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIHJnYiwgMCk7CiAgICByZXR1cm4gcmdiOwogIH0KCiAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0UmdiSXRlbSIpOwogIH0KCiAgZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0UmdiQnVmZmVyIik7CiAgfQoKICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBDb2xvclNwYWNlLmdldE91dHB1dExlbmd0aCIpOwogIH0KCiAgaXNQYXNzdGhyb3VnaChiaXRzKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCBicGMpIHsKICAgIHJldHVybiBDb2xvclNwYWNlLmlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIHRoaXMubnVtQ29tcHMpOwogIH0KCiAgZmlsbFJnYihkZXN0LCBvcmlnaW5hbFdpZHRoLCBvcmlnaW5hbEhlaWdodCwgd2lkdGgsIGhlaWdodCwgYWN0dWFsSGVpZ2h0LCBicGMsIGNvbXBzLCBhbHBoYTAxKSB7CiAgICBjb25zdCBjb3VudCA9IG9yaWdpbmFsV2lkdGggKiBvcmlnaW5hbEhlaWdodDsKICAgIGxldCByZ2JCdWYgPSBudWxsOwogICAgY29uc3QgbnVtQ29tcG9uZW50Q29sb3JzID0gMSA8PCBicGM7CiAgICBjb25zdCBuZWVkc1Jlc2l6aW5nID0gb3JpZ2luYWxIZWlnaHQgIT09IGhlaWdodCB8fCBvcmlnaW5hbFdpZHRoICE9PSB3aWR0aDsKCiAgICBpZiAodGhpcy5pc1Bhc3N0aHJvdWdoKGJwYykpIHsKICAgICAgcmdiQnVmID0gY29tcHM7CiAgICB9IGVsc2UgaWYgKHRoaXMubnVtQ29tcHMgPT09IDEgJiYgY291bnQgPiBudW1Db21wb25lbnRDb2xvcnMgJiYgdGhpcy5uYW1lICE9PSAiRGV2aWNlR3JheSIgJiYgdGhpcy5uYW1lICE9PSAiRGV2aWNlUkdCIikgewogICAgICBjb25zdCBhbGxDb2xvcnMgPSBicGMgPD0gOCA/IG5ldyBVaW50OEFycmF5KG51bUNvbXBvbmVudENvbG9ycykgOiBuZXcgVWludDE2QXJyYXkobnVtQ29tcG9uZW50Q29sb3JzKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtQ29tcG9uZW50Q29sb3JzOyBpKyspIHsKICAgICAgICBhbGxDb2xvcnNbaV0gPSBpOwogICAgICB9CgogICAgICBjb25zdCBjb2xvck1hcCA9IG5ldyBVaW50OENsYW1wZWRBcnJheShudW1Db21wb25lbnRDb2xvcnMgKiAzKTsKICAgICAgdGhpcy5nZXRSZ2JCdWZmZXIoYWxsQ29sb3JzLCAwLCBudW1Db21wb25lbnRDb2xvcnMsIGNvbG9yTWFwLCAwLCBicGMsIDApOwoKICAgICAgaWYgKCFuZWVkc1Jlc2l6aW5nKSB7CiAgICAgICAgbGV0IGRlc3RQb3MgPSAwOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICAgIGNvbnN0IGtleSA9IGNvbXBzW2ldICogMzsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGNvbG9yTWFwW2tleV07CiAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSBjb2xvck1hcFtrZXkgKyAxXTsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGNvbG9yTWFwW2tleSArIDJdOwogICAgICAgICAgZGVzdFBvcyArPSBhbHBoYTAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZ2JCdWYgPSBuZXcgVWludDhBcnJheShjb3VudCAqIDMpOwogICAgICAgIGxldCByZ2JQb3MgPSAwOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICAgIGNvbnN0IGtleSA9IGNvbXBzW2ldICogMzsKICAgICAgICAgIHJnYkJ1ZltyZ2JQb3MrK10gPSBjb2xvck1hcFtrZXldOwogICAgICAgICAgcmdiQnVmW3JnYlBvcysrXSA9IGNvbG9yTWFwW2tleSArIDFdOwogICAgICAgICAgcmdiQnVmW3JnYlBvcysrXSA9IGNvbG9yTWFwW2tleSArIDJdOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKCFuZWVkc1Jlc2l6aW5nKSB7CiAgICAgICAgdGhpcy5nZXRSZ2JCdWZmZXIoY29tcHMsIDAsIHdpZHRoICogYWN0dWFsSGVpZ2h0LCBkZXN0LCAwLCBicGMsIGFscGhhMDEpOwogICAgICB9IGVsc2UgewogICAgICAgIHJnYkJ1ZiA9IG5ldyBVaW50OENsYW1wZWRBcnJheShjb3VudCAqIDMpOwogICAgICAgIHRoaXMuZ2V0UmdiQnVmZmVyKGNvbXBzLCAwLCBjb3VudCwgcmdiQnVmLCAwLCBicGMsIDApOwogICAgICB9CiAgICB9CgogICAgaWYgKHJnYkJ1ZikgewogICAgICBpZiAobmVlZHNSZXNpemluZykgewogICAgICAgIHJlc2l6ZVJnYkltYWdlKHJnYkJ1ZiwgZGVzdCwgb3JpZ2luYWxXaWR0aCwgb3JpZ2luYWxIZWlnaHQsIHdpZHRoLCBoZWlnaHQsIGFscGhhMDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBkZXN0UG9zID0gMCwKICAgICAgICAgICAgcmdiUG9zID0gMDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gd2lkdGggKiBhY3R1YWxIZWlnaHQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSByZ2JCdWZbcmdiUG9zKytdOwogICAgICAgICAgZGVzdFtkZXN0UG9zKytdID0gcmdiQnVmW3JnYlBvcysrXTsKICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHJnYkJ1ZltyZ2JQb3MrK107CiAgICAgICAgICBkZXN0UG9zICs9IGFscGhhMDE7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBnZXQgdXNlc1plcm9Ub09uZVJhbmdlKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ1c2VzWmVyb1RvT25lUmFuZ2UiLCB0cnVlKTsKICB9CgogIHN0YXRpYyBfY2FjaGUoY2FjaGVLZXksIHhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlLCBwYXJzZWRDb2xvclNwYWNlKSB7CiAgICBpZiAoIWxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ29sb3JTcGFjZS5fY2FjaGUgLSBleHBlY3RlZCAibG9jYWxDb2xvclNwYWNlQ2FjaGUiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmICghcGFyc2VkQ29sb3JTcGFjZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbG9yU3BhY2UuX2NhY2hlIC0gZXhwZWN0ZWQgInBhcnNlZENvbG9yU3BhY2UiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGxldCBjc05hbWUsIGNzUmVmOwoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBjc1JlZiA9IGNhY2hlS2V5OwogICAgICBjYWNoZUtleSA9IHhyZWYuZmV0Y2goY2FjaGVLZXkpOwogICAgfQoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgY3NOYW1lID0gY2FjaGVLZXkubmFtZTsKICAgIH0KCiAgICBpZiAoY3NOYW1lIHx8IGNzUmVmKSB7CiAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlLnNldChjc05hbWUsIGNzUmVmLCBwYXJzZWRDb2xvclNwYWNlKTsKICAgIH0KICB9CgogIHN0YXRpYyBnZXRDYWNoZWQoY2FjaGVLZXksIHhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICBpZiAoIWxvY2FsQ29sb3JTcGFjZUNhY2hlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ29sb3JTcGFjZS5nZXRDYWNoZWQgLSBleHBlY3RlZCAibG9jYWxDb2xvclNwYWNlQ2FjaGUiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBjb25zdCBsb2NhbENvbG9yU3BhY2UgPSBsb2NhbENvbG9yU3BhY2VDYWNoZS5nZXRCeVJlZihjYWNoZUtleSk7CgogICAgICBpZiAobG9jYWxDb2xvclNwYWNlKSB7CiAgICAgICAgcmV0dXJuIGxvY2FsQ29sb3JTcGFjZTsKICAgICAgfQoKICAgICAgdHJ5IHsKICAgICAgICBjYWNoZUtleSA9IHhyZWYuZmV0Y2goY2FjaGVLZXkpOwogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY2FjaGVLZXkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIGNvbnN0IGxvY2FsQ29sb3JTcGFjZSA9IGxvY2FsQ29sb3JTcGFjZUNhY2hlLmdldEJ5TmFtZShjYWNoZUtleS5uYW1lKTsKCiAgICAgIGlmIChsb2NhbENvbG9yU3BhY2UpIHsKICAgICAgICByZXR1cm4gbG9jYWxDb2xvclNwYWNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBzdGF0aWMgYXN5bmMgcGFyc2VBc3luYyh7CiAgICBjcywKICAgIHhyZWYsCiAgICByZXNvdXJjZXMgPSBudWxsLAogICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICB9KSB7CiAgICBjb25zdCBwYXJzZWRDb2xvclNwYWNlID0gdGhpcy5fcGFyc2UoY3MsIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKCiAgICB0aGlzLl9jYWNoZShjcywgeHJlZiwgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIHBhcnNlZENvbG9yU3BhY2UpOwoKICAgIHJldHVybiBwYXJzZWRDb2xvclNwYWNlOwogIH0KCiAgc3RhdGljIHBhcnNlKHsKICAgIGNzLAogICAgeHJlZiwKICAgIHJlc291cmNlcyA9IG51bGwsCiAgICBwZGZGdW5jdGlvbkZhY3RvcnksCiAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogIH0pIHsKICAgIGNvbnN0IGNhY2hlZENvbG9yU3BhY2UgPSB0aGlzLmdldENhY2hlZChjcywgeHJlZiwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgIGlmIChjYWNoZWRDb2xvclNwYWNlKSB7CiAgICAgIHJldHVybiBjYWNoZWRDb2xvclNwYWNlOwogICAgfQoKICAgIGNvbnN0IHBhcnNlZENvbG9yU3BhY2UgPSB0aGlzLl9wYXJzZShjcywgeHJlZiwgcmVzb3VyY2VzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwoKICAgIHRoaXMuX2NhY2hlKGNzLCB4cmVmLCBsb2NhbENvbG9yU3BhY2VDYWNoZSwgcGFyc2VkQ29sb3JTcGFjZSk7CgogICAgcmV0dXJuIHBhcnNlZENvbG9yU3BhY2U7CiAgfQoKICBzdGF0aWMgX3BhcnNlKGNzLCB4cmVmLCByZXNvdXJjZXMgPSBudWxsLCBwZGZGdW5jdGlvbkZhY3RvcnkpIHsKICAgIGNzID0geHJlZi5mZXRjaElmUmVmKGNzKTsKCiAgICBpZiAoY3MgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHN3aXRjaCAoY3MubmFtZSkgewogICAgICAgIGNhc2UgIkciOgogICAgICAgIGNhc2UgIkRldmljZUdyYXkiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5ncmF5OwoKICAgICAgICBjYXNlICJSR0IiOgogICAgICAgIGNhc2UgIkRldmljZVJHQiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLnJnYjsKCiAgICAgICAgY2FzZSAiQ01ZSyI6CiAgICAgICAgY2FzZSAiRGV2aWNlQ01ZSyI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLmNteWs7CgogICAgICAgIGNhc2UgIlBhdHRlcm4iOgogICAgICAgICAgcmV0dXJuIG5ldyBQYXR0ZXJuQ1MobnVsbCk7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAocmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgICBjb25zdCBjb2xvclNwYWNlcyA9IHJlc291cmNlcy5nZXQoIkNvbG9yU3BhY2UiKTsKCiAgICAgICAgICAgIGlmIChjb2xvclNwYWNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgICAgICBjb25zdCByZXNvdXJjZXNDUyA9IGNvbG9yU3BhY2VzLmdldChjcy5uYW1lKTsKCiAgICAgICAgICAgICAgaWYgKHJlc291cmNlc0NTKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2VzQ1MgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXJzZShyZXNvdXJjZXNDUywgeHJlZiwgcmVzb3VyY2VzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNzID0gcmVzb3VyY2VzQ1M7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVucmVjb2duaXplZCBDb2xvclNwYWNlOiAke2NzLm5hbWV9YCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoQXJyYXkuaXNBcnJheShjcykpIHsKICAgICAgY29uc3QgbW9kZSA9IHhyZWYuZmV0Y2hJZlJlZihjc1swXSkubmFtZTsKICAgICAgbGV0IHBhcmFtcywgbnVtQ29tcHMsIGJhc2VDUywgd2hpdGVQb2ludCwgYmxhY2tQb2ludCwgZ2FtbWE7CgogICAgICBzd2l0Y2ggKG1vZGUpIHsKICAgICAgICBjYXNlICJHIjoKICAgICAgICBjYXNlICJEZXZpY2VHcmF5IjoKICAgICAgICAgIHJldHVybiB0aGlzLnNpbmdsZXRvbnMuZ3JheTsKCiAgICAgICAgY2FzZSAiUkdCIjoKICAgICAgICBjYXNlICJEZXZpY2VSR0IiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5yZ2I7CgogICAgICAgIGNhc2UgIkNNWUsiOgogICAgICAgIGNhc2UgIkRldmljZUNNWUsiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5jbXlrOwoKICAgICAgICBjYXNlICJDYWxHcmF5IjoKICAgICAgICAgIHBhcmFtcyA9IHhyZWYuZmV0Y2hJZlJlZihjc1sxXSk7CiAgICAgICAgICB3aGl0ZVBvaW50ID0gcGFyYW1zLmdldEFycmF5KCJXaGl0ZVBvaW50Iik7CiAgICAgICAgICBibGFja1BvaW50ID0gcGFyYW1zLmdldEFycmF5KCJCbGFja1BvaW50Iik7CiAgICAgICAgICBnYW1tYSA9IHBhcmFtcy5nZXQoIkdhbW1hIik7CiAgICAgICAgICByZXR1cm4gbmV3IENhbEdyYXlDUyh3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYSk7CgogICAgICAgIGNhc2UgIkNhbFJHQiI6CiAgICAgICAgICBwYXJhbXMgPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgd2hpdGVQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiV2hpdGVQb2ludCIpOwogICAgICAgICAgYmxhY2tQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiQmxhY2tQb2ludCIpOwogICAgICAgICAgZ2FtbWEgPSBwYXJhbXMuZ2V0QXJyYXkoIkdhbW1hIik7CiAgICAgICAgICBjb25zdCBtYXRyaXggPSBwYXJhbXMuZ2V0QXJyYXkoIk1hdHJpeCIpOwogICAgICAgICAgcmV0dXJuIG5ldyBDYWxSR0JDUyh3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYSwgbWF0cml4KTsKCiAgICAgICAgY2FzZSAiSUNDQmFzZWQiOgogICAgICAgICAgY29uc3Qgc3RyZWFtID0geHJlZi5mZXRjaElmUmVmKGNzWzFdKTsKICAgICAgICAgIGNvbnN0IGRpY3QgPSBzdHJlYW0uZGljdDsKICAgICAgICAgIG51bUNvbXBzID0gZGljdC5nZXQoIk4iKTsKICAgICAgICAgIGNvbnN0IGFsdCA9IGRpY3QuZ2V0KCJBbHRlcm5hdGUiKTsKCiAgICAgICAgICBpZiAoYWx0KSB7CiAgICAgICAgICAgIGNvbnN0IGFsdENTID0gdGhpcy5fcGFyc2UoYWx0LCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CgogICAgICAgICAgICBpZiAoYWx0Q1MubnVtQ29tcHMgPT09IG51bUNvbXBzKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGFsdENTOwogICAgICAgICAgICB9CgogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIklDQ0Jhc2VkIGNvbG9yIHNwYWNlOiBJZ25vcmluZyBpbmNvcnJlY3QgL0FsdGVybmF0ZSBlbnRyeS4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobnVtQ29tcHMgPT09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5ncmF5OwogICAgICAgICAgfSBlbHNlIGlmIChudW1Db21wcyA9PT0gMykgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLnJnYjsKICAgICAgICAgIH0gZWxzZSBpZiAobnVtQ29tcHMgPT09IDQpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5jbXlrOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJQYXR0ZXJuIjoKICAgICAgICAgIGJhc2VDUyA9IGNzWzFdIHx8IG51bGw7CgogICAgICAgICAgaWYgKGJhc2VDUykgewogICAgICAgICAgICBiYXNlQ1MgPSB0aGlzLl9wYXJzZShiYXNlQ1MsIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IFBhdHRlcm5DUyhiYXNlQ1MpOwoKICAgICAgICBjYXNlICJJIjoKICAgICAgICBjYXNlICJJbmRleGVkIjoKICAgICAgICAgIGJhc2VDUyA9IHRoaXMuX3BhcnNlKGNzWzFdLCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgICAgICAgICBjb25zdCBoaVZhbCA9IHhyZWYuZmV0Y2hJZlJlZihjc1syXSkgKyAxOwogICAgICAgICAgY29uc3QgbG9va3VwID0geHJlZi5mZXRjaElmUmVmKGNzWzNdKTsKICAgICAgICAgIHJldHVybiBuZXcgSW5kZXhlZENTKGJhc2VDUywgaGlWYWwsIGxvb2t1cCk7CgogICAgICAgIGNhc2UgIlNlcGFyYXRpb24iOgogICAgICAgIGNhc2UgIkRldmljZU4iOgogICAgICAgICAgY29uc3QgbmFtZSA9IHhyZWYuZmV0Y2hJZlJlZihjc1sxXSk7CiAgICAgICAgICBudW1Db21wcyA9IEFycmF5LmlzQXJyYXkobmFtZSkgPyBuYW1lLmxlbmd0aCA6IDE7CiAgICAgICAgICBiYXNlQ1MgPSB0aGlzLl9wYXJzZShjc1syXSwgeHJlZiwgcmVzb3VyY2VzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgICAgICAgY29uc3QgdGludEZuID0gcGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZShjc1szXSk7CiAgICAgICAgICByZXR1cm4gbmV3IEFsdGVybmF0ZUNTKG51bUNvbXBzLCBiYXNlQ1MsIHRpbnRGbik7CgogICAgICAgIGNhc2UgIkxhYiI6CiAgICAgICAgICBwYXJhbXMgPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgd2hpdGVQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiV2hpdGVQb2ludCIpOwogICAgICAgICAgYmxhY2tQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiQmxhY2tQb2ludCIpOwogICAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuZ2V0QXJyYXkoIlJhbmdlIik7CiAgICAgICAgICByZXR1cm4gbmV3IExhYkNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIHJhbmdlKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVW5pbXBsZW1lbnRlZCBDb2xvclNwYWNlIG9iamVjdDogJHttb2RlfWApOwogICAgICB9CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbnJlY29nbml6ZWQgQ29sb3JTcGFjZSBvYmplY3Q6ICR7Y3N9YCk7CiAgfQoKICBzdGF0aWMgaXNEZWZhdWx0RGVjb2RlKGRlY29kZSwgbnVtQ29tcHMpIHsKICAgIGlmICghQXJyYXkuaXNBcnJheShkZWNvZGUpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmIChudW1Db21wcyAqIDIgIT09IGRlY29kZS5sZW5ndGgpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJUaGUgZGVjb2RlIG1hcCBpcyBub3QgdGhlIGNvcnJlY3QgbGVuZ3RoIik7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGRlY29kZS5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgIGlmIChkZWNvZGVbaV0gIT09IDAgfHwgZGVjb2RlW2kgKyAxXSAhPT0gMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgc3RhdGljIGdldCBzaW5nbGV0b25zKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJzaW5nbGV0b25zIiwgewogICAgICBnZXQgZ3JheSgpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImdyYXkiLCBuZXcgRGV2aWNlR3JheUNTKCkpOwogICAgICB9LAoKICAgICAgZ2V0IHJnYigpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInJnYiIsIG5ldyBEZXZpY2VSZ2JDUygpKTsKICAgICAgfSwKCiAgICAgIGdldCBjbXlrKCkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY215ayIsIG5ldyBEZXZpY2VDbXlrQ1MoKSk7CiAgICAgIH0KCiAgICB9KTsKICB9Cgp9CgpleHBvcnRzLkNvbG9yU3BhY2UgPSBDb2xvclNwYWNlOwoKY2xhc3MgQWx0ZXJuYXRlQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcihudW1Db21wcywgYmFzZSwgdGludEZuKSB7CiAgICBzdXBlcigiQWx0ZXJuYXRlIiwgbnVtQ29tcHMpOwogICAgdGhpcy5iYXNlID0gYmFzZTsKICAgIHRoaXMudGludEZuID0gdGludEZuOwogICAgdGhpcy50bXBCdWYgPSBuZXcgRmxvYXQzMkFycmF5KGJhc2UubnVtQ29tcHMpOwogIH0KCiAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgY29uc3QgdG1wQnVmID0gdGhpcy50bXBCdWY7CiAgICB0aGlzLnRpbnRGbihzcmMsIHNyY09mZnNldCwgdG1wQnVmLCAwKTsKICAgIHRoaXMuYmFzZS5nZXRSZ2JJdGVtKHRtcEJ1ZiwgMCwgZGVzdCwgZGVzdE9mZnNldCk7CiAgfQoKICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICBjb25zdCB0aW50Rm4gPSB0aGlzLnRpbnRGbjsKICAgIGNvbnN0IGJhc2UgPSB0aGlzLmJhc2U7CiAgICBjb25zdCBzY2FsZSA9IDEgLyAoKDEgPDwgYml0cykgLSAxKTsKICAgIGNvbnN0IGJhc2VOdW1Db21wcyA9IGJhc2UubnVtQ29tcHM7CiAgICBjb25zdCB1c2VzWmVyb1RvT25lUmFuZ2UgPSBiYXNlLnVzZXNaZXJvVG9PbmVSYW5nZTsKICAgIGNvbnN0IGlzUGFzc3Rocm91Z2ggPSAoYmFzZS5pc1Bhc3N0aHJvdWdoKDgpIHx8ICF1c2VzWmVyb1RvT25lUmFuZ2UpICYmIGFscGhhMDEgPT09IDA7CiAgICBsZXQgcG9zID0gaXNQYXNzdGhyb3VnaCA/IGRlc3RPZmZzZXQgOiAwOwogICAgY29uc3QgYmFzZUJ1ZiA9IGlzUGFzc3Rocm91Z2ggPyBkZXN0IDogbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGJhc2VOdW1Db21wcyAqIGNvdW50KTsKICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5udW1Db21wczsKICAgIGNvbnN0IHNjYWxlZCA9IG5ldyBGbG9hdDMyQXJyYXkobnVtQ29tcHMpOwogICAgY29uc3QgdGludGVkID0gbmV3IEZsb2F0MzJBcnJheShiYXNlTnVtQ29tcHMpOwogICAgbGV0IGksIGo7CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IG51bUNvbXBzOyBqKyspIHsKICAgICAgICBzY2FsZWRbal0gPSBzcmNbc3JjT2Zmc2V0KytdICogc2NhbGU7CiAgICAgIH0KCiAgICAgIHRpbnRGbihzY2FsZWQsIDAsIHRpbnRlZCwgMCk7CgogICAgICBpZiAodXNlc1plcm9Ub09uZVJhbmdlKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IGJhc2VOdW1Db21wczsgaisrKSB7CiAgICAgICAgICBiYXNlQnVmW3BvcysrXSA9IHRpbnRlZFtqXSAqIDI1NTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYmFzZS5nZXRSZ2JJdGVtKHRpbnRlZCwgMCwgYmFzZUJ1ZiwgcG9zKTsKICAgICAgICBwb3MgKz0gYmFzZU51bUNvbXBzOwogICAgICB9CiAgICB9CgogICAgaWYgKCFpc1Bhc3N0aHJvdWdoKSB7CiAgICAgIGJhc2UuZ2V0UmdiQnVmZmVyKGJhc2VCdWYsIDAsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCA4LCBhbHBoYTAxKTsKICAgIH0KICB9CgogIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgcmV0dXJuIHRoaXMuYmFzZS5nZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGggKiB0aGlzLmJhc2UubnVtQ29tcHMgLyB0aGlzLm51bUNvbXBzLCBhbHBoYTAxKTsKICB9Cgp9CgpjbGFzcyBQYXR0ZXJuQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcihiYXNlQ1MpIHsKICAgIHN1cGVyKCJQYXR0ZXJuIiwgbnVsbCk7CiAgICB0aGlzLmJhc2UgPSBiYXNlQ1M7CiAgfQoKICBpc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCBicGMpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBQYXR0ZXJuQ1MuaXNEZWZhdWx0RGVjb2RlIik7CiAgfQoKfQoKY2xhc3MgSW5kZXhlZENTIGV4dGVuZHMgQ29sb3JTcGFjZSB7CiAgY29uc3RydWN0b3IoYmFzZSwgaGlnaFZhbCwgbG9va3VwKSB7CiAgICBzdXBlcigiSW5kZXhlZCIsIDEpOwogICAgdGhpcy5iYXNlID0gYmFzZTsKICAgIHRoaXMuaGlnaFZhbCA9IGhpZ2hWYWw7CiAgICBjb25zdCBsZW5ndGggPSBiYXNlLm51bUNvbXBzICogaGlnaFZhbDsKICAgIHRoaXMubG9va3VwID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKCiAgICBpZiAobG9va3VwIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgY29uc3QgYnl0ZXMgPSBsb29rdXAuZ2V0Qnl0ZXMobGVuZ3RoKTsKICAgICAgdGhpcy5sb29rdXAuc2V0KGJ5dGVzKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGxvb2t1cCA9PT0gInN0cmluZyIpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgIHRoaXMubG9va3VwW2ldID0gbG9va3VwLmNoYXJDb2RlQXQoaSkgJiAweGZmOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEluZGV4ZWRDUyAtIHVucmVjb2duaXplZCBsb29rdXAgdGFibGU6ICR7bG9va3VwfWApOwogICAgfQogIH0KCiAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLmJhc2UubnVtQ29tcHM7CiAgICBjb25zdCBzdGFydCA9IHNyY1tzcmNPZmZzZXRdICogbnVtQ29tcHM7CiAgICB0aGlzLmJhc2UuZ2V0UmdiQnVmZmVyKHRoaXMubG9va3VwLCBzdGFydCwgMSwgZGVzdCwgZGVzdE9mZnNldCwgOCwgMCk7CiAgfQoKICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICBjb25zdCBiYXNlID0gdGhpcy5iYXNlOwogICAgY29uc3QgbnVtQ29tcHMgPSBiYXNlLm51bUNvbXBzOwogICAgY29uc3Qgb3V0cHV0RGVsdGEgPSBiYXNlLmdldE91dHB1dExlbmd0aChudW1Db21wcywgYWxwaGEwMSk7CiAgICBjb25zdCBsb29rdXAgPSB0aGlzLmxvb2t1cDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgY29uc3QgbG9va3VwUG9zID0gc3JjW3NyY09mZnNldCsrXSAqIG51bUNvbXBzOwogICAgICBiYXNlLmdldFJnYkJ1ZmZlcihsb29rdXAsIGxvb2t1cFBvcywgMSwgZGVzdCwgZGVzdE9mZnNldCwgOCwgYWxwaGEwMSk7CiAgICAgIGRlc3RPZmZzZXQgKz0gb3V0cHV0RGVsdGE7CiAgICB9CiAgfQoKICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgIHJldHVybiB0aGlzLmJhc2UuZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoICogdGhpcy5iYXNlLm51bUNvbXBzLCBhbHBoYTAxKTsKICB9CgogIGlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIGJwYykgewogICAgaWYgKCFBcnJheS5pc0FycmF5KGRlY29kZU1hcCkpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKGRlY29kZU1hcC5sZW5ndGggIT09IDIpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJEZWNvZGUgbWFwIGxlbmd0aCBpcyBub3QgY29ycmVjdCIpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoYnBjKSB8fCBicGMgPCAxKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiQml0cyBwZXIgY29tcG9uZW50IGlzIG5vdCBjb3JyZWN0Iik7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBkZWNvZGVNYXBbMF0gPT09IDAgJiYgZGVjb2RlTWFwWzFdID09PSAoMSA8PCBicGMpIC0gMTsKICB9Cgp9CgpjbGFzcyBEZXZpY2VHcmF5Q1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCJEZXZpY2VHcmF5IiwgMSk7CiAgfQoKICBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICBjb25zdCBjID0gc3JjW3NyY09mZnNldF0gKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXRdID0gZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IGM7CiAgfQoKICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICBjb25zdCBzY2FsZSA9IDI1NSAvICgoMSA8PCBiaXRzKSAtIDEpOwogICAgbGV0IGogPSBzcmNPZmZzZXQsCiAgICAgICAgcSA9IGRlc3RPZmZzZXQ7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAgICAgIGNvbnN0IGMgPSBzY2FsZSAqIHNyY1tqKytdOwogICAgICBkZXN0W3ErK10gPSBjOwogICAgICBkZXN0W3ErK10gPSBjOwogICAgICBkZXN0W3ErK10gPSBjOwogICAgICBxICs9IGFscGhhMDE7CiAgICB9CiAgfQoKICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgIHJldHVybiBpbnB1dExlbmd0aCAqICgzICsgYWxwaGEwMSk7CiAgfQoKfQoKY2xhc3MgRGV2aWNlUmdiQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCJEZXZpY2VSR0IiLCAzKTsKICB9CgogIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSBzcmNbc3JjT2Zmc2V0XSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gc3JjW3NyY09mZnNldCArIDFdICogMjU1OwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSBzcmNbc3JjT2Zmc2V0ICsgMl0gKiAyNTU7CiAgfQoKICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICBpZiAoYml0cyA9PT0gOCAmJiBhbHBoYTAxID09PSAwKSB7CiAgICAgIGRlc3Quc2V0KHNyYy5zdWJhcnJheShzcmNPZmZzZXQsIHNyY09mZnNldCArIGNvdW50ICogMyksIGRlc3RPZmZzZXQpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgc2NhbGUgPSAyNTUgLyAoKDEgPDwgYml0cykgLSAxKTsKICAgIGxldCBqID0gc3JjT2Zmc2V0LAogICAgICAgIHEgPSBkZXN0T2Zmc2V0OwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICBkZXN0W3ErK10gPSBzY2FsZSAqIHNyY1tqKytdOwogICAgICBkZXN0W3ErK10gPSBzY2FsZSAqIHNyY1tqKytdOwogICAgICBkZXN0W3ErK10gPSBzY2FsZSAqIHNyY1tqKytdOwogICAgICBxICs9IGFscGhhMDE7CiAgICB9CiAgfQoKICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgIHJldHVybiBpbnB1dExlbmd0aCAqICgzICsgYWxwaGEwMSkgLyAzIHwgMDsKICB9CgogIGlzUGFzc3Rocm91Z2goYml0cykgewogICAgcmV0dXJuIGJpdHMgPT09IDg7CiAgfQoKfQoKY29uc3QgRGV2aWNlQ215a0NTID0gZnVuY3Rpb24gRGV2aWNlQ215a0NTQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBjb252ZXJ0VG9SZ2Ioc3JjLCBzcmNPZmZzZXQsIHNyY1NjYWxlLCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICBjb25zdCBjID0gc3JjW3NyY09mZnNldF0gKiBzcmNTY2FsZTsKICAgIGNvbnN0IG0gPSBzcmNbc3JjT2Zmc2V0ICsgMV0gKiBzcmNTY2FsZTsKICAgIGNvbnN0IHkgPSBzcmNbc3JjT2Zmc2V0ICsgMl0gKiBzcmNTY2FsZTsKICAgIGNvbnN0IGsgPSBzcmNbc3JjT2Zmc2V0ICsgM10gKiBzcmNTY2FsZTsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSAyNTUgKyBjICogKC00LjM4NzMzMjM4NDYwOTk4OCAqIGMgKyA1NC40ODYxNTE5NDE4OTE3NiAqIG0gKyAxOC44MjI5MDUwMjE2NTMwMiAqIHkgKyAyMTIuMjU2NjI0NTE2Mzk1ODUgKiBrICsgLTI4NS4yMzMxMDI2MTM3MDA0KSArIG0gKiAoMS43MTQ5NzYzNDc3MzYyMTM0ICogbSAtIDUuNjA5NjczNjkwNDA0NzMxNSAqIHkgKyAtMTcuODczODcwODYxNDE1NDQ0ICogayAtIDUuNDk3MDA2NDI3MTk2MzY2KSArIHkgKiAoLTIuNTIxNzM0MDEzMTY4MzAzMyAqIHkgLSAyMS4yNDg5MjMzMzczNTMwNzMgKiBrICsgMTcuNTExOTI3MDg0MTgxMykgKyBrICogKC0yMS44NjEyMjE0NzQ2MzYwNSAqIGsgLSAxODkuNDgxODA4MzU5MjI3NDcpOwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSAyNTUgKyBjICogKDguODQxMDQxNDIyMDM2MTQ5ICogYyArIDYwLjExODAyNzA0NTU5NzM2NiAqIG0gKyA2Ljg3MTQyNTU5MjA0OTAwNyAqIHkgKyAzMS4xNTkxMDAxMzAwNTU5MjIgKiBrICsgLTc5LjI5NzA4NDQ4MTY1NDgpICsgbSAqICgtMTUuMzEwMzYxMzA2OTY3ODE3ICogbSArIDE3LjU3NTI1MTI2MTEwOTQ4MiAqIHkgKyAxMzEuMzUyNTA5MTI0OTM5NzYgKiBrIC0gMTkwLjk0NTMzMDI1ODg5NTEpICsgeSAqICg0LjQ0NDMzOTEwMjg1MjczOSAqIHkgKyA5Ljg2MzI4NjE0OTM0MDUgKiBrIC0gMjQuODY3NDE1ODI1NTU4NzgpICsgayAqICgtMjAuNzM3MzI1NDcxMTgxMDM0ICogayAtIDE4Ny44MDQ1MzcwOTcxOTU3OCk7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IDI1NSArIGMgKiAoMC44ODQyNTIyNDMwMDAzMjk2ICogYyArIDguMDc4Njc3NTAzMTEyOTI4ICogbSArIDMwLjg5OTc4MzA5NzAzNzI5ICogeSAtIDAuMjM4ODMyMzg2ODkxNzg5MzQgKiBrICsgLTE0LjE4MzU3Njc5OTY3MzI4NikgKyBtICogKDEwLjQ5NTkzMjczNDMyMDcyICogbSArIDYzLjAyMzc4NDk0NzU0MDUyICogeSArIDUwLjYwNjk1NzY1NjM2MDczNCAqIGsgLSAxMTIuMjM4ODQyNTM3MTkyNDgpICsgeSAqICgwLjAzMjk2MDQxMTE0ODczMjE3ICogeSArIDExNS42MDM4NDQ0OTY0NjY0MSAqIGsgKyAtMTkzLjU4MjA5MzU2ODYxNTA1KSArIGsgKiAoLTIyLjMzODE2ODA3MzA5ODg2ICogayAtIDE4MC4xMjYxMzk3NDcwODM2Nyk7CiAgfQoKICBjbGFzcyBEZXZpY2VDbXlrQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiRGV2aWNlQ01ZSyIsIDQpOwogICAgfQoKICAgIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29udmVydFRvUmdiKHNyYywgc3JjT2Zmc2V0LCAxLCBkZXN0LCBkZXN0T2Zmc2V0KTsKICAgIH0KCiAgICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICAgIGNvbnN0IHNjYWxlID0gMSAvICgoMSA8PCBiaXRzKSAtIDEpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29udmVydFRvUmdiKHNyYywgc3JjT2Zmc2V0LCBzY2FsZSwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICAgICAgc3JjT2Zmc2V0ICs9IDQ7CiAgICAgICAgZGVzdE9mZnNldCArPSAzICsgYWxwaGEwMTsKICAgICAgfQogICAgfQoKICAgIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICByZXR1cm4gaW5wdXRMZW5ndGggLyA0ICogKDMgKyBhbHBoYTAxKSB8IDA7CiAgICB9CgogIH0KCiAgcmV0dXJuIERldmljZUNteWtDUzsKfSgpOwoKY29uc3QgQ2FsR3JheUNTID0gZnVuY3Rpb24gQ2FsR3JheUNTQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBjb252ZXJ0VG9SZ2IoY3MsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCBzY2FsZSkgewogICAgY29uc3QgQSA9IHNyY1tzcmNPZmZzZXRdICogc2NhbGU7CiAgICBjb25zdCBBRyA9IEEgKiogY3MuRzsKICAgIGNvbnN0IEwgPSBjcy5ZVyAqIEFHOwogICAgY29uc3QgdmFsID0gTWF0aC5tYXgoMjk1LjggKiBMICoqIDAuMzMzMzMzMzMzMzMzMzMzMyAtIDQwLjgsIDApOwogICAgZGVzdFtkZXN0T2Zmc2V0XSA9IHZhbDsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gdmFsOwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSB2YWw7CiAgfQoKICBjbGFzcyBDYWxHcmF5Q1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICAgIGNvbnN0cnVjdG9yKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hKSB7CiAgICAgIHN1cGVyKCJDYWxHcmF5IiwgMSk7CgogICAgICBpZiAoIXdoaXRlUG9pbnQpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIldoaXRlUG9pbnQgbWlzc2luZyAtIHJlcXVpcmVkIGZvciBjb2xvciBzcGFjZSBDYWxHcmF5Iik7CiAgICAgIH0KCiAgICAgIGJsYWNrUG9pbnQgPSBibGFja1BvaW50IHx8IFswLCAwLCAwXTsKICAgICAgZ2FtbWEgPSBnYW1tYSB8fCAxOwogICAgICB0aGlzLlhXID0gd2hpdGVQb2ludFswXTsKICAgICAgdGhpcy5ZVyA9IHdoaXRlUG9pbnRbMV07CiAgICAgIHRoaXMuWlcgPSB3aGl0ZVBvaW50WzJdOwogICAgICB0aGlzLlhCID0gYmxhY2tQb2ludFswXTsKICAgICAgdGhpcy5ZQiA9IGJsYWNrUG9pbnRbMV07CiAgICAgIHRoaXMuWkIgPSBibGFja1BvaW50WzJdOwogICAgICB0aGlzLkcgPSBnYW1tYTsKCiAgICAgIGlmICh0aGlzLlhXIDwgMCB8fCB0aGlzLlpXIDwgMCB8fCB0aGlzLllXICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIFdoaXRlUG9pbnQgY29tcG9uZW50cyBmb3IgJHt0aGlzLm5hbWV9YCArICIsIG5vIGZhbGxiYWNrIGF2YWlsYWJsZSIpOwogICAgICB9CgogICAgICBpZiAodGhpcy5YQiA8IDAgfHwgdGhpcy5ZQiA8IDAgfHwgdGhpcy5aQiA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoYEludmFsaWQgQmxhY2tQb2ludCBmb3IgJHt0aGlzLm5hbWV9LCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC5gKTsKICAgICAgICB0aGlzLlhCID0gdGhpcy5ZQiA9IHRoaXMuWkIgPSAwOwogICAgICB9CgogICAgICBpZiAodGhpcy5YQiAhPT0gMCB8fCB0aGlzLllCICE9PSAwIHx8IHRoaXMuWkIgIT09IDApIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYCR7dGhpcy5uYW1lfSwgQmxhY2tQb2ludDogWEI6ICR7dGhpcy5YQn0sIFlCOiAke3RoaXMuWUJ9LCBgICsgYFpCOiAke3RoaXMuWkJ9LCBvbmx5IGRlZmF1bHQgdmFsdWVzIGFyZSBzdXBwb3J0ZWQuYCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLkcgPCAxKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKGBJbnZhbGlkIEdhbW1hOiAke3RoaXMuR30gZm9yICR7dGhpcy5uYW1lfSwgYCArICJmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC4iKTsKICAgICAgICB0aGlzLkcgPSAxOwogICAgICB9CiAgICB9CgogICAgZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIDEpOwogICAgfQoKICAgIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgY29uc3Qgc2NhbGUgPSAxIC8gKCgxIDw8IGJpdHMpIC0gMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyArK2kpIHsKICAgICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIHNjYWxlKTsKICAgICAgICBzcmNPZmZzZXQgKz0gMTsKICAgICAgICBkZXN0T2Zmc2V0ICs9IDMgKyBhbHBoYTAxOwogICAgICB9CiAgICB9CgogICAgZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICAgIHJldHVybiBpbnB1dExlbmd0aCAqICgzICsgYWxwaGEwMSk7CiAgICB9CgogIH0KCiAgcmV0dXJuIENhbEdyYXlDUzsKfSgpOwoKY29uc3QgQ2FsUkdCQ1MgPSBmdW5jdGlvbiBDYWxSR0JDU0Nsb3N1cmUoKSB7CiAgY29uc3QgQlJBREZPUkRfU0NBTEVfTUFUUklYID0gbmV3IEZsb2F0MzJBcnJheShbMC44OTUxLCAwLjI2NjQsIC0wLjE2MTQsIC0wLjc1MDIsIDEuNzEzNSwgMC4wMzY3LCAwLjAzODksIC0wLjA2ODUsIDEuMDI5Nl0pOwogIGNvbnN0IEJSQURGT1JEX1NDQUxFX0lOVkVSU0VfTUFUUklYID0gbmV3IEZsb2F0MzJBcnJheShbMC45ODY5OTI5LCAtMC4xNDcwNTQzLCAwLjE1OTk2MjcsIDAuNDMyMzA1MywgMC41MTgzNjAzLCAwLjA0OTI5MTIsIC0wLjAwODUyODcsIDAuMDQwMDQyOCwgMC45Njg0ODY3XSk7CiAgY29uc3QgU1JHQl9ENjVfWFlaX1RPX1JHQl9NQVRSSVggPSBuZXcgRmxvYXQzMkFycmF5KFszLjI0MDQ1NDIsIC0xLjUzNzEzODUsIC0wLjQ5ODUzMTQsIC0wLjk2OTI2NjAsIDEuODc2MDEwOCwgMC4wNDE1NTYwLCAwLjA1NTY0MzQsIC0wLjIwNDAyNTksIDEuMDU3MjI1Ml0pOwogIGNvbnN0IEZMQVRfV0hJVEVQT0lOVF9NQVRSSVggPSBuZXcgRmxvYXQzMkFycmF5KFsxLCAxLCAxXSk7CiAgY29uc3QgdGVtcE5vcm1hbGl6ZU1hdHJpeCA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7CiAgY29uc3QgdGVtcENvbnZlcnRNYXRyaXgxID0gbmV3IEZsb2F0MzJBcnJheSgzKTsKICBjb25zdCB0ZW1wQ29udmVydE1hdHJpeDIgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogIGNvbnN0IERFQ09ERV9MX0NPTlNUQU5UID0gKCg4ICsgMTYpIC8gMTE2KSAqKiAzIC8gOC4wOwoKICBmdW5jdGlvbiBtYXRyaXhQcm9kdWN0KGEsIGIsIHJlc3VsdCkgewogICAgcmVzdWx0WzBdID0gYVswXSAqIGJbMF0gKyBhWzFdICogYlsxXSArIGFbMl0gKiBiWzJdOwogICAgcmVzdWx0WzFdID0gYVszXSAqIGJbMF0gKyBhWzRdICogYlsxXSArIGFbNV0gKiBiWzJdOwogICAgcmVzdWx0WzJdID0gYVs2XSAqIGJbMF0gKyBhWzddICogYlsxXSArIGFbOF0gKiBiWzJdOwogIH0KCiAgZnVuY3Rpb24gY29udmVydFRvRmxhdChzb3VyY2VXaGl0ZVBvaW50LCBMTVMsIHJlc3VsdCkgewogICAgcmVzdWx0WzBdID0gTE1TWzBdICogMSAvIHNvdXJjZVdoaXRlUG9pbnRbMF07CiAgICByZXN1bHRbMV0gPSBMTVNbMV0gKiAxIC8gc291cmNlV2hpdGVQb2ludFsxXTsKICAgIHJlc3VsdFsyXSA9IExNU1syXSAqIDEgLyBzb3VyY2VXaGl0ZVBvaW50WzJdOwogIH0KCiAgZnVuY3Rpb24gY29udmVydFRvRDY1KHNvdXJjZVdoaXRlUG9pbnQsIExNUywgcmVzdWx0KSB7CiAgICBjb25zdCBENjVYID0gMC45NTA0NzsKICAgIGNvbnN0IEQ2NVkgPSAxOwogICAgY29uc3QgRDY1WiA9IDEuMDg4ODM7CiAgICByZXN1bHRbMF0gPSBMTVNbMF0gKiBENjVYIC8gc291cmNlV2hpdGVQb2ludFswXTsKICAgIHJlc3VsdFsxXSA9IExNU1sxXSAqIEQ2NVkgLyBzb3VyY2VXaGl0ZVBvaW50WzFdOwogICAgcmVzdWx0WzJdID0gTE1TWzJdICogRDY1WiAvIHNvdXJjZVdoaXRlUG9pbnRbMl07CiAgfQoKICBmdW5jdGlvbiBzUkdCVHJhbnNmZXJGdW5jdGlvbihjb2xvcikgewogICAgaWYgKGNvbG9yIDw9IDAuMDAzMTMwOCkgewogICAgICByZXR1cm4gYWRqdXN0VG9SYW5nZSgwLCAxLCAxMi45MiAqIGNvbG9yKTsKICAgIH0KCiAgICBpZiAoY29sb3IgPj0gMC45OTU1NDUyNSkgewogICAgICByZXR1cm4gMTsKICAgIH0KCiAgICByZXR1cm4gYWRqdXN0VG9SYW5nZSgwLCAxLCAoMSArIDAuMDU1KSAqIGNvbG9yICoqICgxIC8gMi40KSAtIDAuMDU1KTsKICB9CgogIGZ1bmN0aW9uIGFkanVzdFRvUmFuZ2UobWluLCBtYXgsIHZhbHVlKSB7CiAgICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVMKEwpIHsKICAgIGlmIChMIDwgMCkgewogICAgICByZXR1cm4gLWRlY29kZUwoLUwpOwogICAgfQoKICAgIGlmIChMID4gOC4wKSB7CiAgICAgIHJldHVybiAoKEwgKyAxNikgLyAxMTYpICoqIDM7CiAgICB9CgogICAgcmV0dXJuIEwgKiBERUNPREVfTF9DT05TVEFOVDsKICB9CgogIGZ1bmN0aW9uIGNvbXBlbnNhdGVCbGFja1BvaW50KHNvdXJjZUJsYWNrUG9pbnQsIFhZWl9GbGF0LCByZXN1bHQpIHsKICAgIGlmIChzb3VyY2VCbGFja1BvaW50WzBdID09PSAwICYmIHNvdXJjZUJsYWNrUG9pbnRbMV0gPT09IDAgJiYgc291cmNlQmxhY2tQb2ludFsyXSA9PT0gMCkgewogICAgICByZXN1bHRbMF0gPSBYWVpfRmxhdFswXTsKICAgICAgcmVzdWx0WzFdID0gWFlaX0ZsYXRbMV07CiAgICAgIHJlc3VsdFsyXSA9IFhZWl9GbGF0WzJdOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgemVyb0RlY29kZUwgPSBkZWNvZGVMKDApOwogICAgY29uc3QgWF9EU1QgPSB6ZXJvRGVjb2RlTDsKICAgIGNvbnN0IFhfU1JDID0gZGVjb2RlTChzb3VyY2VCbGFja1BvaW50WzBdKTsKICAgIGNvbnN0IFlfRFNUID0gemVyb0RlY29kZUw7CiAgICBjb25zdCBZX1NSQyA9IGRlY29kZUwoc291cmNlQmxhY2tQb2ludFsxXSk7CiAgICBjb25zdCBaX0RTVCA9IHplcm9EZWNvZGVMOwogICAgY29uc3QgWl9TUkMgPSBkZWNvZGVMKHNvdXJjZUJsYWNrUG9pbnRbMl0pOwogICAgY29uc3QgWF9TY2FsZSA9ICgxIC0gWF9EU1QpIC8gKDEgLSBYX1NSQyk7CiAgICBjb25zdCBYX09mZnNldCA9IDEgLSBYX1NjYWxlOwogICAgY29uc3QgWV9TY2FsZSA9ICgxIC0gWV9EU1QpIC8gKDEgLSBZX1NSQyk7CiAgICBjb25zdCBZX09mZnNldCA9IDEgLSBZX1NjYWxlOwogICAgY29uc3QgWl9TY2FsZSA9ICgxIC0gWl9EU1QpIC8gKDEgLSBaX1NSQyk7CiAgICBjb25zdCBaX09mZnNldCA9IDEgLSBaX1NjYWxlOwogICAgcmVzdWx0WzBdID0gWFlaX0ZsYXRbMF0gKiBYX1NjYWxlICsgWF9PZmZzZXQ7CiAgICByZXN1bHRbMV0gPSBYWVpfRmxhdFsxXSAqIFlfU2NhbGUgKyBZX09mZnNldDsKICAgIHJlc3VsdFsyXSA9IFhZWl9GbGF0WzJdICogWl9TY2FsZSArIFpfT2Zmc2V0OwogIH0KCiAgZnVuY3Rpb24gbm9ybWFsaXplV2hpdGVQb2ludFRvRmxhdChzb3VyY2VXaGl0ZVBvaW50LCBYWVpfSW4sIHJlc3VsdCkgewogICAgaWYgKHNvdXJjZVdoaXRlUG9pbnRbMF0gPT09IDEgJiYgc291cmNlV2hpdGVQb2ludFsyXSA9PT0gMSkgewogICAgICByZXN1bHRbMF0gPSBYWVpfSW5bMF07CiAgICAgIHJlc3VsdFsxXSA9IFhZWl9JblsxXTsKICAgICAgcmVzdWx0WzJdID0gWFlaX0luWzJdOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgTE1TID0gcmVzdWx0OwogICAgbWF0cml4UHJvZHVjdChCUkFERk9SRF9TQ0FMRV9NQVRSSVgsIFhZWl9JbiwgTE1TKTsKICAgIGNvbnN0IExNU19GbGF0ID0gdGVtcE5vcm1hbGl6ZU1hdHJpeDsKICAgIGNvbnZlcnRUb0ZsYXQoc291cmNlV2hpdGVQb2ludCwgTE1TLCBMTVNfRmxhdCk7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX0lOVkVSU0VfTUFUUklYLCBMTVNfRmxhdCwgcmVzdWx0KTsKICB9CgogIGZ1bmN0aW9uIG5vcm1hbGl6ZVdoaXRlUG9pbnRUb0Q2NShzb3VyY2VXaGl0ZVBvaW50LCBYWVpfSW4sIHJlc3VsdCkgewogICAgY29uc3QgTE1TID0gcmVzdWx0OwogICAgbWF0cml4UHJvZHVjdChCUkFERk9SRF9TQ0FMRV9NQVRSSVgsIFhZWl9JbiwgTE1TKTsKICAgIGNvbnN0IExNU19ENjUgPSB0ZW1wTm9ybWFsaXplTWF0cml4OwogICAgY29udmVydFRvRDY1KHNvdXJjZVdoaXRlUG9pbnQsIExNUywgTE1TX0Q2NSk7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX0lOVkVSU0VfTUFUUklYLCBMTVNfRDY1LCByZXN1bHQpOwogIH0KCiAgZnVuY3Rpb24gY29udmVydFRvUmdiKGNzLCBzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCwgc2NhbGUpIHsKICAgIGNvbnN0IEEgPSBhZGp1c3RUb1JhbmdlKDAsIDEsIHNyY1tzcmNPZmZzZXRdICogc2NhbGUpOwogICAgY29uc3QgQiA9IGFkanVzdFRvUmFuZ2UoMCwgMSwgc3JjW3NyY09mZnNldCArIDFdICogc2NhbGUpOwogICAgY29uc3QgQyA9IGFkanVzdFRvUmFuZ2UoMCwgMSwgc3JjW3NyY09mZnNldCArIDJdICogc2NhbGUpOwogICAgY29uc3QgQUdSID0gQSA9PT0gMSA/IDEgOiBBICoqIGNzLkdSOwogICAgY29uc3QgQkdHID0gQiA9PT0gMSA/IDEgOiBCICoqIGNzLkdHOwogICAgY29uc3QgQ0dCID0gQyA9PT0gMSA/IDEgOiBDICoqIGNzLkdCOwogICAgY29uc3QgWCA9IGNzLk1YQSAqIEFHUiArIGNzLk1YQiAqIEJHRyArIGNzLk1YQyAqIENHQjsKICAgIGNvbnN0IFkgPSBjcy5NWUEgKiBBR1IgKyBjcy5NWUIgKiBCR0cgKyBjcy5NWUMgKiBDR0I7CiAgICBjb25zdCBaID0gY3MuTVpBICogQUdSICsgY3MuTVpCICogQkdHICsgY3MuTVpDICogQ0dCOwogICAgY29uc3QgWFlaID0gdGVtcENvbnZlcnRNYXRyaXgxOwogICAgWFlaWzBdID0gWDsKICAgIFhZWlsxXSA9IFk7CiAgICBYWVpbMl0gPSBaOwogICAgY29uc3QgWFlaX0ZsYXQgPSB0ZW1wQ29udmVydE1hdHJpeDI7CiAgICBub3JtYWxpemVXaGl0ZVBvaW50VG9GbGF0KGNzLndoaXRlUG9pbnQsIFhZWiwgWFlaX0ZsYXQpOwogICAgY29uc3QgWFlaX0JsYWNrID0gdGVtcENvbnZlcnRNYXRyaXgxOwogICAgY29tcGVuc2F0ZUJsYWNrUG9pbnQoY3MuYmxhY2tQb2ludCwgWFlaX0ZsYXQsIFhZWl9CbGFjayk7CiAgICBjb25zdCBYWVpfRDY1ID0gdGVtcENvbnZlcnRNYXRyaXgyOwogICAgbm9ybWFsaXplV2hpdGVQb2ludFRvRDY1KEZMQVRfV0hJVEVQT0lOVF9NQVRSSVgsIFhZWl9CbGFjaywgWFlaX0Q2NSk7CiAgICBjb25zdCBTUkdCID0gdGVtcENvbnZlcnRNYXRyaXgxOwogICAgbWF0cml4UHJvZHVjdChTUkdCX0Q2NV9YWVpfVE9fUkdCX01BVFJJWCwgWFlaX0Q2NSwgU1JHQik7CiAgICBkZXN0W2Rlc3RPZmZzZXRdID0gc1JHQlRyYW5zZmVyRnVuY3Rpb24oU1JHQlswXSkgKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAxXSA9IHNSR0JUcmFuc2ZlckZ1bmN0aW9uKFNSR0JbMV0pICogMjU1OwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSBzUkdCVHJhbnNmZXJGdW5jdGlvbihTUkdCWzJdKSAqIDI1NTsKICB9CgogIGNsYXNzIENhbFJHQkNTIGV4dGVuZHMgQ29sb3JTcGFjZSB7CiAgICBjb25zdHJ1Y3Rvcih3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYSwgbWF0cml4KSB7CiAgICAgIHN1cGVyKCJDYWxSR0IiLCAzKTsKCiAgICAgIGlmICghd2hpdGVQb2ludCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiV2hpdGVQb2ludCBtaXNzaW5nIC0gcmVxdWlyZWQgZm9yIGNvbG9yIHNwYWNlIENhbFJHQiIpOwogICAgICB9CgogICAgICBibGFja1BvaW50ID0gYmxhY2tQb2ludCB8fCBuZXcgRmxvYXQzMkFycmF5KDMpOwogICAgICBnYW1tYSA9IGdhbW1hIHx8IG5ldyBGbG9hdDMyQXJyYXkoWzEsIDEsIDFdKTsKICAgICAgbWF0cml4ID0gbWF0cml4IHx8IG5ldyBGbG9hdDMyQXJyYXkoWzEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDFdKTsKICAgICAgY29uc3QgWFcgPSB3aGl0ZVBvaW50WzBdOwogICAgICBjb25zdCBZVyA9IHdoaXRlUG9pbnRbMV07CiAgICAgIGNvbnN0IFpXID0gd2hpdGVQb2ludFsyXTsKICAgICAgdGhpcy53aGl0ZVBvaW50ID0gd2hpdGVQb2ludDsKICAgICAgY29uc3QgWEIgPSBibGFja1BvaW50WzBdOwogICAgICBjb25zdCBZQiA9IGJsYWNrUG9pbnRbMV07CiAgICAgIGNvbnN0IFpCID0gYmxhY2tQb2ludFsyXTsKICAgICAgdGhpcy5ibGFja1BvaW50ID0gYmxhY2tQb2ludDsKICAgICAgdGhpcy5HUiA9IGdhbW1hWzBdOwogICAgICB0aGlzLkdHID0gZ2FtbWFbMV07CiAgICAgIHRoaXMuR0IgPSBnYW1tYVsyXTsKICAgICAgdGhpcy5NWEEgPSBtYXRyaXhbMF07CiAgICAgIHRoaXMuTVlBID0gbWF0cml4WzFdOwogICAgICB0aGlzLk1aQSA9IG1hdHJpeFsyXTsKICAgICAgdGhpcy5NWEIgPSBtYXRyaXhbM107CiAgICAgIHRoaXMuTVlCID0gbWF0cml4WzRdOwogICAgICB0aGlzLk1aQiA9IG1hdHJpeFs1XTsKICAgICAgdGhpcy5NWEMgPSBtYXRyaXhbNl07CiAgICAgIHRoaXMuTVlDID0gbWF0cml4WzddOwogICAgICB0aGlzLk1aQyA9IG1hdHJpeFs4XTsKCiAgICAgIGlmIChYVyA8IDAgfHwgWlcgPCAwIHx8IFlXICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIFdoaXRlUG9pbnQgY29tcG9uZW50cyBmb3IgJHt0aGlzLm5hbWV9YCArICIsIG5vIGZhbGxiYWNrIGF2YWlsYWJsZSIpOwogICAgICB9CgogICAgICBpZiAoWEIgPCAwIHx8IFlCIDwgMCB8fCBaQiA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoYEludmFsaWQgQmxhY2tQb2ludCBmb3IgJHt0aGlzLm5hbWV9IFske1hCfSwgJHtZQn0sICR7WkJ9XSwgYCArICJmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC4iKTsKICAgICAgICB0aGlzLmJsYWNrUG9pbnQgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogICAgICB9CgogICAgICBpZiAodGhpcy5HUiA8IDAgfHwgdGhpcy5HRyA8IDAgfHwgdGhpcy5HQiA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoYEludmFsaWQgR2FtbWEgWyR7dGhpcy5HUn0sICR7dGhpcy5HR30sICR7dGhpcy5HQn1dIGZvciBgICsgYCR7dGhpcy5uYW1lfSwgZmFsbGluZyBiYWNrIHRvIGRlZmF1bHQuYCk7CiAgICAgICAgdGhpcy5HUiA9IHRoaXMuR0cgPSB0aGlzLkdCID0gMTsKICAgICAgfQogICAgfQoKICAgIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCAxKTsKICAgIH0KCiAgICBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICAgIGNvbnN0IHNjYWxlID0gMSAvICgoMSA8PCBiaXRzKSAtIDEpOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAgICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCBzY2FsZSk7CiAgICAgICAgc3JjT2Zmc2V0ICs9IDM7CiAgICAgICAgZGVzdE9mZnNldCArPSAzICsgYWxwaGEwMTsKICAgICAgfQogICAgfQoKICAgIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICByZXR1cm4gaW5wdXRMZW5ndGggKiAoMyArIGFscGhhMDEpIC8gMyB8IDA7CiAgICB9CgogIH0KCiAgcmV0dXJuIENhbFJHQkNTOwp9KCk7Cgpjb25zdCBMYWJDUyA9IGZ1bmN0aW9uIExhYkNTQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBmbl9nKHgpIHsKICAgIGxldCByZXN1bHQ7CgogICAgaWYgKHggPj0gNiAvIDI5KSB7CiAgICAgIHJlc3VsdCA9IHggKiogMzsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdCA9IDEwOCAvIDg0MSAqICh4IC0gNCAvIDI5KTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlKHZhbHVlLCBoaWdoMSwgbG93MiwgaGlnaDIpIHsKICAgIHJldHVybiBsb3cyICsgdmFsdWUgKiAoaGlnaDIgLSBsb3cyKSAvIGhpZ2gxOwogIH0KCiAgZnVuY3Rpb24gY29udmVydFRvUmdiKGNzLCBzcmMsIHNyY09mZnNldCwgbWF4VmFsLCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICBsZXQgTHMgPSBzcmNbc3JjT2Zmc2V0XTsKICAgIGxldCBhcyA9IHNyY1tzcmNPZmZzZXQgKyAxXTsKICAgIGxldCBicyA9IHNyY1tzcmNPZmZzZXQgKyAyXTsKCiAgICBpZiAobWF4VmFsICE9PSBmYWxzZSkgewogICAgICBMcyA9IGRlY29kZShMcywgbWF4VmFsLCAwLCAxMDApOwogICAgICBhcyA9IGRlY29kZShhcywgbWF4VmFsLCBjcy5hbWluLCBjcy5hbWF4KTsKICAgICAgYnMgPSBkZWNvZGUoYnMsIG1heFZhbCwgY3MuYm1pbiwgY3MuYm1heCk7CiAgICB9CgogICAgaWYgKGFzID4gY3MuYW1heCkgewogICAgICBhcyA9IGNzLmFtYXg7CiAgICB9IGVsc2UgaWYgKGFzIDwgY3MuYW1pbikgewogICAgICBhcyA9IGNzLmFtaW47CiAgICB9CgogICAgaWYgKGJzID4gY3MuYm1heCkgewogICAgICBicyA9IGNzLmJtYXg7CiAgICB9IGVsc2UgaWYgKGJzIDwgY3MuYm1pbikgewogICAgICBicyA9IGNzLmJtaW47CiAgICB9CgogICAgY29uc3QgTSA9IChMcyArIDE2KSAvIDExNjsKICAgIGNvbnN0IEwgPSBNICsgYXMgLyA1MDA7CiAgICBjb25zdCBOID0gTSAtIGJzIC8gMjAwOwogICAgY29uc3QgWCA9IGNzLlhXICogZm5fZyhMKTsKICAgIGNvbnN0IFkgPSBjcy5ZVyAqIGZuX2coTSk7CiAgICBjb25zdCBaID0gY3MuWlcgKiBmbl9nKE4pOwogICAgbGV0IHIsIGcsIGI7CgogICAgaWYgKGNzLlpXIDwgMSkgewogICAgICByID0gWCAqIDMuMTMzOSArIFkgKiAtMS42MTcgKyBaICogLTAuNDkwNjsKICAgICAgZyA9IFggKiAtMC45Nzg1ICsgWSAqIDEuOTE2ICsgWiAqIDAuMDMzMzsKICAgICAgYiA9IFggKiAwLjA3MiArIFkgKiAtMC4yMjkgKyBaICogMS40MDU3OwogICAgfSBlbHNlIHsKICAgICAgciA9IFggKiAzLjI0MDYgKyBZICogLTEuNTM3MiArIFogKiAtMC40OTg2OwogICAgICBnID0gWCAqIC0wLjk2ODkgKyBZICogMS44NzU4ICsgWiAqIDAuMDQxNTsKICAgICAgYiA9IFggKiAwLjA1NTcgKyBZICogLTAuMjA0ICsgWiAqIDEuMDU3OwogICAgfQoKICAgIGRlc3RbZGVzdE9mZnNldF0gPSBNYXRoLnNxcnQocikgKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAxXSA9IE1hdGguc3FydChnKSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDJdID0gTWF0aC5zcXJ0KGIpICogMjU1OwogIH0KCiAgY2xhc3MgTGFiQ1MgZXh0ZW5kcyBDb2xvclNwYWNlIHsKICAgIGNvbnN0cnVjdG9yKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIHJhbmdlKSB7CiAgICAgIHN1cGVyKCJMYWIiLCAzKTsKCiAgICAgIGlmICghd2hpdGVQb2ludCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiV2hpdGVQb2ludCBtaXNzaW5nIC0gcmVxdWlyZWQgZm9yIGNvbG9yIHNwYWNlIExhYiIpOwogICAgICB9CgogICAgICBibGFja1BvaW50ID0gYmxhY2tQb2ludCB8fCBbMCwgMCwgMF07CiAgICAgIHJhbmdlID0gcmFuZ2UgfHwgWy0xMDAsIDEwMCwgLTEwMCwgMTAwXTsKICAgICAgdGhpcy5YVyA9IHdoaXRlUG9pbnRbMF07CiAgICAgIHRoaXMuWVcgPSB3aGl0ZVBvaW50WzFdOwogICAgICB0aGlzLlpXID0gd2hpdGVQb2ludFsyXTsKICAgICAgdGhpcy5hbWluID0gcmFuZ2VbMF07CiAgICAgIHRoaXMuYW1heCA9IHJhbmdlWzFdOwogICAgICB0aGlzLmJtaW4gPSByYW5nZVsyXTsKICAgICAgdGhpcy5ibWF4ID0gcmFuZ2VbM107CiAgICAgIHRoaXMuWEIgPSBibGFja1BvaW50WzBdOwogICAgICB0aGlzLllCID0gYmxhY2tQb2ludFsxXTsKICAgICAgdGhpcy5aQiA9IGJsYWNrUG9pbnRbMl07CgogICAgICBpZiAodGhpcy5YVyA8IDAgfHwgdGhpcy5aVyA8IDAgfHwgdGhpcy5ZVyAhPT0gMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBXaGl0ZVBvaW50IGNvbXBvbmVudHMsIG5vIGZhbGxiYWNrIGF2YWlsYWJsZSIpOwogICAgICB9CgogICAgICBpZiAodGhpcy5YQiA8IDAgfHwgdGhpcy5ZQiA8IDAgfHwgdGhpcy5aQiA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkludmFsaWQgQmxhY2tQb2ludCwgZmFsbGluZyBiYWNrIHRvIGRlZmF1bHQiKTsKICAgICAgICB0aGlzLlhCID0gdGhpcy5ZQiA9IHRoaXMuWkIgPSAwOwogICAgICB9CgogICAgICBpZiAodGhpcy5hbWluID4gdGhpcy5hbWF4IHx8IHRoaXMuYm1pbiA+IHRoaXMuYm1heCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiSW52YWxpZCBSYW5nZSwgZmFsbGluZyBiYWNrIHRvIGRlZmF1bHRzIik7CiAgICAgICAgdGhpcy5hbWluID0gLTEwMDsKICAgICAgICB0aGlzLmFtYXggPSAxMDA7CiAgICAgICAgdGhpcy5ibWluID0gLTEwMDsKICAgICAgICB0aGlzLmJtYXggPSAxMDA7CiAgICAgIH0KICAgIH0KCiAgICBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGNvbnZlcnRUb1JnYih0aGlzLCBzcmMsIHNyY09mZnNldCwgZmFsc2UsIGRlc3QsIGRlc3RPZmZzZXQpOwogICAgfQoKICAgIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgY29uc3QgbWF4VmFsID0gKDEgPDwgYml0cykgLSAxOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBtYXhWYWwsIGRlc3QsIGRlc3RPZmZzZXQpOwogICAgICAgIHNyY09mZnNldCArPSAzOwogICAgICAgIGRlc3RPZmZzZXQgKz0gMyArIGFscGhhMDE7CiAgICAgIH0KICAgIH0KCiAgICBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKSAvIDMgfCAwOwogICAgfQoKICAgIGlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIGJwYykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBnZXQgdXNlc1plcm9Ub09uZVJhbmdlKCkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInVzZXNaZXJvVG9PbmVSYW5nZSIsIGZhbHNlKTsKICAgIH0KCiAgfQoKICByZXR1cm4gTGFiQ1M7Cn0oKTsKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBhcnRpYWxFdmFsdWF0b3IgPSBleHBvcnRzLkV2YWx1YXRvclByZXByb2Nlc3NvciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NtYXAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygzNCk7Cgp2YXIgX2ZvbnRzX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygzOCk7Cgp2YXIgX2VuY29kaW5ncyA9IF9fd19wZGZqc19yZXF1aXJlX18oMzcpOwoKdmFyIF9zdGFuZGFyZF9mb250cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDEpOwoKdmFyIF91bmljb2RlID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3BhdHRlcm4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKCnZhciBfeGZhX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1MSk7Cgp2YXIgX3RvX3VuaWNvZGVfbWFwID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7Cgp2YXIgX2Z1bmN0aW9uID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7Cgp2YXIgX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcpOwoKdmFyIF9pbWFnZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNTkpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9iaWRpID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MCk7Cgp2YXIgX2NvbG9yc3BhY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwoKdmFyIF9nbHlwaGxpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX21ldHJpY3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ1KTsKCnZhciBfbXVybXVyaGFzaCA9IF9fd19wZGZqc19yZXF1aXJlX18oNjEpOwoKdmFyIF9vcGVyYXRvcl9saXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7Cgp2YXIgX2ltYWdlID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Myk7Cgpjb25zdCBEZWZhdWx0UGFydGlhbEV2YWx1YXRvck9wdGlvbnMgPSBPYmplY3QuZnJlZXplKHsKICBtYXhJbWFnZVNpemU6IC0xLAogIGRpc2FibGVGb250RmFjZTogZmFsc2UsCiAgaWdub3JlRXJyb3JzOiBmYWxzZSwKICBpc0V2YWxTdXBwb3J0ZWQ6IHRydWUsCiAgZm9udEV4dHJhUHJvcGVydGllczogZmFsc2UsCiAgdXNlU3lzdGVtRm9udHM6IHRydWUsCiAgY01hcFVybDogbnVsbCwKICBzdGFuZGFyZEZvbnREYXRhVXJsOiBudWxsCn0pOwpjb25zdCBQYXR0ZXJuVHlwZSA9IHsKICBUSUxJTkc6IDEsCiAgU0hBRElORzogMgp9Owpjb25zdCBURVhUX0NIVU5LX0JBVENIX1NJWkUgPSAxMDsKY29uc3QgZGVmZXJyZWQgPSBQcm9taXNlLnJlc29sdmUoKTsKCmZ1bmN0aW9uIG5vcm1hbGl6ZUJsZW5kTW9kZSh2YWx1ZSwgcGFyc2luZ0FycmF5ID0gZmFsc2UpIHsKICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHZhbHVlLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgbWF5YmVCTSA9IG5vcm1hbGl6ZUJsZW5kTW9kZSh2YWx1ZVtpXSwgdHJ1ZSk7CgogICAgICBpZiAobWF5YmVCTSkgewogICAgICAgIHJldHVybiBtYXliZUJNOwogICAgICB9CiAgICB9CgogICAgKDAsIF91dGlsLndhcm4pKGBVbnN1cHBvcnRlZCBibGVuZCBtb2RlIEFycmF5OiAke3ZhbHVlfWApOwogICAgcmV0dXJuICJzb3VyY2Utb3ZlciI7CiAgfQoKICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICBpZiAocGFyc2luZ0FycmF5KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiAic291cmNlLW92ZXIiOwogIH0KCiAgc3dpdGNoICh2YWx1ZS5uYW1lKSB7CiAgICBjYXNlICJOb3JtYWwiOgogICAgY2FzZSAiQ29tcGF0aWJsZSI6CiAgICAgIHJldHVybiAic291cmNlLW92ZXIiOwoKICAgIGNhc2UgIk11bHRpcGx5IjoKICAgICAgcmV0dXJuICJtdWx0aXBseSI7CgogICAgY2FzZSAiU2NyZWVuIjoKICAgICAgcmV0dXJuICJzY3JlZW4iOwoKICAgIGNhc2UgIk92ZXJsYXkiOgogICAgICByZXR1cm4gIm92ZXJsYXkiOwoKICAgIGNhc2UgIkRhcmtlbiI6CiAgICAgIHJldHVybiAiZGFya2VuIjsKCiAgICBjYXNlICJMaWdodGVuIjoKICAgICAgcmV0dXJuICJsaWdodGVuIjsKCiAgICBjYXNlICJDb2xvckRvZGdlIjoKICAgICAgcmV0dXJuICJjb2xvci1kb2RnZSI7CgogICAgY2FzZSAiQ29sb3JCdXJuIjoKICAgICAgcmV0dXJuICJjb2xvci1idXJuIjsKCiAgICBjYXNlICJIYXJkTGlnaHQiOgogICAgICByZXR1cm4gImhhcmQtbGlnaHQiOwoKICAgIGNhc2UgIlNvZnRMaWdodCI6CiAgICAgIHJldHVybiAic29mdC1saWdodCI7CgogICAgY2FzZSAiRGlmZmVyZW5jZSI6CiAgICAgIHJldHVybiAiZGlmZmVyZW5jZSI7CgogICAgY2FzZSAiRXhjbHVzaW9uIjoKICAgICAgcmV0dXJuICJleGNsdXNpb24iOwoKICAgIGNhc2UgIkh1ZSI6CiAgICAgIHJldHVybiAiaHVlIjsKCiAgICBjYXNlICJTYXR1cmF0aW9uIjoKICAgICAgcmV0dXJuICJzYXR1cmF0aW9uIjsKCiAgICBjYXNlICJDb2xvciI6CiAgICAgIHJldHVybiAiY29sb3IiOwoKICAgIGNhc2UgIkx1bWlub3NpdHkiOgogICAgICByZXR1cm4gImx1bWlub3NpdHkiOwogIH0KCiAgaWYgKHBhcnNpbmdBcnJheSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICAoMCwgX3V0aWwud2FybikoYFVuc3VwcG9ydGVkIGJsZW5kIG1vZGU6ICR7dmFsdWUubmFtZX1gKTsKICByZXR1cm4gInNvdXJjZS1vdmVyIjsKfQoKZnVuY3Rpb24gaW5jcmVtZW50Q2FjaGVkSW1hZ2VNYXNrQ291bnQoZGF0YSkgewogIGlmIChkYXRhLmZuID09PSBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0ICYmIGRhdGEuYXJnc1swXSAmJiBkYXRhLmFyZ3NbMF0uY291bnQgPiAwKSB7CiAgICBkYXRhLmFyZ3NbMF0uY291bnQrKzsKICB9Cn0KCmNsYXNzIFRpbWVTbG90TWFuYWdlciB7CiAgc3RhdGljIGdldCBUSU1FX1NMT1RfRFVSQVRJT05fTVMoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIlRJTUVfU0xPVF9EVVJBVElPTl9NUyIsIDIwKTsKICB9CgogIHN0YXRpYyBnZXQgQ0hFQ0tfVElNRV9FVkVSWSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiQ0hFQ0tfVElNRV9FVkVSWSIsIDEwMCk7CiAgfQoKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMucmVzZXQoKTsKICB9CgogIGNoZWNrKCkgewogICAgaWYgKCsrdGhpcy5jaGVja2VkIDwgVGltZVNsb3RNYW5hZ2VyLkNIRUNLX1RJTUVfRVZFUlkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRoaXMuY2hlY2tlZCA9IDA7CiAgICByZXR1cm4gdGhpcy5lbmRUaW1lIDw9IERhdGUubm93KCk7CiAgfQoKICByZXNldCgpIHsKICAgIHRoaXMuZW5kVGltZSA9IERhdGUubm93KCkgKyBUaW1lU2xvdE1hbmFnZXIuVElNRV9TTE9UX0RVUkFUSU9OX01TOwogICAgdGhpcy5jaGVja2VkID0gMDsKICB9Cgp9CgpjbGFzcyBQYXJ0aWFsRXZhbHVhdG9yIHsKICBjb25zdHJ1Y3Rvcih7CiAgICB4cmVmLAogICAgaGFuZGxlciwKICAgIHBhZ2VJbmRleCwKICAgIGlkRmFjdG9yeSwKICAgIGZvbnRDYWNoZSwKICAgIGJ1aWx0SW5DTWFwQ2FjaGUsCiAgICBzdGFuZGFyZEZvbnREYXRhQ2FjaGUsCiAgICBnbG9iYWxJbWFnZUNhY2hlLAogICAgb3B0aW9ucyA9IG51bGwKICB9KSB7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlcjsKICAgIHRoaXMucGFnZUluZGV4ID0gcGFnZUluZGV4OwogICAgdGhpcy5pZEZhY3RvcnkgPSBpZEZhY3Rvcnk7CiAgICB0aGlzLmZvbnRDYWNoZSA9IGZvbnRDYWNoZTsKICAgIHRoaXMuYnVpbHRJbkNNYXBDYWNoZSA9IGJ1aWx0SW5DTWFwQ2FjaGU7CiAgICB0aGlzLnN0YW5kYXJkRm9udERhdGFDYWNoZSA9IHN0YW5kYXJkRm9udERhdGFDYWNoZTsKICAgIHRoaXMuZ2xvYmFsSW1hZ2VDYWNoZSA9IGdsb2JhbEltYWdlQ2FjaGU7CiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IERlZmF1bHRQYXJ0aWFsRXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMucGFyc2luZ1R5cGUzRm9udCA9IGZhbHNlOwogICAgdGhpcy5fZmV0Y2hCdWlsdEluQ01hcEJvdW5kID0gdGhpcy5mZXRjaEJ1aWx0SW5DTWFwLmJpbmQodGhpcyk7CiAgfQoKICBnZXQgX3BkZkZ1bmN0aW9uRmFjdG9yeSgpIHsKICAgIGNvbnN0IHBkZkZ1bmN0aW9uRmFjdG9yeSA9IG5ldyBfZnVuY3Rpb24uUERGRnVuY3Rpb25GYWN0b3J5KHsKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICBpc0V2YWxTdXBwb3J0ZWQ6IHRoaXMub3B0aW9ucy5pc0V2YWxTdXBwb3J0ZWQKICAgIH0pOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJfcGRmRnVuY3Rpb25GYWN0b3J5IiwgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICB9CgogIGNsb25lKG5ld09wdGlvbnMgPSBudWxsKSB7CiAgICBjb25zdCBuZXdFdmFsdWF0b3IgPSBPYmplY3QuY3JlYXRlKHRoaXMpOwogICAgbmV3RXZhbHVhdG9yLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobnVsbCksIHRoaXMub3B0aW9ucywgbmV3T3B0aW9ucyk7CiAgICByZXR1cm4gbmV3RXZhbHVhdG9yOwogIH0KCiAgaGFzQmxlbmRNb2RlcyhyZXNvdXJjZXMsIG5vbkJsZW5kTW9kZXNTZXQpIHsKICAgIGlmICghKHJlc291cmNlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAocmVzb3VyY2VzLm9iaklkICYmIG5vbkJsZW5kTW9kZXNTZXQuaGFzKHJlc291cmNlcy5vYmpJZCkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGNvbnN0IHByb2Nlc3NlZCA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXQobm9uQmxlbmRNb2Rlc1NldCk7CgogICAgaWYgKHJlc291cmNlcy5vYmpJZCkgewogICAgICBwcm9jZXNzZWQucHV0KHJlc291cmNlcy5vYmpJZCk7CiAgICB9CgogICAgY29uc3Qgbm9kZXMgPSBbcmVzb3VyY2VzXSwKICAgICAgICAgIHhyZWYgPSB0aGlzLnhyZWY7CgogICAgd2hpbGUgKG5vZGVzLmxlbmd0aCkgewogICAgICBjb25zdCBub2RlID0gbm9kZXMuc2hpZnQoKTsKICAgICAgY29uc3QgZ3JhcGhpY1N0YXRlcyA9IG5vZGUuZ2V0KCJFeHRHU3RhdGUiKTsKCiAgICAgIGlmIChncmFwaGljU3RhdGVzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIGZvciAobGV0IGdyYXBoaWNTdGF0ZSBvZiBncmFwaGljU3RhdGVzLmdldFJhd1ZhbHVlcygpKSB7CiAgICAgICAgICBpZiAoZ3JhcGhpY1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgIGlmIChwcm9jZXNzZWQuaGFzKGdyYXBoaWNTdGF0ZSkpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBncmFwaGljU3RhdGUgPSB4cmVmLmZldGNoKGdyYXBoaWNTdGF0ZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICAgICAgcHJvY2Vzc2VkLnB1dChncmFwaGljU3RhdGUpOwogICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKShgaGFzQmxlbmRNb2RlcyAtIGlnbm9yaW5nIEV4dEdTdGF0ZTogIiR7ZXh9Ii5gKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICghKGdyYXBoaWNTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChncmFwaGljU3RhdGUub2JqSWQpIHsKICAgICAgICAgICAgcHJvY2Vzc2VkLnB1dChncmFwaGljU3RhdGUub2JqSWQpOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGJtID0gZ3JhcGhpY1N0YXRlLmdldCgiQk0iKTsKCiAgICAgICAgICBpZiAoYm0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIGlmIChibS5uYW1lICE9PSAiTm9ybWFsIikgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoYm0gIT09IHVuZGVmaW5lZCAmJiBBcnJheS5pc0FycmF5KGJtKSkgewogICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgYm0pIHsKICAgICAgICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUgJiYgZWxlbWVudC5uYW1lICE9PSAiTm9ybWFsIikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB4T2JqZWN0cyA9IG5vZGUuZ2V0KCJYT2JqZWN0Iik7CgogICAgICBpZiAoISh4T2JqZWN0cyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IHhPYmplY3Qgb2YgeE9iamVjdHMuZ2V0UmF3VmFsdWVzKCkpIHsKICAgICAgICBpZiAoeE9iamVjdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgaWYgKHByb2Nlc3NlZC5oYXMoeE9iamVjdCkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgeE9iamVjdCA9IHhyZWYuZmV0Y2goeE9iamVjdCk7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICBwcm9jZXNzZWQucHV0KHhPYmplY3QpOwogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoYGhhc0JsZW5kTW9kZXMgLSBpZ25vcmluZyBYT2JqZWN0OiAiJHtleH0iLmApOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghKHhPYmplY3QgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhPYmplY3QuZGljdC5vYmpJZCkgewogICAgICAgICAgcHJvY2Vzc2VkLnB1dCh4T2JqZWN0LmRpY3Qub2JqSWQpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgeFJlc291cmNlcyA9IHhPYmplY3QuZGljdC5nZXQoIlJlc291cmNlcyIpOwoKICAgICAgICBpZiAoISh4UmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhSZXNvdXJjZXMub2JqSWQgJiYgcHJvY2Vzc2VkLmhhcyh4UmVzb3VyY2VzLm9iaklkKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBub2Rlcy5wdXNoKHhSZXNvdXJjZXMpOwoKICAgICAgICBpZiAoeFJlc291cmNlcy5vYmpJZCkgewogICAgICAgICAgcHJvY2Vzc2VkLnB1dCh4UmVzb3VyY2VzLm9iaklkKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IHJlZiBvZiBwcm9jZXNzZWQpIHsKICAgICAgbm9uQmxlbmRNb2Rlc1NldC5wdXQocmVmKTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBhc3luYyBmZXRjaEJ1aWx0SW5DTWFwKG5hbWUpIHsKICAgIGNvbnN0IGNhY2hlZERhdGEgPSB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUuZ2V0KG5hbWUpOwoKICAgIGlmIChjYWNoZWREYXRhKSB7CiAgICAgIHJldHVybiBjYWNoZWREYXRhOwogICAgfQoKICAgIGxldCBkYXRhOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuY01hcFVybCAhPT0gbnVsbCkgewogICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLm9wdGlvbnMuY01hcFVybH0ke25hbWV9LmJjbWFwYDsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpOwoKICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgZmV0Y2hCdWlsdEluQ01hcDogZmFpbGVkIHRvIGZldGNoIGZpbGUgIiR7dXJsfSIgd2l0aCAiJHtyZXNwb25zZS5zdGF0dXNUZXh0fSIuYCk7CiAgICAgIH0KCiAgICAgIGRhdGEgPSB7CiAgICAgICAgY01hcERhdGE6IG5ldyBVaW50OEFycmF5KGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpLAogICAgICAgIGNvbXByZXNzaW9uVHlwZTogX3V0aWwuQ01hcENvbXByZXNzaW9uVHlwZS5CSU5BUlkKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGRhdGEgPSBhd2FpdCB0aGlzLmhhbmRsZXIuc2VuZFdpdGhQcm9taXNlKCJGZXRjaEJ1aWx0SW5DTWFwIiwgewogICAgICAgIG5hbWUKICAgICAgfSk7CiAgICB9CgogICAgaWYgKGRhdGEuY29tcHJlc3Npb25UeXBlICE9PSBfdXRpbC5DTWFwQ29tcHJlc3Npb25UeXBlLk5PTkUpIHsKICAgICAgdGhpcy5idWlsdEluQ01hcENhY2hlLnNldChuYW1lLCBkYXRhKTsKICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIGFzeW5jIGZldGNoU3RhbmRhcmRGb250RGF0YShuYW1lKSB7CiAgICBjb25zdCBjYWNoZWREYXRhID0gdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUuZ2V0KG5hbWUpOwoKICAgIGlmIChjYWNoZWREYXRhKSB7CiAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5TdHJlYW0oY2FjaGVkRGF0YSk7CiAgICB9CgogICAgaWYgKHRoaXMub3B0aW9ucy51c2VTeXN0ZW1Gb250cyAmJiBuYW1lICE9PSAiU3ltYm9sIiAmJiBuYW1lICE9PSAiWmFwZkRpbmdiYXRzIikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBzdGFuZGFyZEZvbnROYW1lVG9GaWxlTmFtZSA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0Rm9udE5hbWVUb0ZpbGVNYXApKCksCiAgICAgICAgICBmaWxlbmFtZSA9IHN0YW5kYXJkRm9udE5hbWVUb0ZpbGVOYW1lW25hbWVdOwogICAgbGV0IGRhdGE7CgogICAgaWYgKHRoaXMub3B0aW9ucy5zdGFuZGFyZEZvbnREYXRhVXJsICE9PSBudWxsKSB7CiAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMub3B0aW9ucy5zdGFuZGFyZEZvbnREYXRhVXJsfSR7ZmlsZW5hbWV9YDsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpOwoKICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgZmV0Y2hTdGFuZGFyZEZvbnREYXRhOiBmYWlsZWQgdG8gZmV0Y2ggZmlsZSAiJHt1cmx9IiB3aXRoICIke3Jlc3BvbnNlLnN0YXR1c1RleHR9Ii5gKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdHJ5IHsKICAgICAgICBkYXRhID0gYXdhaXQgdGhpcy5oYW5kbGVyLnNlbmRXaXRoUHJvbWlzZSgiRmV0Y2hTdGFuZGFyZEZvbnREYXRhIiwgewogICAgICAgICAgZmlsZW5hbWUKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgZmV0Y2hTdGFuZGFyZEZvbnREYXRhOiBmYWlsZWQgdG8gZmV0Y2ggZmlsZSAiJHtmaWxlbmFtZX0iIHdpdGggIiR7ZX0iLmApOwogICAgICB9CiAgICB9CgogICAgaWYgKCFkYXRhKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHRoaXMuc3RhbmRhcmRGb250RGF0YUNhY2hlLnNldChuYW1lLCBkYXRhKTsKICAgIHJldHVybiBuZXcgX3N0cmVhbS5TdHJlYW0oZGF0YSk7CiAgfQoKICBhc3luYyBidWlsZEZvcm1YT2JqZWN0KHJlc291cmNlcywgeG9iaiwgc21hc2ssIG9wZXJhdG9yTGlzdCwgdGFzaywgaW5pdGlhbFN0YXRlLCBsb2NhbENvbG9yU3BhY2VDYWNoZSkgewogICAgY29uc3QgZGljdCA9IHhvYmouZGljdDsKICAgIGNvbnN0IG1hdHJpeCA9IGRpY3QuZ2V0QXJyYXkoIk1hdHJpeCIpOwogICAgbGV0IGJib3ggPSBkaWN0LmdldEFycmF5KCJCQm94Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYmJveCkgJiYgYmJveC5sZW5ndGggPT09IDQpIHsKICAgICAgYmJveCA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdChiYm94KTsKICAgIH0gZWxzZSB7CiAgICAgIGJib3ggPSBudWxsOwogICAgfQoKICAgIGxldCBvcHRpb25hbENvbnRlbnQsIGdyb3VwT3B0aW9uczsKCiAgICBpZiAoZGljdC5oYXMoIk9DIikpIHsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gYXdhaXQgdGhpcy5wYXJzZU1hcmtlZENvbnRlbnRQcm9wcyhkaWN0LmdldCgiT0MiKSwgcmVzb3VyY2VzKTsKICAgIH0KCiAgICBpZiAob3B0aW9uYWxDb250ZW50ICE9PSB1bmRlZmluZWQpIHsKICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wcywgWyJPQyIsIG9wdGlvbmFsQ29udGVudF0pOwogICAgfQoKICAgIGNvbnN0IGdyb3VwID0gZGljdC5nZXQoIkdyb3VwIik7CgogICAgaWYgKGdyb3VwKSB7CiAgICAgIGdyb3VwT3B0aW9ucyA9IHsKICAgICAgICBtYXRyaXgsCiAgICAgICAgYmJveCwKICAgICAgICBzbWFzaywKICAgICAgICBpc29sYXRlZDogZmFsc2UsCiAgICAgICAga25vY2tvdXQ6IGZhbHNlCiAgICAgIH07CiAgICAgIGNvbnN0IGdyb3VwU3VidHlwZSA9IGdyb3VwLmdldCgiUyIpOwogICAgICBsZXQgY29sb3JTcGFjZSA9IG51bGw7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZ3JvdXBTdWJ0eXBlLCAiVHJhbnNwYXJlbmN5IikpIHsKICAgICAgICBncm91cE9wdGlvbnMuaXNvbGF0ZWQgPSBncm91cC5nZXQoIkkiKSB8fCBmYWxzZTsKICAgICAgICBncm91cE9wdGlvbnMua25vY2tvdXQgPSBncm91cC5nZXQoIksiKSB8fCBmYWxzZTsKCiAgICAgICAgaWYgKGdyb3VwLmhhcygiQ1MiKSkgewogICAgICAgICAgY29uc3QgY3MgPSBncm91cC5nZXRSYXcoIkNTIik7CgogICAgICAgICAgY29uc3QgY2FjaGVkQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2UuZ2V0Q2FjaGVkKGNzLCB0aGlzLnhyZWYsIGxvY2FsQ29sb3JTcGFjZUNhY2hlKTsKCiAgICAgICAgICBpZiAoY2FjaGVkQ29sb3JTcGFjZSkgewogICAgICAgICAgICBjb2xvclNwYWNlID0gY2FjaGVkQ29sb3JTcGFjZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBhd2FpdCB0aGlzLnBhcnNlQ29sb3JTcGFjZSh7CiAgICAgICAgICAgICAgY3MsCiAgICAgICAgICAgICAgcmVzb3VyY2VzLAogICAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNtYXNrICYmIHNtYXNrLmJhY2tkcm9wKSB7CiAgICAgICAgY29sb3JTcGFjZSA9IGNvbG9yU3BhY2UgfHwgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYjsKICAgICAgICBzbWFzay5iYWNrZHJvcCA9IGNvbG9yU3BhY2UuZ2V0UmdiKHNtYXNrLmJhY2tkcm9wLCAwKTsKICAgICAgfQoKICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbkdyb3VwLCBbZ3JvdXBPcHRpb25zXSk7CiAgICB9CgogICAgY29uc3QgYXJncyA9IGdyb3VwID8gW21hdHJpeCwgbnVsbF0gOiBbbWF0cml4LCBiYm94XTsKICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucGFpbnRGb3JtWE9iamVjdEJlZ2luLCBhcmdzKTsKICAgIHJldHVybiB0aGlzLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgIHN0cmVhbTogeG9iaiwKICAgICAgdGFzaywKICAgICAgcmVzb3VyY2VzOiBkaWN0LmdldCgiUmVzb3VyY2VzIikgfHwgcmVzb3VyY2VzLAogICAgICBvcGVyYXRvckxpc3QsCiAgICAgIGluaXRpYWxTdGF0ZQogICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucGFpbnRGb3JtWE9iamVjdEVuZCwgW10pOwoKICAgICAgaWYgKGdyb3VwKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5lbmRHcm91cCwgW2dyb3VwT3B0aW9uc10pOwogICAgICB9CgogICAgICBpZiAob3B0aW9uYWxDb250ZW50ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsIFtdKTsKICAgICAgfQogICAgfSk7CiAgfQoKICBfc2VuZEltZ0RhdGEob2JqSWQsIGltZ0RhdGEsIGNhY2hlR2xvYmFsbHkgPSBmYWxzZSkgewogICAgY29uc3QgdHJhbnNmZXJzID0gaW1nRGF0YSA/IFtpbWdEYXRhLmJpdG1hcCB8fCBpbWdEYXRhLmRhdGEuYnVmZmVyXSA6IG51bGw7CgogICAgaWYgKHRoaXMucGFyc2luZ1R5cGUzRm9udCB8fCBjYWNoZUdsb2JhbGx5KSB7CiAgICAgIHJldHVybiB0aGlzLmhhbmRsZXIuc2VuZCgiY29tbW9ub2JqIiwgW29iaklkLCAiSW1hZ2UiLCBpbWdEYXRhXSwgdHJhbnNmZXJzKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5oYW5kbGVyLnNlbmQoIm9iaiIsIFtvYmpJZCwgdGhpcy5wYWdlSW5kZXgsICJJbWFnZSIsIGltZ0RhdGFdLCB0cmFuc2ZlcnMpOwogIH0KCiAgYXN5bmMgYnVpbGRQYWludEltYWdlWE9iamVjdCh7CiAgICByZXNvdXJjZXMsCiAgICBpbWFnZSwKICAgIGlzSW5saW5lID0gZmFsc2UsCiAgICBvcGVyYXRvckxpc3QsCiAgICBjYWNoZUtleSwKICAgIGxvY2FsSW1hZ2VDYWNoZSwKICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgfSkgewogICAgY29uc3QgZGljdCA9IGltYWdlLmRpY3Q7CiAgICBjb25zdCBpbWFnZVJlZiA9IGRpY3Qub2JqSWQ7CiAgICBjb25zdCB3ID0gZGljdC5nZXQoIlciLCAiV2lkdGgiKTsKICAgIGNvbnN0IGggPSBkaWN0LmdldCgiSCIsICJIZWlnaHQiKTsKCiAgICBpZiAoISh3ICYmIHR5cGVvZiB3ID09PSAibnVtYmVyIikgfHwgIShoICYmIHR5cGVvZiBoID09PSAibnVtYmVyIikpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbWFnZSBkaW1lbnNpb25zIGFyZSBtaXNzaW5nLCBvciBub3QgbnVtYmVycy4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG1heEltYWdlU2l6ZSA9IHRoaXMub3B0aW9ucy5tYXhJbWFnZVNpemU7CgogICAgaWYgKG1heEltYWdlU2l6ZSAhPT0gLTEgJiYgdyAqIGggPiBtYXhJbWFnZVNpemUpIHsKICAgICAgY29uc3QgbXNnID0gIkltYWdlIGV4Y2VlZGVkIG1heGltdW0gYWxsb3dlZCBzaXplIGFuZCB3YXMgcmVtb3ZlZC4iOwoKICAgICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikobXNnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpOwogICAgfQoKICAgIGxldCBvcHRpb25hbENvbnRlbnQ7CgogICAgaWYgKGRpY3QuaGFzKCJPQyIpKSB7CiAgICAgIG9wdGlvbmFsQ29udGVudCA9IGF3YWl0IHRoaXMucGFyc2VNYXJrZWRDb250ZW50UHJvcHMoZGljdC5nZXQoIk9DIiksIHJlc291cmNlcyk7CiAgICB9CgogICAgY29uc3QgaW1hZ2VNYXNrID0gZGljdC5nZXQoIklNIiwgIkltYWdlTWFzayIpIHx8IGZhbHNlOwogICAgbGV0IGltZ0RhdGEsIGFyZ3M7CgogICAgaWYgKGltYWdlTWFzaykgewogICAgICBjb25zdCBpbnRlcnBvbGF0ZSA9IGRpY3QuZ2V0KCJJIiwgIkludGVycG9sYXRlIik7CiAgICAgIGNvbnN0IGJpdFN0cmlkZUxlbmd0aCA9IHcgKyA3ID4+IDM7CiAgICAgIGNvbnN0IGltZ0FycmF5ID0gaW1hZ2UuZ2V0Qnl0ZXMoYml0U3RyaWRlTGVuZ3RoICogaCk7CiAgICAgIGNvbnN0IGRlY29kZSA9IGRpY3QuZ2V0QXJyYXkoIkQiLCAiRGVjb2RlIik7CgogICAgICBpZiAodGhpcy5wYXJzaW5nVHlwZTNGb250KSB7CiAgICAgICAgaW1nRGF0YSA9IF9pbWFnZS5QREZJbWFnZS5jcmVhdGVSYXdNYXNrKHsKICAgICAgICAgIGltZ0FycmF5LAogICAgICAgICAgd2lkdGg6IHcsCiAgICAgICAgICBoZWlnaHQ6IGgsCiAgICAgICAgICBpbWFnZUlzRnJvbURlY29kZVN0cmVhbTogaW1hZ2UgaW5zdGFuY2VvZiBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0sCiAgICAgICAgICBpbnZlcnNlRGVjb2RlOiAhIWRlY29kZSAmJiBkZWNvZGVbMF0gPiAwLAogICAgICAgICAgaW50ZXJwb2xhdGUKICAgICAgICB9KTsKICAgICAgICBpbWdEYXRhLmNhY2hlZCA9ICEhY2FjaGVLZXk7CiAgICAgICAgYXJncyA9IFtpbWdEYXRhXTsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMoX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdCwgYXJncywgb3B0aW9uYWxDb250ZW50KTsKCiAgICAgICAgaWYgKGNhY2hlS2V5KSB7CiAgICAgICAgICBsb2NhbEltYWdlQ2FjaGUuc2V0KGNhY2hlS2V5LCBpbWFnZVJlZiwgewogICAgICAgICAgICBmbjogX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdCwKICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgb3B0aW9uYWxDb250ZW50CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaW1nRGF0YSA9IF9pbWFnZS5QREZJbWFnZS5jcmVhdGVNYXNrKHsKICAgICAgICBpbWdBcnJheSwKICAgICAgICB3aWR0aDogdywKICAgICAgICBoZWlnaHQ6IGgsCiAgICAgICAgaW1hZ2VJc0Zyb21EZWNvZGVTdHJlYW06IGltYWdlIGluc3RhbmNlb2YgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtLAogICAgICAgIGludmVyc2VEZWNvZGU6ICEhZGVjb2RlICYmIGRlY29kZVswXSA+IDAsCiAgICAgICAgaW50ZXJwb2xhdGUKICAgICAgfSk7CgogICAgICBpZiAoaW1nRGF0YS5pc1NpbmdsZU9wYXF1ZVBpeGVsKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZEltYWdlT3BzKF91dGlsLk9QUy5wYWludFNvbGlkQ29sb3JJbWFnZU1hc2ssIFtdLCBvcHRpb25hbENvbnRlbnQpOwoKICAgICAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgICAgIGxvY2FsSW1hZ2VDYWNoZS5zZXQoY2FjaGVLZXksIGltYWdlUmVmLCB7CiAgICAgICAgICAgIGZuOiBfdXRpbC5PUFMucGFpbnRTb2xpZENvbG9ySW1hZ2VNYXNrLAogICAgICAgICAgICBhcmdzOiBbXSwKICAgICAgICAgICAgb3B0aW9uYWxDb250ZW50CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgb2JqSWQgPSBgbWFza18ke3RoaXMuaWRGYWN0b3J5LmNyZWF0ZU9iaklkKCl9YDsKICAgICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY3kob2JqSWQpOwoKICAgICAgdGhpcy5fc2VuZEltZ0RhdGEob2JqSWQsIGltZ0RhdGEpOwoKICAgICAgYXJncyA9IFt7CiAgICAgICAgZGF0YTogb2JqSWQsCiAgICAgICAgd2lkdGg6IGltZ0RhdGEud2lkdGgsCiAgICAgICAgaGVpZ2h0OiBpbWdEYXRhLmhlaWdodCwKICAgICAgICBpbnRlcnBvbGF0ZTogaW1nRGF0YS5pbnRlcnBvbGF0ZSwKICAgICAgICBjb3VudDogMQogICAgICB9XTsKICAgICAgb3BlcmF0b3JMaXN0LmFkZEltYWdlT3BzKF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QsIGFyZ3MsIG9wdGlvbmFsQ29udGVudCk7CgogICAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgICBsb2NhbEltYWdlQ2FjaGUuc2V0KGNhY2hlS2V5LCBpbWFnZVJlZiwgewogICAgICAgICAgZm46IF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QsCiAgICAgICAgICBhcmdzLAogICAgICAgICAgb3B0aW9uYWxDb250ZW50CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzb2Z0TWFzayA9IGRpY3QuZ2V0KCJTTSIsICJTTWFzayIpIHx8IGZhbHNlOwogICAgY29uc3QgbWFzayA9IGRpY3QuZ2V0KCJNYXNrIikgfHwgZmFsc2U7CiAgICBjb25zdCBTTUFMTF9JTUFHRV9ESU1FTlNJT05TID0gMjAwOwoKICAgIGlmIChpc0lubGluZSAmJiAhc29mdE1hc2sgJiYgIW1hc2sgJiYgdyArIGggPCBTTUFMTF9JTUFHRV9ESU1FTlNJT05TKSB7CiAgICAgIGNvbnN0IGltYWdlT2JqID0gbmV3IF9pbWFnZS5QREZJbWFnZSh7CiAgICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICAgIHJlczogcmVzb3VyY2VzLAogICAgICAgIGltYWdlLAogICAgICAgIGlzSW5saW5lLAogICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogdGhpcy5fcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgIH0pOwogICAgICBpbWdEYXRhID0gaW1hZ2VPYmouY3JlYXRlSW1hZ2VEYXRhKHRydWUpOwogICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMoX3V0aWwuT1BTLnBhaW50SW5saW5lSW1hZ2VYT2JqZWN0LCBbaW1nRGF0YV0sIG9wdGlvbmFsQ29udGVudCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgb2JqSWQgPSBgaW1nXyR7dGhpcy5pZEZhY3RvcnkuY3JlYXRlT2JqSWQoKX1gLAogICAgICAgIGNhY2hlR2xvYmFsbHkgPSBmYWxzZTsKCiAgICBpZiAodGhpcy5wYXJzaW5nVHlwZTNGb250KSB7CiAgICAgIG9iaklkID0gYCR7dGhpcy5pZEZhY3RvcnkuZ2V0RG9jSWQoKX1fdHlwZTNfJHtvYmpJZH1gOwogICAgfSBlbHNlIGlmIChpbWFnZVJlZikgewogICAgICBjYWNoZUdsb2JhbGx5ID0gdGhpcy5nbG9iYWxJbWFnZUNhY2hlLnNob3VsZENhY2hlKGltYWdlUmVmLCB0aGlzLnBhZ2VJbmRleCk7CgogICAgICBpZiAoY2FjaGVHbG9iYWxseSkgewogICAgICAgIG9iaklkID0gYCR7dGhpcy5pZEZhY3RvcnkuZ2V0RG9jSWQoKX1fJHtvYmpJZH1gOwogICAgICB9CiAgICB9CgogICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY3kob2JqSWQpOwogICAgYXJncyA9IFtvYmpJZCwgdywgaF07CgogICAgX2ltYWdlLlBERkltYWdlLmJ1aWxkSW1hZ2UoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIHJlczogcmVzb3VyY2VzLAogICAgICBpbWFnZSwKICAgICAgaXNJbmxpbmUsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogdGhpcy5fcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgfSkudGhlbihpbWFnZU9iaiA9PiB7CiAgICAgIGltZ0RhdGEgPSBpbWFnZU9iai5jcmVhdGVJbWFnZURhdGEoZmFsc2UpOwoKICAgICAgaWYgKGNhY2hlS2V5ICYmIGltYWdlUmVmICYmIGNhY2hlR2xvYmFsbHkpIHsKICAgICAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUuYWRkQnl0ZVNpemUoaW1hZ2VSZWYsIGltZ0RhdGEuZGF0YS5sZW5ndGgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fc2VuZEltZ0RhdGEob2JqSWQsIGltZ0RhdGEsIGNhY2hlR2xvYmFsbHkpOwogICAgfSkuY2F0Y2gocmVhc29uID0+IHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBVbmFibGUgdG8gZGVjb2RlIGltYWdlICIke29iaklkfSI6ICIke3JlYXNvbn0iLmApOwogICAgICByZXR1cm4gdGhpcy5fc2VuZEltZ0RhdGEob2JqSWQsIG51bGwsIGNhY2hlR2xvYmFsbHkpOwogICAgfSk7CgogICAgb3BlcmF0b3JMaXN0LmFkZEltYWdlT3BzKF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdCwgYXJncywgb3B0aW9uYWxDb250ZW50KTsKCiAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgbG9jYWxJbWFnZUNhY2hlLnNldChjYWNoZUtleSwgaW1hZ2VSZWYsIHsKICAgICAgICBmbjogX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0LAogICAgICAgIGFyZ3MsCiAgICAgICAgb3B0aW9uYWxDb250ZW50CiAgICAgIH0pOwoKICAgICAgaWYgKGltYWdlUmVmKSB7CiAgICAgICAgKDAsIF91dGlsLmFzc2VydCkoIWlzSW5saW5lLCAiQ2Fubm90IGNhY2hlIGFuIGlubGluZSBpbWFnZSBnbG9iYWxseS4iKTsKICAgICAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUuYWRkUGFnZUluZGV4KGltYWdlUmVmLCB0aGlzLnBhZ2VJbmRleCk7CgogICAgICAgIGlmIChjYWNoZUdsb2JhbGx5KSB7CiAgICAgICAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUuc2V0RGF0YShpbWFnZVJlZiwgewogICAgICAgICAgICBvYmpJZCwKICAgICAgICAgICAgZm46IF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdCwKICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgb3B0aW9uYWxDb250ZW50LAogICAgICAgICAgICBieXRlU2l6ZTogMAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBoYW5kbGVTTWFzayhzbWFzaywgcmVzb3VyY2VzLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlciwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpIHsKICAgIGNvbnN0IHNtYXNrQ29udGVudCA9IHNtYXNrLmdldCgiRyIpOwogICAgY29uc3Qgc21hc2tPcHRpb25zID0gewogICAgICBzdWJ0eXBlOiBzbWFzay5nZXQoIlMiKS5uYW1lLAogICAgICBiYWNrZHJvcDogc21hc2suZ2V0KCJCQyIpCiAgICB9OwogICAgY29uc3QgdHJhbnNmZXJPYmogPSBzbWFzay5nZXQoIlRSIik7CgogICAgaWYgKCgwLCBfZnVuY3Rpb24uaXNQREZGdW5jdGlvbikodHJhbnNmZXJPYmopKSB7CiAgICAgIGNvbnN0IHRyYW5zZmVyRm4gPSB0aGlzLl9wZGZGdW5jdGlvbkZhY3RvcnkuY3JlYXRlKHRyYW5zZmVyT2JqKTsKCiAgICAgIGNvbnN0IHRyYW5zZmVyTWFwID0gbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgICAgY29uc3QgdG1wID0gbmV3IEZsb2F0MzJBcnJheSgxKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKICAgICAgICB0bXBbMF0gPSBpIC8gMjU1OwogICAgICAgIHRyYW5zZmVyRm4odG1wLCAwLCB0bXAsIDApOwogICAgICAgIHRyYW5zZmVyTWFwW2ldID0gdG1wWzBdICogMjU1IHwgMDsKICAgICAgfQoKICAgICAgc21hc2tPcHRpb25zLnRyYW5zZmVyTWFwID0gdHJhbnNmZXJNYXA7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnVpbGRGb3JtWE9iamVjdChyZXNvdXJjZXMsIHNtYXNrQ29udGVudCwgc21hc2tPcHRpb25zLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlci5zdGF0ZS5jbG9uZSgpLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CiAgfQoKICBoYW5kbGVUcmFuc2ZlckZ1bmN0aW9uKHRyKSB7CiAgICBsZXQgdHJhbnNmZXJBcnJheTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheSh0cikpIHsKICAgICAgdHJhbnNmZXJBcnJheSA9IHRyOwogICAgfSBlbHNlIGlmICgoMCwgX2Z1bmN0aW9uLmlzUERGRnVuY3Rpb24pKHRyKSkgewogICAgICB0cmFuc2ZlckFycmF5ID0gW3RyXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHRyYW5zZmVyTWFwcyA9IFtdOwogICAgbGV0IG51bUZucyA9IDAsCiAgICAgICAgbnVtRWZmZWN0ZnVsRm5zID0gMDsKCiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIHRyYW5zZmVyQXJyYXkpIHsKICAgICAgY29uc3QgdHJhbnNmZXJPYmogPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihlbnRyeSk7CiAgICAgIG51bUZucysrOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHRyYW5zZmVyT2JqLCAiSWRlbnRpdHkiKSkgewogICAgICAgIHRyYW5zZmVyTWFwcy5wdXNoKG51bGwpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9IGVsc2UgaWYgKCEoMCwgX2Z1bmN0aW9uLmlzUERGRnVuY3Rpb24pKHRyYW5zZmVyT2JqKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCB0cmFuc2ZlckZuID0gdGhpcy5fcGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZSh0cmFuc2Zlck9iaik7CgogICAgICBjb25zdCB0cmFuc2Zlck1hcCA9IG5ldyBVaW50OEFycmF5KDI1NiksCiAgICAgICAgICAgIHRtcCA9IG5ldyBGbG9hdDMyQXJyYXkoMSk7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDI1NjsgaisrKSB7CiAgICAgICAgdG1wWzBdID0gaiAvIDI1NTsKICAgICAgICB0cmFuc2ZlckZuKHRtcCwgMCwgdG1wLCAwKTsKICAgICAgICB0cmFuc2Zlck1hcFtqXSA9IHRtcFswXSAqIDI1NSB8IDA7CiAgICAgIH0KCiAgICAgIHRyYW5zZmVyTWFwcy5wdXNoKHRyYW5zZmVyTWFwKTsKICAgICAgbnVtRWZmZWN0ZnVsRm5zKys7CiAgICB9CgogICAgaWYgKCEobnVtRm5zID09PSAxIHx8IG51bUZucyA9PT0gNCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKG51bUVmZmVjdGZ1bEZucyA9PT0gMCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gdHJhbnNmZXJNYXBzOwogIH0KCiAgaGFuZGxlVGlsaW5nVHlwZShmbiwgY29sb3IsIHJlc291cmNlcywgcGF0dGVybiwgcGF0dGVybkRpY3QsIG9wZXJhdG9yTGlzdCwgdGFzaywgbG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUpIHsKICAgIGNvbnN0IHRpbGluZ09wTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKCiAgICBjb25zdCBwYXR0ZXJuUmVzb3VyY2VzID0gX3ByaW1pdGl2ZXMuRGljdC5tZXJnZSh7CiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgZGljdEFycmF5OiBbcGF0dGVybkRpY3QuZ2V0KCJSZXNvdXJjZXMiKSwgcmVzb3VyY2VzXQogICAgfSk7CgogICAgcmV0dXJuIHRoaXMuZ2V0T3BlcmF0b3JMaXN0KHsKICAgICAgc3RyZWFtOiBwYXR0ZXJuLAogICAgICB0YXNrLAogICAgICByZXNvdXJjZXM6IHBhdHRlcm5SZXNvdXJjZXMsCiAgICAgIG9wZXJhdG9yTGlzdDogdGlsaW5nT3BMaXN0CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3Qgb3BlcmF0b3JMaXN0SVIgPSB0aWxpbmdPcExpc3QuZ2V0SVIoKTsKICAgICAgY29uc3QgdGlsaW5nUGF0dGVybklSID0gKDAsIF9wYXR0ZXJuLmdldFRpbGluZ1BhdHRlcm5JUikob3BlcmF0b3JMaXN0SVIsIHBhdHRlcm5EaWN0LCBjb2xvcik7CiAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmNpZXModGlsaW5nT3BMaXN0LmRlcGVuZGVuY2llcyk7CiAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChmbiwgdGlsaW5nUGF0dGVybklSKTsKCiAgICAgIGlmIChwYXR0ZXJuRGljdC5vYmpJZCkgewogICAgICAgIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLnNldChudWxsLCBwYXR0ZXJuRGljdC5vYmpJZCwgewogICAgICAgICAgb3BlcmF0b3JMaXN0SVIsCiAgICAgICAgICBkaWN0OiBwYXR0ZXJuRGljdAogICAgICAgIH0pOwogICAgICB9CiAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgdGhpcy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JUaWxpbmdQYXR0ZXJuCiAgICAgICAgfSk7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBoYW5kbGVUaWxpbmdUeXBlIC0gaWdub3JpbmcgcGF0dGVybjogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aHJvdyByZWFzb247CiAgICB9KTsKICB9CgogIGhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBmb250QXJncywgZm9udFJlZiwgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZSwgZmFsbGJhY2tGb250RGljdCA9IG51bGwsIGNzc0ZvbnRJbmZvID0gbnVsbCkgewogICAgY29uc3QgZm9udE5hbWUgPSBmb250QXJncyAmJiBmb250QXJnc1swXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUgPyBmb250QXJnc1swXS5uYW1lIDogbnVsbDsKICAgIHJldHVybiB0aGlzLmxvYWRGb250KGZvbnROYW1lLCBmb250UmVmLCByZXNvdXJjZXMsIGZhbGxiYWNrRm9udERpY3QsIGNzc0ZvbnRJbmZvKS50aGVuKHRyYW5zbGF0ZWQgPT4gewogICAgICBpZiAoIXRyYW5zbGF0ZWQuZm9udC5pc1R5cGUzRm9udCkgewogICAgICAgIHJldHVybiB0cmFuc2xhdGVkOwogICAgICB9CgogICAgICByZXR1cm4gdHJhbnNsYXRlZC5sb2FkVHlwZTNEYXRhKHRoaXMsIHJlc291cmNlcywgdGFzaykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY2llcyh0cmFuc2xhdGVkLnR5cGUzRGVwZW5kZW5jaWVzKTsKICAgICAgICByZXR1cm4gdHJhbnNsYXRlZDsKICAgICAgfSkuY2F0Y2gocmVhc29uID0+IHsKICAgICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckZvbnRMb2FkVHlwZTMKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0ZWRGb250KHsKICAgICAgICAgIGxvYWRlZE5hbWU6ICJnX2ZvbnRfZXJyb3IiLAogICAgICAgICAgZm9udDogbmV3IF9mb250cy5FcnJvckZvbnQoYFR5cGUzIGZvbnQgbG9hZCBlcnJvcjogJHtyZWFzb259YCksCiAgICAgICAgICBkaWN0OiB0cmFuc2xhdGVkLmZvbnQsCiAgICAgICAgICBldmFsdWF0b3JPcHRpb25zOiB0aGlzLm9wdGlvbnMKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KS50aGVuKHRyYW5zbGF0ZWQgPT4gewogICAgICBzdGF0ZS5mb250ID0gdHJhbnNsYXRlZC5mb250OwogICAgICB0cmFuc2xhdGVkLnNlbmQodGhpcy5oYW5kbGVyKTsKICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQubG9hZGVkTmFtZTsKICAgIH0pOwogIH0KCiAgaGFuZGxlVGV4dChjaGFycywgc3RhdGUpIHsKICAgIGNvbnN0IGZvbnQgPSBzdGF0ZS5mb250OwogICAgY29uc3QgZ2x5cGhzID0gZm9udC5jaGFyc1RvR2x5cGhzKGNoYXJzKTsKCiAgICBpZiAoZm9udC5kYXRhKSB7CiAgICAgIGNvbnN0IGlzQWRkVG9QYXRoU2V0ID0gISEoc3RhdGUudGV4dFJlbmRlcmluZ01vZGUgJiBfdXRpbC5UZXh0UmVuZGVyaW5nTW9kZS5BRERfVE9fUEFUSF9GTEFHKTsKCiAgICAgIGlmIChpc0FkZFRvUGF0aFNldCB8fCBzdGF0ZS5maWxsQ29sb3JTcGFjZS5uYW1lID09PSAiUGF0dGVybiIgfHwgZm9udC5kaXNhYmxlRm9udEZhY2UgfHwgdGhpcy5vcHRpb25zLmRpc2FibGVGb250RmFjZSkgewogICAgICAgIFBhcnRpYWxFdmFsdWF0b3IuYnVpbGRGb250UGF0aHMoZm9udCwgZ2x5cGhzLCB0aGlzLmhhbmRsZXIsIHRoaXMub3B0aW9ucyk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZ2x5cGhzOwogIH0KCiAgZW5zdXJlU3RhdGVGb250KHN0YXRlKSB7CiAgICBpZiAoc3RhdGUuZm9udCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcmVhc29uID0gbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNaXNzaW5nIHNldEZvbnQgKFRmKSBvcGVyYXRvciBiZWZvcmUgdGV4dCByZW5kZXJpbmcgb3BlcmF0b3IuIik7CgogICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgdGhpcy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yRm9udFN0YXRlCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoYGVuc3VyZVN0YXRlRm9udDogIiR7cmVhc29ufSIuYCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aHJvdyByZWFzb247CiAgfQoKICBhc3luYyBzZXRHU3RhdGUoewogICAgcmVzb3VyY2VzLAogICAgZ1N0YXRlLAogICAgb3BlcmF0b3JMaXN0LAogICAgY2FjaGVLZXksCiAgICB0YXNrLAogICAgc3RhdGVNYW5hZ2VyLAogICAgbG9jYWxHU3RhdGVDYWNoZSwKICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgfSkgewogICAgY29uc3QgZ1N0YXRlUmVmID0gZ1N0YXRlLm9iaklkOwogICAgbGV0IGlzU2ltcGxlR1N0YXRlID0gdHJ1ZTsKICAgIGNvbnN0IGdTdGF0ZU9iaiA9IFtdOwogICAgY29uc3QgZ1N0YXRlS2V5cyA9IGdTdGF0ZS5nZXRLZXlzKCk7CiAgICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGdTdGF0ZUtleXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBrZXkgPSBnU3RhdGVLZXlzW2ldOwogICAgICBjb25zdCB2YWx1ZSA9IGdTdGF0ZS5nZXQoa2V5KTsKCiAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgY2FzZSAiVHlwZSI6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiTFciOgogICAgICAgIGNhc2UgIkxDIjoKICAgICAgICBjYXNlICJMSiI6CiAgICAgICAgY2FzZSAiTUwiOgogICAgICAgIGNhc2UgIkQiOgogICAgICAgIGNhc2UgIlJJIjoKICAgICAgICBjYXNlICJGTCI6CiAgICAgICAgY2FzZSAiQ0EiOgogICAgICAgIGNhc2UgImNhIjoKICAgICAgICAgIGdTdGF0ZU9iai5wdXNoKFtrZXksIHZhbHVlXSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRm9udCI6CiAgICAgICAgICBpc1NpbXBsZUdTdGF0ZSA9IGZhbHNlOwogICAgICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBudWxsLCB2YWx1ZVswXSwgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIuc3RhdGUpLnRoZW4oZnVuY3Rpb24gKGxvYWRlZE5hbWUpIHsKICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShsb2FkZWROYW1lKTsKICAgICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCBbbG9hZGVkTmFtZSwgdmFsdWVbMV1dXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQk0iOgogICAgICAgICAgZ1N0YXRlT2JqLnB1c2goW2tleSwgbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlKV0pOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlNNYXNrIjoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh2YWx1ZSwgIk5vbmUiKSkgewogICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCBmYWxzZV0pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgIGlzU2ltcGxlR1N0YXRlID0gZmFsc2U7CiAgICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVNNYXNrKHZhbHVlLCByZXNvdXJjZXMsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCB0cnVlXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIFNNYXNrIHR5cGUiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiVFIiOgogICAgICAgICAgY29uc3QgdHJhbnNmZXJNYXBzID0gdGhpcy5oYW5kbGVUcmFuc2ZlckZ1bmN0aW9uKHZhbHVlKTsKICAgICAgICAgIGdTdGF0ZU9iai5wdXNoKFtrZXksIHRyYW5zZmVyTWFwc10pOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIk9QIjoKICAgICAgICBjYXNlICJvcCI6CiAgICAgICAgY2FzZSAiT1BNIjoKICAgICAgICBjYXNlICJCRyI6CiAgICAgICAgY2FzZSAiQkcyIjoKICAgICAgICBjYXNlICJVQ1IiOgogICAgICAgIGNhc2UgIlVDUjIiOgogICAgICAgIGNhc2UgIlRSMiI6CiAgICAgICAgY2FzZSAiSFQiOgogICAgICAgIGNhc2UgIlNNIjoKICAgICAgICBjYXNlICJTQSI6CiAgICAgICAgY2FzZSAiQUlTIjoKICAgICAgICBjYXNlICJUSyI6CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoImdyYXBoaWMgc3RhdGUgb3BlcmF0b3IgIiArIGtleSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVW5rbm93biBncmFwaGljIHN0YXRlIG9wZXJhdG9yICIgKyBrZXkpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGdTdGF0ZU9iai5sZW5ndGggPiAwKSB7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5zZXRHU3RhdGUsIFtnU3RhdGVPYmpdKTsKICAgICAgfQoKICAgICAgaWYgKGlzU2ltcGxlR1N0YXRlKSB7CiAgICAgICAgbG9jYWxHU3RhdGVDYWNoZS5zZXQoY2FjaGVLZXksIGdTdGF0ZVJlZiwgZ1N0YXRlT2JqKTsKICAgICAgfQogICAgfSk7CiAgfQoKICBsb2FkRm9udChmb250TmFtZSwgZm9udCwgcmVzb3VyY2VzLCBmYWxsYmFja0ZvbnREaWN0ID0gbnVsbCwgY3NzRm9udEluZm8gPSBudWxsKSB7CiAgICBjb25zdCBlcnJvckZvbnQgPSBhc3luYyAoKSA9PiB7CiAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRlZEZvbnQoewogICAgICAgIGxvYWRlZE5hbWU6ICJnX2ZvbnRfZXJyb3IiLAogICAgICAgIGZvbnQ6IG5ldyBfZm9udHMuRXJyb3JGb250KGBGb250ICIke2ZvbnROYW1lfSIgaXMgbm90IGF2YWlsYWJsZS5gKSwKICAgICAgICBkaWN0OiBmb250LAogICAgICAgIGV2YWx1YXRvck9wdGlvbnM6IHRoaXMub3B0aW9ucwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZjsKICAgIGxldCBmb250UmVmOwoKICAgIGlmIChmb250KSB7CiAgICAgIGlmIChmb250IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgZm9udFJlZiA9IGZvbnQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGZvbnRSZXMgPSByZXNvdXJjZXMuZ2V0KCJGb250Iik7CgogICAgICBpZiAoZm9udFJlcykgewogICAgICAgIGZvbnRSZWYgPSBmb250UmVzLmdldFJhdyhmb250TmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWZvbnRSZWYpIHsKICAgICAgY29uc3QgcGFydGlhbE1zZyA9IGBGb250ICIke2ZvbnROYW1lIHx8IGZvbnQgJiYgZm9udC50b1N0cmluZygpfSIgaXMgbm90IGF2YWlsYWJsZWA7CgogICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMgJiYgIXRoaXMucGFyc2luZ1R5cGUzRm9udCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgJHtwYXJ0aWFsTXNnfS5gKTsKICAgICAgICByZXR1cm4gZXJyb3JGb250KCk7CiAgICAgIH0KCiAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckZvbnRNaXNzaW5nCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoYCR7cGFydGlhbE1zZ30gLS0gYXR0ZW1wdGluZyB0byBmYWxsYmFjayB0byBhIGRlZmF1bHQgZm9udC5gKTsKCiAgICAgIGlmIChmYWxsYmFja0ZvbnREaWN0KSB7CiAgICAgICAgZm9udFJlZiA9IGZhbGxiYWNrRm9udERpY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9udFJlZiA9IFBhcnRpYWxFdmFsdWF0b3IuZmFsbGJhY2tGb250RGljdDsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLnBhcnNpbmdUeXBlM0ZvbnQgJiYgdGhpcy50eXBlM0ZvbnRSZWZzLmhhcyhmb250UmVmKSkgewogICAgICByZXR1cm4gZXJyb3JGb250KCk7CiAgICB9CgogICAgaWYgKHRoaXMuZm9udENhY2hlLmhhcyhmb250UmVmKSkgewogICAgICByZXR1cm4gdGhpcy5mb250Q2FjaGUuZ2V0KGZvbnRSZWYpOwogICAgfQoKICAgIGZvbnQgPSB4cmVmLmZldGNoSWZSZWYoZm9udFJlZik7CgogICAgaWYgKCEoZm9udCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBlcnJvckZvbnQoKTsKICAgIH0KCiAgICBpZiAoZm9udC5jYWNoZUtleSAmJiB0aGlzLmZvbnRDYWNoZS5oYXMoZm9udC5jYWNoZUtleSkpIHsKICAgICAgcmV0dXJuIHRoaXMuZm9udENhY2hlLmdldChmb250LmNhY2hlS2V5KTsKICAgIH0KCiAgICBjb25zdCBmb250Q2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgIGxldCBwcmVFdmFsdWF0ZWRGb250OwoKICAgIHRyeSB7CiAgICAgIHByZUV2YWx1YXRlZEZvbnQgPSB0aGlzLnByZUV2YWx1YXRlRm9udChmb250KTsKICAgICAgcHJlRXZhbHVhdGVkRm9udC5jc3NGb250SW5mbyA9IGNzc0ZvbnRJbmZvOwogICAgfSBjYXRjaCAocmVhc29uKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgbG9hZEZvbnQgLSBwcmVFdmFsdWF0ZUZvbnQgZmFpbGVkOiAiJHtyZWFzb259Ii5gKTsKICAgICAgcmV0dXJuIGVycm9yRm9udCgpOwogICAgfQoKICAgIGNvbnN0IHsKICAgICAgZGVzY3JpcHRvciwKICAgICAgaGFzaAogICAgfSA9IHByZUV2YWx1YXRlZEZvbnQ7CiAgICBjb25zdCBmb250UmVmSXNSZWYgPSBmb250UmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmOwogICAgbGV0IGZvbnRJRDsKCiAgICBpZiAoZm9udFJlZklzUmVmKSB7CiAgICAgIGZvbnRJRCA9IGBmJHtmb250UmVmLnRvU3RyaW5nKCl9YDsKICAgIH0KCiAgICBpZiAoaGFzaCAmJiBkZXNjcmlwdG9yIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBpZiAoIWRlc2NyaXB0b3IuZm9udEFsaWFzZXMpIHsKICAgICAgICBkZXNjcmlwdG9yLmZvbnRBbGlhc2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgfQoKICAgICAgY29uc3QgZm9udEFsaWFzZXMgPSBkZXNjcmlwdG9yLmZvbnRBbGlhc2VzOwoKICAgICAgaWYgKGZvbnRBbGlhc2VzW2hhc2hdKSB7CiAgICAgICAgY29uc3QgYWxpYXNGb250UmVmID0gZm9udEFsaWFzZXNbaGFzaF0uYWxpYXNSZWY7CgogICAgICAgIGlmIChmb250UmVmSXNSZWYgJiYgYWxpYXNGb250UmVmICYmIHRoaXMuZm9udENhY2hlLmhhcyhhbGlhc0ZvbnRSZWYpKSB7CiAgICAgICAgICB0aGlzLmZvbnRDYWNoZS5wdXRBbGlhcyhmb250UmVmLCBhbGlhc0ZvbnRSZWYpOwogICAgICAgICAgcmV0dXJuIHRoaXMuZm9udENhY2hlLmdldChmb250UmVmKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9udEFsaWFzZXNbaGFzaF0gPSB7CiAgICAgICAgICBmb250SUQ6IHRoaXMuaWRGYWN0b3J5LmNyZWF0ZUZvbnRJZCgpCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKGZvbnRSZWZJc1JlZikgewogICAgICAgIGZvbnRBbGlhc2VzW2hhc2hdLmFsaWFzUmVmID0gZm9udFJlZjsKICAgICAgfQoKICAgICAgZm9udElEID0gZm9udEFsaWFzZXNbaGFzaF0uZm9udElEOwogICAgfQoKICAgIGlmIChmb250UmVmSXNSZWYpIHsKICAgICAgdGhpcy5mb250Q2FjaGUucHV0KGZvbnRSZWYsIGZvbnRDYXBhYmlsaXR5LnByb21pc2UpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKCFmb250SUQpIHsKICAgICAgICBmb250SUQgPSB0aGlzLmlkRmFjdG9yeS5jcmVhdGVGb250SWQoKTsKICAgICAgfQoKICAgICAgZm9udC5jYWNoZUtleSA9IGBjYWNoZUtleV8ke2ZvbnRJRH1gOwogICAgICB0aGlzLmZvbnRDYWNoZS5wdXQoZm9udC5jYWNoZUtleSwgZm9udENhcGFiaWxpdHkucHJvbWlzZSk7CiAgICB9CgogICAgKDAsIF91dGlsLmFzc2VydCkoZm9udElEICYmIGZvbnRJRC5zdGFydHNXaXRoKCJmIiksICdUaGUgImZvbnRJRCIgbXVzdCBiZSAoY29ycmVjdGx5KSBkZWZpbmVkLicpOwogICAgZm9udC5sb2FkZWROYW1lID0gYCR7dGhpcy5pZEZhY3RvcnkuZ2V0RG9jSWQoKX1fJHtmb250SUR9YDsKICAgIHRoaXMudHJhbnNsYXRlRm9udChwcmVFdmFsdWF0ZWRGb250KS50aGVuKHRyYW5zbGF0ZWRGb250ID0+IHsKICAgICAgaWYgKHRyYW5zbGF0ZWRGb250LmZvbnRUeXBlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB4cmVmLnN0YXRzLmFkZEZvbnRUeXBlKHRyYW5zbGF0ZWRGb250LmZvbnRUeXBlKTsKICAgICAgfQoKICAgICAgZm9udENhcGFiaWxpdHkucmVzb2x2ZShuZXcgVHJhbnNsYXRlZEZvbnQoewogICAgICAgIGxvYWRlZE5hbWU6IGZvbnQubG9hZGVkTmFtZSwKICAgICAgICBmb250OiB0cmFuc2xhdGVkRm9udCwKICAgICAgICBkaWN0OiBmb250LAogICAgICAgIGV2YWx1YXRvck9wdGlvbnM6IHRoaXMub3B0aW9ucwogICAgICB9KSk7CiAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250VHJhbnNsYXRlCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoYGxvYWRGb250IC0gdHJhbnNsYXRlRm9udCBmYWlsZWQ6ICIke3JlYXNvbn0iLmApOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBmb250RmlsZTMgPSBkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3IuZ2V0KCJGb250RmlsZTMiKTsKICAgICAgICBjb25zdCBzdWJ0eXBlID0gZm9udEZpbGUzICYmIGZvbnRGaWxlMy5nZXQoIlN1YnR5cGUiKTsKICAgICAgICBjb25zdCBmb250VHlwZSA9ICgwLCBfZm9udHNfdXRpbHMuZ2V0Rm9udFR5cGUpKHByZUV2YWx1YXRlZEZvbnQudHlwZSwgc3VidHlwZSAmJiBzdWJ0eXBlLm5hbWUpOwoKICAgICAgICBpZiAoZm9udFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgeHJlZi5zdGF0cy5hZGRGb250VHlwZShmb250VHlwZSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChleCkge30KCiAgICAgIGZvbnRDYXBhYmlsaXR5LnJlc29sdmUobmV3IFRyYW5zbGF0ZWRGb250KHsKICAgICAgICBsb2FkZWROYW1lOiBmb250LmxvYWRlZE5hbWUsCiAgICAgICAgZm9udDogbmV3IF9mb250cy5FcnJvckZvbnQocmVhc29uIGluc3RhbmNlb2YgRXJyb3IgPyByZWFzb24ubWVzc2FnZSA6IHJlYXNvbiksCiAgICAgICAgZGljdDogZm9udCwKICAgICAgICBldmFsdWF0b3JPcHRpb25zOiB0aGlzLm9wdGlvbnMKICAgICAgfSkpOwogICAgfSk7CiAgICByZXR1cm4gZm9udENhcGFiaWxpdHkucHJvbWlzZTsKICB9CgogIGJ1aWxkUGF0aChvcGVyYXRvckxpc3QsIGZuLCBhcmdzLCBwYXJzaW5nVGV4dCA9IGZhbHNlKSB7CiAgICBjb25zdCBsYXN0SW5kZXggPSBvcGVyYXRvckxpc3QubGVuZ3RoIC0gMTsKCiAgICBpZiAoIWFyZ3MpIHsKICAgICAgYXJncyA9IFtdOwogICAgfQoKICAgIGxldCBtaW5NYXg7CgogICAgaWYgKGxhc3RJbmRleCA8IDAgfHwgb3BlcmF0b3JMaXN0LmZuQXJyYXlbbGFzdEluZGV4XSAhPT0gX3V0aWwuT1BTLmNvbnN0cnVjdFBhdGgpIHsKICAgICAgaWYgKHBhcnNpbmdUZXh0KSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBFbmNvdW50ZXJlZCBwYXRoIG9wZXJhdG9yICIke2ZufSIgaW5zaWRlIG9mIGEgdGV4dCBvYmplY3QuYCk7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5zYXZlLCBudWxsKTsKICAgICAgfQoKICAgICAgbWluTWF4ID0gW0luZmluaXR5LCAtSW5maW5pdHksIEluZmluaXR5LCAtSW5maW5pdHldOwogICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLmNvbnN0cnVjdFBhdGgsIFtbZm5dLCBhcmdzLCBtaW5NYXhdKTsKCiAgICAgIGlmIChwYXJzaW5nVGV4dCkgewogICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucmVzdG9yZSwgbnVsbCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IG9wQXJncyA9IG9wZXJhdG9yTGlzdC5hcmdzQXJyYXlbbGFzdEluZGV4XTsKICAgICAgb3BBcmdzWzBdLnB1c2goZm4pOwogICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShvcEFyZ3NbMV0sIGFyZ3MpOwogICAgICBtaW5NYXggPSBvcEFyZ3NbMl07CiAgICB9CgogICAgc3dpdGNoIChmbikgewogICAgICBjYXNlIF91dGlsLk9QUy5yZWN0YW5nbGU6CiAgICAgICAgbWluTWF4WzBdID0gTWF0aC5taW4obWluTWF4WzBdLCBhcmdzWzBdLCBhcmdzWzBdICsgYXJnc1syXSk7CiAgICAgICAgbWluTWF4WzFdID0gTWF0aC5tYXgobWluTWF4WzFdLCBhcmdzWzBdLCBhcmdzWzBdICsgYXJnc1syXSk7CiAgICAgICAgbWluTWF4WzJdID0gTWF0aC5taW4obWluTWF4WzJdLCBhcmdzWzFdLCBhcmdzWzFdICsgYXJnc1szXSk7CiAgICAgICAgbWluTWF4WzNdID0gTWF0aC5tYXgobWluTWF4WzNdLCBhcmdzWzFdLCBhcmdzWzFdICsgYXJnc1szXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIF91dGlsLk9QUy5tb3ZlVG86CiAgICAgIGNhc2UgX3V0aWwuT1BTLmxpbmVUbzoKICAgICAgICBtaW5NYXhbMF0gPSBNYXRoLm1pbihtaW5NYXhbMF0sIGFyZ3NbMF0pOwogICAgICAgIG1pbk1heFsxXSA9IE1hdGgubWF4KG1pbk1heFsxXSwgYXJnc1swXSk7CiAgICAgICAgbWluTWF4WzJdID0gTWF0aC5taW4obWluTWF4WzJdLCBhcmdzWzFdKTsKICAgICAgICBtaW5NYXhbM10gPSBNYXRoLm1heChtaW5NYXhbM10sIGFyZ3NbMV0pOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcGFyc2VDb2xvclNwYWNlKHsKICAgIGNzLAogICAgcmVzb3VyY2VzLAogICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICB9KSB7CiAgICByZXR1cm4gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5wYXJzZUFzeW5jKHsKICAgICAgY3MsCiAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgcmVzb3VyY2VzLAogICAgICBwZGZGdW5jdGlvbkZhY3Rvcnk6IHRoaXMuX3BkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0pLmNhdGNoKHJlYXNvbiA9PiB7CiAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yQ29sb3JTcGFjZQogICAgICAgIH0pOwogICAgICAgICgwLCBfdXRpbC53YXJuKShgcGFyc2VDb2xvclNwYWNlIC0gaWdub3JpbmcgQ29sb3JTcGFjZTogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHRocm93IHJlYXNvbjsKICAgIH0pOwogIH0KCiAgcGFyc2VTaGFkaW5nKHsKICAgIHNoYWRpbmcsCiAgICByZXNvdXJjZXMsCiAgICBsb2NhbENvbG9yU3BhY2VDYWNoZSwKICAgIGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZQogIH0pIHsKICAgIGxldCBpZCA9IGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZS5nZXQoc2hhZGluZyk7CgogICAgaWYgKCFpZCkgewogICAgICB2YXIgc2hhZGluZ0ZpbGwgPSBfcGF0dGVybi5QYXR0ZXJuLnBhcnNlU2hhZGluZyhzaGFkaW5nLCB0aGlzLnhyZWYsIHJlc291cmNlcywgdGhpcy5oYW5kbGVyLCB0aGlzLl9wZGZGdW5jdGlvbkZhY3RvcnksIGxvY2FsQ29sb3JTcGFjZUNhY2hlKTsKCiAgICAgIGNvbnN0IHBhdHRlcm5JUiA9IHNoYWRpbmdGaWxsLmdldElSKCk7CiAgICAgIGlkID0gYHBhdHRlcm5fJHt0aGlzLmlkRmFjdG9yeS5jcmVhdGVPYmpJZCgpfWA7CiAgICAgIGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZS5zZXQoc2hhZGluZywgaWQpOwogICAgICB0aGlzLmhhbmRsZXIuc2VuZCgib2JqIiwgW2lkLCB0aGlzLnBhZ2VJbmRleCwgIlBhdHRlcm4iLCBwYXR0ZXJuSVJdKTsKICAgIH0KCiAgICByZXR1cm4gaWQ7CiAgfQoKICBoYW5kbGVDb2xvck4ob3BlcmF0b3JMaXN0LCBmbiwgYXJncywgY3MsIHBhdHRlcm5zLCByZXNvdXJjZXMsIHRhc2ssIGxvY2FsQ29sb3JTcGFjZUNhY2hlLCBsb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSwgbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlKSB7CiAgICBjb25zdCBwYXR0ZXJuTmFtZSA9IGFyZ3MucG9wKCk7CgogICAgaWYgKHBhdHRlcm5OYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICBjb25zdCByYXdQYXR0ZXJuID0gcGF0dGVybnMuZ2V0UmF3KHBhdHRlcm5OYW1lLm5hbWUpOwogICAgICBjb25zdCBsb2NhbFRpbGluZ1BhdHRlcm4gPSByYXdQYXR0ZXJuIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmICYmIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLmdldEJ5UmVmKHJhd1BhdHRlcm4pOwoKICAgICAgaWYgKGxvY2FsVGlsaW5nUGF0dGVybikgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBjb2xvciA9IGNzLmJhc2UgPyBjcy5iYXNlLmdldFJnYihhcmdzLCAwKSA6IG51bGw7CiAgICAgICAgICBjb25zdCB0aWxpbmdQYXR0ZXJuSVIgPSAoMCwgX3BhdHRlcm4uZ2V0VGlsaW5nUGF0dGVybklSKShsb2NhbFRpbGluZ1BhdHRlcm4ub3BlcmF0b3JMaXN0SVIsIGxvY2FsVGlsaW5nUGF0dGVybi5kaWN0LCBjb2xvcik7CiAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoZm4sIHRpbGluZ1BhdHRlcm5JUik7CiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7fQogICAgICB9CgogICAgICBjb25zdCBwYXR0ZXJuID0gdGhpcy54cmVmLmZldGNoSWZSZWYocmF3UGF0dGVybik7CgogICAgICBpZiAocGF0dGVybikgewogICAgICAgIGNvbnN0IGRpY3QgPSBwYXR0ZXJuIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gPyBwYXR0ZXJuLmRpY3QgOiBwYXR0ZXJuOwogICAgICAgIGNvbnN0IHR5cGVOdW0gPSBkaWN0LmdldCgiUGF0dGVyblR5cGUiKTsKCiAgICAgICAgaWYgKHR5cGVOdW0gPT09IFBhdHRlcm5UeXBlLlRJTElORykgewogICAgICAgICAgY29uc3QgY29sb3IgPSBjcy5iYXNlID8gY3MuYmFzZS5nZXRSZ2IoYXJncywgMCkgOiBudWxsOwogICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlVGlsaW5nVHlwZShmbiwgY29sb3IsIHJlc291cmNlcywgcGF0dGVybiwgZGljdCwgb3BlcmF0b3JMaXN0LCB0YXNrLCBsb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlTnVtID09PSBQYXR0ZXJuVHlwZS5TSEFESU5HKSB7CiAgICAgICAgICBjb25zdCBzaGFkaW5nID0gZGljdC5nZXQoIlNoYWRpbmciKTsKICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IGRpY3QuZ2V0QXJyYXkoIk1hdHJpeCIpOwogICAgICAgICAgY29uc3Qgb2JqSWQgPSB0aGlzLnBhcnNlU2hhZGluZyh7CiAgICAgICAgICAgIHNoYWRpbmcsCiAgICAgICAgICAgIHJlc291cmNlcywKICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUsCiAgICAgICAgICAgIGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZQogICAgICAgICAgfSk7CiAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoZm4sIFsiU2hhZGluZyIsIG9iaklkLCBtYXRyaXhdKTsKICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVua25vd24gUGF0dGVyblR5cGU6ICR7dHlwZU51bX1gKTsKICAgICAgfQogICAgfQoKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgVW5rbm93biBQYXR0ZXJuTmFtZTogJHtwYXR0ZXJuTmFtZX1gKTsKICB9CgogIF9wYXJzZVZpc2liaWxpdHlFeHByZXNzaW9uKGFycmF5LCBuZXN0aW5nQ291bnRlciwgY3VycmVudFJlc3VsdCkgewogICAgY29uc3QgTUFYX05FU1RJTkcgPSAxMDsKCiAgICBpZiAoKytuZXN0aW5nQ291bnRlciA+IE1BWF9ORVNUSU5HKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiVmlzaWJpbGl0eSBleHByZXNzaW9uIGlzIHRvbyBkZWVwbHkgbmVzdGVkIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBsZW5ndGggPSBhcnJheS5sZW5ndGg7CiAgICBjb25zdCBvcGVyYXRvciA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGFycmF5WzBdKTsKCiAgICBpZiAobGVuZ3RoIDwgMiB8fCAhKG9wZXJhdG9yIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIHZpc2liaWxpdHkgZXhwcmVzc2lvbiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoIChvcGVyYXRvci5uYW1lKSB7CiAgICAgIGNhc2UgIkFuZCI6CiAgICAgIGNhc2UgIk9yIjoKICAgICAgY2FzZSAiTm90IjoKICAgICAgICBjdXJyZW50UmVzdWx0LnB1c2gob3BlcmF0b3IubmFtZSk7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgICgwLCBfdXRpbC53YXJuKShgSW52YWxpZCBvcGVyYXRvciAke29wZXJhdG9yLm5hbWV9IGluIHZpc2liaWxpdHkgZXhwcmVzc2lvbmApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHJhdyA9IGFycmF5W2ldOwogICAgICBjb25zdCBvYmplY3QgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihyYXcpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0KSkgewogICAgICAgIGNvbnN0IG5lc3RlZFJlc3VsdCA9IFtdOwogICAgICAgIGN1cnJlbnRSZXN1bHQucHVzaChuZXN0ZWRSZXN1bHQpOwoKICAgICAgICB0aGlzLl9wYXJzZVZpc2liaWxpdHlFeHByZXNzaW9uKG9iamVjdCwgbmVzdGluZ0NvdW50ZXIsIG5lc3RlZFJlc3VsdCk7CiAgICAgIH0gZWxzZSBpZiAocmF3IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgY3VycmVudFJlc3VsdC5wdXNoKHJhdy50b1N0cmluZygpKTsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgcGFyc2VNYXJrZWRDb250ZW50UHJvcHMoY29udGVudFByb3BlcnRpZXMsIHJlc291cmNlcykgewogICAgbGV0IG9wdGlvbmFsQ29udGVudDsKCiAgICBpZiAoY29udGVudFByb3BlcnRpZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSByZXNvdXJjZXMuZ2V0KCJQcm9wZXJ0aWVzIik7CiAgICAgIG9wdGlvbmFsQ29udGVudCA9IHByb3BlcnRpZXMuZ2V0KGNvbnRlbnRQcm9wZXJ0aWVzLm5hbWUpOwogICAgfSBlbHNlIGlmIChjb250ZW50UHJvcGVydGllcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgb3B0aW9uYWxDb250ZW50ID0gY29udGVudFByb3BlcnRpZXM7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk9wdGlvbmFsIGNvbnRlbnQgcHJvcGVydGllcyBtYWxmb3JtZWQuIik7CiAgICB9CgogICAgY29uc3Qgb3B0aW9uYWxDb250ZW50VHlwZSA9IG9wdGlvbmFsQ29udGVudC5nZXQoIlR5cGUiKS5uYW1lOwoKICAgIGlmIChvcHRpb25hbENvbnRlbnRUeXBlID09PSAiT0NHIikgewogICAgICByZXR1cm4gewogICAgICAgIHR5cGU6IG9wdGlvbmFsQ29udGVudFR5cGUsCiAgICAgICAgaWQ6IG9wdGlvbmFsQ29udGVudC5vYmpJZAogICAgICB9OwogICAgfSBlbHNlIGlmIChvcHRpb25hbENvbnRlbnRUeXBlID09PSAiT0NNRCIpIHsKICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IG9wdGlvbmFsQ29udGVudC5nZXQoIlZFIik7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShleHByZXNzaW9uKSkgewogICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdOwoKICAgICAgICB0aGlzLl9wYXJzZVZpc2liaWxpdHlFeHByZXNzaW9uKGV4cHJlc3Npb24sIDAsIHJlc3VsdCk7CgogICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdHlwZTogIk9DTUQiLAogICAgICAgICAgICBleHByZXNzaW9uOiByZXN1bHQKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCBvcHRpb25hbENvbnRlbnRHcm91cHMgPSBvcHRpb25hbENvbnRlbnQuZ2V0KCJPQ0dzIik7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25hbENvbnRlbnRHcm91cHMpIHx8IG9wdGlvbmFsQ29udGVudEdyb3VwcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBjb25zdCBncm91cElkcyA9IFtdOwoKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25hbENvbnRlbnRHcm91cHMpKSB7CiAgICAgICAgICBmb3IgKGNvbnN0IG9jZyBvZiBvcHRpb25hbENvbnRlbnRHcm91cHMpIHsKICAgICAgICAgICAgZ3JvdXBJZHMucHVzaChvY2cudG9TdHJpbmcoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGdyb3VwSWRzLnB1c2gob3B0aW9uYWxDb250ZW50R3JvdXBzLm9iaklkKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0eXBlOiBvcHRpb25hbENvbnRlbnRUeXBlLAogICAgICAgICAgaWRzOiBncm91cElkcywKICAgICAgICAgIHBvbGljeTogb3B0aW9uYWxDb250ZW50LmdldCgiUCIpIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IG9wdGlvbmFsQ29udGVudC5nZXQoIlAiKS5uYW1lIDogbnVsbCwKICAgICAgICAgIGV4cHJlc3Npb246IG51bGwKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKG9wdGlvbmFsQ29udGVudEdyb3VwcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0eXBlOiBvcHRpb25hbENvbnRlbnRUeXBlLAogICAgICAgICAgaWQ6IG9wdGlvbmFsQ29udGVudEdyb3Vwcy50b1N0cmluZygpCiAgICAgICAgfTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZ2V0T3BlcmF0b3JMaXN0KHsKICAgIHN0cmVhbSwKICAgIHRhc2ssCiAgICByZXNvdXJjZXMsCiAgICBvcGVyYXRvckxpc3QsCiAgICBpbml0aWFsU3RhdGUgPSBudWxsLAogICAgZmFsbGJhY2tGb250RGljdCA9IG51bGwKICB9KSB7CiAgICByZXNvdXJjZXMgPSByZXNvdXJjZXMgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICAgIGluaXRpYWxTdGF0ZSA9IGluaXRpYWxTdGF0ZSB8fCBuZXcgRXZhbFN0YXRlKCk7CgogICAgaWYgKCFvcGVyYXRvckxpc3QpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdnZXRPcGVyYXRvckxpc3Q6IG1pc3NpbmcgIm9wZXJhdG9yTGlzdCIgcGFyYW1ldGVyJyk7CiAgICB9CgogICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgbGV0IHBhcnNpbmdUZXh0ID0gZmFsc2U7CiAgICBjb25zdCBsb2NhbEltYWdlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsSW1hZ2VDYWNoZSgpOwogICAgY29uc3QgbG9jYWxDb2xvclNwYWNlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsQ29sb3JTcGFjZUNhY2hlKCk7CiAgICBjb25zdCBsb2NhbEdTdGF0ZUNhY2hlID0gbmV3IF9pbWFnZV91dGlscy5Mb2NhbEdTdGF0ZUNhY2hlKCk7CiAgICBjb25zdCBsb2NhbFRpbGluZ1BhdHRlcm5DYWNoZSA9IG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUoKTsKICAgIGNvbnN0IGxvY2FsU2hhZGluZ1BhdHRlcm5DYWNoZSA9IG5ldyBNYXAoKTsKCiAgICBjb25zdCB4b2JqcyA9IHJlc291cmNlcy5nZXQoIlhPYmplY3QiKSB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwoKICAgIGNvbnN0IHBhdHRlcm5zID0gcmVzb3VyY2VzLmdldCgiUGF0dGVybiIpIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CgogICAgY29uc3Qgc3RhdGVNYW5hZ2VyID0gbmV3IFN0YXRlTWFuYWdlcihpbml0aWFsU3RhdGUpOwogICAgY29uc3QgcHJlcHJvY2Vzc29yID0gbmV3IEV2YWx1YXRvclByZXByb2Nlc3NvcihzdHJlYW0sIHhyZWYsIHN0YXRlTWFuYWdlcik7CiAgICBjb25zdCB0aW1lU2xvdE1hbmFnZXIgPSBuZXcgVGltZVNsb3RNYW5hZ2VyKCk7CgogICAgZnVuY3Rpb24gY2xvc2VQZW5kaW5nUmVzdG9yZU9QUyhhcmd1bWVudCkgewogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBwcmVwcm9jZXNzb3Iuc2F2ZWRTdGF0ZXNEZXB0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnJlc3RvcmUsIFtdKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlQm9keShyZXNvbHZlLCByZWplY3QpIHsKICAgICAgY29uc3QgbmV4dCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7CiAgICAgICAgUHJvbWlzZS5hbGwoW3Byb21pc2UsIG9wZXJhdG9yTGlzdC5yZWFkeV0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcHJvbWlzZUJvZHkocmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICAgIHJlamVjdChleCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfTsKCiAgICAgIHRhc2suZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICB0aW1lU2xvdE1hbmFnZXIucmVzZXQoKTsKICAgICAgY29uc3Qgb3BlcmF0aW9uID0ge307CiAgICAgIGxldCBzdG9wLCBpLCBpaSwgY3MsIG5hbWUsIGlzVmFsaWROYW1lOwoKICAgICAgd2hpbGUgKCEoc3RvcCA9IHRpbWVTbG90TWFuYWdlci5jaGVjaygpKSkgewogICAgICAgIG9wZXJhdGlvbi5hcmdzID0gbnVsbDsKCiAgICAgICAgaWYgKCFwcmVwcm9jZXNzb3IucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGxldCBhcmdzID0gb3BlcmF0aW9uLmFyZ3M7CiAgICAgICAgbGV0IGZuID0gb3BlcmF0aW9uLmZuOwoKICAgICAgICBzd2l0Y2ggKGZuIHwgMCkgewogICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRYT2JqZWN0OgogICAgICAgICAgICBpc1ZhbGlkTmFtZSA9IGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lOwogICAgICAgICAgICBuYW1lID0gYXJnc1swXS5uYW1lOwoKICAgICAgICAgICAgaWYgKGlzVmFsaWROYW1lKSB7CiAgICAgICAgICAgICAgY29uc3QgbG9jYWxJbWFnZSA9IGxvY2FsSW1hZ2VDYWNoZS5nZXRCeU5hbWUobmFtZSk7CgogICAgICAgICAgICAgIGlmIChsb2NhbEltYWdlKSB7CiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkSW1hZ2VPcHMobG9jYWxJbWFnZS5mbiwgbG9jYWxJbWFnZS5hcmdzLCBsb2NhbEltYWdlLm9wdGlvbmFsQ29udGVudCk7CiAgICAgICAgICAgICAgICBpbmNyZW1lbnRDYWNoZWRJbWFnZU1hc2tDb3VudChsb2NhbEltYWdlKTsKICAgICAgICAgICAgICAgIGFyZ3MgPSBudWxsOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlWE9iamVjdCwgcmVqZWN0WE9iamVjdCkgewogICAgICAgICAgICAgIGlmICghaXNWYWxpZE5hbWUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBtdXN0IGJlIHJlZmVycmVkIHRvIGJ5IG5hbWUuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBsZXQgeG9iaiA9IHhvYmpzLmdldFJhdyhuYW1lKTsKCiAgICAgICAgICAgICAgaWYgKHhvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxvY2FsSW1hZ2UgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlSZWYoeG9iaik7CgogICAgICAgICAgICAgICAgaWYgKGxvY2FsSW1hZ2UpIHsKICAgICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZEltYWdlT3BzKGxvY2FsSW1hZ2UuZm4sIGxvY2FsSW1hZ2UuYXJncywgbG9jYWxJbWFnZS5vcHRpb25hbENvbnRlbnQpOwogICAgICAgICAgICAgICAgICBpbmNyZW1lbnRDYWNoZWRJbWFnZU1hc2tDb3VudChsb2NhbEltYWdlKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGdsb2JhbEltYWdlID0gc2VsZi5nbG9iYWxJbWFnZUNhY2hlLmdldERhdGEoeG9iaiwgc2VsZi5wYWdlSW5kZXgpOwoKICAgICAgICAgICAgICAgIGlmIChnbG9iYWxJbWFnZSkgewogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShnbG9iYWxJbWFnZS5vYmpJZCk7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhnbG9iYWxJbWFnZS5mbiwgZ2xvYmFsSW1hZ2UuYXJncywgZ2xvYmFsSW1hZ2Uub3B0aW9uYWxDb250ZW50KTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHhvYmogPSB4cmVmLmZldGNoKHhvYmopOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKCEoeG9iaiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IHNob3VsZCBiZSBhIHN0cmVhbSIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IHhvYmouZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgICAgICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlhPYmplY3Qgc2hvdWxkIGhhdmUgYSBOYW1lIHN1YnR5cGUiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0eXBlLm5hbWUgPT09ICJGb3JtIikgewogICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnNhdmUoKTsKICAgICAgICAgICAgICAgIHNlbGYuYnVpbGRGb3JtWE9iamVjdChyZXNvdXJjZXMsIHhvYmosIG51bGwsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLnN0YXRlLmNsb25lKCksIGxvY2FsQ29sb3JTcGFjZUNhY2hlKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgIH0sIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5uYW1lID09PSAiSW1hZ2UiKSB7CiAgICAgICAgICAgICAgICBzZWxmLmJ1aWxkUGFpbnRJbWFnZVhPYmplY3QoewogICAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICAgIGltYWdlOiB4b2JqLAogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QsCiAgICAgICAgICAgICAgICAgIGNhY2hlS2V5OiBuYW1lLAogICAgICAgICAgICAgICAgICBsb2NhbEltYWdlQ2FjaGUsCiAgICAgICAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICAgICAgICB9KS50aGVuKHJlc29sdmVYT2JqZWN0LCByZWplY3RYT2JqZWN0KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUubmFtZSA9PT0gIlBTIikgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJZ25vcmVkIFhPYmplY3Qgc3VidHlwZSBQUyIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuaGFuZGxlZCBYT2JqZWN0IHN1YnR5cGUgJHt0eXBlLm5hbWV9YCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgc2VsZi5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvclhPYmplY3QKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRPcGVyYXRvckxpc3QgLSBpZ25vcmluZyBYT2JqZWN0OiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0Rm9udDoKICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gYXJnc1sxXTsKICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBhcmdzLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlci5zdGF0ZSwgZmFsbGJhY2tGb250RGljdCkudGhlbihmdW5jdGlvbiAobG9hZGVkTmFtZSkgewogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmN5KGxvYWRlZE5hbWUpOwogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0Rm9udCwgW2xvYWRlZE5hbWUsIGZvbnRTaXplXSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luVGV4dDoKICAgICAgICAgICAgcGFyc2luZ1RleHQgPSB0cnVlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRUZXh0OgogICAgICAgICAgICBwYXJzaW5nVGV4dCA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRJbmxpbmVJbWFnZToKICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gYXJnc1swXS5jYWNoZUtleTsKCiAgICAgICAgICAgIGlmIChjYWNoZUtleSkgewogICAgICAgICAgICAgIGNvbnN0IGxvY2FsSW1hZ2UgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlOYW1lKGNhY2hlS2V5KTsKCiAgICAgICAgICAgICAgaWYgKGxvY2FsSW1hZ2UpIHsKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRJbWFnZU9wcyhsb2NhbEltYWdlLmZuLCBsb2NhbEltYWdlLmFyZ3MsIGxvY2FsSW1hZ2Uub3B0aW9uYWxDb250ZW50KTsKICAgICAgICAgICAgICAgIGluY3JlbWVudENhY2hlZEltYWdlTWFza0NvdW50KGxvY2FsSW1hZ2UpOwogICAgICAgICAgICAgICAgYXJncyA9IG51bGw7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHQoc2VsZi5idWlsZFBhaW50SW1hZ2VYT2JqZWN0KHsKICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgaW1hZ2U6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgaXNJbmxpbmU6IHRydWUsCiAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LAogICAgICAgICAgICAgIGNhY2hlS2V5LAogICAgICAgICAgICAgIGxvY2FsSW1hZ2VDYWNoZSwKICAgICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93VGV4dDoKICAgICAgICAgICAgaWYgKCFzdGF0ZU1hbmFnZXIuc3RhdGUuZm9udCkgewogICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3NbMF0gPSBzZWxmLmhhbmRsZVRleHQoYXJnc1swXSwgc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hvd1NwYWNlZFRleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgYXJyID0gYXJnc1swXTsKICAgICAgICAgICAgdmFyIGNvbWJpbmVkR2x5cGhzID0gW107CiAgICAgICAgICAgIHZhciBhcnJMZW5ndGggPSBhcnIubGVuZ3RoOwogICAgICAgICAgICB2YXIgc3RhdGUgPSBzdGF0ZU1hbmFnZXIuc3RhdGU7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJyTGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgICBjb25zdCBhcnJJdGVtID0gYXJyW2ldOwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGFyckl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShjb21iaW5lZEdseXBocywgc2VsZi5oYW5kbGVUZXh0KGFyckl0ZW0sIHN0YXRlKSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJySXRlbSA9PT0gIm51bWJlciIpIHsKICAgICAgICAgICAgICAgIGNvbWJpbmVkR2x5cGhzLnB1c2goYXJySXRlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBhcmdzWzBdID0gY29tYmluZWRHbHlwaHM7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNob3dUZXh0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5uZXh0TGluZVNob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5uZXh0TGluZSk7CiAgICAgICAgICAgIGFyZ3NbMF0gPSBzZWxmLmhhbmRsZVRleHQoYXJnc1swXSwgc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2hvd1RleHQ7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OgogICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5uZXh0TGluZSk7CiAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0V29yZFNwYWNpbmcsIFthcmdzLnNoaWZ0KCldKTsKICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5zZXRDaGFyU3BhY2luZywgW2FyZ3Muc2hpZnQoKV0pOwogICAgICAgICAgICBhcmdzWzBdID0gc2VsZi5oYW5kbGVUZXh0KGFyZ3NbMF0sIHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNob3dUZXh0OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRUZXh0UmVuZGVyaW5nTW9kZToKICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLnRleHRSZW5kZXJpbmdNb2RlID0gYXJnc1swXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yU3BhY2U6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb25zdCBjYWNoZWRDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5nZXRDYWNoZWQoYXJnc1swXSwgeHJlZiwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgICAgICAgICAgICBpZiAoY2FjaGVkQ29sb3JTcGFjZSkgewogICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gY2FjaGVkQ29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbmV4dChzZWxmLnBhcnNlQ29sb3JTcGFjZSh7CiAgICAgICAgICAgICAgICBjczogYXJnc1swXSwKICAgICAgICAgICAgICAgIHJlc291cmNlcywKICAgICAgICAgICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29sb3JTcGFjZSkgewogICAgICAgICAgICAgICAgaWYgKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gY29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JTcGFjZToKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvbnN0IGNhY2hlZENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLmdldENhY2hlZChhcmdzWzBdLCB4cmVmLCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CgogICAgICAgICAgICAgIGlmIChjYWNoZWRDb2xvclNwYWNlKSB7CiAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IGNhY2hlZENvbG9yU3BhY2U7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG5leHQoc2VsZi5wYXJzZUNvbG9yU3BhY2UoewogICAgICAgICAgICAgICAgY3M6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgIGlmIChjb2xvclNwYWNlKSB7CiAgICAgICAgICAgICAgICAgIHN0YXRlTWFuYWdlci5zdGF0ZS5zdHJva2VDb2xvclNwYWNlID0gY29sb3JTcGFjZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yOgogICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5maWxsQ29sb3JTcGFjZTsKICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvcjoKICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZTsKICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3I7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxHcmF5OgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheTsKICAgICAgICAgICAgYXJncyA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5LmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VHcmF5OgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5OwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENNWUtDb2xvcjoKICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmNteWs7CiAgICAgICAgICAgIGFyZ3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ01ZS0NvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5jbXlrOwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmNteWsuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiOwogICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOgogICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2I7CiAgICAgICAgICAgIGFyZ3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yTjoKICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2U7CgogICAgICAgICAgICBpZiAoY3MubmFtZSA9PT0gIlBhdHRlcm4iKSB7CiAgICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZUNvbG9yTihvcGVyYXRvckxpc3QsIF91dGlsLk9QUy5zZXRGaWxsQ29sb3JOLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaywgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLCBsb2NhbFNoYWRpbmdQYXR0ZXJuQ2FjaGUpKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3MgPSBjcy5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JOOgogICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5zdHJva2VDb2xvclNwYWNlOwoKICAgICAgICAgICAgaWYgKGNzLm5hbWUgPT09ICJQYXR0ZXJuIikgewogICAgICAgICAgICAgIG5leHQoc2VsZi5oYW5kbGVDb2xvck4ob3BlcmF0b3JMaXN0LCBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JOLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaywgbG9jYWxDb2xvclNwYWNlQ2FjaGUsIGxvY2FsVGlsaW5nUGF0dGVybkNhY2hlLCBsb2NhbFNoYWRpbmdQYXR0ZXJuQ2FjaGUpKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZ3MgPSBjcy5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaGFkaW5nRmlsbDoKICAgICAgICAgICAgdmFyIHNoYWRpbmdSZXMgPSByZXNvdXJjZXMuZ2V0KCJTaGFkaW5nIik7CgogICAgICAgICAgICBpZiAoIXNoYWRpbmdSZXMpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIHNoYWRpbmcgcmVzb3VyY2UgZm91bmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNoYWRpbmcgPSBzaGFkaW5nUmVzLmdldChhcmdzWzBdLm5hbWUpOwoKICAgICAgICAgICAgaWYgKCFzaGFkaW5nKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBzaGFkaW5nIG9iamVjdCBmb3VuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBwYXR0ZXJuSWQgPSBzZWxmLnBhcnNlU2hhZGluZyh7CiAgICAgICAgICAgICAgc2hhZGluZywKICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUsCiAgICAgICAgICAgICAgbG9jYWxTaGFkaW5nUGF0dGVybkNhY2hlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhcmdzID0gW3BhdHRlcm5JZF07CiAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNoYWRpbmdGaWxsOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRHU3RhdGU6CiAgICAgICAgICAgIGlzVmFsaWROYW1lID0gYXJnc1swXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWU7CiAgICAgICAgICAgIG5hbWUgPSBhcmdzWzBdLm5hbWU7CgogICAgICAgICAgICBpZiAoaXNWYWxpZE5hbWUpIHsKICAgICAgICAgICAgICBjb25zdCBsb2NhbEdTdGF0ZU9iaiA9IGxvY2FsR1N0YXRlQ2FjaGUuZ2V0QnlOYW1lKG5hbWUpOwoKICAgICAgICAgICAgICBpZiAobG9jYWxHU3RhdGVPYmopIHsKICAgICAgICAgICAgICAgIGlmIChsb2NhbEdTdGF0ZU9iai5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0R1N0YXRlLCBbbG9jYWxHU3RhdGVPYmpdKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhcmdzID0gbnVsbDsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dChuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZUdTdGF0ZSwgcmVqZWN0R1N0YXRlKSB7CiAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTmFtZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJHU3RhdGUgbXVzdCBiZSByZWZlcnJlZCB0byBieSBuYW1lLiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZXh0R1N0YXRlID0gcmVzb3VyY2VzLmdldCgiRXh0R1N0YXRlIik7CgogICAgICAgICAgICAgIGlmICghKGV4dEdTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkV4dEdTdGF0ZSBzaG91bGQgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29uc3QgZ1N0YXRlID0gZXh0R1N0YXRlLmdldChuYW1lKTsKCiAgICAgICAgICAgICAgaWYgKCEoZ1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiR1N0YXRlIHNob3VsZCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnNldEdTdGF0ZSh7CiAgICAgICAgICAgICAgICByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBnU3RhdGUsCiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QsCiAgICAgICAgICAgICAgICBjYWNoZUtleTogbmFtZSwKICAgICAgICAgICAgICAgIHRhc2ssCiAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIsCiAgICAgICAgICAgICAgICBsb2NhbEdTdGF0ZUNhY2hlLAogICAgICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgICAgICAgICAgICB9KS50aGVuKHJlc29sdmVHU3RhdGUsIHJlamVjdEdTdGF0ZSk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yRXh0R1N0YXRlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgZ2V0T3BlcmF0b3JMaXN0IC0gaWdub3JpbmcgRXh0R1N0YXRlOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubW92ZVRvOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubGluZVRvOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmN1cnZlVG8yOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzM6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5jbG9zZVBhdGg6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5yZWN0YW5nbGU6CiAgICAgICAgICAgIHNlbGYuYnVpbGRQYXRoKG9wZXJhdG9yTGlzdCwgZm4sIGFyZ3MsIHBhcnNpbmdUZXh0KTsKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubWFya1BvaW50OgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubWFya1BvaW50UHJvcHM6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbkNvbXBhdDoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmVuZENvbXBhdDoKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHM6CiAgICAgICAgICAgIGlmICghKGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgRXhwZWN0ZWQgbmFtZSBmb3IgYmVnaW5NYXJrZWRDb250ZW50UHJvcHMgYXJnMD0ke2FyZ3NbMF19YCk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChhcmdzWzBdLm5hbWUgPT09ICJPQyIpIHsKICAgICAgICAgICAgICBuZXh0KHNlbGYucGFyc2VNYXJrZWRDb250ZW50UHJvcHMoYXJnc1sxXSwgcmVzb3VyY2VzKS50aGVuKGRhdGEgPT4gewogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wcywgWyJPQyIsIGRhdGFdKTsKICAgICAgICAgICAgICB9KS5jYXRjaChyZWFzb24gPT4gewogICAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JNYXJrZWRDb250ZW50CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIGJlZ2luTWFya2VkQ29udGVudFByb3BzOiAiJHtyZWFzb259Ii5gKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhcmdzID0gW2FyZ3NbMF0ubmFtZSwgYXJnc1sxXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgPyBhcmdzWzFdLmdldCgiTUNJRCIpIDogbnVsbF07CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudDoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQ6CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBpZiAoYXJncyAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gYXJncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJnc1tpXSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoaSA8IGlpKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoImdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIG9wZXJhdG9yOiAiICsgZm4pOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKGZuLCBhcmdzKTsKICAgICAgfQoKICAgICAgaWYgKHN0b3ApIHsKICAgICAgICBuZXh0KGRlZmVycmVkKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNsb3NlUGVuZGluZ1Jlc3RvcmVPUFMoKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSkuY2F0Y2gocmVhc29uID0+IHsKICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yT3BlcmF0b3JMaXN0CiAgICAgICAgfSk7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRPcGVyYXRvckxpc3QgLSBpZ25vcmluZyBlcnJvcnMgZHVyaW5nICIke3Rhc2submFtZX0iIGAgKyBgdGFzazogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgY2xvc2VQZW5kaW5nUmVzdG9yZU9QUygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSk7CiAgfQoKICBnZXRUZXh0Q29udGVudCh7CiAgICBzdHJlYW0sCiAgICB0YXNrLAogICAgcmVzb3VyY2VzLAogICAgc3RhdGVNYW5hZ2VyID0gbnVsbCwKICAgIGNvbWJpbmVUZXh0SXRlbXMgPSBmYWxzZSwKICAgIGluY2x1ZGVNYXJrZWRDb250ZW50ID0gZmFsc2UsCiAgICBzaW5rLAogICAgc2VlblN0eWxlcyA9IG5ldyBTZXQoKSwKICAgIHZpZXdCb3gKICB9KSB7CiAgICByZXNvdXJjZXMgPSByZXNvdXJjZXMgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICAgIHN0YXRlTWFuYWdlciA9IHN0YXRlTWFuYWdlciB8fCBuZXcgU3RhdGVNYW5hZ2VyKG5ldyBUZXh0U3RhdGUoKSk7CiAgICBjb25zdCBOb3JtYWxpemVkVW5pY29kZXMgPSAoMCwgX3VuaWNvZGUuZ2V0Tm9ybWFsaXplZFVuaWNvZGVzKSgpOwogICAgY29uc3QgdGV4dENvbnRlbnQgPSB7CiAgICAgIGl0ZW1zOiBbXSwKICAgICAgc3R5bGVzOiBPYmplY3QuY3JlYXRlKG51bGwpCiAgICB9OwogICAgY29uc3QgdGV4dENvbnRlbnRJdGVtID0gewogICAgICBpbml0aWFsaXplZDogZmFsc2UsCiAgICAgIHN0cjogW10sCiAgICAgIHRvdGFsV2lkdGg6IDAsCiAgICAgIHRvdGFsSGVpZ2h0OiAwLAogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwLAogICAgICB2ZXJ0aWNhbDogZmFsc2UsCiAgICAgIHByZXZUcmFuc2Zvcm06IG51bGwsCiAgICAgIHRleHRBZHZhbmNlU2NhbGU6IDAsCiAgICAgIHNwYWNlSW5GbG93TWluOiAwLAogICAgICBzcGFjZUluRmxvd01heDogMCwKICAgICAgdHJhY2tpbmdTcGFjZU1pbjogSW5maW5pdHksCiAgICAgIG5lZ2F0aXZlU3BhY2VNYXg6IC1JbmZpbml0eSwKICAgICAgbm90QVNwYWNlOiAtSW5maW5pdHksCiAgICAgIHRyYW5zZm9ybTogbnVsbCwKICAgICAgZm9udE5hbWU6IG51bGwsCiAgICAgIGhhc0VPTDogZmFsc2UKICAgIH07CiAgICBjb25zdCB0d29MYXN0Q2hhcnMgPSBbIiAiLCAiICJdOwogICAgbGV0IHR3b0xhc3RDaGFyc1BvcyA9IDA7CgogICAgZnVuY3Rpb24gc2F2ZUxhc3RDaGFyKGNoYXIpIHsKICAgICAgY29uc3QgbmV4dFBvcyA9ICh0d29MYXN0Q2hhcnNQb3MgKyAxKSAlIDI7CiAgICAgIGNvbnN0IHJldCA9IHR3b0xhc3RDaGFyc1t0d29MYXN0Q2hhcnNQb3NdICE9PSAiICIgJiYgdHdvTGFzdENoYXJzW25leHRQb3NdID09PSAiICI7CiAgICAgIHR3b0xhc3RDaGFyc1t0d29MYXN0Q2hhcnNQb3NdID0gY2hhcjsKICAgICAgdHdvTGFzdENoYXJzUG9zID0gbmV4dFBvczsKICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICBmdW5jdGlvbiByZXNldExhc3RDaGFycygpIHsKICAgICAgdHdvTGFzdENoYXJzWzBdID0gdHdvTGFzdENoYXJzWzFdID0gIiAiOwogICAgICB0d29MYXN0Q2hhcnNQb3MgPSAwOwogICAgfQoKICAgIGNvbnN0IFRSQUNLSU5HX1NQQUNFX0ZBQ1RPUiA9IDAuMTsKICAgIGNvbnN0IE5PVF9BX1NQQUNFX0ZBQ1RPUiA9IDAuMDM7CiAgICBjb25zdCBORUdBVElWRV9TUEFDRV9GQUNUT1IgPSAtMC4yOwogICAgY29uc3QgU1BBQ0VfSU5fRkxPV19NSU5fRkFDVE9SID0gMC4xOwogICAgY29uc3QgU1BBQ0VfSU5fRkxPV19NQVhfRkFDVE9SID0gMC42OwogICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgY29uc3Qgc2hvd1NwYWNlZFRleHRCdWZmZXIgPSBbXTsKICAgIGxldCB4b2JqcyA9IG51bGw7CiAgICBjb25zdCBlbXB0eVhPYmplY3RDYWNoZSA9IG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxJbWFnZUNhY2hlKCk7CiAgICBjb25zdCBlbXB0eUdTdGF0ZUNhY2hlID0gbmV3IF9pbWFnZV91dGlscy5Mb2NhbEdTdGF0ZUNhY2hlKCk7CiAgICBjb25zdCBwcmVwcm9jZXNzb3IgPSBuZXcgRXZhbHVhdG9yUHJlcHJvY2Vzc29yKHN0cmVhbSwgeHJlZiwgc3RhdGVNYW5hZ2VyKTsKICAgIGxldCB0ZXh0U3RhdGU7CgogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFRleHRUcmFuc2Zvcm0oKSB7CiAgICAgIGNvbnN0IGZvbnQgPSB0ZXh0U3RhdGUuZm9udDsKICAgICAgY29uc3QgdHNtID0gW3RleHRTdGF0ZS5mb250U2l6ZSAqIHRleHRTdGF0ZS50ZXh0SFNjYWxlLCAwLCAwLCB0ZXh0U3RhdGUuZm9udFNpemUsIDAsIHRleHRTdGF0ZS50ZXh0UmlzZV07CgogICAgICBpZiAoZm9udC5pc1R5cGUzRm9udCAmJiAodGV4dFN0YXRlLmZvbnRTaXplIDw9IDEgfHwgZm9udC5pc0NoYXJCQm94KSAmJiAhKDAsIF91dGlsLmlzQXJyYXlFcXVhbCkodGV4dFN0YXRlLmZvbnRNYXRyaXgsIF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYKSkgewogICAgICAgIGNvbnN0IGdseXBoSGVpZ2h0ID0gZm9udC5iYm94WzNdIC0gZm9udC5iYm94WzFdOwoKICAgICAgICBpZiAoZ2x5cGhIZWlnaHQgPiAwKSB7CiAgICAgICAgICB0c21bM10gKj0gZ2x5cGhIZWlnaHQgKiB0ZXh0U3RhdGUuZm9udE1hdHJpeFszXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBfdXRpbC5VdGlsLnRyYW5zZm9ybSh0ZXh0U3RhdGUuY3RtLCBfdXRpbC5VdGlsLnRyYW5zZm9ybSh0ZXh0U3RhdGUudGV4dE1hdHJpeCwgdHNtKSk7CiAgICB9CgogICAgZnVuY3Rpb24gZW5zdXJlVGV4dENvbnRlbnRJdGVtKCkgewogICAgICBpZiAodGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkKSB7CiAgICAgICAgcmV0dXJuIHRleHRDb250ZW50SXRlbTsKICAgICAgfQoKICAgICAgY29uc3QgZm9udCA9IHRleHRTdGF0ZS5mb250LAogICAgICAgICAgICBsb2FkZWROYW1lID0gZm9udC5sb2FkZWROYW1lOwoKICAgICAgaWYgKCFzZWVuU3R5bGVzLmhhcyhsb2FkZWROYW1lKSkgewogICAgICAgIHNlZW5TdHlsZXMuYWRkKGxvYWRlZE5hbWUpOwogICAgICAgIHRleHRDb250ZW50LnN0eWxlc1tsb2FkZWROYW1lXSA9IHsKICAgICAgICAgIGZvbnRGYW1pbHk6IGZvbnQuZmFsbGJhY2tOYW1lLAogICAgICAgICAgYXNjZW50OiBmb250LmFzY2VudCwKICAgICAgICAgIGRlc2NlbnQ6IGZvbnQuZGVzY2VudCwKICAgICAgICAgIHZlcnRpY2FsOiBmb250LnZlcnRpY2FsCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdGV4dENvbnRlbnRJdGVtLmZvbnROYW1lID0gbG9hZGVkTmFtZTsKICAgICAgY29uc3QgdHJtID0gdGV4dENvbnRlbnRJdGVtLnRyYW5zZm9ybSA9IGdldEN1cnJlbnRUZXh0VHJhbnNmb3JtKCk7CgogICAgICBpZiAoIWZvbnQudmVydGljYWwpIHsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0ud2lkdGggPSB0ZXh0Q29udGVudEl0ZW0udG90YWxXaWR0aCA9IDA7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCA9IHRleHRDb250ZW50SXRlbS50b3RhbEhlaWdodCA9IE1hdGguaHlwb3QodHJtWzJdLCB0cm1bM10pOwogICAgICAgIHRleHRDb250ZW50SXRlbS52ZXJ0aWNhbCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCA9IHRleHRDb250ZW50SXRlbS50b3RhbFdpZHRoID0gTWF0aC5oeXBvdCh0cm1bMF0sIHRybVsxXSk7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCA9IHRleHRDb250ZW50SXRlbS50b3RhbEhlaWdodCA9IDA7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnZlcnRpY2FsID0gdHJ1ZTsKICAgICAgfQoKICAgICAgY29uc3Qgc2NhbGVMaW5lWCA9IE1hdGguaHlwb3QodGV4dFN0YXRlLnRleHRMaW5lTWF0cml4WzBdLCB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXhbMV0pOwogICAgICBjb25zdCBzY2FsZUN0bVggPSBNYXRoLmh5cG90KHRleHRTdGF0ZS5jdG1bMF0sIHRleHRTdGF0ZS5jdG1bMV0pOwogICAgICB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZSA9IHNjYWxlQ3RtWCAqIHNjYWxlTGluZVg7CiAgICAgIHRleHRDb250ZW50SXRlbS50cmFja2luZ1NwYWNlTWluID0gdGV4dFN0YXRlLmZvbnRTaXplICogVFJBQ0tJTkdfU1BBQ0VfRkFDVE9SOwogICAgICB0ZXh0Q29udGVudEl0ZW0ubm90QVNwYWNlID0gdGV4dFN0YXRlLmZvbnRTaXplICogTk9UX0FfU1BBQ0VfRkFDVE9SOwogICAgICB0ZXh0Q29udGVudEl0ZW0ubmVnYXRpdmVTcGFjZU1heCA9IHRleHRTdGF0ZS5mb250U2l6ZSAqIE5FR0FUSVZFX1NQQUNFX0ZBQ1RPUjsKICAgICAgdGV4dENvbnRlbnRJdGVtLnNwYWNlSW5GbG93TWluID0gdGV4dFN0YXRlLmZvbnRTaXplICogU1BBQ0VfSU5fRkxPV19NSU5fRkFDVE9SOwogICAgICB0ZXh0Q29udGVudEl0ZW0uc3BhY2VJbkZsb3dNYXggPSB0ZXh0U3RhdGUuZm9udFNpemUgKiBTUEFDRV9JTl9GTE9XX01BWF9GQUNUT1I7CiAgICAgIHRleHRDb250ZW50SXRlbS5oYXNFT0wgPSBmYWxzZTsKICAgICAgdGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgcmV0dXJuIHRleHRDb250ZW50SXRlbTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVBZHZhbmNlU2NhbGUoKSB7CiAgICAgIGlmICghdGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBzY2FsZUxpbmVYID0gTWF0aC5oeXBvdCh0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXhbMF0sIHRleHRTdGF0ZS50ZXh0TGluZU1hdHJpeFsxXSk7CiAgICAgIGNvbnN0IHNjYWxlQ3RtWCA9IE1hdGguaHlwb3QodGV4dFN0YXRlLmN0bVswXSwgdGV4dFN0YXRlLmN0bVsxXSk7CiAgICAgIGNvbnN0IHNjYWxlRmFjdG9yID0gc2NhbGVDdG1YICogc2NhbGVMaW5lWDsKCiAgICAgIGlmIChzY2FsZUZhY3RvciA9PT0gdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGV4dENvbnRlbnRJdGVtLnZlcnRpY2FsKSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnRvdGFsV2lkdGggKz0gdGV4dENvbnRlbnRJdGVtLndpZHRoICogdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGU7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0udG90YWxIZWlnaHQgKz0gdGV4dENvbnRlbnRJdGVtLmhlaWdodCAqIHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlOwogICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgPSAwOwogICAgICB9CgogICAgICB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZSA9IHNjYWxlRmFjdG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bkJpZGlUcmFuc2Zvcm0odGV4dENodW5rKSB7CiAgICAgIGNvbnN0IHRleHQgPSB0ZXh0Q2h1bmsuc3RyLmpvaW4oIiIpOwogICAgICBjb25zdCBiaWRpUmVzdWx0ID0gKDAsIF9iaWRpLmJpZGkpKHRleHQsIC0xLCB0ZXh0Q2h1bmsudmVydGljYWwpOwogICAgICByZXR1cm4gewogICAgICAgIHN0cjogYmlkaVJlc3VsdC5zdHIsCiAgICAgICAgZGlyOiBiaWRpUmVzdWx0LmRpciwKICAgICAgICB3aWR0aDogTWF0aC5hYnModGV4dENodW5rLnRvdGFsV2lkdGgpLAogICAgICAgIGhlaWdodDogTWF0aC5hYnModGV4dENodW5rLnRvdGFsSGVpZ2h0KSwKICAgICAgICB0cmFuc2Zvcm06IHRleHRDaHVuay50cmFuc2Zvcm0sCiAgICAgICAgZm9udE5hbWU6IHRleHRDaHVuay5mb250TmFtZSwKICAgICAgICBoYXNFT0w6IHRleHRDaHVuay5oYXNFT0wKICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVTZXRGb250KGZvbnROYW1lLCBmb250UmVmKSB7CiAgICAgIHJldHVybiBzZWxmLmxvYWRGb250KGZvbnROYW1lLCBmb250UmVmLCByZXNvdXJjZXMpLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0ZWQpIHsKICAgICAgICBpZiAoIXRyYW5zbGF0ZWQuZm9udC5pc1R5cGUzRm9udCkgewogICAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJhbnNsYXRlZC5sb2FkVHlwZTNEYXRhKHNlbGYsIHJlc291cmNlcywgdGFzaykuY2F0Y2goZnVuY3Rpb24gKCkge30pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQ7CiAgICAgICAgfSk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0ZWQpIHsKICAgICAgICB0ZXh0U3RhdGUuZm9udCA9IHRyYW5zbGF0ZWQuZm9udDsKICAgICAgICB0ZXh0U3RhdGUuZm9udE1hdHJpeCA9IHRyYW5zbGF0ZWQuZm9udC5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYOwogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseUludmVyc2VSb3RhdGlvbih4LCB5LCBtYXRyaXgpIHsKICAgICAgY29uc3Qgc2NhbGUgPSBNYXRoLmh5cG90KG1hdHJpeFswXSwgbWF0cml4WzFdKTsKICAgICAgcmV0dXJuIFsobWF0cml4WzBdICogeCArIG1hdHJpeFsxXSAqIHkpIC8gc2NhbGUsIChtYXRyaXhbMl0gKiB4ICsgbWF0cml4WzNdICogeSkgLyBzY2FsZV07CiAgICB9CgogICAgZnVuY3Rpb24gY29tcGFyZVdpdGhMYXN0UG9zaXRpb24oKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRUcmFuc2Zvcm0gPSBnZXRDdXJyZW50VGV4dFRyYW5zZm9ybSgpOwogICAgICBsZXQgcG9zWCA9IGN1cnJlbnRUcmFuc2Zvcm1bNF07CiAgICAgIGxldCBwb3NZID0gY3VycmVudFRyYW5zZm9ybVs1XTsKICAgICAgY29uc3Qgc2hpZnRlZFggPSBwb3NYIC0gdmlld0JveFswXTsKICAgICAgY29uc3Qgc2hpZnRlZFkgPSBwb3NZIC0gdmlld0JveFsxXTsKCiAgICAgIGlmIChzaGlmdGVkWCA8IDAgfHwgc2hpZnRlZFggPiB2aWV3Qm94WzJdIHx8IHNoaWZ0ZWRZIDwgMCB8fCBzaGlmdGVkWSA+IHZpZXdCb3hbM10pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICghY29tYmluZVRleHRJdGVtcyB8fCAhdGV4dFN0YXRlLmZvbnQgfHwgIXRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGxldCBsYXN0UG9zWCA9IHRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtWzRdOwogICAgICBsZXQgbGFzdFBvc1kgPSB0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybVs1XTsKCiAgICAgIGlmIChsYXN0UG9zWCA9PT0gcG9zWCAmJiBsYXN0UG9zWSA9PT0gcG9zWSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBsZXQgcm90YXRlID0gLTE7CgogICAgICBpZiAoY3VycmVudFRyYW5zZm9ybVswXSAmJiBjdXJyZW50VHJhbnNmb3JtWzFdID09PSAwICYmIGN1cnJlbnRUcmFuc2Zvcm1bMl0gPT09IDApIHsKICAgICAgICByb3RhdGUgPSBjdXJyZW50VHJhbnNmb3JtWzBdID4gMCA/IDAgOiAxODA7CiAgICAgIH0gZWxzZSBpZiAoY3VycmVudFRyYW5zZm9ybVsxXSAmJiBjdXJyZW50VHJhbnNmb3JtWzBdID09PSAwICYmIGN1cnJlbnRUcmFuc2Zvcm1bM10gPT09IDApIHsKICAgICAgICByb3RhdGUgPSBjdXJyZW50VHJhbnNmb3JtWzFdID4gMCA/IDkwIDogMjcwOwogICAgICB9CgogICAgICBzd2l0Y2ggKHJvdGF0ZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDkwOgogICAgICAgICAgW3Bvc1gsIHBvc1ldID0gW3Bvc1ksIHBvc1hdOwogICAgICAgICAgW2xhc3RQb3NYLCBsYXN0UG9zWV0gPSBbbGFzdFBvc1ksIGxhc3RQb3NYXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE4MDoKICAgICAgICAgIFtwb3NYLCBwb3NZLCBsYXN0UG9zWCwgbGFzdFBvc1ldID0gWy1wb3NYLCAtcG9zWSwgLWxhc3RQb3NYLCAtbGFzdFBvc1ldOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjcwOgogICAgICAgICAgW3Bvc1gsIHBvc1ldID0gWy1wb3NZLCAtcG9zWF07CiAgICAgICAgICBbbGFzdFBvc1gsIGxhc3RQb3NZXSA9IFstbGFzdFBvc1ksIC1sYXN0UG9zWF07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIFtwb3NYLCBwb3NZXSA9IGFwcGx5SW52ZXJzZVJvdGF0aW9uKHBvc1gsIHBvc1ksIGN1cnJlbnRUcmFuc2Zvcm0pOwogICAgICAgICAgW2xhc3RQb3NYLCBsYXN0UG9zWV0gPSBhcHBseUludmVyc2VSb3RhdGlvbihsYXN0UG9zWCwgbGFzdFBvc1ksIHRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtKTsKICAgICAgfQoKICAgICAgaWYgKHRleHRTdGF0ZS5mb250LnZlcnRpY2FsKSB7CiAgICAgICAgY29uc3QgYWR2YW5jZVkgPSAobGFzdFBvc1kgLSBwb3NZKSAvIHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlOwogICAgICAgIGNvbnN0IGFkdmFuY2VYID0gcG9zWCAtIGxhc3RQb3NYOwogICAgICAgIGNvbnN0IHRleHRPcmllbnRhdGlvbiA9IE1hdGguc2lnbih0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0KTsKCiAgICAgICAgaWYgKGFkdmFuY2VZIDwgdGV4dE9yaWVudGF0aW9uICogdGV4dENvbnRlbnRJdGVtLm5lZ2F0aXZlU3BhY2VNYXgpIHsKICAgICAgICAgIGlmIChNYXRoLmFicyhhZHZhbmNlWCkgPiAwLjUgKiB0ZXh0Q29udGVudEl0ZW0ud2lkdGgpIHsKICAgICAgICAgICAgYXBwZW5kRU9MKCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc2V0TGFzdENoYXJzKCk7CiAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoTWF0aC5hYnMoYWR2YW5jZVgpID4gdGV4dENvbnRlbnRJdGVtLndpZHRoKSB7CiAgICAgICAgICBhcHBlbmRFT0woKTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGFkdmFuY2VZIDw9IHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS5ub3RBU3BhY2UpIHsKICAgICAgICAgIHJlc2V0TGFzdENoYXJzKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYWR2YW5jZVkgPD0gdGV4dE9yaWVudGF0aW9uICogdGV4dENvbnRlbnRJdGVtLnRyYWNraW5nU3BhY2VNaW4pIHsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgKz0gYWR2YW5jZVk7CiAgICAgICAgfSBlbHNlIGlmICghYWRkRmFrZVNwYWNlcyhhZHZhbmNlWSwgdGV4dENvbnRlbnRJdGVtLnByZXZUcmFuc2Zvcm0sIHRleHRPcmllbnRhdGlvbikpIHsKICAgICAgICAgIGlmICh0ZXh0Q29udGVudEl0ZW0uc3RyLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXNldExhc3RDaGFycygpOwogICAgICAgICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgICBzdHI6ICIgIiwKICAgICAgICAgICAgICBkaXI6ICJsdHIiLAogICAgICAgICAgICAgIHdpZHRoOiAwLAogICAgICAgICAgICAgIGhlaWdodDogTWF0aC5hYnMoYWR2YW5jZVkpLAogICAgICAgICAgICAgIHRyYW5zZm9ybTogdGV4dENvbnRlbnRJdGVtLnByZXZUcmFuc2Zvcm0sCiAgICAgICAgICAgICAgZm9udE5hbWU6IHRleHRDb250ZW50SXRlbS5mb250TmFtZSwKICAgICAgICAgICAgICBoYXNFT0w6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCArPSBhZHZhbmNlWTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBjb25zdCBhZHZhbmNlWCA9IChwb3NYIC0gbGFzdFBvc1gpIC8gdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGU7CiAgICAgIGNvbnN0IGFkdmFuY2VZID0gcG9zWSAtIGxhc3RQb3NZOwogICAgICBjb25zdCB0ZXh0T3JpZW50YXRpb24gPSBNYXRoLnNpZ24odGV4dENvbnRlbnRJdGVtLndpZHRoKTsKCiAgICAgIGlmIChhZHZhbmNlWCA8IHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS5uZWdhdGl2ZVNwYWNlTWF4KSB7CiAgICAgICAgaWYgKE1hdGguYWJzKGFkdmFuY2VZKSA+IDAuNSAqIHRleHRDb250ZW50SXRlbS5oZWlnaHQpIHsKICAgICAgICAgIGFwcGVuZEVPTCgpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXNldExhc3RDaGFycygpOwogICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChNYXRoLmFicyhhZHZhbmNlWSkgPiB0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0KSB7CiAgICAgICAgYXBwZW5kRU9MKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChhZHZhbmNlWCA8PSB0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0ubm90QVNwYWNlKSB7CiAgICAgICAgcmVzZXRMYXN0Q2hhcnMoKTsKICAgICAgfQoKICAgICAgaWYgKGFkdmFuY2VYIDw9IHRleHRPcmllbnRhdGlvbiAqIHRleHRDb250ZW50SXRlbS50cmFja2luZ1NwYWNlTWluKSB7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoICs9IGFkdmFuY2VYOwogICAgICB9IGVsc2UgaWYgKCFhZGRGYWtlU3BhY2VzKGFkdmFuY2VYLCB0ZXh0Q29udGVudEl0ZW0ucHJldlRyYW5zZm9ybSwgdGV4dE9yaWVudGF0aW9uKSkgewogICAgICAgIGlmICh0ZXh0Q29udGVudEl0ZW0uc3RyLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmVzZXRMYXN0Q2hhcnMoKTsKICAgICAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2goewogICAgICAgICAgICBzdHI6ICIgIiwKICAgICAgICAgICAgZGlyOiAibHRyIiwKICAgICAgICAgICAgd2lkdGg6IE1hdGguYWJzKGFkdmFuY2VYKSwKICAgICAgICAgICAgaGVpZ2h0OiAwLAogICAgICAgICAgICB0cmFuc2Zvcm06IHRleHRDb250ZW50SXRlbS5wcmV2VHJhbnNmb3JtLAogICAgICAgICAgICBmb250TmFtZTogdGV4dENvbnRlbnRJdGVtLmZvbnROYW1lLAogICAgICAgICAgICBoYXNFT0w6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoICs9IGFkdmFuY2VYOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYnVpbGRUZXh0Q29udGVudEl0ZW0oewogICAgICBjaGFycywKICAgICAgZXh0cmFTcGFjaW5nCiAgICB9KSB7CiAgICAgIGNvbnN0IGZvbnQgPSB0ZXh0U3RhdGUuZm9udDsKCiAgICAgIGlmICghY2hhcnMpIHsKICAgICAgICBjb25zdCBjaGFyU3BhY2luZyA9IHRleHRTdGF0ZS5jaGFyU3BhY2luZyArIGV4dHJhU3BhY2luZzsKCiAgICAgICAgaWYgKGNoYXJTcGFjaW5nKSB7CiAgICAgICAgICBpZiAoIWZvbnQudmVydGljYWwpIHsKICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoY2hhclNwYWNpbmcgKiB0ZXh0U3RhdGUudGV4dEhTY2FsZSwgMCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeCgwLCAtY2hhclNwYWNpbmcpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBnbHlwaHMgPSBmb250LmNoYXJzVG9HbHlwaHMoY2hhcnMpOwogICAgICBjb25zdCBzY2FsZSA9IHRleHRTdGF0ZS5mb250TWF0cml4WzBdICogdGV4dFN0YXRlLmZvbnRTaXplOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZ2x5cGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCBnbHlwaCA9IGdseXBoc1tpXTsKCiAgICAgICAgaWYgKGdseXBoLmlzSW52aXNpYmxlRm9ybWF0TWFyaykgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsZXQgY2hhclNwYWNpbmcgPSB0ZXh0U3RhdGUuY2hhclNwYWNpbmcgKyAoaSArIDEgPT09IGlpID8gZXh0cmFTcGFjaW5nIDogMCk7CiAgICAgICAgbGV0IGdseXBoV2lkdGggPSBnbHlwaC53aWR0aDsKCiAgICAgICAgaWYgKGZvbnQudmVydGljYWwpIHsKICAgICAgICAgIGdseXBoV2lkdGggPSBnbHlwaC52bWV0cmljID8gZ2x5cGgudm1ldHJpY1swXSA6IC1nbHlwaFdpZHRoOwogICAgICAgIH0KCiAgICAgICAgbGV0IHNjYWxlZERpbSA9IGdseXBoV2lkdGggKiBzY2FsZTsKCiAgICAgICAgaWYgKGdseXBoLmlzV2hpdGVzcGFjZSkgewogICAgICAgICAgaWYgKCFmb250LnZlcnRpY2FsKSB7CiAgICAgICAgICAgIGNoYXJTcGFjaW5nICs9IHNjYWxlZERpbSArIHRleHRTdGF0ZS53b3JkU3BhY2luZzsKICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoY2hhclNwYWNpbmcgKiB0ZXh0U3RhdGUudGV4dEhTY2FsZSwgMCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaGFyU3BhY2luZyArPSAtc2NhbGVkRGltICsgdGV4dFN0YXRlLndvcmRTcGFjaW5nOwogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeCgwLCAtY2hhclNwYWNpbmcpOwogICAgICAgICAgfQoKICAgICAgICAgIHNhdmVMYXN0Q2hhcigiICIpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWNvbXBhcmVXaXRoTGFzdFBvc2l0aW9uKCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdGV4dENodW5rID0gZW5zdXJlVGV4dENvbnRlbnRJdGVtKCk7CgogICAgICAgIGlmIChnbHlwaC5pc1plcm9XaWR0aERpYWNyaXRpYykgewogICAgICAgICAgc2NhbGVkRGltID0gMDsKICAgICAgICB9CgogICAgICAgIGlmICghZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgc2NhbGVkRGltICo9IHRleHRTdGF0ZS50ZXh0SFNjYWxlOwogICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoc2NhbGVkRGltLCAwKTsKICAgICAgICAgIHRleHRDaHVuay53aWR0aCArPSBzY2FsZWREaW07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TWF0cml4KDAsIHNjYWxlZERpbSk7CiAgICAgICAgICBzY2FsZWREaW0gPSBNYXRoLmFicyhzY2FsZWREaW0pOwogICAgICAgICAgdGV4dENodW5rLmhlaWdodCArPSBzY2FsZWREaW07CiAgICAgICAgfQoKICAgICAgICBpZiAoc2NhbGVkRGltKSB7CiAgICAgICAgICB0ZXh0Q2h1bmsucHJldlRyYW5zZm9ybSA9IGdldEN1cnJlbnRUZXh0VHJhbnNmb3JtKCk7CiAgICAgICAgfQoKICAgICAgICBsZXQgZ2x5cGhVbmljb2RlID0gZ2x5cGgudW5pY29kZTsKICAgICAgICBnbHlwaFVuaWNvZGUgPSBOb3JtYWxpemVkVW5pY29kZXNbZ2x5cGhVbmljb2RlXSB8fCBnbHlwaFVuaWNvZGU7CiAgICAgICAgZ2x5cGhVbmljb2RlID0gKDAsIF91bmljb2RlLnJldmVyc2VJZlJ0bCkoZ2x5cGhVbmljb2RlKTsKCiAgICAgICAgaWYgKHNhdmVMYXN0Q2hhcihnbHlwaFVuaWNvZGUpKSB7CiAgICAgICAgICB0ZXh0Q2h1bmsuc3RyLnB1c2goIiAiKTsKICAgICAgICB9CgogICAgICAgIHRleHRDaHVuay5zdHIucHVzaChnbHlwaFVuaWNvZGUpOwoKICAgICAgICBpZiAoY2hhclNwYWNpbmcpIHsKICAgICAgICAgIGlmICghZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeChjaGFyU3BhY2luZyAqIHRleHRTdGF0ZS50ZXh0SFNjYWxlLCAwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TWF0cml4KDAsIC1jaGFyU3BhY2luZyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYXBwZW5kRU9MKCkgewogICAgICByZXNldExhc3RDaGFycygpOwoKICAgICAgaWYgKHRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCkgewogICAgICAgIHRleHRDb250ZW50SXRlbS5oYXNFT0wgPSB0cnVlOwogICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGV4dENvbnRlbnQuaXRlbXMucHVzaCh7CiAgICAgICAgICBzdHI6ICIiLAogICAgICAgICAgZGlyOiAibHRyIiwKICAgICAgICAgIHdpZHRoOiAwLAogICAgICAgICAgaGVpZ2h0OiAwLAogICAgICAgICAgdHJhbnNmb3JtOiBnZXRDdXJyZW50VGV4dFRyYW5zZm9ybSgpLAogICAgICAgICAgZm9udE5hbWU6IHRleHRTdGF0ZS5mb250LmxvYWRlZE5hbWUsCiAgICAgICAgICBoYXNFT0w6IHRydWUKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGFkZEZha2VTcGFjZXMod2lkdGgsIHRyYW5zZiwgdGV4dE9yaWVudGF0aW9uKSB7CiAgICAgIGlmICh0ZXh0T3JpZW50YXRpb24gKiB0ZXh0Q29udGVudEl0ZW0uc3BhY2VJbkZsb3dNaW4gPD0gd2lkdGggJiYgd2lkdGggPD0gdGV4dE9yaWVudGF0aW9uICogdGV4dENvbnRlbnRJdGVtLnNwYWNlSW5GbG93TWF4KSB7CiAgICAgICAgaWYgKHRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCkgewogICAgICAgICAgcmVzZXRMYXN0Q2hhcnMoKTsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS5zdHIucHVzaCgiICIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCBmb250TmFtZSA9IHRleHRDb250ZW50SXRlbS5mb250TmFtZTsKICAgICAgbGV0IGhlaWdodCA9IDA7CgogICAgICBpZiAodGV4dENvbnRlbnRJdGVtLnZlcnRpY2FsKSB7CiAgICAgICAgaGVpZ2h0ID0gd2lkdGg7CiAgICAgICAgd2lkdGggPSAwOwogICAgICB9CgogICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICByZXNldExhc3RDaGFycygpOwogICAgICB0ZXh0Q29udGVudC5pdGVtcy5wdXNoKHsKICAgICAgICBzdHI6ICIgIiwKICAgICAgICBkaXI6ICJsdHIiLAogICAgICAgIHdpZHRoOiBNYXRoLmFicyh3aWR0aCksCiAgICAgICAgaGVpZ2h0OiBNYXRoLmFicyhoZWlnaHQpLAogICAgICAgIHRyYW5zZm9ybTogdHJhbnNmIHx8IGdldEN1cnJlbnRUZXh0VHJhbnNmb3JtKCksCiAgICAgICAgZm9udE5hbWUsCiAgICAgICAgaGFzRU9MOiBmYWxzZQogICAgICB9KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gZmx1c2hUZXh0Q29udGVudEl0ZW0oKSB7CiAgICAgIGlmICghdGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkIHx8ICF0ZXh0Q29udGVudEl0ZW0uc3RyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRleHRDb250ZW50SXRlbS52ZXJ0aWNhbCkgewogICAgICAgIHRleHRDb250ZW50SXRlbS50b3RhbFdpZHRoICs9IHRleHRDb250ZW50SXRlbS53aWR0aCAqIHRleHRDb250ZW50SXRlbS50ZXh0QWR2YW5jZVNjYWxlOwogICAgICB9IGVsc2UgewogICAgICAgIHRleHRDb250ZW50SXRlbS50b3RhbEhlaWdodCArPSB0ZXh0Q29udGVudEl0ZW0uaGVpZ2h0ICogdGV4dENvbnRlbnRJdGVtLnRleHRBZHZhbmNlU2NhbGU7CiAgICAgIH0KCiAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2gocnVuQmlkaVRyYW5zZm9ybSh0ZXh0Q29udGVudEl0ZW0pKTsKICAgICAgdGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgIHRleHRDb250ZW50SXRlbS5zdHIubGVuZ3RoID0gMDsKICAgIH0KCiAgICBmdW5jdGlvbiBlbnF1ZXVlQ2h1bmsoYmF0Y2ggPSBmYWxzZSkgewogICAgICBjb25zdCBsZW5ndGggPSB0ZXh0Q29udGVudC5pdGVtcy5sZW5ndGg7CgogICAgICBpZiAobGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYmF0Y2ggJiYgbGVuZ3RoIDwgVEVYVF9DSFVOS19CQVRDSF9TSVpFKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzaW5rLmVucXVldWUodGV4dENvbnRlbnQsIGxlbmd0aCk7CiAgICAgIHRleHRDb250ZW50Lml0ZW1zID0gW107CiAgICAgIHRleHRDb250ZW50LnN0eWxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogICAgY29uc3QgdGltZVNsb3RNYW5hZ2VyID0gbmV3IFRpbWVTbG90TWFuYWdlcigpOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHByb21pc2VCb2R5KHJlc29sdmUsIHJlamVjdCkgewogICAgICBjb25zdCBuZXh0ID0gZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICBlbnF1ZXVlQ2h1bmsodHJ1ZSk7CiAgICAgICAgUHJvbWlzZS5hbGwoW3Byb21pc2UsIHNpbmsucmVhZHldKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHByb21pc2VCb2R5KHJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICByZWplY3QoZXgpOwogICAgICAgICAgfQogICAgICAgIH0sIHJlamVjdCk7CiAgICAgIH07CgogICAgICB0YXNrLmVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgdGltZVNsb3RNYW5hZ2VyLnJlc2V0KCk7CiAgICAgIGNvbnN0IG9wZXJhdGlvbiA9IHt9OwogICAgICBsZXQgc3RvcCwKICAgICAgICAgIGFyZ3MgPSBbXTsKCiAgICAgIHdoaWxlICghKHN0b3AgPSB0aW1lU2xvdE1hbmFnZXIuY2hlY2soKSkpIHsKICAgICAgICBhcmdzLmxlbmd0aCA9IDA7CiAgICAgICAgb3BlcmF0aW9uLmFyZ3MgPSBhcmdzOwoKICAgICAgICBpZiAoIXByZXByb2Nlc3Nvci5yZWFkKG9wZXJhdGlvbikpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgdGV4dFN0YXRlID0gc3RhdGVNYW5hZ2VyLnN0YXRlOwogICAgICAgIGNvbnN0IGZuID0gb3BlcmF0aW9uLmZuOwogICAgICAgIGFyZ3MgPSBvcGVyYXRpb24uYXJnczsKCiAgICAgICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZvbnQ6CiAgICAgICAgICAgIHZhciBmb250TmFtZUFyZyA9IGFyZ3NbMF0ubmFtZSwKICAgICAgICAgICAgICAgIGZvbnRTaXplQXJnID0gYXJnc1sxXTsKCiAgICAgICAgICAgIGlmICh0ZXh0U3RhdGUuZm9udCAmJiBmb250TmFtZUFyZyA9PT0gdGV4dFN0YXRlLmZvbnROYW1lICYmIGZvbnRTaXplQXJnID09PSB0ZXh0U3RhdGUuZm9udFNpemUpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgICAgdGV4dFN0YXRlLmZvbnROYW1lID0gZm9udE5hbWVBcmc7CiAgICAgICAgICAgIHRleHRTdGF0ZS5mb250U2l6ZSA9IGZvbnRTaXplQXJnOwogICAgICAgICAgICBuZXh0KGhhbmRsZVNldEZvbnQoZm9udE5hbWVBcmcsIG51bGwpKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFRleHRSaXNlOgogICAgICAgICAgICB0ZXh0U3RhdGUudGV4dFJpc2UgPSBhcmdzWzBdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRIU2NhbGU6CiAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0SFNjYWxlID0gYXJnc1swXSAvIDEwMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0TGVhZGluZzoKICAgICAgICAgICAgdGV4dFN0YXRlLmxlYWRpbmcgPSBhcmdzWzBdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5tb3ZlVGV4dDoKICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRMaW5lTWF0cml4KGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgICAgICAgICB0ZXh0U3RhdGUudGV4dE1hdHJpeCA9IHRleHRTdGF0ZS50ZXh0TGluZU1hdHJpeC5zbGljZSgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRMZWFkaW5nTW92ZVRleHQ6CiAgICAgICAgICAgIHRleHRTdGF0ZS5sZWFkaW5nID0gLWFyZ3NbMV07CiAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TGluZU1hdHJpeChhcmdzWzBdLCBhcmdzWzFdKTsKICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRNYXRyaXggPSB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXguc2xpY2UoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubmV4dExpbmU6CiAgICAgICAgICAgIHRleHRTdGF0ZS5jYXJyaWFnZVJldHVybigpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRUZXh0TWF0cml4OgogICAgICAgICAgICB0ZXh0U3RhdGUuc2V0VGV4dE1hdHJpeChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdKTsKICAgICAgICAgICAgdGV4dFN0YXRlLnNldFRleHRMaW5lTWF0cml4KGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0pOwogICAgICAgICAgICB1cGRhdGVBZHZhbmNlU2NhbGUoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0Q2hhclNwYWNpbmc6CiAgICAgICAgICAgIHRleHRTdGF0ZS5jaGFyU3BhY2luZyA9IGFyZ3NbMF07CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFdvcmRTcGFjaW5nOgogICAgICAgICAgICB0ZXh0U3RhdGUud29yZFNwYWNpbmcgPSBhcmdzWzBdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpblRleHQ6CiAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0TWF0cml4ID0gX3V0aWwuSURFTlRJVFlfTUFUUklYLnNsaWNlKCk7CiAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0TGluZU1hdHJpeCA9IF91dGlsLklERU5USVRZX01BVFJJWC5zbGljZSgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93U3BhY2VkVGV4dDoKICAgICAgICAgICAgaWYgKCFzdGF0ZU1hbmFnZXIuc3RhdGUuZm9udCkgewogICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHNwYWNlRmFjdG9yID0gKHRleHRTdGF0ZS5mb250LnZlcnRpY2FsID8gMSA6IC0xKSAqIHRleHRTdGF0ZS5mb250U2l6ZSAvIDEwMDA7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gYXJnc1swXTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGVsZW1lbnRzLmxlbmd0aDsgaSA8IGlpIC0gMTsgaSsrKSB7CiAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGVsZW1lbnRzW2ldOwoKICAgICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICBzaG93U3BhY2VkVGV4dEJ1ZmZlci5wdXNoKGl0ZW0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09ICJudW1iZXIiICYmIGl0ZW0gIT09IDApIHsKICAgICAgICAgICAgICAgIGNvbnN0IHN0ciA9IHNob3dTcGFjZWRUZXh0QnVmZmVyLmpvaW4oIiIpOwogICAgICAgICAgICAgICAgc2hvd1NwYWNlZFRleHRCdWZmZXIubGVuZ3RoID0gMDsKICAgICAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKHsKICAgICAgICAgICAgICAgICAgY2hhcnM6IHN0ciwKICAgICAgICAgICAgICAgICAgZXh0cmFTcGFjaW5nOiBpdGVtICogc3BhY2VGYWN0b3IKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgaXRlbSA9IGVsZW1lbnRzLmF0KC0xKTsKCiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBzaG93U3BhY2VkVGV4dEJ1ZmZlci5wdXNoKGl0ZW0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2hvd1NwYWNlZFRleHRCdWZmZXIubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IHN0ciA9IHNob3dTcGFjZWRUZXh0QnVmZmVyLmpvaW4oIiIpOwogICAgICAgICAgICAgIHNob3dTcGFjZWRUZXh0QnVmZmVyLmxlbmd0aCA9IDA7CiAgICAgICAgICAgICAgYnVpbGRUZXh0Q29udGVudEl0ZW0oewogICAgICAgICAgICAgICAgY2hhcnM6IHN0ciwKICAgICAgICAgICAgICAgIGV4dHJhU3BhY2luZzogMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93VGV4dDoKICAgICAgICAgICAgaWYgKCFzdGF0ZU1hbmFnZXIuc3RhdGUuZm9udCkgewogICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKHsKICAgICAgICAgICAgICBjaGFyczogYXJnc1swXSwKICAgICAgICAgICAgICBleHRyYVNwYWNpbmc6IDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2hvd1RleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0ZXh0U3RhdGUuY2FycmlhZ2VSZXR1cm4oKTsKICAgICAgICAgICAgYnVpbGRUZXh0Q29udGVudEl0ZW0oewogICAgICAgICAgICAgIGNoYXJzOiBhcmdzWzBdLAogICAgICAgICAgICAgIGV4dHJhU3BhY2luZzogMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMubmV4dExpbmVTZXRTcGFjaW5nU2hvd1RleHQ6CiAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0ZXh0U3RhdGUud29yZFNwYWNpbmcgPSBhcmdzWzBdOwogICAgICAgICAgICB0ZXh0U3RhdGUuY2hhclNwYWNpbmcgPSBhcmdzWzFdOwogICAgICAgICAgICB0ZXh0U3RhdGUuY2FycmlhZ2VSZXR1cm4oKTsKICAgICAgICAgICAgYnVpbGRUZXh0Q29udGVudEl0ZW0oewogICAgICAgICAgICAgIGNoYXJzOiBhcmdzWzJdLAogICAgICAgICAgICAgIGV4dHJhU3BhY2luZzogMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRYT2JqZWN0OgogICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwoKICAgICAgICAgICAgaWYgKCF4b2JqcykgewogICAgICAgICAgICAgIHhvYmpzID0gcmVzb3VyY2VzLmdldCgiWE9iamVjdCIpIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc1ZhbGlkTmFtZSA9IGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lOwogICAgICAgICAgICB2YXIgbmFtZSA9IGFyZ3NbMF0ubmFtZTsKCiAgICAgICAgICAgIGlmIChpc1ZhbGlkTmFtZSAmJiBlbXB0eVhPYmplY3RDYWNoZS5nZXRCeU5hbWUobmFtZSkpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dChuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZVhPYmplY3QsIHJlamVjdFhPYmplY3QpIHsKICAgICAgICAgICAgICBpZiAoIWlzVmFsaWROYW1lKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlhPYmplY3QgbXVzdCBiZSByZWZlcnJlZCB0byBieSBuYW1lLiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbGV0IHhvYmogPSB4b2Jqcy5nZXRSYXcobmFtZSk7CgogICAgICAgICAgICAgIGlmICh4b2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgICAgICBpZiAoZW1wdHlYT2JqZWN0Q2FjaGUuZ2V0QnlSZWYoeG9iaikpIHsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGdsb2JhbEltYWdlID0gc2VsZi5nbG9iYWxJbWFnZUNhY2hlLmdldERhdGEoeG9iaiwgc2VsZi5wYWdlSW5kZXgpOwoKICAgICAgICAgICAgICAgIGlmIChnbG9iYWxJbWFnZSkgewogICAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgeG9iaiA9IHhyZWYuZmV0Y2goeG9iaik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoISh4b2JqIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlhPYmplY3Qgc2hvdWxkIGJlIGEgc3RyZWFtIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCB0eXBlID0geG9iai5kaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgICAgICAgICBpZiAoISh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBzaG91bGQgaGF2ZSBhIE5hbWUgc3VidHlwZSIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHR5cGUubmFtZSAhPT0gIkZvcm0iKSB7CiAgICAgICAgICAgICAgICBlbXB0eVhPYmplY3RDYWNoZS5zZXQobmFtZSwgeG9iai5kaWN0Lm9iaklkLCB0cnVlKTsKICAgICAgICAgICAgICAgIHJlc29sdmVYT2JqZWN0KCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBjdXJyZW50U3RhdGUgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuY2xvbmUoKTsKICAgICAgICAgICAgICBjb25zdCB4T2JqU3RhdGVNYW5hZ2VyID0gbmV3IFN0YXRlTWFuYWdlcihjdXJyZW50U3RhdGUpOwogICAgICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHhvYmouZGljdC5nZXRBcnJheSgiTWF0cml4Iik7CgogICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1hdHJpeCkgJiYgbWF0cml4Lmxlbmd0aCA9PT0gNikgewogICAgICAgICAgICAgICAgeE9ialN0YXRlTWFuYWdlci50cmFuc2Zvcm0obWF0cml4KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGVucXVldWVDaHVuaygpOwogICAgICAgICAgICAgIGNvbnN0IHNpbmtXcmFwcGVyID0gewogICAgICAgICAgICAgICAgZW5xdWV1ZUludm9rZWQ6IGZhbHNlLAoKICAgICAgICAgICAgICAgIGVucXVldWUoY2h1bmssIHNpemUpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5lbnF1ZXVlSW52b2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIHNpbmsuZW5xdWV1ZShjaHVuaywgc2l6ZSk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIGdldCBkZXNpcmVkU2l6ZSgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpbmsuZGVzaXJlZFNpemU7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIGdldCByZWFkeSgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpbmsucmVhZHk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgc2VsZi5nZXRUZXh0Q29udGVudCh7CiAgICAgICAgICAgICAgICBzdHJlYW06IHhvYmosCiAgICAgICAgICAgICAgICB0YXNrLAogICAgICAgICAgICAgICAgcmVzb3VyY2VzOiB4b2JqLmRpY3QuZ2V0KCJSZXNvdXJjZXMiKSB8fCByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXI6IHhPYmpTdGF0ZU1hbmFnZXIsCiAgICAgICAgICAgICAgICBjb21iaW5lVGV4dEl0ZW1zLAogICAgICAgICAgICAgICAgaW5jbHVkZU1hcmtlZENvbnRlbnQsCiAgICAgICAgICAgICAgICBzaW5rOiBzaW5rV3JhcHBlciwKICAgICAgICAgICAgICAgIHNlZW5TdHlsZXMsCiAgICAgICAgICAgICAgICB2aWV3Qm94CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoIXNpbmtXcmFwcGVyLmVucXVldWVJbnZva2VkKSB7CiAgICAgICAgICAgICAgICAgIGVtcHR5WE9iamVjdENhY2hlLnNldChuYW1lLCB4b2JqLmRpY3Qub2JqSWQsIHRydWUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJlc29sdmVYT2JqZWN0KCk7CiAgICAgICAgICAgICAgfSwgcmVqZWN0WE9iamVjdCk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGdldFRleHRDb250ZW50IC0gaWdub3JpbmcgWE9iamVjdDogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aHJvdyByZWFzb247CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEdTdGF0ZToKICAgICAgICAgICAgaXNWYWxpZE5hbWUgPSBhcmdzWzBdIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZTsKICAgICAgICAgICAgbmFtZSA9IGFyZ3NbMF0ubmFtZTsKCiAgICAgICAgICAgIGlmIChpc1ZhbGlkTmFtZSAmJiBlbXB0eUdTdGF0ZUNhY2hlLmdldEJ5TmFtZShuYW1lKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlR1N0YXRlLCByZWplY3RHU3RhdGUpIHsKICAgICAgICAgICAgICBpZiAoIWlzVmFsaWROYW1lKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkdTdGF0ZSBtdXN0IGJlIHJlZmVycmVkIHRvIGJ5IG5hbWUuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBleHRHU3RhdGUgPSByZXNvdXJjZXMuZ2V0KCJFeHRHU3RhdGUiKTsKCiAgICAgICAgICAgICAgaWYgKCEoZXh0R1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRXh0R1N0YXRlIHNob3VsZCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBnU3RhdGUgPSBleHRHU3RhdGUuZ2V0KG5hbWUpOwoKICAgICAgICAgICAgICBpZiAoIShnU3RhdGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJHU3RhdGUgc2hvdWxkIGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IGdTdGF0ZUZvbnQgPSBnU3RhdGUuZ2V0KCJGb250Iik7CgogICAgICAgICAgICAgIGlmICghZ1N0YXRlRm9udCkgewogICAgICAgICAgICAgICAgZW1wdHlHU3RhdGVDYWNoZS5zZXQobmFtZSwgZ1N0YXRlLm9iaklkLCB0cnVlKTsKICAgICAgICAgICAgICAgIHJlc29sdmVHU3RhdGUoKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLmZvbnROYW1lID0gbnVsbDsKICAgICAgICAgICAgICB0ZXh0U3RhdGUuZm9udFNpemUgPSBnU3RhdGVGb250WzFdOwogICAgICAgICAgICAgIGhhbmRsZVNldEZvbnQobnVsbCwgZ1N0YXRlRm9udFswXSkudGhlbihyZXNvbHZlR1N0YXRlLCByZWplY3RHU3RhdGUpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBnZXRUZXh0Q29udGVudCAtIGlnbm9yaW5nIEV4dEdTdGF0ZTogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aHJvdyByZWFzb247CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudDoKICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKCiAgICAgICAgICAgIGlmIChpbmNsdWRlTWFya2VkQ29udGVudCkgewogICAgICAgICAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2goewogICAgICAgICAgICAgICAgdHlwZTogImJlZ2luTWFya2VkQ29udGVudCIsCiAgICAgICAgICAgICAgICB0YWc6IGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gYXJnc1swXS5uYW1lIDogbnVsbAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wczoKICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKCiAgICAgICAgICAgIGlmIChpbmNsdWRlTWFya2VkQ29udGVudCkgewogICAgICAgICAgICAgIGxldCBtY2lkID0gbnVsbDsKCiAgICAgICAgICAgICAgaWYgKGFyZ3NbMV0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgICAgICBtY2lkID0gYXJnc1sxXS5nZXQoIk1DSUQiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2goewogICAgICAgICAgICAgICAgdHlwZTogImJlZ2luTWFya2VkQ29udGVudFByb3BzIiwKICAgICAgICAgICAgICAgIGlkOiBOdW1iZXIuaXNJbnRlZ2VyKG1jaWQpID8gYCR7c2VsZi5pZEZhY3RvcnkuZ2V0UGFnZU9iaklkKCl9X21jaWQke21jaWR9YCA6IG51bGwsCiAgICAgICAgICAgICAgICB0YWc6IGFyZ3NbMF0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gYXJnc1swXS5uYW1lIDogbnVsbAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRNYXJrZWRDb250ZW50OgogICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwoKICAgICAgICAgICAgaWYgKGluY2x1ZGVNYXJrZWRDb250ZW50KSB7CiAgICAgICAgICAgICAgdGV4dENvbnRlbnQuaXRlbXMucHVzaCh7CiAgICAgICAgICAgICAgICB0eXBlOiAiZW5kTWFya2VkQ29udGVudCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAodGV4dENvbnRlbnQuaXRlbXMubGVuZ3RoID49IHNpbmsuZGVzaXJlZFNpemUpIHsKICAgICAgICAgIHN0b3AgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoc3RvcCkgewogICAgICAgIG5leHQoZGVmZXJyZWQpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgZW5xdWV1ZUNodW5rKCk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pLmNhdGNoKHJlYXNvbiA9PiB7CiAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYGdldFRleHRDb250ZW50IC0gaWdub3JpbmcgZXJyb3JzIGR1cmluZyAiJHt0YXNrLm5hbWV9IiBgICsgYHRhc2s6ICIke3JlYXNvbn0iLmApOwogICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgZW5xdWV1ZUNodW5rKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aHJvdyByZWFzb247CiAgICB9KTsKICB9CgogIGV4dHJhY3REYXRhU3RydWN0dXJlcyhkaWN0LCBiYXNlRGljdCwgcHJvcGVydGllcykgewogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZjsKICAgIGxldCBjaWRUb0dpZEJ5dGVzOwogICAgY29uc3QgdG9Vbmljb2RlUHJvbWlzZSA9IHRoaXMucmVhZFRvVW5pY29kZShwcm9wZXJ0aWVzLnRvVW5pY29kZSB8fCBkaWN0LmdldCgiVG9Vbmljb2RlIikgfHwgYmFzZURpY3QuZ2V0KCJUb1VuaWNvZGUiKSk7CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgIGNvbnN0IGNpZFN5c3RlbUluZm8gPSBkaWN0LmdldCgiQ0lEU3lzdGVtSW5mbyIpOwoKICAgICAgaWYgKGNpZFN5c3RlbUluZm8gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvID0gewogICAgICAgICAgcmVnaXN0cnk6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY2lkU3lzdGVtSW5mby5nZXQoIlJlZ2lzdHJ5IikpLAogICAgICAgICAgb3JkZXJpbmc6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY2lkU3lzdGVtSW5mby5nZXQoIk9yZGVyaW5nIikpLAogICAgICAgICAgc3VwcGxlbWVudDogY2lkU3lzdGVtSW5mby5nZXQoIlN1cHBsZW1lbnQiKQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgY2lkVG9HaWRNYXAgPSBkaWN0LmdldCgiQ0lEVG9HSURNYXAiKTsKCiAgICAgICAgaWYgKGNpZFRvR2lkTWFwIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICAgIGNpZFRvR2lkQnl0ZXMgPSBjaWRUb0dpZE1hcC5nZXRCeXRlcygpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgIHRocm93IGV4OwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBleHRyYWN0RGF0YVN0cnVjdHVyZXMgLSBpZ25vcmluZyBDSURUb0dJRE1hcCBkYXRhOiAiJHtleH0iLmApOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZGlmZmVyZW5jZXMgPSBbXTsKICAgIGxldCBiYXNlRW5jb2RpbmdOYW1lID0gbnVsbDsKICAgIGxldCBlbmNvZGluZzsKCiAgICBpZiAoZGljdC5oYXMoIkVuY29kaW5nIikpIHsKICAgICAgZW5jb2RpbmcgPSBkaWN0LmdldCgiRW5jb2RpbmciKTsKCiAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gZW5jb2RpbmcuZ2V0KCJCYXNlRW5jb2RpbmciKTsKICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gYmFzZUVuY29kaW5nTmFtZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUgPyBiYXNlRW5jb2RpbmdOYW1lLm5hbWUgOiBudWxsOwoKICAgICAgICBpZiAoZW5jb2RpbmcuaGFzKCJEaWZmZXJlbmNlcyIpKSB7CiAgICAgICAgICBjb25zdCBkaWZmRW5jb2RpbmcgPSBlbmNvZGluZy5nZXQoIkRpZmZlcmVuY2VzIik7CiAgICAgICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IGRpZmZFbmNvZGluZy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB4cmVmLmZldGNoSWZSZWYoZGlmZkVuY29kaW5nW2pdKTsKCiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gIm51bWJlciIpIHsKICAgICAgICAgICAgICBpbmRleCA9IGRhdGE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICBkaWZmZXJlbmNlc1tpbmRleCsrXSA9IGRhdGEubmFtZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZW50cnkgaW4gJ0RpZmZlcmVuY2VzJyBhcnJheTogJHtkYXRhfWApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGVuY29kaW5nIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIGJhc2VFbmNvZGluZ05hbWUgPSBlbmNvZGluZy5uYW1lOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IG1zZyA9ICJFbmNvZGluZyBpcyBub3QgYSBOYW1lIG5vciBhIERpY3QiOwoKICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihtc2cpOwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKG1zZyk7CiAgICAgIH0KCiAgICAgIGlmIChiYXNlRW5jb2RpbmdOYW1lICE9PSAiTWFjUm9tYW5FbmNvZGluZyIgJiYgYmFzZUVuY29kaW5nTmFtZSAhPT0gIk1hY0V4cGVydEVuY29kaW5nIiAmJiBiYXNlRW5jb2RpbmdOYW1lICE9PSAiV2luQW5zaUVuY29kaW5nIikgewogICAgICAgIGJhc2VFbmNvZGluZ05hbWUgPSBudWxsOwogICAgICB9CiAgICB9CgogICAgaWYgKGJhc2VFbmNvZGluZ05hbWUpIHsKICAgICAgcHJvcGVydGllcy5kZWZhdWx0RW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykoYmFzZUVuY29kaW5nTmFtZSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBpc1N5bWJvbGljRm9udCA9ICEhKHByb3BlcnRpZXMuZmxhZ3MgJiBfZm9udHNfdXRpbHMuRm9udEZsYWdzLlN5bWJvbGljKTsKICAgICAgY29uc3QgaXNOb25zeW1ib2xpY0ZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5Ob25zeW1ib2xpYyk7CiAgICAgIGVuY29kaW5nID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nOwoKICAgICAgaWYgKHByb3BlcnRpZXMudHlwZSA9PT0gIlRydWVUeXBlIiAmJiAhaXNOb25zeW1ib2xpY0ZvbnQpIHsKICAgICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuV2luQW5zaUVuY29kaW5nOwogICAgICB9CgogICAgICBpZiAoaXNTeW1ib2xpY0ZvbnQpIHsKICAgICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuTWFjUm9tYW5FbmNvZGluZzsKCiAgICAgICAgaWYgKCFwcm9wZXJ0aWVzLmZpbGUgfHwgcHJvcGVydGllcy5pc0ludGVybmFsRm9udCkgewogICAgICAgICAgaWYgKC9TeW1ib2wvaS50ZXN0KHByb3BlcnRpZXMubmFtZSkpIHsKICAgICAgICAgICAgZW5jb2RpbmcgPSBfZW5jb2RpbmdzLlN5bWJvbFNldEVuY29kaW5nOwogICAgICAgICAgfSBlbHNlIGlmICgvRGluZ2JhdHN8V2luZ2RpbmdzL2kudGVzdChwcm9wZXJ0aWVzLm5hbWUpKSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gX2VuY29kaW5ncy5aYXBmRGluZ2JhdHNFbmNvZGluZzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICB9CgogICAgcHJvcGVydGllcy5kaWZmZXJlbmNlcyA9IGRpZmZlcmVuY2VzOwogICAgcHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lID0gYmFzZUVuY29kaW5nTmFtZTsKICAgIHByb3BlcnRpZXMuaGFzRW5jb2RpbmcgPSAhIWJhc2VFbmNvZGluZ05hbWUgfHwgZGlmZmVyZW5jZXMubGVuZ3RoID4gMDsKICAgIHByb3BlcnRpZXMuZGljdCA9IGRpY3Q7CiAgICByZXR1cm4gdG9Vbmljb2RlUHJvbWlzZS50aGVuKHJlYWRUb1VuaWNvZGUgPT4gewogICAgICBwcm9wZXJ0aWVzLnRvVW5pY29kZSA9IHJlYWRUb1VuaWNvZGU7CiAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9Vbmljb2RlKHByb3BlcnRpZXMpOwogICAgfSkudGhlbihidWlsdFRvVW5pY29kZSA9PiB7CiAgICAgIHByb3BlcnRpZXMudG9Vbmljb2RlID0gYnVpbHRUb1VuaWNvZGU7CgogICAgICBpZiAoY2lkVG9HaWRCeXRlcykgewogICAgICAgIHByb3BlcnRpZXMuY2lkVG9HaWRNYXAgPSB0aGlzLnJlYWRDaWRUb0dpZE1hcChjaWRUb0dpZEJ5dGVzLCBidWlsdFRvVW5pY29kZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwogICAgfSk7CiAgfQoKICBfc2ltcGxlRm9udFRvVW5pY29kZShwcm9wZXJ0aWVzLCBmb3JjZUdseXBocyA9IGZhbHNlKSB7CiAgICAoMCwgX3V0aWwuYXNzZXJ0KSghcHJvcGVydGllcy5jb21wb3NpdGUsICJNdXN0IGJlIGEgc2ltcGxlIGZvbnQuIik7CiAgICBjb25zdCB0b1VuaWNvZGUgPSBbXTsKICAgIGNvbnN0IGVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmcuc2xpY2UoKTsKICAgIGNvbnN0IGJhc2VFbmNvZGluZ05hbWUgPSBwcm9wZXJ0aWVzLmJhc2VFbmNvZGluZ05hbWU7CiAgICBjb25zdCBkaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXM7CgogICAgZm9yIChjb25zdCBjaGFyY29kZSBpbiBkaWZmZXJlbmNlcykgewogICAgICBjb25zdCBnbHlwaE5hbWUgPSBkaWZmZXJlbmNlc1tjaGFyY29kZV07CgogICAgICBpZiAoZ2x5cGhOYW1lID09PSAiLm5vdGRlZiIpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZW5jb2RpbmdbY2hhcmNvZGVdID0gZ2x5cGhOYW1lOwogICAgfQoKICAgIGNvbnN0IGdseXBoc1VuaWNvZGVNYXAgPSAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwoKICAgIGZvciAoY29uc3QgY2hhcmNvZGUgaW4gZW5jb2RpbmcpIHsKICAgICAgbGV0IGdseXBoTmFtZSA9IGVuY29kaW5nW2NoYXJjb2RlXTsKCiAgICAgIGlmIChnbHlwaE5hbWUgPT09ICIiKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSBpZiAoZ2x5cGhzVW5pY29kZU1hcFtnbHlwaE5hbWVdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBsZXQgY29kZSA9IDA7CgogICAgICAgIHN3aXRjaCAoZ2x5cGhOYW1lWzBdKSB7CiAgICAgICAgICBjYXNlICJHIjoKICAgICAgICAgICAgaWYgKGdseXBoTmFtZS5sZW5ndGggPT09IDMpIHsKICAgICAgICAgICAgICBjb2RlID0gcGFyc2VJbnQoZ2x5cGhOYW1lLnN1YnN0cmluZygxKSwgMTYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJnIjoKICAgICAgICAgICAgaWYgKGdseXBoTmFtZS5sZW5ndGggPT09IDUpIHsKICAgICAgICAgICAgICBjb2RlID0gcGFyc2VJbnQoZ2x5cGhOYW1lLnN1YnN0cmluZygxKSwgMTYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJDIjoKICAgICAgICAgIGNhc2UgImMiOgogICAgICAgICAgICBpZiAoZ2x5cGhOYW1lLmxlbmd0aCA+PSAzICYmIGdseXBoTmFtZS5sZW5ndGggPD0gNCkgewogICAgICAgICAgICAgIGNvbnN0IGNvZGVTdHIgPSBnbHlwaE5hbWUuc3Vic3RyaW5nKDEpOwoKICAgICAgICAgICAgICBpZiAoZm9yY2VHbHlwaHMpIHsKICAgICAgICAgICAgICAgIGNvZGUgPSBwYXJzZUludChjb2RlU3RyLCAxNik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvZGUgPSArY29kZVN0cjsKCiAgICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihjb2RlKSAmJiBOdW1iZXIuaXNJbnRlZ2VyKHBhcnNlSW50KGNvZGVTdHIsIDE2KSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zaW1wbGVGb250VG9Vbmljb2RlKHByb3BlcnRpZXMsIHRydWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgY29uc3QgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKGdseXBoTmFtZSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgICAgICAgICBpZiAodW5pY29kZSAhPT0gLTEpIHsKICAgICAgICAgICAgICBjb2RlID0gdW5pY29kZTsKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgICAgIGlmIChjb2RlID4gMCAmJiBjb2RlIDw9IDB4MTBmZmZmICYmIE51bWJlci5pc0ludGVnZXIoY29kZSkpIHsKICAgICAgICAgIGlmIChiYXNlRW5jb2RpbmdOYW1lICYmIGNvZGUgPT09ICtjaGFyY29kZSkgewogICAgICAgICAgICBjb25zdCBiYXNlRW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykoYmFzZUVuY29kaW5nTmFtZSk7CgogICAgICAgICAgICBpZiAoYmFzZUVuY29kaW5nICYmIChnbHlwaE5hbWUgPSBiYXNlRW5jb2RpbmdbY2hhcmNvZGVdKSkgewogICAgICAgICAgICAgIHRvVW5pY29kZVtjaGFyY29kZV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGdseXBoc1VuaWNvZGVNYXBbZ2x5cGhOYW1lXSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0b1VuaWNvZGVbY2hhcmNvZGVdID0gU3RyaW5nLmZyb21Db2RlUG9pbnQoY29kZSk7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdG9Vbmljb2RlW2NoYXJjb2RlXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZ2x5cGhzVW5pY29kZU1hcFtnbHlwaE5hbWVdKTsKICAgIH0KCiAgICByZXR1cm4gdG9Vbmljb2RlOwogIH0KCiAgYXN5bmMgYnVpbGRUb1VuaWNvZGUocHJvcGVydGllcykgewogICAgcHJvcGVydGllcy5oYXNJbmNsdWRlZFRvVW5pY29kZU1hcCA9ICEhcHJvcGVydGllcy50b1VuaWNvZGUgJiYgcHJvcGVydGllcy50b1VuaWNvZGUubGVuZ3RoID4gMDsKCiAgICBpZiAocHJvcGVydGllcy5oYXNJbmNsdWRlZFRvVW5pY29kZU1hcCkgewogICAgICBpZiAoIXByb3BlcnRpZXMuY29tcG9zaXRlICYmIHByb3BlcnRpZXMuaGFzRW5jb2RpbmcpIHsKICAgICAgICBwcm9wZXJ0aWVzLmZhbGxiYWNrVG9Vbmljb2RlID0gdGhpcy5fc2ltcGxlRm9udFRvVW5pY29kZShwcm9wZXJ0aWVzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHByb3BlcnRpZXMudG9Vbmljb2RlOwogICAgfQoKICAgIGlmICghcHJvcGVydGllcy5jb21wb3NpdGUpIHsKICAgICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuVG9Vbmljb2RlTWFwKHRoaXMuX3NpbXBsZUZvbnRUb1VuaWNvZGUocHJvcGVydGllcykpOwogICAgfQoKICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSAmJiAocHJvcGVydGllcy5jTWFwLmJ1aWx0SW5DTWFwICYmICEocHJvcGVydGllcy5jTWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ucmVnaXN0cnkgPT09ICJBZG9iZSIgJiYgKHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mby5vcmRlcmluZyA9PT0gIkdCMSIgfHwgcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nID09PSAiQ05TMSIgfHwgcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nID09PSAiSmFwYW4xIiB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ub3JkZXJpbmcgPT09ICJLb3JlYTEiKSkpIHsKICAgICAgY29uc3QgewogICAgICAgIHJlZ2lzdHJ5LAogICAgICAgIG9yZGVyaW5nCiAgICAgIH0gPSBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm87CgogICAgICBjb25zdCB1Y3MyQ01hcE5hbWUgPSBfcHJpbWl0aXZlcy5OYW1lLmdldChgJHtyZWdpc3RyeX0tJHtvcmRlcmluZ30tVUNTMmApOwoKICAgICAgY29uc3QgdWNzMkNNYXAgPSBhd2FpdCBfY21hcC5DTWFwRmFjdG9yeS5jcmVhdGUoewogICAgICAgIGVuY29kaW5nOiB1Y3MyQ01hcE5hbWUsCiAgICAgICAgZmV0Y2hCdWlsdEluQ01hcDogdGhpcy5fZmV0Y2hCdWlsdEluQ01hcEJvdW5kLAogICAgICAgIHVzZUNNYXA6IG51bGwKICAgICAgfSk7CiAgICAgIGNvbnN0IHRvVW5pY29kZSA9IFtdOwogICAgICBwcm9wZXJ0aWVzLmNNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhcmNvZGUsIGNpZCkgewogICAgICAgIGlmIChjaWQgPiAweGZmZmYpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWF4IHNpemUgb2YgQ0lEIGlzIDY1LDUzNSIpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdWNzMiA9IHVjczJDTWFwLmxvb2t1cChjaWQpOwoKICAgICAgICBpZiAodWNzMikgewogICAgICAgICAgdG9Vbmljb2RlW2NoYXJjb2RlXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKHVjczIuY2hhckNvZGVBdCgwKSA8PCA4KSArIHVjczIuY2hhckNvZGVBdCgxKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuVG9Vbmljb2RlTWFwKHRvVW5pY29kZSk7CiAgICB9CgogICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXAocHJvcGVydGllcy5maXJzdENoYXIsIHByb3BlcnRpZXMubGFzdENoYXIpOwogIH0KCiAgcmVhZFRvVW5pY29kZShjbWFwT2JqKSB7CiAgICBpZiAoIWNtYXBPYmopIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTsKICAgIH0KCiAgICBpZiAoY21hcE9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgcmV0dXJuIF9jbWFwLkNNYXBGYWN0b3J5LmNyZWF0ZSh7CiAgICAgICAgZW5jb2Rpbmc6IGNtYXBPYmosCiAgICAgICAgZmV0Y2hCdWlsdEluQ01hcDogdGhpcy5fZmV0Y2hCdWlsdEluQ01hcEJvdW5kLAogICAgICAgIHVzZUNNYXA6IG51bGwKICAgICAgfSkudGhlbihmdW5jdGlvbiAoY21hcCkgewogICAgICAgIGlmIChjbWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB7CiAgICAgICAgICByZXR1cm4gbmV3IF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCgwLCAweGZmZmYpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuVG9Vbmljb2RlTWFwKGNtYXAuZ2V0TWFwKCkpOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoY21hcE9iaiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgIHJldHVybiBfY21hcC5DTWFwRmFjdG9yeS5jcmVhdGUoewogICAgICAgIGVuY29kaW5nOiBjbWFwT2JqLAogICAgICAgIGZldGNoQnVpbHRJbkNNYXA6IHRoaXMuX2ZldGNoQnVpbHRJbkNNYXBCb3VuZCwKICAgICAgICB1c2VDTWFwOiBudWxsCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNtYXApIHsKICAgICAgICBpZiAoY21hcCBpbnN0YW5jZW9mIF9jbWFwLklkZW50aXR5Q01hcCkgewogICAgICAgICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXAoMCwgMHhmZmZmKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG1hcCA9IG5ldyBBcnJheShjbWFwLmxlbmd0aCk7CiAgICAgICAgY21hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyQ29kZSwgdG9rZW4pIHsKICAgICAgICAgIGlmICh0eXBlb2YgdG9rZW4gPT09ICJudW1iZXIiKSB7CiAgICAgICAgICAgIG1hcFtjaGFyQ29kZV0gPSBTdHJpbmcuZnJvbUNvZGVQb2ludCh0b2tlbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBzdHIgPSBbXTsKCiAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHRva2VuLmxlbmd0aDsgayArPSAyKSB7CiAgICAgICAgICAgIGNvbnN0IHcxID0gdG9rZW4uY2hhckNvZGVBdChrKSA8PCA4IHwgdG9rZW4uY2hhckNvZGVBdChrICsgMSk7CgogICAgICAgICAgICBpZiAoKHcxICYgMHhmODAwKSAhPT0gMHhkODAwKSB7CiAgICAgICAgICAgICAgc3RyLnB1c2godzEpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBrICs9IDI7CiAgICAgICAgICAgIGNvbnN0IHcyID0gdG9rZW4uY2hhckNvZGVBdChrKSA8PCA4IHwgdG9rZW4uY2hhckNvZGVBdChrICsgMSk7CiAgICAgICAgICAgIHN0ci5wdXNoKCgodzEgJiAweDNmZikgPDwgMTApICsgKHcyICYgMHgzZmYpICsgMHgxMDAwMCk7CiAgICAgICAgICB9CgogICAgICAgICAgbWFwW2NoYXJDb2RlXSA9IFN0cmluZy5mcm9tQ29kZVBvaW50KC4uLnN0cik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG5ldyBfdG9fdW5pY29kZV9tYXAuVG9Vbmljb2RlTWFwKG1hcCk7CiAgICAgIH0sIHJlYXNvbiA9PiB7CiAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yRm9udFRvVW5pY29kZQogICAgICAgICAgfSk7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYHJlYWRUb1VuaWNvZGUgLSBpZ25vcmluZyBUb1VuaWNvZGUgZGF0YTogIiR7cmVhc29ufSIuYCk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTsKICB9CgogIHJlYWRDaWRUb0dpZE1hcChnbHlwaHNEYXRhLCB0b1VuaWNvZGUpIHsKICAgIGNvbnN0IHJlc3VsdCA9IFtdOwoKICAgIGZvciAobGV0IGogPSAwLCBqaiA9IGdseXBoc0RhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBjb25zdCBnbHlwaElEID0gZ2x5cGhzRGF0YVtqKytdIDw8IDggfCBnbHlwaHNEYXRhW2pdOwogICAgICBjb25zdCBjb2RlID0gaiA+PiAxOwoKICAgICAgaWYgKGdseXBoSUQgPT09IDAgJiYgIXRvVW5pY29kZS5oYXMoY29kZSkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgcmVzdWx0W2NvZGVdID0gZ2x5cGhJRDsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgZXh0cmFjdFdpZHRocyhkaWN0LCBkZXNjcmlwdG9yLCBwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmOwogICAgbGV0IGdseXBoc1dpZHRocyA9IFtdOwogICAgbGV0IGRlZmF1bHRXaWR0aCA9IDA7CiAgICBjb25zdCBnbHlwaHNWTWV0cmljcyA9IFtdOwogICAgbGV0IGRlZmF1bHRWTWV0cmljczsKICAgIGxldCBpLCBpaSwgaiwgamosIHN0YXJ0LCBjb2RlLCB3aWR0aHM7CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgIGRlZmF1bHRXaWR0aCA9IGRpY3QuaGFzKCJEVyIpID8gZGljdC5nZXQoIkRXIikgOiAxMDAwOwogICAgICB3aWR0aHMgPSBkaWN0LmdldCgiVyIpOwoKICAgICAgaWYgKHdpZHRocykgewogICAgICAgIGZvciAoaSA9IDAsIGlpID0gd2lkdGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIHN0YXJ0ID0geHJlZi5mZXRjaElmUmVmKHdpZHRoc1tpKytdKTsKICAgICAgICAgIGNvZGUgPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzW2ldKTsKCiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2RlKSkgewogICAgICAgICAgICBmb3IgKGogPSAwLCBqaiA9IGNvZGUubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgICAgIGdseXBoc1dpZHRoc1tzdGFydCsrXSA9IHhyZWYuZmV0Y2hJZlJlZihjb2RlW2pdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3Qgd2lkdGggPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzWysraV0pOwoKICAgICAgICAgICAgZm9yIChqID0gc3RhcnQ7IGogPD0gY29kZTsgaisrKSB7CiAgICAgICAgICAgICAgZ2x5cGhzV2lkdGhzW2pdID0gd2lkdGg7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwcm9wZXJ0aWVzLnZlcnRpY2FsKSB7CiAgICAgICAgbGV0IHZtZXRyaWNzID0gZGljdC5nZXRBcnJheSgiRFcyIikgfHwgWzg4MCwgLTEwMDBdOwogICAgICAgIGRlZmF1bHRWTWV0cmljcyA9IFt2bWV0cmljc1sxXSwgZGVmYXVsdFdpZHRoICogMC41LCB2bWV0cmljc1swXV07CiAgICAgICAgdm1ldHJpY3MgPSBkaWN0LmdldCgiVzIiKTsKCiAgICAgICAgaWYgKHZtZXRyaWNzKSB7CiAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHZtZXRyaWNzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgc3RhcnQgPSB4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbaSsrXSk7CiAgICAgICAgICAgIGNvZGUgPSB4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbaV0pOwoKICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29kZSkpIHsKICAgICAgICAgICAgICBmb3IgKGogPSAwLCBqaiA9IGNvZGUubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgICAgICAgZ2x5cGhzVk1ldHJpY3Nbc3RhcnQrK10gPSBbeHJlZi5mZXRjaElmUmVmKGNvZGVbaisrXSksIHhyZWYuZmV0Y2hJZlJlZihjb2RlW2orK10pLCB4cmVmLmZldGNoSWZSZWYoY29kZVtqXSldOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCB2bWV0cmljID0gW3hyZWYuZmV0Y2hJZlJlZih2bWV0cmljc1srK2ldKSwgeHJlZi5mZXRjaElmUmVmKHZtZXRyaWNzWysraV0pLCB4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbKytpXSldOwoKICAgICAgICAgICAgICBmb3IgKGogPSBzdGFydDsgaiA8PSBjb2RlOyBqKyspIHsKICAgICAgICAgICAgICAgIGdseXBoc1ZNZXRyaWNzW2pdID0gdm1ldHJpYzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGZpcnN0Q2hhciA9IHByb3BlcnRpZXMuZmlyc3RDaGFyOwogICAgICB3aWR0aHMgPSBkaWN0LmdldCgiV2lkdGhzIik7CgogICAgICBpZiAod2lkdGhzKSB7CiAgICAgICAgaiA9IGZpcnN0Q2hhcjsKCiAgICAgICAgZm9yIChpID0gMCwgaWkgPSB3aWR0aHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgZ2x5cGhzV2lkdGhzW2orK10gPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzW2ldKTsKICAgICAgICB9CgogICAgICAgIGRlZmF1bHRXaWR0aCA9IHBhcnNlRmxvYXQoZGVzY3JpcHRvci5nZXQoIk1pc3NpbmdXaWR0aCIpKSB8fCAwOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGJhc2VGb250TmFtZSA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgICAgICBpZiAoYmFzZUZvbnROYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgY29uc3QgbWV0cmljcyA9IHRoaXMuZ2V0QmFzZUZvbnRNZXRyaWNzKGJhc2VGb250TmFtZS5uYW1lKTsKICAgICAgICAgIGdseXBoc1dpZHRocyA9IHRoaXMuYnVpbGRDaGFyQ29kZVRvV2lkdGgobWV0cmljcy53aWR0aHMsIHByb3BlcnRpZXMpOwogICAgICAgICAgZGVmYXVsdFdpZHRoID0gbWV0cmljcy5kZWZhdWx0V2lkdGg7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbGV0IGlzTW9ub3NwYWNlID0gdHJ1ZTsKICAgIGxldCBmaXJzdFdpZHRoID0gZGVmYXVsdFdpZHRoOwoKICAgIGZvciAoY29uc3QgZ2x5cGggaW4gZ2x5cGhzV2lkdGhzKSB7CiAgICAgIGNvbnN0IGdseXBoV2lkdGggPSBnbHlwaHNXaWR0aHNbZ2x5cGhdOwoKICAgICAgaWYgKCFnbHlwaFdpZHRoKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghZmlyc3RXaWR0aCkgewogICAgICAgIGZpcnN0V2lkdGggPSBnbHlwaFdpZHRoOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoZmlyc3RXaWR0aCAhPT0gZ2x5cGhXaWR0aCkgewogICAgICAgIGlzTW9ub3NwYWNlID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaXNNb25vc3BhY2UpIHsKICAgICAgcHJvcGVydGllcy5mbGFncyB8PSBfZm9udHNfdXRpbHMuRm9udEZsYWdzLkZpeGVkUGl0Y2g7CiAgICB9CgogICAgcHJvcGVydGllcy5kZWZhdWx0V2lkdGggPSBkZWZhdWx0V2lkdGg7CiAgICBwcm9wZXJ0aWVzLndpZHRocyA9IGdseXBoc1dpZHRoczsKICAgIHByb3BlcnRpZXMuZGVmYXVsdFZNZXRyaWNzID0gZGVmYXVsdFZNZXRyaWNzOwogICAgcHJvcGVydGllcy52bWV0cmljcyA9IGdseXBoc1ZNZXRyaWNzOwogIH0KCiAgaXNTZXJpZkZvbnQoYmFzZUZvbnROYW1lKSB7CiAgICBjb25zdCBmb250TmFtZVdvU3R5bGUgPSBiYXNlRm9udE5hbWUuc3BsaXQoIi0iKVswXTsKICAgIHJldHVybiBmb250TmFtZVdvU3R5bGUgaW4gKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTZXJpZkZvbnRzKSgpIHx8IGZvbnROYW1lV29TdHlsZS5zZWFyY2goL3NlcmlmL2dpKSAhPT0gLTE7CiAgfQoKICBnZXRCYXNlRm9udE1ldHJpY3MobmFtZSkgewogICAgbGV0IGRlZmF1bHRXaWR0aCA9IDA7CiAgICBsZXQgd2lkdGhzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGxldCBtb25vc3BhY2UgPSBmYWxzZTsKICAgIGNvbnN0IHN0ZEZvbnRNYXAgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN0ZEZvbnRNYXApKCk7CiAgICBsZXQgbG9va3VwTmFtZSA9IHN0ZEZvbnRNYXBbbmFtZV0gfHwgbmFtZTsKICAgIGNvbnN0IE1ldHJpY3MgPSAoMCwgX21ldHJpY3MuZ2V0TWV0cmljcykoKTsKCiAgICBpZiAoIShsb29rdXBOYW1lIGluIE1ldHJpY3MpKSB7CiAgICAgIGlmICh0aGlzLmlzU2VyaWZGb250KG5hbWUpKSB7CiAgICAgICAgbG9va3VwTmFtZSA9ICJUaW1lcy1Sb21hbiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9va3VwTmFtZSA9ICJIZWx2ZXRpY2EiOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZ2x5cGhXaWR0aHMgPSBNZXRyaWNzW2xvb2t1cE5hbWVdOwoKICAgIGlmICh0eXBlb2YgZ2x5cGhXaWR0aHMgPT09ICJudW1iZXIiKSB7CiAgICAgIGRlZmF1bHRXaWR0aCA9IGdseXBoV2lkdGhzOwogICAgICBtb25vc3BhY2UgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgd2lkdGhzID0gZ2x5cGhXaWR0aHMoKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBkZWZhdWx0V2lkdGgsCiAgICAgIG1vbm9zcGFjZSwKICAgICAgd2lkdGhzCiAgICB9OwogIH0KCiAgYnVpbGRDaGFyQ29kZVRvV2lkdGgod2lkdGhzQnlHbHlwaE5hbWUsIHByb3BlcnRpZXMpIHsKICAgIGNvbnN0IHdpZHRocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBjb25zdCBkaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXM7CiAgICBjb25zdCBlbmNvZGluZyA9IHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nOwoKICAgIGZvciAobGV0IGNoYXJDb2RlID0gMDsgY2hhckNvZGUgPCAyNTY7IGNoYXJDb2RlKyspIHsKICAgICAgaWYgKGNoYXJDb2RlIGluIGRpZmZlcmVuY2VzICYmIHdpZHRoc0J5R2x5cGhOYW1lW2RpZmZlcmVuY2VzW2NoYXJDb2RlXV0pIHsKICAgICAgICB3aWR0aHNbY2hhckNvZGVdID0gd2lkdGhzQnlHbHlwaE5hbWVbZGlmZmVyZW5jZXNbY2hhckNvZGVdXTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGNoYXJDb2RlIGluIGVuY29kaW5nICYmIHdpZHRoc0J5R2x5cGhOYW1lW2VuY29kaW5nW2NoYXJDb2RlXV0pIHsKICAgICAgICB3aWR0aHNbY2hhckNvZGVdID0gd2lkdGhzQnlHbHlwaE5hbWVbZW5jb2RpbmdbY2hhckNvZGVdXTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB3aWR0aHM7CiAgfQoKICBwcmVFdmFsdWF0ZUZvbnQoZGljdCkgewogICAgY29uc3QgYmFzZURpY3QgPSBkaWN0OwogICAgbGV0IHR5cGUgPSBkaWN0LmdldCgiU3VidHlwZSIpOwoKICAgIGlmICghKHR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQgZm9udCBTdWJ0eXBlIik7CiAgICB9CgogICAgbGV0IGNvbXBvc2l0ZSA9IGZhbHNlOwogICAgbGV0IGhhc2gsIHRvVW5pY29kZTsKCiAgICBpZiAodHlwZS5uYW1lID09PSAiVHlwZTAiKSB7CiAgICAgIGNvbnN0IGRmID0gZGljdC5nZXQoIkRlc2NlbmRhbnRGb250cyIpOwoKICAgICAgaWYgKCFkZikgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRGVzY2VuZGFudCBmb250cyBhcmUgbm90IHNwZWNpZmllZCIpOwogICAgICB9CgogICAgICBkaWN0ID0gQXJyYXkuaXNBcnJheShkZikgPyB0aGlzLnhyZWYuZmV0Y2hJZlJlZihkZlswXSkgOiBkZjsKCiAgICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRGVzY2VuZGFudCBmb250IGlzIG5vdCBhIGRpY3Rpb25hcnkuIik7CiAgICAgIH0KCiAgICAgIHR5cGUgPSBkaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGZvbnQgU3VidHlwZSIpOwogICAgICB9CgogICAgICBjb21wb3NpdGUgPSB0cnVlOwogICAgfQoKICAgIGNvbnN0IGZpcnN0Q2hhciA9IGRpY3QuZ2V0KCJGaXJzdENoYXIiKSB8fCAwLAogICAgICAgICAgbGFzdENoYXIgPSBkaWN0LmdldCgiTGFzdENoYXIiKSB8fCAoY29tcG9zaXRlID8gMHhmZmZmIDogMHhmZik7CiAgICBjb25zdCBkZXNjcmlwdG9yID0gZGljdC5nZXQoIkZvbnREZXNjcmlwdG9yIik7CgogICAgaWYgKGRlc2NyaXB0b3IpIHsKICAgICAgaGFzaCA9IG5ldyBfbXVybXVyaGFzaC5NdXJtdXJIYXNoM182NCgpOwogICAgICBjb25zdCBlbmNvZGluZyA9IGJhc2VEaWN0LmdldFJhdygiRW5jb2RpbmciKTsKCiAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBoYXNoLnVwZGF0ZShlbmNvZGluZy5uYW1lKTsKICAgICAgfSBlbHNlIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGhhc2gudXBkYXRlKGVuY29kaW5nLnRvU3RyaW5nKCkpOwogICAgICB9IGVsc2UgaWYgKGVuY29kaW5nIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW5jb2RpbmcuZ2V0UmF3VmFsdWVzKCkpIHsKICAgICAgICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgaGFzaC51cGRhdGUoZW50cnkubmFtZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgIGhhc2gudXBkYXRlKGVudHJ5LnRvU3RyaW5nKCkpOwogICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGVudHJ5KSkgewogICAgICAgICAgICBjb25zdCBkaWZmTGVuZ3RoID0gZW50cnkubGVuZ3RoLAogICAgICAgICAgICAgICAgICBkaWZmQnVmID0gbmV3IEFycmF5KGRpZmZMZW5ndGgpOwoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBkaWZmTGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICBjb25zdCBkaWZmRW50cnkgPSBlbnRyeVtqXTsKCiAgICAgICAgICAgICAgaWYgKGRpZmZFbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICAgIGRpZmZCdWZbal0gPSBkaWZmRW50cnkubmFtZTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkaWZmRW50cnkgPT09ICJudW1iZXIiIHx8IGRpZmZFbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgICAgZGlmZkJ1ZltqXSA9IGRpZmZFbnRyeS50b1N0cmluZygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaGFzaC51cGRhdGUoZGlmZkJ1Zi5qb2luKCkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaGFzaC51cGRhdGUoYCR7Zmlyc3RDaGFyfS0ke2xhc3RDaGFyfWApOwogICAgICB0b1VuaWNvZGUgPSBkaWN0LmdldCgiVG9Vbmljb2RlIikgfHwgYmFzZURpY3QuZ2V0KCJUb1VuaWNvZGUiKTsKCiAgICAgIGlmICh0b1VuaWNvZGUgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnN0IHN0cmVhbSA9IHRvVW5pY29kZS5zdHIgfHwgdG9Vbmljb2RlOwogICAgICAgIGNvbnN0IHVpbnQ4YXJyYXkgPSBzdHJlYW0uYnVmZmVyID8gbmV3IFVpbnQ4QXJyYXkoc3RyZWFtLmJ1ZmZlci5idWZmZXIsIDAsIHN0cmVhbS5idWZmZXJMZW5ndGgpIDogbmV3IFVpbnQ4QXJyYXkoc3RyZWFtLmJ5dGVzLmJ1ZmZlciwgc3RyZWFtLnN0YXJ0LCBzdHJlYW0uZW5kIC0gc3RyZWFtLnN0YXJ0KTsKICAgICAgICBoYXNoLnVwZGF0ZSh1aW50OGFycmF5KTsKICAgICAgfSBlbHNlIGlmICh0b1VuaWNvZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgaGFzaC51cGRhdGUodG9Vbmljb2RlLm5hbWUpOwogICAgICB9CgogICAgICBjb25zdCB3aWR0aHMgPSBkaWN0LmdldCgiV2lkdGhzIikgfHwgYmFzZURpY3QuZ2V0KCJXaWR0aHMiKTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHdpZHRocykpIHsKICAgICAgICBjb25zdCB3aWR0aHNCdWYgPSBbXTsKCiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB3aWR0aHMpIHsKICAgICAgICAgIGlmICh0eXBlb2YgZW50cnkgPT09ICJudW1iZXIiIHx8IGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgIHdpZHRoc0J1Zi5wdXNoKGVudHJ5LnRvU3RyaW5nKCkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaGFzaC51cGRhdGUod2lkdGhzQnVmLmpvaW4oKSk7CiAgICAgIH0KCiAgICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgICBoYXNoLnVwZGF0ZSgiY29tcG9zaXRlRm9udCIpOwogICAgICAgIGNvbnN0IGNvbXBvc2l0ZVdpZHRocyA9IGRpY3QuZ2V0KCJXIikgfHwgYmFzZURpY3QuZ2V0KCJXIik7CgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbXBvc2l0ZVdpZHRocykpIHsKICAgICAgICAgIGNvbnN0IHdpZHRoc0J1ZiA9IFtdOwoKICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgY29tcG9zaXRlV2lkdGhzKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgZW50cnkgPT09ICJudW1iZXIiIHx8IGVudHJ5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgICAgd2lkdGhzQnVmLnB1c2goZW50cnkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShlbnRyeSkpIHsKICAgICAgICAgICAgICBjb25zdCBzdWJXaWR0aHNCdWYgPSBbXTsKCiAgICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVudHJ5KSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQgPT09ICJudW1iZXIiIHx8IGVsZW1lbnQgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgICAgc3ViV2lkdGhzQnVmLnB1c2goZWxlbWVudC50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHdpZHRoc0J1Zi5wdXNoKGBbJHtzdWJXaWR0aHNCdWYuam9pbigpfV1gKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGhhc2gudXBkYXRlKHdpZHRoc0J1Zi5qb2luKCkpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgY2lkVG9HaWRNYXAgPSBkaWN0LmdldFJhdygiQ0lEVG9HSURNYXAiKSB8fCBiYXNlRGljdC5nZXRSYXcoIkNJRFRvR0lETWFwIik7CgogICAgICAgIGlmIChjaWRUb0dpZE1hcCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIGhhc2gudXBkYXRlKGNpZFRvR2lkTWFwLm5hbWUpOwogICAgICAgIH0gZWxzZSBpZiAoY2lkVG9HaWRNYXAgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgIGhhc2gudXBkYXRlKGNpZFRvR2lkTWFwLnRvU3RyaW5nKCkpOwogICAgICAgIH0gZWxzZSBpZiAoY2lkVG9HaWRNYXAgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgICAgaGFzaC51cGRhdGUoY2lkVG9HaWRNYXAucGVla0J5dGVzKCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGRlc2NyaXB0b3IsCiAgICAgIGRpY3QsCiAgICAgIGJhc2VEaWN0LAogICAgICBjb21wb3NpdGUsCiAgICAgIHR5cGU6IHR5cGUubmFtZSwKICAgICAgZmlyc3RDaGFyLAogICAgICBsYXN0Q2hhciwKICAgICAgdG9Vbmljb2RlLAogICAgICBoYXNoOiBoYXNoID8gaGFzaC5oZXhkaWdlc3QoKSA6ICIiCiAgICB9OwogIH0KCiAgYXN5bmMgdHJhbnNsYXRlRm9udCh7CiAgICBkZXNjcmlwdG9yLAogICAgZGljdCwKICAgIGJhc2VEaWN0LAogICAgY29tcG9zaXRlLAogICAgdHlwZSwKICAgIGZpcnN0Q2hhciwKICAgIGxhc3RDaGFyLAogICAgdG9Vbmljb2RlLAogICAgY3NzRm9udEluZm8KICB9KSB7CiAgICBjb25zdCBpc1R5cGUzRm9udCA9IHR5cGUgPT09ICJUeXBlMyI7CiAgICBsZXQgcHJvcGVydGllczsKCiAgICBpZiAoIWRlc2NyaXB0b3IpIHsKICAgICAgaWYgKGlzVHlwZTNGb250KSB7CiAgICAgICAgZGVzY3JpcHRvciA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogICAgICAgIGRlc2NyaXB0b3Iuc2V0KCJGb250TmFtZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KHR5cGUpKTsKICAgICAgICBkZXNjcmlwdG9yLnNldCgiRm9udEJCb3giLCBkaWN0LmdldEFycmF5KCJGb250QkJveCIpIHx8IFswLCAwLCAwLCAwXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IGJhc2VGb250TmFtZSA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgICAgICBpZiAoIShiYXNlRm9udE5hbWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYXNlIGZvbnQgaXMgbm90IHNwZWNpZmllZCIpOwogICAgICAgIH0KCiAgICAgICAgYmFzZUZvbnROYW1lID0gYmFzZUZvbnROYW1lLm5hbWUucmVwbGFjZSgvWyxfXS9nLCAiLSIpOwogICAgICAgIGNvbnN0IG1ldHJpY3MgPSB0aGlzLmdldEJhc2VGb250TWV0cmljcyhiYXNlRm9udE5hbWUpOwogICAgICAgIGNvbnN0IGZvbnROYW1lV29TdHlsZSA9IGJhc2VGb250TmFtZS5zcGxpdCgiLSIpWzBdOwogICAgICAgIGNvbnN0IGZsYWdzID0gKHRoaXMuaXNTZXJpZkZvbnQoZm9udE5hbWVXb1N0eWxlKSA/IF9mb250c191dGlscy5Gb250RmxhZ3MuU2VyaWYgOiAwKSB8IChtZXRyaWNzLm1vbm9zcGFjZSA/IF9mb250c191dGlscy5Gb250RmxhZ3MuRml4ZWRQaXRjaCA6IDApIHwgKCgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3ltYm9sc0ZvbnRzKSgpW2ZvbnROYW1lV29TdHlsZV0gPyBfZm9udHNfdXRpbHMuRm9udEZsYWdzLlN5bWJvbGljIDogX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5Ob25zeW1ib2xpYyk7CiAgICAgICAgcHJvcGVydGllcyA9IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBuYW1lOiBiYXNlRm9udE5hbWUsCiAgICAgICAgICBsb2FkZWROYW1lOiBiYXNlRGljdC5sb2FkZWROYW1lLAogICAgICAgICAgd2lkdGhzOiBtZXRyaWNzLndpZHRocywKICAgICAgICAgIGRlZmF1bHRXaWR0aDogbWV0cmljcy5kZWZhdWx0V2lkdGgsCiAgICAgICAgICBpc1NpbXVsYXRlZEZsYWdzOiB0cnVlLAogICAgICAgICAgZmxhZ3MsCiAgICAgICAgICBmaXJzdENoYXIsCiAgICAgICAgICBsYXN0Q2hhciwKICAgICAgICAgIHRvVW5pY29kZSwKICAgICAgICAgIHhIZWlnaHQ6IDAsCiAgICAgICAgICBjYXBIZWlnaHQ6IDAsCiAgICAgICAgICBpdGFsaWNBbmdsZTogMCwKICAgICAgICAgIGlzVHlwZTNGb250CiAgICAgICAgfTsKICAgICAgICBjb25zdCB3aWR0aHMgPSBkaWN0LmdldCgiV2lkdGhzIik7CiAgICAgICAgY29uc3Qgc3RhbmRhcmRGb250TmFtZSA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3RhbmRhcmRGb250TmFtZSkoYmFzZUZvbnROYW1lKTsKICAgICAgICBsZXQgZmlsZSA9IG51bGw7CgogICAgICAgIGlmIChzdGFuZGFyZEZvbnROYW1lKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmlzU3RhbmRhcmRGb250ID0gdHJ1ZTsKICAgICAgICAgIGZpbGUgPSBhd2FpdCB0aGlzLmZldGNoU3RhbmRhcmRGb250RGF0YShzdGFuZGFyZEZvbnROYW1lKTsKICAgICAgICAgIHByb3BlcnRpZXMuaXNJbnRlcm5hbEZvbnQgPSAhIWZpbGU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0RGF0YVN0cnVjdHVyZXMoZGljdCwgZGljdCwgcHJvcGVydGllcykudGhlbihuZXdQcm9wZXJ0aWVzID0+IHsKICAgICAgICAgIGlmICh3aWR0aHMpIHsKICAgICAgICAgICAgY29uc3QgZ2x5cGhXaWR0aHMgPSBbXTsKICAgICAgICAgICAgbGV0IGogPSBmaXJzdENoYXI7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB3aWR0aHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICAgIGdseXBoV2lkdGhzW2orK10gPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXdQcm9wZXJ0aWVzLndpZHRocyA9IGdseXBoV2lkdGhzOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3UHJvcGVydGllcy53aWR0aHMgPSB0aGlzLmJ1aWxkQ2hhckNvZGVUb1dpZHRoKG1ldHJpY3Mud2lkdGhzLCBuZXdQcm9wZXJ0aWVzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IF9mb250cy5Gb250KGJhc2VGb250TmFtZSwgZmlsZSwgbmV3UHJvcGVydGllcyk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgZm9udE5hbWUgPSBkZXNjcmlwdG9yLmdldCgiRm9udE5hbWUiKTsKICAgIGxldCBiYXNlRm9udCA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgIGlmICh0eXBlb2YgZm9udE5hbWUgPT09ICJzdHJpbmciKSB7CiAgICAgIGZvbnROYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoZm9udE5hbWUpOwogICAgfQoKICAgIGlmICh0eXBlb2YgYmFzZUZvbnQgPT09ICJzdHJpbmciKSB7CiAgICAgIGJhc2VGb250ID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoYmFzZUZvbnQpOwogICAgfQoKICAgIGlmICghaXNUeXBlM0ZvbnQpIHsKICAgICAgY29uc3QgZm9udE5hbWVTdHIgPSBmb250TmFtZSAmJiBmb250TmFtZS5uYW1lOwogICAgICBjb25zdCBiYXNlRm9udFN0ciA9IGJhc2VGb250ICYmIGJhc2VGb250Lm5hbWU7CgogICAgICBpZiAoZm9udE5hbWVTdHIgIT09IGJhc2VGb250U3RyKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKGBUaGUgRm9udERlc2NyaXB0b3IncyBGb250TmFtZSBpcyAiJHtmb250TmFtZVN0cn0iIGJ1dCBgICsgYHNob3VsZCBiZSB0aGUgc2FtZSBhcyB0aGUgRm9udCdzIEJhc2VGb250ICIke2Jhc2VGb250U3RyfSIuYCk7CgogICAgICAgIGlmIChmb250TmFtZVN0ciAmJiBiYXNlRm9udFN0ciAmJiBiYXNlRm9udFN0ci5zdGFydHNXaXRoKGZvbnROYW1lU3RyKSkgewogICAgICAgICAgZm9udE5hbWUgPSBiYXNlRm9udDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb250TmFtZSA9IGZvbnROYW1lIHx8IGJhc2VGb250OwoKICAgIGlmICghKGZvbnROYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGZvbnQgbmFtZSIpOwogICAgfQoKICAgIGxldCBmb250RmlsZSwgc3VidHlwZSwgbGVuZ3RoMSwgbGVuZ3RoMiwgbGVuZ3RoMzsKCiAgICB0cnkgewogICAgICBmb250RmlsZSA9IGRlc2NyaXB0b3IuZ2V0KCJGb250RmlsZSIsICJGb250RmlsZTIiLCAiRm9udEZpbGUzIik7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoIXRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGB0cmFuc2xhdGVGb250IC0gZmV0Y2hpbmcgIiR7Zm9udE5hbWUubmFtZX0iIGZvbnQgZmlsZTogIiR7ZXh9Ii5gKTsKICAgICAgZm9udEZpbGUgPSBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICB9CgogICAgbGV0IGlzU3RhbmRhcmRGb250ID0gZmFsc2U7CiAgICBsZXQgaXNJbnRlcm5hbEZvbnQgPSBmYWxzZTsKICAgIGxldCBnbHlwaFNjYWxlRmFjdG9ycyA9IG51bGw7CgogICAgaWYgKGZvbnRGaWxlKSB7CiAgICAgIGlmIChmb250RmlsZS5kaWN0KSB7CiAgICAgICAgY29uc3Qgc3VidHlwZUVudHJ5ID0gZm9udEZpbGUuZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgaWYgKHN1YnR5cGVFbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIHN1YnR5cGUgPSBzdWJ0eXBlRW50cnkubmFtZTsKICAgICAgICB9CgogICAgICAgIGxlbmd0aDEgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMSIpOwogICAgICAgIGxlbmd0aDIgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMiIpOwogICAgICAgIGxlbmd0aDMgPSBmb250RmlsZS5kaWN0LmdldCgiTGVuZ3RoMyIpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGNzc0ZvbnRJbmZvKSB7CiAgICAgIGNvbnN0IHN0YW5kYXJkRm9udE5hbWUgPSAoMCwgX3hmYV9mb250cy5nZXRYZmFGb250TmFtZSkoZm9udE5hbWUubmFtZSk7CgogICAgICBpZiAoc3RhbmRhcmRGb250TmFtZSkgewogICAgICAgIGNzc0ZvbnRJbmZvLmZvbnRGYW1pbHkgPSBgJHtjc3NGb250SW5mby5mb250RmFtaWx5fS1QZGZKUy1YRkFgOwogICAgICAgIGNzc0ZvbnRJbmZvLm1ldHJpY3MgPSBzdGFuZGFyZEZvbnROYW1lLm1ldHJpY3MgfHwgbnVsbDsKICAgICAgICBnbHlwaFNjYWxlRmFjdG9ycyA9IHN0YW5kYXJkRm9udE5hbWUuZmFjdG9ycyB8fCBudWxsOwogICAgICAgIGZvbnRGaWxlID0gYXdhaXQgdGhpcy5mZXRjaFN0YW5kYXJkRm9udERhdGEoc3RhbmRhcmRGb250TmFtZS5uYW1lKTsKICAgICAgICBpc0ludGVybmFsRm9udCA9ICEhZm9udEZpbGU7CiAgICAgICAgYmFzZURpY3QgPSBkaWN0ID0gKDAsIF94ZmFfZm9udHMuZ2V0WGZhRm9udERpY3QpKGZvbnROYW1lLm5hbWUpOwogICAgICAgIGNvbXBvc2l0ZSA9IHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoIWlzVHlwZTNGb250KSB7CiAgICAgIGNvbnN0IHN0YW5kYXJkRm9udE5hbWUgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN0YW5kYXJkRm9udE5hbWUpKGZvbnROYW1lLm5hbWUpOwoKICAgICAgaWYgKHN0YW5kYXJkRm9udE5hbWUpIHsKICAgICAgICBpc1N0YW5kYXJkRm9udCA9IHRydWU7CiAgICAgICAgZm9udEZpbGUgPSBhd2FpdCB0aGlzLmZldGNoU3RhbmRhcmRGb250RGF0YShzdGFuZGFyZEZvbnROYW1lKTsKICAgICAgICBpc0ludGVybmFsRm9udCA9ICEhZm9udEZpbGU7CiAgICAgIH0KICAgIH0KCiAgICBwcm9wZXJ0aWVzID0gewogICAgICB0eXBlLAogICAgICBuYW1lOiBmb250TmFtZS5uYW1lLAogICAgICBzdWJ0eXBlLAogICAgICBmaWxlOiBmb250RmlsZSwKICAgICAgbGVuZ3RoMSwKICAgICAgbGVuZ3RoMiwKICAgICAgbGVuZ3RoMywKICAgICAgaXNTdGFuZGFyZEZvbnQsCiAgICAgIGlzSW50ZXJuYWxGb250LAogICAgICBsb2FkZWROYW1lOiBiYXNlRGljdC5sb2FkZWROYW1lLAogICAgICBjb21wb3NpdGUsCiAgICAgIGZpeGVkUGl0Y2g6IGZhbHNlLAogICAgICBmb250TWF0cml4OiBkaWN0LmdldEFycmF5KCJGb250TWF0cml4IikgfHwgX3V0aWwuRk9OVF9JREVOVElUWV9NQVRSSVgsCiAgICAgIGZpcnN0Q2hhciwKICAgICAgbGFzdENoYXIsCiAgICAgIHRvVW5pY29kZSwKICAgICAgYmJveDogZGVzY3JpcHRvci5nZXRBcnJheSgiRm9udEJCb3giKSB8fCBkaWN0LmdldEFycmF5KCJGb250QkJveCIpLAogICAgICBhc2NlbnQ6IGRlc2NyaXB0b3IuZ2V0KCJBc2NlbnQiKSwKICAgICAgZGVzY2VudDogZGVzY3JpcHRvci5nZXQoIkRlc2NlbnQiKSwKICAgICAgeEhlaWdodDogZGVzY3JpcHRvci5nZXQoIlhIZWlnaHQiKSB8fCAwLAogICAgICBjYXBIZWlnaHQ6IGRlc2NyaXB0b3IuZ2V0KCJDYXBIZWlnaHQiKSB8fCAwLAogICAgICBmbGFnczogZGVzY3JpcHRvci5nZXQoIkZsYWdzIiksCiAgICAgIGl0YWxpY0FuZ2xlOiBkZXNjcmlwdG9yLmdldCgiSXRhbGljQW5nbGUiKSB8fCAwLAogICAgICBpc1R5cGUzRm9udCwKICAgICAgY3NzRm9udEluZm8sCiAgICAgIHNjYWxlRmFjdG9yczogZ2x5cGhTY2FsZUZhY3RvcnMKICAgIH07CgogICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICBjb25zdCBjaWRFbmNvZGluZyA9IGJhc2VEaWN0LmdldCgiRW5jb2RpbmciKTsKCiAgICAgIGlmIChjaWRFbmNvZGluZyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBwcm9wZXJ0aWVzLmNpZEVuY29kaW5nID0gY2lkRW5jb2RpbmcubmFtZTsKICAgICAgfQoKICAgICAgY29uc3QgY01hcCA9IGF3YWl0IF9jbWFwLkNNYXBGYWN0b3J5LmNyZWF0ZSh7CiAgICAgICAgZW5jb2Rpbmc6IGNpZEVuY29kaW5nLAogICAgICAgIGZldGNoQnVpbHRJbkNNYXA6IHRoaXMuX2ZldGNoQnVpbHRJbkNNYXBCb3VuZCwKICAgICAgICB1c2VDTWFwOiBudWxsCiAgICAgIH0pOwogICAgICBwcm9wZXJ0aWVzLmNNYXAgPSBjTWFwOwogICAgICBwcm9wZXJ0aWVzLnZlcnRpY2FsID0gcHJvcGVydGllcy5jTWFwLnZlcnRpY2FsOwogICAgfQoKICAgIHJldHVybiB0aGlzLmV4dHJhY3REYXRhU3RydWN0dXJlcyhkaWN0LCBiYXNlRGljdCwgcHJvcGVydGllcykudGhlbihuZXdQcm9wZXJ0aWVzID0+IHsKICAgICAgdGhpcy5leHRyYWN0V2lkdGhzKGRpY3QsIGRlc2NyaXB0b3IsIG5ld1Byb3BlcnRpZXMpOwogICAgICByZXR1cm4gbmV3IF9mb250cy5Gb250KGZvbnROYW1lLm5hbWUsIGZvbnRGaWxlLCBuZXdQcm9wZXJ0aWVzKTsKICAgIH0pOwogIH0KCiAgc3RhdGljIGJ1aWxkRm9udFBhdGhzKGZvbnQsIGdseXBocywgaGFuZGxlciwgZXZhbHVhdG9yT3B0aW9ucykgewogICAgZnVuY3Rpb24gYnVpbGRQYXRoKGZvbnRDaGFyKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IGAke2ZvbnQubG9hZGVkTmFtZX1fcGF0aF8ke2ZvbnRDaGFyfWA7CgogICAgICB0cnkgewogICAgICAgIGlmIChmb250LnJlbmRlcmVyLmhhc0J1aWx0UGF0aChmb250Q2hhcikpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGhhbmRsZXIuc2VuZCgiY29tbW9ub2JqIiwgW2dseXBoTmFtZSwgIkZvbnRQYXRoIiwgZm9udC5yZW5kZXJlci5nZXRQYXRoSnMoZm9udENoYXIpXSk7CiAgICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICAgIGlmIChldmFsdWF0b3JPcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250QnVpbGRQYXRoCiAgICAgICAgICB9KTsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgYnVpbGRGb250UGF0aHMgLSBpZ25vcmluZyAke2dseXBoTmFtZX0gZ2x5cGg6ICIke3JlYXNvbn0iLmApOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICB9CiAgICB9CgogICAgZm9yIChjb25zdCBnbHlwaCBvZiBnbHlwaHMpIHsKICAgICAgYnVpbGRQYXRoKGdseXBoLmZvbnRDaGFyKTsKICAgICAgY29uc3QgYWNjZW50ID0gZ2x5cGguYWNjZW50OwoKICAgICAgaWYgKGFjY2VudCAmJiBhY2NlbnQuZm9udENoYXIpIHsKICAgICAgICBidWlsZFBhdGgoYWNjZW50LmZvbnRDaGFyKTsKICAgICAgfQogICAgfQogIH0KCiAgc3RhdGljIGdldCBmYWxsYmFja0ZvbnREaWN0KCkgewogICAgY29uc3QgZGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KCk7CiAgICBkaWN0LnNldCgiQmFzZUZvbnQiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiUERGSlMtRmFsbGJhY2tGb250IikpOwogICAgZGljdC5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIlN1YnR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRmFsbGJhY2tUeXBlIikpOwogICAgZGljdC5zZXQoIkVuY29kaW5nIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIldpbkFuc2lFbmNvZGluZyIpKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZmFsbGJhY2tGb250RGljdCIsIGRpY3QpOwogIH0KCn0KCmV4cG9ydHMuUGFydGlhbEV2YWx1YXRvciA9IFBhcnRpYWxFdmFsdWF0b3I7CgpjbGFzcyBUcmFuc2xhdGVkRm9udCB7CiAgY29uc3RydWN0b3IoewogICAgbG9hZGVkTmFtZSwKICAgIGZvbnQsCiAgICBkaWN0LAogICAgZXZhbHVhdG9yT3B0aW9ucwogIH0pIHsKICAgIHRoaXMubG9hZGVkTmFtZSA9IGxvYWRlZE5hbWU7CiAgICB0aGlzLmZvbnQgPSBmb250OwogICAgdGhpcy5kaWN0ID0gZGljdDsKICAgIHRoaXMuX2V2YWx1YXRvck9wdGlvbnMgPSBldmFsdWF0b3JPcHRpb25zIHx8IERlZmF1bHRQYXJ0aWFsRXZhbHVhdG9yT3B0aW9uczsKICAgIHRoaXMudHlwZTNMb2FkZWQgPSBudWxsOwogICAgdGhpcy50eXBlM0RlcGVuZGVuY2llcyA9IGZvbnQuaXNUeXBlM0ZvbnQgPyBuZXcgU2V0KCkgOiBudWxsOwogICAgdGhpcy5zZW50ID0gZmFsc2U7CiAgfQoKICBzZW5kKGhhbmRsZXIpIHsKICAgIGlmICh0aGlzLnNlbnQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuc2VudCA9IHRydWU7CiAgICBoYW5kbGVyLnNlbmQoImNvbW1vbm9iaiIsIFt0aGlzLmxvYWRlZE5hbWUsICJGb250IiwgdGhpcy5mb250LmV4cG9ydERhdGEodGhpcy5fZXZhbHVhdG9yT3B0aW9ucy5mb250RXh0cmFQcm9wZXJ0aWVzKV0pOwogIH0KCiAgZmFsbGJhY2soaGFuZGxlcikgewogICAgaWYgKCF0aGlzLmZvbnQuZGF0YSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5mb250LmRpc2FibGVGb250RmFjZSA9IHRydWU7CiAgICBQYXJ0aWFsRXZhbHVhdG9yLmJ1aWxkRm9udFBhdGhzKHRoaXMuZm9udCwgdGhpcy5mb250LmdseXBoQ2FjaGVWYWx1ZXMsIGhhbmRsZXIsIHRoaXMuX2V2YWx1YXRvck9wdGlvbnMpOwogIH0KCiAgbG9hZFR5cGUzRGF0YShldmFsdWF0b3IsIHJlc291cmNlcywgdGFzaykgewogICAgaWYgKHRoaXMudHlwZTNMb2FkZWQpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZTNMb2FkZWQ7CiAgICB9CgogICAgaWYgKCF0aGlzLmZvbnQuaXNUeXBlM0ZvbnQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJNdXN0IGJlIGEgVHlwZTMgZm9udC4iKTsKICAgIH0KCiAgICBjb25zdCB0eXBlM0V2YWx1YXRvciA9IGV2YWx1YXRvci5jbG9uZSh7CiAgICAgIGlnbm9yZUVycm9yczogZmFsc2UKICAgIH0pOwogICAgdHlwZTNFdmFsdWF0b3IucGFyc2luZ1R5cGUzRm9udCA9IHRydWU7CiAgICBjb25zdCB0eXBlM0ZvbnRSZWZzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldChldmFsdWF0b3IudHlwZTNGb250UmVmcyk7CgogICAgaWYgKHRoaXMuZGljdC5vYmpJZCAmJiAhdHlwZTNGb250UmVmcy5oYXModGhpcy5kaWN0Lm9iaklkKSkgewogICAgICB0eXBlM0ZvbnRSZWZzLnB1dCh0aGlzLmRpY3Qub2JqSWQpOwogICAgfQoKICAgIHR5cGUzRXZhbHVhdG9yLnR5cGUzRm9udFJlZnMgPSB0eXBlM0ZvbnRSZWZzOwogICAgY29uc3QgdHJhbnNsYXRlZEZvbnQgPSB0aGlzLmZvbnQsCiAgICAgICAgICB0eXBlM0RlcGVuZGVuY2llcyA9IHRoaXMudHlwZTNEZXBlbmRlbmNpZXM7CiAgICBsZXQgbG9hZENoYXJQcm9jc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIGNvbnN0IGNoYXJQcm9jcyA9IHRoaXMuZGljdC5nZXQoIkNoYXJQcm9jcyIpOwogICAgY29uc3QgZm9udFJlc291cmNlcyA9IHRoaXMuZGljdC5nZXQoIlJlc291cmNlcyIpIHx8IHJlc291cmNlczsKICAgIGNvbnN0IGNoYXJQcm9jT3BlcmF0b3JMaXN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBjb25zdCBmb250QkJveCA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdCh0cmFuc2xhdGVkRm9udC5iYm94IHx8IFswLCAwLCAwLCAwXSksCiAgICAgICAgICB3aWR0aCA9IGZvbnRCQm94WzJdIC0gZm9udEJCb3hbMF0sCiAgICAgICAgICBoZWlnaHQgPSBmb250QkJveFszXSAtIGZvbnRCQm94WzFdOwoKICAgIGNvbnN0IGZvbnRCQm94U2l6ZSA9IE1hdGguaHlwb3Qod2lkdGgsIGhlaWdodCk7CgogICAgZm9yIChjb25zdCBrZXkgb2YgY2hhclByb2NzLmdldEtleXMoKSkgewogICAgICBsb2FkQ2hhclByb2NzUHJvbWlzZSA9IGxvYWRDaGFyUHJvY3NQcm9taXNlLnRoZW4oKCkgPT4gewogICAgICAgIGNvbnN0IGdseXBoU3RyZWFtID0gY2hhclByb2NzLmdldChrZXkpOwogICAgICAgIGNvbnN0IG9wZXJhdG9yTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKICAgICAgICByZXR1cm4gdHlwZTNFdmFsdWF0b3IuZ2V0T3BlcmF0b3JMaXN0KHsKICAgICAgICAgIHN0cmVhbTogZ2x5cGhTdHJlYW0sCiAgICAgICAgICB0YXNrLAogICAgICAgICAgcmVzb3VyY2VzOiBmb250UmVzb3VyY2VzLAogICAgICAgICAgb3BlcmF0b3JMaXN0CiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICBpZiAob3BlcmF0b3JMaXN0LmZuQXJyYXlbMF0gPT09IF91dGlsLk9QUy5zZXRDaGFyV2lkdGhBbmRCb3VuZHMpIHsKICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVHlwZTNDb2xvck9wZXJhdG9ycyhvcGVyYXRvckxpc3QsIGZvbnRCQm94U2l6ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgY2hhclByb2NPcGVyYXRvckxpc3Rba2V5XSA9IG9wZXJhdG9yTGlzdC5nZXRJUigpOwoKICAgICAgICAgIGZvciAoY29uc3QgZGVwZW5kZW5jeSBvZiBvcGVyYXRvckxpc3QuZGVwZW5kZW5jaWVzKSB7CiAgICAgICAgICAgIHR5cGUzRGVwZW5kZW5jaWVzLmFkZChkZXBlbmRlbmN5KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFR5cGUzIGZvbnQgcmVzb3VyY2UgIiR7a2V5fSIgaXMgbm90IGF2YWlsYWJsZS5gKTsKICAgICAgICAgIGNvbnN0IGR1bW15T3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwogICAgICAgICAgY2hhclByb2NPcGVyYXRvckxpc3Rba2V5XSA9IGR1bW15T3BlcmF0b3JMaXN0LmdldElSKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMudHlwZTNMb2FkZWQgPSBsb2FkQ2hhclByb2NzUHJvbWlzZS50aGVuKCgpID0+IHsKICAgICAgdHJhbnNsYXRlZEZvbnQuY2hhclByb2NPcGVyYXRvckxpc3QgPSBjaGFyUHJvY09wZXJhdG9yTGlzdDsKCiAgICAgIGlmICh0aGlzLl9iYm94KSB7CiAgICAgICAgdHJhbnNsYXRlZEZvbnQuaXNDaGFyQkJveCA9IHRydWU7CiAgICAgICAgdHJhbnNsYXRlZEZvbnQuYmJveCA9IHRoaXMuX2Jib3g7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHRoaXMudHlwZTNMb2FkZWQ7CiAgfQoKICBfcmVtb3ZlVHlwZTNDb2xvck9wZXJhdG9ycyhvcGVyYXRvckxpc3QsIGZvbnRCQm94U2l6ZSA9IE5hTikgewogICAgY29uc3QgY2hhckJCb3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3Qob3BlcmF0b3JMaXN0LmFyZ3NBcnJheVswXS5zbGljZSgyKSksCiAgICAgICAgICB3aWR0aCA9IGNoYXJCQm94WzJdIC0gY2hhckJCb3hbMF0sCiAgICAgICAgICBoZWlnaHQgPSBjaGFyQkJveFszXSAtIGNoYXJCQm94WzFdOwoKICAgIGNvbnN0IGNoYXJCQm94U2l6ZSA9IE1hdGguaHlwb3Qod2lkdGgsIGhlaWdodCk7CgogICAgaWYgKHdpZHRoID09PSAwIHx8IGhlaWdodCA9PT0gMCkgewogICAgICBvcGVyYXRvckxpc3QuZm5BcnJheS5zcGxpY2UoMCwgMSk7CiAgICAgIG9wZXJhdG9yTGlzdC5hcmdzQXJyYXkuc3BsaWNlKDAsIDEpOwogICAgfSBlbHNlIGlmIChmb250QkJveFNpemUgPT09IDAgfHwgTWF0aC5yb3VuZChjaGFyQkJveFNpemUgLyBmb250QkJveFNpemUpID49IDEwKSB7CiAgICAgIGlmICghdGhpcy5fYmJveCkgewogICAgICAgIHRoaXMuX2Jib3ggPSBbSW5maW5pdHksIEluZmluaXR5LCAtSW5maW5pdHksIC1JbmZpbml0eV07CiAgICAgIH0KCiAgICAgIHRoaXMuX2Jib3hbMF0gPSBNYXRoLm1pbih0aGlzLl9iYm94WzBdLCBjaGFyQkJveFswXSk7CiAgICAgIHRoaXMuX2Jib3hbMV0gPSBNYXRoLm1pbih0aGlzLl9iYm94WzFdLCBjaGFyQkJveFsxXSk7CiAgICAgIHRoaXMuX2Jib3hbMl0gPSBNYXRoLm1heCh0aGlzLl9iYm94WzJdLCBjaGFyQkJveFsyXSk7CiAgICAgIHRoaXMuX2Jib3hbM10gPSBNYXRoLm1heCh0aGlzLl9iYm94WzNdLCBjaGFyQkJveFszXSk7CiAgICB9CgogICAgbGV0IGkgPSAwLAogICAgICAgIGlpID0gb3BlcmF0b3JMaXN0Lmxlbmd0aDsKCiAgICB3aGlsZSAoaSA8IGlpKSB7CiAgICAgIHN3aXRjaCAob3BlcmF0b3JMaXN0LmZuQXJyYXlbaV0pIHsKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRDaGFyV2lkdGhBbmRCb3VuZHM6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JTcGFjZToKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsQ29sb3JTcGFjZToKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvcjoKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvck46CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDb2xvck46CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlR3JheToKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsR3JheToKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjoKICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsUkdCQ29sb3I6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0U3Ryb2tlQ01ZS0NvbG9yOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDTVlLQ29sb3I6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hhZGluZ0ZpbGw6CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0UmVuZGVyaW5nSW50ZW50OgogICAgICAgICAgb3BlcmF0b3JMaXN0LmZuQXJyYXkuc3BsaWNlKGksIDEpOwogICAgICAgICAgb3BlcmF0b3JMaXN0LmFyZ3NBcnJheS5zcGxpY2UoaSwgMSk7CiAgICAgICAgICBpaS0tOwogICAgICAgICAgY29udGludWU7CgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEdTdGF0ZToKICAgICAgICAgIGNvbnN0IFtnU3RhdGVPYmpdID0gb3BlcmF0b3JMaXN0LmFyZ3NBcnJheVtpXTsKICAgICAgICAgIGxldCBqID0gMCwKICAgICAgICAgICAgICBqaiA9IGdTdGF0ZU9iai5sZW5ndGg7CgogICAgICAgICAgd2hpbGUgKGogPCBqaikgewogICAgICAgICAgICBjb25zdCBbZ1N0YXRlS2V5XSA9IGdTdGF0ZU9ialtqXTsKCiAgICAgICAgICAgIHN3aXRjaCAoZ1N0YXRlS2V5KSB7CiAgICAgICAgICAgICAgY2FzZSAiVFIiOgogICAgICAgICAgICAgIGNhc2UgIlRSMiI6CiAgICAgICAgICAgICAgY2FzZSAiSFQiOgogICAgICAgICAgICAgIGNhc2UgIkJHIjoKICAgICAgICAgICAgICBjYXNlICJCRzIiOgogICAgICAgICAgICAgIGNhc2UgIlVDUiI6CiAgICAgICAgICAgICAgY2FzZSAiVUNSMiI6CiAgICAgICAgICAgICAgICBnU3RhdGVPYmouc3BsaWNlKGosIDEpOwogICAgICAgICAgICAgICAgamotLTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBqKys7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGkrKzsKICAgIH0KICB9Cgp9CgpjbGFzcyBTdGF0ZU1hbmFnZXIgewogIGNvbnN0cnVjdG9yKGluaXRpYWxTdGF0ZSA9IG5ldyBFdmFsU3RhdGUoKSkgewogICAgdGhpcy5zdGF0ZSA9IGluaXRpYWxTdGF0ZTsKICAgIHRoaXMuc3RhdGVTdGFjayA9IFtdOwogIH0KCiAgc2F2ZSgpIHsKICAgIGNvbnN0IG9sZCA9IHRoaXMuc3RhdGU7CiAgICB0aGlzLnN0YXRlU3RhY2sucHVzaCh0aGlzLnN0YXRlKTsKICAgIHRoaXMuc3RhdGUgPSBvbGQuY2xvbmUoKTsKICB9CgogIHJlc3RvcmUoKSB7CiAgICBjb25zdCBwcmV2ID0gdGhpcy5zdGF0ZVN0YWNrLnBvcCgpOwoKICAgIGlmIChwcmV2KSB7CiAgICAgIHRoaXMuc3RhdGUgPSBwcmV2OwogICAgfQogIH0KCiAgdHJhbnNmb3JtKGFyZ3MpIHsKICAgIHRoaXMuc3RhdGUuY3RtID0gX3V0aWwuVXRpbC50cmFuc2Zvcm0odGhpcy5zdGF0ZS5jdG0sIGFyZ3MpOwogIH0KCn0KCmNsYXNzIFRleHRTdGF0ZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmN0bSA9IG5ldyBGbG9hdDMyQXJyYXkoX3V0aWwuSURFTlRJVFlfTUFUUklYKTsKICAgIHRoaXMuZm9udE5hbWUgPSBudWxsOwogICAgdGhpcy5mb250U2l6ZSA9IDA7CiAgICB0aGlzLmZvbnQgPSBudWxsOwogICAgdGhpcy5mb250TWF0cml4ID0gX3V0aWwuRk9OVF9JREVOVElUWV9NQVRSSVg7CiAgICB0aGlzLnRleHRNYXRyaXggPSBfdXRpbC5JREVOVElUWV9NQVRSSVguc2xpY2UoKTsKICAgIHRoaXMudGV4dExpbmVNYXRyaXggPSBfdXRpbC5JREVOVElUWV9NQVRSSVguc2xpY2UoKTsKICAgIHRoaXMuY2hhclNwYWNpbmcgPSAwOwogICAgdGhpcy53b3JkU3BhY2luZyA9IDA7CiAgICB0aGlzLmxlYWRpbmcgPSAwOwogICAgdGhpcy50ZXh0SFNjYWxlID0gMTsKICAgIHRoaXMudGV4dFJpc2UgPSAwOwogIH0KCiAgc2V0VGV4dE1hdHJpeChhLCBiLCBjLCBkLCBlLCBmKSB7CiAgICBjb25zdCBtID0gdGhpcy50ZXh0TWF0cml4OwogICAgbVswXSA9IGE7CiAgICBtWzFdID0gYjsKICAgIG1bMl0gPSBjOwogICAgbVszXSA9IGQ7CiAgICBtWzRdID0gZTsKICAgIG1bNV0gPSBmOwogIH0KCiAgc2V0VGV4dExpbmVNYXRyaXgoYSwgYiwgYywgZCwgZSwgZikgewogICAgY29uc3QgbSA9IHRoaXMudGV4dExpbmVNYXRyaXg7CiAgICBtWzBdID0gYTsKICAgIG1bMV0gPSBiOwogICAgbVsyXSA9IGM7CiAgICBtWzNdID0gZDsKICAgIG1bNF0gPSBlOwogICAgbVs1XSA9IGY7CiAgfQoKICB0cmFuc2xhdGVUZXh0TWF0cml4KHgsIHkpIHsKICAgIGNvbnN0IG0gPSB0aGlzLnRleHRNYXRyaXg7CiAgICBtWzRdID0gbVswXSAqIHggKyBtWzJdICogeSArIG1bNF07CiAgICBtWzVdID0gbVsxXSAqIHggKyBtWzNdICogeSArIG1bNV07CiAgfQoKICB0cmFuc2xhdGVUZXh0TGluZU1hdHJpeCh4LCB5KSB7CiAgICBjb25zdCBtID0gdGhpcy50ZXh0TGluZU1hdHJpeDsKICAgIG1bNF0gPSBtWzBdICogeCArIG1bMl0gKiB5ICsgbVs0XTsKICAgIG1bNV0gPSBtWzFdICogeCArIG1bM10gKiB5ICsgbVs1XTsKICB9CgogIGNhcnJpYWdlUmV0dXJuKCkgewogICAgdGhpcy50cmFuc2xhdGVUZXh0TGluZU1hdHJpeCgwLCAtdGhpcy5sZWFkaW5nKTsKICAgIHRoaXMudGV4dE1hdHJpeCA9IHRoaXMudGV4dExpbmVNYXRyaXguc2xpY2UoKTsKICB9CgogIGNsb25lKCkgewogICAgY29uc3QgY2xvbmUgPSBPYmplY3QuY3JlYXRlKHRoaXMpOwogICAgY2xvbmUudGV4dE1hdHJpeCA9IHRoaXMudGV4dE1hdHJpeC5zbGljZSgpOwogICAgY2xvbmUudGV4dExpbmVNYXRyaXggPSB0aGlzLnRleHRMaW5lTWF0cml4LnNsaWNlKCk7CiAgICBjbG9uZS5mb250TWF0cml4ID0gdGhpcy5mb250TWF0cml4LnNsaWNlKCk7CiAgICByZXR1cm4gY2xvbmU7CiAgfQoKfQoKY2xhc3MgRXZhbFN0YXRlIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuY3RtID0gbmV3IEZsb2F0MzJBcnJheShfdXRpbC5JREVOVElUWV9NQVRSSVgpOwogICAgdGhpcy5mb250ID0gbnVsbDsKICAgIHRoaXMudGV4dFJlbmRlcmluZ01vZGUgPSBfdXRpbC5UZXh0UmVuZGVyaW5nTW9kZS5GSUxMOwogICAgdGhpcy5maWxsQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5OwogICAgdGhpcy5zdHJva2VDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXk7CiAgfQoKICBjbG9uZSgpIHsKICAgIHJldHVybiBPYmplY3QuY3JlYXRlKHRoaXMpOwogIH0KCn0KCmNsYXNzIEV2YWx1YXRvclByZXByb2Nlc3NvciB7CiAgc3RhdGljIGdldCBvcE1hcCgpIHsKICAgIGNvbnN0IGdldE9QTWFwID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgICAgdC53ID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TGluZVdpZHRoLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkogPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRMaW5lQ2FwLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmogPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRMaW5lSm9pbiwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5NID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TWl0ZXJMaW1pdCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5kID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RGFzaCwKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5yaSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFJlbmRlcmluZ0ludGVudCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5pID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmxhdG5lc3MsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZ3MgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRHU3RhdGUsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQucSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNhdmUsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuUSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnJlc3RvcmUsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuY20gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy50cmFuc2Zvcm0sCiAgICAgICAgbnVtQXJnczogNiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQubSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLm1vdmVUbywKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5sID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMubGluZVRvLAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmMgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5jdXJ2ZVRvLAogICAgICAgIG51bUFyZ3M6IDYsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LnYgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5jdXJ2ZVRvMiwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC55ID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY3VydmVUbzMsCiAgICAgICAgbnVtQXJnczogNCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuaCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmNsb3NlUGF0aCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5yZSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnJlY3RhbmdsZSwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5TID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc3Ryb2tlLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LnMgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5jbG9zZVN0cm9rZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5mID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZmlsbCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5GID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZmlsbCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsiZioiXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVvRmlsbCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5CID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZmlsbFN0cm9rZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsiQioiXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVvRmlsbFN0cm9rZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5iID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY2xvc2VGaWxsU3Ryb2tlLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0WyJiKiJdID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuY2xvc2VFT0ZpbGxTdHJva2UsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQubiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmVuZFBhdGgsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmNsaXAsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHRbIlcqIl0gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5lb0NsaXAsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQlQgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpblRleHQsCiAgICAgICAgbnVtQXJnczogMCwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuRVQgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5lbmRUZXh0LAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRjID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0Q2hhclNwYWNpbmcsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVHcgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRXb3JkU3BhY2luZywKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UeiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEhTY2FsZSwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UTCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldExlYWRpbmcsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVGYgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGb250LAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRyID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0VGV4dFJlbmRlcmluZ01vZGUsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVHMgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRUZXh0UmlzZSwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5UZCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLm1vdmVUZXh0LAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlREID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TGVhZGluZ01vdmVUZXh0LAogICAgICAgIG51bUFyZ3M6IDIsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRtID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0VGV4dE1hdHJpeCwKICAgICAgICBudW1BcmdzOiA2LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsiVCoiXSA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLm5leHRMaW5lLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlRqID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2hvd1RleHQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuVEogPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zaG93U3BhY2VkVGV4dCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsiJyJdID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMubmV4dExpbmVTaG93VGV4dCwKICAgICAgICBudW1BcmdzOiAxLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdFsnIiddID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMubmV4dExpbmVTZXRTcGFjaW5nU2hvd1RleHQsCiAgICAgICAgbnVtQXJnczogMywKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZDAgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRDaGFyV2lkdGgsCiAgICAgICAgbnVtQXJnczogMiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZDEgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRDaGFyV2lkdGhBbmRCb3VuZHMsCiAgICAgICAgbnVtQXJnczogNiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQ1MgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VDb2xvclNwYWNlLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LmNzID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbENvbG9yU3BhY2UsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuU0MgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VDb2xvciwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogdHJ1ZQogICAgICB9OwogICAgICB0LlNDTiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZUNvbG9yTiwKICAgICAgICBudW1BcmdzOiAzMywKICAgICAgICB2YXJpYWJsZUFyZ3M6IHRydWUKICAgICAgfTsKICAgICAgdC5zYyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxDb2xvciwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogdHJ1ZQogICAgICB9OwogICAgICB0LnNjbiA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxDb2xvck4sCiAgICAgICAgbnVtQXJnczogMzMsCiAgICAgICAgdmFyaWFibGVBcmdzOiB0cnVlCiAgICAgIH07CiAgICAgIHQuRyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZUdyYXksCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuZyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxHcmF5LAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LlJHID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3IsCiAgICAgICAgbnVtQXJnczogMywKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQucmcgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGaWxsUkdCQ29sb3IsCiAgICAgICAgbnVtQXJnczogMywKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuSyA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZUNNWUtDb2xvciwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5rID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbENNWUtDb2xvciwKICAgICAgICBudW1BcmdzOiA0LAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5zaCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLnNoYWRpbmdGaWxsLAogICAgICAgIG51bUFyZ3M6IDEsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkJJID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5JbmxpbmVJbWFnZSwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5JRCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmJlZ2luSW1hZ2VEYXRhLAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkVJID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZW5kSW5saW5lSW1hZ2UsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuRG8gPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5wYWludFhPYmplY3QsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuTVAgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5tYXJrUG9pbnQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuRFAgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5tYXJrUG9pbnRQcm9wcywKICAgICAgICBudW1BcmdzOiAyLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5CTUMgPSB7CiAgICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnQsCiAgICAgICAgbnVtQXJnczogMSwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuQkRDID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5NYXJrZWRDb250ZW50UHJvcHMsCiAgICAgICAgbnVtQXJnczogMiwKICAgICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICAgIH07CiAgICAgIHQuRU1DID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZW5kTWFya2VkQ29udGVudCwKICAgICAgICBudW1BcmdzOiAwLAogICAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgICAgfTsKICAgICAgdC5CWCA9IHsKICAgICAgICBpZDogX3V0aWwuT1BTLmJlZ2luQ29tcGF0LAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkVYID0gewogICAgICAgIGlkOiBfdXRpbC5PUFMuZW5kQ29tcGF0LAogICAgICAgIG51bUFyZ3M6IDAsCiAgICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgICB9OwogICAgICB0LkJNID0gbnVsbDsKICAgICAgdC5CRCA9IG51bGw7CiAgICAgIHQudHJ1ZSA9IG51bGw7CiAgICAgIHQuZmEgPSBudWxsOwogICAgICB0LmZhbCA9IG51bGw7CiAgICAgIHQuZmFscyA9IG51bGw7CiAgICAgIHQuZmFsc2UgPSBudWxsOwogICAgICB0Lm51ID0gbnVsbDsKICAgICAgdC5udWwgPSBudWxsOwogICAgICB0Lm51bGwgPSBudWxsOwogICAgfSk7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm9wTWFwIiwgZ2V0T1BNYXAoKSk7CiAgfQoKICBzdGF0aWMgZ2V0IE1BWF9JTlZBTElEX1BBVEhfT1BTKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNQVhfSU5WQUxJRF9QQVRIX09QUyIsIDEwKTsKICB9CgogIGNvbnN0cnVjdG9yKHN0cmVhbSwgeHJlZiwgc3RhdGVNYW5hZ2VyID0gbmV3IFN0YXRlTWFuYWdlcigpKSB7CiAgICB0aGlzLnBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgIGxleGVyOiBuZXcgX3BhcnNlci5MZXhlcihzdHJlYW0sIEV2YWx1YXRvclByZXByb2Nlc3Nvci5vcE1hcCksCiAgICAgIHhyZWYKICAgIH0pOwogICAgdGhpcy5zdGF0ZU1hbmFnZXIgPSBzdGF0ZU1hbmFnZXI7CiAgICB0aGlzLm5vblByb2Nlc3NlZEFyZ3MgPSBbXTsKICAgIHRoaXMuX2lzUGF0aE9wID0gZmFsc2U7CiAgICB0aGlzLl9udW1JbnZhbGlkUGF0aE9QUyA9IDA7CiAgfQoKICBnZXQgc2F2ZWRTdGF0ZXNEZXB0aCgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlTWFuYWdlci5zdGF0ZVN0YWNrLmxlbmd0aDsKICB9CgogIHJlYWQob3BlcmF0aW9uKSB7CiAgICBsZXQgYXJncyA9IG9wZXJhdGlvbi5hcmdzOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGNvbnN0IG9iaiA9IHRoaXMucGFyc2VyLmdldE9iaigpOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCkgewogICAgICAgIGNvbnN0IGNtZCA9IG9iai5jbWQ7CiAgICAgICAgY29uc3Qgb3BTcGVjID0gRXZhbHVhdG9yUHJlcHJvY2Vzc29yLm9wTWFwW2NtZF07CgogICAgICAgIGlmICghb3BTcGVjKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFVua25vd24gY29tbWFuZCAiJHtjbWR9Ii5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgZm4gPSBvcFNwZWMuaWQ7CiAgICAgICAgY29uc3QgbnVtQXJncyA9IG9wU3BlYy5udW1BcmdzOwogICAgICAgIGxldCBhcmdzTGVuZ3RoID0gYXJncyAhPT0gbnVsbCA/IGFyZ3MubGVuZ3RoIDogMDsKCiAgICAgICAgaWYgKCF0aGlzLl9pc1BhdGhPcCkgewogICAgICAgICAgdGhpcy5fbnVtSW52YWxpZFBhdGhPUFMgPSAwOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5faXNQYXRoT3AgPSBmbiA+PSBfdXRpbC5PUFMubW92ZVRvICYmIGZuIDw9IF91dGlsLk9QUy5lbmRQYXRoOwoKICAgICAgICBpZiAoIW9wU3BlYy52YXJpYWJsZUFyZ3MpIHsKICAgICAgICAgIGlmIChhcmdzTGVuZ3RoICE9PSBudW1BcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IG5vblByb2Nlc3NlZEFyZ3MgPSB0aGlzLm5vblByb2Nlc3NlZEFyZ3M7CgogICAgICAgICAgICB3aGlsZSAoYXJnc0xlbmd0aCA+IG51bUFyZ3MpIHsKICAgICAgICAgICAgICBub25Qcm9jZXNzZWRBcmdzLnB1c2goYXJncy5zaGlmdCgpKTsKICAgICAgICAgICAgICBhcmdzTGVuZ3RoLS07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdoaWxlIChhcmdzTGVuZ3RoIDwgbnVtQXJncyAmJiBub25Qcm9jZXNzZWRBcmdzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICAgIGlmIChhcmdzID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBhcmdzID0gW107CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBhcmdzLnVuc2hpZnQobm9uUHJvY2Vzc2VkQXJncy5wb3AoKSk7CiAgICAgICAgICAgICAgYXJnc0xlbmd0aCsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGFyZ3NMZW5ndGggPCBudW1BcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IHBhcnRpYWxNc2cgPSBgY29tbWFuZCAke2NtZH06IGV4cGVjdGVkICR7bnVtQXJnc30gYXJncywgYCArIGBidXQgcmVjZWl2ZWQgJHthcmdzTGVuZ3RofSBhcmdzLmA7CgogICAgICAgICAgICBpZiAodGhpcy5faXNQYXRoT3AgJiYgKyt0aGlzLl9udW1JbnZhbGlkUGF0aE9QUyA+IEV2YWx1YXRvclByZXByb2Nlc3Nvci5NQVhfSU5WQUxJRF9QQVRIX09QUykgewogICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCAke3BhcnRpYWxNc2d9YCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgU2tpcHBpbmcgJHtwYXJ0aWFsTXNnfWApOwoKICAgICAgICAgICAgaWYgKGFyZ3MgIT09IG51bGwpIHsKICAgICAgICAgICAgICBhcmdzLmxlbmd0aCA9IDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoYXJnc0xlbmd0aCA+IG51bUFyZ3MpIHsKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKShgQ29tbWFuZCAke2NtZH06IGV4cGVjdGVkIFswLCAke251bUFyZ3N9XSBhcmdzLCBgICsgYGJ1dCByZWNlaXZlZCAke2FyZ3NMZW5ndGh9IGFyZ3MuYCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnByZXByb2Nlc3NDb21tYW5kKGZuLCBhcmdzKTsKICAgICAgICBvcGVyYXRpb24uZm4gPSBmbjsKICAgICAgICBvcGVyYXRpb24uYXJncyA9IGFyZ3M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKG9iaiAhPT0gbnVsbCkgewogICAgICAgIGlmIChhcmdzID09PSBudWxsKSB7CiAgICAgICAgICBhcmdzID0gW107CiAgICAgICAgfQoKICAgICAgICBhcmdzLnB1c2gob2JqKTsKCiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMzMpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVG9vIG1hbnkgYXJndW1lbnRzIik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBwcmVwcm9jZXNzQ29tbWFuZChmbiwgYXJncykgewogICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgY2FzZSBfdXRpbC5PUFMuc2F2ZToKICAgICAgICB0aGlzLnN0YXRlTWFuYWdlci5zYXZlKCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIF91dGlsLk9QUy5yZXN0b3JlOgogICAgICAgIHRoaXMuc3RhdGVNYW5hZ2VyLnJlc3RvcmUoKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgX3V0aWwuT1BTLnRyYW5zZm9ybToKICAgICAgICB0aGlzLnN0YXRlTWFuYWdlci50cmFuc2Zvcm0oYXJncyk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5FdmFsdWF0b3JQcmVwcm9jZXNzb3IgPSBFdmFsdWF0b3JQcmVwcm9jZXNzb3I7CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5JZGVudGl0eUNNYXAgPSBleHBvcnRzLkNNYXBGYWN0b3J5ID0gZXhwb3J0cy5DTWFwID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNyk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCmNvbnN0IEJVSUxUX0lOX0NNQVBTID0gWyJBZG9iZS1HQjEtVUNTMiIsICJBZG9iZS1DTlMxLVVDUzIiLCAiQWRvYmUtSmFwYW4xLVVDUzIiLCAiQWRvYmUtS29yZWExLVVDUzIiLCAiNzgtRVVDLUgiLCAiNzgtRVVDLVYiLCAiNzgtSCIsICI3OC1SS1NKLUgiLCAiNzgtUktTSi1WIiwgIjc4LVYiLCAiNzhtcy1SS1NKLUgiLCAiNzhtcy1SS1NKLVYiLCAiODNwdi1SS1NKLUgiLCAiOTBtcy1SS1NKLUgiLCAiOTBtcy1SS1NKLVYiLCAiOTBtc3AtUktTSi1IIiwgIjkwbXNwLVJLU0otViIsICI5MHB2LVJLU0otSCIsICI5MHB2LVJLU0otViIsICJBZGQtSCIsICJBZGQtUktTSi1IIiwgIkFkZC1SS1NKLVYiLCAiQWRkLVYiLCAiQWRvYmUtQ05TMS0wIiwgIkFkb2JlLUNOUzEtMSIsICJBZG9iZS1DTlMxLTIiLCAiQWRvYmUtQ05TMS0zIiwgIkFkb2JlLUNOUzEtNCIsICJBZG9iZS1DTlMxLTUiLCAiQWRvYmUtQ05TMS02IiwgIkFkb2JlLUdCMS0wIiwgIkFkb2JlLUdCMS0xIiwgIkFkb2JlLUdCMS0yIiwgIkFkb2JlLUdCMS0zIiwgIkFkb2JlLUdCMS00IiwgIkFkb2JlLUdCMS01IiwgIkFkb2JlLUphcGFuMS0wIiwgIkFkb2JlLUphcGFuMS0xIiwgIkFkb2JlLUphcGFuMS0yIiwgIkFkb2JlLUphcGFuMS0zIiwgIkFkb2JlLUphcGFuMS00IiwgIkFkb2JlLUphcGFuMS01IiwgIkFkb2JlLUphcGFuMS02IiwgIkFkb2JlLUtvcmVhMS0wIiwgIkFkb2JlLUtvcmVhMS0xIiwgIkFkb2JlLUtvcmVhMS0yIiwgIkI1LUgiLCAiQjUtViIsICJCNXBjLUgiLCAiQjVwYy1WIiwgIkNOUy1FVUMtSCIsICJDTlMtRVVDLVYiLCAiQ05TMS1IIiwgIkNOUzEtViIsICJDTlMyLUgiLCAiQ05TMi1WIiwgIkVUSEstQjUtSCIsICJFVEhLLUI1LVYiLCAiRVRlbi1CNS1IIiwgIkVUZW4tQjUtViIsICJFVGVubXMtQjUtSCIsICJFVGVubXMtQjUtViIsICJFVUMtSCIsICJFVUMtViIsICJFeHQtSCIsICJFeHQtUktTSi1IIiwgIkV4dC1SS1NKLVYiLCAiRXh0LVYiLCAiR0ItRVVDLUgiLCAiR0ItRVVDLVYiLCAiR0ItSCIsICJHQi1WIiwgIkdCSy1FVUMtSCIsICJHQkstRVVDLVYiLCAiR0JLMkstSCIsICJHQksySy1WIiwgIkdCS3AtRVVDLUgiLCAiR0JLcC1FVUMtViIsICJHQlQtRVVDLUgiLCAiR0JULUVVQy1WIiwgIkdCVC1IIiwgIkdCVC1WIiwgIkdCVHBjLUVVQy1IIiwgIkdCVHBjLUVVQy1WIiwgIkdCcGMtRVVDLUgiLCAiR0JwYy1FVUMtViIsICJIIiwgIkhLZGxhLUI1LUgiLCAiSEtkbGEtQjUtViIsICJIS2RsYi1CNS1IIiwgIkhLZGxiLUI1LVYiLCAiSEtnY2NzLUI1LUgiLCAiSEtnY2NzLUI1LVYiLCAiSEttMzE0LUI1LUgiLCAiSEttMzE0LUI1LVYiLCAiSEttNDcxLUI1LUgiLCAiSEttNDcxLUI1LVYiLCAiSEtzY3MtQjUtSCIsICJIS3Njcy1CNS1WIiwgIkhhbmtha3UiLCAiSGlyYWdhbmEiLCAiS1NDLUVVQy1IIiwgIktTQy1FVUMtViIsICJLU0MtSCIsICJLU0MtSm9oYWItSCIsICJLU0MtSm9oYWItViIsICJLU0MtViIsICJLU0Ntcy1VSEMtSCIsICJLU0Ntcy1VSEMtSFctSCIsICJLU0Ntcy1VSEMtSFctViIsICJLU0Ntcy1VSEMtViIsICJLU0NwYy1FVUMtSCIsICJLU0NwYy1FVUMtViIsICJLYXRha2FuYSIsICJOV1AtSCIsICJOV1AtViIsICJSS1NKLUgiLCAiUktTSi1WIiwgIlJvbWFuIiwgIlVuaUNOUy1VQ1MyLUgiLCAiVW5pQ05TLVVDUzItViIsICJVbmlDTlMtVVRGMTYtSCIsICJVbmlDTlMtVVRGMTYtViIsICJVbmlDTlMtVVRGMzItSCIsICJVbmlDTlMtVVRGMzItViIsICJVbmlDTlMtVVRGOC1IIiwgIlVuaUNOUy1VVEY4LVYiLCAiVW5pR0ItVUNTMi1IIiwgIlVuaUdCLVVDUzItViIsICJVbmlHQi1VVEYxNi1IIiwgIlVuaUdCLVVURjE2LVYiLCAiVW5pR0ItVVRGMzItSCIsICJVbmlHQi1VVEYzMi1WIiwgIlVuaUdCLVVURjgtSCIsICJVbmlHQi1VVEY4LVYiLCAiVW5pSklTLVVDUzItSCIsICJVbmlKSVMtVUNTMi1IVy1IIiwgIlVuaUpJUy1VQ1MyLUhXLVYiLCAiVW5pSklTLVVDUzItViIsICJVbmlKSVMtVVRGMTYtSCIsICJVbmlKSVMtVVRGMTYtViIsICJVbmlKSVMtVVRGMzItSCIsICJVbmlKSVMtVVRGMzItViIsICJVbmlKSVMtVVRGOC1IIiwgIlVuaUpJUy1VVEY4LVYiLCAiVW5pSklTMjAwNC1VVEYxNi1IIiwgIlVuaUpJUzIwMDQtVVRGMTYtViIsICJVbmlKSVMyMDA0LVVURjMyLUgiLCAiVW5pSklTMjAwNC1VVEYzMi1WIiwgIlVuaUpJUzIwMDQtVVRGOC1IIiwgIlVuaUpJUzIwMDQtVVRGOC1WIiwgIlVuaUpJU1Byby1VQ1MyLUhXLVYiLCAiVW5pSklTUHJvLVVDUzItViIsICJVbmlKSVNQcm8tVVRGOC1WIiwgIlVuaUpJU1gwMjEzLVVURjMyLUgiLCAiVW5pSklTWDAyMTMtVVRGMzItViIsICJVbmlKSVNYMDIxMzIwMDQtVVRGMzItSCIsICJVbmlKSVNYMDIxMzIwMDQtVVRGMzItViIsICJVbmlLUy1VQ1MyLUgiLCAiVW5pS1MtVUNTMi1WIiwgIlVuaUtTLVVURjE2LUgiLCAiVW5pS1MtVVRGMTYtViIsICJVbmlLUy1VVEYzMi1IIiwgIlVuaUtTLVVURjMyLVYiLCAiVW5pS1MtVVRGOC1IIiwgIlVuaUtTLVVURjgtViIsICJWIiwgIldQLVN5bWJvbCJdOwpjb25zdCBNQVhfTUFQX1JBTkdFID0gMiAqKiAyNCAtIDE7CgpjbGFzcyBDTWFwIHsKICBjb25zdHJ1Y3RvcihidWlsdEluQ01hcCA9IGZhbHNlKSB7CiAgICB0aGlzLmNvZGVzcGFjZVJhbmdlcyA9IFtbXSwgW10sIFtdLCBbXV07CiAgICB0aGlzLm51bUNvZGVzcGFjZVJhbmdlcyA9IDA7CiAgICB0aGlzLl9tYXAgPSBbXTsKICAgIHRoaXMubmFtZSA9ICIiOwogICAgdGhpcy52ZXJ0aWNhbCA9IGZhbHNlOwogICAgdGhpcy51c2VDTWFwID0gbnVsbDsKICAgIHRoaXMuYnVpbHRJbkNNYXAgPSBidWlsdEluQ01hcDsKICB9CgogIGFkZENvZGVzcGFjZVJhbmdlKG4sIGxvdywgaGlnaCkgewogICAgdGhpcy5jb2Rlc3BhY2VSYW5nZXNbbiAtIDFdLnB1c2gobG93LCBoaWdoKTsKICAgIHRoaXMubnVtQ29kZXNwYWNlUmFuZ2VzKys7CiAgfQoKICBtYXBDaWRSYW5nZShsb3csIGhpZ2gsIGRzdExvdykgewogICAgaWYgKGhpZ2ggLSBsb3cgPiBNQVhfTUFQX1JBTkdFKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwQ2lkUmFuZ2UgLSBpZ25vcmluZyBkYXRhIGFib3ZlIE1BWF9NQVBfUkFOR0UuIik7CiAgICB9CgogICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7CiAgICAgIHRoaXMuX21hcFtsb3crK10gPSBkc3RMb3crKzsKICAgIH0KICB9CgogIG1hcEJmUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpIHsKICAgIGlmIChoaWdoIC0gbG93ID4gTUFYX01BUF9SQU5HRSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIm1hcEJmUmFuZ2UgLSBpZ25vcmluZyBkYXRhIGFib3ZlIE1BWF9NQVBfUkFOR0UuIik7CiAgICB9CgogICAgY29uc3QgbGFzdEJ5dGUgPSBkc3RMb3cubGVuZ3RoIC0gMTsKCiAgICB3aGlsZSAobG93IDw9IGhpZ2gpIHsKICAgICAgdGhpcy5fbWFwW2xvdysrXSA9IGRzdExvdzsKICAgICAgY29uc3QgbmV4dENoYXJDb2RlID0gZHN0TG93LmNoYXJDb2RlQXQobGFzdEJ5dGUpICsgMTsKCiAgICAgIGlmIChuZXh0Q2hhckNvZGUgPiAweGZmKSB7CiAgICAgICAgZHN0TG93ID0gZHN0TG93LnN1YnN0cmluZygwLCBsYXN0Qnl0ZSAtIDEpICsgU3RyaW5nLmZyb21DaGFyQ29kZShkc3RMb3cuY2hhckNvZGVBdChsYXN0Qnl0ZSAtIDEpICsgMSkgKyAiXHgwMCI7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGRzdExvdyA9IGRzdExvdy5zdWJzdHJpbmcoMCwgbGFzdEJ5dGUpICsgU3RyaW5nLmZyb21DaGFyQ29kZShuZXh0Q2hhckNvZGUpOwogICAgfQogIH0KCiAgbWFwQmZSYW5nZVRvQXJyYXkobG93LCBoaWdoLCBhcnJheSkgewogICAgaWYgKGhpZ2ggLSBsb3cgPiBNQVhfTUFQX1JBTkdFKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwQmZSYW5nZVRvQXJyYXkgLSBpZ25vcmluZyBkYXRhIGFib3ZlIE1BWF9NQVBfUkFOR0UuIik7CiAgICB9CgogICAgY29uc3QgaWkgPSBhcnJheS5sZW5ndGg7CiAgICBsZXQgaSA9IDA7CgogICAgd2hpbGUgKGxvdyA8PSBoaWdoICYmIGkgPCBpaSkgewogICAgICB0aGlzLl9tYXBbbG93XSA9IGFycmF5W2krK107CiAgICAgICsrbG93OwogICAgfQogIH0KCiAgbWFwT25lKHNyYywgZHN0KSB7CiAgICB0aGlzLl9tYXBbc3JjXSA9IGRzdDsKICB9CgogIGxvb2t1cChjb2RlKSB7CiAgICByZXR1cm4gdGhpcy5fbWFwW2NvZGVdOwogIH0KCiAgY29udGFpbnMoY29kZSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtjb2RlXSAhPT0gdW5kZWZpbmVkOwogIH0KCiAgZm9yRWFjaChjYWxsYmFjaykgewogICAgY29uc3QgbWFwID0gdGhpcy5fbWFwOwogICAgY29uc3QgbGVuZ3RoID0gbWFwLmxlbmd0aDsKCiAgICBpZiAobGVuZ3RoIDw9IDB4MTAwMDApIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGlmIChtYXBbaV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgY2FsbGJhY2soaSwgbWFwW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAoY29uc3QgaSBpbiBtYXApIHsKICAgICAgICBjYWxsYmFjayhpLCBtYXBbaV0pOwogICAgICB9CiAgICB9CiAgfQoKICBjaGFyQ29kZU9mKHZhbHVlKSB7CiAgICBjb25zdCBtYXAgPSB0aGlzLl9tYXA7CgogICAgaWYgKG1hcC5sZW5ndGggPD0gMHgxMDAwMCkgewogICAgICByZXR1cm4gbWFwLmluZGV4T2YodmFsdWUpOwogICAgfQoKICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gbWFwKSB7CiAgICAgIGlmIChtYXBbY2hhckNvZGVdID09PSB2YWx1ZSkgewogICAgICAgIHJldHVybiBjaGFyQ29kZSB8IDA7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gLTE7CiAgfQoKICBnZXRNYXAoKSB7CiAgICByZXR1cm4gdGhpcy5fbWFwOwogIH0KCiAgcmVhZENoYXJDb2RlKHN0ciwgb2Zmc2V0LCBvdXQpIHsKICAgIGxldCBjID0gMDsKICAgIGNvbnN0IGNvZGVzcGFjZVJhbmdlcyA9IHRoaXMuY29kZXNwYWNlUmFuZ2VzOwoKICAgIGZvciAobGV0IG4gPSAwLCBubiA9IGNvZGVzcGFjZVJhbmdlcy5sZW5ndGg7IG4gPCBubjsgbisrKSB7CiAgICAgIGMgPSAoYyA8PCA4IHwgc3RyLmNoYXJDb2RlQXQob2Zmc2V0ICsgbikpID4+PiAwOwogICAgICBjb25zdCBjb2Rlc3BhY2VSYW5nZSA9IGNvZGVzcGFjZVJhbmdlc1tuXTsKCiAgICAgIGZvciAobGV0IGsgPSAwLCBrayA9IGNvZGVzcGFjZVJhbmdlLmxlbmd0aDsgayA8IGtrOykgewogICAgICAgIGNvbnN0IGxvdyA9IGNvZGVzcGFjZVJhbmdlW2srK107CiAgICAgICAgY29uc3QgaGlnaCA9IGNvZGVzcGFjZVJhbmdlW2srK107CgogICAgICAgIGlmIChjID49IGxvdyAmJiBjIDw9IGhpZ2gpIHsKICAgICAgICAgIG91dC5jaGFyY29kZSA9IGM7CiAgICAgICAgICBvdXQubGVuZ3RoID0gbiArIDE7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgb3V0LmNoYXJjb2RlID0gMDsKICAgIG91dC5sZW5ndGggPSAxOwogIH0KCiAgZ2V0Q2hhckNvZGVMZW5ndGgoY2hhckNvZGUpIHsKICAgIGNvbnN0IGNvZGVzcGFjZVJhbmdlcyA9IHRoaXMuY29kZXNwYWNlUmFuZ2VzOwoKICAgIGZvciAobGV0IG4gPSAwLCBubiA9IGNvZGVzcGFjZVJhbmdlcy5sZW5ndGg7IG4gPCBubjsgbisrKSB7CiAgICAgIGNvbnN0IGNvZGVzcGFjZVJhbmdlID0gY29kZXNwYWNlUmFuZ2VzW25dOwoKICAgICAgZm9yIChsZXQgayA9IDAsIGtrID0gY29kZXNwYWNlUmFuZ2UubGVuZ3RoOyBrIDwga2s7KSB7CiAgICAgICAgY29uc3QgbG93ID0gY29kZXNwYWNlUmFuZ2VbaysrXTsKICAgICAgICBjb25zdCBoaWdoID0gY29kZXNwYWNlUmFuZ2VbaysrXTsKCiAgICAgICAgaWYgKGNoYXJDb2RlID49IGxvdyAmJiBjaGFyQ29kZSA8PSBoaWdoKSB7CiAgICAgICAgICByZXR1cm4gbiArIDE7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIDE7CiAgfQoKICBnZXQgbGVuZ3RoKCkgewogICAgcmV0dXJuIHRoaXMuX21hcC5sZW5ndGg7CiAgfQoKICBnZXQgaXNJZGVudGl0eUNNYXAoKSB7CiAgICBpZiAoISh0aGlzLm5hbWUgPT09ICJJZGVudGl0eS1IIiB8fCB0aGlzLm5hbWUgPT09ICJJZGVudGl0eS1WIikpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLl9tYXAubGVuZ3RoICE9PSAweDEwMDAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDB4MTAwMDA7IGkrKykgewogICAgICBpZiAodGhpcy5fbWFwW2ldICE9PSBpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKZXhwb3J0cy5DTWFwID0gQ01hcDsKCmNsYXNzIElkZW50aXR5Q01hcCBleHRlbmRzIENNYXAgewogIGNvbnN0cnVjdG9yKHZlcnRpY2FsLCBuKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy52ZXJ0aWNhbCA9IHZlcnRpY2FsOwogICAgdGhpcy5hZGRDb2Rlc3BhY2VSYW5nZShuLCAwLCAweGZmZmYpOwogIH0KCiAgbWFwQ2lkUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoInNob3VsZCBub3QgY2FsbCBtYXBDaWRSYW5nZSIpOwogIH0KCiAgbWFwQmZSYW5nZShsb3csIGhpZ2gsIGRzdExvdykgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgic2hvdWxkIG5vdCBjYWxsIG1hcEJmUmFuZ2UiKTsKICB9CgogIG1hcEJmUmFuZ2VUb0FycmF5KGxvdywgaGlnaCwgYXJyYXkpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoInNob3VsZCBub3QgY2FsbCBtYXBCZlJhbmdlVG9BcnJheSIpOwogIH0KCiAgbWFwT25lKHNyYywgZHN0KSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgbWFwQ2lkT25lIik7CiAgfQoKICBsb29rdXAoY29kZSkgewogICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIoY29kZSkgJiYgY29kZSA8PSAweGZmZmYgPyBjb2RlIDogdW5kZWZpbmVkOwogIH0KCiAgY29udGFpbnMoY29kZSkgewogICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIoY29kZSkgJiYgY29kZSA8PSAweGZmZmY7CiAgfQoKICBmb3JFYWNoKGNhbGxiYWNrKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAweGZmZmY7IGkrKykgewogICAgICBjYWxsYmFjayhpLCBpKTsKICAgIH0KICB9CgogIGNoYXJDb2RlT2YodmFsdWUpIHsKICAgIHJldHVybiBOdW1iZXIuaXNJbnRlZ2VyKHZhbHVlKSAmJiB2YWx1ZSA8PSAweGZmZmYgPyB2YWx1ZSA6IC0xOwogIH0KCiAgZ2V0TWFwKCkgewogICAgY29uc3QgbWFwID0gbmV3IEFycmF5KDB4MTAwMDApOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IDB4ZmZmZjsgaSsrKSB7CiAgICAgIG1hcFtpXSA9IGk7CiAgICB9CgogICAgcmV0dXJuIG1hcDsKICB9CgogIGdldCBsZW5ndGgoKSB7CiAgICByZXR1cm4gMHgxMDAwMDsKICB9CgogIGdldCBpc0lkZW50aXR5Q01hcCgpIHsKICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoInNob3VsZCBub3QgYWNjZXNzIC5pc0lkZW50aXR5Q01hcCIpOwogIH0KCn0KCmV4cG9ydHMuSWRlbnRpdHlDTWFwID0gSWRlbnRpdHlDTWFwOwoKY29uc3QgQmluYXJ5Q01hcFJlYWRlciA9IGZ1bmN0aW9uIEJpbmFyeUNNYXBSZWFkZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGhleFRvSW50KGEsIHNpemUpIHsKICAgIGxldCBuID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzaXplOyBpKyspIHsKICAgICAgbiA9IG4gPDwgOCB8IGFbaV07CiAgICB9CgogICAgcmV0dXJuIG4gPj4+IDA7CiAgfQoKICBmdW5jdGlvbiBoZXhUb1N0cihhLCBzaXplKSB7CiAgICBpZiAoc2l6ZSA9PT0gMSkgewogICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShhWzBdLCBhWzFdKTsKICAgIH0KCiAgICBpZiAoc2l6ZSA9PT0gMykgewogICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdKTsKICAgIH0KCiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBhLnN1YmFycmF5KDAsIHNpemUgKyAxKSk7CiAgfQoKICBmdW5jdGlvbiBhZGRIZXgoYSwgYiwgc2l6ZSkgewogICAgbGV0IGMgPSAwOwoKICAgIGZvciAobGV0IGkgPSBzaXplOyBpID49IDA7IGktLSkgewogICAgICBjICs9IGFbaV0gKyBiW2ldOwogICAgICBhW2ldID0gYyAmIDI1NTsKICAgICAgYyA+Pj0gODsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGluY0hleChhLCBzaXplKSB7CiAgICBsZXQgYyA9IDE7CgogICAgZm9yIChsZXQgaSA9IHNpemU7IGkgPj0gMCAmJiBjID4gMDsgaS0tKSB7CiAgICAgIGMgKz0gYVtpXTsKICAgICAgYVtpXSA9IGMgJiAyNTU7CiAgICAgIGMgPj49IDg7CiAgICB9CiAgfQoKICBjb25zdCBNQVhfTlVNX1NJWkUgPSAxNjsKICBjb25zdCBNQVhfRU5DT0RFRF9OVU1fU0laRSA9IDE5OwoKICBjbGFzcyBCaW5hcnlDTWFwU3RyZWFtIHsKICAgIGNvbnN0cnVjdG9yKGRhdGEpIHsKICAgICAgdGhpcy5idWZmZXIgPSBkYXRhOwogICAgICB0aGlzLnBvcyA9IDA7CiAgICAgIHRoaXMuZW5kID0gZGF0YS5sZW5ndGg7CiAgICAgIHRoaXMudG1wQnVmID0gbmV3IFVpbnQ4QXJyYXkoTUFYX0VOQ09ERURfTlVNX1NJWkUpOwogICAgfQoKICAgIHJlYWRCeXRlKCkgewogICAgICBpZiAodGhpcy5wb3MgPj0gdGhpcy5lbmQpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmJ1ZmZlclt0aGlzLnBvcysrXTsKICAgIH0KCiAgICByZWFkTnVtYmVyKCkgewogICAgICBsZXQgbiA9IDA7CiAgICAgIGxldCBsYXN0OwoKICAgICAgZG8gewogICAgICAgIGNvbnN0IGIgPSB0aGlzLnJlYWRCeXRlKCk7CgogICAgICAgIGlmIChiIDwgMCkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bmV4cGVjdGVkIEVPRiBpbiBiY21hcCIpOwogICAgICAgIH0KCiAgICAgICAgbGFzdCA9ICEoYiAmIDB4ODApOwogICAgICAgIG4gPSBuIDw8IDcgfCBiICYgMHg3ZjsKICAgICAgfSB3aGlsZSAoIWxhc3QpOwoKICAgICAgcmV0dXJuIG47CiAgICB9CgogICAgcmVhZFNpZ25lZCgpIHsKICAgICAgY29uc3QgbiA9IHRoaXMucmVhZE51bWJlcigpOwogICAgICByZXR1cm4gbiAmIDEgPyB+KG4gPj4+IDEpIDogbiA+Pj4gMTsKICAgIH0KCiAgICByZWFkSGV4KG51bSwgc2l6ZSkgewogICAgICBudW0uc2V0KHRoaXMuYnVmZmVyLnN1YmFycmF5KHRoaXMucG9zLCB0aGlzLnBvcyArIHNpemUgKyAxKSk7CiAgICAgIHRoaXMucG9zICs9IHNpemUgKyAxOwogICAgfQoKICAgIHJlYWRIZXhOdW1iZXIobnVtLCBzaXplKSB7CiAgICAgIGxldCBsYXN0OwogICAgICBjb25zdCBzdGFjayA9IHRoaXMudG1wQnVmOwogICAgICBsZXQgc3AgPSAwOwoKICAgICAgZG8gewogICAgICAgIGNvbnN0IGIgPSB0aGlzLnJlYWRCeXRlKCk7CgogICAgICAgIGlmIChiIDwgMCkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bmV4cGVjdGVkIEVPRiBpbiBiY21hcCIpOwogICAgICAgIH0KCiAgICAgICAgbGFzdCA9ICEoYiAmIDB4ODApOwogICAgICAgIHN0YWNrW3NwKytdID0gYiAmIDB4N2Y7CiAgICAgIH0gd2hpbGUgKCFsYXN0KTsKCiAgICAgIGxldCBpID0gc2l6ZSwKICAgICAgICAgIGJ1ZmZlciA9IDAsCiAgICAgICAgICBidWZmZXJTaXplID0gMDsKCiAgICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICB3aGlsZSAoYnVmZmVyU2l6ZSA8IDggJiYgc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgYnVmZmVyIHw9IHN0YWNrWy0tc3BdIDw8IGJ1ZmZlclNpemU7CiAgICAgICAgICBidWZmZXJTaXplICs9IDc7CiAgICAgICAgfQoKICAgICAgICBudW1baV0gPSBidWZmZXIgJiAyNTU7CiAgICAgICAgaS0tOwogICAgICAgIGJ1ZmZlciA+Pj0gODsKICAgICAgICBidWZmZXJTaXplIC09IDg7CiAgICAgIH0KICAgIH0KCiAgICByZWFkSGV4U2lnbmVkKG51bSwgc2l6ZSkgewogICAgICB0aGlzLnJlYWRIZXhOdW1iZXIobnVtLCBzaXplKTsKICAgICAgY29uc3Qgc2lnbiA9IG51bVtzaXplXSAmIDEgPyAyNTUgOiAwOwogICAgICBsZXQgYyA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBzaXplOyBpKyspIHsKICAgICAgICBjID0gKGMgJiAxKSA8PCA4IHwgbnVtW2ldOwogICAgICAgIG51bVtpXSA9IGMgPj4gMSBeIHNpZ247CiAgICAgIH0KICAgIH0KCiAgICByZWFkU3RyaW5nKCkgewogICAgICBjb25zdCBsZW4gPSB0aGlzLnJlYWROdW1iZXIoKTsKICAgICAgbGV0IHMgPSAiIjsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICBzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkTnVtYmVyKCkpOwogICAgICB9CgogICAgICByZXR1cm4gczsKICAgIH0KCiAgfQoKICBjbGFzcyBCaW5hcnlDTWFwUmVhZGVyIHsKICAgIGFzeW5jIHByb2Nlc3MoZGF0YSwgY01hcCwgZXh0ZW5kKSB7CiAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBCaW5hcnlDTWFwU3RyZWFtKGRhdGEpOwogICAgICBjb25zdCBoZWFkZXIgPSBzdHJlYW0ucmVhZEJ5dGUoKTsKICAgICAgY01hcC52ZXJ0aWNhbCA9ICEhKGhlYWRlciAmIDEpOwogICAgICBsZXQgdXNlQ01hcCA9IG51bGw7CiAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgY29uc3QgZW5kID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgY29uc3QgY2hhciA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIGNvbnN0IGNoYXJDb2RlID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgY29uc3QgdG1wID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgbGV0IGNvZGU7CiAgICAgIGxldCBiOwoKICAgICAgd2hpbGUgKChiID0gc3RyZWFtLnJlYWRCeXRlKCkpID49IDApIHsKICAgICAgICBjb25zdCB0eXBlID0gYiA+PiA1OwoKICAgICAgICBpZiAodHlwZSA9PT0gNykgewogICAgICAgICAgc3dpdGNoIChiICYgMHgxZikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRTdHJpbmcoKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB1c2VDTWFwID0gc3RyZWFtLnJlYWRTdHJpbmcoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHNlcXVlbmNlID0gISEoYiAmIDB4MTApOwogICAgICAgIGNvbnN0IGRhdGFTaXplID0gYiAmIDE1OwoKICAgICAgICBpZiAoZGF0YVNpemUgKyAxID4gTUFYX05VTV9TSVpFKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkJpbmFyeUNNYXBSZWFkZXIucHJvY2VzczogSW52YWxpZCBkYXRhU2l6ZS4iKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHVjczJEYXRhU2l6ZSA9IDE7CiAgICAgICAgY29uc3Qgc3ViaXRlbXNDb3VudCA9IHN0cmVhbS5yZWFkTnVtYmVyKCk7CgogICAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgY01hcC5hZGRDb2Rlc3BhY2VSYW5nZShkYXRhU2l6ZSArIDEsIGhleFRvSW50KHN0YXJ0LCBkYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgZGF0YVNpemUpKTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KHN0YXJ0LCBlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGNNYXAuYWRkQ29kZXNwYWNlUmFuZ2UoZGF0YVNpemUgKyAxLCBoZXhUb0ludChzdGFydCwgZGF0YVNpemUpLCBoZXhUb0ludChlbmQsIGRhdGFTaXplKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkTnVtYmVyKCk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChzdGFydCwgZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KGNoYXIsIGRhdGFTaXplKTsKICAgICAgICAgICAgY29kZSA9IHN0cmVhbS5yZWFkTnVtYmVyKCk7CiAgICAgICAgICAgIGNNYXAubWFwT25lKGhleFRvSW50KGNoYXIsIGRhdGFTaXplKSwgY29kZSk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChjaGFyLCBkYXRhU2l6ZSk7CgogICAgICAgICAgICAgIGlmICghc2VxdWVuY2UpIHsKICAgICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgICAgYWRkSGV4KGNoYXIsIHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29kZSA9IHN0cmVhbS5yZWFkU2lnbmVkKCkgKyAoY29kZSArIDEpOwogICAgICAgICAgICAgIGNNYXAubWFwT25lKGhleFRvSW50KGNoYXIsIGRhdGFTaXplKSwgY29kZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICBjTWFwLm1hcENpZFJhbmdlKGhleFRvSW50KHN0YXJ0LCBkYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgZGF0YVNpemUpLCBjb2RlKTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGVuZCwgZGF0YVNpemUpOwoKICAgICAgICAgICAgICBpZiAoIXNlcXVlbmNlKSB7CiAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgICAgYWRkSGV4KHN0YXJ0LCBlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhcnQuc2V0KGVuZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICAgIGNNYXAubWFwQ2lkUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIGRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCBkYXRhU2l6ZSksIGNvZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KGNoYXIsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KGNoYXJDb2RlLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNNYXAubWFwT25lKGhleFRvSW50KGNoYXIsIHVjczJEYXRhU2l6ZSksIGhleFRvU3RyKGNoYXJDb2RlLCBkYXRhU2l6ZSkpOwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzdWJpdGVtc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICBpbmNIZXgoY2hhciwgdWNzMkRhdGFTaXplKTsKCiAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIodG1wLCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICAgICAgYWRkSGV4KGNoYXIsIHRtcCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGluY0hleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4U2lnbmVkKHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChjaGFyQ29kZSwgdG1wLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgY01hcC5tYXBPbmUoaGV4VG9JbnQoY2hhciwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KGNoYXJDb2RlLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNNYXAubWFwQmZSYW5nZShoZXhUb0ludChzdGFydCwgdWNzMkRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCB1Y3MyRGF0YVNpemUpLCBoZXhUb1N0cihjaGFyQ29kZSwgZGF0YVNpemUpKTsKCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGVuZCwgdWNzMkRhdGFTaXplKTsKCiAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgICBhZGRIZXgoc3RhcnQsIGVuZCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhcnQuc2V0KGVuZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoY2hhckNvZGUsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBjTWFwLm1hcEJmUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIHVjczJEYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQmluYXJ5Q01hcFJlYWRlci5wcm9jZXNzIC0gdW5rbm93biB0eXBlOiAke3R5cGV9YCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodXNlQ01hcCkgewogICAgICAgIHJldHVybiBleHRlbmQodXNlQ01hcCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjTWFwOwogICAgfQoKICB9CgogIHJldHVybiBCaW5hcnlDTWFwUmVhZGVyOwp9KCk7Cgpjb25zdCBDTWFwRmFjdG9yeSA9IGZ1bmN0aW9uIENNYXBGYWN0b3J5Q2xvc3VyZSgpIHsKICBmdW5jdGlvbiBzdHJUb0ludChzdHIpIHsKICAgIGxldCBhID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgewogICAgICBhID0gYSA8PCA4IHwgc3RyLmNoYXJDb2RlQXQoaSk7CiAgICB9CgogICAgcmV0dXJuIGEgPj4+IDA7CiAgfQoKICBmdW5jdGlvbiBleHBlY3RTdHJpbmcob2JqKSB7CiAgICBpZiAodHlwZW9mIG9iaiAhPT0gInN0cmluZyIpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNYWxmb3JtZWQgQ01hcDogZXhwZWN0ZWQgc3RyaW5nLiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZXhwZWN0SW50KG9iaikgewogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG9iaikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNYWxmb3JtZWQgQ01hcDogZXhwZWN0ZWQgaW50LiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VCZkNoYXIoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGxldCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJlbmRiZmNoYXIiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IHNyYyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICBleHBlY3RTdHJpbmcob2JqKTsKICAgICAgY29uc3QgZHN0ID0gb2JqOwogICAgICBjTWFwLm1hcE9uZShzcmMsIGRzdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUJmUmFuZ2UoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGxldCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJlbmRiZnJhbmdlIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICBjb25zdCBsb3cgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IGhpZ2ggPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG9iaikgfHwgdHlwZW9mIG9iaiA9PT0gInN0cmluZyIpIHsKICAgICAgICBjb25zdCBkc3RMb3cgPSBOdW1iZXIuaXNJbnRlZ2VyKG9iaikgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKG9iaikgOiBvYmo7CiAgICAgICAgY01hcC5tYXBCZlJhbmdlKGxvdywgaGlnaCwgZHN0TG93KTsKICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgIlsiKSkgewogICAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICAgIGNvbnN0IGFycmF5ID0gW107CgogICAgICAgIHdoaWxlICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJdIikgJiYgb2JqICE9PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICAgIGFycmF5LnB1c2gob2JqKTsKICAgICAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICAgIH0KCiAgICAgICAgY01hcC5tYXBCZlJhbmdlVG9BcnJheShsb3csIGhpZ2gsIGFycmF5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBiZiByYW5nZS4iKTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlQ2lkQ2hhcihjTWFwLCBsZXhlcikgewogICAgd2hpbGUgKHRydWUpIHsKICAgICAgbGV0IG9iaiA9IGxleGVyLmdldE9iaigpOwoKICAgICAgaWYgKG9iaiA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgImVuZGNpZGNoYXIiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IHNyYyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICBleHBlY3RJbnQob2JqKTsKICAgICAgY29uc3QgZHN0ID0gb2JqOwogICAgICBjTWFwLm1hcE9uZShzcmMsIGRzdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUNpZFJhbmdlKGNNYXAsIGxleGVyKSB7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kY2lkcmFuZ2UiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIGNvbnN0IGxvdyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICBleHBlY3RTdHJpbmcob2JqKTsKICAgICAgY29uc3QgaGlnaCA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICBleHBlY3RJbnQob2JqKTsKICAgICAgY29uc3QgZHN0TG93ID0gb2JqOwogICAgICBjTWFwLm1hcENpZFJhbmdlKGxvdywgaGlnaCwgZHN0TG93KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQ29kZXNwYWNlUmFuZ2UoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGxldCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChvYmogPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJlbmRjb2Rlc3BhY2VyYW5nZSIpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIG9iaiAhPT0gInN0cmluZyIpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29uc3QgbG93ID0gc3RyVG9JbnQob2JqKTsKICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAodHlwZW9mIG9iaiAhPT0gInN0cmluZyIpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29uc3QgaGlnaCA9IHN0clRvSW50KG9iaik7CiAgICAgIGNNYXAuYWRkQ29kZXNwYWNlUmFuZ2Uob2JqLmxlbmd0aCwgbG93LCBoaWdoKTsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgY29kZXNwYWNlIHJhbmdlLiIpOwogIH0KCiAgZnVuY3Rpb24gcGFyc2VXTW9kZShjTWFwLCBsZXhlcikgewogICAgY29uc3Qgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICBjTWFwLnZlcnRpY2FsID0gISFvYmo7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUNNYXBOYW1lKGNNYXAsIGxleGVyKSB7CiAgICBjb25zdCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICBjTWFwLm5hbWUgPSBvYmoubmFtZTsKICAgIH0KICB9CgogIGFzeW5jIGZ1bmN0aW9uIHBhcnNlQ01hcChjTWFwLCBsZXhlciwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCkgewogICAgbGV0IHByZXZpb3VzLCBlbWJlZGRlZFVzZUNNYXA7CgogICAgb2JqTG9vcDogd2hpbGUgKHRydWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgICAgaWYgKG9iaiA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgIGlmIChvYmoubmFtZSA9PT0gIldNb2RlIikgewogICAgICAgICAgICBwYXJzZVdNb2RlKGNNYXAsIGxleGVyKTsKICAgICAgICAgIH0gZWxzZSBpZiAob2JqLm5hbWUgPT09ICJDTWFwTmFtZSIpIHsKICAgICAgICAgICAgcGFyc2VDTWFwTmFtZShjTWFwLCBsZXhlcik7CiAgICAgICAgICB9CgogICAgICAgICAgcHJldmlvdXMgPSBvYmo7CiAgICAgICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5DbWQpIHsKICAgICAgICAgIHN3aXRjaCAob2JqLmNtZCkgewogICAgICAgICAgICBjYXNlICJlbmRjbWFwIjoKICAgICAgICAgICAgICBicmVhayBvYmpMb29wOwoKICAgICAgICAgICAgY2FzZSAidXNlY21hcCI6CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICAgICAgZW1iZWRkZWRVc2VDTWFwID0gcHJldmlvdXMubmFtZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5jb2Rlc3BhY2VyYW5nZSI6CiAgICAgICAgICAgICAgcGFyc2VDb2Rlc3BhY2VSYW5nZShjTWFwLCBsZXhlcik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJiZWdpbmJmY2hhciI6CiAgICAgICAgICAgICAgcGFyc2VCZkNoYXIoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5jaWRjaGFyIjoKICAgICAgICAgICAgICBwYXJzZUNpZENoYXIoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5iZnJhbmdlIjoKICAgICAgICAgICAgICBwYXJzZUJmUmFuZ2UoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5jaWRyYW5nZSI6CiAgICAgICAgICAgICAgcGFyc2VDaWRSYW5nZShjTWFwLCBsZXhlcik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBjTWFwIGRhdGE6ICIgKyBleCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXVzZUNNYXAgJiYgZW1iZWRkZWRVc2VDTWFwKSB7CiAgICAgIHVzZUNNYXAgPSBlbWJlZGRlZFVzZUNNYXA7CiAgICB9CgogICAgaWYgKHVzZUNNYXApIHsKICAgICAgcmV0dXJuIGV4dGVuZENNYXAoY01hcCwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCk7CiAgICB9CgogICAgcmV0dXJuIGNNYXA7CiAgfQoKICBhc3luYyBmdW5jdGlvbiBleHRlbmRDTWFwKGNNYXAsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApIHsKICAgIGNNYXAudXNlQ01hcCA9IGF3YWl0IGNyZWF0ZUJ1aWx0SW5DTWFwKHVzZUNNYXAsIGZldGNoQnVpbHRJbkNNYXApOwoKICAgIGlmIChjTWFwLm51bUNvZGVzcGFjZVJhbmdlcyA9PT0gMCkgewogICAgICBjb25zdCB1c2VDb2Rlc3BhY2VSYW5nZXMgPSBjTWFwLnVzZUNNYXAuY29kZXNwYWNlUmFuZ2VzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1c2VDb2Rlc3BhY2VSYW5nZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjTWFwLmNvZGVzcGFjZVJhbmdlc1tpXSA9IHVzZUNvZGVzcGFjZVJhbmdlc1tpXS5zbGljZSgpOwogICAgICB9CgogICAgICBjTWFwLm51bUNvZGVzcGFjZVJhbmdlcyA9IGNNYXAudXNlQ01hcC5udW1Db2Rlc3BhY2VSYW5nZXM7CiAgICB9CgogICAgY01hcC51c2VDTWFwLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgaWYgKCFjTWFwLmNvbnRhaW5zKGtleSkpIHsKICAgICAgICBjTWFwLm1hcE9uZShrZXksIGNNYXAudXNlQ01hcC5sb29rdXAoa2V5KSk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGNNYXA7CiAgfQoKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWlsdEluQ01hcChuYW1lLCBmZXRjaEJ1aWx0SW5DTWFwKSB7CiAgICBpZiAobmFtZSA9PT0gIklkZW50aXR5LUgiKSB7CiAgICAgIHJldHVybiBuZXcgSWRlbnRpdHlDTWFwKGZhbHNlLCAyKTsKICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gIklkZW50aXR5LVYiKSB7CiAgICAgIHJldHVybiBuZXcgSWRlbnRpdHlDTWFwKHRydWUsIDIpOwogICAgfQoKICAgIGlmICghQlVJTFRfSU5fQ01BUFMuaW5jbHVkZXMobmFtZSkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIENNYXAgbmFtZTogIiArIG5hbWUpOwogICAgfQoKICAgIGlmICghZmV0Y2hCdWlsdEluQ01hcCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIkJ1aWx0LWluIENNYXAgcGFyYW1ldGVycyBhcmUgbm90IHByb3ZpZGVkLiIpOwogICAgfQoKICAgIGNvbnN0IHsKICAgICAgY01hcERhdGEsCiAgICAgIGNvbXByZXNzaW9uVHlwZQogICAgfSA9IGF3YWl0IGZldGNoQnVpbHRJbkNNYXAobmFtZSk7CiAgICBjb25zdCBjTWFwID0gbmV3IENNYXAodHJ1ZSk7CgogICAgaWYgKGNvbXByZXNzaW9uVHlwZSA9PT0gX3V0aWwuQ01hcENvbXByZXNzaW9uVHlwZS5CSU5BUlkpIHsKICAgICAgcmV0dXJuIG5ldyBCaW5hcnlDTWFwUmVhZGVyKCkucHJvY2VzcyhjTWFwRGF0YSwgY01hcCwgdXNlQ01hcCA9PiB7CiAgICAgICAgcmV0dXJuIGV4dGVuZENNYXAoY01hcCwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCk7CiAgICAgIH0pOwogICAgfQoKICAgIGlmIChjb21wcmVzc2lvblR5cGUgPT09IF91dGlsLkNNYXBDb21wcmVzc2lvblR5cGUuTk9ORSkgewogICAgICBjb25zdCBsZXhlciA9IG5ldyBfcGFyc2VyLkxleGVyKG5ldyBfc3RyZWFtLlN0cmVhbShjTWFwRGF0YSkpOwogICAgICByZXR1cm4gcGFyc2VDTWFwKGNNYXAsIGxleGVyLCBmZXRjaEJ1aWx0SW5DTWFwLCBudWxsKTsKICAgIH0KCiAgICB0aHJvdyBuZXcgRXJyb3IoIlRPRE86IE9ubHkgQklOQVJZL05PTkUgQ01hcCBjb21wcmVzc2lvbiBpcyBjdXJyZW50bHkgc3VwcG9ydGVkLiIpOwogIH0KCiAgcmV0dXJuIHsKICAgIGFzeW5jIGNyZWF0ZShwYXJhbXMpIHsKICAgICAgY29uc3QgZW5jb2RpbmcgPSBwYXJhbXMuZW5jb2Rpbmc7CiAgICAgIGNvbnN0IGZldGNoQnVpbHRJbkNNYXAgPSBwYXJhbXMuZmV0Y2hCdWlsdEluQ01hcDsKICAgICAgY29uc3QgdXNlQ01hcCA9IHBhcmFtcy51c2VDTWFwOwoKICAgICAgaWYgKGVuY29kaW5nIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIHJldHVybiBjcmVhdGVCdWlsdEluQ01hcChlbmNvZGluZy5uYW1lLCBmZXRjaEJ1aWx0SW5DTWFwKTsKICAgICAgfSBlbHNlIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgICAgY29uc3QgcGFyc2VkQ01hcCA9IGF3YWl0IHBhcnNlQ01hcChuZXcgQ01hcCgpLCBuZXcgX3BhcnNlci5MZXhlcihlbmNvZGluZyksIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApOwoKICAgICAgICBpZiAocGFyc2VkQ01hcC5pc0lkZW50aXR5Q01hcCkgewogICAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1aWx0SW5DTWFwKHBhcnNlZENNYXAubmFtZSwgZmV0Y2hCdWlsdEluQ01hcCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcGFyc2VkQ01hcDsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKCJFbmNvZGluZyByZXF1aXJlZC4iKTsKICAgIH0KCiAgfTsKfSgpOwoKZXhwb3J0cy5DTWFwRmFjdG9yeSA9IENNYXBGYWN0b3J5OwoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGFyc2VyID0gZXhwb3J0cy5MaW5lYXJpemF0aW9uID0gZXhwb3J0cy5MZXhlciA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfYXNjaWlfODVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7Cgp2YXIgX2FzY2lpX2hleF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwKTsKCnZhciBfY2NpdHRfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMSk7Cgp2YXIgX2ZsYXRlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwoKdmFyIF9qYmlnMl9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKCnZhciBfanBlZ19zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KTsKCnZhciBfanB4X3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjkpOwoKdmFyIF9sendfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygzMSk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwoKdmFyIF9wcmVkaWN0b3Jfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygzMik7Cgp2YXIgX3J1bl9sZW5ndGhfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7Cgpjb25zdCBNQVhfTEVOR1RIX1RPX0NBQ0hFID0gMTAwMDsKY29uc3QgTUFYX0FETEVSMzJfTEVOR1RIID0gNTU1MjsKCmZ1bmN0aW9uIGNvbXB1dGVBZGxlcjMyKGJ5dGVzKSB7CiAgY29uc3QgYnl0ZXNMZW5ndGggPSBieXRlcy5sZW5ndGg7CiAgbGV0IGEgPSAxLAogICAgICBiID0gMDsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBieXRlc0xlbmd0aDsgKytpKSB7CiAgICBhICs9IGJ5dGVzW2ldICYgMHhmZjsKICAgIGIgKz0gYTsKICB9CgogIHJldHVybiBiICUgNjU1MjEgPDwgMTYgfCBhICUgNjU1MjE7Cn0KCmNsYXNzIFBhcnNlciB7CiAgY29uc3RydWN0b3IoewogICAgbGV4ZXIsCiAgICB4cmVmLAogICAgYWxsb3dTdHJlYW1zID0gZmFsc2UsCiAgICByZWNvdmVyeU1vZGUgPSBmYWxzZQogIH0pIHsKICAgIHRoaXMubGV4ZXIgPSBsZXhlcjsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLmFsbG93U3RyZWFtcyA9IGFsbG93U3RyZWFtczsKICAgIHRoaXMucmVjb3ZlcnlNb2RlID0gcmVjb3ZlcnlNb2RlOwogICAgdGhpcy5pbWFnZUNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMucmVmaWxsKCk7CiAgfQoKICByZWZpbGwoKSB7CiAgICB0aGlzLmJ1ZjEgPSB0aGlzLmxleGVyLmdldE9iaigpOwogICAgdGhpcy5idWYyID0gdGhpcy5sZXhlci5nZXRPYmooKTsKICB9CgogIHNoaWZ0KCkgewogICAgaWYgKHRoaXMuYnVmMiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCAmJiB0aGlzLmJ1ZjIuY21kID09PSAiSUQiKSB7CiAgICAgIHRoaXMuYnVmMSA9IHRoaXMuYnVmMjsKICAgICAgdGhpcy5idWYyID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYnVmMSA9IHRoaXMuYnVmMjsKICAgICAgdGhpcy5idWYyID0gdGhpcy5sZXhlci5nZXRPYmooKTsKICAgIH0KICB9CgogIHRyeVNoaWZ0KCkgewogICAgdHJ5IHsKICAgICAgdGhpcy5zaGlmdCgpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIGdldE9iaihjaXBoZXJUcmFuc2Zvcm0gPSBudWxsKSB7CiAgICBjb25zdCBidWYxID0gdGhpcy5idWYxOwogICAgdGhpcy5zaGlmdCgpOwoKICAgIGlmIChidWYxIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSB7CiAgICAgIHN3aXRjaCAoYnVmMS5jbWQpIHsKICAgICAgICBjYXNlICJCSSI6CiAgICAgICAgICByZXR1cm4gdGhpcy5tYWtlSW5saW5lSW1hZ2UoY2lwaGVyVHJhbnNmb3JtKTsKCiAgICAgICAgY2FzZSAiWyI6CiAgICAgICAgICBjb25zdCBhcnJheSA9IFtdOwoKICAgICAgICAgIHdoaWxlICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKSh0aGlzLmJ1ZjEsICJdIikgJiYgdGhpcy5idWYxICE9PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICAgICAgYXJyYXkucHVzaCh0aGlzLmdldE9iaihjaXBoZXJUcmFuc2Zvcm0pKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5idWYxID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICAgICAgaWYgKHRoaXMucmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuUGFyc2VyRU9GRXhjZXB0aW9uKCJFbmQgb2YgZmlsZSBpbnNpZGUgYXJyYXkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgICAgcmV0dXJuIGFycmF5OwoKICAgICAgICBjYXNlICI8PCI6CiAgICAgICAgICBjb25zdCBkaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QodGhpcy54cmVmKTsKCiAgICAgICAgICB3aGlsZSAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYxLCAiPj4iKSAmJiB0aGlzLmJ1ZjEgIT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgICAgICBpZiAoISh0aGlzLmJ1ZjEgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiTWFsZm9ybWVkIGRpY3Rpb25hcnk6IGtleSBtdXN0IGJlIGEgbmFtZSBvYmplY3QiKTsKICAgICAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuYnVmMS5uYW1lOwogICAgICAgICAgICB0aGlzLnNoaWZ0KCk7CgogICAgICAgICAgICBpZiAodGhpcy5idWYxID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGljdC5zZXQoa2V5LCB0aGlzLmdldE9iaihjaXBoZXJUcmFuc2Zvcm0pKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5idWYxID09PSBfcHJpbWl0aXZlcy5FT0YpIHsKICAgICAgICAgICAgaWYgKHRoaXMucmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGRpY3Q7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5QYXJzZXJFT0ZFeGNlcHRpb24oIkVuZCBvZiBmaWxlIGluc2lkZSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMiwgInN0cmVhbSIpKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmFsbG93U3RyZWFtcyA/IHRoaXMubWFrZVN0cmVhbShkaWN0LCBjaXBoZXJUcmFuc2Zvcm0pIDogZGljdDsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICByZXR1cm4gZGljdDsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiBidWYxOwogICAgICB9CiAgICB9CgogICAgaWYgKE51bWJlci5pc0ludGVnZXIoYnVmMSkpIHsKICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIodGhpcy5idWYxKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMiwgIlIiKSkgewogICAgICAgIGNvbnN0IHJlZiA9IF9wcmltaXRpdmVzLlJlZi5nZXQoYnVmMSwgdGhpcy5idWYxKTsKCiAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICByZXR1cm4gcmVmOwogICAgICB9CgogICAgICByZXR1cm4gYnVmMTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGJ1ZjEgPT09ICJzdHJpbmciKSB7CiAgICAgIGlmIChjaXBoZXJUcmFuc2Zvcm0pIHsKICAgICAgICByZXR1cm4gY2lwaGVyVHJhbnNmb3JtLmRlY3J5cHRTdHJpbmcoYnVmMSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBidWYxOwogICAgfQoKICAgIHJldHVybiBidWYxOwogIH0KCiAgZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKSB7CiAgICBjb25zdCBFID0gMHg0NSwKICAgICAgICAgIEkgPSAweDQ5LAogICAgICAgICAgU1BBQ0UgPSAweDIwLAogICAgICAgICAgTEYgPSAweGEsCiAgICAgICAgICBDUiA9IDB4ZCwKICAgICAgICAgIE5VTCA9IDB4MDsKICAgIGNvbnN0IGxleGVyID0gdGhpcy5sZXhlciwKICAgICAgICAgIHN0YXJ0UG9zID0gc3RyZWFtLnBvcywKICAgICAgICAgIG4gPSAxMDsKICAgIGxldCBzdGF0ZSA9IDAsCiAgICAgICAgY2gsCiAgICAgICAgbWF5YmVFSVBvczsKCiAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgIGlmIChzdGF0ZSA9PT0gMCkgewogICAgICAgIHN0YXRlID0gY2ggPT09IEUgPyAxIDogMDsKICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gMSkgewogICAgICAgIHN0YXRlID0gY2ggPT09IEkgPyAyIDogMDsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShzdGF0ZSA9PT0gMiwgImZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kIC0gaW52YWxpZCBzdGF0ZS4iKTsKCiAgICAgICAgaWYgKGNoID09PSBTUEFDRSB8fCBjaCA9PT0gTEYgfHwgY2ggPT09IENSKSB7CiAgICAgICAgICBtYXliZUVJUG9zID0gc3RyZWFtLnBvczsKICAgICAgICAgIGNvbnN0IGZvbGxvd2luZ0J5dGVzID0gc3RyZWFtLnBlZWtCeXRlcyhuKTsKCiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmb2xsb3dpbmdCeXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIGNoID0gZm9sbG93aW5nQnl0ZXNbaV07CgogICAgICAgICAgICBpZiAoY2ggPT09IE5VTCAmJiBmb2xsb3dpbmdCeXRlc1tpICsgMV0gIT09IE5VTCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY2ggIT09IExGICYmIGNoICE9PSBDUiAmJiAoY2ggPCBTUEFDRSB8fCBjaCA+IDB4N2YpKSB7CiAgICAgICAgICAgICAgc3RhdGUgPSAwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN0YXRlICE9PSAyKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChsZXhlci5rbm93bkNvbW1hbmRzKSB7CiAgICAgICAgICAgIGNvbnN0IG5leHRPYmogPSBsZXhlci5wZWVrT2JqKCk7CgogICAgICAgICAgICBpZiAobmV4dE9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCAmJiAhbGV4ZXIua25vd25Db21tYW5kc1tuZXh0T2JqLmNtZF0pIHsKICAgICAgICAgICAgICBzdGF0ZSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQgLSBgbGV4ZXIua25vd25Db21tYW5kc2AgaXMgdW5kZWZpbmVkLiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RhdGUgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChjaCA9PT0gLTEpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJmaW5kRGVmYXVsdElubGluZVN0cmVhbUVuZDogIiArICJSZWFjaGVkIHRoZSBlbmQgb2YgdGhlIHN0cmVhbSB3aXRob3V0IGZpbmRpbmcgYSB2YWxpZCBFSSBtYXJrZXIiKTsKCiAgICAgIGlmIChtYXliZUVJUG9zKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCcuLi4gdHJ5aW5nIHRvIHJlY292ZXIgYnkgdXNpbmcgdGhlIGxhc3QgIkVJIiBvY2N1cnJlbmNlLicpOwogICAgICAgIHN0cmVhbS5za2lwKC0oc3RyZWFtLnBvcyAtIG1heWJlRUlQb3MpKTsKICAgICAgfQogICAgfQoKICAgIGxldCBlbmRPZmZzZXQgPSA0OwogICAgc3RyZWFtLnNraXAoLWVuZE9mZnNldCk7CiAgICBjaCA9IHN0cmVhbS5wZWVrQnl0ZSgpOwogICAgc3RyZWFtLnNraXAoZW5kT2Zmc2V0KTsKCiAgICBpZiAoISgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSkgewogICAgICBlbmRPZmZzZXQtLTsKICAgIH0KCiAgICByZXR1cm4gc3RyZWFtLnBvcyAtIGVuZE9mZnNldCAtIHN0YXJ0UG9zOwogIH0KCiAgZmluZERDVERlY29kZUlubGluZVN0cmVhbUVuZChzdHJlYW0pIHsKICAgIGNvbnN0IHN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICAgIGxldCBmb3VuZEVPSSA9IGZhbHNlLAogICAgICAgIGIsCiAgICAgICAgbWFya2VyTGVuZ3RoOwoKICAgIHdoaWxlICgoYiA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICBpZiAoYiAhPT0gMHhmZikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBzd2l0Y2ggKHN0cmVhbS5nZXRCeXRlKCkpIHsKICAgICAgICBjYXNlIDB4MDA6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGZmOgogICAgICAgICAgc3RyZWFtLnNraXAoLTEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhkOToKICAgICAgICAgIGZvdW5kRU9JID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4YzA6CiAgICAgICAgY2FzZSAweGMxOgogICAgICAgIGNhc2UgMHhjMjoKICAgICAgICBjYXNlIDB4YzM6CiAgICAgICAgY2FzZSAweGM1OgogICAgICAgIGNhc2UgMHhjNjoKICAgICAgICBjYXNlIDB4Yzc6CiAgICAgICAgY2FzZSAweGM5OgogICAgICAgIGNhc2UgMHhjYToKICAgICAgICBjYXNlIDB4Y2I6CiAgICAgICAgY2FzZSAweGNkOgogICAgICAgIGNhc2UgMHhjZToKICAgICAgICBjYXNlIDB4Y2Y6CiAgICAgICAgY2FzZSAweGM0OgogICAgICAgIGNhc2UgMHhjYzoKICAgICAgICBjYXNlIDB4ZGE6CiAgICAgICAgY2FzZSAweGRiOgogICAgICAgIGNhc2UgMHhkYzoKICAgICAgICBjYXNlIDB4ZGQ6CiAgICAgICAgY2FzZSAweGRlOgogICAgICAgIGNhc2UgMHhkZjoKICAgICAgICBjYXNlIDB4ZTA6CiAgICAgICAgY2FzZSAweGUxOgogICAgICAgIGNhc2UgMHhlMjoKICAgICAgICBjYXNlIDB4ZTM6CiAgICAgICAgY2FzZSAweGU0OgogICAgICAgIGNhc2UgMHhlNToKICAgICAgICBjYXNlIDB4ZTY6CiAgICAgICAgY2FzZSAweGU3OgogICAgICAgIGNhc2UgMHhlODoKICAgICAgICBjYXNlIDB4ZTk6CiAgICAgICAgY2FzZSAweGVhOgogICAgICAgIGNhc2UgMHhlYjoKICAgICAgICBjYXNlIDB4ZWM6CiAgICAgICAgY2FzZSAweGVkOgogICAgICAgIGNhc2UgMHhlZToKICAgICAgICBjYXNlIDB4ZWY6CiAgICAgICAgY2FzZSAweGZlOgogICAgICAgICAgbWFya2VyTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpOwoKICAgICAgICAgIGlmIChtYXJrZXJMZW5ndGggPiAyKSB7CiAgICAgICAgICAgIHN0cmVhbS5za2lwKG1hcmtlckxlbmd0aCAtIDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyZWFtLnNraXAoLTIpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoZm91bmRFT0kpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGxlbmd0aCA9IHN0cmVhbS5wb3MgLSBzdGFydFBvczsKCiAgICBpZiAoYiA9PT0gLTEpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbmxpbmUgRENURGVjb2RlIGltYWdlIHN0cmVhbTogIiArICJFT0kgbWFya2VyIG5vdCBmb3VuZCwgc2VhcmNoaW5nIGZvciAvRUkvIGluc3RlYWQuIik7CiAgICAgIHN0cmVhbS5za2lwKC1sZW5ndGgpOwogICAgICByZXR1cm4gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgfQoKICAgIHRoaXMuaW5saW5lU3RyZWFtU2tpcEVJKHN0cmVhbSk7CiAgICByZXR1cm4gbGVuZ3RoOwogIH0KCiAgZmluZEFTQ0lJODVEZWNvZGVJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKSB7CiAgICBjb25zdCBUSUxERSA9IDB4N2UsCiAgICAgICAgICBHVCA9IDB4M2U7CiAgICBjb25zdCBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICBsZXQgY2g7CgogICAgd2hpbGUgKChjaCA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICBpZiAoY2ggPT09IFRJTERFKSB7CiAgICAgICAgY29uc3QgdGlsZGVQb3MgPSBzdHJlYW0ucG9zOwogICAgICAgIGNoID0gc3RyZWFtLnBlZWtCeXRlKCk7CgogICAgICAgIHdoaWxlICgoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICAgIHN0cmVhbS5za2lwKCk7CiAgICAgICAgICBjaCA9IHN0cmVhbS5wZWVrQnl0ZSgpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoID09PSBHVCkgewogICAgICAgICAgc3RyZWFtLnNraXAoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0cmVhbS5wb3MgPiB0aWxkZVBvcykgewogICAgICAgICAgY29uc3QgbWF5YmVFSSA9IHN0cmVhbS5wZWVrQnl0ZXMoMik7CgogICAgICAgICAgaWYgKG1heWJlRUlbMF0gPT09IDB4NDUgJiYgbWF5YmVFSVsxXSA9PT0gMHg0OSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBsZW5ndGggPSBzdHJlYW0ucG9zIC0gc3RhcnRQb3M7CgogICAgaWYgKGNoID09PSAtMSkgewogICAgICAoMCwgX3V0aWwud2FybikoIklubGluZSBBU0NJSTg1RGVjb2RlIGltYWdlIHN0cmVhbTogIiArICJFT0QgbWFya2VyIG5vdCBmb3VuZCwgc2VhcmNoaW5nIGZvciAvRUkvIGluc3RlYWQuIik7CiAgICAgIHN0cmVhbS5za2lwKC1sZW5ndGgpOwogICAgICByZXR1cm4gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgfQoKICAgIHRoaXMuaW5saW5lU3RyZWFtU2tpcEVJKHN0cmVhbSk7CiAgICByZXR1cm4gbGVuZ3RoOwogIH0KCiAgZmluZEFTQ0lJSGV4RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSkgewogICAgY29uc3QgR1QgPSAweDNlOwogICAgY29uc3Qgc3RhcnRQb3MgPSBzdHJlYW0ucG9zOwogICAgbGV0IGNoOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSAhPT0gLTEpIHsKICAgICAgaWYgKGNoID09PSBHVCkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgY29uc3QgbGVuZ3RoID0gc3RyZWFtLnBvcyAtIHN0YXJ0UG9zOwoKICAgIGlmIChjaCA9PT0gLTEpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbmxpbmUgQVNDSUlIZXhEZWNvZGUgaW1hZ2Ugc3RyZWFtOiAiICsgIkVPRCBtYXJrZXIgbm90IGZvdW5kLCBzZWFyY2hpbmcgZm9yIC9FSS8gaW5zdGVhZC4iKTsKICAgICAgc3RyZWFtLnNraXAoLWxlbmd0aCk7CiAgICAgIHJldHVybiB0aGlzLmZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICB9CgogICAgdGhpcy5pbmxpbmVTdHJlYW1Ta2lwRUkoc3RyZWFtKTsKICAgIHJldHVybiBsZW5ndGg7CiAgfQoKICBpbmxpbmVTdHJlYW1Ta2lwRUkoc3RyZWFtKSB7CiAgICBjb25zdCBFID0gMHg0NSwKICAgICAgICAgIEkgPSAweDQ5OwogICAgbGV0IHN0YXRlID0gMCwKICAgICAgICBjaDsKCiAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgIGlmIChzdGF0ZSA9PT0gMCkgewogICAgICAgIHN0YXRlID0gY2ggPT09IEUgPyAxIDogMDsKICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gMSkgewogICAgICAgIHN0YXRlID0gY2ggPT09IEkgPyAyIDogMDsKICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gMikgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBtYWtlSW5saW5lSW1hZ2UoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICBjb25zdCBsZXhlciA9IHRoaXMubGV4ZXI7CiAgICBjb25zdCBzdHJlYW0gPSBsZXhlci5zdHJlYW07CiAgICBjb25zdCBkaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QodGhpcy54cmVmKTsKICAgIGxldCBkaWN0TGVuZ3RoOwoKICAgIHdoaWxlICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKSh0aGlzLmJ1ZjEsICJJRCIpICYmIHRoaXMuYnVmMSAhPT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgIGlmICghKHRoaXMuYnVmMSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJEaWN0aW9uYXJ5IGtleSBtdXN0IGJlIGEgbmFtZSBvYmplY3QiKTsKICAgICAgfQoKICAgICAgY29uc3Qga2V5ID0gdGhpcy5idWYxLm5hbWU7CiAgICAgIHRoaXMuc2hpZnQoKTsKCiAgICAgIGlmICh0aGlzLmJ1ZjEgPT09IF9wcmltaXRpdmVzLkVPRikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBkaWN0LnNldChrZXksIHRoaXMuZ2V0T2JqKGNpcGhlclRyYW5zZm9ybSkpOwogICAgfQoKICAgIGlmIChsZXhlci5iZWdpbklubGluZUltYWdlUG9zICE9PSAtMSkgewogICAgICBkaWN0TGVuZ3RoID0gc3RyZWFtLnBvcyAtIGxleGVyLmJlZ2luSW5saW5lSW1hZ2VQb3M7CiAgICB9CgogICAgY29uc3QgZmlsdGVyID0gZGljdC5nZXQoIkYiLCAiRmlsdGVyIik7CiAgICBsZXQgZmlsdGVyTmFtZTsKCiAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyLm5hbWU7CiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyKSkgewogICAgICBjb25zdCBmaWx0ZXJaZXJvID0gdGhpcy54cmVmLmZldGNoSWZSZWYoZmlsdGVyWzBdKTsKCiAgICAgIGlmIChmaWx0ZXJaZXJvIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgIGZpbHRlck5hbWUgPSBmaWx0ZXJaZXJvLm5hbWU7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICBsZXQgbGVuZ3RoOwoKICAgIHN3aXRjaCAoZmlsdGVyTmFtZSkgewogICAgICBjYXNlICJEQ1QiOgogICAgICBjYXNlICJEQ1REZWNvZGUiOgogICAgICAgIGxlbmd0aCA9IHRoaXMuZmluZERDVERlY29kZUlubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiQTg1IjoKICAgICAgY2FzZSAiQVNDSUk4NURlY29kZSI6CiAgICAgICAgbGVuZ3RoID0gdGhpcy5maW5kQVNDSUk4NURlY29kZUlubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiQUh4IjoKICAgICAgY2FzZSAiQVNDSUlIZXhEZWNvZGUiOgogICAgICAgIGxlbmd0aCA9IHRoaXMuZmluZEFTQ0lJSGV4RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIGxlbmd0aCA9IHRoaXMuZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKTsKICAgIH0KCiAgICBsZXQgaW1hZ2VTdHJlYW0gPSBzdHJlYW0ubWFrZVN1YlN0cmVhbShzdGFydFBvcywgbGVuZ3RoLCBkaWN0KTsKICAgIGxldCBjYWNoZUtleTsKCiAgICBpZiAobGVuZ3RoIDwgTUFYX0xFTkdUSF9UT19DQUNIRSAmJiBkaWN0TGVuZ3RoIDwgTUFYX0FETEVSMzJfTEVOR1RIKSB7CiAgICAgIGNvbnN0IGltYWdlQnl0ZXMgPSBpbWFnZVN0cmVhbS5nZXRCeXRlcygpOwogICAgICBpbWFnZVN0cmVhbS5yZXNldCgpOwogICAgICBjb25zdCBpbml0aWFsU3RyZWFtUG9zID0gc3RyZWFtLnBvczsKICAgICAgc3RyZWFtLnBvcyA9IGxleGVyLmJlZ2luSW5saW5lSW1hZ2VQb3M7CiAgICAgIGNvbnN0IGRpY3RCeXRlcyA9IHN0cmVhbS5nZXRCeXRlcyhkaWN0TGVuZ3RoKTsKICAgICAgc3RyZWFtLnBvcyA9IGluaXRpYWxTdHJlYW1Qb3M7CiAgICAgIGNhY2hlS2V5ID0gY29tcHV0ZUFkbGVyMzIoaW1hZ2VCeXRlcykgKyAiXyIgKyBjb21wdXRlQWRsZXIzMihkaWN0Qnl0ZXMpOwogICAgICBjb25zdCBjYWNoZUVudHJ5ID0gdGhpcy5pbWFnZUNhY2hlW2NhY2hlS2V5XTsKCiAgICAgIGlmIChjYWNoZUVudHJ5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLmJ1ZjIgPSBfcHJpbWl0aXZlcy5DbWQuZ2V0KCJFSSIpOwogICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICBjYWNoZUVudHJ5LnJlc2V0KCk7CiAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgIGltYWdlU3RyZWFtID0gY2lwaGVyVHJhbnNmb3JtLmNyZWF0ZVN0cmVhbShpbWFnZVN0cmVhbSwgbGVuZ3RoKTsKICAgIH0KCiAgICBpbWFnZVN0cmVhbSA9IHRoaXMuZmlsdGVyKGltYWdlU3RyZWFtLCBkaWN0LCBsZW5ndGgpOwogICAgaW1hZ2VTdHJlYW0uZGljdCA9IGRpY3Q7CgogICAgaWYgKGNhY2hlS2V5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgaW1hZ2VTdHJlYW0uY2FjaGVLZXkgPSBgaW5saW5lXyR7bGVuZ3RofV8ke2NhY2hlS2V5fWA7CiAgICAgIHRoaXMuaW1hZ2VDYWNoZVtjYWNoZUtleV0gPSBpbWFnZVN0cmVhbTsKICAgIH0KCiAgICB0aGlzLmJ1ZjIgPSBfcHJpbWl0aXZlcy5DbWQuZ2V0KCJFSSIpOwogICAgdGhpcy5zaGlmdCgpOwogICAgcmV0dXJuIGltYWdlU3RyZWFtOwogIH0KCiAgX2ZpbmRTdHJlYW1MZW5ndGgoc3RhcnRQb3MsIHNpZ25hdHVyZSkgewogICAgY29uc3QgewogICAgICBzdHJlYW0KICAgIH0gPSB0aGlzLmxleGVyOwogICAgc3RyZWFtLnBvcyA9IHN0YXJ0UG9zOwogICAgY29uc3QgU0NBTl9CTE9DS19MRU5HVEggPSAyMDQ4OwogICAgY29uc3Qgc2lnbmF0dXJlTGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKCiAgICB3aGlsZSAoc3RyZWFtLnBvcyA8IHN0cmVhbS5lbmQpIHsKICAgICAgY29uc3Qgc2NhbkJ5dGVzID0gc3RyZWFtLnBlZWtCeXRlcyhTQ0FOX0JMT0NLX0xFTkdUSCk7CiAgICAgIGNvbnN0IHNjYW5MZW5ndGggPSBzY2FuQnl0ZXMubGVuZ3RoIC0gc2lnbmF0dXJlTGVuZ3RoOwoKICAgICAgaWYgKHNjYW5MZW5ndGggPD0gMCkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZXQgcG9zID0gMDsKCiAgICAgIHdoaWxlIChwb3MgPCBzY2FuTGVuZ3RoKSB7CiAgICAgICAgbGV0IGogPSAwOwoKICAgICAgICB3aGlsZSAoaiA8IHNpZ25hdHVyZUxlbmd0aCAmJiBzY2FuQnl0ZXNbcG9zICsgal0gPT09IHNpZ25hdHVyZVtqXSkgewogICAgICAgICAgaisrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGogPj0gc2lnbmF0dXJlTGVuZ3RoKSB7CiAgICAgICAgICBzdHJlYW0ucG9zICs9IHBvczsKICAgICAgICAgIHJldHVybiBzdHJlYW0ucG9zIC0gc3RhcnRQb3M7CiAgICAgICAgfQoKICAgICAgICBwb3MrKzsKICAgICAgfQoKICAgICAgc3RyZWFtLnBvcyArPSBzY2FuTGVuZ3RoOwogICAgfQoKICAgIHJldHVybiAtMTsKICB9CgogIG1ha2VTdHJlYW0oZGljdCwgY2lwaGVyVHJhbnNmb3JtKSB7CiAgICBjb25zdCBsZXhlciA9IHRoaXMubGV4ZXI7CiAgICBsZXQgc3RyZWFtID0gbGV4ZXIuc3RyZWFtOwogICAgbGV4ZXIuc2tpcFRvTmV4dExpbmUoKTsKICAgIGNvbnN0IHN0YXJ0UG9zID0gc3RyZWFtLnBvcyAtIDE7CiAgICBsZXQgbGVuZ3RoID0gZGljdC5nZXQoIkxlbmd0aCIpOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihsZW5ndGgpKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKShgQmFkIGxlbmd0aCAiJHtsZW5ndGggJiYgbGVuZ3RoLnRvU3RyaW5nKCl9IiBpbiBzdHJlYW0uYCk7CiAgICAgIGxlbmd0aCA9IDA7CiAgICB9CgogICAgc3RyZWFtLnBvcyA9IHN0YXJ0UG9zICsgbGVuZ3RoOwogICAgbGV4ZXIubmV4dENoYXIoKTsKCiAgICBpZiAodGhpcy50cnlTaGlmdCgpICYmICgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYyLCAiZW5kc3RyZWFtIikpIHsKICAgICAgdGhpcy5zaGlmdCgpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgRU5EU1RSRUFNX1NJR05BVFVSRSA9IG5ldyBVaW50OEFycmF5KFsweDY1LCAweDZlLCAweDY0LCAweDczLCAweDc0LCAweDcyLCAweDY1LCAweDYxLCAweDZkXSk7CgogICAgICBsZXQgYWN0dWFsTGVuZ3RoID0gdGhpcy5fZmluZFN0cmVhbUxlbmd0aChzdGFydFBvcywgRU5EU1RSRUFNX1NJR05BVFVSRSk7CgogICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgMCkgewogICAgICAgIGNvbnN0IE1BWF9UUlVOQ0FUSU9OID0gMTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gTUFYX1RSVU5DQVRJT047IGkrKykgewogICAgICAgICAgY29uc3QgZW5kID0gRU5EU1RSRUFNX1NJR05BVFVSRS5sZW5ndGggLSBpOwogICAgICAgICAgY29uc3QgVFJVTkNBVEVEX1NJR05BVFVSRSA9IEVORFNUUkVBTV9TSUdOQVRVUkUuc2xpY2UoMCwgZW5kKTsKCiAgICAgICAgICBjb25zdCBtYXliZUxlbmd0aCA9IHRoaXMuX2ZpbmRTdHJlYW1MZW5ndGgoc3RhcnRQb3MsIFRSVU5DQVRFRF9TSUdOQVRVUkUpOwoKICAgICAgICAgIGlmIChtYXliZUxlbmd0aCA+PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IGxhc3RCeXRlID0gc3RyZWFtLnBlZWtCeXRlcyhlbmQgKyAxKVtlbmRdOwoKICAgICAgICAgICAgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShsYXN0Qnl0ZSkpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKGBGb3VuZCAiJHsoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoVFJVTkNBVEVEX1NJR05BVFVSRSl9IiB3aGVuIGAgKyAic2VhcmNoaW5nIGZvciBlbmRzdHJlYW0gY29tbWFuZC4iKTsKICAgICAgICAgICAgYWN0dWFsTGVuZ3RoID0gbWF5YmVMZW5ndGg7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGFjdHVhbExlbmd0aCA8IDApIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWlzc2luZyBlbmRzdHJlYW0gY29tbWFuZC4iKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IGFjdHVhbExlbmd0aDsKICAgICAgbGV4ZXIubmV4dENoYXIoKTsKICAgICAgdGhpcy5zaGlmdCgpOwogICAgICB0aGlzLnNoaWZ0KCk7CiAgICB9CgogICAgdGhpcy5zaGlmdCgpOwogICAgc3RyZWFtID0gc3RyZWFtLm1ha2VTdWJTdHJlYW0oc3RhcnRQb3MsIGxlbmd0aCwgZGljdCk7CgogICAgaWYgKGNpcGhlclRyYW5zZm9ybSkgewogICAgICBzdHJlYW0gPSBjaXBoZXJUcmFuc2Zvcm0uY3JlYXRlU3RyZWFtKHN0cmVhbSwgbGVuZ3RoKTsKICAgIH0KCiAgICBzdHJlYW0gPSB0aGlzLmZpbHRlcihzdHJlYW0sIGRpY3QsIGxlbmd0aCk7CiAgICBzdHJlYW0uZGljdCA9IGRpY3Q7CiAgICByZXR1cm4gc3RyZWFtOwogIH0KCiAgZmlsdGVyKHN0cmVhbSwgZGljdCwgbGVuZ3RoKSB7CiAgICBsZXQgZmlsdGVyID0gZGljdC5nZXQoIkYiLCAiRmlsdGVyIik7CiAgICBsZXQgcGFyYW1zID0gZGljdC5nZXQoIkRQIiwgIkRlY29kZVBhcm1zIik7CgogICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1zKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiL0RlY29kZVBhcm1zIHNob3VsZCBub3QgYmUgYW4gQXJyYXksIHdoZW4gL0ZpbHRlciBpcyBhIE5hbWUuIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLm1ha2VGaWx0ZXIoc3RyZWFtLCBmaWx0ZXIubmFtZSwgbGVuZ3RoLCBwYXJhbXMpOwogICAgfQoKICAgIGxldCBtYXliZUxlbmd0aCA9IGxlbmd0aDsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXIpKSB7CiAgICAgIGNvbnN0IGZpbHRlckFycmF5ID0gZmlsdGVyOwogICAgICBjb25zdCBwYXJhbXNBcnJheSA9IHBhcmFtczsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZpbHRlckFycmF5Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBmaWx0ZXIgPSB0aGlzLnhyZWYuZmV0Y2hJZlJlZihmaWx0ZXJBcnJheVtpXSk7CgogICAgICAgIGlmICghKGZpbHRlciBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEJhZCBmaWx0ZXIgbmFtZSAiJHtmaWx0ZXJ9ImApOwogICAgICAgIH0KCiAgICAgICAgcGFyYW1zID0gbnVsbDsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1zQXJyYXkpICYmIGkgaW4gcGFyYW1zQXJyYXkpIHsKICAgICAgICAgIHBhcmFtcyA9IHRoaXMueHJlZi5mZXRjaElmUmVmKHBhcmFtc0FycmF5W2ldKTsKICAgICAgICB9CgogICAgICAgIHN0cmVhbSA9IHRoaXMubWFrZUZpbHRlcihzdHJlYW0sIGZpbHRlci5uYW1lLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKICAgICAgICBtYXliZUxlbmd0aCA9IG51bGw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RyZWFtOwogIH0KCiAgbWFrZUZpbHRlcihzdHJlYW0sIG5hbWUsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIGlmIChtYXliZUxlbmd0aCA9PT0gMCkgewogICAgICAoMCwgX3V0aWwud2FybikoYEVtcHR5ICIke25hbWV9IiBzdHJlYW0uYCk7CiAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICB9CgogICAgY29uc3QgeHJlZlN0YXRzID0gdGhpcy54cmVmLnN0YXRzOwoKICAgIHRyeSB7CiAgICAgIHN3aXRjaCAobmFtZSkgewogICAgICAgIGNhc2UgIkZsIjoKICAgICAgICBjYXNlICJGbGF0ZURlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkZMQVRFKTsKCiAgICAgICAgICBpZiAocGFyYW1zKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgX3ByZWRpY3Rvcl9zdHJlYW0uUHJlZGljdG9yU3RyZWFtKG5ldyBfZmxhdGVfc3RyZWFtLkZsYXRlU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgpLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IF9mbGF0ZV9zdHJlYW0uRmxhdGVTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CgogICAgICAgIGNhc2UgIkxaVyI6CiAgICAgICAgY2FzZSAiTFpXRGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuTFpXKTsKICAgICAgICAgIGxldCBlYXJseUNoYW5nZSA9IDE7CgogICAgICAgICAgaWYgKHBhcmFtcykgewogICAgICAgICAgICBpZiAocGFyYW1zLmhhcygiRWFybHlDaGFuZ2UiKSkgewogICAgICAgICAgICAgIGVhcmx5Q2hhbmdlID0gcGFyYW1zLmdldCgiRWFybHlDaGFuZ2UiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG5ldyBfcHJlZGljdG9yX3N0cmVhbS5QcmVkaWN0b3JTdHJlYW0obmV3IF9sendfc3RyZWFtLkxaV1N0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBlYXJseUNoYW5nZSksIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgX2x6d19zdHJlYW0uTFpXU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIGVhcmx5Q2hhbmdlKTsKCiAgICAgICAgY2FzZSAiRENUIjoKICAgICAgICBjYXNlICJEQ1REZWNvZGUiOgogICAgICAgICAgeHJlZlN0YXRzLmFkZFN0cmVhbVR5cGUoX3V0aWwuU3RyZWFtVHlwZS5EQ1QpOwogICAgICAgICAgcmV0dXJuIG5ldyBfanBlZ19zdHJlYW0uSnBlZ1N0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwoKICAgICAgICBjYXNlICJKUFgiOgogICAgICAgIGNhc2UgIkpQWERlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkpQWCk7CiAgICAgICAgICByZXR1cm4gbmV3IF9qcHhfc3RyZWFtLkpweFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwoKICAgICAgICBjYXNlICJBODUiOgogICAgICAgIGNhc2UgIkFTQ0lJODVEZWNvZGUiOgogICAgICAgICAgeHJlZlN0YXRzLmFkZFN0cmVhbVR5cGUoX3V0aWwuU3RyZWFtVHlwZS5BODUpOwogICAgICAgICAgcmV0dXJuIG5ldyBfYXNjaWlfODVfc3RyZWFtLkFzY2lpODVTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CgogICAgICAgIGNhc2UgIkFIeCI6CiAgICAgICAgY2FzZSAiQVNDSUlIZXhEZWNvZGUiOgogICAgICAgICAgeHJlZlN0YXRzLmFkZFN0cmVhbVR5cGUoX3V0aWwuU3RyZWFtVHlwZS5BSFgpOwogICAgICAgICAgcmV0dXJuIG5ldyBfYXNjaWlfaGV4X3N0cmVhbS5Bc2NpaUhleFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoKTsKCiAgICAgICAgY2FzZSAiQ0NGIjoKICAgICAgICBjYXNlICJDQ0lUVEZheERlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLkNDRik7CiAgICAgICAgICByZXR1cm4gbmV3IF9jY2l0dF9zdHJlYW0uQ0NJVFRGYXhTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKCiAgICAgICAgY2FzZSAiUkwiOgogICAgICAgIGNhc2UgIlJ1bkxlbmd0aERlY29kZSI6CiAgICAgICAgICB4cmVmU3RhdHMuYWRkU3RyZWFtVHlwZShfdXRpbC5TdHJlYW1UeXBlLlJMWCk7CiAgICAgICAgICByZXR1cm4gbmV3IF9ydW5fbGVuZ3RoX3N0cmVhbS5SdW5MZW5ndGhTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CgogICAgICAgIGNhc2UgIkpCSUcyRGVjb2RlIjoKICAgICAgICAgIHhyZWZTdGF0cy5hZGRTdHJlYW1UeXBlKF91dGlsLlN0cmVhbVR5cGUuSkJJRyk7CiAgICAgICAgICByZXR1cm4gbmV3IF9qYmlnMl9zdHJlYW0uSmJpZzJTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBGaWx0ZXIgIiR7bmFtZX0iIGlzIG5vdCBzdXBwb3J0ZWQuYCk7CiAgICAgIHJldHVybiBzdHJlYW07CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoYEludmFsaWQgc3RyZWFtOiAiJHtleH0iYCk7CiAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5QYXJzZXIgPSBQYXJzZXI7CmNvbnN0IHNwZWNpYWxDaGFycyA9IFsxLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAxLCAxLCAwLCAxLCAxLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAyLCAwLCAwLCAyLCAyLCAwLCAwLCAwLCAwLCAwLCAyLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyLCAwLCAyLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyLCAwLCAyLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyLCAwLCAyLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCmZ1bmN0aW9uIHRvSGV4RGlnaXQoY2gpIHsKICBpZiAoY2ggPj0gMHgzMCAmJiBjaCA8PSAweDM5KSB7CiAgICByZXR1cm4gY2ggJiAweDBmOwogIH0KCiAgaWYgKGNoID49IDB4NDEgJiYgY2ggPD0gMHg0NiB8fCBjaCA+PSAweDYxICYmIGNoIDw9IDB4NjYpIHsKICAgIHJldHVybiAoY2ggJiAweDBmKSArIDk7CiAgfQoKICByZXR1cm4gLTE7Cn0KCmNsYXNzIExleGVyIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIGtub3duQ29tbWFuZHMgPSBudWxsKSB7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICAgIHRoaXMuc3RyQnVmID0gW107CiAgICB0aGlzLmtub3duQ29tbWFuZHMgPSBrbm93bkNvbW1hbmRzOwogICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CiAgICB0aGlzLmJlZ2luSW5saW5lSW1hZ2VQb3MgPSAtMTsKICB9CgogIG5leHRDaGFyKCkgewogICAgcmV0dXJuIHRoaXMuY3VycmVudENoYXIgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgfQoKICBwZWVrQ2hhcigpIHsKICAgIHJldHVybiB0aGlzLnN0cmVhbS5wZWVrQnl0ZSgpOwogIH0KCiAgZ2V0TnVtYmVyKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKICAgIGxldCBlTm90YXRpb24gPSBmYWxzZTsKICAgIGxldCBkaXZpZGVCeSA9IDA7CiAgICBsZXQgc2lnbiA9IDA7CgogICAgaWYgKGNoID09PSAweDJkKSB7CiAgICAgIHNpZ24gPSAtMTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICBpZiAoY2ggPT09IDB4MmQpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyYikgewogICAgICBzaWduID0gMTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgaWYgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKSB7CiAgICAgIGRvIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfSB3aGlsZSAoY2ggPT09IDB4MGEgfHwgY2ggPT09IDB4MGQpOwogICAgfQoKICAgIGlmIChjaCA9PT0gMHgyZSkgewogICAgICBkaXZpZGVCeSA9IDEwOwogICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgIH0KCiAgICBpZiAoY2ggPCAweDMwIHx8IGNoID4gMHgzOSkgewogICAgICBpZiAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoY2gpIHx8IGNoID09PSAtMSkgewogICAgICAgIGlmIChkaXZpZGVCeSA9PT0gMTAgJiYgc2lnbiA9PT0gMCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJMZXhlci5nZXROdW1iZXIgLSB0cmVhdGluZyBhIHNpbmdsZSBkZWNpbWFsIHBvaW50IGFzIHplcm8uIik7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIGlmIChkaXZpZGVCeSA9PT0gMCAmJiBzaWduID09PSAtMSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJMZXhlci5nZXROdW1iZXIgLSB0cmVhdGluZyBhIHNpbmdsZSBtaW51cyBzaWduIGFzIHplcm8uIik7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBudW1iZXI6ICR7U3RyaW5nLmZyb21DaGFyQ29kZShjaCl9IChjaGFyQ29kZSAke2NofSlgKTsKICAgIH0KCiAgICBzaWduID0gc2lnbiB8fCAxOwogICAgbGV0IGJhc2VWYWx1ZSA9IGNoIC0gMHgzMDsKICAgIGxldCBwb3dlclZhbHVlID0gMDsKICAgIGxldCBwb3dlclZhbHVlU2lnbiA9IDE7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCkgewogICAgICBpZiAoY2ggPj0gMHgzMCAmJiBjaCA8PSAweDM5KSB7CiAgICAgICAgY29uc3QgY3VycmVudERpZ2l0ID0gY2ggLSAweDMwOwoKICAgICAgICBpZiAoZU5vdGF0aW9uKSB7CiAgICAgICAgICBwb3dlclZhbHVlID0gcG93ZXJWYWx1ZSAqIDEwICsgY3VycmVudERpZ2l0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoZGl2aWRlQnkgIT09IDApIHsKICAgICAgICAgICAgZGl2aWRlQnkgKj0gMTA7CiAgICAgICAgICB9CgogICAgICAgICAgYmFzZVZhbHVlID0gYmFzZVZhbHVlICogMTAgKyBjdXJyZW50RGlnaXQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNoID09PSAweDJlKSB7CiAgICAgICAgaWYgKGRpdmlkZUJ5ID09PSAwKSB7CiAgICAgICAgICBkaXZpZGVCeSA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyZCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiQmFkbHkgZm9ybWF0dGVkIG51bWJlcjogbWludXMgc2lnbiBpbiB0aGUgbWlkZGxlIik7CiAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4NDUgfHwgY2ggPT09IDB4NjUpIHsKICAgICAgICBjaCA9IHRoaXMucGVla0NoYXIoKTsKCiAgICAgICAgaWYgKGNoID09PSAweDJiIHx8IGNoID09PSAweDJkKSB7CiAgICAgICAgICBwb3dlclZhbHVlU2lnbiA9IGNoID09PSAweDJkID8gLTEgOiAxOwogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIH0gZWxzZSBpZiAoY2ggPCAweDMwIHx8IGNoID4gMHgzOSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBlTm90YXRpb24gPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGRpdmlkZUJ5ICE9PSAwKSB7CiAgICAgIGJhc2VWYWx1ZSAvPSBkaXZpZGVCeTsKICAgIH0KCiAgICBpZiAoZU5vdGF0aW9uKSB7CiAgICAgIGJhc2VWYWx1ZSAqPSAxMCAqKiAocG93ZXJWYWx1ZVNpZ24gKiBwb3dlclZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gc2lnbiAqIGJhc2VWYWx1ZTsKICB9CgogIGdldFN0cmluZygpIHsKICAgIGxldCBudW1QYXJlbiA9IDE7CiAgICBsZXQgZG9uZSA9IGZhbHNlOwogICAgY29uc3Qgc3RyQnVmID0gdGhpcy5zdHJCdWY7CiAgICBzdHJCdWYubGVuZ3RoID0gMDsKICAgIGxldCBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgY2hhckJ1ZmZlcmVkID0gZmFsc2U7CgogICAgICBzd2l0Y2ggKGNoIHwgMCkgewogICAgICAgIGNhc2UgLTE6CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVudGVybWluYXRlZCBzdHJpbmciKTsKICAgICAgICAgIGRvbmUgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgyODoKICAgICAgICAgICsrbnVtUGFyZW47CiAgICAgICAgICBzdHJCdWYucHVzaCgiKCIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHgyOToKICAgICAgICAgIGlmICgtLW51bVBhcmVuID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdHJCdWYucHVzaCgiKSIpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4NWM6CiAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgICBzd2l0Y2ggKGNoKSB7CiAgICAgICAgICAgIGNhc2UgLTE6CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnRlcm1pbmF0ZWQgc3RyaW5nIik7CiAgICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NmU6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxuIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NzI6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxyIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NzQ6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlx0Iik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NjI6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxiIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NjY6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goIlxmIik7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4NWM6CiAgICAgICAgICAgIGNhc2UgMHgyODoKICAgICAgICAgICAgY2FzZSAweDI5OgogICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgzMDoKICAgICAgICAgICAgY2FzZSAweDMxOgogICAgICAgICAgICBjYXNlIDB4MzI6CiAgICAgICAgICAgIGNhc2UgMHgzMzoKICAgICAgICAgICAgY2FzZSAweDM0OgogICAgICAgICAgICBjYXNlIDB4MzU6CiAgICAgICAgICAgIGNhc2UgMHgzNjoKICAgICAgICAgICAgY2FzZSAweDM3OgogICAgICAgICAgICAgIGxldCB4ID0gY2ggJiAweDBmOwogICAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICAgIGNoYXJCdWZmZXJlZCA9IHRydWU7CgogICAgICAgICAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzcpIHsKICAgICAgICAgICAgICAgIHggPSAoeCA8PCAzKSArIChjaCAmIDB4MGYpOwogICAgICAgICAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgICAgICAgICAgaWYgKGNoID49IDB4MzAgJiYgY2ggPD0gMHgzNykgewogICAgICAgICAgICAgICAgICBjaGFyQnVmZmVyZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgeCA9ICh4IDw8IDMpICsgKGNoICYgMHgwZik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHgpKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgwZDoKICAgICAgICAgICAgICBpZiAodGhpcy5wZWVrQ2hhcigpID09PSAweDBhKSB7CiAgICAgICAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHgwYToKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChkb25lKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICghY2hhckJ1ZmZlcmVkKSB7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwogIH0KCiAgZ2V0TmFtZSgpIHsKICAgIGxldCBjaCwgcHJldmlvdXNDaDsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCAmJiAhc3BlY2lhbENoYXJzW2NoXSkgewogICAgICBpZiAoY2ggPT09IDB4MjMpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgaWYgKHNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTGV4ZXJfZ2V0TmFtZTogIiArICJOVU1CRVIgU0lHTiAoIykgc2hvdWxkIGJlIGZvbGxvd2VkIGJ5IGEgaGV4YWRlY2ltYWwgbnVtYmVyLiIpOwogICAgICAgICAgc3RyQnVmLnB1c2goIiMiKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgeCA9IHRvSGV4RGlnaXQoY2gpOwoKICAgICAgICBpZiAoeCAhPT0gLTEpIHsKICAgICAgICAgIHByZXZpb3VzQ2ggPSBjaDsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgY29uc3QgeDIgPSB0b0hleERpZ2l0KGNoKTsKCiAgICAgICAgICBpZiAoeDIgPT09IC0xKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgTGV4ZXJfZ2V0TmFtZTogSWxsZWdhbCBkaWdpdCAoJHtTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKX0pIGAgKyAiaW4gaGV4YWRlY2ltYWwgbnVtYmVyLiIpOwogICAgICAgICAgICBzdHJCdWYucHVzaCgiIyIsIFN0cmluZy5mcm9tQ2hhckNvZGUocHJldmlvdXNDaCkpOwoKICAgICAgICAgICAgaWYgKHNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHggPDwgNCB8IHgyKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0ckJ1Zi5wdXNoKCIjIiwgU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc3RyQnVmLmxlbmd0aCA+IDEyNykgewogICAgICAoMCwgX3V0aWwud2FybikoYE5hbWUgdG9rZW4gaXMgbG9uZ2VyIHRoYW4gYWxsb3dlZCBieSB0aGUgc3BlYzogJHtzdHJCdWYubGVuZ3RofWApOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5OYW1lLmdldChzdHJCdWYuam9pbigiIikpOwogIH0KCiAgX2hleFN0cmluZ1dhcm4oY2gpIHsKICAgIGNvbnN0IE1BWF9IRVhfU1RSSU5HX05VTV9XQVJOID0gNTsKCiAgICBpZiAodGhpcy5faGV4U3RyaW5nTnVtV2FybisrID09PSBNQVhfSEVYX1NUUklOR19OVU1fV0FSTikgewogICAgICAoMCwgX3V0aWwud2FybikoImdldEhleFN0cmluZyAtIGlnbm9yaW5nIGFkZGl0aW9uYWwgaW52YWxpZCBjaGFyYWN0ZXJzLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuX2hleFN0cmluZ051bVdhcm4gPiBNQVhfSEVYX1NUUklOR19OVU1fV0FSTikgewogICAgICByZXR1cm47CiAgICB9CgogICAgKDAsIF91dGlsLndhcm4pKGBnZXRIZXhTdHJpbmcgLSBpZ25vcmluZyBpbnZhbGlkIGNoYXJhY3RlcjogJHtjaH1gKTsKICB9CgogIGdldEhleFN0cmluZygpIHsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICBsZXQgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwogICAgbGV0IGlzRmlyc3RIZXggPSB0cnVlOwogICAgbGV0IGZpcnN0RGlnaXQsIHNlY29uZERpZ2l0OwogICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW50ZXJtaW5hdGVkIGhleCBzdHJpbmciKTsKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChzcGVjaWFsQ2hhcnNbY2hdID09PSAxKSB7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzRmlyc3RIZXgpIHsKICAgICAgICAgIGZpcnN0RGlnaXQgPSB0b0hleERpZ2l0KGNoKTsKCiAgICAgICAgICBpZiAoZmlyc3REaWdpdCA9PT0gLTEpIHsKICAgICAgICAgICAgdGhpcy5faGV4U3RyaW5nV2FybihjaCk7CgogICAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlY29uZERpZ2l0ID0gdG9IZXhEaWdpdChjaCk7CgogICAgICAgICAgaWYgKHNlY29uZERpZ2l0ID09PSAtMSkgewogICAgICAgICAgICB0aGlzLl9oZXhTdHJpbmdXYXJuKGNoKTsKCiAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGZpcnN0RGlnaXQgPDwgNCB8IHNlY29uZERpZ2l0KSk7CiAgICAgICAgfQoKICAgICAgICBpc0ZpcnN0SGV4ID0gIWlzRmlyc3RIZXg7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwogIH0KCiAgZ2V0T2JqKCkgewogICAgbGV0IGNvbW1lbnQgPSBmYWxzZTsKICAgIGxldCBjaCA9IHRoaXMuY3VycmVudENoYXI7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5FT0Y7CiAgICAgIH0KCiAgICAgIGlmIChjb21tZW50KSB7CiAgICAgICAgaWYgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKSB7CiAgICAgICAgICBjb21tZW50ID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNoID09PSAweDI1KSB7CiAgICAgICAgY29tbWVudCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAoc3BlY2lhbENoYXJzW2NoXSAhPT0gMSkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgIH0KCiAgICBzd2l0Y2ggKGNoIHwgMCkgewogICAgICBjYXNlIDB4MzA6CiAgICAgIGNhc2UgMHgzMToKICAgICAgY2FzZSAweDMyOgogICAgICBjYXNlIDB4MzM6CiAgICAgIGNhc2UgMHgzNDoKICAgICAgY2FzZSAweDM1OgogICAgICBjYXNlIDB4MzY6CiAgICAgIGNhc2UgMHgzNzoKICAgICAgY2FzZSAweDM4OgogICAgICBjYXNlIDB4Mzk6CiAgICAgIGNhc2UgMHgyYjoKICAgICAgY2FzZSAweDJkOgogICAgICBjYXNlIDB4MmU6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TnVtYmVyKCk7CgogICAgICBjYXNlIDB4Mjg6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyaW5nKCk7CgogICAgICBjYXNlIDB4MmY6CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZSgpOwoKICAgICAgY2FzZSAweDViOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiWyIpOwoKICAgICAgY2FzZSAweDVkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiXSIpOwoKICAgICAgY2FzZSAweDNjOgogICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgICBpZiAoY2ggPT09IDB4M2MpIHsKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCI8PCIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGV4U3RyaW5nKCk7CgogICAgICBjYXNlIDB4M2U6CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoIj4+Iik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgiPiIpOwoKICAgICAgY2FzZSAweDdiOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgieyIpOwoKICAgICAgY2FzZSAweDdkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ21kLmdldCgifSIpOwoKICAgICAgY2FzZSAweDI5OgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYElsbGVnYWwgY2hhcmFjdGVyOiAke2NofWApOwogICAgfQoKICAgIGxldCBzdHIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKCiAgICBpZiAoY2ggPCAweDIwIHx8IGNoID4gMHg3ZikgewogICAgICBjb25zdCBuZXh0Q2ggPSB0aGlzLnBlZWtDaGFyKCk7CgogICAgICBpZiAobmV4dENoID49IDB4MjAgJiYgbmV4dENoIDw9IDB4N2YpIHsKICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoc3RyKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGtub3duQ29tbWFuZHMgPSB0aGlzLmtub3duQ29tbWFuZHM7CiAgICBsZXQga25vd25Db21tYW5kRm91bmQgPSBrbm93bkNvbW1hbmRzICYmIGtub3duQ29tbWFuZHNbc3RyXSAhPT0gdW5kZWZpbmVkOwoKICAgIHdoaWxlICgoY2ggPSB0aGlzLm5leHRDaGFyKCkpID49IDAgJiYgIXNwZWNpYWxDaGFyc1tjaF0pIHsKICAgICAgY29uc3QgcG9zc2libGVDb21tYW5kID0gc3RyICsgU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CgogICAgICBpZiAoa25vd25Db21tYW5kRm91bmQgJiYga25vd25Db21tYW5kc1twb3NzaWJsZUNvbW1hbmRdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKHN0ci5sZW5ndGggPT09IDEyOCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgQ29tbWFuZCB0b2tlbiB0b28gbG9uZzogJHtzdHIubGVuZ3RofWApOwogICAgICB9CgogICAgICBzdHIgPSBwb3NzaWJsZUNvbW1hbmQ7CiAgICAgIGtub3duQ29tbWFuZEZvdW5kID0ga25vd25Db21tYW5kcyAmJiBrbm93bkNvbW1hbmRzW3N0cl0gIT09IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAoc3RyID09PSAidHJ1ZSIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKHN0ciA9PT0gImZhbHNlIikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHN0ciA9PT0gIm51bGwiKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChzdHIgPT09ICJCSSIpIHsKICAgICAgdGhpcy5iZWdpbklubGluZUltYWdlUG9zID0gdGhpcy5zdHJlYW0ucG9zOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KHN0cik7CiAgfQoKICBwZWVrT2JqKCkgewogICAgY29uc3Qgc3RyZWFtUG9zID0gdGhpcy5zdHJlYW0ucG9zLAogICAgICAgICAgY3VycmVudENoYXIgPSB0aGlzLmN1cnJlbnRDaGFyLAogICAgICAgICAgYmVnaW5JbmxpbmVJbWFnZVBvcyA9IHRoaXMuYmVnaW5JbmxpbmVJbWFnZVBvczsKICAgIGxldCBuZXh0T2JqOwoKICAgIHRyeSB7CiAgICAgIG5leHRPYmogPSB0aGlzLmdldE9iaigpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBwZWVrT2JqOiAke2V4fWApOwogICAgfQoKICAgIHRoaXMuc3RyZWFtLnBvcyA9IHN0cmVhbVBvczsKICAgIHRoaXMuY3VycmVudENoYXIgPSBjdXJyZW50Q2hhcjsKICAgIHRoaXMuYmVnaW5JbmxpbmVJbWFnZVBvcyA9IGJlZ2luSW5saW5lSW1hZ2VQb3M7CiAgICByZXR1cm4gbmV4dE9iajsKICB9CgogIHNraXBUb05leHRMaW5lKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKCiAgICB3aGlsZSAoY2ggPj0gMCkgewogICAgICBpZiAoY2ggPT09IDB4MGQpIHsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgaWYgKGNoID09PSAweDBhKSB7CiAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgwYSkgewogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5MZXhlciA9IExleGVyOwoKY2xhc3MgTGluZWFyaXphdGlvbiB7CiAgc3RhdGljIGNyZWF0ZShzdHJlYW0pIHsKICAgIGZ1bmN0aW9uIGdldEludChsaW5EaWN0LCBuYW1lLCBhbGxvd1plcm9WYWx1ZSA9IGZhbHNlKSB7CiAgICAgIGNvbnN0IG9iaiA9IGxpbkRpY3QuZ2V0KG5hbWUpOwoKICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSAmJiAoYWxsb3daZXJvVmFsdWUgPyBvYmogPj0gMCA6IG9iaiA+IDApKSB7CiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgIiR7bmFtZX0iIHBhcmFtZXRlciBpbiB0aGUgbGluZWFyaXphdGlvbiBgICsgImRpY3Rpb25hcnkgaXMgaW52YWxpZC4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRIaW50cyhsaW5EaWN0KSB7CiAgICAgIGNvbnN0IGhpbnRzID0gbGluRGljdC5nZXQoIkgiKTsKICAgICAgbGV0IGhpbnRzTGVuZ3RoOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaGludHMpICYmICgoaGludHNMZW5ndGggPSBoaW50cy5sZW5ndGgpID09PSAyIHx8IGhpbnRzTGVuZ3RoID09PSA0KSkgewogICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBoaW50c0xlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgY29uc3QgaGludCA9IGhpbnRzW2luZGV4XTsKCiAgICAgICAgICBpZiAoIShOdW1iZXIuaXNJbnRlZ2VyKGhpbnQpICYmIGhpbnQgPiAwKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhpbnQgKCR7aW5kZXh9KSBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuYCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaGludHM7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBFcnJvcigiSGludCBhcnJheSBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuIik7CiAgICB9CgogICAgY29uc3QgcGFyc2VyID0gbmV3IFBhcnNlcih7CiAgICAgIGxleGVyOiBuZXcgTGV4ZXIoc3RyZWFtKSwKICAgICAgeHJlZjogbnVsbAogICAgfSk7CiAgICBjb25zdCBvYmoxID0gcGFyc2VyLmdldE9iaigpOwogICAgY29uc3Qgb2JqMiA9IHBhcnNlci5nZXRPYmooKTsKICAgIGNvbnN0IG9iajMgPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICBjb25zdCBsaW5EaWN0ID0gcGFyc2VyLmdldE9iaigpOwogICAgbGV0IG9iaiwgbGVuZ3RoOwoKICAgIGlmICghKE51bWJlci5pc0ludGVnZXIob2JqMSkgJiYgTnVtYmVyLmlzSW50ZWdlcihvYmoyKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iajMsICJvYmoiKSAmJiBsaW5EaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiB0eXBlb2YgKG9iaiA9IGxpbkRpY3QuZ2V0KCJMaW5lYXJpemVkIikpID09PSAibnVtYmVyIiAmJiBvYmogPiAwKSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSBpZiAoKGxlbmd0aCA9IGdldEludChsaW5EaWN0LCAiTCIpKSAhPT0gc3RyZWFtLmxlbmd0aCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSAiTCIgcGFyYW1ldGVyIGluIHRoZSBsaW5lYXJpemF0aW9uIGRpY3Rpb25hcnkgJyArICJkb2VzIG5vdCBlcXVhbCB0aGUgc3RyZWFtIGxlbmd0aC4iKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBsZW5ndGgsCiAgICAgIGhpbnRzOiBnZXRIaW50cyhsaW5EaWN0KSwKICAgICAgb2JqZWN0TnVtYmVyRmlyc3Q6IGdldEludChsaW5EaWN0LCAiTyIpLAogICAgICBlbmRGaXJzdDogZ2V0SW50KGxpbkRpY3QsICJFIiksCiAgICAgIG51bVBhZ2VzOiBnZXRJbnQobGluRGljdCwgIk4iKSwKICAgICAgbWFpblhSZWZFbnRyaWVzT2Zmc2V0OiBnZXRJbnQobGluRGljdCwgIlQiKSwKICAgICAgcGFnZUZpcnN0OiBsaW5EaWN0LmhhcygiUCIpID8gZ2V0SW50KGxpbkRpY3QsICJQIiwgdHJ1ZSkgOiAwCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuTGluZWFyaXphdGlvbiA9IExpbmVhcml6YXRpb247CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Bc2NpaTg1U3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKY2xhc3MgQXNjaWk4NVN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCkgewogICAgaWYgKG1heWJlTGVuZ3RoKSB7CiAgICAgIG1heWJlTGVuZ3RoICo9IDAuODsKICAgIH0KCiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdGhpcy5pbnB1dCA9IG5ldyBVaW50OEFycmF5KDUpOwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgY29uc3QgVElMREFfQ0hBUiA9IDB4N2U7CiAgICBjb25zdCBaX0xPV0VSX0NIQVIgPSAweDdhOwogICAgY29uc3QgRU9GID0gLTE7CiAgICBjb25zdCBzdHIgPSB0aGlzLnN0cjsKICAgIGxldCBjID0gc3RyLmdldEJ5dGUoKTsKCiAgICB3aGlsZSAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoYykpIHsKICAgICAgYyA9IHN0ci5nZXRCeXRlKCk7CiAgICB9CgogICAgaWYgKGMgPT09IEVPRiB8fCBjID09PSBUSUxEQV9DSEFSKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgbGV0IGJ1ZmZlciwgaTsKCiAgICBpZiAoYyA9PT0gWl9MT1dFUl9DSEFSKSB7CiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIDQpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDQ7ICsraSkgewogICAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGggKyBpXSA9IDA7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IDQ7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBpbnB1dCA9IHRoaXMuaW5wdXQ7CiAgICAgIGlucHV0WzBdID0gYzsKCiAgICAgIGZvciAoaSA9IDE7IGkgPCA1OyArK2kpIHsKICAgICAgICBjID0gc3RyLmdldEJ5dGUoKTsKCiAgICAgICAgd2hpbGUgKCgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGMpKSB7CiAgICAgICAgICBjID0gc3RyLmdldEJ5dGUoKTsKICAgICAgICB9CgogICAgICAgIGlucHV0W2ldID0gYzsKCiAgICAgICAgaWYgKGMgPT09IEVPRiB8fCBjID09PSBUSUxEQV9DSEFSKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIGkgLSAxKTsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggKz0gaSAtIDE7CgogICAgICBpZiAoaSA8IDUpIHsKICAgICAgICBmb3IgKDsgaSA8IDU7ICsraSkgewogICAgICAgICAgaW5wdXRbaV0gPSAweDIxICsgODQ7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIH0KCiAgICAgIGxldCB0ID0gMDsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCA1OyArK2kpIHsKICAgICAgICB0ID0gdCAqIDg1ICsgKGlucHV0W2ldIC0gMHgyMSk7CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDM7IGkgPj0gMDsgLS1pKSB7CiAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aCArIGldID0gdCAmIDB4ZmY7CiAgICAgICAgdCA+Pj0gODsKICAgICAgfQogICAgfQogIH0KCn0KCmV4cG9ydHMuQXNjaWk4NVN0cmVhbSA9IEFzY2lpODVTdHJlYW07CgovKioqLyB9KSwKLyogMTkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHJlYW1zU2VxdWVuY2VTdHJlYW0gPSBleHBvcnRzLkRlY29kZVN0cmVhbSA9IHZvaWQgMDsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCmNvbnN0IGVtcHR5QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMCk7CgpjbGFzcyBEZWNvZGVTdHJlYW0gZXh0ZW5kcyBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSB7CiAgY29uc3RydWN0b3IobWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9yYXdNaW5CdWZmZXJMZW5ndGggPSBtYXliZU1pbkJ1ZmZlckxlbmd0aCB8fCAwOwogICAgdGhpcy5wb3MgPSAwOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSAwOwogICAgdGhpcy5lb2YgPSBmYWxzZTsKICAgIHRoaXMuYnVmZmVyID0gZW1wdHlCdWZmZXI7CiAgICB0aGlzLm1pbkJ1ZmZlckxlbmd0aCA9IDUxMjsKCiAgICBpZiAobWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgICAgd2hpbGUgKHRoaXMubWluQnVmZmVyTGVuZ3RoIDwgbWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgICAgICB0aGlzLm1pbkJ1ZmZlckxlbmd0aCAqPSAyOwogICAgICB9CiAgICB9CiAgfQoKICBnZXQgaXNFbXB0eSgpIHsKICAgIHdoaWxlICghdGhpcy5lb2YgJiYgdGhpcy5idWZmZXJMZW5ndGggPT09IDApIHsKICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5idWZmZXJMZW5ndGggPT09IDA7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7CiAgICBjb25zdCBidWZmZXIgPSB0aGlzLmJ1ZmZlcjsKCiAgICBpZiAocmVxdWVzdGVkIDw9IGJ1ZmZlci5ieXRlTGVuZ3RoKSB7CiAgICAgIHJldHVybiBidWZmZXI7CiAgICB9CgogICAgbGV0IHNpemUgPSB0aGlzLm1pbkJ1ZmZlckxlbmd0aDsKCiAgICB3aGlsZSAoc2l6ZSA8IHJlcXVlc3RlZCkgewogICAgICBzaXplICo9IDI7CiAgICB9CgogICAgY29uc3QgYnVmZmVyMiA9IG5ldyBVaW50OEFycmF5KHNpemUpOwogICAgYnVmZmVyMi5zZXQoYnVmZmVyKTsKICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjI7CiAgfQoKICBnZXRCeXRlKCkgewogICAgY29uc3QgcG9zID0gdGhpcy5wb3M7CgogICAgd2hpbGUgKHRoaXMuYnVmZmVyTGVuZ3RoIDw9IHBvcykgewogICAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuYnVmZmVyW3RoaXMucG9zKytdOwogIH0KCiAgZ2V0Qnl0ZXMobGVuZ3RoKSB7CiAgICBjb25zdCBwb3MgPSB0aGlzLnBvczsKICAgIGxldCBlbmQ7CgogICAgaWYgKGxlbmd0aCkgewogICAgICB0aGlzLmVuc3VyZUJ1ZmZlcihwb3MgKyBsZW5ndGgpOwogICAgICBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgICB3aGlsZSAoIXRoaXMuZW9mICYmIHRoaXMuYnVmZmVyTGVuZ3RoIDwgZW5kKSB7CiAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgfQoKICAgICAgY29uc3QgYnVmRW5kID0gdGhpcy5idWZmZXJMZW5ndGg7CgogICAgICBpZiAoZW5kID4gYnVmRW5kKSB7CiAgICAgICAgZW5kID0gYnVmRW5kOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB3aGlsZSAoIXRoaXMuZW9mKSB7CiAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgfQoKICAgICAgZW5kID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICB9CgogICAgdGhpcy5wb3MgPSBlbmQ7CiAgICByZXR1cm4gdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zLCBlbmQpOwogIH0KCiAgcmVzZXQoKSB7CiAgICB0aGlzLnBvcyA9IDA7CiAgfQoKICBtYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgsIGRpY3QgPSBudWxsKSB7CiAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKICAgICAgd2hpbGUgKCF0aGlzLmVvZikgewogICAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbGVuZ3RoOwoKICAgICAgd2hpbGUgKHRoaXMuYnVmZmVyTGVuZ3RoIDw9IGVuZCAmJiAhdGhpcy5lb2YpIHsKICAgICAgICB0aGlzLnJlYWRCbG9jaygpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5ldyBfc3RyZWFtLlN0cmVhbSh0aGlzLmJ1ZmZlciwgc3RhcnQsIGxlbmd0aCwgZGljdCk7CiAgfQoKICBnZXRCYXNlU3RyZWFtcygpIHsKICAgIHJldHVybiB0aGlzLnN0ciA/IHRoaXMuc3RyLmdldEJhc2VTdHJlYW1zKCkgOiBudWxsOwogIH0KCn0KCmV4cG9ydHMuRGVjb2RlU3RyZWFtID0gRGVjb2RlU3RyZWFtOwoKY2xhc3MgU3RyZWFtc1NlcXVlbmNlU3RyZWFtIGV4dGVuZHMgRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHJlYW1zLCBvbkVycm9yID0gbnVsbCkgewogICAgbGV0IG1heWJlTGVuZ3RoID0gMDsKCiAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiBzdHJlYW1zKSB7CiAgICAgIG1heWJlTGVuZ3RoICs9IHN0cmVhbSBpbnN0YW5jZW9mIERlY29kZVN0cmVhbSA/IHN0cmVhbS5fcmF3TWluQnVmZmVyTGVuZ3RoIDogc3RyZWFtLmxlbmd0aDsKICAgIH0KCiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0cmVhbXMgPSBzdHJlYW1zOwogICAgdGhpcy5fb25FcnJvciA9IG9uRXJyb3I7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICBjb25zdCBzdHJlYW1zID0gdGhpcy5zdHJlYW1zOwoKICAgIGlmIChzdHJlYW1zLmxlbmd0aCA9PT0gMCkgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzdHJlYW0gPSBzdHJlYW1zLnNoaWZ0KCk7CiAgICBsZXQgY2h1bms7CgogICAgdHJ5IHsKICAgICAgY2h1bmsgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgIH0gY2F0Y2ggKHJlYXNvbikgewogICAgICBpZiAodGhpcy5fb25FcnJvcikgewogICAgICAgIHRoaXMuX29uRXJyb3IocmVhc29uLCBzdHJlYW0uZGljdCAmJiBzdHJlYW0uZGljdC5vYmpJZCk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgY29uc3QgbmV3TGVuZ3RoID0gYnVmZmVyTGVuZ3RoICsgY2h1bmsubGVuZ3RoOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIobmV3TGVuZ3RoKTsKICAgIGJ1ZmZlci5zZXQoY2h1bmssIGJ1ZmZlckxlbmd0aCk7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IG5ld0xlbmd0aDsKICB9CgogIGdldEJhc2VTdHJlYW1zKCkgewogICAgY29uc3QgYmFzZVN0cmVhbXNCdWYgPSBbXTsKCiAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiB0aGlzLnN0cmVhbXMpIHsKICAgICAgY29uc3QgYmFzZVN0cmVhbXMgPSBzdHJlYW0uZ2V0QmFzZVN0cmVhbXMoKTsKCiAgICAgIGlmIChiYXNlU3RyZWFtcykgewogICAgICAgIGJhc2VTdHJlYW1zQnVmLnB1c2goLi4uYmFzZVN0cmVhbXMpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGJhc2VTdHJlYW1zQnVmLmxlbmd0aCA+IDAgPyBiYXNlU3RyZWFtc0J1ZiA6IG51bGw7CiAgfQoKfQoKZXhwb3J0cy5TdHJlYW1zU2VxdWVuY2VTdHJlYW0gPSBTdHJlYW1zU2VxdWVuY2VTdHJlYW07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Bc2NpaUhleFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwoKY2xhc3MgQXNjaWlIZXhTdHJlYW0gZXh0ZW5kcyBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0ciwgbWF5YmVMZW5ndGgpIHsKICAgIGlmIChtYXliZUxlbmd0aCkgewogICAgICBtYXliZUxlbmd0aCAqPSAwLjU7CiAgICB9CgogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuZmlyc3REaWdpdCA9IC0xOwogIH0KCiAgcmVhZEJsb2NrKCkgewogICAgY29uc3QgVVBTVFJFQU1fQkxPQ0tfU0laRSA9IDgwMDA7CiAgICBjb25zdCBieXRlcyA9IHRoaXMuc3RyLmdldEJ5dGVzKFVQU1RSRUFNX0JMT0NLX1NJWkUpOwoKICAgIGlmICghYnl0ZXMubGVuZ3RoKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG1heERlY29kZUxlbmd0aCA9IGJ5dGVzLmxlbmd0aCArIDEgPj4gMTsKICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKHRoaXMuYnVmZmVyTGVuZ3RoICsgbWF4RGVjb2RlTGVuZ3RoKTsKICAgIGxldCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGxldCBmaXJzdERpZ2l0ID0gdGhpcy5maXJzdERpZ2l0OwoKICAgIGZvciAoY29uc3QgY2ggb2YgYnl0ZXMpIHsKICAgICAgbGV0IGRpZ2l0OwoKICAgICAgaWYgKGNoID49IDB4MzAgJiYgY2ggPD0gMHgzOSkgewogICAgICAgIGRpZ2l0ID0gY2ggJiAweDBmOwogICAgICB9IGVsc2UgaWYgKGNoID49IDB4NDEgJiYgY2ggPD0gMHg0NiB8fCBjaCA+PSAweDYxICYmIGNoIDw9IDB4NjYpIHsKICAgICAgICBkaWdpdCA9IChjaCAmIDB4MGYpICsgOTsKICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGZpcnN0RGlnaXQgPCAwKSB7CiAgICAgICAgZmlyc3REaWdpdCA9IGRpZ2l0OwogICAgICB9IGVsc2UgewogICAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGgrK10gPSBmaXJzdERpZ2l0IDw8IDQgfCBkaWdpdDsKICAgICAgICBmaXJzdERpZ2l0ID0gLTE7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZmlyc3REaWdpdCA+PSAwICYmIHRoaXMuZW9mKSB7CiAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGgrK10gPSBmaXJzdERpZ2l0IDw8IDQ7CiAgICAgIGZpcnN0RGlnaXQgPSAtMTsKICAgIH0KCiAgICB0aGlzLmZpcnN0RGlnaXQgPSBmaXJzdERpZ2l0OwogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgfQoKfQoKZXhwb3J0cy5Bc2NpaUhleFN0cmVhbSA9IEFzY2lpSGV4U3RyZWFtOwoKLyoqKi8gfSksCi8qIDIxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQ0NJVFRGYXhTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2NjaXR0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7CgpjbGFzcyBDQ0lUVEZheFN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCwgcGFyYW1zKSB7CiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwoKICAgIGlmICghKHBhcmFtcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHBhcmFtcyA9IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CiAgICB9CgogICAgY29uc3Qgc291cmNlID0gewogICAgICBuZXh0KCkgewogICAgICAgIHJldHVybiBzdHIuZ2V0Qnl0ZSgpOwogICAgICB9CgogICAgfTsKICAgIHRoaXMuY2NpdHRGYXhEZWNvZGVyID0gbmV3IF9jY2l0dC5DQ0lUVEZheERlY29kZXIoc291cmNlLCB7CiAgICAgIEs6IHBhcmFtcy5nZXQoIksiKSwKICAgICAgRW5kT2ZMaW5lOiBwYXJhbXMuZ2V0KCJFbmRPZkxpbmUiKSwKICAgICAgRW5jb2RlZEJ5dGVBbGlnbjogcGFyYW1zLmdldCgiRW5jb2RlZEJ5dGVBbGlnbiIpLAogICAgICBDb2x1bW5zOiBwYXJhbXMuZ2V0KCJDb2x1bW5zIiksCiAgICAgIFJvd3M6IHBhcmFtcy5nZXQoIlJvd3MiKSwKICAgICAgRW5kT2ZCbG9jazogcGFyYW1zLmdldCgiRW5kT2ZCbG9jayIpLAogICAgICBCbGFja0lzMTogcGFyYW1zLmdldCgiQmxhY2tJczEiKQogICAgfSk7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICB3aGlsZSAoIXRoaXMuZW9mKSB7CiAgICAgIGNvbnN0IGMgPSB0aGlzLmNjaXR0RmF4RGVjb2Rlci5yZWFkTmV4dENoYXIoKTsKCiAgICAgIGlmIChjID09PSAtMSkgewogICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuZW5zdXJlQnVmZmVyKHRoaXMuYnVmZmVyTGVuZ3RoICsgMSk7CiAgICAgIHRoaXMuYnVmZmVyW3RoaXMuYnVmZmVyTGVuZ3RoKytdID0gYzsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkNDSVRURmF4U3RyZWFtID0gQ0NJVFRGYXhTdHJlYW07CgovKioqLyB9KSwKLyogMjIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5DQ0lUVEZheERlY29kZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgY2NpdHRFT0wgPSAtMjsKY29uc3QgY2NpdHRFT0YgPSAtMTsKY29uc3QgdHdvRGltUGFzcyA9IDA7CmNvbnN0IHR3b0RpbUhvcml6ID0gMTsKY29uc3QgdHdvRGltVmVydDAgPSAyOwpjb25zdCB0d29EaW1WZXJ0UjEgPSAzOwpjb25zdCB0d29EaW1WZXJ0TDEgPSA0Owpjb25zdCB0d29EaW1WZXJ0UjIgPSA1Owpjb25zdCB0d29EaW1WZXJ0TDIgPSA2Owpjb25zdCB0d29EaW1WZXJ0UjMgPSA3Owpjb25zdCB0d29EaW1WZXJ0TDMgPSA4Owpjb25zdCB0d29EaW1UYWJsZSA9IFtbLTEsIC0xXSwgWy0xLCAtMV0sIFs3LCB0d29EaW1WZXJ0TDNdLCBbNywgdHdvRGltVmVydFIzXSwgWzYsIHR3b0RpbVZlcnRMMl0sIFs2LCB0d29EaW1WZXJ0TDJdLCBbNiwgdHdvRGltVmVydFIyXSwgWzYsIHR3b0RpbVZlcnRSMl0sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltSG9yaXpdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF0sIFsxLCB0d29EaW1WZXJ0MF1dOwpjb25zdCB3aGl0ZVRhYmxlMSA9IFtbLTEsIC0xXSwgWzEyLCBjY2l0dEVPTF0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWzExLCAxNzkyXSwgWzExLCAxNzkyXSwgWzEyLCAxOTg0XSwgWzEyLCAyMDQ4XSwgWzEyLCAyMTEyXSwgWzEyLCAyMTc2XSwgWzEyLCAyMjQwXSwgWzEyLCAyMzA0XSwgWzExLCAxODU2XSwgWzExLCAxODU2XSwgWzExLCAxOTIwXSwgWzExLCAxOTIwXSwgWzEyLCAyMzY4XSwgWzEyLCAyNDMyXSwgWzEyLCAyNDk2XSwgWzEyLCAyNTYwXV07CmNvbnN0IHdoaXRlVGFibGUyID0gW1stMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbOCwgMjldLCBbOCwgMjldLCBbOCwgMzBdLCBbOCwgMzBdLCBbOCwgNDVdLCBbOCwgNDVdLCBbOCwgNDZdLCBbOCwgNDZdLCBbNywgMjJdLCBbNywgMjJdLCBbNywgMjJdLCBbNywgMjJdLCBbNywgMjNdLCBbNywgMjNdLCBbNywgMjNdLCBbNywgMjNdLCBbOCwgNDddLCBbOCwgNDddLCBbOCwgNDhdLCBbOCwgNDhdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNiwgMTNdLCBbNywgMjBdLCBbNywgMjBdLCBbNywgMjBdLCBbNywgMjBdLCBbOCwgMzNdLCBbOCwgMzNdLCBbOCwgMzRdLCBbOCwgMzRdLCBbOCwgMzVdLCBbOCwgMzVdLCBbOCwgMzZdLCBbOCwgMzZdLCBbOCwgMzddLCBbOCwgMzddLCBbOCwgMzhdLCBbOCwgMzhdLCBbNywgMTldLCBbNywgMTldLCBbNywgMTldLCBbNywgMTldLCBbOCwgMzFdLCBbOCwgMzFdLCBbOCwgMzJdLCBbOCwgMzJdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzYsIDEyXSwgWzgsIDUzXSwgWzgsIDUzXSwgWzgsIDU0XSwgWzgsIDU0XSwgWzcsIDI2XSwgWzcsIDI2XSwgWzcsIDI2XSwgWzcsIDI2XSwgWzgsIDM5XSwgWzgsIDM5XSwgWzgsIDQwXSwgWzgsIDQwXSwgWzgsIDQxXSwgWzgsIDQxXSwgWzgsIDQyXSwgWzgsIDQyXSwgWzgsIDQzXSwgWzgsIDQzXSwgWzgsIDQ0XSwgWzgsIDQ0XSwgWzcsIDIxXSwgWzcsIDIxXSwgWzcsIDIxXSwgWzcsIDIxXSwgWzcsIDI4XSwgWzcsIDI4XSwgWzcsIDI4XSwgWzcsIDI4XSwgWzgsIDYxXSwgWzgsIDYxXSwgWzgsIDYyXSwgWzgsIDYyXSwgWzgsIDYzXSwgWzgsIDYzXSwgWzgsIDBdLCBbOCwgMF0sIFs4LCAzMjBdLCBbOCwgMzIwXSwgWzgsIDM4NF0sIFs4LCAzODRdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTBdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNSwgMTFdLCBbNywgMjddLCBbNywgMjddLCBbNywgMjddLCBbNywgMjddLCBbOCwgNTldLCBbOCwgNTldLCBbOCwgNjBdLCBbOCwgNjBdLCBbOSwgMTQ3Ml0sIFs5LCAxNTM2XSwgWzksIDE2MDBdLCBbOSwgMTcyOF0sIFs3LCAxOF0sIFs3LCAxOF0sIFs3LCAxOF0sIFs3LCAxOF0sIFs3LCAyNF0sIFs3LCAyNF0sIFs3LCAyNF0sIFs3LCAyNF0sIFs4LCA0OV0sIFs4LCA0OV0sIFs4LCA1MF0sIFs4LCA1MF0sIFs4LCA1MV0sIFs4LCA1MV0sIFs4LCA1Ml0sIFs4LCA1Ml0sIFs3LCAyNV0sIFs3LCAyNV0sIFs3LCAyNV0sIFs3LCAyNV0sIFs4LCA1NV0sIFs4LCA1NV0sIFs4LCA1Nl0sIFs4LCA1Nl0sIFs4LCA1N10sIFs4LCA1N10sIFs4LCA1OF0sIFs4LCA1OF0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs4LCA0NDhdLCBbOCwgNDQ4XSwgWzgsIDUxMl0sIFs4LCA1MTJdLCBbOSwgNzA0XSwgWzksIDc2OF0sIFs4LCA2NDBdLCBbOCwgNjQwXSwgWzgsIDU3Nl0sIFs4LCA1NzZdLCBbOSwgODMyXSwgWzksIDg5Nl0sIFs5LCA5NjBdLCBbOSwgMTAyNF0sIFs5LCAxMDg4XSwgWzksIDExNTJdLCBbOSwgMTIxNl0sIFs5LCAxMjgwXSwgWzksIDEzNDRdLCBbOSwgMTQwOF0sIFs3LCAyNTZdLCBbNywgMjU2XSwgWzcsIDI1Nl0sIFs3LCAyNTZdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE2XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzYsIDE3XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTRdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNiwgMTVdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNSwgNjRdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN11dOwpjb25zdCBibGFja1RhYmxlMSA9IFtbLTEsIC0xXSwgWy0xLCAtMV0sIFsxMiwgY2NpdHRFT0xdLCBbMTIsIGNjaXR0RU9MXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFsxMSwgMTc5Ml0sIFsxMSwgMTc5Ml0sIFsxMSwgMTc5Ml0sIFsxMSwgMTc5Ml0sIFsxMiwgMTk4NF0sIFsxMiwgMTk4NF0sIFsxMiwgMjA0OF0sIFsxMiwgMjA0OF0sIFsxMiwgMjExMl0sIFsxMiwgMjExMl0sIFsxMiwgMjE3Nl0sIFsxMiwgMjE3Nl0sIFsxMiwgMjI0MF0sIFsxMiwgMjI0MF0sIFsxMiwgMjMwNF0sIFsxMiwgMjMwNF0sIFsxMSwgMTg1Nl0sIFsxMSwgMTg1Nl0sIFsxMSwgMTg1Nl0sIFsxMSwgMTg1Nl0sIFsxMSwgMTkyMF0sIFsxMSwgMTkyMF0sIFsxMSwgMTkyMF0sIFsxMSwgMTkyMF0sIFsxMiwgMjM2OF0sIFsxMiwgMjM2OF0sIFsxMiwgMjQzMl0sIFsxMiwgMjQzMl0sIFsxMiwgMjQ5Nl0sIFsxMiwgMjQ5Nl0sIFsxMiwgMjU2MF0sIFsxMiwgMjU2MF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEyLCA1Ml0sIFsxMiwgNTJdLCBbMTMsIDY0MF0sIFsxMywgNzA0XSwgWzEzLCA3NjhdLCBbMTMsIDgzMl0sIFsxMiwgNTVdLCBbMTIsIDU1XSwgWzEyLCA1Nl0sIFsxMiwgNTZdLCBbMTMsIDEyODBdLCBbMTMsIDEzNDRdLCBbMTMsIDE0MDhdLCBbMTMsIDE0NzJdLCBbMTIsIDU5XSwgWzEyLCA1OV0sIFsxMiwgNjBdLCBbMTIsIDYwXSwgWzEzLCAxNTM2XSwgWzEzLCAxNjAwXSwgWzExLCAyNF0sIFsxMSwgMjRdLCBbMTEsIDI0XSwgWzExLCAyNF0sIFsxMSwgMjVdLCBbMTEsIDI1XSwgWzExLCAyNV0sIFsxMSwgMjVdLCBbMTMsIDE2NjRdLCBbMTMsIDE3MjhdLCBbMTIsIDMyMF0sIFsxMiwgMzIwXSwgWzEyLCAzODRdLCBbMTIsIDM4NF0sIFsxMiwgNDQ4XSwgWzEyLCA0NDhdLCBbMTMsIDUxMl0sIFsxMywgNTc2XSwgWzEyLCA1M10sIFsxMiwgNTNdLCBbMTIsIDU0XSwgWzEyLCA1NF0sIFsxMywgODk2XSwgWzEzLCA5NjBdLCBbMTMsIDEwMjRdLCBbMTMsIDEwODhdLCBbMTMsIDExNTJdLCBbMTMsIDEyMTZdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF1dOwpjb25zdCBibGFja1RhYmxlMiA9IFtbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbOCwgMTNdLCBbMTEsIDIzXSwgWzExLCAyM10sIFsxMiwgNTBdLCBbMTIsIDUxXSwgWzEyLCA0NF0sIFsxMiwgNDVdLCBbMTIsIDQ2XSwgWzEyLCA0N10sIFsxMiwgNTddLCBbMTIsIDU4XSwgWzEyLCA2MV0sIFsxMiwgMjU2XSwgWzEwLCAxNl0sIFsxMCwgMTZdLCBbMTAsIDE2XSwgWzEwLCAxNl0sIFsxMCwgMTddLCBbMTAsIDE3XSwgWzEwLCAxN10sIFsxMCwgMTddLCBbMTIsIDQ4XSwgWzEyLCA0OV0sIFsxMiwgNjJdLCBbMTIsIDYzXSwgWzEyLCAzMF0sIFsxMiwgMzFdLCBbMTIsIDMyXSwgWzEyLCAzM10sIFsxMiwgNDBdLCBbMTIsIDQxXSwgWzExLCAyMl0sIFsxMSwgMjJdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbOCwgMTRdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTBdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbNywgMTFdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbOSwgMTVdLCBbMTIsIDEyOF0sIFsxMiwgMTkyXSwgWzEyLCAyNl0sIFsxMiwgMjddLCBbMTIsIDI4XSwgWzEyLCAyOV0sIFsxMSwgMTldLCBbMTEsIDE5XSwgWzExLCAyMF0sIFsxMSwgMjBdLCBbMTIsIDM0XSwgWzEyLCAzNV0sIFsxMiwgMzZdLCBbMTIsIDM3XSwgWzEyLCAzOF0sIFsxMiwgMzldLCBbMTEsIDIxXSwgWzExLCAyMV0sIFsxMiwgNDJdLCBbMTIsIDQzXSwgWzEwLCAwXSwgWzEwLCAwXSwgWzEwLCAwXSwgWzEwLCAwXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXSwgWzcsIDEyXV07CmNvbnN0IGJsYWNrVGFibGUzID0gW1stMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbNiwgOV0sIFs2LCA4XSwgWzUsIDddLCBbNSwgN10sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdXTsKCmNsYXNzIENDSVRURmF4RGVjb2RlciB7CiAgY29uc3RydWN0b3Ioc291cmNlLCBvcHRpb25zID0ge30pIHsKICAgIGlmICghc291cmNlIHx8IHR5cGVvZiBzb3VyY2UubmV4dCAhPT0gImZ1bmN0aW9uIikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NDSVRURmF4RGVjb2RlciAtIGludmFsaWQgInNvdXJjZSIgcGFyYW1ldGVyLicpOwogICAgfQoKICAgIHRoaXMuc291cmNlID0gc291cmNlOwogICAgdGhpcy5lb2YgPSBmYWxzZTsKICAgIHRoaXMuZW5jb2RpbmcgPSBvcHRpb25zLksgfHwgMDsKICAgIHRoaXMuZW9saW5lID0gb3B0aW9ucy5FbmRPZkxpbmUgfHwgZmFsc2U7CiAgICB0aGlzLmJ5dGVBbGlnbiA9IG9wdGlvbnMuRW5jb2RlZEJ5dGVBbGlnbiB8fCBmYWxzZTsKICAgIHRoaXMuY29sdW1ucyA9IG9wdGlvbnMuQ29sdW1ucyB8fCAxNzI4OwogICAgdGhpcy5yb3dzID0gb3B0aW9ucy5Sb3dzIHx8IDA7CiAgICBsZXQgZW9ibG9jayA9IG9wdGlvbnMuRW5kT2ZCbG9jazsKCiAgICBpZiAoZW9ibG9jayA9PT0gbnVsbCB8fCBlb2Jsb2NrID09PSB1bmRlZmluZWQpIHsKICAgICAgZW9ibG9jayA9IHRydWU7CiAgICB9CgogICAgdGhpcy5lb2Jsb2NrID0gZW9ibG9jazsKICAgIHRoaXMuYmxhY2sgPSBvcHRpb25zLkJsYWNrSXMxIHx8IGZhbHNlOwogICAgdGhpcy5jb2RpbmdMaW5lID0gbmV3IFVpbnQzMkFycmF5KHRoaXMuY29sdW1ucyArIDEpOwogICAgdGhpcy5yZWZMaW5lID0gbmV3IFVpbnQzMkFycmF5KHRoaXMuY29sdW1ucyArIDIpOwogICAgdGhpcy5jb2RpbmdMaW5lWzBdID0gdGhpcy5jb2x1bW5zOwogICAgdGhpcy5jb2RpbmdQb3MgPSAwOwogICAgdGhpcy5yb3cgPSAwOwogICAgdGhpcy5uZXh0TGluZTJEID0gdGhpcy5lbmNvZGluZyA8IDA7CiAgICB0aGlzLmlucHV0Qml0cyA9IDA7CiAgICB0aGlzLmlucHV0QnVmID0gMDsKICAgIHRoaXMub3V0cHV0Qml0cyA9IDA7CiAgICB0aGlzLnJvd3NEb25lID0gZmFsc2U7CiAgICBsZXQgY29kZTE7CgogICAgd2hpbGUgKChjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKSkgPT09IDApIHsKICAgICAgdGhpcy5fZWF0Qml0cygxKTsKICAgIH0KCiAgICBpZiAoY29kZTEgPT09IDEpIHsKICAgICAgdGhpcy5fZWF0Qml0cygxMik7CiAgICB9CgogICAgaWYgKHRoaXMuZW5jb2RpbmcgPiAwKSB7CiAgICAgIHRoaXMubmV4dExpbmUyRCA9ICF0aGlzLl9sb29rQml0cygxKTsKCiAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICB9CiAgfQoKICByZWFkTmV4dENoYXIoKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfQoKICAgIGNvbnN0IHJlZkxpbmUgPSB0aGlzLnJlZkxpbmU7CiAgICBjb25zdCBjb2RpbmdMaW5lID0gdGhpcy5jb2RpbmdMaW5lOwogICAgY29uc3QgY29sdW1ucyA9IHRoaXMuY29sdW1uczsKICAgIGxldCByZWZQb3MsIGJsYWNrUGl4ZWxzLCBiaXRzLCBpOwoKICAgIGlmICh0aGlzLm91dHB1dEJpdHMgPT09IDApIHsKICAgICAgaWYgKHRoaXMucm93c0RvbmUpIHsKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVvZikgewogICAgICAgIHJldHVybiAtMTsKICAgICAgfQoKICAgICAgdGhpcy5lcnIgPSBmYWxzZTsKICAgICAgbGV0IGNvZGUxLCBjb2RlMiwgY29kZTM7CgogICAgICBpZiAodGhpcy5uZXh0TGluZTJEKSB7CiAgICAgICAgZm9yIChpID0gMDsgY29kaW5nTGluZVtpXSA8IGNvbHVtbnM7ICsraSkgewogICAgICAgICAgcmVmTGluZVtpXSA9IGNvZGluZ0xpbmVbaV07CiAgICAgICAgfQoKICAgICAgICByZWZMaW5lW2krK10gPSBjb2x1bW5zOwogICAgICAgIHJlZkxpbmVbaV0gPSBjb2x1bW5zOwogICAgICAgIGNvZGluZ0xpbmVbMF0gPSAwOwogICAgICAgIHRoaXMuY29kaW5nUG9zID0gMDsKICAgICAgICByZWZQb3MgPSAwOwogICAgICAgIGJsYWNrUGl4ZWxzID0gMDsKCiAgICAgICAgd2hpbGUgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgY29kZTEgPSB0aGlzLl9nZXRUd29EaW1Db2RlKCk7CgogICAgICAgICAgc3dpdGNoIChjb2RlMSkgewogICAgICAgICAgICBjYXNlIHR3b0RpbVBhc3M6CiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zICsgMV0sIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgaWYgKHJlZkxpbmVbcmVmUG9zICsgMV0gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1Ib3JpejoKICAgICAgICAgICAgICBjb2RlMSA9IGNvZGUyID0gMDsKCiAgICAgICAgICAgICAgaWYgKGJsYWNrUGl4ZWxzKSB7CiAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0QmxhY2tDb2RlKCk7CiAgICAgICAgICAgICAgICB9IHdoaWxlIChjb2RlMyA+PSA2NCk7CgogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICBjb2RlMiArPSBjb2RlMyA9IHRoaXMuX2dldFdoaXRlQ29kZSgpOwogICAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0V2hpdGVDb2RlKCk7CiAgICAgICAgICAgICAgICB9IHdoaWxlIChjb2RlMyA+PSA2NCk7CgogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICBjb2RlMiArPSBjb2RlMyA9IHRoaXMuX2dldEJsYWNrQ29kZSgpOwogICAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICsgY29kZTEsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICsgY29kZTIsIGJsYWNrUGl4ZWxzIF4gMSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRSMzoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMocmVmTGluZVtyZWZQb3NdICsgMywgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICArK3JlZlBvczsKCiAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydFIyOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhyZWZMaW5lW3JlZlBvc10gKyAyLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICsrcmVmUG9zOwoKICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0UjE6CiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zXSArIDEsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgKytyZWZQb3M7CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnQwOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhyZWZMaW5lW3JlZlBvc10sIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgKytyZWZQb3M7CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRMMzoKICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHNOZWcocmVmTGluZVtyZWZQb3NdIC0gMywgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICBpZiAocmVmUG9zID4gMCkgewogICAgICAgICAgICAgICAgICAtLXJlZlBvczsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICsrcmVmUG9zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0TDI6CiAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzTmVnKHJlZkxpbmVbcmVmUG9zXSAtIDIsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgaWYgKHJlZlBvcyA+IDApIHsKICAgICAgICAgICAgICAgICAgLS1yZWZQb3M7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICArK3JlZlBvczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydEwxOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVsc05lZyhyZWZMaW5lW3JlZlBvc10gLSAxLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgIGlmIChyZWZQb3MgPiAwKSB7CiAgICAgICAgICAgICAgICAgIC0tcmVmUG9zOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgKytyZWZQb3M7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIGNjaXR0RU9GOgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhjb2x1bW5zLCAwKTsKCiAgICAgICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoImJhZCAyZCBjb2RlIik7CgogICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhjb2x1bW5zLCAwKTsKCiAgICAgICAgICAgICAgdGhpcy5lcnIgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb2RpbmdMaW5lWzBdID0gMDsKICAgICAgICB0aGlzLmNvZGluZ1BvcyA9IDA7CiAgICAgICAgYmxhY2tQaXhlbHMgPSAwOwoKICAgICAgICB3aGlsZSAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICBjb2RlMSA9IDA7CgogICAgICAgICAgaWYgKGJsYWNrUGl4ZWxzKSB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICBjb2RlMSArPSBjb2RlMyA9IHRoaXMuX2dldEJsYWNrQ29kZSgpOwogICAgICAgICAgICB9IHdoaWxlIChjb2RlMyA+PSA2NCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgY29kZTEgKz0gY29kZTMgPSB0aGlzLl9nZXRXaGl0ZUNvZGUoKTsKICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSArIGNvZGUxLCBibGFja1BpeGVscyk7CgogICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxldCBnb3RFT0wgPSBmYWxzZTsKCiAgICAgIGlmICh0aGlzLmJ5dGVBbGlnbikgewogICAgICAgIHRoaXMuaW5wdXRCaXRzICY9IH43OwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZW9ibG9jayAmJiB0aGlzLnJvdyA9PT0gdGhpcy5yb3dzIC0gMSkgewogICAgICAgIHRoaXMucm93c0RvbmUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTIpOwoKICAgICAgICBpZiAodGhpcy5lb2xpbmUpIHsKICAgICAgICAgIHdoaWxlIChjb2RlMSAhPT0gY2NpdHRFT0YgJiYgY29kZTEgIT09IDEpIHsKICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICAgICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTIpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGlsZSAoY29kZTEgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICAgICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNvZGUxID09PSAxKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEyKTsKCiAgICAgICAgICBnb3RFT0wgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoY29kZTEgPT09IGNjaXR0RU9GKSB7CiAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuZW9mICYmIHRoaXMuZW5jb2RpbmcgPiAwICYmICF0aGlzLnJvd3NEb25lKSB7CiAgICAgICAgdGhpcy5uZXh0TGluZTJEID0gIXRoaXMuX2xvb2tCaXRzKDEpOwoKICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgICB9CgogICAgICBpZiAodGhpcy5lb2Jsb2NrICYmIGdvdEVPTCAmJiB0aGlzLmJ5dGVBbGlnbikgewogICAgICAgIGNvZGUxID0gdGhpcy5fbG9va0JpdHMoMTIpOwoKICAgICAgICBpZiAoY29kZTEgPT09IDEpIHsKICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwoKICAgICAgICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICAgICAgICB0aGlzLl9sb29rQml0cygxKTsKCiAgICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuZW5jb2RpbmcgPj0gMCkgewogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgKytpKSB7CiAgICAgICAgICAgICAgY29kZTEgPSB0aGlzLl9sb29rQml0cygxMik7CgogICAgICAgICAgICAgIGlmIChjb2RlMSAhPT0gMSkgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJiYWQgcnRjIGNvZGU6ICIgKyBjb2RlMSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEyKTsKCiAgICAgICAgICAgICAgaWYgKHRoaXMuZW5jb2RpbmcgPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9sb29rQml0cygxKTsKCiAgICAgICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lcnIgJiYgdGhpcy5lb2xpbmUpIHsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgY29kZTEgPSB0aGlzLl9sb29rQml0cygxMyk7CgogICAgICAgICAgaWYgKGNvZGUxID09PSBjY2l0dEVPRikgewogICAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY29kZTEgPj4gMSA9PT0gMSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fZWF0Qml0cygxMik7CgogICAgICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICAgICAgICB0aGlzLm5leHRMaW5lMkQgPSAhKGNvZGUxICYgMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY29kaW5nTGluZVswXSA+IDApIHsKICAgICAgICB0aGlzLm91dHB1dEJpdHMgPSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zID0gMF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5vdXRwdXRCaXRzID0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1BvcyA9IDFdOwogICAgICB9CgogICAgICB0aGlzLnJvdysrOwogICAgfQoKICAgIGxldCBjOwoKICAgIGlmICh0aGlzLm91dHB1dEJpdHMgPj0gOCkgewogICAgICBjID0gdGhpcy5jb2RpbmdQb3MgJiAxID8gMCA6IDB4ZmY7CiAgICAgIHRoaXMub3V0cHV0Qml0cyAtPSA4OwoKICAgICAgaWYgKHRoaXMub3V0cHV0Qml0cyA9PT0gMCAmJiBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICB0aGlzLmNvZGluZ1BvcysrOwogICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIC0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1BvcyAtIDFdOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBiaXRzID0gODsKICAgICAgYyA9IDA7CgogICAgICBkbyB7CiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm91dHB1dEJpdHMgIT09ICJudW1iZXIiKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ0ludmFsaWQgL0NDSVRURmF4RGVjb2RlIGRhdGEsICJvdXRwdXRCaXRzIiBtdXN0IGJlIGEgbnVtYmVyLicpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMub3V0cHV0Qml0cyA+IGJpdHMpIHsKICAgICAgICAgIGMgPDw9IGJpdHM7CgogICAgICAgICAgaWYgKCEodGhpcy5jb2RpbmdQb3MgJiAxKSkgewogICAgICAgICAgICBjIHw9IDB4ZmYgPj4gOCAtIGJpdHM7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5vdXRwdXRCaXRzIC09IGJpdHM7CiAgICAgICAgICBiaXRzID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYyA8PD0gdGhpcy5vdXRwdXRCaXRzOwoKICAgICAgICAgIGlmICghKHRoaXMuY29kaW5nUG9zICYgMSkpIHsKICAgICAgICAgICAgYyB8PSAweGZmID4+IDggLSB0aGlzLm91dHB1dEJpdHM7CiAgICAgICAgICB9CgogICAgICAgICAgYml0cyAtPSB0aGlzLm91dHB1dEJpdHM7CiAgICAgICAgICB0aGlzLm91dHB1dEJpdHMgPSAwOwoKICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgdGhpcy5jb2RpbmdQb3MrKzsKICAgICAgICAgICAgdGhpcy5vdXRwdXRCaXRzID0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gLSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zIC0gMV07CiAgICAgICAgICB9IGVsc2UgaWYgKGJpdHMgPiAwKSB7CiAgICAgICAgICAgIGMgPDw9IGJpdHM7CiAgICAgICAgICAgIGJpdHMgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoYml0cyk7CiAgICB9CgogICAgaWYgKHRoaXMuYmxhY2spIHsKICAgICAgYyBePSAweGZmOwogICAgfQoKICAgIHJldHVybiBjOwogIH0KCiAgX2FkZFBpeGVscyhhMSwgYmxhY2tQaXhlbHMpIHsKICAgIGNvbnN0IGNvZGluZ0xpbmUgPSB0aGlzLmNvZGluZ0xpbmU7CiAgICBsZXQgY29kaW5nUG9zID0gdGhpcy5jb2RpbmdQb3M7CgogICAgaWYgKGExID4gY29kaW5nTGluZVtjb2RpbmdQb3NdKSB7CiAgICAgIGlmIChhMSA+IHRoaXMuY29sdW1ucykgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgicm93IGlzIHdyb25nIGxlbmd0aCIpOwogICAgICAgIHRoaXMuZXJyID0gdHJ1ZTsKICAgICAgICBhMSA9IHRoaXMuY29sdW1uczsKICAgICAgfQoKICAgICAgaWYgKGNvZGluZ1BvcyAmIDEgXiBibGFja1BpeGVscykgewogICAgICAgICsrY29kaW5nUG9zOwogICAgICB9CgogICAgICBjb2RpbmdMaW5lW2NvZGluZ1Bvc10gPSBhMTsKICAgIH0KCiAgICB0aGlzLmNvZGluZ1BvcyA9IGNvZGluZ1BvczsKICB9CgogIF9hZGRQaXhlbHNOZWcoYTEsIGJsYWNrUGl4ZWxzKSB7CiAgICBjb25zdCBjb2RpbmdMaW5lID0gdGhpcy5jb2RpbmdMaW5lOwogICAgbGV0IGNvZGluZ1BvcyA9IHRoaXMuY29kaW5nUG9zOwoKICAgIGlmIChhMSA+IGNvZGluZ0xpbmVbY29kaW5nUG9zXSkgewogICAgICBpZiAoYTEgPiB0aGlzLmNvbHVtbnMpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoInJvdyBpcyB3cm9uZyBsZW5ndGgiKTsKICAgICAgICB0aGlzLmVyciA9IHRydWU7CiAgICAgICAgYTEgPSB0aGlzLmNvbHVtbnM7CiAgICAgIH0KCiAgICAgIGlmIChjb2RpbmdQb3MgJiAxIF4gYmxhY2tQaXhlbHMpIHsKICAgICAgICArK2NvZGluZ1BvczsKICAgICAgfQoKICAgICAgY29kaW5nTGluZVtjb2RpbmdQb3NdID0gYTE7CiAgICB9IGVsc2UgaWYgKGExIDwgY29kaW5nTGluZVtjb2RpbmdQb3NdKSB7CiAgICAgIGlmIChhMSA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoImludmFsaWQgY29kZSIpOwogICAgICAgIHRoaXMuZXJyID0gdHJ1ZTsKICAgICAgICBhMSA9IDA7CiAgICAgIH0KCiAgICAgIHdoaWxlIChjb2RpbmdQb3MgPiAwICYmIGExIDwgY29kaW5nTGluZVtjb2RpbmdQb3MgLSAxXSkgewogICAgICAgIC0tY29kaW5nUG9zOwogICAgICB9CgogICAgICBjb2RpbmdMaW5lW2NvZGluZ1Bvc10gPSBhMTsKICAgIH0KCiAgICB0aGlzLmNvZGluZ1BvcyA9IGNvZGluZ1BvczsKICB9CgogIF9maW5kVGFibGVDb2RlKHN0YXJ0LCBlbmQsIHRhYmxlLCBsaW1pdCkgewogICAgY29uc3QgbGltaXRWYWx1ZSA9IGxpbWl0IHx8IDA7CgogICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDw9IGVuZDsgKytpKSB7CiAgICAgIGxldCBjb2RlID0gdGhpcy5fbG9va0JpdHMoaSk7CgogICAgICBpZiAoY29kZSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICByZXR1cm4gW3RydWUsIDEsIGZhbHNlXTsKICAgICAgfQoKICAgICAgaWYgKGkgPCBlbmQpIHsKICAgICAgICBjb2RlIDw8PSBlbmQgLSBpOwogICAgICB9CgogICAgICBpZiAoIWxpbWl0VmFsdWUgfHwgY29kZSA+PSBsaW1pdFZhbHVlKSB7CiAgICAgICAgY29uc3QgcCA9IHRhYmxlW2NvZGUgLSBsaW1pdFZhbHVlXTsKCiAgICAgICAgaWYgKHBbMF0gPT09IGkpIHsKICAgICAgICAgIHRoaXMuX2VhdEJpdHMoaSk7CgogICAgICAgICAgcmV0dXJuIFt0cnVlLCBwWzFdLCB0cnVlXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gW2ZhbHNlLCAwLCBmYWxzZV07CiAgfQoKICBfZ2V0VHdvRGltQ29kZSgpIHsKICAgIGxldCBjb2RlID0gMDsKICAgIGxldCBwOwoKICAgIGlmICh0aGlzLmVvYmxvY2spIHsKICAgICAgY29kZSA9IHRoaXMuX2xvb2tCaXRzKDcpOwogICAgICBwID0gdHdvRGltVGFibGVbY29kZV07CgogICAgICBpZiAocCAmJiBwWzBdID4gMCkgewogICAgICAgIHRoaXMuX2VhdEJpdHMocFswXSk7CgogICAgICAgIHJldHVybiBwWzFdOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDEsIDcsIHR3b0RpbVRhYmxlKTsKCiAgICAgIGlmIChyZXN1bHRbMF0gJiYgcmVzdWx0WzJdKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdFsxXTsKICAgICAgfQogICAgfQoKICAgICgwLCBfdXRpbC5pbmZvKSgiQmFkIHR3byBkaW0gY29kZSIpOwogICAgcmV0dXJuIGNjaXR0RU9GOwogIH0KCiAgX2dldFdoaXRlQ29kZSgpIHsKICAgIGxldCBjb2RlID0gMDsKICAgIGxldCBwOwoKICAgIGlmICh0aGlzLmVvYmxvY2spIHsKICAgICAgY29kZSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKCiAgICAgIGlmIChjb2RlID09PSBjY2l0dEVPRikgewogICAgICAgIHJldHVybiAxOwogICAgICB9CgogICAgICBpZiAoY29kZSA+PiA1ID09PSAwKSB7CiAgICAgICAgcCA9IHdoaXRlVGFibGUxW2NvZGVdOwogICAgICB9IGVsc2UgewogICAgICAgIHAgPSB3aGl0ZVRhYmxlMltjb2RlID4+IDNdOwogICAgICB9CgogICAgICBpZiAocFswXSA+IDApIHsKICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICByZXR1cm4gcFsxXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuX2ZpbmRUYWJsZUNvZGUoMSwgOSwgd2hpdGVUYWJsZTIpOwoKICAgICAgaWYgKHJlc3VsdFswXSkgewogICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgIH0KCiAgICAgIHJlc3VsdCA9IHRoaXMuX2ZpbmRUYWJsZUNvZGUoMTEsIDEyLCB3aGl0ZVRhYmxlMSk7CgogICAgICBpZiAocmVzdWx0WzBdKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdFsxXTsKICAgICAgfQogICAgfQoKICAgICgwLCBfdXRpbC5pbmZvKSgiYmFkIHdoaXRlIGNvZGUiKTsKCiAgICB0aGlzLl9lYXRCaXRzKDEpOwoKICAgIHJldHVybiAxOwogIH0KCiAgX2dldEJsYWNrQ29kZSgpIHsKICAgIGxldCBjb2RlLCBwOwoKICAgIGlmICh0aGlzLmVvYmxvY2spIHsKICAgICAgY29kZSA9IHRoaXMuX2xvb2tCaXRzKDEzKTsKCiAgICAgIGlmIChjb2RlID09PSBjY2l0dEVPRikgewogICAgICAgIHJldHVybiAxOwogICAgICB9CgogICAgICBpZiAoY29kZSA+PiA3ID09PSAwKSB7CiAgICAgICAgcCA9IGJsYWNrVGFibGUxW2NvZGVdOwogICAgICB9IGVsc2UgaWYgKGNvZGUgPj4gOSA9PT0gMCAmJiBjb2RlID4+IDcgIT09IDApIHsKICAgICAgICBwID0gYmxhY2tUYWJsZTJbKGNvZGUgPj4gMSkgLSA2NF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcCA9IGJsYWNrVGFibGUzW2NvZGUgPj4gN107CiAgICAgIH0KCiAgICAgIGlmIChwWzBdID4gMCkgewogICAgICAgIHRoaXMuX2VhdEJpdHMocFswXSk7CgogICAgICAgIHJldHVybiBwWzFdOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBsZXQgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgyLCA2LCBibGFja1RhYmxlMyk7CgogICAgICBpZiAocmVzdWx0WzBdKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdFsxXTsKICAgICAgfQoKICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSg3LCAxMiwgYmxhY2tUYWJsZTIsIDY0KTsKCiAgICAgIGlmIChyZXN1bHRbMF0pIHsKICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICB9CgogICAgICByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDEwLCAxMywgYmxhY2tUYWJsZTEpOwoKICAgICAgaWYgKHJlc3VsdFswXSkgewogICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwuaW5mbykoImJhZCBibGFjayBjb2RlIik7CgogICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICByZXR1cm4gMTsKICB9CgogIF9sb29rQml0cyhuKSB7CiAgICBsZXQgYzsKCiAgICB3aGlsZSAodGhpcy5pbnB1dEJpdHMgPCBuKSB7CiAgICAgIGlmICgoYyA9IHRoaXMuc291cmNlLm5leHQoKSkgPT09IC0xKSB7CiAgICAgICAgaWYgKHRoaXMuaW5wdXRCaXRzID09PSAwKSB7CiAgICAgICAgICByZXR1cm4gY2NpdHRFT0Y7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5pbnB1dEJ1ZiA8PCBuIC0gdGhpcy5pbnB1dEJpdHMgJiAweGZmZmYgPj4gMTYgLSBuOwogICAgICB9CgogICAgICB0aGlzLmlucHV0QnVmID0gdGhpcy5pbnB1dEJ1ZiA8PCA4IHwgYzsKICAgICAgdGhpcy5pbnB1dEJpdHMgKz0gODsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5pbnB1dEJ1ZiA+PiB0aGlzLmlucHV0Qml0cyAtIG4gJiAweGZmZmYgPj4gMTYgLSBuOwogIH0KCiAgX2VhdEJpdHMobikgewogICAgaWYgKCh0aGlzLmlucHV0Qml0cyAtPSBuKSA8IDApIHsKICAgICAgdGhpcy5pbnB1dEJpdHMgPSAwOwogICAgfQogIH0KCn0KCmV4cG9ydHMuQ0NJVFRGYXhEZWNvZGVyID0gQ0NJVFRGYXhEZWNvZGVyOwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRmxhdGVTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgpjb25zdCBjb2RlTGVuQ29kZU1hcCA9IG5ldyBJbnQzMkFycmF5KFsxNiwgMTcsIDE4LCAwLCA4LCA3LCA5LCA2LCAxMCwgNSwgMTEsIDQsIDEyLCAzLCAxMywgMiwgMTQsIDEsIDE1XSk7CmNvbnN0IGxlbmd0aERlY29kZSA9IG5ldyBJbnQzMkFycmF5KFsweDAwMDAzLCAweDAwMDA0LCAweDAwMDA1LCAweDAwMDA2LCAweDAwMDA3LCAweDAwMDA4LCAweDAwMDA5LCAweDAwMDBhLCAweDEwMDBiLCAweDEwMDBkLCAweDEwMDBmLCAweDEwMDExLCAweDIwMDEzLCAweDIwMDE3LCAweDIwMDFiLCAweDIwMDFmLCAweDMwMDIzLCAweDMwMDJiLCAweDMwMDMzLCAweDMwMDNiLCAweDQwMDQzLCAweDQwMDUzLCAweDQwMDYzLCAweDQwMDczLCAweDUwMDgzLCAweDUwMGEzLCAweDUwMGMzLCAweDUwMGUzLCAweDAwMTAyLCAweDAwMTAyLCAweDAwMTAyXSk7CmNvbnN0IGRpc3REZWNvZGUgPSBuZXcgSW50MzJBcnJheShbMHgwMDAwMSwgMHgwMDAwMiwgMHgwMDAwMywgMHgwMDAwNCwgMHgxMDAwNSwgMHgxMDAwNywgMHgyMDAwOSwgMHgyMDAwZCwgMHgzMDAxMSwgMHgzMDAxOSwgMHg0MDAyMSwgMHg0MDAzMSwgMHg1MDA0MSwgMHg1MDA2MSwgMHg2MDA4MSwgMHg2MDBjMSwgMHg3MDEwMSwgMHg3MDE4MSwgMHg4MDIwMSwgMHg4MDMwMSwgMHg5MDQwMSwgMHg5MDYwMSwgMHhhMDgwMSwgMHhhMGMwMSwgMHhiMTAwMSwgMHhiMTgwMSwgMHhjMjAwMSwgMHhjMzAwMSwgMHhkNDAwMSwgMHhkNjAwMV0pOwpjb25zdCBmaXhlZExpdENvZGVUYWIgPSBbbmV3IEludDMyQXJyYXkoWzB4NzAxMDAsIDB4ODAwNTAsIDB4ODAwMTAsIDB4ODAxMTgsIDB4NzAxMTAsIDB4ODAwNzAsIDB4ODAwMzAsIDB4OTAwYzAsIDB4NzAxMDgsIDB4ODAwNjAsIDB4ODAwMjAsIDB4OTAwYTAsIDB4ODAwMDAsIDB4ODAwODAsIDB4ODAwNDAsIDB4OTAwZTAsIDB4NzAxMDQsIDB4ODAwNTgsIDB4ODAwMTgsIDB4OTAwOTAsIDB4NzAxMTQsIDB4ODAwNzgsIDB4ODAwMzgsIDB4OTAwZDAsIDB4NzAxMGMsIDB4ODAwNjgsIDB4ODAwMjgsIDB4OTAwYjAsIDB4ODAwMDgsIDB4ODAwODgsIDB4ODAwNDgsIDB4OTAwZjAsIDB4NzAxMDIsIDB4ODAwNTQsIDB4ODAwMTQsIDB4ODAxMWMsIDB4NzAxMTIsIDB4ODAwNzQsIDB4ODAwMzQsIDB4OTAwYzgsIDB4NzAxMGEsIDB4ODAwNjQsIDB4ODAwMjQsIDB4OTAwYTgsIDB4ODAwMDQsIDB4ODAwODQsIDB4ODAwNDQsIDB4OTAwZTgsIDB4NzAxMDYsIDB4ODAwNWMsIDB4ODAwMWMsIDB4OTAwOTgsIDB4NzAxMTYsIDB4ODAwN2MsIDB4ODAwM2MsIDB4OTAwZDgsIDB4NzAxMGUsIDB4ODAwNmMsIDB4ODAwMmMsIDB4OTAwYjgsIDB4ODAwMGMsIDB4ODAwOGMsIDB4ODAwNGMsIDB4OTAwZjgsIDB4NzAxMDEsIDB4ODAwNTIsIDB4ODAwMTIsIDB4ODAxMWEsIDB4NzAxMTEsIDB4ODAwNzIsIDB4ODAwMzIsIDB4OTAwYzQsIDB4NzAxMDksIDB4ODAwNjIsIDB4ODAwMjIsIDB4OTAwYTQsIDB4ODAwMDIsIDB4ODAwODIsIDB4ODAwNDIsIDB4OTAwZTQsIDB4NzAxMDUsIDB4ODAwNWEsIDB4ODAwMWEsIDB4OTAwOTQsIDB4NzAxMTUsIDB4ODAwN2EsIDB4ODAwM2EsIDB4OTAwZDQsIDB4NzAxMGQsIDB4ODAwNmEsIDB4ODAwMmEsIDB4OTAwYjQsIDB4ODAwMGEsIDB4ODAwOGEsIDB4ODAwNGEsIDB4OTAwZjQsIDB4NzAxMDMsIDB4ODAwNTYsIDB4ODAwMTYsIDB4ODAxMWUsIDB4NzAxMTMsIDB4ODAwNzYsIDB4ODAwMzYsIDB4OTAwY2MsIDB4NzAxMGIsIDB4ODAwNjYsIDB4ODAwMjYsIDB4OTAwYWMsIDB4ODAwMDYsIDB4ODAwODYsIDB4ODAwNDYsIDB4OTAwZWMsIDB4NzAxMDcsIDB4ODAwNWUsIDB4ODAwMWUsIDB4OTAwOWMsIDB4NzAxMTcsIDB4ODAwN2UsIDB4ODAwM2UsIDB4OTAwZGMsIDB4NzAxMGYsIDB4ODAwNmUsIDB4ODAwMmUsIDB4OTAwYmMsIDB4ODAwMGUsIDB4ODAwOGUsIDB4ODAwNGUsIDB4OTAwZmMsIDB4NzAxMDAsIDB4ODAwNTEsIDB4ODAwMTEsIDB4ODAxMTksIDB4NzAxMTAsIDB4ODAwNzEsIDB4ODAwMzEsIDB4OTAwYzIsIDB4NzAxMDgsIDB4ODAwNjEsIDB4ODAwMjEsIDB4OTAwYTIsIDB4ODAwMDEsIDB4ODAwODEsIDB4ODAwNDEsIDB4OTAwZTIsIDB4NzAxMDQsIDB4ODAwNTksIDB4ODAwMTksIDB4OTAwOTIsIDB4NzAxMTQsIDB4ODAwNzksIDB4ODAwMzksIDB4OTAwZDIsIDB4NzAxMGMsIDB4ODAwNjksIDB4ODAwMjksIDB4OTAwYjIsIDB4ODAwMDksIDB4ODAwODksIDB4ODAwNDksIDB4OTAwZjIsIDB4NzAxMDIsIDB4ODAwNTUsIDB4ODAwMTUsIDB4ODAxMWQsIDB4NzAxMTIsIDB4ODAwNzUsIDB4ODAwMzUsIDB4OTAwY2EsIDB4NzAxMGEsIDB4ODAwNjUsIDB4ODAwMjUsIDB4OTAwYWEsIDB4ODAwMDUsIDB4ODAwODUsIDB4ODAwNDUsIDB4OTAwZWEsIDB4NzAxMDYsIDB4ODAwNWQsIDB4ODAwMWQsIDB4OTAwOWEsIDB4NzAxMTYsIDB4ODAwN2QsIDB4ODAwM2QsIDB4OTAwZGEsIDB4NzAxMGUsIDB4ODAwNmQsIDB4ODAwMmQsIDB4OTAwYmEsIDB4ODAwMGQsIDB4ODAwOGQsIDB4ODAwNGQsIDB4OTAwZmEsIDB4NzAxMDEsIDB4ODAwNTMsIDB4ODAwMTMsIDB4ODAxMWIsIDB4NzAxMTEsIDB4ODAwNzMsIDB4ODAwMzMsIDB4OTAwYzYsIDB4NzAxMDksIDB4ODAwNjMsIDB4ODAwMjMsIDB4OTAwYTYsIDB4ODAwMDMsIDB4ODAwODMsIDB4ODAwNDMsIDB4OTAwZTYsIDB4NzAxMDUsIDB4ODAwNWIsIDB4ODAwMWIsIDB4OTAwOTYsIDB4NzAxMTUsIDB4ODAwN2IsIDB4ODAwM2IsIDB4OTAwZDYsIDB4NzAxMGQsIDB4ODAwNmIsIDB4ODAwMmIsIDB4OTAwYjYsIDB4ODAwMGIsIDB4ODAwOGIsIDB4ODAwNGIsIDB4OTAwZjYsIDB4NzAxMDMsIDB4ODAwNTcsIDB4ODAwMTcsIDB4ODAxMWYsIDB4NzAxMTMsIDB4ODAwNzcsIDB4ODAwMzcsIDB4OTAwY2UsIDB4NzAxMGIsIDB4ODAwNjcsIDB4ODAwMjcsIDB4OTAwYWUsIDB4ODAwMDcsIDB4ODAwODcsIDB4ODAwNDcsIDB4OTAwZWUsIDB4NzAxMDcsIDB4ODAwNWYsIDB4ODAwMWYsIDB4OTAwOWUsIDB4NzAxMTcsIDB4ODAwN2YsIDB4ODAwM2YsIDB4OTAwZGUsIDB4NzAxMGYsIDB4ODAwNmYsIDB4ODAwMmYsIDB4OTAwYmUsIDB4ODAwMGYsIDB4ODAwOGYsIDB4ODAwNGYsIDB4OTAwZmUsIDB4NzAxMDAsIDB4ODAwNTAsIDB4ODAwMTAsIDB4ODAxMTgsIDB4NzAxMTAsIDB4ODAwNzAsIDB4ODAwMzAsIDB4OTAwYzEsIDB4NzAxMDgsIDB4ODAwNjAsIDB4ODAwMjAsIDB4OTAwYTEsIDB4ODAwMDAsIDB4ODAwODAsIDB4ODAwNDAsIDB4OTAwZTEsIDB4NzAxMDQsIDB4ODAwNTgsIDB4ODAwMTgsIDB4OTAwOTEsIDB4NzAxMTQsIDB4ODAwNzgsIDB4ODAwMzgsIDB4OTAwZDEsIDB4NzAxMGMsIDB4ODAwNjgsIDB4ODAwMjgsIDB4OTAwYjEsIDB4ODAwMDgsIDB4ODAwODgsIDB4ODAwNDgsIDB4OTAwZjEsIDB4NzAxMDIsIDB4ODAwNTQsIDB4ODAwMTQsIDB4ODAxMWMsIDB4NzAxMTIsIDB4ODAwNzQsIDB4ODAwMzQsIDB4OTAwYzksIDB4NzAxMGEsIDB4ODAwNjQsIDB4ODAwMjQsIDB4OTAwYTksIDB4ODAwMDQsIDB4ODAwODQsIDB4ODAwNDQsIDB4OTAwZTksIDB4NzAxMDYsIDB4ODAwNWMsIDB4ODAwMWMsIDB4OTAwOTksIDB4NzAxMTYsIDB4ODAwN2MsIDB4ODAwM2MsIDB4OTAwZDksIDB4NzAxMGUsIDB4ODAwNmMsIDB4ODAwMmMsIDB4OTAwYjksIDB4ODAwMGMsIDB4ODAwOGMsIDB4ODAwNGMsIDB4OTAwZjksIDB4NzAxMDEsIDB4ODAwNTIsIDB4ODAwMTIsIDB4ODAxMWEsIDB4NzAxMTEsIDB4ODAwNzIsIDB4ODAwMzIsIDB4OTAwYzUsIDB4NzAxMDksIDB4ODAwNjIsIDB4ODAwMjIsIDB4OTAwYTUsIDB4ODAwMDIsIDB4ODAwODIsIDB4ODAwNDIsIDB4OTAwZTUsIDB4NzAxMDUsIDB4ODAwNWEsIDB4ODAwMWEsIDB4OTAwOTUsIDB4NzAxMTUsIDB4ODAwN2EsIDB4ODAwM2EsIDB4OTAwZDUsIDB4NzAxMGQsIDB4ODAwNmEsIDB4ODAwMmEsIDB4OTAwYjUsIDB4ODAwMGEsIDB4ODAwOGEsIDB4ODAwNGEsIDB4OTAwZjUsIDB4NzAxMDMsIDB4ODAwNTYsIDB4ODAwMTYsIDB4ODAxMWUsIDB4NzAxMTMsIDB4ODAwNzYsIDB4ODAwMzYsIDB4OTAwY2QsIDB4NzAxMGIsIDB4ODAwNjYsIDB4ODAwMjYsIDB4OTAwYWQsIDB4ODAwMDYsIDB4ODAwODYsIDB4ODAwNDYsIDB4OTAwZWQsIDB4NzAxMDcsIDB4ODAwNWUsIDB4ODAwMWUsIDB4OTAwOWQsIDB4NzAxMTcsIDB4ODAwN2UsIDB4ODAwM2UsIDB4OTAwZGQsIDB4NzAxMGYsIDB4ODAwNmUsIDB4ODAwMmUsIDB4OTAwYmQsIDB4ODAwMGUsIDB4ODAwOGUsIDB4ODAwNGUsIDB4OTAwZmQsIDB4NzAxMDAsIDB4ODAwNTEsIDB4ODAwMTEsIDB4ODAxMTksIDB4NzAxMTAsIDB4ODAwNzEsIDB4ODAwMzEsIDB4OTAwYzMsIDB4NzAxMDgsIDB4ODAwNjEsIDB4ODAwMjEsIDB4OTAwYTMsIDB4ODAwMDEsIDB4ODAwODEsIDB4ODAwNDEsIDB4OTAwZTMsIDB4NzAxMDQsIDB4ODAwNTksIDB4ODAwMTksIDB4OTAwOTMsIDB4NzAxMTQsIDB4ODAwNzksIDB4ODAwMzksIDB4OTAwZDMsIDB4NzAxMGMsIDB4ODAwNjksIDB4ODAwMjksIDB4OTAwYjMsIDB4ODAwMDksIDB4ODAwODksIDB4ODAwNDksIDB4OTAwZjMsIDB4NzAxMDIsIDB4ODAwNTUsIDB4ODAwMTUsIDB4ODAxMWQsIDB4NzAxMTIsIDB4ODAwNzUsIDB4ODAwMzUsIDB4OTAwY2IsIDB4NzAxMGEsIDB4ODAwNjUsIDB4ODAwMjUsIDB4OTAwYWIsIDB4ODAwMDUsIDB4ODAwODUsIDB4ODAwNDUsIDB4OTAwZWIsIDB4NzAxMDYsIDB4ODAwNWQsIDB4ODAwMWQsIDB4OTAwOWIsIDB4NzAxMTYsIDB4ODAwN2QsIDB4ODAwM2QsIDB4OTAwZGIsIDB4NzAxMGUsIDB4ODAwNmQsIDB4ODAwMmQsIDB4OTAwYmIsIDB4ODAwMGQsIDB4ODAwOGQsIDB4ODAwNGQsIDB4OTAwZmIsIDB4NzAxMDEsIDB4ODAwNTMsIDB4ODAwMTMsIDB4ODAxMWIsIDB4NzAxMTEsIDB4ODAwNzMsIDB4ODAwMzMsIDB4OTAwYzcsIDB4NzAxMDksIDB4ODAwNjMsIDB4ODAwMjMsIDB4OTAwYTcsIDB4ODAwMDMsIDB4ODAwODMsIDB4ODAwNDMsIDB4OTAwZTcsIDB4NzAxMDUsIDB4ODAwNWIsIDB4ODAwMWIsIDB4OTAwOTcsIDB4NzAxMTUsIDB4ODAwN2IsIDB4ODAwM2IsIDB4OTAwZDcsIDB4NzAxMGQsIDB4ODAwNmIsIDB4ODAwMmIsIDB4OTAwYjcsIDB4ODAwMGIsIDB4ODAwOGIsIDB4ODAwNGIsIDB4OTAwZjcsIDB4NzAxMDMsIDB4ODAwNTcsIDB4ODAwMTcsIDB4ODAxMWYsIDB4NzAxMTMsIDB4ODAwNzcsIDB4ODAwMzcsIDB4OTAwY2YsIDB4NzAxMGIsIDB4ODAwNjcsIDB4ODAwMjcsIDB4OTAwYWYsIDB4ODAwMDcsIDB4ODAwODcsIDB4ODAwNDcsIDB4OTAwZWYsIDB4NzAxMDcsIDB4ODAwNWYsIDB4ODAwMWYsIDB4OTAwOWYsIDB4NzAxMTcsIDB4ODAwN2YsIDB4ODAwM2YsIDB4OTAwZGYsIDB4NzAxMGYsIDB4ODAwNmYsIDB4ODAwMmYsIDB4OTAwYmYsIDB4ODAwMGYsIDB4ODAwOGYsIDB4ODAwNGYsIDB4OTAwZmZdKSwgOV07CmNvbnN0IGZpeGVkRGlzdENvZGVUYWIgPSBbbmV3IEludDMyQXJyYXkoWzB4NTAwMDAsIDB4NTAwMTAsIDB4NTAwMDgsIDB4NTAwMTgsIDB4NTAwMDQsIDB4NTAwMTQsIDB4NTAwMGMsIDB4NTAwMWMsIDB4NTAwMDIsIDB4NTAwMTIsIDB4NTAwMGEsIDB4NTAwMWEsIDB4NTAwMDYsIDB4NTAwMTYsIDB4NTAwMGUsIDB4MDAwMDAsIDB4NTAwMDEsIDB4NTAwMTEsIDB4NTAwMDksIDB4NTAwMTksIDB4NTAwMDUsIDB4NTAwMTUsIDB4NTAwMGQsIDB4NTAwMWQsIDB4NTAwMDMsIDB4NTAwMTMsIDB4NTAwMGIsIDB4NTAwMWIsIDB4NTAwMDcsIDB4NTAwMTcsIDB4NTAwMGYsIDB4MDAwMDBdKSwgNV07CgpjbGFzcyBGbGF0ZVN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCkgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIGNvbnN0IGNtZiA9IHN0ci5nZXRCeXRlKCk7CiAgICBjb25zdCBmbGcgPSBzdHIuZ2V0Qnl0ZSgpOwoKICAgIGlmIChjbWYgPT09IC0xIHx8IGZsZyA9PT0gLTEpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW06ICR7Y21mfSwgJHtmbGd9YCk7CiAgICB9CgogICAgaWYgKChjbWYgJiAweDBmKSAhPT0gMHgwOCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVua25vd24gY29tcHJlc3Npb24gbWV0aG9kIGluIGZsYXRlIHN0cmVhbTogJHtjbWZ9LCAke2ZsZ31gKTsKICAgIH0KCiAgICBpZiAoKChjbWYgPDwgOCkgKyBmbGcpICUgMzEgIT09IDApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBCYWQgRkNIRUNLIGluIGZsYXRlIHN0cmVhbTogJHtjbWZ9LCAke2ZsZ31gKTsKICAgIH0KCiAgICBpZiAoZmxnICYgMHgyMCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEZESUNUIGJpdCBzZXQgaW4gZmxhdGUgc3RyZWFtOiAke2NtZn0sICR7ZmxnfWApOwogICAgfQoKICAgIHRoaXMuY29kZVNpemUgPSAwOwogICAgdGhpcy5jb2RlQnVmID0gMDsKICB9CgogIGdldEJpdHMoYml0cykgewogICAgY29uc3Qgc3RyID0gdGhpcy5zdHI7CiAgICBsZXQgY29kZVNpemUgPSB0aGlzLmNvZGVTaXplOwogICAgbGV0IGNvZGVCdWYgPSB0aGlzLmNvZGVCdWY7CiAgICBsZXQgYjsKCiAgICB3aGlsZSAoY29kZVNpemUgPCBiaXRzKSB7CiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGVuY29kaW5nIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICBjb2RlQnVmIHw9IGIgPDwgY29kZVNpemU7CiAgICAgIGNvZGVTaXplICs9IDg7CiAgICB9CgogICAgYiA9IGNvZGVCdWYgJiAoMSA8PCBiaXRzKSAtIDE7CiAgICB0aGlzLmNvZGVCdWYgPSBjb2RlQnVmID4+IGJpdHM7CiAgICB0aGlzLmNvZGVTaXplID0gY29kZVNpemUgLT0gYml0czsKICAgIHJldHVybiBiOwogIH0KCiAgZ2V0Q29kZSh0YWJsZSkgewogICAgY29uc3Qgc3RyID0gdGhpcy5zdHI7CiAgICBjb25zdCBjb2RlcyA9IHRhYmxlWzBdOwogICAgY29uc3QgbWF4TGVuID0gdGFibGVbMV07CiAgICBsZXQgY29kZVNpemUgPSB0aGlzLmNvZGVTaXplOwogICAgbGV0IGNvZGVCdWYgPSB0aGlzLmNvZGVCdWY7CiAgICBsZXQgYjsKCiAgICB3aGlsZSAoY29kZVNpemUgPCBtYXhMZW4pIHsKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvZGVCdWYgfD0gYiA8PCBjb2RlU2l6ZTsKICAgICAgY29kZVNpemUgKz0gODsKICAgIH0KCiAgICBjb25zdCBjb2RlID0gY29kZXNbY29kZUJ1ZiAmICgxIDw8IG1heExlbikgLSAxXTsKICAgIGNvbnN0IGNvZGVMZW4gPSBjb2RlID4+IDE2OwogICAgY29uc3QgY29kZVZhbCA9IGNvZGUgJiAweGZmZmY7CgogICAgaWYgKGNvZGVMZW4gPCAxIHx8IGNvZGVTaXplIDwgY29kZUxlbikgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCBlbmNvZGluZyBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgIH0KCiAgICB0aGlzLmNvZGVCdWYgPSBjb2RlQnVmID4+IGNvZGVMZW47CiAgICB0aGlzLmNvZGVTaXplID0gY29kZVNpemUgLSBjb2RlTGVuOwogICAgcmV0dXJuIGNvZGVWYWw7CiAgfQoKICBnZW5lcmF0ZUh1ZmZtYW5UYWJsZShsZW5ndGhzKSB7CiAgICBjb25zdCBuID0gbGVuZ3Rocy5sZW5ndGg7CiAgICBsZXQgbWF4TGVuID0gMDsKICAgIGxldCBpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgaWYgKGxlbmd0aHNbaV0gPiBtYXhMZW4pIHsKICAgICAgICBtYXhMZW4gPSBsZW5ndGhzW2ldOwogICAgICB9CiAgICB9CgogICAgY29uc3Qgc2l6ZSA9IDEgPDwgbWF4TGVuOwogICAgY29uc3QgY29kZXMgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCiAgICBmb3IgKGxldCBsZW4gPSAxLCBjb2RlID0gMCwgc2tpcCA9IDI7IGxlbiA8PSBtYXhMZW47ICsrbGVuLCBjb2RlIDw8PSAxLCBza2lwIDw8PSAxKSB7CiAgICAgIGZvciAobGV0IHZhbCA9IDA7IHZhbCA8IG47ICsrdmFsKSB7CiAgICAgICAgaWYgKGxlbmd0aHNbdmFsXSA9PT0gbGVuKSB7CiAgICAgICAgICBsZXQgY29kZTIgPSAwOwogICAgICAgICAgbGV0IHQgPSBjb2RlOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkgewogICAgICAgICAgICBjb2RlMiA9IGNvZGUyIDw8IDEgfCB0ICYgMTsKICAgICAgICAgICAgdCA+Pj0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGkgPSBjb2RlMjsgaSA8IHNpemU7IGkgKz0gc2tpcCkgewogICAgICAgICAgICBjb2Rlc1tpXSA9IGxlbiA8PCAxNiB8IHZhbDsKICAgICAgICAgIH0KCiAgICAgICAgICArK2NvZGU7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFtjb2RlcywgbWF4TGVuXTsKICB9CgogIHJlYWRCbG9jaygpIHsKICAgIGxldCBidWZmZXIsIGxlbjsKICAgIGNvbnN0IHN0ciA9IHRoaXMuc3RyOwogICAgbGV0IGhkciA9IHRoaXMuZ2V0Qml0cygzKTsKCiAgICBpZiAoaGRyICYgMSkgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICB9CgogICAgaGRyID4+PSAxOwoKICAgIGlmIChoZHIgPT09IDApIHsKICAgICAgbGV0IGI7CgogICAgICBpZiAoKGIgPSBzdHIuZ2V0Qnl0ZSgpKSA9PT0gLTEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCBibG9jayBoZWFkZXIgaW4gZmxhdGUgc3RyZWFtIik7CiAgICAgIH0KCiAgICAgIGxldCBibG9ja0xlbiA9IGI7CgogICAgICBpZiAoKGIgPSBzdHIuZ2V0Qnl0ZSgpKSA9PT0gLTEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCBibG9jayBoZWFkZXIgaW4gZmxhdGUgc3RyZWFtIik7CiAgICAgIH0KCiAgICAgIGJsb2NrTGVuIHw9IGIgPDwgODsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgbGV0IGNoZWNrID0gYjsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgY2hlY2sgfD0gYiA8PCA4OwoKICAgICAgaWYgKGNoZWNrICE9PSAofmJsb2NrTGVuICYgMHhmZmZmKSAmJiAoYmxvY2tMZW4gIT09IDAgfHwgY2hlY2sgIT09IDApKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgdW5jb21wcmVzc2VkIGJsb2NrIGxlbmd0aCBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgdGhpcy5jb2RlQnVmID0gMDsKICAgICAgdGhpcy5jb2RlU2l6ZSA9IDA7CiAgICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoLAogICAgICAgICAgICBlbmQgPSBidWZmZXJMZW5ndGggKyBibG9ja0xlbjsKICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoZW5kKTsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSBlbmQ7CgogICAgICBpZiAoYmxvY2tMZW4gPT09IDApIHsKICAgICAgICBpZiAoc3RyLnBlZWtCeXRlKCkgPT09IC0xKSB7CiAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGJsb2NrID0gc3RyLmdldEJ5dGVzKGJsb2NrTGVuKTsKICAgICAgICBidWZmZXIuc2V0KGJsb2NrLCBidWZmZXJMZW5ndGgpOwoKICAgICAgICBpZiAoYmxvY2subGVuZ3RoIDwgYmxvY2tMZW4pIHsKICAgICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgbGl0Q29kZVRhYmxlOwogICAgbGV0IGRpc3RDb2RlVGFibGU7CgogICAgaWYgKGhkciA9PT0gMSkgewogICAgICBsaXRDb2RlVGFibGUgPSBmaXhlZExpdENvZGVUYWI7CiAgICAgIGRpc3RDb2RlVGFibGUgPSBmaXhlZERpc3RDb2RlVGFiOwogICAgfSBlbHNlIGlmIChoZHIgPT09IDIpIHsKICAgICAgY29uc3QgbnVtTGl0Q29kZXMgPSB0aGlzLmdldEJpdHMoNSkgKyAyNTc7CiAgICAgIGNvbnN0IG51bURpc3RDb2RlcyA9IHRoaXMuZ2V0Qml0cyg1KSArIDE7CiAgICAgIGNvbnN0IG51bUNvZGVMZW5Db2RlcyA9IHRoaXMuZ2V0Qml0cyg0KSArIDQ7CiAgICAgIGNvbnN0IGNvZGVMZW5Db2RlTGVuZ3RocyA9IG5ldyBVaW50OEFycmF5KGNvZGVMZW5Db2RlTWFwLmxlbmd0aCk7CiAgICAgIGxldCBpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bUNvZGVMZW5Db2RlczsgKytpKSB7CiAgICAgICAgY29kZUxlbkNvZGVMZW5ndGhzW2NvZGVMZW5Db2RlTWFwW2ldXSA9IHRoaXMuZ2V0Qml0cygzKTsKICAgICAgfQoKICAgICAgY29uc3QgY29kZUxlbkNvZGVUYWIgPSB0aGlzLmdlbmVyYXRlSHVmZm1hblRhYmxlKGNvZGVMZW5Db2RlTGVuZ3Rocyk7CiAgICAgIGxlbiA9IDA7CiAgICAgIGkgPSAwOwogICAgICBjb25zdCBjb2RlcyA9IG51bUxpdENvZGVzICsgbnVtRGlzdENvZGVzOwogICAgICBjb25zdCBjb2RlTGVuZ3RocyA9IG5ldyBVaW50OEFycmF5KGNvZGVzKTsKICAgICAgbGV0IGJpdHNMZW5ndGgsIGJpdHNPZmZzZXQsIHdoYXQ7CgogICAgICB3aGlsZSAoaSA8IGNvZGVzKSB7CiAgICAgICAgY29uc3QgY29kZSA9IHRoaXMuZ2V0Q29kZShjb2RlTGVuQ29kZVRhYik7CgogICAgICAgIGlmIChjb2RlID09PSAxNikgewogICAgICAgICAgYml0c0xlbmd0aCA9IDI7CiAgICAgICAgICBiaXRzT2Zmc2V0ID0gMzsKICAgICAgICAgIHdoYXQgPSBsZW47CiAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSAxNykgewogICAgICAgICAgYml0c0xlbmd0aCA9IDM7CiAgICAgICAgICBiaXRzT2Zmc2V0ID0gMzsKICAgICAgICAgIHdoYXQgPSBsZW4gPSAwOwogICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gMTgpIHsKICAgICAgICAgIGJpdHNMZW5ndGggPSA3OwogICAgICAgICAgYml0c09mZnNldCA9IDExOwogICAgICAgICAgd2hhdCA9IGxlbiA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvZGVMZW5ndGhzW2krK10gPSBsZW4gPSBjb2RlOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsZXQgcmVwZWF0TGVuZ3RoID0gdGhpcy5nZXRCaXRzKGJpdHNMZW5ndGgpICsgYml0c09mZnNldDsKCiAgICAgICAgd2hpbGUgKHJlcGVhdExlbmd0aC0tID4gMCkgewogICAgICAgICAgY29kZUxlbmd0aHNbaSsrXSA9IHdoYXQ7CiAgICAgICAgfQogICAgICB9CgogICAgICBsaXRDb2RlVGFibGUgPSB0aGlzLmdlbmVyYXRlSHVmZm1hblRhYmxlKGNvZGVMZW5ndGhzLnN1YmFycmF5KDAsIG51bUxpdENvZGVzKSk7CiAgICAgIGRpc3RDb2RlVGFibGUgPSB0aGlzLmdlbmVyYXRlSHVmZm1hblRhYmxlKGNvZGVMZW5ndGhzLnN1YmFycmF5KG51bUxpdENvZGVzLCBjb2RlcykpOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIGJsb2NrIHR5cGUgaW4gZmxhdGUgc3RyZWFtIik7CiAgICB9CgogICAgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICBsZXQgbGltaXQgPSBidWZmZXIgPyBidWZmZXIubGVuZ3RoIDogMDsKICAgIGxldCBwb3MgPSB0aGlzLmJ1ZmZlckxlbmd0aDsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBsZXQgY29kZTEgPSB0aGlzLmdldENvZGUobGl0Q29kZVRhYmxlKTsKCiAgICAgIGlmIChjb2RlMSA8IDI1NikgewogICAgICAgIGlmIChwb3MgKyAxID49IGxpbWl0KSB7CiAgICAgICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihwb3MgKyAxKTsKICAgICAgICAgIGxpbWl0ID0gYnVmZmVyLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGJ1ZmZlcltwb3MrK10gPSBjb2RlMTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGNvZGUxID09PSAyNTYpIHsKICAgICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IHBvczsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvZGUxIC09IDI1NzsKICAgICAgY29kZTEgPSBsZW5ndGhEZWNvZGVbY29kZTFdOwogICAgICBsZXQgY29kZTIgPSBjb2RlMSA+PiAxNjsKCiAgICAgIGlmIChjb2RlMiA+IDApIHsKICAgICAgICBjb2RlMiA9IHRoaXMuZ2V0Qml0cyhjb2RlMik7CiAgICAgIH0KCiAgICAgIGxlbiA9IChjb2RlMSAmIDB4ZmZmZikgKyBjb2RlMjsKICAgICAgY29kZTEgPSB0aGlzLmdldENvZGUoZGlzdENvZGVUYWJsZSk7CiAgICAgIGNvZGUxID0gZGlzdERlY29kZVtjb2RlMV07CiAgICAgIGNvZGUyID0gY29kZTEgPj4gMTY7CgogICAgICBpZiAoY29kZTIgPiAwKSB7CiAgICAgICAgY29kZTIgPSB0aGlzLmdldEJpdHMoY29kZTIpOwogICAgICB9CgogICAgICBjb25zdCBkaXN0ID0gKGNvZGUxICYgMHhmZmZmKSArIGNvZGUyOwoKICAgICAgaWYgKHBvcyArIGxlbiA+PSBsaW1pdCkgewogICAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKHBvcyArIGxlbik7CiAgICAgICAgbGltaXQgPSBidWZmZXIubGVuZ3RoOwogICAgICB9CgogICAgICBmb3IgKGxldCBrID0gMDsgayA8IGxlbjsgKytrLCArK3BvcykgewogICAgICAgIGJ1ZmZlcltwb3NdID0gYnVmZmVyW3BvcyAtIGRpc3RdOwogICAgICB9CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5GbGF0ZVN0cmVhbSA9IEZsYXRlU3RyZWFtOwoKLyoqKi8gfSksCi8qIDI0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuSmJpZzJTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfamJpZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjUpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIEpiaWcyU3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5kaWN0ID0gc3RyZWFtLmRpY3Q7CiAgICB0aGlzLm1heWJlTGVuZ3RoID0gbWF5YmVMZW5ndGg7CiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICB9CgogIGdldCBieXRlcygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYnl0ZXMiLCB0aGlzLnN0cmVhbS5nZXRCeXRlcyh0aGlzLm1heWJlTGVuZ3RoKSk7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7fQoKICByZWFkQmxvY2soKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGpiaWcySW1hZ2UgPSBuZXcgX2piaWcuSmJpZzJJbWFnZSgpOwogICAgY29uc3QgY2h1bmtzID0gW107CgogICAgaWYgKHRoaXMucGFyYW1zIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBnbG9iYWxzU3RyZWFtID0gdGhpcy5wYXJhbXMuZ2V0KCJKQklHMkdsb2JhbHMiKTsKCiAgICAgIGlmIChnbG9iYWxzU3RyZWFtIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBjb25zdCBnbG9iYWxzID0gZ2xvYmFsc1N0cmVhbS5nZXRCeXRlcygpOwogICAgICAgIGNodW5rcy5wdXNoKHsKICAgICAgICAgIGRhdGE6IGdsb2JhbHMsCiAgICAgICAgICBzdGFydDogMCwKICAgICAgICAgIGVuZDogZ2xvYmFscy5sZW5ndGgKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGNodW5rcy5wdXNoKHsKICAgICAgZGF0YTogdGhpcy5ieXRlcywKICAgICAgc3RhcnQ6IDAsCiAgICAgIGVuZDogdGhpcy5ieXRlcy5sZW5ndGgKICAgIH0pOwogICAgY29uc3QgZGF0YSA9IGpiaWcySW1hZ2UucGFyc2VDaHVua3MoY2h1bmtzKTsKICAgIGNvbnN0IGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGFMZW5ndGg7IGkrKykgewogICAgICBkYXRhW2ldIF49IDB4ZmY7CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBkYXRhOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSBkYXRhTGVuZ3RoOwogICAgdGhpcy5lb2YgPSB0cnVlOwogIH0KCn0KCmV4cG9ydHMuSmJpZzJTdHJlYW0gPSBKYmlnMlN0cmVhbTsKCi8qKiovIH0pLAovKiAyNSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkpiaWcySW1hZ2UgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfYXJpdGhtZXRpY19kZWNvZGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyNik7Cgp2YXIgX2NjaXR0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CgpjbGFzcyBKYmlnMkVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSkJJRzIgZXJyb3I6ICR7bXNnfWAsICJKYmlnMkVycm9yIik7CiAgfQoKfQoKY2xhc3MgQ29udGV4dENhY2hlIHsKICBnZXRDb250ZXh0cyhpZCkgewogICAgaWYgKGlkIGluIHRoaXMpIHsKICAgICAgcmV0dXJuIHRoaXNbaWRdOwogICAgfQoKICAgIHJldHVybiB0aGlzW2lkXSA9IG5ldyBJbnQ4QXJyYXkoMSA8PCAxNik7CiAgfQoKfQoKY2xhc3MgRGVjb2RpbmdDb250ZXh0IHsKICBjb25zdHJ1Y3RvcihkYXRhLCBzdGFydCwgZW5kKSB7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5zdGFydCA9IHN0YXJ0OwogICAgdGhpcy5lbmQgPSBlbmQ7CiAgfQoKICBnZXQgZGVjb2RlcigpIHsKICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgX2FyaXRobWV0aWNfZGVjb2Rlci5Bcml0aG1ldGljRGVjb2Rlcih0aGlzLmRhdGEsIHRoaXMuc3RhcnQsIHRoaXMuZW5kKTsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZGVjb2RlciIsIGRlY29kZXIpOwogIH0KCiAgZ2V0IGNvbnRleHRDYWNoZSgpIHsKICAgIGNvbnN0IGNhY2hlID0gbmV3IENvbnRleHRDYWNoZSgpOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjb250ZXh0Q2FjaGUiLCBjYWNoZSk7CiAgfQoKfQoKZnVuY3Rpb24gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsIHByb2NlZHVyZSwgZGVjb2RlcikgewogIGNvbnN0IGNvbnRleHRzID0gY29udGV4dENhY2hlLmdldENvbnRleHRzKHByb2NlZHVyZSk7CiAgbGV0IHByZXYgPSAxOwoKICBmdW5jdGlvbiByZWFkQml0cyhsZW5ndGgpIHsKICAgIGxldCB2ID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICAgIHByZXYgPSBwcmV2IDwgMjU2ID8gcHJldiA8PCAxIHwgYml0IDogKHByZXYgPDwgMSB8IGJpdCkgJiA1MTEgfCAyNTY7CiAgICAgIHYgPSB2IDw8IDEgfCBiaXQ7CiAgICB9CgogICAgcmV0dXJuIHYgPj4+IDA7CiAgfQoKICBjb25zdCBzaWduID0gcmVhZEJpdHMoMSk7CiAgY29uc3QgdmFsdWUgPSByZWFkQml0cygxKSA/IHJlYWRCaXRzKDEpID8gcmVhZEJpdHMoMSkgPyByZWFkQml0cygxKSA/IHJlYWRCaXRzKDEpID8gcmVhZEJpdHMoMzIpICsgNDQzNiA6IHJlYWRCaXRzKDEyKSArIDM0MCA6IHJlYWRCaXRzKDgpICsgODQgOiByZWFkQml0cyg2KSArIDIwIDogcmVhZEJpdHMoNCkgKyA0IDogcmVhZEJpdHMoMik7CgogIGlmIChzaWduID09PSAwKSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfSBlbHNlIGlmICh2YWx1ZSA+IDApIHsKICAgIHJldHVybiAtdmFsdWU7CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKZnVuY3Rpb24gZGVjb2RlSUFJRChjb250ZXh0Q2FjaGUsIGRlY29kZXIsIGNvZGVMZW5ndGgpIHsKICBjb25zdCBjb250ZXh0cyA9IGNvbnRleHRDYWNoZS5nZXRDb250ZXh0cygiSUFJRCIpOwogIGxldCBwcmV2ID0gMTsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2RlTGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICBwcmV2ID0gcHJldiA8PCAxIHwgYml0OwogIH0KCiAgaWYgKGNvZGVMZW5ndGggPCAzMSkgewogICAgcmV0dXJuIHByZXYgJiAoMSA8PCBjb2RlTGVuZ3RoKSAtIDE7CiAgfQoKICByZXR1cm4gcHJldiAmIDB4N2ZmZmZmZmY7Cn0KCmNvbnN0IFNlZ21lbnRUeXBlcyA9IFsiU3ltYm9sRGljdGlvbmFyeSIsIG51bGwsIG51bGwsIG51bGwsICJJbnRlcm1lZGlhdGVUZXh0UmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZVRleHRSZWdpb24iLCAiSW1tZWRpYXRlTG9zc2xlc3NUZXh0UmVnaW9uIiwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgIlBhdHRlcm5EaWN0aW9uYXJ5IiwgbnVsbCwgbnVsbCwgbnVsbCwgIkludGVybWVkaWF0ZUhhbGZ0b25lUmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZUhhbGZ0b25lUmVnaW9uIiwgIkltbWVkaWF0ZUxvc3NsZXNzSGFsZnRvbmVSZWdpb24iLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCAiSW50ZXJtZWRpYXRlR2VuZXJpY1JlZ2lvbiIsIG51bGwsICJJbW1lZGlhdGVHZW5lcmljUmVnaW9uIiwgIkltbWVkaWF0ZUxvc3NsZXNzR2VuZXJpY1JlZ2lvbiIsICJJbnRlcm1lZGlhdGVHZW5lcmljUmVmaW5lbWVudFJlZ2lvbiIsIG51bGwsICJJbW1lZGlhdGVHZW5lcmljUmVmaW5lbWVudFJlZ2lvbiIsICJJbW1lZGlhdGVMb3NzbGVzc0dlbmVyaWNSZWZpbmVtZW50UmVnaW9uIiwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgIlBhZ2VJbmZvcm1hdGlvbiIsICJFbmRPZlBhZ2UiLCAiRW5kT2ZTdHJpcGUiLCAiRW5kT2ZGaWxlIiwgIlByb2ZpbGVzIiwgIlRhYmxlcyIsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsICJFeHRlbnNpb24iXTsKY29uc3QgQ29kaW5nVGVtcGxhdGVzID0gW1t7CiAgeDogLTEsCiAgeTogLTIKfSwgewogIHg6IDAsCiAgeTogLTIKfSwgewogIHg6IDEsCiAgeTogLTIKfSwgewogIHg6IC0yLAogIHk6IC0xCn0sIHsKICB4OiAtMSwKICB5OiAtMQp9LCB7CiAgeDogMCwKICB5OiAtMQp9LCB7CiAgeDogMSwKICB5OiAtMQp9LCB7CiAgeDogMiwKICB5OiAtMQp9LCB7CiAgeDogLTQsCiAgeTogMAp9LCB7CiAgeDogLTMsCiAgeTogMAp9LCB7CiAgeDogLTIsCiAgeTogMAp9LCB7CiAgeDogLTEsCiAgeTogMAp9XSwgW3sKICB4OiAtMSwKICB5OiAtMgp9LCB7CiAgeDogMCwKICB5OiAtMgp9LCB7CiAgeDogMSwKICB5OiAtMgp9LCB7CiAgeDogMiwKICB5OiAtMgp9LCB7CiAgeDogLTIsCiAgeTogLTEKfSwgewogIHg6IC0xLAogIHk6IC0xCn0sIHsKICB4OiAwLAogIHk6IC0xCn0sIHsKICB4OiAxLAogIHk6IC0xCn0sIHsKICB4OiAyLAogIHk6IC0xCn0sIHsKICB4OiAtMywKICB5OiAwCn0sIHsKICB4OiAtMiwKICB5OiAwCn0sIHsKICB4OiAtMSwKICB5OiAwCn1dLCBbewogIHg6IC0xLAogIHk6IC0yCn0sIHsKICB4OiAwLAogIHk6IC0yCn0sIHsKICB4OiAxLAogIHk6IC0yCn0sIHsKICB4OiAtMiwKICB5OiAtMQp9LCB7CiAgeDogLTEsCiAgeTogLTEKfSwgewogIHg6IDAsCiAgeTogLTEKfSwgewogIHg6IDEsCiAgeTogLTEKfSwgewogIHg6IC0yLAogIHk6IDAKfSwgewogIHg6IC0xLAogIHk6IDAKfV0sIFt7CiAgeDogLTMsCiAgeTogLTEKfSwgewogIHg6IC0yLAogIHk6IC0xCn0sIHsKICB4OiAtMSwKICB5OiAtMQp9LCB7CiAgeDogMCwKICB5OiAtMQp9LCB7CiAgeDogMSwKICB5OiAtMQp9LCB7CiAgeDogLTQsCiAgeTogMAp9LCB7CiAgeDogLTMsCiAgeTogMAp9LCB7CiAgeDogLTIsCiAgeTogMAp9LCB7CiAgeDogLTEsCiAgeTogMAp9XV07CmNvbnN0IFJlZmluZW1lbnRUZW1wbGF0ZXMgPSBbewogIGNvZGluZzogW3sKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH1dLAogIHJlZmVyZW5jZTogW3sKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH0sIHsKICAgIHg6IDAsCiAgICB5OiAwCiAgfSwgewogICAgeDogMSwKICAgIHk6IDAKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDEKICB9LCB7CiAgICB4OiAwLAogICAgeTogMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAxCiAgfV0KfSwgewogIGNvZGluZzogW3sKICAgIHg6IC0xLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAwLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAxLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDAKICB9XSwKICByZWZlcmVuY2U6IFt7CiAgICB4OiAwLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDAKICB9LCB7CiAgICB4OiAwLAogICAgeTogMAogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAwCiAgfSwgewogICAgeDogMCwKICAgIHk6IDEKICB9LCB7CiAgICB4OiAxLAogICAgeTogMQogIH1dCn1dOwpjb25zdCBSZXVzZWRDb250ZXh0cyA9IFsweDliMjUsIDB4MDc5NSwgMHgwMGU1LCAweDAxOTVdOwpjb25zdCBSZWZpbmVtZW50UmV1c2VkQ29udGV4dHMgPSBbMHgwMDIwLCAweDAwMDhdOwoKZnVuY3Rpb24gZGVjb2RlQml0bWFwVGVtcGxhdGUwKHdpZHRoLCBoZWlnaHQsIGRlY29kaW5nQ29udGV4dCkgewogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0cyA9IGRlY29kaW5nQ29udGV4dC5jb250ZXh0Q2FjaGUuZ2V0Q29udGV4dHMoIkdCIik7CiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGNvbnRleHRMYWJlbCwgaSwgaiwgcGl4ZWwsIHJvdywgcm93MSwgcm93MjsKICBjb25zdCBPTERfUElYRUxfTUFTSyA9IDB4N2JmNzsKCiAgZm9yIChpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBiaXRtYXBbaV0gPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICByb3cxID0gaSA8IDEgPyByb3cgOiBiaXRtYXBbaSAtIDFdOwogICAgcm93MiA9IGkgPCAyID8gcm93IDogYml0bWFwW2kgLSAyXTsKICAgIGNvbnRleHRMYWJlbCA9IHJvdzJbMF0gPDwgMTMgfCByb3cyWzFdIDw8IDEyIHwgcm93MlsyXSA8PCAxMSB8IHJvdzFbMF0gPDwgNyB8IHJvdzFbMV0gPDwgNiB8IHJvdzFbMl0gPDwgNSB8IHJvdzFbM10gPDwgNDsKCiAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICByb3dbal0gPSBwaXhlbCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgY29udGV4dExhYmVsKTsKICAgICAgY29udGV4dExhYmVsID0gKGNvbnRleHRMYWJlbCAmIE9MRF9QSVhFTF9NQVNLKSA8PCAxIHwgKGogKyAzIDwgd2lkdGggPyByb3cyW2ogKyAzXSA8PCAxMSA6IDApIHwgKGogKyA0IDwgd2lkdGggPyByb3cxW2ogKyA0XSA8PCA0IDogMCkgfCBwaXhlbDsKICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmZ1bmN0aW9uIGRlY29kZUJpdG1hcChtbXIsIHdpZHRoLCBoZWlnaHQsIHRlbXBsYXRlSW5kZXgsIHByZWRpY3Rpb24sIHNraXAsIGF0LCBkZWNvZGluZ0NvbnRleHQpIHsKICBpZiAobW1yKSB7CiAgICBjb25zdCBpbnB1dCA9IG5ldyBSZWFkZXIoZGVjb2RpbmdDb250ZXh0LmRhdGEsIGRlY29kaW5nQ29udGV4dC5zdGFydCwgZGVjb2RpbmdDb250ZXh0LmVuZCk7CiAgICByZXR1cm4gZGVjb2RlTU1SQml0bWFwKGlucHV0LCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7CiAgfQoKICBpZiAodGVtcGxhdGVJbmRleCA9PT0gMCAmJiAhc2tpcCAmJiAhcHJlZGljdGlvbiAmJiBhdC5sZW5ndGggPT09IDQgJiYgYXRbMF0ueCA9PT0gMyAmJiBhdFswXS55ID09PSAtMSAmJiBhdFsxXS54ID09PSAtMyAmJiBhdFsxXS55ID09PSAtMSAmJiBhdFsyXS54ID09PSAyICYmIGF0WzJdLnkgPT09IC0yICYmIGF0WzNdLnggPT09IC0yICYmIGF0WzNdLnkgPT09IC0yKSB7CiAgICByZXR1cm4gZGVjb2RlQml0bWFwVGVtcGxhdGUwKHdpZHRoLCBoZWlnaHQsIGRlY29kaW5nQ29udGV4dCk7CiAgfQoKICBjb25zdCB1c2Vza2lwID0gISFza2lwOwogIGNvbnN0IHRlbXBsYXRlID0gQ29kaW5nVGVtcGxhdGVzW3RlbXBsYXRlSW5kZXhdLmNvbmNhdChhdCk7CiAgdGVtcGxhdGUuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgcmV0dXJuIGEueSAtIGIueSB8fCBhLnggLSBiLng7CiAgfSk7CiAgY29uc3QgdGVtcGxhdGVMZW5ndGggPSB0ZW1wbGF0ZS5sZW5ndGg7CiAgY29uc3QgdGVtcGxhdGVYID0gbmV3IEludDhBcnJheSh0ZW1wbGF0ZUxlbmd0aCk7CiAgY29uc3QgdGVtcGxhdGVZID0gbmV3IEludDhBcnJheSh0ZW1wbGF0ZUxlbmd0aCk7CiAgY29uc3QgY2hhbmdpbmdUZW1wbGF0ZUVudHJpZXMgPSBbXTsKICBsZXQgcmV1c2VNYXNrID0gMCwKICAgICAgbWluWCA9IDAsCiAgICAgIG1heFggPSAwLAogICAgICBtaW5ZID0gMDsKICBsZXQgYywgazsKCiAgZm9yIChrID0gMDsgayA8IHRlbXBsYXRlTGVuZ3RoOyBrKyspIHsKICAgIHRlbXBsYXRlWFtrXSA9IHRlbXBsYXRlW2tdLng7CiAgICB0ZW1wbGF0ZVlba10gPSB0ZW1wbGF0ZVtrXS55OwogICAgbWluWCA9IE1hdGgubWluKG1pblgsIHRlbXBsYXRlW2tdLngpOwogICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHRlbXBsYXRlW2tdLngpOwogICAgbWluWSA9IE1hdGgubWluKG1pblksIHRlbXBsYXRlW2tdLnkpOwoKICAgIGlmIChrIDwgdGVtcGxhdGVMZW5ndGggLSAxICYmIHRlbXBsYXRlW2tdLnkgPT09IHRlbXBsYXRlW2sgKyAxXS55ICYmIHRlbXBsYXRlW2tdLnggPT09IHRlbXBsYXRlW2sgKyAxXS54IC0gMSkgewogICAgICByZXVzZU1hc2sgfD0gMSA8PCB0ZW1wbGF0ZUxlbmd0aCAtIDEgLSBrOwogICAgfSBlbHNlIHsKICAgICAgY2hhbmdpbmdUZW1wbGF0ZUVudHJpZXMucHVzaChrKTsKICAgIH0KICB9CgogIGNvbnN0IGNoYW5naW5nRW50cmllc0xlbmd0aCA9IGNoYW5naW5nVGVtcGxhdGVFbnRyaWVzLmxlbmd0aDsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlWCA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlWSA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICBjb25zdCBjaGFuZ2luZ1RlbXBsYXRlQml0ID0gbmV3IFVpbnQxNkFycmF5KGNoYW5naW5nRW50cmllc0xlbmd0aCk7CgogIGZvciAoYyA9IDA7IGMgPCBjaGFuZ2luZ0VudHJpZXNMZW5ndGg7IGMrKykgewogICAgayA9IGNoYW5naW5nVGVtcGxhdGVFbnRyaWVzW2NdOwogICAgY2hhbmdpbmdUZW1wbGF0ZVhbY10gPSB0ZW1wbGF0ZVtrXS54OwogICAgY2hhbmdpbmdUZW1wbGF0ZVlbY10gPSB0ZW1wbGF0ZVtrXS55OwogICAgY2hhbmdpbmdUZW1wbGF0ZUJpdFtjXSA9IDEgPDwgdGVtcGxhdGVMZW5ndGggLSAxIC0gazsKICB9CgogIGNvbnN0IHNiYl9sZWZ0ID0gLW1pblg7CiAgY29uc3Qgc2JiX3RvcCA9IC1taW5ZOwogIGNvbnN0IHNiYl9yaWdodCA9IHdpZHRoIC0gbWF4WDsKICBjb25zdCBwc2V1ZG9QaXhlbENvbnRleHQgPSBSZXVzZWRDb250ZXh0c1t0ZW1wbGF0ZUluZGV4XTsKICBsZXQgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogIGNvbnN0IGJpdG1hcCA9IFtdOwogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0cyA9IGRlY29kaW5nQ29udGV4dC5jb250ZXh0Q2FjaGUuZ2V0Q29udGV4dHMoIkdCIik7CiAgbGV0IGx0cCA9IDAsCiAgICAgIGosCiAgICAgIGkwLAogICAgICBqMCwKICAgICAgY29udGV4dExhYmVsID0gMCwKICAgICAgYml0LAogICAgICBzaGlmdDsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgaWYgKHByZWRpY3Rpb24pIHsKICAgICAgY29uc3Qgc2x0cCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHNldWRvUGl4ZWxDb250ZXh0KTsKICAgICAgbHRwIF49IHNsdHA7CgogICAgICBpZiAobHRwKSB7CiAgICAgICAgYml0bWFwLnB1c2gocm93KTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQoKICAgIHJvdyA9IG5ldyBVaW50OEFycmF5KHJvdyk7CiAgICBiaXRtYXAucHVzaChyb3cpOwoKICAgIGZvciAoaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CiAgICAgIGlmICh1c2Vza2lwICYmIHNraXBbaV1bal0pIHsKICAgICAgICByb3dbal0gPSAwOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoaiA+PSBzYmJfbGVmdCAmJiBqIDwgc2JiX3JpZ2h0ICYmIGkgPj0gc2JiX3RvcCkgewogICAgICAgIGNvbnRleHRMYWJlbCA9IGNvbnRleHRMYWJlbCA8PCAxICYgcmV1c2VNYXNrOwoKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY2hhbmdpbmdFbnRyaWVzTGVuZ3RoOyBrKyspIHsKICAgICAgICAgIGkwID0gaSArIGNoYW5naW5nVGVtcGxhdGVZW2tdOwogICAgICAgICAgajAgPSBqICsgY2hhbmdpbmdUZW1wbGF0ZVhba107CiAgICAgICAgICBiaXQgPSBiaXRtYXBbaTBdW2owXTsKCiAgICAgICAgICBpZiAoYml0KSB7CiAgICAgICAgICAgIGJpdCA9IGNoYW5naW5nVGVtcGxhdGVCaXRba107CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCB8PSBiaXQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHRMYWJlbCA9IDA7CiAgICAgICAgc2hpZnQgPSB0ZW1wbGF0ZUxlbmd0aCAtIDE7CgogICAgICAgIGZvciAoayA9IDA7IGsgPCB0ZW1wbGF0ZUxlbmd0aDsgaysrLCBzaGlmdC0tKSB7CiAgICAgICAgICBqMCA9IGogKyB0ZW1wbGF0ZVhba107CgogICAgICAgICAgaWYgKGowID49IDAgJiYgajAgPCB3aWR0aCkgewogICAgICAgICAgICBpMCA9IGkgKyB0ZW1wbGF0ZVlba107CgogICAgICAgICAgICBpZiAoaTAgPj0gMCkgewogICAgICAgICAgICAgIGJpdCA9IGJpdG1hcFtpMF1bajBdOwoKICAgICAgICAgICAgICBpZiAoYml0KSB7CiAgICAgICAgICAgICAgICBjb250ZXh0TGFiZWwgfD0gYml0IDw8IHNoaWZ0OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgcGl4ZWwgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CiAgICAgIHJvd1tqXSA9IHBpeGVsOwogICAgfQogIH0KCiAgcmV0dXJuIGJpdG1hcDsKfQoKZnVuY3Rpb24gZGVjb2RlUmVmaW5lbWVudCh3aWR0aCwgaGVpZ2h0LCB0ZW1wbGF0ZUluZGV4LCByZWZlcmVuY2VCaXRtYXAsIG9mZnNldFgsIG9mZnNldFksIHByZWRpY3Rpb24sIGF0LCBkZWNvZGluZ0NvbnRleHQpIHsKICBsZXQgY29kaW5nVGVtcGxhdGUgPSBSZWZpbmVtZW50VGVtcGxhdGVzW3RlbXBsYXRlSW5kZXhdLmNvZGluZzsKCiAgaWYgKHRlbXBsYXRlSW5kZXggPT09IDApIHsKICAgIGNvZGluZ1RlbXBsYXRlID0gY29kaW5nVGVtcGxhdGUuY29uY2F0KFthdFswXV0pOwogIH0KCiAgY29uc3QgY29kaW5nVGVtcGxhdGVMZW5ndGggPSBjb2RpbmdUZW1wbGF0ZS5sZW5ndGg7CiAgY29uc3QgY29kaW5nVGVtcGxhdGVYID0gbmV3IEludDMyQXJyYXkoY29kaW5nVGVtcGxhdGVMZW5ndGgpOwogIGNvbnN0IGNvZGluZ1RlbXBsYXRlWSA9IG5ldyBJbnQzMkFycmF5KGNvZGluZ1RlbXBsYXRlTGVuZ3RoKTsKICBsZXQgazsKCiAgZm9yIChrID0gMDsgayA8IGNvZGluZ1RlbXBsYXRlTGVuZ3RoOyBrKyspIHsKICAgIGNvZGluZ1RlbXBsYXRlWFtrXSA9IGNvZGluZ1RlbXBsYXRlW2tdLng7CiAgICBjb2RpbmdUZW1wbGF0ZVlba10gPSBjb2RpbmdUZW1wbGF0ZVtrXS55OwogIH0KCiAgbGV0IHJlZmVyZW5jZVRlbXBsYXRlID0gUmVmaW5lbWVudFRlbXBsYXRlc1t0ZW1wbGF0ZUluZGV4XS5yZWZlcmVuY2U7CgogIGlmICh0ZW1wbGF0ZUluZGV4ID09PSAwKSB7CiAgICByZWZlcmVuY2VUZW1wbGF0ZSA9IHJlZmVyZW5jZVRlbXBsYXRlLmNvbmNhdChbYXRbMV1dKTsKICB9CgogIGNvbnN0IHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoID0gcmVmZXJlbmNlVGVtcGxhdGUubGVuZ3RoOwogIGNvbnN0IHJlZmVyZW5jZVRlbXBsYXRlWCA9IG5ldyBJbnQzMkFycmF5KHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoKTsKICBjb25zdCByZWZlcmVuY2VUZW1wbGF0ZVkgPSBuZXcgSW50MzJBcnJheShyZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aCk7CgogIGZvciAoayA9IDA7IGsgPCByZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICByZWZlcmVuY2VUZW1wbGF0ZVhba10gPSByZWZlcmVuY2VUZW1wbGF0ZVtrXS54OwogICAgcmVmZXJlbmNlVGVtcGxhdGVZW2tdID0gcmVmZXJlbmNlVGVtcGxhdGVba10ueTsKICB9CgogIGNvbnN0IHJlZmVyZW5jZVdpZHRoID0gcmVmZXJlbmNlQml0bWFwWzBdLmxlbmd0aDsKICBjb25zdCByZWZlcmVuY2VIZWlnaHQgPSByZWZlcmVuY2VCaXRtYXAubGVuZ3RoOwogIGNvbnN0IHBzZXVkb1BpeGVsQ29udGV4dCA9IFJlZmluZW1lbnRSZXVzZWRDb250ZXh0c1t0ZW1wbGF0ZUluZGV4XTsKICBjb25zdCBiaXRtYXAgPSBbXTsKICBjb25zdCBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgY29uc3QgY29udGV4dHMgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlLmdldENvbnRleHRzKCJHUiIpOwogIGxldCBsdHAgPSAwOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICBpZiAocHJlZGljdGlvbikgewogICAgICBjb25zdCBzbHRwID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBwc2V1ZG9QaXhlbENvbnRleHQpOwogICAgICBsdHAgXj0gc2x0cDsKCiAgICAgIGlmIChsdHApIHsKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicHJlZGljdGlvbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICBiaXRtYXAucHVzaChyb3cpOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICBsZXQgaTAsIGowOwogICAgICBsZXQgY29udGV4dExhYmVsID0gMDsKCiAgICAgIGZvciAoayA9IDA7IGsgPCBjb2RpbmdUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICAgICAgaTAgPSBpICsgY29kaW5nVGVtcGxhdGVZW2tdOwogICAgICAgIGowID0gaiArIGNvZGluZ1RlbXBsYXRlWFtrXTsKCiAgICAgICAgaWYgKGkwIDwgMCB8fCBqMCA8IDAgfHwgajAgPj0gd2lkdGgpIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGV4dExhYmVsID0gY29udGV4dExhYmVsIDw8IDEgfCBiaXRtYXBbaTBdW2owXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAoayA9IDA7IGsgPCByZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICAgICAgaTAgPSBpICsgcmVmZXJlbmNlVGVtcGxhdGVZW2tdIC0gb2Zmc2V0WTsKICAgICAgICBqMCA9IGogKyByZWZlcmVuY2VUZW1wbGF0ZVhba10gLSBvZmZzZXRYOwoKICAgICAgICBpZiAoaTAgPCAwIHx8IGkwID49IHJlZmVyZW5jZUhlaWdodCB8fCBqMCA8IDAgfHwgajAgPj0gcmVmZXJlbmNlV2lkdGgpIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGV4dExhYmVsID0gY29udGV4dExhYmVsIDw8IDEgfCByZWZlcmVuY2VCaXRtYXBbaTBdW2owXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHBpeGVsID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICByb3dbal0gPSBwaXhlbDsKICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmZ1bmN0aW9uIGRlY29kZVN5bWJvbERpY3Rpb25hcnkoaHVmZm1hbiwgcmVmaW5lbWVudCwgc3ltYm9scywgbnVtYmVyT2ZOZXdTeW1ib2xzLCBudW1iZXJPZkV4cG9ydGVkU3ltYm9scywgaHVmZm1hblRhYmxlcywgdGVtcGxhdGVJbmRleCwgYXQsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgaHVmZm1hbklucHV0KSB7CiAgaWYgKGh1ZmZtYW4gJiYgcmVmaW5lbWVudCkgewogICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoInN5bWJvbCByZWZpbmVtZW50IHdpdGggSHVmZm1hbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgfQoKICBjb25zdCBuZXdTeW1ib2xzID0gW107CiAgbGV0IGN1cnJlbnRIZWlnaHQgPSAwOwogIGxldCBzeW1ib2xDb2RlTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKHN5bWJvbHMubGVuZ3RoICsgbnVtYmVyT2ZOZXdTeW1ib2xzKTsKICBjb25zdCBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgY29uc3QgY29udGV4dENhY2hlID0gZGVjb2RpbmdDb250ZXh0LmNvbnRleHRDYWNoZTsKICBsZXQgdGFibGVCMSwgc3ltYm9sV2lkdGhzOwoKICBpZiAoaHVmZm1hbikgewogICAgdGFibGVCMSA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgICBzeW1ib2xXaWR0aHMgPSBbXTsKICAgIHN5bWJvbENvZGVMZW5ndGggPSBNYXRoLm1heChzeW1ib2xDb2RlTGVuZ3RoLCAxKTsKICB9CgogIHdoaWxlIChuZXdTeW1ib2xzLmxlbmd0aCA8IG51bWJlck9mTmV3U3ltYm9scykgewogICAgY29uc3QgZGVsdGFIZWlnaHQgPSBodWZmbWFuID8gaHVmZm1hblRhYmxlcy50YWJsZURlbHRhSGVpZ2h0LmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURIIiwgZGVjb2Rlcik7CiAgICBjdXJyZW50SGVpZ2h0ICs9IGRlbHRhSGVpZ2h0OwogICAgbGV0IGN1cnJlbnRXaWR0aCA9IDAsCiAgICAgICAgdG90YWxXaWR0aCA9IDA7CiAgICBjb25zdCBmaXJzdFN5bWJvbCA9IGh1ZmZtYW4gPyBzeW1ib2xXaWR0aHMubGVuZ3RoIDogMDsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBjb25zdCBkZWx0YVdpZHRoID0gaHVmZm1hbiA/IGh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVdpZHRoLmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURXIiwgZGVjb2Rlcik7CgogICAgICBpZiAoZGVsdGFXaWR0aCA9PT0gbnVsbCkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjdXJyZW50V2lkdGggKz0gZGVsdGFXaWR0aDsKICAgICAgdG90YWxXaWR0aCArPSBjdXJyZW50V2lkdGg7CiAgICAgIGxldCBiaXRtYXA7CgogICAgICBpZiAocmVmaW5lbWVudCkgewogICAgICAgIGNvbnN0IG51bWJlck9mSW5zdGFuY2VzID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQUFJIiwgZGVjb2Rlcik7CgogICAgICAgIGlmIChudW1iZXJPZkluc3RhbmNlcyA+IDEpIHsKICAgICAgICAgIGJpdG1hcCA9IGRlY29kZVRleHRSZWdpb24oaHVmZm1hbiwgcmVmaW5lbWVudCwgY3VycmVudFdpZHRoLCBjdXJyZW50SGVpZ2h0LCAwLCBudW1iZXJPZkluc3RhbmNlcywgMSwgc3ltYm9scy5jb25jYXQobmV3U3ltYm9scyksIHN5bWJvbENvZGVMZW5ndGgsIDAsIDAsIDEsIDAsIGh1ZmZtYW5UYWJsZXMsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgMCwgaHVmZm1hbklucHV0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgc3ltYm9sSWQgPSBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgICAgICBjb25zdCByZHggPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRYIiwgZGVjb2Rlcik7CiAgICAgICAgICBjb25zdCByZHkgPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRZIiwgZGVjb2Rlcik7CiAgICAgICAgICBjb25zdCBzeW1ib2wgPSBzeW1ib2xJZCA8IHN5bWJvbHMubGVuZ3RoID8gc3ltYm9sc1tzeW1ib2xJZF0gOiBuZXdTeW1ib2xzW3N5bWJvbElkIC0gc3ltYm9scy5sZW5ndGhdOwogICAgICAgICAgYml0bWFwID0gZGVjb2RlUmVmaW5lbWVudChjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCBzeW1ib2wsIHJkeCwgcmR5LCBmYWxzZSwgcmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQpOwogICAgICAgIH0KCiAgICAgICAgbmV3U3ltYm9scy5wdXNoKGJpdG1hcCk7CiAgICAgIH0gZWxzZSBpZiAoaHVmZm1hbikgewogICAgICAgIHN5bWJvbFdpZHRocy5wdXNoKGN1cnJlbnRXaWR0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYml0bWFwID0gZGVjb2RlQml0bWFwKGZhbHNlLCBjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQsIHRlbXBsYXRlSW5kZXgsIGZhbHNlLCBudWxsLCBhdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgICAgICBuZXdTeW1ib2xzLnB1c2goYml0bWFwKTsKICAgICAgfQogICAgfQoKICAgIGlmIChodWZmbWFuICYmICFyZWZpbmVtZW50KSB7CiAgICAgIGNvbnN0IGJpdG1hcFNpemUgPSBodWZmbWFuVGFibGVzLnRhYmxlQml0bWFwU2l6ZS5kZWNvZGUoaHVmZm1hbklucHV0KTsKICAgICAgaHVmZm1hbklucHV0LmJ5dGVBbGlnbigpOwogICAgICBsZXQgY29sbGVjdGl2ZUJpdG1hcDsKCiAgICAgIGlmIChiaXRtYXBTaXplID09PSAwKSB7CiAgICAgICAgY29sbGVjdGl2ZUJpdG1hcCA9IHJlYWRVbmNvbXByZXNzZWRCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBvcmlnaW5hbEVuZCA9IGh1ZmZtYW5JbnB1dC5lbmQ7CiAgICAgICAgY29uc3QgYml0bWFwRW5kID0gaHVmZm1hbklucHV0LnBvc2l0aW9uICsgYml0bWFwU2l6ZTsKICAgICAgICBodWZmbWFuSW5wdXQuZW5kID0gYml0bWFwRW5kOwogICAgICAgIGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVNTVJCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0LCBmYWxzZSk7CiAgICAgICAgaHVmZm1hbklucHV0LmVuZCA9IG9yaWdpbmFsRW5kOwogICAgICAgIGh1ZmZtYW5JbnB1dC5wb3NpdGlvbiA9IGJpdG1hcEVuZDsKICAgICAgfQoKICAgICAgY29uc3QgbnVtYmVyT2ZTeW1ib2xzRGVjb2RlZCA9IHN5bWJvbFdpZHRocy5sZW5ndGg7CgogICAgICBpZiAoZmlyc3RTeW1ib2wgPT09IG51bWJlck9mU3ltYm9sc0RlY29kZWQgLSAxKSB7CiAgICAgICAgbmV3U3ltYm9scy5wdXNoKGNvbGxlY3RpdmVCaXRtYXApOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCBpLAogICAgICAgICAgICB5LAogICAgICAgICAgICB4TWluID0gMCwKICAgICAgICAgICAgeE1heCwKICAgICAgICAgICAgYml0bWFwV2lkdGgsCiAgICAgICAgICAgIHN5bWJvbEJpdG1hcDsKCiAgICAgICAgZm9yIChpID0gZmlyc3RTeW1ib2w7IGkgPCBudW1iZXJPZlN5bWJvbHNEZWNvZGVkOyBpKyspIHsKICAgICAgICAgIGJpdG1hcFdpZHRoID0gc3ltYm9sV2lkdGhzW2ldOwogICAgICAgICAgeE1heCA9IHhNaW4gKyBiaXRtYXBXaWR0aDsKICAgICAgICAgIHN5bWJvbEJpdG1hcCA9IFtdOwoKICAgICAgICAgIGZvciAoeSA9IDA7IHkgPCBjdXJyZW50SGVpZ2h0OyB5KyspIHsKICAgICAgICAgICAgc3ltYm9sQml0bWFwLnB1c2goY29sbGVjdGl2ZUJpdG1hcFt5XS5zdWJhcnJheSh4TWluLCB4TWF4KSk7CiAgICAgICAgICB9CgogICAgICAgICAgbmV3U3ltYm9scy5wdXNoKHN5bWJvbEJpdG1hcCk7CiAgICAgICAgICB4TWluID0geE1heDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGNvbnN0IGV4cG9ydGVkU3ltYm9scyA9IFtdLAogICAgICAgIGZsYWdzID0gW107CiAgbGV0IGN1cnJlbnRGbGFnID0gZmFsc2UsCiAgICAgIGksCiAgICAgIGlpOwogIGNvbnN0IHRvdGFsU3ltYm9sc0xlbmd0aCA9IHN5bWJvbHMubGVuZ3RoICsgbnVtYmVyT2ZOZXdTeW1ib2xzOwoKICB3aGlsZSAoZmxhZ3MubGVuZ3RoIDwgdG90YWxTeW1ib2xzTGVuZ3RoKSB7CiAgICBsZXQgcnVuTGVuZ3RoID0gaHVmZm1hbiA/IHRhYmxlQjEuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRVgiLCBkZWNvZGVyKTsKCiAgICB3aGlsZSAocnVuTGVuZ3RoLS0pIHsKICAgICAgZmxhZ3MucHVzaChjdXJyZW50RmxhZyk7CiAgICB9CgogICAgY3VycmVudEZsYWcgPSAhY3VycmVudEZsYWc7CiAgfQoKICBmb3IgKGkgPSAwLCBpaSA9IHN5bWJvbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgaWYgKGZsYWdzW2ldKSB7CiAgICAgIGV4cG9ydGVkU3ltYm9scy5wdXNoKHN5bWJvbHNbaV0pOwogICAgfQogIH0KCiAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1iZXJPZk5ld1N5bWJvbHM7IGkrKywgaisrKSB7CiAgICBpZiAoZmxhZ3NbaV0pIHsKICAgICAgZXhwb3J0ZWRTeW1ib2xzLnB1c2gobmV3U3ltYm9sc1tqXSk7CiAgICB9CiAgfQoKICByZXR1cm4gZXhwb3J0ZWRTeW1ib2xzOwp9CgpmdW5jdGlvbiBkZWNvZGVUZXh0UmVnaW9uKGh1ZmZtYW4sIHJlZmluZW1lbnQsIHdpZHRoLCBoZWlnaHQsIGRlZmF1bHRQaXhlbFZhbHVlLCBudW1iZXJPZlN5bWJvbEluc3RhbmNlcywgc3RyaXBTaXplLCBpbnB1dFN5bWJvbHMsIHN5bWJvbENvZGVMZW5ndGgsIHRyYW5zcG9zZWQsIGRzT2Zmc2V0LCByZWZlcmVuY2VDb3JuZXIsIGNvbWJpbmF0aW9uT3BlcmF0b3IsIGh1ZmZtYW5UYWJsZXMsIHJlZmluZW1lbnRUZW1wbGF0ZUluZGV4LCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgbG9nU3RyaXBTaXplLCBodWZmbWFuSW5wdXQpIHsKICBpZiAoaHVmZm1hbiAmJiByZWZpbmVtZW50KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicmVmaW5lbWVudCB3aXRoIEh1ZmZtYW4gaXMgbm90IHN1cHBvcnRlZCIpOwogIH0KCiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGksIHJvdzsKCiAgZm9yIChpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CgogICAgaWYgKGRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgIHJvd1tqXSA9IGRlZmF1bHRQaXhlbFZhbHVlOwogICAgICB9CiAgICB9CgogICAgYml0bWFwLnB1c2gocm93KTsKICB9CgogIGNvbnN0IGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICBjb25zdCBjb250ZXh0Q2FjaGUgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlOwogIGxldCBzdHJpcFQgPSBodWZmbWFuID8gLWh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVQuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiAtZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURUIiwgZGVjb2Rlcik7CiAgbGV0IGZpcnN0UyA9IDA7CiAgaSA9IDA7CgogIHdoaWxlIChpIDwgbnVtYmVyT2ZTeW1ib2xJbnN0YW5jZXMpIHsKICAgIGNvbnN0IGRlbHRhVCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFULmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURUIiwgZGVjb2Rlcik7CiAgICBzdHJpcFQgKz0gZGVsdGFUOwogICAgY29uc3QgZGVsdGFGaXJzdFMgPSBodWZmbWFuID8gaHVmZm1hblRhYmxlcy50YWJsZUZpcnN0Uy5kZWNvZGUoaHVmZm1hbklucHV0KSA6IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFGUyIsIGRlY29kZXIpOwogICAgZmlyc3RTICs9IGRlbHRhRmlyc3RTOwogICAgbGV0IGN1cnJlbnRTID0gZmlyc3RTOwoKICAgIGRvIHsKICAgICAgbGV0IGN1cnJlbnRUID0gMDsKCiAgICAgIGlmIChzdHJpcFNpemUgPiAxKSB7CiAgICAgICAgY3VycmVudFQgPSBodWZmbWFuID8gaHVmZm1hbklucHV0LnJlYWRCaXRzKGxvZ1N0cmlwU2l6ZSkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBSVQiLCBkZWNvZGVyKTsKICAgICAgfQoKICAgICAgY29uc3QgdCA9IHN0cmlwU2l6ZSAqIHN0cmlwVCArIGN1cnJlbnRUOwogICAgICBjb25zdCBzeW1ib2xJZCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnN5bWJvbElEVGFibGUuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgIGNvbnN0IGFwcGx5UmVmaW5lbWVudCA9IHJlZmluZW1lbnQgJiYgKGh1ZmZtYW4gPyBodWZmbWFuSW5wdXQucmVhZEJpdCgpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJJIiwgZGVjb2RlcikpOwogICAgICBsZXQgc3ltYm9sQml0bWFwID0gaW5wdXRTeW1ib2xzW3N5bWJvbElkXTsKICAgICAgbGV0IHN5bWJvbFdpZHRoID0gc3ltYm9sQml0bWFwWzBdLmxlbmd0aDsKICAgICAgbGV0IHN5bWJvbEhlaWdodCA9IHN5bWJvbEJpdG1hcC5sZW5ndGg7CgogICAgICBpZiAoYXBwbHlSZWZpbmVtZW50KSB7CiAgICAgICAgY29uc3QgcmR3ID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJEVyIsIGRlY29kZXIpOwogICAgICAgIGNvbnN0IHJkaCA9IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFSREgiLCBkZWNvZGVyKTsKICAgICAgICBjb25zdCByZHggPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRYIiwgZGVjb2Rlcik7CiAgICAgICAgY29uc3QgcmR5ID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJEWSIsIGRlY29kZXIpOwogICAgICAgIHN5bWJvbFdpZHRoICs9IHJkdzsKICAgICAgICBzeW1ib2xIZWlnaHQgKz0gcmRoOwogICAgICAgIHN5bWJvbEJpdG1hcCA9IGRlY29kZVJlZmluZW1lbnQoc3ltYm9sV2lkdGgsIHN5bWJvbEhlaWdodCwgcmVmaW5lbWVudFRlbXBsYXRlSW5kZXgsIHN5bWJvbEJpdG1hcCwgKHJkdyA+PiAxKSArIHJkeCwgKHJkaCA+PiAxKSArIHJkeSwgZmFsc2UsIHJlZmluZW1lbnRBdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgICAgfQoKICAgICAgY29uc3Qgb2Zmc2V0VCA9IHQgLSAocmVmZXJlbmNlQ29ybmVyICYgMSA/IDAgOiBzeW1ib2xIZWlnaHQgLSAxKTsKICAgICAgY29uc3Qgb2Zmc2V0UyA9IGN1cnJlbnRTIC0gKHJlZmVyZW5jZUNvcm5lciAmIDIgPyBzeW1ib2xXaWR0aCAtIDEgOiAwKTsKICAgICAgbGV0IHMyLCB0Miwgc3ltYm9sUm93OwoKICAgICAgaWYgKHRyYW5zcG9zZWQpIHsKICAgICAgICBmb3IgKHMyID0gMDsgczIgPCBzeW1ib2xIZWlnaHQ7IHMyKyspIHsKICAgICAgICAgIHJvdyA9IGJpdG1hcFtvZmZzZXRTICsgczJdOwoKICAgICAgICAgIGlmICghcm93KSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHN5bWJvbFJvdyA9IHN5bWJvbEJpdG1hcFtzMl07CiAgICAgICAgICBjb25zdCBtYXhXaWR0aCA9IE1hdGgubWluKHdpZHRoIC0gb2Zmc2V0VCwgc3ltYm9sV2lkdGgpOwoKICAgICAgICAgIHN3aXRjaCAoY29tYmluYXRpb25PcGVyYXRvcikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZm9yICh0MiA9IDA7IHQyIDwgbWF4V2lkdGg7IHQyKyspIHsKICAgICAgICAgICAgICAgIHJvd1tvZmZzZXRUICsgdDJdIHw9IHN5bWJvbFJvd1t0Ml07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBmb3IgKHQyID0gMDsgdDIgPCBtYXhXaWR0aDsgdDIrKykgewogICAgICAgICAgICAgICAgcm93W29mZnNldFQgKyB0Ml0gXj0gc3ltYm9sUm93W3QyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcihgb3BlcmF0b3IgJHtjb21iaW5hdGlvbk9wZXJhdG9yfSBpcyBub3Qgc3VwcG9ydGVkYCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50UyArPSBzeW1ib2xIZWlnaHQgLSAxOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodDIgPSAwOyB0MiA8IHN5bWJvbEhlaWdodDsgdDIrKykgewogICAgICAgICAgcm93ID0gYml0bWFwW29mZnNldFQgKyB0Ml07CgogICAgICAgICAgaWYgKCFyb3cpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgc3ltYm9sUm93ID0gc3ltYm9sQml0bWFwW3QyXTsKCiAgICAgICAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGZvciAoczIgPSAwOyBzMiA8IHN5bWJvbFdpZHRoOyBzMisrKSB7CiAgICAgICAgICAgICAgICByb3dbb2Zmc2V0UyArIHMyXSB8PSBzeW1ib2xSb3dbczJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgZm9yIChzMiA9IDA7IHMyIDwgc3ltYm9sV2lkdGg7IHMyKyspIHsKICAgICAgICAgICAgICAgIHJvd1tvZmZzZXRTICsgczJdIF49IHN5bWJvbFJvd1tzMl07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoYG9wZXJhdG9yICR7Y29tYmluYXRpb25PcGVyYXRvcn0gaXMgbm90IHN1cHBvcnRlZGApOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY3VycmVudFMgKz0gc3ltYm9sV2lkdGggLSAxOwogICAgICB9CgogICAgICBpKys7CiAgICAgIGNvbnN0IGRlbHRhUyA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFTLmRlY29kZShodWZmbWFuSW5wdXQpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQURTIiwgZGVjb2Rlcik7CgogICAgICBpZiAoZGVsdGFTID09PSBudWxsKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGN1cnJlbnRTICs9IGRlbHRhUyArIGRzT2Zmc2V0OwogICAgfSB3aGlsZSAodHJ1ZSk7CiAgfQoKICByZXR1cm4gYml0bWFwOwp9CgpmdW5jdGlvbiBkZWNvZGVQYXR0ZXJuRGljdGlvbmFyeShtbXIsIHBhdHRlcm5XaWR0aCwgcGF0dGVybkhlaWdodCwgbWF4UGF0dGVybkluZGV4LCB0ZW1wbGF0ZSwgZGVjb2RpbmdDb250ZXh0KSB7CiAgY29uc3QgYXQgPSBbXTsKCiAgaWYgKCFtbXIpIHsKICAgIGF0LnB1c2goewogICAgICB4OiAtcGF0dGVybldpZHRoLAogICAgICB5OiAwCiAgICB9KTsKCiAgICBpZiAodGVtcGxhdGUgPT09IDApIHsKICAgICAgYXQucHVzaCh7CiAgICAgICAgeDogLTMsCiAgICAgICAgeTogLTEKICAgICAgfSwgewogICAgICAgIHg6IDIsCiAgICAgICAgeTogLTIKICAgICAgfSwgewogICAgICAgIHg6IC0yLAogICAgICAgIHk6IC0yCiAgICAgIH0pOwogICAgfQogIH0KCiAgY29uc3QgY29sbGVjdGl2ZVdpZHRoID0gKG1heFBhdHRlcm5JbmRleCArIDEpICogcGF0dGVybldpZHRoOwogIGNvbnN0IGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVCaXRtYXAobW1yLCBjb2xsZWN0aXZlV2lkdGgsIHBhdHRlcm5IZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgbnVsbCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgY29uc3QgcGF0dGVybnMgPSBbXTsKCiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbWF4UGF0dGVybkluZGV4OyBpKyspIHsKICAgIGNvbnN0IHBhdHRlcm5CaXRtYXAgPSBbXTsKICAgIGNvbnN0IHhNaW4gPSBwYXR0ZXJuV2lkdGggKiBpOwogICAgY29uc3QgeE1heCA9IHhNaW4gKyBwYXR0ZXJuV2lkdGg7CgogICAgZm9yIChsZXQgeSA9IDA7IHkgPCBwYXR0ZXJuSGVpZ2h0OyB5KyspIHsKICAgICAgcGF0dGVybkJpdG1hcC5wdXNoKGNvbGxlY3RpdmVCaXRtYXBbeV0uc3ViYXJyYXkoeE1pbiwgeE1heCkpOwogICAgfQoKICAgIHBhdHRlcm5zLnB1c2gocGF0dGVybkJpdG1hcCk7CiAgfQoKICByZXR1cm4gcGF0dGVybnM7Cn0KCmZ1bmN0aW9uIGRlY29kZUhhbGZ0b25lUmVnaW9uKG1tciwgcGF0dGVybnMsIHRlbXBsYXRlLCByZWdpb25XaWR0aCwgcmVnaW9uSGVpZ2h0LCBkZWZhdWx0UGl4ZWxWYWx1ZSwgZW5hYmxlU2tpcCwgY29tYmluYXRpb25PcGVyYXRvciwgZ3JpZFdpZHRoLCBncmlkSGVpZ2h0LCBncmlkT2Zmc2V0WCwgZ3JpZE9mZnNldFksIGdyaWRWZWN0b3JYLCBncmlkVmVjdG9yWSwgZGVjb2RpbmdDb250ZXh0KSB7CiAgY29uc3Qgc2tpcCA9IG51bGw7CgogIGlmIChlbmFibGVTa2lwKSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigic2tpcCBpcyBub3Qgc3VwcG9ydGVkIik7CiAgfQoKICBpZiAoY29tYmluYXRpb25PcGVyYXRvciAhPT0gMCkgewogICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoYG9wZXJhdG9yICIke2NvbWJpbmF0aW9uT3BlcmF0b3J9IiBpcyBub3Qgc3VwcG9ydGVkIGluIGhhbGZ0b25lIHJlZ2lvbmApOwogIH0KCiAgY29uc3QgcmVnaW9uQml0bWFwID0gW107CiAgbGV0IGksIGosIHJvdzsKCiAgZm9yIChpID0gMDsgaSA8IHJlZ2lvbkhlaWdodDsgaSsrKSB7CiAgICByb3cgPSBuZXcgVWludDhBcnJheShyZWdpb25XaWR0aCk7CgogICAgaWYgKGRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCByZWdpb25XaWR0aDsgaisrKSB7CiAgICAgICAgcm93W2pdID0gZGVmYXVsdFBpeGVsVmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICByZWdpb25CaXRtYXAucHVzaChyb3cpOwogIH0KCiAgY29uc3QgbnVtYmVyT2ZQYXR0ZXJucyA9IHBhdHRlcm5zLmxlbmd0aDsKICBjb25zdCBwYXR0ZXJuMCA9IHBhdHRlcm5zWzBdOwogIGNvbnN0IHBhdHRlcm5XaWR0aCA9IHBhdHRlcm4wWzBdLmxlbmd0aCwKICAgICAgICBwYXR0ZXJuSGVpZ2h0ID0gcGF0dGVybjAubGVuZ3RoOwogIGNvbnN0IGJpdHNQZXJWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5sb2cyKShudW1iZXJPZlBhdHRlcm5zKTsKICBjb25zdCBhdCA9IFtdOwoKICBpZiAoIW1tcikgewogICAgYXQucHVzaCh7CiAgICAgIHg6IHRlbXBsYXRlIDw9IDEgPyAzIDogMiwKICAgICAgeTogLTEKICAgIH0pOwoKICAgIGlmICh0ZW1wbGF0ZSA9PT0gMCkgewogICAgICBhdC5wdXNoKHsKICAgICAgICB4OiAtMywKICAgICAgICB5OiAtMQogICAgICB9LCB7CiAgICAgICAgeDogMiwKICAgICAgICB5OiAtMgogICAgICB9LCB7CiAgICAgICAgeDogLTIsCiAgICAgICAgeTogLTIKICAgICAgfSk7CiAgICB9CiAgfQoKICBjb25zdCBncmF5U2NhbGVCaXRQbGFuZXMgPSBbXTsKICBsZXQgbW1ySW5wdXQsIGJpdG1hcDsKCiAgaWYgKG1tcikgewogICAgbW1ySW5wdXQgPSBuZXcgUmVhZGVyKGRlY29kaW5nQ29udGV4dC5kYXRhLCBkZWNvZGluZ0NvbnRleHQuc3RhcnQsIGRlY29kaW5nQ29udGV4dC5lbmQpOwogIH0KCiAgZm9yIChpID0gYml0c1BlclZhbHVlIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgIGlmIChtbXIpIHsKICAgICAgYml0bWFwID0gZGVjb2RlTU1SQml0bWFwKG1tcklucHV0LCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIHRydWUpOwogICAgfSBlbHNlIHsKICAgICAgYml0bWFwID0gZGVjb2RlQml0bWFwKGZhbHNlLCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgc2tpcCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgICB9CgogICAgZ3JheVNjYWxlQml0UGxhbmVzW2ldID0gYml0bWFwOwogIH0KCiAgbGV0IG1nLCBuZywgYml0LCBwYXR0ZXJuSW5kZXgsIHBhdHRlcm5CaXRtYXAsIHgsIHksIHBhdHRlcm5Sb3csIHJlZ2lvblJvdzsKCiAgZm9yIChtZyA9IDA7IG1nIDwgZ3JpZEhlaWdodDsgbWcrKykgewogICAgZm9yIChuZyA9IDA7IG5nIDwgZ3JpZFdpZHRoOyBuZysrKSB7CiAgICAgIGJpdCA9IDA7CiAgICAgIHBhdHRlcm5JbmRleCA9IDA7CgogICAgICBmb3IgKGogPSBiaXRzUGVyVmFsdWUgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgIGJpdCBePSBncmF5U2NhbGVCaXRQbGFuZXNbal1bbWddW25nXTsKICAgICAgICBwYXR0ZXJuSW5kZXggfD0gYml0IDw8IGo7CiAgICAgIH0KCiAgICAgIHBhdHRlcm5CaXRtYXAgPSBwYXR0ZXJuc1twYXR0ZXJuSW5kZXhdOwogICAgICB4ID0gZ3JpZE9mZnNldFggKyBtZyAqIGdyaWRWZWN0b3JZICsgbmcgKiBncmlkVmVjdG9yWCA+PiA4OwogICAgICB5ID0gZ3JpZE9mZnNldFkgKyBtZyAqIGdyaWRWZWN0b3JYIC0gbmcgKiBncmlkVmVjdG9yWSA+PiA4OwoKICAgICAgaWYgKHggPj0gMCAmJiB4ICsgcGF0dGVybldpZHRoIDw9IHJlZ2lvbldpZHRoICYmIHkgPj0gMCAmJiB5ICsgcGF0dGVybkhlaWdodCA8PSByZWdpb25IZWlnaHQpIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGF0dGVybkhlaWdodDsgaSsrKSB7CiAgICAgICAgICByZWdpb25Sb3cgPSByZWdpb25CaXRtYXBbeSArIGldOwogICAgICAgICAgcGF0dGVyblJvdyA9IHBhdHRlcm5CaXRtYXBbaV07CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHBhdHRlcm5XaWR0aDsgaisrKSB7CiAgICAgICAgICAgIHJlZ2lvblJvd1t4ICsgal0gfD0gcGF0dGVyblJvd1tqXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHJlZ2lvblgsIHJlZ2lvblk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXR0ZXJuSGVpZ2h0OyBpKyspIHsKICAgICAgICAgIHJlZ2lvblkgPSB5ICsgaTsKCiAgICAgICAgICBpZiAocmVnaW9uWSA8IDAgfHwgcmVnaW9uWSA+PSByZWdpb25IZWlnaHQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmVnaW9uUm93ID0gcmVnaW9uQml0bWFwW3JlZ2lvblldOwogICAgICAgICAgcGF0dGVyblJvdyA9IHBhdHRlcm5CaXRtYXBbaV07CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHBhdHRlcm5XaWR0aDsgaisrKSB7CiAgICAgICAgICAgIHJlZ2lvblggPSB4ICsgajsKCiAgICAgICAgICAgIGlmIChyZWdpb25YID49IDAgJiYgcmVnaW9uWCA8IHJlZ2lvbldpZHRoKSB7CiAgICAgICAgICAgICAgcmVnaW9uUm93W3JlZ2lvblhdIHw9IHBhdHRlcm5Sb3dbal07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiByZWdpb25CaXRtYXA7Cn0KCmZ1bmN0aW9uIHJlYWRTZWdtZW50SGVhZGVyKGRhdGEsIHN0YXJ0KSB7CiAgY29uc3Qgc2VnbWVudEhlYWRlciA9IHt9OwogIHNlZ21lbnRIZWFkZXIubnVtYmVyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0KTsKICBjb25zdCBmbGFncyA9IGRhdGFbc3RhcnQgKyA0XTsKICBjb25zdCBzZWdtZW50VHlwZSA9IGZsYWdzICYgMHgzZjsKCiAgaWYgKCFTZWdtZW50VHlwZXNbc2VnbWVudFR5cGVdKSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBzZWdtZW50IHR5cGU6ICIgKyBzZWdtZW50VHlwZSk7CiAgfQoKICBzZWdtZW50SGVhZGVyLnR5cGUgPSBzZWdtZW50VHlwZTsKICBzZWdtZW50SGVhZGVyLnR5cGVOYW1lID0gU2VnbWVudFR5cGVzW3NlZ21lbnRUeXBlXTsKICBzZWdtZW50SGVhZGVyLmRlZmVycmVkTm9uUmV0YWluID0gISEoZmxhZ3MgJiAweDgwKTsKICBjb25zdCBwYWdlQXNzb2NpYXRpb25GaWVsZFNpemUgPSAhIShmbGFncyAmIDB4NDApOwogIGNvbnN0IHJlZmVycmVkRmxhZ3MgPSBkYXRhW3N0YXJ0ICsgNV07CiAgbGV0IHJlZmVycmVkVG9Db3VudCA9IHJlZmVycmVkRmxhZ3MgPj4gNSAmIDc7CiAgY29uc3QgcmV0YWluQml0cyA9IFtyZWZlcnJlZEZsYWdzICYgMzFdOwogIGxldCBwb3NpdGlvbiA9IHN0YXJ0ICsgNjsKCiAgaWYgKHJlZmVycmVkRmxhZ3MgPT09IDcpIHsKICAgIHJlZmVycmVkVG9Db3VudCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiAtIDEpICYgMHgxZmZmZmZmZjsKICAgIHBvc2l0aW9uICs9IDM7CiAgICBsZXQgYnl0ZXMgPSByZWZlcnJlZFRvQ291bnQgKyA3ID4+IDM7CiAgICByZXRhaW5CaXRzWzBdID0gZGF0YVtwb3NpdGlvbisrXTsKCiAgICB3aGlsZSAoLS1ieXRlcyA+IDApIHsKICAgICAgcmV0YWluQml0cy5wdXNoKGRhdGFbcG9zaXRpb24rK10pOwogICAgfQogIH0gZWxzZSBpZiAocmVmZXJyZWRGbGFncyA9PT0gNSB8fCByZWZlcnJlZEZsYWdzID09PSA2KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCByZWZlcnJlZC10byBmbGFncyIpOwogIH0KCiAgc2VnbWVudEhlYWRlci5yZXRhaW5CaXRzID0gcmV0YWluQml0czsKICBsZXQgcmVmZXJyZWRUb1NlZ21lbnROdW1iZXJTaXplID0gNDsKCiAgaWYgKHNlZ21lbnRIZWFkZXIubnVtYmVyIDw9IDI1NikgewogICAgcmVmZXJyZWRUb1NlZ21lbnROdW1iZXJTaXplID0gMTsKICB9IGVsc2UgaWYgKHNlZ21lbnRIZWFkZXIubnVtYmVyIDw9IDY1NTM2KSB7CiAgICByZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPSAyOwogIH0KCiAgY29uc3QgcmVmZXJyZWRUbyA9IFtdOwogIGxldCBpLCBpaTsKCiAgZm9yIChpID0gMDsgaSA8IHJlZmVycmVkVG9Db3VudDsgaSsrKSB7CiAgICBsZXQgbnVtYmVyOwoKICAgIGlmIChyZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPT09IDEpIHsKICAgICAgbnVtYmVyID0gZGF0YVtwb3NpdGlvbl07CiAgICB9IGVsc2UgaWYgKHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZSA9PT0gMikgewogICAgICBudW1iZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgfSBlbHNlIHsKICAgICAgbnVtYmVyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgIH0KCiAgICByZWZlcnJlZFRvLnB1c2gobnVtYmVyKTsKICAgIHBvc2l0aW9uICs9IHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZTsKICB9CgogIHNlZ21lbnRIZWFkZXIucmVmZXJyZWRUbyA9IHJlZmVycmVkVG87CgogIGlmICghcGFnZUFzc29jaWF0aW9uRmllbGRTaXplKSB7CiAgICBzZWdtZW50SGVhZGVyLnBhZ2VBc3NvY2lhdGlvbiA9IGRhdGFbcG9zaXRpb24rK107CiAgfSBlbHNlIHsKICAgIHNlZ21lbnRIZWFkZXIucGFnZUFzc29jaWF0aW9uID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgIHBvc2l0aW9uICs9IDQ7CiAgfQoKICBzZWdtZW50SGVhZGVyLmxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgcG9zaXRpb24gKz0gNDsKCiAgaWYgKHNlZ21lbnRIZWFkZXIubGVuZ3RoID09PSAweGZmZmZmZmZmKSB7CiAgICBpZiAoc2VnbWVudFR5cGUgPT09IDM4KSB7CiAgICAgIGNvbnN0IGdlbmVyaWNSZWdpb25JbmZvID0gcmVhZFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbihkYXRhLCBwb3NpdGlvbik7CiAgICAgIGNvbnN0IGdlbmVyaWNSZWdpb25TZWdtZW50RmxhZ3MgPSBkYXRhW3Bvc2l0aW9uICsgUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uRmllbGRMZW5ndGhdOwogICAgICBjb25zdCBnZW5lcmljUmVnaW9uTW1yID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDEpOwogICAgICBjb25zdCBzZWFyY2hQYXR0ZXJuTGVuZ3RoID0gNjsKICAgICAgY29uc3Qgc2VhcmNoUGF0dGVybiA9IG5ldyBVaW50OEFycmF5KHNlYXJjaFBhdHRlcm5MZW5ndGgpOwoKICAgICAgaWYgKCFnZW5lcmljUmVnaW9uTW1yKSB7CiAgICAgICAgc2VhcmNoUGF0dGVyblswXSA9IDB4ZmY7CiAgICAgICAgc2VhcmNoUGF0dGVyblsxXSA9IDB4YWM7CiAgICAgIH0KCiAgICAgIHNlYXJjaFBhdHRlcm5bMl0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4+IDI0ICYgMHhmZjsKICAgICAgc2VhcmNoUGF0dGVyblszXSA9IGdlbmVyaWNSZWdpb25JbmZvLmhlaWdodCA+PiAxNiAmIDB4ZmY7CiAgICAgIHNlYXJjaFBhdHRlcm5bNF0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4gOCAmIDB4ZmY7CiAgICAgIHNlYXJjaFBhdHRlcm5bNV0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgJiAweGZmOwoKICAgICAgZm9yIChpID0gcG9zaXRpb24sIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgbGV0IGogPSAwOwoKICAgICAgICB3aGlsZSAoaiA8IHNlYXJjaFBhdHRlcm5MZW5ndGggJiYgc2VhcmNoUGF0dGVybltqXSA9PT0gZGF0YVtpICsgal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGlmIChqID09PSBzZWFyY2hQYXR0ZXJuTGVuZ3RoKSB7CiAgICAgICAgICBzZWdtZW50SGVhZGVyLmxlbmd0aCA9IGkgKyBzZWFyY2hQYXR0ZXJuTGVuZ3RoOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoc2VnbWVudEhlYWRlci5sZW5ndGggPT09IDB4ZmZmZmZmZmYpIHsKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigic2VnbWVudCBlbmQgd2FzIG5vdCBmb3VuZCIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCB1bmtub3duIHNlZ21lbnQgbGVuZ3RoIik7CiAgICB9CiAgfQoKICBzZWdtZW50SGVhZGVyLmhlYWRlckVuZCA9IHBvc2l0aW9uOwogIHJldHVybiBzZWdtZW50SGVhZGVyOwp9CgpmdW5jdGlvbiByZWFkU2VnbWVudHMoaGVhZGVyLCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgY29uc3Qgc2VnbWVudHMgPSBbXTsKICBsZXQgcG9zaXRpb24gPSBzdGFydDsKCiAgd2hpbGUgKHBvc2l0aW9uIDwgZW5kKSB7CiAgICBjb25zdCBzZWdtZW50SGVhZGVyID0gcmVhZFNlZ21lbnRIZWFkZXIoZGF0YSwgcG9zaXRpb24pOwogICAgcG9zaXRpb24gPSBzZWdtZW50SGVhZGVyLmhlYWRlckVuZDsKICAgIGNvbnN0IHNlZ21lbnQgPSB7CiAgICAgIGhlYWRlcjogc2VnbWVudEhlYWRlciwKICAgICAgZGF0YQogICAgfTsKCiAgICBpZiAoIWhlYWRlci5yYW5kb21BY2Nlc3MpIHsKICAgICAgc2VnbWVudC5zdGFydCA9IHBvc2l0aW9uOwogICAgICBwb3NpdGlvbiArPSBzZWdtZW50SGVhZGVyLmxlbmd0aDsKICAgICAgc2VnbWVudC5lbmQgPSBwb3NpdGlvbjsKICAgIH0KCiAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpOwoKICAgIGlmIChzZWdtZW50SGVhZGVyLnR5cGUgPT09IDUxKSB7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgaWYgKGhlYWRlci5yYW5kb21BY2Nlc3MpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHNlZ21lbnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgc2VnbWVudHNbaV0uc3RhcnQgPSBwb3NpdGlvbjsKICAgICAgcG9zaXRpb24gKz0gc2VnbWVudHNbaV0uaGVhZGVyLmxlbmd0aDsKICAgICAgc2VnbWVudHNbaV0uZW5kID0gcG9zaXRpb247CiAgICB9CiAgfQoKICByZXR1cm4gc2VnbWVudHM7Cn0KCmZ1bmN0aW9uIHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgc3RhcnQpIHsKICByZXR1cm4gewogICAgd2lkdGg6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCksCiAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCArIDQpLAogICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0ICsgOCksCiAgICB5OiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyAxMiksCiAgICBjb21iaW5hdGlvbk9wZXJhdG9yOiBkYXRhW3N0YXJ0ICsgMTZdICYgNwogIH07Cn0KCmNvbnN0IFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbkZpZWxkTGVuZ3RoID0gMTc7CgpmdW5jdGlvbiBwcm9jZXNzU2VnbWVudChzZWdtZW50LCB2aXNpdG9yKSB7CiAgY29uc3QgaGVhZGVyID0gc2VnbWVudC5oZWFkZXI7CiAgY29uc3QgZGF0YSA9IHNlZ21lbnQuZGF0YSwKICAgICAgICBlbmQgPSBzZWdtZW50LmVuZDsKICBsZXQgcG9zaXRpb24gPSBzZWdtZW50LnN0YXJ0OwogIGxldCBhcmdzLCBhdCwgaSwgYXRMZW5ndGg7CgogIHN3aXRjaCAoaGVhZGVyLnR5cGUpIHsKICAgIGNhc2UgMDoKICAgICAgY29uc3QgZGljdGlvbmFyeSA9IHt9OwogICAgICBjb25zdCBkaWN0aW9uYXJ5RmxhZ3MgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICBkaWN0aW9uYXJ5Lmh1ZmZtYW4gPSAhIShkaWN0aW9uYXJ5RmxhZ3MgJiAxKTsKICAgICAgZGljdGlvbmFyeS5yZWZpbmVtZW50ID0gISEoZGljdGlvbmFyeUZsYWdzICYgMik7CiAgICAgIGRpY3Rpb25hcnkuaHVmZm1hbkRIU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gMiAmIDM7CiAgICAgIGRpY3Rpb25hcnkuaHVmZm1hbkRXU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gNCAmIDM7CiAgICAgIGRpY3Rpb25hcnkuYml0bWFwU2l6ZVNlbGVjdG9yID0gZGljdGlvbmFyeUZsYWdzID4+IDYgJiAxOwogICAgICBkaWN0aW9uYXJ5LmFnZ3JlZ2F0aW9uSW5zdGFuY2VzU2VsZWN0b3IgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gNyAmIDE7CiAgICAgIGRpY3Rpb25hcnkuYml0bWFwQ29kaW5nQ29udGV4dFVzZWQgPSAhIShkaWN0aW9uYXJ5RmxhZ3MgJiAyNTYpOwogICAgICBkaWN0aW9uYXJ5LmJpdG1hcENvZGluZ0NvbnRleHRSZXRhaW5lZCA9ICEhKGRpY3Rpb25hcnlGbGFncyAmIDUxMik7CiAgICAgIGRpY3Rpb25hcnkudGVtcGxhdGUgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gMTAgJiAzOwogICAgICBkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSA9IGRpY3Rpb25hcnlGbGFncyA+PiAxMiAmIDE7CiAgICAgIHBvc2l0aW9uICs9IDI7CgogICAgICBpZiAoIWRpY3Rpb25hcnkuaHVmZm1hbikgewogICAgICAgIGF0TGVuZ3RoID0gZGljdGlvbmFyeS50ZW1wbGF0ZSA9PT0gMCA/IDQgOiAxOwogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdExlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgZGljdGlvbmFyeS5hdCA9IGF0OwogICAgICB9CgogICAgICBpZiAoZGljdGlvbmFyeS5yZWZpbmVtZW50ICYmICFkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSkgewogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICAgIGF0LnB1c2goewogICAgICAgICAgICB4OiAoMCwgX2NvcmVfdXRpbHMucmVhZEludDgpKGRhdGEsIHBvc2l0aW9uKSwKICAgICAgICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiArIDEpCiAgICAgICAgICB9KTsKICAgICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgfQoKICAgICAgICBkaWN0aW9uYXJ5LnJlZmluZW1lbnRBdCA9IGF0OwogICAgICB9CgogICAgICBkaWN0aW9uYXJ5Lm51bWJlck9mRXhwb3J0ZWRTeW1ib2xzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgZGljdGlvbmFyeS5udW1iZXJPZk5ld1N5bWJvbHMgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSA0OwogICAgICBhcmdzID0gW2RpY3Rpb25hcnksIGhlYWRlci5udW1iZXIsIGhlYWRlci5yZWZlcnJlZFRvLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA2OgogICAgY2FzZSA3OgogICAgICBjb25zdCB0ZXh0UmVnaW9uID0ge307CiAgICAgIHRleHRSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aDsKICAgICAgY29uc3QgdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgIHRleHRSZWdpb24uaHVmZm1hbiA9ICEhKHRleHRSZWdpb25TZWdtZW50RmxhZ3MgJiAxKTsKICAgICAgdGV4dFJlZ2lvbi5yZWZpbmVtZW50ID0gISEodGV4dFJlZ2lvblNlZ21lbnRGbGFncyAmIDIpOwogICAgICB0ZXh0UmVnaW9uLmxvZ1N0cmlwU2l6ZSA9IHRleHRSZWdpb25TZWdtZW50RmxhZ3MgPj4gMiAmIDM7CiAgICAgIHRleHRSZWdpb24uc3RyaXBTaXplID0gMSA8PCB0ZXh0UmVnaW9uLmxvZ1N0cmlwU2l6ZTsKICAgICAgdGV4dFJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIgPSB0ZXh0UmVnaW9uU2VnbWVudEZsYWdzID4+IDQgJiAzOwogICAgICB0ZXh0UmVnaW9uLnRyYW5zcG9zZWQgPSAhISh0ZXh0UmVnaW9uU2VnbWVudEZsYWdzICYgNjQpOwogICAgICB0ZXh0UmVnaW9uLmNvbWJpbmF0aW9uT3BlcmF0b3IgPSB0ZXh0UmVnaW9uU2VnbWVudEZsYWdzID4+IDcgJiAzOwogICAgICB0ZXh0UmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiA5ICYgMTsKICAgICAgdGV4dFJlZ2lvbi5kc09mZnNldCA9IHRleHRSZWdpb25TZWdtZW50RmxhZ3MgPDwgMTcgPj4gMjc7CiAgICAgIHRleHRSZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiAxNSAmIDE7CgogICAgICBpZiAodGV4dFJlZ2lvbi5odWZmbWFuKSB7CiAgICAgICAgY29uc3QgdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5GUyA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hbkRTID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiAyICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5EVCA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gNCAmIDM7CiAgICAgICAgdGV4dFJlZ2lvbi5odWZmbWFuUmVmaW5lbWVudERXID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiA2ICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5SZWZpbmVtZW50REggPSB0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzID4+IDggJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnREWCA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gMTAgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnREWSA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gMTIgJiAzOwogICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnRTaXplU2VsZWN0b3IgPSAhISh0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzICYgMHg0MDAwKTsKICAgICAgfQoKICAgICAgaWYgKHRleHRSZWdpb24ucmVmaW5lbWVudCAmJiAhdGV4dFJlZ2lvbi5yZWZpbmVtZW50VGVtcGxhdGUpIHsKICAgICAgICBhdCA9IFtdOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMjsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgdGV4dFJlZ2lvbi5yZWZpbmVtZW50QXQgPSBhdDsKICAgICAgfQoKICAgICAgdGV4dFJlZ2lvbi5udW1iZXJPZlN5bWJvbEluc3RhbmNlcyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGFyZ3MgPSBbdGV4dFJlZ2lvbiwgaGVhZGVyLnJlZmVycmVkVG8sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICBicmVhazsKCiAgICBjYXNlIDE2OgogICAgICBjb25zdCBwYXR0ZXJuRGljdGlvbmFyeSA9IHt9OwogICAgICBjb25zdCBwYXR0ZXJuRGljdGlvbmFyeUZsYWdzID0gZGF0YVtwb3NpdGlvbisrXTsKICAgICAgcGF0dGVybkRpY3Rpb25hcnkubW1yID0gISEocGF0dGVybkRpY3Rpb25hcnlGbGFncyAmIDEpOwogICAgICBwYXR0ZXJuRGljdGlvbmFyeS50ZW1wbGF0ZSA9IHBhdHRlcm5EaWN0aW9uYXJ5RmxhZ3MgPj4gMSAmIDM7CiAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnBhdHRlcm5XaWR0aCA9IGRhdGFbcG9zaXRpb24rK107CiAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnBhdHRlcm5IZWlnaHQgPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICBwYXR0ZXJuRGljdGlvbmFyeS5tYXhQYXR0ZXJuSW5kZXggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSA0OwogICAgICBhcmdzID0gW3BhdHRlcm5EaWN0aW9uYXJ5LCBoZWFkZXIubnVtYmVyLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAyMjoKICAgIGNhc2UgMjM6CiAgICAgIGNvbnN0IGhhbGZ0b25lUmVnaW9uID0ge307CiAgICAgIGhhbGZ0b25lUmVnaW9uLmluZm8gPSByZWFkUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uRmllbGRMZW5ndGg7CiAgICAgIGNvbnN0IGhhbGZ0b25lUmVnaW9uRmxhZ3MgPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICBoYWxmdG9uZVJlZ2lvbi5tbXIgPSAhIShoYWxmdG9uZVJlZ2lvbkZsYWdzICYgMSk7CiAgICAgIGhhbGZ0b25lUmVnaW9uLnRlbXBsYXRlID0gaGFsZnRvbmVSZWdpb25GbGFncyA+PiAxICYgMzsKICAgICAgaGFsZnRvbmVSZWdpb24uZW5hYmxlU2tpcCA9ICEhKGhhbGZ0b25lUmVnaW9uRmxhZ3MgJiA4KTsKICAgICAgaGFsZnRvbmVSZWdpb24uY29tYmluYXRpb25PcGVyYXRvciA9IGhhbGZ0b25lUmVnaW9uRmxhZ3MgPj4gNCAmIDc7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlID0gaGFsZnRvbmVSZWdpb25GbGFncyA+PiA3ICYgMTsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFdpZHRoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZEhlaWdodCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRPZmZzZXRYID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAmIDB4ZmZmZmZmZmY7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRPZmZzZXRZID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAmIDB4ZmZmZmZmZmY7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRWZWN0b3JYID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFZlY3RvclkgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSAyOwogICAgICBhcmdzID0gW2hhbGZ0b25lUmVnaW9uLCBoZWFkZXIucmVmZXJyZWRUbywgZGF0YSwgcG9zaXRpb24sIGVuZF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzg6CiAgICBjYXNlIDM5OgogICAgICBjb25zdCBnZW5lcmljUmVnaW9uID0ge307CiAgICAgIGdlbmVyaWNSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aDsKICAgICAgY29uc3QgZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyA9IGRhdGFbcG9zaXRpb24rK107CiAgICAgIGdlbmVyaWNSZWdpb24ubW1yID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDEpOwogICAgICBnZW5lcmljUmVnaW9uLnRlbXBsYXRlID0gZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyA+PiAxICYgMzsKICAgICAgZ2VuZXJpY1JlZ2lvbi5wcmVkaWN0aW9uID0gISEoZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyAmIDgpOwoKICAgICAgaWYgKCFnZW5lcmljUmVnaW9uLm1tcikgewogICAgICAgIGF0TGVuZ3RoID0gZ2VuZXJpY1JlZ2lvbi50ZW1wbGF0ZSA9PT0gMCA/IDQgOiAxOwogICAgICAgIGF0ID0gW107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhdExlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgIHk6ICgwLCBfY29yZV91dGlscy5yZWFkSW50OCkoZGF0YSwgcG9zaXRpb24gKyAxKQogICAgICAgICAgfSk7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgIH0KCiAgICAgICAgZ2VuZXJpY1JlZ2lvbi5hdCA9IGF0OwogICAgICB9CgogICAgICBhcmdzID0gW2dlbmVyaWNSZWdpb24sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICBicmVhazsKCiAgICBjYXNlIDQ4OgogICAgICBjb25zdCBwYWdlSW5mbyA9IHsKICAgICAgICB3aWR0aDogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSwKICAgICAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpLAogICAgICAgIHJlc29sdXRpb25YOiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA4KSwKICAgICAgICByZXNvbHV0aW9uWTogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMTIpCiAgICAgIH07CgogICAgICBpZiAocGFnZUluZm8uaGVpZ2h0ID09PSAweGZmZmZmZmZmKSB7CiAgICAgICAgZGVsZXRlIHBhZ2VJbmZvLmhlaWdodDsKICAgICAgfQoKICAgICAgY29uc3QgcGFnZVNlZ21lbnRGbGFncyA9IGRhdGFbcG9zaXRpb24gKyAxNl07CiAgICAgICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbiArIDE3KTsKICAgICAgcGFnZUluZm8ubG9zc2xlc3MgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgMSk7CiAgICAgIHBhZ2VJbmZvLnJlZmluZW1lbnQgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgMik7CiAgICAgIHBhZ2VJbmZvLmRlZmF1bHRQaXhlbFZhbHVlID0gcGFnZVNlZ21lbnRGbGFncyA+PiAyICYgMTsKICAgICAgcGFnZUluZm8uY29tYmluYXRpb25PcGVyYXRvciA9IHBhZ2VTZWdtZW50RmxhZ3MgPj4gMyAmIDM7CiAgICAgIHBhZ2VJbmZvLnJlcXVpcmVzQnVmZmVyID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDMyKTsKICAgICAgcGFnZUluZm8uY29tYmluYXRpb25PcGVyYXRvck92ZXJyaWRlID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDY0KTsKICAgICAgYXJncyA9IFtwYWdlSW5mb107CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNDk6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTA6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTE6CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNTM6CiAgICAgIGFyZ3MgPSBbaGVhZGVyLm51bWJlciwgZGF0YSwgcG9zaXRpb24sIGVuZF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgNjI6CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKGBzZWdtZW50IHR5cGUgJHtoZWFkZXIudHlwZU5hbWV9KCR7aGVhZGVyLnR5cGV9KSBpcyBub3QgaW1wbGVtZW50ZWRgKTsKICB9CgogIGNvbnN0IGNhbGxiYWNrTmFtZSA9ICJvbiIgKyBoZWFkZXIudHlwZU5hbWU7CgogIGlmIChjYWxsYmFja05hbWUgaW4gdmlzaXRvcikgewogICAgdmlzaXRvcltjYWxsYmFja05hbWVdLmFwcGx5KHZpc2l0b3IsIGFyZ3MpOwogIH0KfQoKZnVuY3Rpb24gcHJvY2Vzc1NlZ21lbnRzKHNlZ21lbnRzLCB2aXNpdG9yKSB7CiAgZm9yIChsZXQgaSA9IDAsIGlpID0gc2VnbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgcHJvY2Vzc1NlZ21lbnQoc2VnbWVudHNbaV0sIHZpc2l0b3IpOwogIH0KfQoKZnVuY3Rpb24gcGFyc2VKYmlnMkNodW5rcyhjaHVua3MpIHsKICBjb25zdCB2aXNpdG9yID0gbmV3IFNpbXBsZVNlZ21lbnRWaXNpdG9yKCk7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjaHVuayA9IGNodW5rc1tpXTsKICAgIGNvbnN0IHNlZ21lbnRzID0gcmVhZFNlZ21lbnRzKHt9LCBjaHVuay5kYXRhLCBjaHVuay5zdGFydCwgY2h1bmsuZW5kKTsKICAgIHByb2Nlc3NTZWdtZW50cyhzZWdtZW50cywgdmlzaXRvcik7CiAgfQoKICByZXR1cm4gdmlzaXRvci5idWZmZXI7Cn0KCmZ1bmN0aW9uIHBhcnNlSmJpZzIoZGF0YSkgewogIHRocm93IG5ldyBFcnJvcigiTm90IGltcGxlbWVudGVkOiBwYXJzZUpiaWcyIik7Cn0KCmNsYXNzIFNpbXBsZVNlZ21lbnRWaXNpdG9yIHsKICBvblBhZ2VJbmZvcm1hdGlvbihpbmZvKSB7CiAgICB0aGlzLmN1cnJlbnRQYWdlSW5mbyA9IGluZm87CiAgICBjb25zdCByb3dTaXplID0gaW5mby53aWR0aCArIDcgPj4gMzsKICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBVaW50OENsYW1wZWRBcnJheShyb3dTaXplICogaW5mby5oZWlnaHQpOwoKICAgIGlmIChpbmZvLmRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgIGJ1ZmZlci5maWxsKDB4ZmYpOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogIH0KCiAgZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApIHsKICAgIGNvbnN0IHBhZ2VJbmZvID0gdGhpcy5jdXJyZW50UGFnZUluZm87CiAgICBjb25zdCB3aWR0aCA9IHJlZ2lvbkluZm8ud2lkdGgsCiAgICAgICAgICBoZWlnaHQgPSByZWdpb25JbmZvLmhlaWdodDsKICAgIGNvbnN0IHJvd1NpemUgPSBwYWdlSW5mby53aWR0aCArIDcgPj4gMzsKICAgIGNvbnN0IGNvbWJpbmF0aW9uT3BlcmF0b3IgPSBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yT3ZlcnJpZGUgPyByZWdpb25JbmZvLmNvbWJpbmF0aW9uT3BlcmF0b3IgOiBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICBjb25zdCBtYXNrMCA9IDEyOCA+PiAocmVnaW9uSW5mby54ICYgNyk7CiAgICBsZXQgb2Zmc2V0MCA9IHJlZ2lvbkluZm8ueSAqIHJvd1NpemUgKyAocmVnaW9uSW5mby54ID4+IDMpOwogICAgbGV0IGksIGosIG1hc2ssIG9mZnNldDsKCiAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgY2FzZSAwOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgICAgICAgbWFzayA9IG1hc2swOwogICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0MDsKCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgICBpZiAoYml0bWFwW2ldW2pdKSB7CiAgICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gfD0gbWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbWFzayA+Pj0gMTsKCiAgICAgICAgICAgIGlmICghbWFzaykgewogICAgICAgICAgICAgIG1hc2sgPSAxMjg7CiAgICAgICAgICAgICAgb2Zmc2V0Kys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBvZmZzZXQwICs9IHJvd1NpemU7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgICAgICAgIG1hc2sgPSBtYXNrMDsKICAgICAgICAgIG9mZnNldCA9IG9mZnNldDA7CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgICAgaWYgKGJpdG1hcFtpXVtqXSkgewogICAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXRdIF49IG1hc2s7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1hc2sgPj49IDE7CgogICAgICAgICAgICBpZiAoIW1hc2spIHsKICAgICAgICAgICAgICBtYXNrID0gMTI4OwogICAgICAgICAgICAgIG9mZnNldCsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0MCArPSByb3dTaXplOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKGBvcGVyYXRvciAke2NvbWJpbmF0aW9uT3BlcmF0b3J9IGlzIG5vdCBzdXBwb3J0ZWRgKTsKICAgIH0KICB9CgogIG9uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbihyZWdpb24sIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVCaXRtYXAocmVnaW9uLm1tciwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi50ZW1wbGF0ZSwgcmVnaW9uLnByZWRpY3Rpb24sIG51bGwsIHJlZ2lvbi5hdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgIHRoaXMuZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApOwogIH0KCiAgb25JbW1lZGlhdGVMb3NzbGVzc0dlbmVyaWNSZWdpb24oKSB7CiAgICB0aGlzLm9uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbiguLi5hcmd1bWVudHMpOwogIH0KCiAgb25TeW1ib2xEaWN0aW9uYXJ5KGRpY3Rpb25hcnksIGN1cnJlbnRTZWdtZW50LCByZWZlcnJlZFNlZ21lbnRzLCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgICBsZXQgaHVmZm1hblRhYmxlcywgaHVmZm1hbklucHV0OwoKICAgIGlmIChkaWN0aW9uYXJ5Lmh1ZmZtYW4pIHsKICAgICAgaHVmZm1hblRhYmxlcyA9IGdldFN5bWJvbERpY3Rpb25hcnlIdWZmbWFuVGFibGVzKGRpY3Rpb25hcnksIHJlZmVycmVkU2VnbWVudHMsIHRoaXMuY3VzdG9tVGFibGVzKTsKICAgICAgaHVmZm1hbklucHV0ID0gbmV3IFJlYWRlcihkYXRhLCBzdGFydCwgZW5kKTsKICAgIH0KCiAgICBsZXQgc3ltYm9scyA9IHRoaXMuc3ltYm9sczsKCiAgICBpZiAoIXN5bWJvbHMpIHsKICAgICAgdGhpcy5zeW1ib2xzID0gc3ltYm9scyA9IHt9OwogICAgfQoKICAgIGNvbnN0IGlucHV0U3ltYm9scyA9IFtdOwoKICAgIGZvciAoY29uc3QgcmVmZXJyZWRTZWdtZW50IG9mIHJlZmVycmVkU2VnbWVudHMpIHsKICAgICAgY29uc3QgcmVmZXJyZWRTeW1ib2xzID0gc3ltYm9sc1tyZWZlcnJlZFNlZ21lbnRdOwoKICAgICAgaWYgKHJlZmVycmVkU3ltYm9scykgewogICAgICAgIGlucHV0U3ltYm9scy5wdXNoKC4uLnJlZmVycmVkU3ltYm9scyk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgc3ltYm9sc1tjdXJyZW50U2VnbWVudF0gPSBkZWNvZGVTeW1ib2xEaWN0aW9uYXJ5KGRpY3Rpb25hcnkuaHVmZm1hbiwgZGljdGlvbmFyeS5yZWZpbmVtZW50LCBpbnB1dFN5bWJvbHMsIGRpY3Rpb25hcnkubnVtYmVyT2ZOZXdTeW1ib2xzLCBkaWN0aW9uYXJ5Lm51bWJlck9mRXhwb3J0ZWRTeW1ib2xzLCBodWZmbWFuVGFibGVzLCBkaWN0aW9uYXJ5LnRlbXBsYXRlLCBkaWN0aW9uYXJ5LmF0LCBkaWN0aW9uYXJ5LnJlZmluZW1lbnRUZW1wbGF0ZSwgZGljdGlvbmFyeS5yZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCwgaHVmZm1hbklucHV0KTsKICB9CgogIG9uSW1tZWRpYXRlVGV4dFJlZ2lvbihyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGxldCBodWZmbWFuVGFibGVzLCBodWZmbWFuSW5wdXQ7CiAgICBjb25zdCBzeW1ib2xzID0gdGhpcy5zeW1ib2xzOwogICAgY29uc3QgaW5wdXRTeW1ib2xzID0gW107CgogICAgZm9yIChjb25zdCByZWZlcnJlZFNlZ21lbnQgb2YgcmVmZXJyZWRTZWdtZW50cykgewogICAgICBjb25zdCByZWZlcnJlZFN5bWJvbHMgPSBzeW1ib2xzW3JlZmVycmVkU2VnbWVudF07CgogICAgICBpZiAocmVmZXJyZWRTeW1ib2xzKSB7CiAgICAgICAgaW5wdXRTeW1ib2xzLnB1c2goLi4ucmVmZXJyZWRTeW1ib2xzKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHN5bWJvbENvZGVMZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMubG9nMikoaW5wdXRTeW1ib2xzLmxlbmd0aCk7CgogICAgaWYgKHJlZ2lvbi5odWZmbWFuKSB7CiAgICAgIGh1ZmZtYW5JbnB1dCA9IG5ldyBSZWFkZXIoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICAgIGh1ZmZtYW5UYWJsZXMgPSBnZXRUZXh0UmVnaW9uSHVmZm1hblRhYmxlcyhyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIHRoaXMuY3VzdG9tVGFibGVzLCBpbnB1dFN5bWJvbHMubGVuZ3RoLCBodWZmbWFuSW5wdXQpOwogICAgfQoKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVUZXh0UmVnaW9uKHJlZ2lvbi5odWZmbWFuLCByZWdpb24ucmVmaW5lbWVudCwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi5kZWZhdWx0UGl4ZWxWYWx1ZSwgcmVnaW9uLm51bWJlck9mU3ltYm9sSW5zdGFuY2VzLCByZWdpb24uc3RyaXBTaXplLCBpbnB1dFN5bWJvbHMsIHN5bWJvbENvZGVMZW5ndGgsIHJlZ2lvbi50cmFuc3Bvc2VkLCByZWdpb24uZHNPZmZzZXQsIHJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIsIHJlZ2lvbi5jb21iaW5hdGlvbk9wZXJhdG9yLCBodWZmbWFuVGFibGVzLCByZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlLCByZWdpb24ucmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQsIHJlZ2lvbi5sb2dTdHJpcFNpemUsIGh1ZmZtYW5JbnB1dCk7CiAgICB0aGlzLmRyYXdCaXRtYXAocmVnaW9uSW5mbywgYml0bWFwKTsKICB9CgogIG9uSW1tZWRpYXRlTG9zc2xlc3NUZXh0UmVnaW9uKCkgewogICAgdGhpcy5vbkltbWVkaWF0ZVRleHRSZWdpb24oLi4uYXJndW1lbnRzKTsKICB9CgogIG9uUGF0dGVybkRpY3Rpb25hcnkoZGljdGlvbmFyeSwgY3VycmVudFNlZ21lbnQsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGxldCBwYXR0ZXJucyA9IHRoaXMucGF0dGVybnM7CgogICAgaWYgKCFwYXR0ZXJucykgewogICAgICB0aGlzLnBhdHRlcm5zID0gcGF0dGVybnMgPSB7fTsKICAgIH0KCiAgICBjb25zdCBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgcGF0dGVybnNbY3VycmVudFNlZ21lbnRdID0gZGVjb2RlUGF0dGVybkRpY3Rpb25hcnkoZGljdGlvbmFyeS5tbXIsIGRpY3Rpb25hcnkucGF0dGVybldpZHRoLCBkaWN0aW9uYXJ5LnBhdHRlcm5IZWlnaHQsIGRpY3Rpb25hcnkubWF4UGF0dGVybkluZGV4LCBkaWN0aW9uYXJ5LnRlbXBsYXRlLCBkZWNvZGluZ0NvbnRleHQpOwogIH0KCiAgb25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbihyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGNvbnN0IHBhdHRlcm5zID0gdGhpcy5wYXR0ZXJuc1tyZWZlcnJlZFNlZ21lbnRzWzBdXTsKICAgIGNvbnN0IHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgIGNvbnN0IGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICBjb25zdCBiaXRtYXAgPSBkZWNvZGVIYWxmdG9uZVJlZ2lvbihyZWdpb24ubW1yLCBwYXR0ZXJucywgcmVnaW9uLnRlbXBsYXRlLCByZWdpb25JbmZvLndpZHRoLCByZWdpb25JbmZvLmhlaWdodCwgcmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlLCByZWdpb24uZW5hYmxlU2tpcCwgcmVnaW9uLmNvbWJpbmF0aW9uT3BlcmF0b3IsIHJlZ2lvbi5ncmlkV2lkdGgsIHJlZ2lvbi5ncmlkSGVpZ2h0LCByZWdpb24uZ3JpZE9mZnNldFgsIHJlZ2lvbi5ncmlkT2Zmc2V0WSwgcmVnaW9uLmdyaWRWZWN0b3JYLCByZWdpb24uZ3JpZFZlY3RvclksIGRlY29kaW5nQ29udGV4dCk7CiAgICB0aGlzLmRyYXdCaXRtYXAocmVnaW9uSW5mbywgYml0bWFwKTsKICB9CgogIG9uSW1tZWRpYXRlTG9zc2xlc3NIYWxmdG9uZVJlZ2lvbigpIHsKICAgIHRoaXMub25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbiguLi5hcmd1bWVudHMpOwogIH0KCiAgb25UYWJsZXMoY3VycmVudFNlZ21lbnQsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIGxldCBjdXN0b21UYWJsZXMgPSB0aGlzLmN1c3RvbVRhYmxlczsKCiAgICBpZiAoIWN1c3RvbVRhYmxlcykgewogICAgICB0aGlzLmN1c3RvbVRhYmxlcyA9IGN1c3RvbVRhYmxlcyA9IHt9OwogICAgfQoKICAgIGN1c3RvbVRhYmxlc1tjdXJyZW50U2VnbWVudF0gPSBkZWNvZGVUYWJsZXNTZWdtZW50KGRhdGEsIHN0YXJ0LCBlbmQpOwogIH0KCn0KCmNsYXNzIEh1ZmZtYW5MaW5lIHsKICBjb25zdHJ1Y3RvcihsaW5lRGF0YSkgewogICAgaWYgKGxpbmVEYXRhLmxlbmd0aCA9PT0gMikgewogICAgICB0aGlzLmlzT09CID0gdHJ1ZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IDA7CiAgICAgIHRoaXMucHJlZml4TGVuZ3RoID0gbGluZURhdGFbMF07CiAgICAgIHRoaXMucmFuZ2VMZW5ndGggPSAwOwogICAgICB0aGlzLnByZWZpeENvZGUgPSBsaW5lRGF0YVsxXTsKICAgICAgdGhpcy5pc0xvd2VyUmFuZ2UgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNPT0IgPSBmYWxzZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IGxpbmVEYXRhWzBdOwogICAgICB0aGlzLnByZWZpeExlbmd0aCA9IGxpbmVEYXRhWzFdOwogICAgICB0aGlzLnJhbmdlTGVuZ3RoID0gbGluZURhdGFbMl07CiAgICAgIHRoaXMucHJlZml4Q29kZSA9IGxpbmVEYXRhWzNdOwogICAgICB0aGlzLmlzTG93ZXJSYW5nZSA9IGxpbmVEYXRhWzRdID09PSAibG93ZXIiOwogICAgfQogIH0KCn0KCmNsYXNzIEh1ZmZtYW5UcmVlTm9kZSB7CiAgY29uc3RydWN0b3IobGluZSkgewogICAgdGhpcy5jaGlsZHJlbiA9IFtdOwoKICAgIGlmIChsaW5lKSB7CiAgICAgIHRoaXMuaXNMZWFmID0gdHJ1ZTsKICAgICAgdGhpcy5yYW5nZUxlbmd0aCA9IGxpbmUucmFuZ2VMZW5ndGg7CiAgICAgIHRoaXMucmFuZ2VMb3cgPSBsaW5lLnJhbmdlTG93OwogICAgICB0aGlzLmlzTG93ZXJSYW5nZSA9IGxpbmUuaXNMb3dlclJhbmdlOwogICAgICB0aGlzLmlzT09CID0gbGluZS5pc09PQjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNMZWFmID0gZmFsc2U7CiAgICB9CiAgfQoKICBidWlsZFRyZWUobGluZSwgc2hpZnQpIHsKICAgIGNvbnN0IGJpdCA9IGxpbmUucHJlZml4Q29kZSA+PiBzaGlmdCAmIDE7CgogICAgaWYgKHNoaWZ0IDw9IDApIHsKICAgICAgdGhpcy5jaGlsZHJlbltiaXRdID0gbmV3IEh1ZmZtYW5UcmVlTm9kZShsaW5lKTsKICAgIH0gZWxzZSB7CiAgICAgIGxldCBub2RlID0gdGhpcy5jaGlsZHJlbltiaXRdOwoKICAgICAgaWYgKCFub2RlKSB7CiAgICAgICAgdGhpcy5jaGlsZHJlbltiaXRdID0gbm9kZSA9IG5ldyBIdWZmbWFuVHJlZU5vZGUobnVsbCk7CiAgICAgIH0KCiAgICAgIG5vZGUuYnVpbGRUcmVlKGxpbmUsIHNoaWZ0IC0gMSk7CiAgICB9CiAgfQoKICBkZWNvZGVOb2RlKHJlYWRlcikgewogICAgaWYgKHRoaXMuaXNMZWFmKSB7CiAgICAgIGlmICh0aGlzLmlzT09CKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IGh0T2Zmc2V0ID0gcmVhZGVyLnJlYWRCaXRzKHRoaXMucmFuZ2VMZW5ndGgpOwogICAgICByZXR1cm4gdGhpcy5yYW5nZUxvdyArICh0aGlzLmlzTG93ZXJSYW5nZSA/IC1odE9mZnNldCA6IGh0T2Zmc2V0KTsKICAgIH0KCiAgICBjb25zdCBub2RlID0gdGhpcy5jaGlsZHJlbltyZWFkZXIucmVhZEJpdCgpXTsKCiAgICBpZiAoIW5vZGUpIHsKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBkYXRhIik7CiAgICB9CgogICAgcmV0dXJuIG5vZGUuZGVjb2RlTm9kZShyZWFkZXIpOwogIH0KCn0KCmNsYXNzIEh1ZmZtYW5UYWJsZSB7CiAgY29uc3RydWN0b3IobGluZXMsIHByZWZpeENvZGVzRG9uZSkgewogICAgaWYgKCFwcmVmaXhDb2Rlc0RvbmUpIHsKICAgICAgdGhpcy5hc3NpZ25QcmVmaXhDb2RlcyhsaW5lcyk7CiAgICB9CgogICAgdGhpcy5yb290Tm9kZSA9IG5ldyBIdWZmbWFuVHJlZU5vZGUobnVsbCk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gbGluZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07CgogICAgICBpZiAobGluZS5wcmVmaXhMZW5ndGggPiAwKSB7CiAgICAgICAgdGhpcy5yb290Tm9kZS5idWlsZFRyZWUobGluZSwgbGluZS5wcmVmaXhMZW5ndGggLSAxKTsKICAgICAgfQogICAgfQogIH0KCiAgZGVjb2RlKHJlYWRlcikgewogICAgcmV0dXJuIHRoaXMucm9vdE5vZGUuZGVjb2RlTm9kZShyZWFkZXIpOwogIH0KCiAgYXNzaWduUHJlZml4Q29kZXMobGluZXMpIHsKICAgIGNvbnN0IGxpbmVzTGVuZ3RoID0gbGluZXMubGVuZ3RoOwogICAgbGV0IHByZWZpeExlbmd0aE1heCA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lc0xlbmd0aDsgaSsrKSB7CiAgICAgIHByZWZpeExlbmd0aE1heCA9IE1hdGgubWF4KHByZWZpeExlbmd0aE1heCwgbGluZXNbaV0ucHJlZml4TGVuZ3RoKTsKICAgIH0KCiAgICBjb25zdCBoaXN0b2dyYW0gPSBuZXcgVWludDMyQXJyYXkocHJlZml4TGVuZ3RoTWF4ICsgMSk7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lc0xlbmd0aDsgaSsrKSB7CiAgICAgIGhpc3RvZ3JhbVtsaW5lc1tpXS5wcmVmaXhMZW5ndGhdKys7CiAgICB9CgogICAgbGV0IGN1cnJlbnRMZW5ndGggPSAxLAogICAgICAgIGZpcnN0Q29kZSA9IDAsCiAgICAgICAgY3VycmVudENvZGUsCiAgICAgICAgY3VycmVudFRlbXAsCiAgICAgICAgbGluZTsKICAgIGhpc3RvZ3JhbVswXSA9IDA7CgogICAgd2hpbGUgKGN1cnJlbnRMZW5ndGggPD0gcHJlZml4TGVuZ3RoTWF4KSB7CiAgICAgIGZpcnN0Q29kZSA9IGZpcnN0Q29kZSArIGhpc3RvZ3JhbVtjdXJyZW50TGVuZ3RoIC0gMV0gPDwgMTsKICAgICAgY3VycmVudENvZGUgPSBmaXJzdENvZGU7CiAgICAgIGN1cnJlbnRUZW1wID0gMDsKCiAgICAgIHdoaWxlIChjdXJyZW50VGVtcCA8IGxpbmVzTGVuZ3RoKSB7CiAgICAgICAgbGluZSA9IGxpbmVzW2N1cnJlbnRUZW1wXTsKCiAgICAgICAgaWYgKGxpbmUucHJlZml4TGVuZ3RoID09PSBjdXJyZW50TGVuZ3RoKSB7CiAgICAgICAgICBsaW5lLnByZWZpeENvZGUgPSBjdXJyZW50Q29kZTsKICAgICAgICAgIGN1cnJlbnRDb2RlKys7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50VGVtcCsrOwogICAgICB9CgogICAgICBjdXJyZW50TGVuZ3RoKys7CiAgICB9CiAgfQoKfQoKZnVuY3Rpb24gZGVjb2RlVGFibGVzU2VnbWVudChkYXRhLCBzdGFydCwgZW5kKSB7CiAgY29uc3QgZmxhZ3MgPSBkYXRhW3N0YXJ0XTsKICBjb25zdCBsb3dlc3RWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCArIDEpICYgMHhmZmZmZmZmZjsKICBjb25zdCBoaWdoZXN0VmFsdWUgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyA1KSAmIDB4ZmZmZmZmZmY7CiAgY29uc3QgcmVhZGVyID0gbmV3IFJlYWRlcihkYXRhLCBzdGFydCArIDksIGVuZCk7CiAgY29uc3QgcHJlZml4U2l6ZUJpdHMgPSAoZmxhZ3MgPj4gMSAmIDcpICsgMTsKICBjb25zdCByYW5nZVNpemVCaXRzID0gKGZsYWdzID4+IDQgJiA3KSArIDE7CiAgY29uc3QgbGluZXMgPSBbXTsKICBsZXQgcHJlZml4TGVuZ3RoLAogICAgICByYW5nZUxlbmd0aCwKICAgICAgY3VycmVudFJhbmdlTG93ID0gbG93ZXN0VmFsdWU7CgogIGRvIHsKICAgIHByZWZpeExlbmd0aCA9IHJlYWRlci5yZWFkQml0cyhwcmVmaXhTaXplQml0cyk7CiAgICByYW5nZUxlbmd0aCA9IHJlYWRlci5yZWFkQml0cyhyYW5nZVNpemVCaXRzKTsKICAgIGxpbmVzLnB1c2gobmV3IEh1ZmZtYW5MaW5lKFtjdXJyZW50UmFuZ2VMb3csIHByZWZpeExlbmd0aCwgcmFuZ2VMZW5ndGgsIDBdKSk7CiAgICBjdXJyZW50UmFuZ2VMb3cgKz0gMSA8PCByYW5nZUxlbmd0aDsKICB9IHdoaWxlIChjdXJyZW50UmFuZ2VMb3cgPCBoaWdoZXN0VmFsdWUpOwoKICBwcmVmaXhMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocHJlZml4U2l6ZUJpdHMpOwogIGxpbmVzLnB1c2gobmV3IEh1ZmZtYW5MaW5lKFtsb3dlc3RWYWx1ZSAtIDEsIHByZWZpeExlbmd0aCwgMzIsIDAsICJsb3dlciJdKSk7CiAgcHJlZml4TGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKHByZWZpeFNpemVCaXRzKTsKICBsaW5lcy5wdXNoKG5ldyBIdWZmbWFuTGluZShbaGlnaGVzdFZhbHVlLCBwcmVmaXhMZW5ndGgsIDMyLCAwXSkpOwoKICBpZiAoZmxhZ3MgJiAxKSB7CiAgICBwcmVmaXhMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocHJlZml4U2l6ZUJpdHMpOwogICAgbGluZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW3ByZWZpeExlbmd0aCwgMF0pKTsKICB9CgogIHJldHVybiBuZXcgSHVmZm1hblRhYmxlKGxpbmVzLCBmYWxzZSk7Cn0KCmNvbnN0IHN0YW5kYXJkVGFibGVzQ2FjaGUgPSB7fTsKCmZ1bmN0aW9uIGdldFN0YW5kYXJkVGFibGUobnVtYmVyKSB7CiAgbGV0IHRhYmxlID0gc3RhbmRhcmRUYWJsZXNDYWNoZVtudW1iZXJdOwoKICBpZiAodGFibGUpIHsKICAgIHJldHVybiB0YWJsZTsKICB9CgogIGxldCBsaW5lczsKCiAgc3dpdGNoIChudW1iZXIpIHsKICAgIGNhc2UgMToKICAgICAgbGluZXMgPSBbWzAsIDEsIDQsIDB4MF0sIFsxNiwgMiwgOCwgMHgyXSwgWzI3MiwgMywgMTYsIDB4Nl0sIFs2NTgwOCwgMywgMzIsIDB4N11dOwogICAgICBicmVhazsKCiAgICBjYXNlIDI6CiAgICAgIGxpbmVzID0gW1swLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbNzUsIDYsIDMyLCAweDNlXSwgWzYsIDB4M2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAzOgogICAgICBsaW5lcyA9IFtbLTI1NiwgOCwgOCwgMHhmZV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbLTI1NywgOCwgMzIsIDB4ZmYsICJsb3dlciJdLCBbNzUsIDcsIDMyLCAweDdlXSwgWzYsIDB4M2VdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA0OgogICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDIsIDAsIDB4Ml0sIFszLCAzLCAwLCAweDZdLCBbNCwgNCwgMywgMHhlXSwgWzEyLCA1LCA2LCAweDFlXSwgWzc2LCA1LCAzMiwgMHgxZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDU6CiAgICAgIGxpbmVzID0gW1stMjU1LCA3LCA4LCAweDdlXSwgWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMCwgMHg2XSwgWzQsIDQsIDMsIDB4ZV0sIFsxMiwgNSwgNiwgMHgxZV0sIFstMjU2LCA3LCAzMiwgMHg3ZiwgImxvd2VyIl0sIFs3NiwgNiwgMzIsIDB4M2VdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA2OgogICAgICBsaW5lcyA9IFtbLTIwNDgsIDUsIDEwLCAweDFjXSwgWy0xMDI0LCA0LCA5LCAweDhdLCBbLTUxMiwgNCwgOCwgMHg5XSwgWy0yNTYsIDQsIDcsIDB4YV0sIFstMTI4LCA1LCA2LCAweDFkXSwgWy02NCwgNSwgNSwgMHgxZV0sIFstMzIsIDQsIDUsIDB4Yl0sIFswLCAyLCA3LCAweDBdLCBbMTI4LCAzLCA3LCAweDJdLCBbMjU2LCAzLCA4LCAweDNdLCBbNTEyLCA0LCA5LCAweGNdLCBbMTAyNCwgNCwgMTAsIDB4ZF0sIFstMjA0OSwgNiwgMzIsIDB4M2UsICJsb3dlciJdLCBbMjA0OCwgNiwgMzIsIDB4M2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA3OgogICAgICBsaW5lcyA9IFtbLTEwMjQsIDQsIDksIDB4OF0sIFstNTEyLCAzLCA4LCAweDBdLCBbLTI1NiwgNCwgNywgMHg5XSwgWy0xMjgsIDUsIDYsIDB4MWFdLCBbLTY0LCA1LCA1LCAweDFiXSwgWy0zMiwgNCwgNSwgMHhhXSwgWzAsIDQsIDUsIDB4Yl0sIFszMiwgNSwgNSwgMHgxY10sIFs2NCwgNSwgNiwgMHgxZF0sIFsxMjgsIDQsIDcsIDB4Y10sIFsyNTYsIDMsIDgsIDB4MV0sIFs1MTIsIDMsIDksIDB4Ml0sIFsxMDI0LCAzLCAxMCwgMHgzXSwgWy0xMDI1LCA1LCAzMiwgMHgxZSwgImxvd2VyIl0sIFsyMDQ4LCA1LCAzMiwgMHgxZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDg6CiAgICAgIGxpbmVzID0gW1stMTUsIDgsIDMsIDB4ZmNdLCBbLTcsIDksIDEsIDB4MWZjXSwgWy01LCA4LCAxLCAweGZkXSwgWy0zLCA5LCAwLCAweDFmZF0sIFstMiwgNywgMCwgMHg3Y10sIFstMSwgNCwgMCwgMHhhXSwgWzAsIDIsIDEsIDB4MF0sIFsyLCA1LCAwLCAweDFhXSwgWzMsIDYsIDAsIDB4M2FdLCBbNCwgMywgNCwgMHg0XSwgWzIwLCA2LCAxLCAweDNiXSwgWzIyLCA0LCA0LCAweGJdLCBbMzgsIDQsIDUsIDB4Y10sIFs3MCwgNSwgNiwgMHgxYl0sIFsxMzQsIDUsIDcsIDB4MWNdLCBbMjYyLCA2LCA3LCAweDNjXSwgWzM5MCwgNywgOCwgMHg3ZF0sIFs2NDYsIDYsIDEwLCAweDNkXSwgWy0xNiwgOSwgMzIsIDB4MWZlLCAibG93ZXIiXSwgWzE2NzAsIDksIDMyLCAweDFmZl0sIFsyLCAweDFdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA5OgogICAgICBsaW5lcyA9IFtbLTMxLCA4LCA0LCAweGZjXSwgWy0xNSwgOSwgMiwgMHgxZmNdLCBbLTExLCA4LCAyLCAweGZkXSwgWy03LCA5LCAxLCAweDFmZF0sIFstNSwgNywgMSwgMHg3Y10sIFstMywgNCwgMSwgMHhhXSwgWy0xLCAzLCAxLCAweDJdLCBbMSwgMywgMSwgMHgzXSwgWzMsIDUsIDEsIDB4MWFdLCBbNSwgNiwgMSwgMHgzYV0sIFs3LCAzLCA1LCAweDRdLCBbMzksIDYsIDIsIDB4M2JdLCBbNDMsIDQsIDUsIDB4Yl0sIFs3NSwgNCwgNiwgMHhjXSwgWzEzOSwgNSwgNywgMHgxYl0sIFsyNjcsIDUsIDgsIDB4MWNdLCBbNTIzLCA2LCA4LCAweDNjXSwgWzc3OSwgNywgOSwgMHg3ZF0sIFsxMjkxLCA2LCAxMSwgMHgzZF0sIFstMzIsIDksIDMyLCAweDFmZSwgImxvd2VyIl0sIFszMzM5LCA5LCAzMiwgMHgxZmZdLCBbMiwgMHgwXV07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMTA6CiAgICAgIGxpbmVzID0gW1stMjEsIDcsIDQsIDB4N2FdLCBbLTUsIDgsIDAsIDB4ZmNdLCBbLTQsIDcsIDAsIDB4N2JdLCBbLTMsIDUsIDAsIDB4MThdLCBbLTIsIDIsIDIsIDB4MF0sIFsyLCA1LCAwLCAweDE5XSwgWzMsIDYsIDAsIDB4MzZdLCBbNCwgNywgMCwgMHg3Y10sIFs1LCA4LCAwLCAweGZkXSwgWzYsIDIsIDYsIDB4MV0sIFs3MCwgNSwgNSwgMHgxYV0sIFsxMDIsIDYsIDUsIDB4MzddLCBbMTM0LCA2LCA2LCAweDM4XSwgWzE5OCwgNiwgNywgMHgzOV0sIFszMjYsIDYsIDgsIDB4M2FdLCBbNTgyLCA2LCA5LCAweDNiXSwgWzEwOTQsIDYsIDEwLCAweDNjXSwgWzIxMTgsIDcsIDExLCAweDdkXSwgWy0yMiwgOCwgMzIsIDB4ZmUsICJsb3dlciJdLCBbNDE2NiwgOCwgMzIsIDB4ZmZdLCBbMiwgMHgyXV07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMTE6CiAgICAgIGxpbmVzID0gW1sxLCAxLCAwLCAweDBdLCBbMiwgMiwgMSwgMHgyXSwgWzQsIDQsIDAsIDB4Y10sIFs1LCA0LCAxLCAweGRdLCBbNywgNSwgMSwgMHgxY10sIFs5LCA1LCAyLCAweDFkXSwgWzEzLCA2LCAyLCAweDNjXSwgWzE3LCA3LCAyLCAweDdhXSwgWzIxLCA3LCAzLCAweDdiXSwgWzI5LCA3LCA0LCAweDdjXSwgWzQ1LCA3LCA1LCAweDdkXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxMjoKICAgICAgbGluZXMgPSBbWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMSwgMHg2XSwgWzUsIDUsIDAsIDB4MWNdLCBbNiwgNSwgMSwgMHgxZF0sIFs4LCA2LCAxLCAweDNjXSwgWzEwLCA3LCAwLCAweDdhXSwgWzExLCA3LCAxLCAweDdiXSwgWzEzLCA3LCAyLCAweDdjXSwgWzE3LCA3LCAzLCAweDdkXSwgWzI1LCA3LCA0LCAweDdlXSwgWzQxLCA4LCA1LCAweGZlXSwgWzczLCA4LCAzMiwgMHhmZl1dOwogICAgICBicmVhazsKCiAgICBjYXNlIDEzOgogICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDMsIDAsIDB4NF0sIFszLCA0LCAwLCAweGNdLCBbNCwgNSwgMCwgMHgxY10sIFs1LCA0LCAxLCAweGRdLCBbNywgMywgMywgMHg1XSwgWzE1LCA2LCAxLCAweDNhXSwgWzE3LCA2LCAyLCAweDNiXSwgWzIxLCA2LCAzLCAweDNjXSwgWzI5LCA2LCA0LCAweDNkXSwgWzQ1LCA2LCA1LCAweDNlXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxNDoKICAgICAgbGluZXMgPSBbWy0yLCAzLCAwLCAweDRdLCBbLTEsIDMsIDAsIDB4NV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg2XSwgWzIsIDMsIDAsIDB4N11dOwogICAgICBicmVhazsKCiAgICBjYXNlIDE1OgogICAgICBsaW5lcyA9IFtbLTI0LCA3LCA0LCAweDdjXSwgWy04LCA2LCAyLCAweDNjXSwgWy00LCA1LCAxLCAweDFjXSwgWy0yLCA0LCAwLCAweGNdLCBbLTEsIDMsIDAsIDB4NF0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg1XSwgWzIsIDQsIDAsIDB4ZF0sIFszLCA1LCAxLCAweDFkXSwgWzUsIDYsIDIsIDB4M2RdLCBbOSwgNywgNCwgMHg3ZF0sIFstMjUsIDcsIDMyLCAweDdlLCAibG93ZXIiXSwgWzI1LCA3LCAzMiwgMHg3Zl1dOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcihgc3RhbmRhcmQgdGFibGUgQi4ke251bWJlcn0gZG9lcyBub3QgZXhpc3RgKTsKICB9CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IGxpbmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGxpbmVzW2ldID0gbmV3IEh1ZmZtYW5MaW5lKGxpbmVzW2ldKTsKICB9CgogIHRhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShsaW5lcywgdHJ1ZSk7CiAgc3RhbmRhcmRUYWJsZXNDYWNoZVtudW1iZXJdID0gdGFibGU7CiAgcmV0dXJuIHRhYmxlOwp9CgpjbGFzcyBSZWFkZXIgewogIGNvbnN0cnVjdG9yKGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmVuZCA9IGVuZDsKICAgIHRoaXMucG9zaXRpb24gPSBzdGFydDsKICAgIHRoaXMuc2hpZnQgPSAtMTsKICAgIHRoaXMuY3VycmVudEJ5dGUgPSAwOwogIH0KCiAgcmVhZEJpdCgpIHsKICAgIGlmICh0aGlzLnNoaWZ0IDwgMCkgewogICAgICBpZiAodGhpcy5wb3NpdGlvbiA+PSB0aGlzLmVuZCkgewogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJlbmQgb2YgZGF0YSB3aGlsZSByZWFkaW5nIGJpdCIpOwogICAgICB9CgogICAgICB0aGlzLmN1cnJlbnRCeXRlID0gdGhpcy5kYXRhW3RoaXMucG9zaXRpb24rK107CiAgICAgIHRoaXMuc2hpZnQgPSA3OwogICAgfQoKICAgIGNvbnN0IGJpdCA9IHRoaXMuY3VycmVudEJ5dGUgPj4gdGhpcy5zaGlmdCAmIDE7CiAgICB0aGlzLnNoaWZ0LS07CiAgICByZXR1cm4gYml0OwogIH0KCiAgcmVhZEJpdHMobnVtQml0cykgewogICAgbGV0IHJlc3VsdCA9IDAsCiAgICAgICAgaTsKCiAgICBmb3IgKGkgPSBudW1CaXRzIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgcmVzdWx0IHw9IHRoaXMucmVhZEJpdCgpIDw8IGk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGJ5dGVBbGlnbigpIHsKICAgIHRoaXMuc2hpZnQgPSAtMTsKICB9CgogIG5leHQoKSB7CiAgICBpZiAodGhpcy5wb3NpdGlvbiA+PSB0aGlzLmVuZCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZGF0YVt0aGlzLnBvc2l0aW9uKytdOwogIH0KCn0KCmZ1bmN0aW9uIGdldEN1c3RvbUh1ZmZtYW5UYWJsZShpbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKSB7CiAgbGV0IGN1cnJlbnRJbmRleCA9IDA7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlZmVycmVkVG8ubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3QgdGFibGUgPSBjdXN0b21UYWJsZXNbcmVmZXJyZWRUb1tpXV07CgogICAgaWYgKHRhYmxlKSB7CiAgICAgIGlmIChpbmRleCA9PT0gY3VycmVudEluZGV4KSB7CiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgICB9CgogICAgICBjdXJyZW50SW5kZXgrKzsKICAgIH0KICB9CgogIHRocm93IG5ldyBKYmlnMkVycm9yKCJjYW4ndCBmaW5kIGN1c3RvbSBIdWZmbWFuIHRhYmxlIik7Cn0KCmZ1bmN0aW9uIGdldFRleHRSZWdpb25IdWZmbWFuVGFibGVzKHRleHRSZWdpb24sIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcywgbnVtYmVyT2ZTeW1ib2xzLCByZWFkZXIpIHsKICBjb25zdCBjb2RlcyA9IFtdOwoKICBmb3IgKGxldCBpID0gMDsgaSA8PSAzNDsgaSsrKSB7CiAgICBjb25zdCBjb2RlTGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKDQpOwogICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIGNvZGVMZW5ndGgsIDAsIDBdKSk7CiAgfQoKICBjb25zdCBydW5Db2Rlc1RhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShjb2RlcywgZmFsc2UpOwogIGNvZGVzLmxlbmd0aCA9IDA7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZTeW1ib2xzOykgewogICAgY29uc3QgY29kZUxlbmd0aCA9IHJ1bkNvZGVzVGFibGUuZGVjb2RlKHJlYWRlcik7CgogICAgaWYgKGNvZGVMZW5ndGggPj0gMzIpIHsKICAgICAgbGV0IHJlcGVhdGVkTGVuZ3RoLCBudW1iZXJPZlJlcGVhdHMsIGo7CgogICAgICBzd2l0Y2ggKGNvZGVMZW5ndGgpIHsKICAgICAgICBjYXNlIDMyOgogICAgICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoIm5vIHByZXZpb3VzIHZhbHVlIGluIHN5bWJvbCBJRCB0YWJsZSIpOwogICAgICAgICAgfQoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cygyKSArIDM7CiAgICAgICAgICByZXBlYXRlZExlbmd0aCA9IGNvZGVzW2kgLSAxXS5wcmVmaXhMZW5ndGg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzMzoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cygzKSArIDM7CiAgICAgICAgICByZXBlYXRlZExlbmd0aCA9IDA7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzNDoKICAgICAgICAgIG51bWJlck9mUmVwZWF0cyA9IHJlYWRlci5yZWFkQml0cyg3KSArIDExOwogICAgICAgICAgcmVwZWF0ZWRMZW5ndGggPSAwOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBjb2RlIGxlbmd0aCBpbiBzeW1ib2wgSUQgdGFibGUiKTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUmVwZWF0czsgaisrKSB7CiAgICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIHJlcGVhdGVkTGVuZ3RoLCAwLCAwXSkpOwogICAgICAgIGkrKzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIGNvZGVMZW5ndGgsIDAsIDBdKSk7CiAgICAgIGkrKzsKICAgIH0KICB9CgogIHJlYWRlci5ieXRlQWxpZ24oKTsKICBjb25zdCBzeW1ib2xJRFRhYmxlID0gbmV3IEh1ZmZtYW5UYWJsZShjb2RlcywgZmFsc2UpOwogIGxldCBjdXN0b21JbmRleCA9IDAsCiAgICAgIHRhYmxlRmlyc3RTLAogICAgICB0YWJsZURlbHRhUywKICAgICAgdGFibGVEZWx0YVQ7CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRlMpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgICAgdGFibGVGaXJzdFMgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkZTICsgNik7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVGaXJzdFMgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRlMgc2VsZWN0b3IiKTsKICB9CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRFMpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgIGNhc2UgMjoKICAgICAgdGFibGVEZWx0YVMgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkRTICsgOCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVEZWx0YVMgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRFMgc2VsZWN0b3IiKTsKICB9CgogIHN3aXRjaCAodGV4dFJlZ2lvbi5odWZmbWFuRFQpIHsKICAgIGNhc2UgMDoKICAgIGNhc2UgMToKICAgIGNhc2UgMjoKICAgICAgdGFibGVEZWx0YVQgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkRUICsgMTEpOwogICAgICBicmVhazsKCiAgICBjYXNlIDM6CiAgICAgIHRhYmxlRGVsdGFUID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgICBjdXN0b21JbmRleCsrOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBIdWZmbWFuIERUIHNlbGVjdG9yIik7CiAgfQoKICBpZiAodGV4dFJlZ2lvbi5yZWZpbmVtZW50KSB7CiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicmVmaW5lbWVudCB3aXRoIEh1ZmZtYW4gaXMgbm90IHN1cHBvcnRlZCIpOwogIH0KCiAgcmV0dXJuIHsKICAgIHN5bWJvbElEVGFibGUsCiAgICB0YWJsZUZpcnN0UywKICAgIHRhYmxlRGVsdGFTLAogICAgdGFibGVEZWx0YVQKICB9Owp9CgpmdW5jdGlvbiBnZXRTeW1ib2xEaWN0aW9uYXJ5SHVmZm1hblRhYmxlcyhkaWN0aW9uYXJ5LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpIHsKICBsZXQgY3VzdG9tSW5kZXggPSAwLAogICAgICB0YWJsZURlbHRhSGVpZ2h0LAogICAgICB0YWJsZURlbHRhV2lkdGg7CgogIHN3aXRjaCAoZGljdGlvbmFyeS5odWZmbWFuREhTZWxlY3RvcikgewogICAgY2FzZSAwOgogICAgY2FzZSAxOgogICAgICB0YWJsZURlbHRhSGVpZ2h0ID0gZ2V0U3RhbmRhcmRUYWJsZShkaWN0aW9uYXJ5Lmh1ZmZtYW5ESFNlbGVjdG9yICsgNCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGFibGVEZWx0YUhlaWdodCA9IGdldEN1c3RvbUh1ZmZtYW5UYWJsZShjdXN0b21JbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKTsKICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBESCBzZWxlY3RvciIpOwogIH0KCiAgc3dpdGNoIChkaWN0aW9uYXJ5Lmh1ZmZtYW5EV1NlbGVjdG9yKSB7CiAgICBjYXNlIDA6CiAgICBjYXNlIDE6CiAgICAgIHRhYmxlRGVsdGFXaWR0aCA9IGdldFN0YW5kYXJkVGFibGUoZGljdGlvbmFyeS5odWZmbWFuRFdTZWxlY3RvciArIDIpOwogICAgICBicmVhazsKCiAgICBjYXNlIDM6CiAgICAgIHRhYmxlRGVsdGFXaWR0aCA9IGdldEN1c3RvbUh1ZmZtYW5UYWJsZShjdXN0b21JbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKTsKICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBEVyBzZWxlY3RvciIpOwogIH0KCiAgbGV0IHRhYmxlQml0bWFwU2l6ZSwgdGFibGVBZ2dyZWdhdGVJbnN0YW5jZXM7CgogIGlmIChkaWN0aW9uYXJ5LmJpdG1hcFNpemVTZWxlY3RvcikgewogICAgdGFibGVCaXRtYXBTaXplID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgY3VzdG9tSW5kZXgrKzsKICB9IGVsc2UgewogICAgdGFibGVCaXRtYXBTaXplID0gZ2V0U3RhbmRhcmRUYWJsZSgxKTsKICB9CgogIGlmIChkaWN0aW9uYXJ5LmFnZ3JlZ2F0aW9uSW5zdGFuY2VzU2VsZWN0b3IpIHsKICAgIHRhYmxlQWdncmVnYXRlSW5zdGFuY2VzID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogIH0gZWxzZSB7CiAgICB0YWJsZUFnZ3JlZ2F0ZUluc3RhbmNlcyA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgfQoKICByZXR1cm4gewogICAgdGFibGVEZWx0YUhlaWdodCwKICAgIHRhYmxlRGVsdGFXaWR0aCwKICAgIHRhYmxlQml0bWFwU2l6ZSwKICAgIHRhYmxlQWdncmVnYXRlSW5zdGFuY2VzCiAgfTsKfQoKZnVuY3Rpb24gcmVhZFVuY29tcHJlc3NlZEJpdG1hcChyZWFkZXIsIHdpZHRoLCBoZWlnaHQpIHsKICBjb25zdCBiaXRtYXAgPSBbXTsKCiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgY29uc3Qgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogICAgYml0bWFwLnB1c2gocm93KTsKCiAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgcm93W3hdID0gcmVhZGVyLnJlYWRCaXQoKTsKICAgIH0KCiAgICByZWFkZXIuYnl0ZUFsaWduKCk7CiAgfQoKICByZXR1cm4gYml0bWFwOwp9CgpmdW5jdGlvbiBkZWNvZGVNTVJCaXRtYXAoaW5wdXQsIHdpZHRoLCBoZWlnaHQsIGVuZE9mQmxvY2spIHsKICBjb25zdCBwYXJhbXMgPSB7CiAgICBLOiAtMSwKICAgIENvbHVtbnM6IHdpZHRoLAogICAgUm93czogaGVpZ2h0LAogICAgQmxhY2tJczE6IHRydWUsCiAgICBFbmRPZkJsb2NrOiBlbmRPZkJsb2NrCiAgfTsKICBjb25zdCBkZWNvZGVyID0gbmV3IF9jY2l0dC5DQ0lUVEZheERlY29kZXIoaW5wdXQsIHBhcmFtcyk7CiAgY29uc3QgYml0bWFwID0gW107CiAgbGV0IGN1cnJlbnRCeXRlLAogICAgICBlb2YgPSBmYWxzZTsKCiAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgY29uc3Qgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogICAgYml0bWFwLnB1c2gocm93KTsKICAgIGxldCBzaGlmdCA9IC0xOwoKICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBpZiAoc2hpZnQgPCAwKSB7CiAgICAgICAgY3VycmVudEJ5dGUgPSBkZWNvZGVyLnJlYWROZXh0Q2hhcigpOwoKICAgICAgICBpZiAoY3VycmVudEJ5dGUgPT09IC0xKSB7CiAgICAgICAgICBjdXJyZW50Qnl0ZSA9IDA7CiAgICAgICAgICBlb2YgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgc2hpZnQgPSA3OwogICAgICB9CgogICAgICByb3dbeF0gPSBjdXJyZW50Qnl0ZSA+PiBzaGlmdCAmIDE7CiAgICAgIHNoaWZ0LS07CiAgICB9CiAgfQoKICBpZiAoZW5kT2ZCbG9jayAmJiAhZW9mKSB7CiAgICBjb25zdCBsb29rRm9yRU9GTGltaXQgPSA1OwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9va0ZvckVPRkxpbWl0OyBpKyspIHsKICAgICAgaWYgKGRlY29kZXIucmVhZE5leHRDaGFyKCkgPT09IC0xKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBiaXRtYXA7Cn0KCmNsYXNzIEpiaWcySW1hZ2UgewogIHBhcnNlQ2h1bmtzKGNodW5rcykgewogICAgcmV0dXJuIHBhcnNlSmJpZzJDaHVua3MoY2h1bmtzKTsKICB9CgogIHBhcnNlKGRhdGEpIHsKICAgIHRocm93IG5ldyBFcnJvcigiTm90IGltcGxlbWVudGVkOiBKYmlnMkltYWdlLnBhcnNlIik7CiAgfQoKfQoKZXhwb3J0cy5KYmlnMkltYWdlID0gSmJpZzJJbWFnZTsKCi8qKiovIH0pLAovKiAyNiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkFyaXRobWV0aWNEZWNvZGVyID0gdm9pZCAwOwpjb25zdCBRZVRhYmxlID0gW3sKICBxZTogMHg1NjAxLAogIG5tcHM6IDEsCiAgbmxwczogMSwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHgzNDAxLAogIG5tcHM6IDIsCiAgbmxwczogNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxODAxLAogIG5tcHM6IDMsCiAgbmxwczogOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDQsCiAgbmxwczogMTIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDUyMSwKICBubXBzOiA1LAogIG5scHM6IDI5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAyMjEsCiAgbm1wczogMzgsCiAgbmxwczogMzMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiA3LAogIG5scHM6IDYsCiAgc3dpdGNoRmxhZzogMQp9LCB7CiAgcWU6IDB4NTQwMSwKICBubXBzOiA4LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDQ4MDEsCiAgbm1wczogOSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDEwLAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDMwMDEsCiAgbm1wczogMTEsCiAgbmxwczogMTcsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjQwMSwKICBubXBzOiAxMiwKICBubHBzOiAxOCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDEzLAogIG5scHM6IDIwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE2MDEsCiAgbm1wczogMjksCiAgbmxwczogMjEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiAxNSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHg1NDAxLAogIG5tcHM6IDE2LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDUxMDEsCiAgbm1wczogMTcsCiAgbmxwczogMTUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NDgwMSwKICBubXBzOiAxOCwKICBubHBzOiAxNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDE5LAogIG5scHM6IDE3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDM0MDEsCiAgbm1wczogMjAsCiAgbmxwczogMTgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MzAwMSwKICBubXBzOiAyMSwKICBubHBzOiAxOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgyODAxLAogIG5tcHM6IDIyLAogIG5scHM6IDE5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDI0MDEsCiAgbm1wczogMjMsCiAgbmxwczogMjAsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjIwMSwKICBubXBzOiAyNCwKICBubHBzOiAyMSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDI1LAogIG5scHM6IDIyLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE4MDEsCiAgbm1wczogMjYsCiAgbmxwczogMjMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTYwMSwKICBubXBzOiAyNywKICBubHBzOiAyNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxNDAxLAogIG5tcHM6IDI4LAogIG5scHM6IDI1LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDEyMDEsCiAgbm1wczogMjksCiAgbmxwczogMjYsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTEwMSwKICBubXBzOiAzMCwKICBubHBzOiAyNywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDMxLAogIG5scHM6IDI4LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA5YzEsCiAgbm1wczogMzIsCiAgbmxwczogMjksCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDhhMSwKICBubXBzOiAzMywKICBubHBzOiAzMCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwNTIxLAogIG5tcHM6IDM0LAogIG5scHM6IDMxLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA0NDEsCiAgbm1wczogMzUsCiAgbmxwczogMzIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDJhMSwKICBubXBzOiAzNiwKICBubHBzOiAzMywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMjIxLAogIG5tcHM6IDM3LAogIG5scHM6IDM0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAxNDEsCiAgbm1wczogMzgsCiAgbmxwczogMzUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDExMSwKICBubXBzOiAzOSwKICBubHBzOiAzNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDg1LAogIG5tcHM6IDQwLAogIG5scHM6IDM3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwNDksCiAgbm1wczogNDEsCiAgbmxwczogMzgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAyNSwKICBubXBzOiA0MiwKICBubHBzOiAzOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDE1LAogIG5tcHM6IDQzLAogIG5scHM6IDQwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwMDksCiAgbm1wczogNDQsCiAgbmxwczogNDEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAwNSwKICBubXBzOiA0NSwKICBubHBzOiA0MiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDAxLAogIG5tcHM6IDQ1LAogIG5scHM6IDQzLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDU2MDEsCiAgbm1wczogNDYsCiAgbmxwczogNDYsCiAgc3dpdGNoRmxhZzogMAp9XTsKCmNsYXNzIEFyaXRobWV0aWNEZWNvZGVyIHsKICBjb25zdHJ1Y3RvcihkYXRhLCBzdGFydCwgZW5kKSB7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5icCA9IHN0YXJ0OwogICAgdGhpcy5kYXRhRW5kID0gZW5kOwogICAgdGhpcy5jaGlnaCA9IGRhdGFbc3RhcnRdOwogICAgdGhpcy5jbG93ID0gMDsKICAgIHRoaXMuYnl0ZUluKCk7CiAgICB0aGlzLmNoaWdoID0gdGhpcy5jaGlnaCA8PCA3ICYgMHhmZmZmIHwgdGhpcy5jbG93ID4+IDkgJiAweDdmOwogICAgdGhpcy5jbG93ID0gdGhpcy5jbG93IDw8IDcgJiAweGZmZmY7CiAgICB0aGlzLmN0IC09IDc7CiAgICB0aGlzLmEgPSAweDgwMDA7CiAgfQoKICBieXRlSW4oKSB7CiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgbGV0IGJwID0gdGhpcy5icDsKCiAgICBpZiAoZGF0YVticF0gPT09IDB4ZmYpIHsKICAgICAgaWYgKGRhdGFbYnAgKyAxXSA+IDB4OGYpIHsKICAgICAgICB0aGlzLmNsb3cgKz0gMHhmZjAwOwogICAgICAgIHRoaXMuY3QgPSA4OwogICAgICB9IGVsc2UgewogICAgICAgIGJwKys7CiAgICAgICAgdGhpcy5jbG93ICs9IGRhdGFbYnBdIDw8IDk7CiAgICAgICAgdGhpcy5jdCA9IDc7CiAgICAgICAgdGhpcy5icCA9IGJwOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBicCsrOwogICAgICB0aGlzLmNsb3cgKz0gYnAgPCB0aGlzLmRhdGFFbmQgPyBkYXRhW2JwXSA8PCA4IDogMHhmZjAwOwogICAgICB0aGlzLmN0ID0gODsKICAgICAgdGhpcy5icCA9IGJwOwogICAgfQoKICAgIGlmICh0aGlzLmNsb3cgPiAweGZmZmYpIHsKICAgICAgdGhpcy5jaGlnaCArPSB0aGlzLmNsb3cgPj4gMTY7CiAgICAgIHRoaXMuY2xvdyAmPSAweGZmZmY7CiAgICB9CiAgfQoKICByZWFkQml0KGNvbnRleHRzLCBwb3MpIHsKICAgIGxldCBjeF9pbmRleCA9IGNvbnRleHRzW3Bvc10gPj4gMSwKICAgICAgICBjeF9tcHMgPSBjb250ZXh0c1twb3NdICYgMTsKICAgIGNvbnN0IHFlVGFibGVJY3ggPSBRZVRhYmxlW2N4X2luZGV4XTsKICAgIGNvbnN0IHFlSWN4ID0gcWVUYWJsZUljeC5xZTsKICAgIGxldCBkOwogICAgbGV0IGEgPSB0aGlzLmEgLSBxZUljeDsKCiAgICBpZiAodGhpcy5jaGlnaCA8IHFlSWN4KSB7CiAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICBhID0gcWVJY3g7CiAgICAgICAgZCA9IGN4X21wczsKICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubm1wczsKICAgICAgfSBlbHNlIHsKICAgICAgICBhID0gcWVJY3g7CiAgICAgICAgZCA9IDEgXiBjeF9tcHM7CgogICAgICAgIGlmIChxZVRhYmxlSWN4LnN3aXRjaEZsYWcgPT09IDEpIHsKICAgICAgICAgIGN4X21wcyA9IGQ7CiAgICAgICAgfQoKICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubmxwczsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jaGlnaCAtPSBxZUljeDsKCiAgICAgIGlmICgoYSAmIDB4ODAwMCkgIT09IDApIHsKICAgICAgICB0aGlzLmEgPSBhOwogICAgICAgIHJldHVybiBjeF9tcHM7CiAgICAgIH0KCiAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICBkID0gMSBeIGN4X21wczsKCiAgICAgICAgaWYgKHFlVGFibGVJY3guc3dpdGNoRmxhZyA9PT0gMSkgewogICAgICAgICAgY3hfbXBzID0gZDsKICAgICAgICB9CgogICAgICAgIGN4X2luZGV4ID0gcWVUYWJsZUljeC5ubHBzOwogICAgICB9IGVsc2UgewogICAgICAgIGQgPSBjeF9tcHM7CiAgICAgICAgY3hfaW5kZXggPSBxZVRhYmxlSWN4Lm5tcHM7CiAgICAgIH0KICAgIH0KCiAgICBkbyB7CiAgICAgIGlmICh0aGlzLmN0ID09PSAwKSB7CiAgICAgICAgdGhpcy5ieXRlSW4oKTsKICAgICAgfQoKICAgICAgYSA8PD0gMTsKICAgICAgdGhpcy5jaGlnaCA9IHRoaXMuY2hpZ2ggPDwgMSAmIDB4ZmZmZiB8IHRoaXMuY2xvdyA+PiAxNSAmIDE7CiAgICAgIHRoaXMuY2xvdyA9IHRoaXMuY2xvdyA8PCAxICYgMHhmZmZmOwogICAgICB0aGlzLmN0LS07CiAgICB9IHdoaWxlICgoYSAmIDB4ODAwMCkgPT09IDApOwoKICAgIHRoaXMuYSA9IGE7CiAgICBjb250ZXh0c1twb3NdID0gY3hfaW5kZXggPDwgMSB8IGN4X21wczsKICAgIHJldHVybiBkOwogIH0KCn0KCmV4cG9ydHMuQXJpdGhtZXRpY0RlY29kZXIgPSBBcml0aG1ldGljRGVjb2RlcjsKCi8qKiovIH0pLAovKiAyNyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkpwZWdTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2pwZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjgpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIEpwZWdTdHJlYW0gZXh0ZW5kcyBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0cmVhbSwgbWF5YmVMZW5ndGgsIHBhcmFtcykgewogICAgbGV0IGNoOwoKICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSAhPT0gLTEpIHsKICAgICAgaWYgKGNoID09PSAweGZmKSB7CiAgICAgICAgc3RyZWFtLnNraXAoLTEpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHJlYW0gPSBzdHJlYW07CiAgICB0aGlzLmRpY3QgPSBzdHJlYW0uZGljdDsKICAgIHRoaXMubWF5YmVMZW5ndGggPSBtYXliZUxlbmd0aDsKICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwogIH0KCiAgZ2V0IGJ5dGVzKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJieXRlcyIsIHRoaXMuc3RyZWFtLmdldEJ5dGVzKHRoaXMubWF5YmVMZW5ndGgpKTsKICB9CgogIGVuc3VyZUJ1ZmZlcihyZXF1ZXN0ZWQpIHt9CgogIHJlYWRCbG9jaygpIHsKICAgIGlmICh0aGlzLmVvZikgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QganBlZ09wdGlvbnMgPSB7CiAgICAgIGRlY29kZVRyYW5zZm9ybTogdW5kZWZpbmVkLAogICAgICBjb2xvclRyYW5zZm9ybTogdW5kZWZpbmVkCiAgICB9OwogICAgY29uc3QgZGVjb2RlQXJyID0gdGhpcy5kaWN0LmdldEFycmF5KCJEIiwgIkRlY29kZSIpOwoKICAgIGlmICh0aGlzLmZvcmNlUkdCICYmIEFycmF5LmlzQXJyYXkoZGVjb2RlQXJyKSkgewogICAgICBjb25zdCBiaXRzUGVyQ29tcG9uZW50ID0gdGhpcy5kaWN0LmdldCgiQlBDIiwgIkJpdHNQZXJDb21wb25lbnQiKSB8fCA4OwogICAgICBjb25zdCBkZWNvZGVBcnJMZW5ndGggPSBkZWNvZGVBcnIubGVuZ3RoOwogICAgICBjb25zdCB0cmFuc2Zvcm0gPSBuZXcgSW50MzJBcnJheShkZWNvZGVBcnJMZW5ndGgpOwogICAgICBsZXQgdHJhbnNmb3JtTmVlZGVkID0gZmFsc2U7CiAgICAgIGNvbnN0IG1heFZhbHVlID0gKDEgPDwgYml0c1BlckNvbXBvbmVudCkgLSAxOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZWNvZGVBcnJMZW5ndGg7IGkgKz0gMikgewogICAgICAgIHRyYW5zZm9ybVtpXSA9IChkZWNvZGVBcnJbaSArIDFdIC0gZGVjb2RlQXJyW2ldKSAqIDI1NiB8IDA7CiAgICAgICAgdHJhbnNmb3JtW2kgKyAxXSA9IGRlY29kZUFycltpXSAqIG1heFZhbHVlIHwgMDsKCiAgICAgICAgaWYgKHRyYW5zZm9ybVtpXSAhPT0gMjU2IHx8IHRyYW5zZm9ybVtpICsgMV0gIT09IDApIHsKICAgICAgICAgIHRyYW5zZm9ybU5lZWRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHJhbnNmb3JtTmVlZGVkKSB7CiAgICAgICAganBlZ09wdGlvbnMuZGVjb2RlVHJhbnNmb3JtID0gdHJhbnNmb3JtOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMucGFyYW1zIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBjb2xvclRyYW5zZm9ybSA9IHRoaXMucGFyYW1zLmdldCgiQ29sb3JUcmFuc2Zvcm0iKTsKCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGNvbG9yVHJhbnNmb3JtKSkgewogICAgICAgIGpwZWdPcHRpb25zLmNvbG9yVHJhbnNmb3JtID0gY29sb3JUcmFuc2Zvcm07CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBqcGVnSW1hZ2UgPSBuZXcgX2pwZy5KcGVnSW1hZ2UoanBlZ09wdGlvbnMpOwogICAganBlZ0ltYWdlLnBhcnNlKHRoaXMuYnl0ZXMpOwogICAgY29uc3QgZGF0YSA9IGpwZWdJbWFnZS5nZXREYXRhKHsKICAgICAgd2lkdGg6IHRoaXMuZHJhd1dpZHRoLAogICAgICBoZWlnaHQ6IHRoaXMuZHJhd0hlaWdodCwKICAgICAgZm9yY2VSR0I6IHRoaXMuZm9yY2VSR0IsCiAgICAgIGlzU291cmNlUERGOiB0cnVlCiAgICB9KTsKICAgIHRoaXMuYnVmZmVyID0gZGF0YTsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICB0aGlzLmVvZiA9IHRydWU7CiAgfQoKfQoKZXhwb3J0cy5KcGVnU3RyZWFtID0gSnBlZ1N0cmVhbTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkpwZWdJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKY2xhc3MgSnBlZ0Vycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSlBFRyBlcnJvcjogJHttc2d9YCwgIkpwZWdFcnJvciIpOwogIH0KCn0KCmNsYXNzIEROTE1hcmtlckVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobWVzc2FnZSwgc2NhbkxpbmVzKSB7CiAgICBzdXBlcihtZXNzYWdlLCAiRE5MTWFya2VyRXJyb3IiKTsKICAgIHRoaXMuc2NhbkxpbmVzID0gc2NhbkxpbmVzOwogIH0KCn0KCmNsYXNzIEVPSU1hcmtlckVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihtc2csICJFT0lNYXJrZXJFcnJvciIpOwogIH0KCn0KCmNvbnN0IGRjdFppZ1phZyA9IG5ldyBVaW50OEFycmF5KFswLCAxLCA4LCAxNiwgOSwgMiwgMywgMTAsIDE3LCAyNCwgMzIsIDI1LCAxOCwgMTEsIDQsIDUsIDEyLCAxOSwgMjYsIDMzLCA0MCwgNDgsIDQxLCAzNCwgMjcsIDIwLCAxMywgNiwgNywgMTQsIDIxLCAyOCwgMzUsIDQyLCA0OSwgNTYsIDU3LCA1MCwgNDMsIDM2LCAyOSwgMjIsIDE1LCAyMywgMzAsIDM3LCA0NCwgNTEsIDU4LCA1OSwgNTIsIDQ1LCAzOCwgMzEsIDM5LCA0NiwgNTMsIDYwLCA2MSwgNTQsIDQ3LCA1NSwgNjIsIDYzXSk7CmNvbnN0IGRjdENvczEgPSA0MDE3Owpjb25zdCBkY3RTaW4xID0gNzk5Owpjb25zdCBkY3RDb3MzID0gMzQwNjsKY29uc3QgZGN0U2luMyA9IDIyNzY7CmNvbnN0IGRjdENvczYgPSAxNTY3Owpjb25zdCBkY3RTaW42ID0gMzc4NDsKY29uc3QgZGN0U3FydDIgPSA1NzkzOwpjb25zdCBkY3RTcXJ0MWQyID0gMjg5NjsKCmZ1bmN0aW9uIGJ1aWxkSHVmZm1hblRhYmxlKGNvZGVMZW5ndGhzLCB2YWx1ZXMpIHsKICBsZXQgayA9IDAsCiAgICAgIGksCiAgICAgIGosCiAgICAgIGxlbmd0aCA9IDE2OwoKICB3aGlsZSAobGVuZ3RoID4gMCAmJiAhY29kZUxlbmd0aHNbbGVuZ3RoIC0gMV0pIHsKICAgIGxlbmd0aC0tOwogIH0KCiAgY29uc3QgY29kZSA9IFt7CiAgICBjaGlsZHJlbjogW10sCiAgICBpbmRleDogMAogIH1dOwogIGxldCBwID0gY29kZVswXSwKICAgICAgcTsKCiAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICBmb3IgKGogPSAwOyBqIDwgY29kZUxlbmd0aHNbaV07IGorKykgewogICAgICBwID0gY29kZS5wb3AoKTsKICAgICAgcC5jaGlsZHJlbltwLmluZGV4XSA9IHZhbHVlc1trXTsKCiAgICAgIHdoaWxlIChwLmluZGV4ID4gMCkgewogICAgICAgIHAgPSBjb2RlLnBvcCgpOwogICAgICB9CgogICAgICBwLmluZGV4Kys7CiAgICAgIGNvZGUucHVzaChwKTsKCiAgICAgIHdoaWxlIChjb2RlLmxlbmd0aCA8PSBpKSB7CiAgICAgICAgY29kZS5wdXNoKHEgPSB7CiAgICAgICAgICBjaGlsZHJlbjogW10sCiAgICAgICAgICBpbmRleDogMAogICAgICAgIH0pOwogICAgICAgIHAuY2hpbGRyZW5bcC5pbmRleF0gPSBxLmNoaWxkcmVuOwogICAgICAgIHAgPSBxOwogICAgICB9CgogICAgICBrKys7CiAgICB9CgogICAgaWYgKGkgKyAxIDwgbGVuZ3RoKSB7CiAgICAgIGNvZGUucHVzaChxID0gewogICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICBpbmRleDogMAogICAgICB9KTsKICAgICAgcC5jaGlsZHJlbltwLmluZGV4XSA9IHEuY2hpbGRyZW47CiAgICAgIHAgPSBxOwogICAgfQogIH0KCiAgcmV0dXJuIGNvZGVbMF0uY2hpbGRyZW47Cn0KCmZ1bmN0aW9uIGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgcm93LCBjb2wpIHsKICByZXR1cm4gNjQgKiAoKGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lICsgMSkgKiByb3cgKyBjb2wpOwp9CgpmdW5jdGlvbiBkZWNvZGVTY2FuKGRhdGEsIG9mZnNldCwgZnJhbWUsIGNvbXBvbmVudHMsIHJlc2V0SW50ZXJ2YWwsIHNwZWN0cmFsU3RhcnQsIHNwZWN0cmFsRW5kLCBzdWNjZXNzaXZlUHJldiwgc3VjY2Vzc2l2ZSwgcGFyc2VETkxNYXJrZXIgPSBmYWxzZSkgewogIGNvbnN0IG1jdXNQZXJMaW5lID0gZnJhbWUubWN1c1BlckxpbmU7CiAgY29uc3QgcHJvZ3Jlc3NpdmUgPSBmcmFtZS5wcm9ncmVzc2l2ZTsKICBjb25zdCBzdGFydE9mZnNldCA9IG9mZnNldDsKICBsZXQgYml0c0RhdGEgPSAwLAogICAgICBiaXRzQ291bnQgPSAwOwoKICBmdW5jdGlvbiByZWFkQml0KCkgewogICAgaWYgKGJpdHNDb3VudCA+IDApIHsKICAgICAgYml0c0NvdW50LS07CiAgICAgIHJldHVybiBiaXRzRGF0YSA+PiBiaXRzQ291bnQgJiAxOwogICAgfQoKICAgIGJpdHNEYXRhID0gZGF0YVtvZmZzZXQrK107CgogICAgaWYgKGJpdHNEYXRhID09PSAweGZmKSB7CiAgICAgIGNvbnN0IG5leHRCeXRlID0gZGF0YVtvZmZzZXQrK107CgogICAgICBpZiAobmV4dEJ5dGUpIHsKICAgICAgICBpZiAobmV4dEJ5dGUgPT09IDB4ZGMgJiYgcGFyc2VETkxNYXJrZXIpIHsKICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgY29uc3Qgc2NhbkxpbmVzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKCiAgICAgICAgICBpZiAoc2NhbkxpbmVzID4gMCAmJiBzY2FuTGluZXMgIT09IGZyYW1lLnNjYW5MaW5lcykgewogICAgICAgICAgICB0aHJvdyBuZXcgRE5MTWFya2VyRXJyb3IoIkZvdW5kIEROTCBtYXJrZXIgKDB4RkZEQykgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEiLCBzY2FuTGluZXMpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAobmV4dEJ5dGUgPT09IDB4ZDkpIHsKICAgICAgICAgIGlmIChwYXJzZUROTE1hcmtlcikgewogICAgICAgICAgICBjb25zdCBtYXliZVNjYW5MaW5lcyA9IGJsb2NrUm93ICogKGZyYW1lLnByZWNpc2lvbiA9PT0gOCA/IDggOiAwKTsKCiAgICAgICAgICAgIGlmIChtYXliZVNjYW5MaW5lcyA+IDAgJiYgTWF0aC5yb3VuZChmcmFtZS5zY2FuTGluZXMgLyBtYXliZVNjYW5MaW5lcykgPj0gMTApIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRE5MTWFya2VyRXJyb3IoIkZvdW5kIEVPSSBtYXJrZXIgKDB4RkZEOSkgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEsICIgKyAicG9zc2libHkgY2F1c2VkIGJ5IGluY29ycmVjdCBgc2NhbkxpbmVzYCBwYXJhbWV0ZXIiLCBtYXliZVNjYW5MaW5lcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyBuZXcgRU9JTWFya2VyRXJyb3IoIkZvdW5kIEVPSSBtYXJrZXIgKDB4RkZEOSkgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEiKTsKICAgICAgICB9CgogICAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoYHVuZXhwZWN0ZWQgbWFya2VyICR7KGJpdHNEYXRhIDw8IDggfCBuZXh0Qnl0ZSkudG9TdHJpbmcoMTYpfWApOwogICAgICB9CiAgICB9CgogICAgYml0c0NvdW50ID0gNzsKICAgIHJldHVybiBiaXRzRGF0YSA+Pj4gNzsKICB9CgogIGZ1bmN0aW9uIGRlY29kZUh1ZmZtYW4odHJlZSkgewogICAgbGV0IG5vZGUgPSB0cmVlOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIG5vZGUgPSBub2RlW3JlYWRCaXQoKV07CgogICAgICBzd2l0Y2ggKHR5cGVvZiBub2RlKSB7CiAgICAgICAgY2FzZSAibnVtYmVyIjoKICAgICAgICAgIHJldHVybiBub2RlOwoKICAgICAgICBjYXNlICJvYmplY3QiOgogICAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoImludmFsaWQgaHVmZm1hbiBzZXF1ZW5jZSIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVjZWl2ZShsZW5ndGgpIHsKICAgIGxldCBuID0gMDsKCiAgICB3aGlsZSAobGVuZ3RoID4gMCkgewogICAgICBuID0gbiA8PCAxIHwgcmVhZEJpdCgpOwogICAgICBsZW5ndGgtLTsKICAgIH0KCiAgICByZXR1cm4gbjsKICB9CgogIGZ1bmN0aW9uIHJlY2VpdmVBbmRFeHRlbmQobGVuZ3RoKSB7CiAgICBpZiAobGVuZ3RoID09PSAxKSB7CiAgICAgIHJldHVybiByZWFkQml0KCkgPT09IDEgPyAxIDogLTE7CiAgICB9CgogICAgY29uc3QgbiA9IHJlY2VpdmUobGVuZ3RoKTsKCiAgICBpZiAobiA+PSAxIDw8IGxlbmd0aCAtIDEpIHsKICAgICAgcmV0dXJuIG47CiAgICB9CgogICAgcmV0dXJuIG4gKyAoLTEgPDwgbGVuZ3RoKSArIDE7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVCYXNlbGluZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICBjb25zdCB0ID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlREMpOwogICAgY29uc3QgZGlmZiA9IHQgPT09IDAgPyAwIDogcmVjZWl2ZUFuZEV4dGVuZCh0KTsKICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbYmxvY2tPZmZzZXRdID0gY29tcG9uZW50LnByZWQgKz0gZGlmZjsKICAgIGxldCBrID0gMTsKCiAgICB3aGlsZSAoayA8IDY0KSB7CiAgICAgIGNvbnN0IHJzID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlQUMpOwogICAgICBjb25zdCBzID0gcnMgJiAxNSwKICAgICAgICAgICAgciA9IHJzID4+IDQ7CgogICAgICBpZiAocyA9PT0gMCkgewogICAgICAgIGlmIChyIDwgMTUpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgayArPSAxNjsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgayArPSByOwogICAgICBjb25zdCB6ID0gZGN0WmlnWmFnW2tdOwogICAgICBjb21wb25lbnQuYmxvY2tEYXRhW2Jsb2NrT2Zmc2V0ICsgel0gPSByZWNlaXZlQW5kRXh0ZW5kKHMpOwogICAgICBrKys7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVEQ0ZpcnN0KGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpIHsKICAgIGNvbnN0IHQgPSBkZWNvZGVIdWZmbWFuKGNvbXBvbmVudC5odWZmbWFuVGFibGVEQyk7CiAgICBjb25zdCBkaWZmID0gdCA9PT0gMCA/IDAgOiByZWNlaXZlQW5kRXh0ZW5kKHQpIDw8IHN1Y2Nlc3NpdmU7CiAgICBjb21wb25lbnQuYmxvY2tEYXRhW2Jsb2NrT2Zmc2V0XSA9IGNvbXBvbmVudC5wcmVkICs9IGRpZmY7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVEQ1N1Y2Nlc3NpdmUoY29tcG9uZW50LCBibG9ja09mZnNldCkgewogICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldF0gfD0gcmVhZEJpdCgpIDw8IHN1Y2Nlc3NpdmU7CiAgfQoKICBsZXQgZW9icnVuID0gMDsKCiAgZnVuY3Rpb24gZGVjb2RlQUNGaXJzdChjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICBpZiAoZW9icnVuID4gMCkgewogICAgICBlb2JydW4tLTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBrID0gc3BlY3RyYWxTdGFydDsKICAgIGNvbnN0IGUgPSBzcGVjdHJhbEVuZDsKCiAgICB3aGlsZSAoayA8PSBlKSB7CiAgICAgIGNvbnN0IHJzID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlQUMpOwogICAgICBjb25zdCBzID0gcnMgJiAxNSwKICAgICAgICAgICAgciA9IHJzID4+IDQ7CgogICAgICBpZiAocyA9PT0gMCkgewogICAgICAgIGlmIChyIDwgMTUpIHsKICAgICAgICAgIGVvYnJ1biA9IHJlY2VpdmUocikgKyAoMSA8PCByKSAtIDE7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGsgKz0gMTY7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGsgKz0gcjsKICAgICAgY29uc3QgeiA9IGRjdFppZ1phZ1trXTsKICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldCArIHpdID0gcmVjZWl2ZUFuZEV4dGVuZChzKSAqICgxIDw8IHN1Y2Nlc3NpdmUpOwogICAgICBrKys7CiAgICB9CiAgfQoKICBsZXQgc3VjY2Vzc2l2ZUFDU3RhdGUgPSAwLAogICAgICBzdWNjZXNzaXZlQUNOZXh0VmFsdWU7CgogIGZ1bmN0aW9uIGRlY29kZUFDU3VjY2Vzc2l2ZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICBsZXQgayA9IHNwZWN0cmFsU3RhcnQ7CiAgICBjb25zdCBlID0gc3BlY3RyYWxFbmQ7CiAgICBsZXQgciA9IDA7CiAgICBsZXQgczsKICAgIGxldCByczsKCiAgICB3aGlsZSAoayA8PSBlKSB7CiAgICAgIGNvbnN0IG9mZnNldFogPSBibG9ja09mZnNldCArIGRjdFppZ1phZ1trXTsKICAgICAgY29uc3Qgc2lnbiA9IGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0gPCAwID8gLTEgOiAxOwoKICAgICAgc3dpdGNoIChzdWNjZXNzaXZlQUNTdGF0ZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJzID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlQUMpOwogICAgICAgICAgcyA9IHJzICYgMTU7CiAgICAgICAgICByID0gcnMgPj4gNDsKCiAgICAgICAgICBpZiAocyA9PT0gMCkgewogICAgICAgICAgICBpZiAociA8IDE1KSB7CiAgICAgICAgICAgICAgZW9icnVuID0gcmVjZWl2ZShyKSArICgxIDw8IHIpOwogICAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gNDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByID0gMTY7CiAgICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAocyAhPT0gMSkgewogICAgICAgICAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoImludmFsaWQgQUNuIGVuY29kaW5nIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ05leHRWYWx1ZSA9IHJlY2VpdmVBbmRFeHRlbmQocyk7CiAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gciA/IDIgOiAzOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaWYgKGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0pIHsKICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHItLTsKCiAgICAgICAgICAgIGlmIChyID09PSAwKSB7CiAgICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSBzdWNjZXNzaXZlQUNTdGF0ZSA9PT0gMiA/IDMgOiAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGlmIChjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdKSB7CiAgICAgICAgICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0gKz0gc2lnbiAqIChyZWFkQml0KCkgPDwgc3VjY2Vzc2l2ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdID0gc3VjY2Vzc2l2ZUFDTmV4dFZhbHVlIDw8IHN1Y2Nlc3NpdmU7CiAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA0OgogICAgICAgICAgaWYgKGNvbXBvbmVudC5ibG9ja0RhdGFbb2Zmc2V0Wl0pIHsKICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaysrOwogICAgfQoKICAgIGlmIChzdWNjZXNzaXZlQUNTdGF0ZSA9PT0gNCkgewogICAgICBlb2JydW4tLTsKCiAgICAgIGlmIChlb2JydW4gPT09IDApIHsKICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IDA7CiAgICAgIH0KICAgIH0KICB9CgogIGxldCBibG9ja1JvdyA9IDA7CgogIGZ1bmN0aW9uIGRlY29kZU1jdShjb21wb25lbnQsIGRlY29kZSwgbWN1LCByb3csIGNvbCkgewogICAgY29uc3QgbWN1Um93ID0gbWN1IC8gbWN1c1BlckxpbmUgfCAwOwogICAgY29uc3QgbWN1Q29sID0gbWN1ICUgbWN1c1BlckxpbmU7CiAgICBibG9ja1JvdyA9IG1jdVJvdyAqIGNvbXBvbmVudC52ICsgcm93OwogICAgY29uc3QgYmxvY2tDb2wgPSBtY3VDb2wgKiBjb21wb25lbnQuaCArIGNvbDsKICAgIGNvbnN0IGJsb2NrT2Zmc2V0ID0gZ2V0QmxvY2tCdWZmZXJPZmZzZXQoY29tcG9uZW50LCBibG9ja1JvdywgYmxvY2tDb2wpOwogICAgZGVjb2RlKGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlQmxvY2soY29tcG9uZW50LCBkZWNvZGUsIG1jdSkgewogICAgYmxvY2tSb3cgPSBtY3UgLyBjb21wb25lbnQuYmxvY2tzUGVyTGluZSB8IDA7CiAgICBjb25zdCBibG9ja0NvbCA9IG1jdSAlIGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lOwogICAgY29uc3QgYmxvY2tPZmZzZXQgPSBnZXRCbG9ja0J1ZmZlck9mZnNldChjb21wb25lbnQsIGJsb2NrUm93LCBibG9ja0NvbCk7CiAgICBkZWNvZGUoY29tcG9uZW50LCBibG9ja09mZnNldCk7CiAgfQoKICBjb25zdCBjb21wb25lbnRzTGVuZ3RoID0gY29tcG9uZW50cy5sZW5ndGg7CiAgbGV0IGNvbXBvbmVudCwgaSwgaiwgaywgbjsKICBsZXQgZGVjb2RlRm47CgogIGlmIChwcm9ncmVzc2l2ZSkgewogICAgaWYgKHNwZWN0cmFsU3RhcnQgPT09IDApIHsKICAgICAgZGVjb2RlRm4gPSBzdWNjZXNzaXZlUHJldiA9PT0gMCA/IGRlY29kZURDRmlyc3QgOiBkZWNvZGVEQ1N1Y2Nlc3NpdmU7CiAgICB9IGVsc2UgewogICAgICBkZWNvZGVGbiA9IHN1Y2Nlc3NpdmVQcmV2ID09PSAwID8gZGVjb2RlQUNGaXJzdCA6IGRlY29kZUFDU3VjY2Vzc2l2ZTsKICAgIH0KICB9IGVsc2UgewogICAgZGVjb2RlRm4gPSBkZWNvZGVCYXNlbGluZTsKICB9CgogIGxldCBtY3UgPSAwLAogICAgICBmaWxlTWFya2VyOwogIGxldCBtY3VFeHBlY3RlZDsKCiAgaWYgKGNvbXBvbmVudHNMZW5ndGggPT09IDEpIHsKICAgIG1jdUV4cGVjdGVkID0gY29tcG9uZW50c1swXS5ibG9ja3NQZXJMaW5lICogY29tcG9uZW50c1swXS5ibG9ja3NQZXJDb2x1bW47CiAgfSBlbHNlIHsKICAgIG1jdUV4cGVjdGVkID0gbWN1c1BlckxpbmUgKiBmcmFtZS5tY3VzUGVyQ29sdW1uOwogIH0KCiAgbGV0IGgsIHY7CgogIHdoaWxlIChtY3UgPD0gbWN1RXhwZWN0ZWQpIHsKICAgIGNvbnN0IG1jdVRvUmVhZCA9IHJlc2V0SW50ZXJ2YWwgPyBNYXRoLm1pbihtY3VFeHBlY3RlZCAtIG1jdSwgcmVzZXRJbnRlcnZhbCkgOiBtY3VFeHBlY3RlZDsKCiAgICBpZiAobWN1VG9SZWFkID4gMCkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgY29tcG9uZW50c0xlbmd0aDsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50c1tpXS5wcmVkID0gMDsKICAgICAgfQoKICAgICAgZW9icnVuID0gMDsKCiAgICAgIGlmIChjb21wb25lbnRzTGVuZ3RoID09PSAxKSB7CiAgICAgICAgY29tcG9uZW50ID0gY29tcG9uZW50c1swXTsKCiAgICAgICAgZm9yIChuID0gMDsgbiA8IG1jdVRvUmVhZDsgbisrKSB7CiAgICAgICAgICBkZWNvZGVCbG9jayhjb21wb25lbnQsIGRlY29kZUZuLCBtY3UpOwogICAgICAgICAgbWN1Kys7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobiA9IDA7IG4gPCBtY3VUb1JlYWQ7IG4rKykgewogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudHNMZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldOwogICAgICAgICAgICBoID0gY29tcG9uZW50Lmg7CiAgICAgICAgICAgIHYgPSBjb21wb25lbnQudjsKCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB2OyBqKyspIHsKICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgaDsgaysrKSB7CiAgICAgICAgICAgICAgICBkZWNvZGVNY3UoY29tcG9uZW50LCBkZWNvZGVGbiwgbWN1LCBqLCBrKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBtY3UrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBiaXRzQ291bnQgPSAwOwogICAgZmlsZU1hcmtlciA9IGZpbmROZXh0RmlsZU1hcmtlcihkYXRhLCBvZmZzZXQpOwoKICAgIGlmICghZmlsZU1hcmtlcikgewogICAgICBicmVhazsKICAgIH0KCiAgICBpZiAoZmlsZU1hcmtlci5pbnZhbGlkKSB7CiAgICAgIGNvbnN0IHBhcnRpYWxNc2cgPSBtY3VUb1JlYWQgPiAwID8gInVuZXhwZWN0ZWQiIDogImV4Y2Vzc2l2ZSI7CiAgICAgICgwLCBfdXRpbC53YXJuKShgZGVjb2RlU2NhbiAtICR7cGFydGlhbE1zZ30gTUNVIGRhdGEsIGN1cnJlbnQgbWFya2VyIGlzOiAke2ZpbGVNYXJrZXIuaW52YWxpZH1gKTsKICAgICAgb2Zmc2V0ID0gZmlsZU1hcmtlci5vZmZzZXQ7CiAgICB9CgogICAgaWYgKGZpbGVNYXJrZXIubWFya2VyID49IDB4ZmZkMCAmJiBmaWxlTWFya2VyLm1hcmtlciA8PSAweGZmZDcpIHsKICAgICAgb2Zmc2V0ICs9IDI7CiAgICB9IGVsc2UgewogICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiBvZmZzZXQgLSBzdGFydE9mZnNldDsKfQoKZnVuY3Rpb24gcXVhbnRpemVBbmRJbnZlcnNlKGNvbXBvbmVudCwgYmxvY2tCdWZmZXJPZmZzZXQsIHApIHsKICBjb25zdCBxdCA9IGNvbXBvbmVudC5xdWFudGl6YXRpb25UYWJsZSwKICAgICAgICBibG9ja0RhdGEgPSBjb21wb25lbnQuYmxvY2tEYXRhOwogIGxldCB2MCwgdjEsIHYyLCB2MywgdjQsIHY1LCB2Niwgdjc7CiAgbGV0IHAwLCBwMSwgcDIsIHAzLCBwNCwgcDUsIHA2LCBwNzsKICBsZXQgdDsKCiAgaWYgKCFxdCkgewogICAgdGhyb3cgbmV3IEpwZWdFcnJvcigibWlzc2luZyByZXF1aXJlZCBRdWFudGl6YXRpb24gVGFibGUuIik7CiAgfQoKICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCA2NDsgcm93ICs9IDgpIHsKICAgIHAwID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93XTsKICAgIHAxID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93ICsgMV07CiAgICBwMiA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDJdOwogICAgcDMgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3cgKyAzXTsKICAgIHA0ID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93ICsgNF07CiAgICBwNSA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDVdOwogICAgcDYgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3cgKyA2XTsKICAgIHA3ID0gYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgcm93ICsgN107CiAgICBwMCAqPSBxdFtyb3ddOwoKICAgIGlmICgocDEgfCBwMiB8IHAzIHwgcDQgfCBwNSB8IHA2IHwgcDcpID09PSAwKSB7CiAgICAgIHQgPSBkY3RTcXJ0MiAqIHAwICsgNTEyID4+IDEwOwogICAgICBwW3Jvd10gPSB0OwogICAgICBwW3JvdyArIDFdID0gdDsKICAgICAgcFtyb3cgKyAyXSA9IHQ7CiAgICAgIHBbcm93ICsgM10gPSB0OwogICAgICBwW3JvdyArIDRdID0gdDsKICAgICAgcFtyb3cgKyA1XSA9IHQ7CiAgICAgIHBbcm93ICsgNl0gPSB0OwogICAgICBwW3JvdyArIDddID0gdDsKICAgICAgY29udGludWU7CiAgICB9CgogICAgcDEgKj0gcXRbcm93ICsgMV07CiAgICBwMiAqPSBxdFtyb3cgKyAyXTsKICAgIHAzICo9IHF0W3JvdyArIDNdOwogICAgcDQgKj0gcXRbcm93ICsgNF07CiAgICBwNSAqPSBxdFtyb3cgKyA1XTsKICAgIHA2ICo9IHF0W3JvdyArIDZdOwogICAgcDcgKj0gcXRbcm93ICsgN107CiAgICB2MCA9IGRjdFNxcnQyICogcDAgKyAxMjggPj4gODsKICAgIHYxID0gZGN0U3FydDIgKiBwNCArIDEyOCA+PiA4OwogICAgdjIgPSBwMjsKICAgIHYzID0gcDY7CiAgICB2NCA9IGRjdFNxcnQxZDIgKiAocDEgLSBwNykgKyAxMjggPj4gODsKICAgIHY3ID0gZGN0U3FydDFkMiAqIChwMSArIHA3KSArIDEyOCA+PiA4OwogICAgdjUgPSBwMyA8PCA0OwogICAgdjYgPSBwNSA8PCA0OwogICAgdjAgPSB2MCArIHYxICsgMSA+PiAxOwogICAgdjEgPSB2MCAtIHYxOwogICAgdCA9IHYyICogZGN0U2luNiArIHYzICogZGN0Q29zNiArIDEyOCA+PiA4OwogICAgdjIgPSB2MiAqIGRjdENvczYgLSB2MyAqIGRjdFNpbjYgKyAxMjggPj4gODsKICAgIHYzID0gdDsKICAgIHY0ID0gdjQgKyB2NiArIDEgPj4gMTsKICAgIHY2ID0gdjQgLSB2NjsKICAgIHY3ID0gdjcgKyB2NSArIDEgPj4gMTsKICAgIHY1ID0gdjcgLSB2NTsKICAgIHYwID0gdjAgKyB2MyArIDEgPj4gMTsKICAgIHYzID0gdjAgLSB2MzsKICAgIHYxID0gdjEgKyB2MiArIDEgPj4gMTsKICAgIHYyID0gdjEgLSB2MjsKICAgIHQgPSB2NCAqIGRjdFNpbjMgKyB2NyAqIGRjdENvczMgKyAyMDQ4ID4+IDEyOwogICAgdjQgPSB2NCAqIGRjdENvczMgLSB2NyAqIGRjdFNpbjMgKyAyMDQ4ID4+IDEyOwogICAgdjcgPSB0OwogICAgdCA9IHY1ICogZGN0U2luMSArIHY2ICogZGN0Q29zMSArIDIwNDggPj4gMTI7CiAgICB2NSA9IHY1ICogZGN0Q29zMSAtIHY2ICogZGN0U2luMSArIDIwNDggPj4gMTI7CiAgICB2NiA9IHQ7CiAgICBwW3Jvd10gPSB2MCArIHY3OwogICAgcFtyb3cgKyA3XSA9IHYwIC0gdjc7CiAgICBwW3JvdyArIDFdID0gdjEgKyB2NjsKICAgIHBbcm93ICsgNl0gPSB2MSAtIHY2OwogICAgcFtyb3cgKyAyXSA9IHYyICsgdjU7CiAgICBwW3JvdyArIDVdID0gdjIgLSB2NTsKICAgIHBbcm93ICsgM10gPSB2MyArIHY0OwogICAgcFtyb3cgKyA0XSA9IHYzIC0gdjQ7CiAgfQoKICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyArK2NvbCkgewogICAgcDAgPSBwW2NvbF07CiAgICBwMSA9IHBbY29sICsgOF07CiAgICBwMiA9IHBbY29sICsgMTZdOwogICAgcDMgPSBwW2NvbCArIDI0XTsKICAgIHA0ID0gcFtjb2wgKyAzMl07CiAgICBwNSA9IHBbY29sICsgNDBdOwogICAgcDYgPSBwW2NvbCArIDQ4XTsKICAgIHA3ID0gcFtjb2wgKyA1Nl07CgogICAgaWYgKChwMSB8IHAyIHwgcDMgfCBwNCB8IHA1IHwgcDYgfCBwNykgPT09IDApIHsKICAgICAgdCA9IGRjdFNxcnQyICogcDAgKyA4MTkyID4+IDE0OwoKICAgICAgaWYgKHQgPCAtMjA0MCkgewogICAgICAgIHQgPSAwOwogICAgICB9IGVsc2UgaWYgKHQgPj0gMjAyNCkgewogICAgICAgIHQgPSAyNTU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdCA9IHQgKyAyMDU2ID4+IDQ7CiAgICAgIH0KCiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbF0gPSB0OwogICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA4XSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDE2XSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDI0XSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDMyXSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDQwXSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDQ4XSA9IHQ7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDU2XSA9IHQ7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIHYwID0gZGN0U3FydDIgKiBwMCArIDIwNDggPj4gMTI7CiAgICB2MSA9IGRjdFNxcnQyICogcDQgKyAyMDQ4ID4+IDEyOwogICAgdjIgPSBwMjsKICAgIHYzID0gcDY7CiAgICB2NCA9IGRjdFNxcnQxZDIgKiAocDEgLSBwNykgKyAyMDQ4ID4+IDEyOwogICAgdjcgPSBkY3RTcXJ0MWQyICogKHAxICsgcDcpICsgMjA0OCA+PiAxMjsKICAgIHY1ID0gcDM7CiAgICB2NiA9IHA1OwogICAgdjAgPSAodjAgKyB2MSArIDEgPj4gMSkgKyA0MTEyOwogICAgdjEgPSB2MCAtIHYxOwogICAgdCA9IHYyICogZGN0U2luNiArIHYzICogZGN0Q29zNiArIDIwNDggPj4gMTI7CiAgICB2MiA9IHYyICogZGN0Q29zNiAtIHYzICogZGN0U2luNiArIDIwNDggPj4gMTI7CiAgICB2MyA9IHQ7CiAgICB2NCA9IHY0ICsgdjYgKyAxID4+IDE7CiAgICB2NiA9IHY0IC0gdjY7CiAgICB2NyA9IHY3ICsgdjUgKyAxID4+IDE7CiAgICB2NSA9IHY3IC0gdjU7CiAgICB2MCA9IHYwICsgdjMgKyAxID4+IDE7CiAgICB2MyA9IHYwIC0gdjM7CiAgICB2MSA9IHYxICsgdjIgKyAxID4+IDE7CiAgICB2MiA9IHYxIC0gdjI7CiAgICB0ID0gdjQgKiBkY3RTaW4zICsgdjcgKiBkY3RDb3MzICsgMjA0OCA+PiAxMjsKICAgIHY0ID0gdjQgKiBkY3RDb3MzIC0gdjcgKiBkY3RTaW4zICsgMjA0OCA+PiAxMjsKICAgIHY3ID0gdDsKICAgIHQgPSB2NSAqIGRjdFNpbjEgKyB2NiAqIGRjdENvczEgKyAyMDQ4ID4+IDEyOwogICAgdjUgPSB2NSAqIGRjdENvczEgLSB2NiAqIGRjdFNpbjEgKyAyMDQ4ID4+IDEyOwogICAgdjYgPSB0OwogICAgcDAgPSB2MCArIHY3OwogICAgcDcgPSB2MCAtIHY3OwogICAgcDEgPSB2MSArIHY2OwogICAgcDYgPSB2MSAtIHY2OwogICAgcDIgPSB2MiArIHY1OwogICAgcDUgPSB2MiAtIHY1OwogICAgcDMgPSB2MyArIHY0OwogICAgcDQgPSB2MyAtIHY0OwoKICAgIGlmIChwMCA8IDE2KSB7CiAgICAgIHAwID0gMDsKICAgIH0gZWxzZSBpZiAocDAgPj0gNDA4MCkgewogICAgICBwMCA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHAwID4+PSA0OwogICAgfQoKICAgIGlmIChwMSA8IDE2KSB7CiAgICAgIHAxID0gMDsKICAgIH0gZWxzZSBpZiAocDEgPj0gNDA4MCkgewogICAgICBwMSA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHAxID4+PSA0OwogICAgfQoKICAgIGlmIChwMiA8IDE2KSB7CiAgICAgIHAyID0gMDsKICAgIH0gZWxzZSBpZiAocDIgPj0gNDA4MCkgewogICAgICBwMiA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHAyID4+PSA0OwogICAgfQoKICAgIGlmIChwMyA8IDE2KSB7CiAgICAgIHAzID0gMDsKICAgIH0gZWxzZSBpZiAocDMgPj0gNDA4MCkgewogICAgICBwMyA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHAzID4+PSA0OwogICAgfQoKICAgIGlmIChwNCA8IDE2KSB7CiAgICAgIHA0ID0gMDsKICAgIH0gZWxzZSBpZiAocDQgPj0gNDA4MCkgewogICAgICBwNCA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHA0ID4+PSA0OwogICAgfQoKICAgIGlmIChwNSA8IDE2KSB7CiAgICAgIHA1ID0gMDsKICAgIH0gZWxzZSBpZiAocDUgPj0gNDA4MCkgewogICAgICBwNSA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHA1ID4+PSA0OwogICAgfQoKICAgIGlmIChwNiA8IDE2KSB7CiAgICAgIHA2ID0gMDsKICAgIH0gZWxzZSBpZiAocDYgPj0gNDA4MCkgewogICAgICBwNiA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHA2ID4+PSA0OwogICAgfQoKICAgIGlmIChwNyA8IDE2KSB7CiAgICAgIHA3ID0gMDsKICAgIH0gZWxzZSBpZiAocDcgPj0gNDA4MCkgewogICAgICBwNyA9IDI1NTsKICAgIH0gZWxzZSB7CiAgICAgIHA3ID4+PSA0OwogICAgfQoKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbF0gPSBwMDsKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDhdID0gcDE7CiAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyAxNl0gPSBwMjsKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDI0XSA9IHAzOwogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMzJdID0gcDQ7CiAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA0MF0gPSBwNTsKICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDQ4XSA9IHA2OwogICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNTZdID0gcDc7CiAgfQp9CgpmdW5jdGlvbiBidWlsZENvbXBvbmVudERhdGEoZnJhbWUsIGNvbXBvbmVudCkgewogIGNvbnN0IGJsb2Nrc1BlckxpbmUgPSBjb21wb25lbnQuYmxvY2tzUGVyTGluZTsKICBjb25zdCBibG9ja3NQZXJDb2x1bW4gPSBjb21wb25lbnQuYmxvY2tzUGVyQ29sdW1uOwogIGNvbnN0IGNvbXB1dGF0aW9uQnVmZmVyID0gbmV3IEludDE2QXJyYXkoNjQpOwoKICBmb3IgKGxldCBibG9ja1JvdyA9IDA7IGJsb2NrUm93IDwgYmxvY2tzUGVyQ29sdW1uOyBibG9ja1JvdysrKSB7CiAgICBmb3IgKGxldCBibG9ja0NvbCA9IDA7IGJsb2NrQ29sIDwgYmxvY2tzUGVyTGluZTsgYmxvY2tDb2wrKykgewogICAgICBjb25zdCBvZmZzZXQgPSBnZXRCbG9ja0J1ZmZlck9mZnNldChjb21wb25lbnQsIGJsb2NrUm93LCBibG9ja0NvbCk7CiAgICAgIHF1YW50aXplQW5kSW52ZXJzZShjb21wb25lbnQsIG9mZnNldCwgY29tcHV0YXRpb25CdWZmZXIpOwogICAgfQogIH0KCiAgcmV0dXJuIGNvbXBvbmVudC5ibG9ja0RhdGE7Cn0KCmZ1bmN0aW9uIGZpbmROZXh0RmlsZU1hcmtlcihkYXRhLCBjdXJyZW50UG9zLCBzdGFydFBvcyA9IGN1cnJlbnRQb3MpIHsKICBjb25zdCBtYXhQb3MgPSBkYXRhLmxlbmd0aCAtIDE7CiAgbGV0IG5ld1BvcyA9IHN0YXJ0UG9zIDwgY3VycmVudFBvcyA/IHN0YXJ0UG9zIDogY3VycmVudFBvczsKCiAgaWYgKGN1cnJlbnRQb3MgPj0gbWF4UG9zKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IGN1cnJlbnRNYXJrZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgY3VycmVudFBvcyk7CgogIGlmIChjdXJyZW50TWFya2VyID49IDB4ZmZjMCAmJiBjdXJyZW50TWFya2VyIDw9IDB4ZmZmZSkgewogICAgcmV0dXJuIHsKICAgICAgaW52YWxpZDogbnVsbCwKICAgICAgbWFya2VyOiBjdXJyZW50TWFya2VyLAogICAgICBvZmZzZXQ6IGN1cnJlbnRQb3MKICAgIH07CiAgfQoKICBsZXQgbmV3TWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG5ld1Bvcyk7CgogIHdoaWxlICghKG5ld01hcmtlciA+PSAweGZmYzAgJiYgbmV3TWFya2VyIDw9IDB4ZmZmZSkpIHsKICAgIGlmICgrK25ld1BvcyA+PSBtYXhQb3MpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgbmV3TWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG5ld1Bvcyk7CiAgfQoKICByZXR1cm4gewogICAgaW52YWxpZDogY3VycmVudE1hcmtlci50b1N0cmluZygxNiksCiAgICBtYXJrZXI6IG5ld01hcmtlciwKICAgIG9mZnNldDogbmV3UG9zCiAgfTsKfQoKY2xhc3MgSnBlZ0ltYWdlIHsKICBjb25zdHJ1Y3Rvcih7CiAgICBkZWNvZGVUcmFuc2Zvcm0gPSBudWxsLAogICAgY29sb3JUcmFuc2Zvcm0gPSAtMQogIH0gPSB7fSkgewogICAgdGhpcy5fZGVjb2RlVHJhbnNmb3JtID0gZGVjb2RlVHJhbnNmb3JtOwogICAgdGhpcy5fY29sb3JUcmFuc2Zvcm0gPSBjb2xvclRyYW5zZm9ybTsKICB9CgogIHBhcnNlKGRhdGEsIHsKICAgIGRubFNjYW5MaW5lcyA9IG51bGwKICB9ID0ge30pIHsKICAgIGZ1bmN0aW9uIHJlYWREYXRhQmxvY2soKSB7CiAgICAgIGNvbnN0IGxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICBvZmZzZXQgKz0gMjsKICAgICAgbGV0IGVuZE9mZnNldCA9IG9mZnNldCArIGxlbmd0aCAtIDI7CiAgICAgIGNvbnN0IGZpbGVNYXJrZXIgPSBmaW5kTmV4dEZpbGVNYXJrZXIoZGF0YSwgZW5kT2Zmc2V0LCBvZmZzZXQpOwoKICAgICAgaWYgKGZpbGVNYXJrZXIgJiYgZmlsZU1hcmtlci5pbnZhbGlkKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJyZWFkRGF0YUJsb2NrIC0gaW5jb3JyZWN0IGxlbmd0aCwgY3VycmVudCBtYXJrZXIgaXM6ICIgKyBmaWxlTWFya2VyLmludmFsaWQpOwogICAgICAgIGVuZE9mZnNldCA9IGZpbGVNYXJrZXIub2Zmc2V0OwogICAgICB9CgogICAgICBjb25zdCBhcnJheSA9IGRhdGEuc3ViYXJyYXkob2Zmc2V0LCBlbmRPZmZzZXQpOwogICAgICBvZmZzZXQgKz0gYXJyYXkubGVuZ3RoOwogICAgICByZXR1cm4gYXJyYXk7CiAgICB9CgogICAgZnVuY3Rpb24gcHJlcGFyZUNvbXBvbmVudHMoZnJhbWUpIHsKICAgICAgY29uc3QgbWN1c1BlckxpbmUgPSBNYXRoLmNlaWwoZnJhbWUuc2FtcGxlc1BlckxpbmUgLyA4IC8gZnJhbWUubWF4SCk7CiAgICAgIGNvbnN0IG1jdXNQZXJDb2x1bW4gPSBNYXRoLmNlaWwoZnJhbWUuc2NhbkxpbmVzIC8gOCAvIGZyYW1lLm1heFYpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZnJhbWUuY29tcG9uZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZnJhbWUuY29tcG9uZW50c1tpXTsKICAgICAgICBjb25zdCBibG9ja3NQZXJMaW5lID0gTWF0aC5jZWlsKE1hdGguY2VpbChmcmFtZS5zYW1wbGVzUGVyTGluZSAvIDgpICogY29tcG9uZW50LmggLyBmcmFtZS5tYXhIKTsKICAgICAgICBjb25zdCBibG9ja3NQZXJDb2x1bW4gPSBNYXRoLmNlaWwoTWF0aC5jZWlsKGZyYW1lLnNjYW5MaW5lcyAvIDgpICogY29tcG9uZW50LnYgLyBmcmFtZS5tYXhWKTsKICAgICAgICBjb25zdCBibG9ja3NQZXJMaW5lRm9yTWN1ID0gbWN1c1BlckxpbmUgKiBjb21wb25lbnQuaDsKICAgICAgICBjb25zdCBibG9ja3NQZXJDb2x1bW5Gb3JNY3UgPSBtY3VzUGVyQ29sdW1uICogY29tcG9uZW50LnY7CiAgICAgICAgY29uc3QgYmxvY2tzQnVmZmVyU2l6ZSA9IDY0ICogYmxvY2tzUGVyQ29sdW1uRm9yTWN1ICogKGJsb2Nrc1BlckxpbmVGb3JNY3UgKyAxKTsKICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhID0gbmV3IEludDE2QXJyYXkoYmxvY2tzQnVmZmVyU2l6ZSk7CiAgICAgICAgY29tcG9uZW50LmJsb2Nrc1BlckxpbmUgPSBibG9ja3NQZXJMaW5lOwogICAgICAgIGNvbXBvbmVudC5ibG9ja3NQZXJDb2x1bW4gPSBibG9ja3NQZXJDb2x1bW47CiAgICAgIH0KCiAgICAgIGZyYW1lLm1jdXNQZXJMaW5lID0gbWN1c1BlckxpbmU7CiAgICAgIGZyYW1lLm1jdXNQZXJDb2x1bW4gPSBtY3VzUGVyQ29sdW1uOwogICAgfQoKICAgIGxldCBvZmZzZXQgPSAwOwogICAgbGV0IGpmaWYgPSBudWxsOwogICAgbGV0IGFkb2JlID0gbnVsbDsKICAgIGxldCBmcmFtZSwgcmVzZXRJbnRlcnZhbDsKICAgIGxldCBudW1TT1NNYXJrZXJzID0gMDsKICAgIGNvbnN0IHF1YW50aXphdGlvblRhYmxlcyA9IFtdOwogICAgY29uc3QgaHVmZm1hblRhYmxlc0FDID0gW10sCiAgICAgICAgICBodWZmbWFuVGFibGVzREMgPSBbXTsKICAgIGxldCBmaWxlTWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICBvZmZzZXQgKz0gMjsKCiAgICBpZiAoZmlsZU1hcmtlciAhPT0gMHhmZmQ4KSB7CiAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoIlNPSSBub3QgZm91bmQiKTsKICAgIH0KCiAgICBmaWxlTWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICBvZmZzZXQgKz0gMjsKCiAgICBtYXJrZXJMb29wOiB3aGlsZSAoZmlsZU1hcmtlciAhPT0gMHhmZmQ5KSB7CiAgICAgIGxldCBpLCBqLCBsOwoKICAgICAgc3dpdGNoIChmaWxlTWFya2VyKSB7CiAgICAgICAgY2FzZSAweGZmZTA6CiAgICAgICAgY2FzZSAweGZmZTE6CiAgICAgICAgY2FzZSAweGZmZTI6CiAgICAgICAgY2FzZSAweGZmZTM6CiAgICAgICAgY2FzZSAweGZmZTQ6CiAgICAgICAgY2FzZSAweGZmZTU6CiAgICAgICAgY2FzZSAweGZmZTY6CiAgICAgICAgY2FzZSAweGZmZTc6CiAgICAgICAgY2FzZSAweGZmZTg6CiAgICAgICAgY2FzZSAweGZmZTk6CiAgICAgICAgY2FzZSAweGZmZWE6CiAgICAgICAgY2FzZSAweGZmZWI6CiAgICAgICAgY2FzZSAweGZmZWM6CiAgICAgICAgY2FzZSAweGZmZWQ6CiAgICAgICAgY2FzZSAweGZmZWU6CiAgICAgICAgY2FzZSAweGZmZWY6CiAgICAgICAgY2FzZSAweGZmZmU6CiAgICAgICAgICBjb25zdCBhcHBEYXRhID0gcmVhZERhdGFCbG9jaygpOwoKICAgICAgICAgIGlmIChmaWxlTWFya2VyID09PSAweGZmZTApIHsKICAgICAgICAgICAgaWYgKGFwcERhdGFbMF0gPT09IDB4NGEgJiYgYXBwRGF0YVsxXSA9PT0gMHg0NiAmJiBhcHBEYXRhWzJdID09PSAweDQ5ICYmIGFwcERhdGFbM10gPT09IDB4NDYgJiYgYXBwRGF0YVs0XSA9PT0gMCkgewogICAgICAgICAgICAgIGpmaWYgPSB7CiAgICAgICAgICAgICAgICB2ZXJzaW9uOiB7CiAgICAgICAgICAgICAgICAgIG1ham9yOiBhcHBEYXRhWzVdLAogICAgICAgICAgICAgICAgICBtaW5vcjogYXBwRGF0YVs2XQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGRlbnNpdHlVbml0czogYXBwRGF0YVs3XSwKICAgICAgICAgICAgICAgIHhEZW5zaXR5OiBhcHBEYXRhWzhdIDw8IDggfCBhcHBEYXRhWzldLAogICAgICAgICAgICAgICAgeURlbnNpdHk6IGFwcERhdGFbMTBdIDw8IDggfCBhcHBEYXRhWzExXSwKICAgICAgICAgICAgICAgIHRodW1iV2lkdGg6IGFwcERhdGFbMTJdLAogICAgICAgICAgICAgICAgdGh1bWJIZWlnaHQ6IGFwcERhdGFbMTNdLAogICAgICAgICAgICAgICAgdGh1bWJEYXRhOiBhcHBEYXRhLnN1YmFycmF5KDE0LCAxNCArIDMgKiBhcHBEYXRhWzEyXSAqIGFwcERhdGFbMTNdKQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZmlsZU1hcmtlciA9PT0gMHhmZmVlKSB7CiAgICAgICAgICAgIGlmIChhcHBEYXRhWzBdID09PSAweDQxICYmIGFwcERhdGFbMV0gPT09IDB4NjQgJiYgYXBwRGF0YVsyXSA9PT0gMHg2ZiAmJiBhcHBEYXRhWzNdID09PSAweDYyICYmIGFwcERhdGFbNF0gPT09IDB4NjUpIHsKICAgICAgICAgICAgICBhZG9iZSA9IHsKICAgICAgICAgICAgICAgIHZlcnNpb246IGFwcERhdGFbNV0gPDwgOCB8IGFwcERhdGFbNl0sCiAgICAgICAgICAgICAgICBmbGFnczA6IGFwcERhdGFbN10gPDwgOCB8IGFwcERhdGFbOF0sCiAgICAgICAgICAgICAgICBmbGFnczE6IGFwcERhdGFbOV0gPDwgOCB8IGFwcERhdGFbMTBdLAogICAgICAgICAgICAgICAgdHJhbnNmb3JtQ29kZTogYXBwRGF0YVsxMV0KICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhmZmRiOgogICAgICAgICAgY29uc3QgcXVhbnRpemF0aW9uVGFibGVzTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGNvbnN0IHF1YW50aXphdGlvblRhYmxlc0VuZCA9IHF1YW50aXphdGlvblRhYmxlc0xlbmd0aCArIG9mZnNldCAtIDI7CiAgICAgICAgICBsZXQgejsKCiAgICAgICAgICB3aGlsZSAob2Zmc2V0IDwgcXVhbnRpemF0aW9uVGFibGVzRW5kKSB7CiAgICAgICAgICAgIGNvbnN0IHF1YW50aXphdGlvblRhYmxlU3BlYyA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgICBjb25zdCB0YWJsZURhdGEgPSBuZXcgVWludDE2QXJyYXkoNjQpOwoKICAgICAgICAgICAgaWYgKHF1YW50aXphdGlvblRhYmxlU3BlYyA+PiA0ID09PSAwKSB7CiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyBqKyspIHsKICAgICAgICAgICAgICAgIHogPSBkY3RaaWdaYWdbal07CiAgICAgICAgICAgICAgICB0YWJsZURhdGFbel0gPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAocXVhbnRpemF0aW9uVGFibGVTcGVjID4+IDQgPT09IDEpIHsKICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgNjQ7IGorKykgewogICAgICAgICAgICAgICAgeiA9IGRjdFppZ1phZ1tqXTsKICAgICAgICAgICAgICAgIHRhYmxlRGF0YVt6XSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoIkRRVCAtIGludmFsaWQgdGFibGUgc3BlYyIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxdWFudGl6YXRpb25UYWJsZXNbcXVhbnRpemF0aW9uVGFibGVTcGVjICYgMTVdID0gdGFibGVEYXRhOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZjMDoKICAgICAgICBjYXNlIDB4ZmZjMToKICAgICAgICBjYXNlIDB4ZmZjMjoKICAgICAgICAgIGlmIChmcmFtZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJPbmx5IHNpbmdsZSBmcmFtZSBKUEVHcyBzdXBwb3J0ZWQiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGZyYW1lID0ge307CiAgICAgICAgICBmcmFtZS5leHRlbmRlZCA9IGZpbGVNYXJrZXIgPT09IDB4ZmZjMTsKICAgICAgICAgIGZyYW1lLnByb2dyZXNzaXZlID0gZmlsZU1hcmtlciA9PT0gMHhmZmMyOwogICAgICAgICAgZnJhbWUucHJlY2lzaW9uID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICBjb25zdCBzb2ZTY2FuTGluZXMgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgZnJhbWUuc2NhbkxpbmVzID0gZG5sU2NhbkxpbmVzIHx8IHNvZlNjYW5MaW5lczsKICAgICAgICAgIGZyYW1lLnNhbXBsZXNQZXJMaW5lID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGZyYW1lLmNvbXBvbmVudHMgPSBbXTsKICAgICAgICAgIGZyYW1lLmNvbXBvbmVudElkcyA9IHt9OwogICAgICAgICAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICBsZXQgbWF4SCA9IDAsCiAgICAgICAgICAgICAgbWF4ViA9IDA7CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudElkID0gZGF0YVtvZmZzZXRdOwogICAgICAgICAgICBjb25zdCBoID0gZGF0YVtvZmZzZXQgKyAxXSA+PiA0OwogICAgICAgICAgICBjb25zdCB2ID0gZGF0YVtvZmZzZXQgKyAxXSAmIDE1OwoKICAgICAgICAgICAgaWYgKG1heEggPCBoKSB7CiAgICAgICAgICAgICAgbWF4SCA9IGg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChtYXhWIDwgdikgewogICAgICAgICAgICAgIG1heFYgPSB2OwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBxSWQgPSBkYXRhW29mZnNldCArIDJdOwogICAgICAgICAgICBsID0gZnJhbWUuY29tcG9uZW50cy5wdXNoKHsKICAgICAgICAgICAgICBoLAogICAgICAgICAgICAgIHYsCiAgICAgICAgICAgICAgcXVhbnRpemF0aW9uSWQ6IHFJZCwKICAgICAgICAgICAgICBxdWFudGl6YXRpb25UYWJsZTogbnVsbAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZnJhbWUuY29tcG9uZW50SWRzW2NvbXBvbmVudElkXSA9IGwgLSAxOwogICAgICAgICAgICBvZmZzZXQgKz0gMzsKICAgICAgICAgIH0KCiAgICAgICAgICBmcmFtZS5tYXhIID0gbWF4SDsKICAgICAgICAgIGZyYW1lLm1heFYgPSBtYXhWOwogICAgICAgICAgcHJlcGFyZUNvbXBvbmVudHMoZnJhbWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhmZmM0OgogICAgICAgICAgY29uc3QgaHVmZm1hbkxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgb2Zmc2V0ICs9IDI7CgogICAgICAgICAgZm9yIChpID0gMjsgaSA8IGh1ZmZtYW5MZW5ndGg7KSB7CiAgICAgICAgICAgIGNvbnN0IGh1ZmZtYW5UYWJsZVNwZWMgPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgY29uc3QgY29kZUxlbmd0aHMgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICAgICAgICAgIGxldCBjb2RlTGVuZ3RoU3VtID0gMDsKCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCAxNjsgaisrLCBvZmZzZXQrKykgewogICAgICAgICAgICAgIGNvZGVMZW5ndGhTdW0gKz0gY29kZUxlbmd0aHNbal0gPSBkYXRhW29mZnNldF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGh1ZmZtYW5WYWx1ZXMgPSBuZXcgVWludDhBcnJheShjb2RlTGVuZ3RoU3VtKTsKCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBjb2RlTGVuZ3RoU3VtOyBqKyssIG9mZnNldCsrKSB7CiAgICAgICAgICAgICAgaHVmZm1hblZhbHVlc1tqXSA9IGRhdGFbb2Zmc2V0XTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaSArPSAxNyArIGNvZGVMZW5ndGhTdW07CiAgICAgICAgICAgIChodWZmbWFuVGFibGVTcGVjID4+IDQgPT09IDAgPyBodWZmbWFuVGFibGVzREMgOiBodWZmbWFuVGFibGVzQUMpW2h1ZmZtYW5UYWJsZVNwZWMgJiAxNV0gPSBidWlsZEh1ZmZtYW5UYWJsZShjb2RlTGVuZ3RocywgaHVmZm1hblZhbHVlcyk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHhmZmRkOgogICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICByZXNldEludGVydmFsID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZkYToKICAgICAgICAgIGNvbnN0IHBhcnNlRE5MTWFya2VyID0gKytudW1TT1NNYXJrZXJzID09PSAxICYmICFkbmxTY2FuTGluZXM7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgIGNvbnN0IHNlbGVjdG9yc0NvdW50ID0gZGF0YVtvZmZzZXQrK10sCiAgICAgICAgICAgICAgICBjb21wb25lbnRzID0gW107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNlbGVjdG9yc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgY29uc3QgaW5kZXggPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgY29uc3QgY29tcG9uZW50SW5kZXggPSBmcmFtZS5jb21wb25lbnRJZHNbaW5kZXhdOwogICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBmcmFtZS5jb21wb25lbnRzW2NvbXBvbmVudEluZGV4XTsKICAgICAgICAgICAgY29tcG9uZW50LmluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgIGNvbnN0IHRhYmxlU3BlYyA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgICBjb21wb25lbnQuaHVmZm1hblRhYmxlREMgPSBodWZmbWFuVGFibGVzRENbdGFibGVTcGVjID4+IDRdOwogICAgICAgICAgICBjb21wb25lbnQuaHVmZm1hblRhYmxlQUMgPSBodWZmbWFuVGFibGVzQUNbdGFibGVTcGVjICYgMTVdOwogICAgICAgICAgICBjb21wb25lbnRzLnB1c2goY29tcG9uZW50KTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBzcGVjdHJhbFN0YXJ0ID0gZGF0YVtvZmZzZXQrK10sCiAgICAgICAgICAgICAgICBzcGVjdHJhbEVuZCA9IGRhdGFbb2Zmc2V0KytdLAogICAgICAgICAgICAgICAgc3VjY2Vzc2l2ZUFwcHJveGltYXRpb24gPSBkYXRhW29mZnNldCsrXTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBwcm9jZXNzZWQgPSBkZWNvZGVTY2FuKGRhdGEsIG9mZnNldCwgZnJhbWUsIGNvbXBvbmVudHMsIHJlc2V0SW50ZXJ2YWwsIHNwZWN0cmFsU3RhcnQsIHNwZWN0cmFsRW5kLCBzdWNjZXNzaXZlQXBwcm94aW1hdGlvbiA+PiA0LCBzdWNjZXNzaXZlQXBwcm94aW1hdGlvbiAmIDE1LCBwYXJzZUROTE1hcmtlcik7CiAgICAgICAgICAgIG9mZnNldCArPSBwcm9jZXNzZWQ7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBETkxNYXJrZXJFcnJvcikgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgJHtleC5tZXNzYWdlfSAtLSBhdHRlbXB0aW5nIHRvIHJlLXBhcnNlIHRoZSBKUEVHIGltYWdlLmApOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlKGRhdGEsIHsKICAgICAgICAgICAgICAgIGRubFNjYW5MaW5lczogZXguc2NhbkxpbmVzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXggaW5zdGFuY2VvZiBFT0lNYXJrZXJFcnJvcikgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgJHtleC5tZXNzYWdlfSAtLSBpZ25vcmluZyB0aGUgcmVzdCBvZiB0aGUgaW1hZ2UgZGF0YS5gKTsKICAgICAgICAgICAgICBicmVhayBtYXJrZXJMb29wOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBleDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweGZmZGM6CiAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4ZmZmZjoKICAgICAgICAgIGlmIChkYXRhW29mZnNldF0gIT09IDB4ZmYpIHsKICAgICAgICAgICAgb2Zmc2V0LS07CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBjb25zdCBuZXh0RmlsZU1hcmtlciA9IGZpbmROZXh0RmlsZU1hcmtlcihkYXRhLCBvZmZzZXQgLSAyLCBvZmZzZXQgLSAzKTsKCiAgICAgICAgICBpZiAobmV4dEZpbGVNYXJrZXIgJiYgbmV4dEZpbGVNYXJrZXIuaW52YWxpZCkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkpwZWdJbWFnZS5wYXJzZSAtIHVuZXhwZWN0ZWQgZGF0YSwgY3VycmVudCBtYXJrZXIgaXM6ICIgKyBuZXh0RmlsZU1hcmtlci5pbnZhbGlkKTsKICAgICAgICAgICAgb2Zmc2V0ID0gbmV4dEZpbGVNYXJrZXIub2Zmc2V0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIW5leHRGaWxlTWFya2VyIHx8IG9mZnNldCA+PSBkYXRhLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJKcGVnSW1hZ2UucGFyc2UgLSByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGltYWdlIGRhdGEgIiArICJ3aXRob3V0IGZpbmRpbmcgYW4gRU9JIG1hcmtlciAoMHhGRkQ5KS4iKTsKICAgICAgICAgICAgYnJlYWsgbWFya2VyTG9vcDsKICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJKcGVnSW1hZ2UucGFyc2UgLSB1bmtub3duIG1hcmtlcjogIiArIGZpbGVNYXJrZXIudG9TdHJpbmcoMTYpKTsKICAgICAgfQoKICAgICAgZmlsZU1hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICBvZmZzZXQgKz0gMjsKICAgIH0KCiAgICB0aGlzLndpZHRoID0gZnJhbWUuc2FtcGxlc1BlckxpbmU7CiAgICB0aGlzLmhlaWdodCA9IGZyYW1lLnNjYW5MaW5lczsKICAgIHRoaXMuamZpZiA9IGpmaWY7CiAgICB0aGlzLmFkb2JlID0gYWRvYmU7CiAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmcmFtZS5jb21wb25lbnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgY29tcG9uZW50ID0gZnJhbWUuY29tcG9uZW50c1tpXTsKICAgICAgY29uc3QgcXVhbnRpemF0aW9uVGFibGUgPSBxdWFudGl6YXRpb25UYWJsZXNbY29tcG9uZW50LnF1YW50aXphdGlvbklkXTsKCiAgICAgIGlmIChxdWFudGl6YXRpb25UYWJsZSkgewogICAgICAgIGNvbXBvbmVudC5xdWFudGl6YXRpb25UYWJsZSA9IHF1YW50aXphdGlvblRhYmxlOwogICAgICB9CgogICAgICB0aGlzLmNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgaW5kZXg6IGNvbXBvbmVudC5pbmRleCwKICAgICAgICBvdXRwdXQ6IGJ1aWxkQ29tcG9uZW50RGF0YShmcmFtZSwgY29tcG9uZW50KSwKICAgICAgICBzY2FsZVg6IGNvbXBvbmVudC5oIC8gZnJhbWUubWF4SCwKICAgICAgICBzY2FsZVk6IGNvbXBvbmVudC52IC8gZnJhbWUubWF4ViwKICAgICAgICBibG9ja3NQZXJMaW5lOiBjb21wb25lbnQuYmxvY2tzUGVyTGluZSwKICAgICAgICBibG9ja3NQZXJDb2x1bW46IGNvbXBvbmVudC5ibG9ja3NQZXJDb2x1bW4KICAgICAgfSk7CiAgICB9CgogICAgdGhpcy5udW1Db21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLmxlbmd0aDsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBfZ2V0TGluZWFyaXplZEJsb2NrRGF0YSh3aWR0aCwgaGVpZ2h0LCBpc1NvdXJjZVBERiA9IGZhbHNlKSB7CiAgICBjb25zdCBzY2FsZVggPSB0aGlzLndpZHRoIC8gd2lkdGgsCiAgICAgICAgICBzY2FsZVkgPSB0aGlzLmhlaWdodCAvIGhlaWdodDsKICAgIGxldCBjb21wb25lbnQsIGNvbXBvbmVudFNjYWxlWCwgY29tcG9uZW50U2NhbGVZLCBibG9ja3NQZXJTY2FubGluZTsKICAgIGxldCB4LCB5LCBpLCBqLCBrOwogICAgbGV0IGluZGV4OwogICAgbGV0IG9mZnNldCA9IDA7CiAgICBsZXQgb3V0cHV0OwogICAgY29uc3QgbnVtQ29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5sZW5ndGg7CiAgICBjb25zdCBkYXRhTGVuZ3RoID0gd2lkdGggKiBoZWlnaHQgKiBudW1Db21wb25lbnRzOwogICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShkYXRhTGVuZ3RoKTsKICAgIGNvbnN0IHhTY2FsZUJsb2NrT2Zmc2V0ID0gbmV3IFVpbnQzMkFycmF5KHdpZHRoKTsKICAgIGNvbnN0IG1hc2szTFNCID0gMHhmZmZmZmZmODsKICAgIGxldCBsYXN0Q29tcG9uZW50U2NhbGVYOwoKICAgIGZvciAoaSA9IDA7IGkgPCBudW1Db21wb25lbnRzOyBpKyspIHsKICAgICAgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnRzW2ldOwogICAgICBjb21wb25lbnRTY2FsZVggPSBjb21wb25lbnQuc2NhbGVYICogc2NhbGVYOwogICAgICBjb21wb25lbnRTY2FsZVkgPSBjb21wb25lbnQuc2NhbGVZICogc2NhbGVZOwogICAgICBvZmZzZXQgPSBpOwogICAgICBvdXRwdXQgPSBjb21wb25lbnQub3V0cHV0OwogICAgICBibG9ja3NQZXJTY2FubGluZSA9IGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lICsgMSA8PCAzOwoKICAgICAgaWYgKGNvbXBvbmVudFNjYWxlWCAhPT0gbGFzdENvbXBvbmVudFNjYWxlWCkgewogICAgICAgIGZvciAoeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CiAgICAgICAgICBqID0gMCB8IHggKiBjb21wb25lbnRTY2FsZVg7CiAgICAgICAgICB4U2NhbGVCbG9ja09mZnNldFt4XSA9IChqICYgbWFzazNMU0IpIDw8IDMgfCBqICYgNzsKICAgICAgICB9CgogICAgICAgIGxhc3RDb21wb25lbnRTY2FsZVggPSBjb21wb25lbnRTY2FsZVg7CiAgICAgIH0KCiAgICAgIGZvciAoeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgICAgIGogPSAwIHwgeSAqIGNvbXBvbmVudFNjYWxlWTsKICAgICAgICBpbmRleCA9IGJsb2Nrc1BlclNjYW5saW5lICogKGogJiBtYXNrM0xTQikgfCAoaiAmIDcpIDw8IDM7CgogICAgICAgIGZvciAoeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CiAgICAgICAgICBkYXRhW29mZnNldF0gPSBvdXRwdXRbaW5kZXggKyB4U2NhbGVCbG9ja09mZnNldFt4XV07CiAgICAgICAgICBvZmZzZXQgKz0gbnVtQ29tcG9uZW50czsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBsZXQgdHJhbnNmb3JtID0gdGhpcy5fZGVjb2RlVHJhbnNmb3JtOwoKICAgIGlmICghaXNTb3VyY2VQREYgJiYgbnVtQ29tcG9uZW50cyA9PT0gNCAmJiAhdHJhbnNmb3JtKSB7CiAgICAgIHRyYW5zZm9ybSA9IG5ldyBJbnQzMkFycmF5KFstMjU2LCAyNTUsIC0yNTYsIDI1NSwgLTI1NiwgMjU1LCAtMjU2LCAyNTVdKTsKICAgIH0KCiAgICBpZiAodHJhbnNmb3JtKSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOykgewogICAgICAgIGZvciAoaiA9IDAsIGsgPSAwOyBqIDwgbnVtQ29tcG9uZW50czsgaisrLCBpKyssIGsgKz0gMikgewogICAgICAgICAgZGF0YVtpXSA9IChkYXRhW2ldICogdHJhbnNmb3JtW2tdID4+IDgpICsgdHJhbnNmb3JtW2sgKyAxXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIGdldCBfaXNDb2xvckNvbnZlcnNpb25OZWVkZWQoKSB7CiAgICBpZiAodGhpcy5hZG9iZSkgewogICAgICByZXR1cm4gISF0aGlzLmFkb2JlLnRyYW5zZm9ybUNvZGU7CiAgICB9CgogICAgaWYgKHRoaXMubnVtQ29tcG9uZW50cyA9PT0gMykgewogICAgICBpZiAodGhpcy5fY29sb3JUcmFuc2Zvcm0gPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5jb21wb25lbnRzWzBdLmluZGV4ID09PSAweDUyICYmIHRoaXMuY29tcG9uZW50c1sxXS5pbmRleCA9PT0gMHg0NyAmJiB0aGlzLmNvbXBvbmVudHNbMl0uaW5kZXggPT09IDB4NDIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmICh0aGlzLl9jb2xvclRyYW5zZm9ybSA9PT0gMSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBfY29udmVydFljY1RvUmdiKGRhdGEpIHsKICAgIGxldCBZLCBDYiwgQ3I7CgogICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpICs9IDMpIHsKICAgICAgWSA9IGRhdGFbaV07CiAgICAgIENiID0gZGF0YVtpICsgMV07CiAgICAgIENyID0gZGF0YVtpICsgMl07CiAgICAgIGRhdGFbaV0gPSBZIC0gMTc5LjQ1NiArIDEuNDAyICogQ3I7CiAgICAgIGRhdGFbaSArIDFdID0gWSArIDEzNS40NTkgLSAwLjM0NCAqIENiIC0gMC43MTQgKiBDcjsKICAgICAgZGF0YVtpICsgMl0gPSBZIC0gMjI2LjgxNiArIDEuNzcyICogQ2I7CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBfY29udmVydFljY2tUb1JnYihkYXRhKSB7CiAgICBsZXQgWSwgQ2IsIENyLCBrOwogICAgbGV0IG9mZnNldCA9IDA7CgogICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpICs9IDQpIHsKICAgICAgWSA9IGRhdGFbaV07CiAgICAgIENiID0gZGF0YVtpICsgMV07CiAgICAgIENyID0gZGF0YVtpICsgMl07CiAgICAgIGsgPSBkYXRhW2kgKyAzXTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAtMTIyLjY3MTk1NDA2ODk0ICsgQ2IgKiAoLTYuNjA2MzU2Njk0MjAzNjRlLTUgKiBDYiArIDAuMDAwNDM3MTMwNDc1OTI2MjMyICogQ3IgLSA1LjQwODA2MTAwNjQ1OTllLTUgKiBZICsgMC4wMDA0ODQ0OTc5NzEyMDI4MSAqIGsgLSAwLjE1NDM2MjE1MTg3MTEyNikgKyBDciAqICgtMC4wMDA5NTc5NjQzNzg0NDU3NzMgKiBDciArIDAuMDAwODE3MDc2OTExMzQ2NjI1ICogWSAtIDAuMDA0NzcyNzE0MDU0MDg3NDcgKiBrICsgMS41MzM4MDI1MzIyMTczNCkgKyBZICogKDAuMDAwOTYxMjUwMTg0MTMwNjg4ICogWSAtIDAuMDAyNjYyNTczMzIyODM5MzMgKiBrICsgMC40ODM1NzA4ODQ1MTI2NSkgKyBrICogKC0wLjAwMDMzNjE5NzE3NzYxODM5NCAqIGsgKyAwLjQ4NDc5MTU2MTQ5MDc3Nik7CiAgICAgIGRhdGFbb2Zmc2V0KytdID0gMTA3LjI2ODAzOTM5NzcyNCArIENiICogKDIuMTk5MjcxMDQ1MjU3NDFlLTUgKiBDYiAtIDAuMDAwNjQwOTkyMDE4Mjk3OTQ1ICogQ3IgKyAwLjAwMDY1OTM5NzAwMTI0NTU3NyAqIFkgKyAwLjAwMDQyNjEwNTY1MjkzODgzNyAqIGsgLSAwLjE3NjQ5MTc5MjQ2Mjg3NSkgKyBDciAqICgtMC4wMDA3NzgyNjk5NDE1MTM2ODMgKiBDciArIDAuMDAxMzA4NzIyNjE0MDgyNzUgKiBZICsgMC4wMDA3NzA0ODI2MzE4MDExMzIgKiBrIC0gMC4xNTEwNTE0OTI3NzU1NjIpICsgWSAqICgwLjAwMTI2OTM1MzY4MTE0ODQzICogWSAtIDAuMDAyNjUwOTAxODkwMTA4OTggKiBrICsgMC4yNTgwMjkxMDIwNjg0NSkgKyBrICogKC0wLjAwMDMxODkxMzExNzU4ODMyOCAqIGsgLSAwLjIxMzc0MjQwMDMyMzY2NSk7CiAgICAgIGRhdGFbb2Zmc2V0KytdID0gLTIwLjgxMDAxMjU0Njk0NyArIENiICogKC0wLjAwMDU3MDExNTE5Njk3MzY3NyAqIENiIC0gMi42MzQwOTA1MTAwNDU4OWUtNSAqIENyICsgMC4wMDIwNzQxMDg4MTE1MDEyICogWSAtIDAuMDAyODgyNjAyMzY4NTM0NDIgKiBrICsgMC44MTQyNzI5NjgzNTkyOTUpICsgQ3IgKiAoLTEuNTM0OTYwNTc0NDA5NzVlLTUgKiBDciAtIDAuMDAwMTMyNjg5MDQzOTYxNDQ2ICogWSArIDAuMDAwNTYwODMzNjkxMjQyODEyICogayAtIDAuMTk1MTUyMDI3NTM0MDQ5KSArIFkgKiAoMC4wMDE3NDQxODEzMjkyNzU4MiAqIFkgLSAwLjAwMjU1MjQzMzIxNDM5MzQ3ICogayArIDAuMTE2OTM1MDIwNDY1MTQ1KSArIGsgKiAoLTAuMDAwMzQzNTMxOTk2NTEwNTU1ICogayArIDAuMjQxNjUyNjAyMzI0MDcpOwogICAgfQoKICAgIHJldHVybiBkYXRhLnN1YmFycmF5KDAsIG9mZnNldCk7CiAgfQoKICBfY29udmVydFljY2tUb0NteWsoZGF0YSkgewogICAgbGV0IFksIENiLCBDcjsKCiAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gNCkgewogICAgICBZID0gZGF0YVtpXTsKICAgICAgQ2IgPSBkYXRhW2kgKyAxXTsKICAgICAgQ3IgPSBkYXRhW2kgKyAyXTsKICAgICAgZGF0YVtpXSA9IDQzNC40NTYgLSBZIC0gMS40MDIgKiBDcjsKICAgICAgZGF0YVtpICsgMV0gPSAxMTkuNTQxIC0gWSArIDAuMzQ0ICogQ2IgKyAwLjcxNCAqIENyOwogICAgICBkYXRhW2kgKyAyXSA9IDQ4MS44MTYgLSBZIC0gMS43NzIgKiBDYjsKICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIF9jb252ZXJ0Q215a1RvUmdiKGRhdGEpIHsKICAgIGxldCBjLCBtLCB5LCBrOwogICAgbGV0IG9mZnNldCA9IDA7CgogICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpICs9IDQpIHsKICAgICAgYyA9IGRhdGFbaV07CiAgICAgIG0gPSBkYXRhW2kgKyAxXTsKICAgICAgeSA9IGRhdGFbaSArIDJdOwogICAgICBrID0gZGF0YVtpICsgM107CiAgICAgIGRhdGFbb2Zmc2V0KytdID0gMjU1ICsgYyAqICgtMC4wMDAwNjc0NzE0NzA3MzYwMjQ0MSAqIGMgKyAwLjAwMDgzNzkyNjIxMjEwMTM3MjcgKiBtICsgMC4wMDAyODk0NzE4MTg4NjQzMjk0ICogeSArIDAuMDAzMjY0MjMxMDU3NTM3ODA2ICogayAtIDEuMTE4NTYxMTg2NzIwMzkzNykgKyBtICogKDAuMDAwMDI2Mzc0MTA3NjE2MDg5NDA1ICogbSAtIDAuMDAwMDg2MjY5NDkxNTg2Mzg1NzIgKiB5IC0gMC4wMDAyNzQ4NzY5MDY3NDk5NDkxICogayAtIDAuMDIxNTU2ODg3OTQ5Nzg5NjcpICsgeSAqICgtMC4wMDAwMzg3ODA5OTIxMjg2OTM2MyAqIHkgLSAwLjAwMDMyNjc4MDgyNzk0ODUyODYgKiBrICsgMC4wNjg2NzQyMjM4NTk1MzQ1KSAtIGsgKiAoMC4wMDAzMzYxOTcxNzc2MTgzOTM3ICogayArIDAuNzQzMDY1OTE1MTM0MjI1NCk7CiAgICAgIGRhdGFbb2Zmc2V0KytdID0gMjU1ICsgYyAqICgwLjAwMDEzNTk2MzcyODEzNTg4ODQ4ICogYyArIDAuMDAwOTI0NTM3MTMyNTczNTg1ICogbSArIDAuMDAwMTA1NjczNTk2MTg2ODM1OTMgKiB5ICsgMC4wMDA0NzkxODY0Njg3NDM2NTEyICogayAtIDAuMzEwOTY4OTU4NzUxNTg3NSkgKyBtICogKC0wLjAwMDIzNTQ1MzQ2MTA4MzcwMzQ0ICogbSArIDAuMDAwMjcwMjg0NTI1MzUzNDcxNCAqIHkgKyAwLjAwMjAyMDAzMDg5NzczMDcxNTYgKiBrIC0gMC43NDg4MDUyMTY3MDE1NDk0KSArIHkgKiAoMC4wMDAwNjgzNDgxNTk5ODIzNTY2MiAqIHkgKyAwLjAwMDE1MTY4NDUyMzYzNDYwOTczICogayAtIDAuMDk3NTE5Mjc3NzQ3Mjg5MzMpIC0gayAqICgwLjAwMDMxODkxMzExNzU4ODMyODEgKiBrICsgMC43MzY0ODgzODA3NzMzMTY4KTsKICAgICAgZGF0YVtvZmZzZXQrK10gPSAyNTUgKyBjICogKDAuMDAwMDEzNTk4NjUwNDExMzg1MzA3ICogYyArIDAuMDAwMTI0MjM5NTYxNzU0OTA4NTEgKiBtICsgMC4wMDA0NzUxOTg1MDk3NTgzNTg5ICogeSAtIDAuMDAwMDAzNjcyOTMxNzQ3NjYzMDQyMiAqIGsgLSAwLjA1NTYyMTg2OTgwMjY0MDM0KSArIG0gKiAoMC4wMDAxNjE0MTM4MDU5ODcyNDY3NiAqIG0gKyAwLjAwMDk2OTIyMzkxMzA3MjUxODYgKiB5ICsgMC4wMDA3NzgyNjkyNDUwMDM2MjUzICogayAtIDAuNDQwMTUyMzIzNjc1MjY0NjMpICsgeSAqICg1LjA2ODg4MjkxNDA2ODc2OWUtNyAqIHkgKyAwLjAwMTc3NzgzNjkwMTEzNzUwNzEgKiBrIC0gMC43NTkxNDU0NjQ5NzQ5NjA5KSAtIGsgKiAoMC4wMDAzNDM1MzE5OTY1MTA1NTUzICogayArIDAuNzA2Mzc3MDE4NjE2MDE0NCk7CiAgICB9CgogICAgcmV0dXJuIGRhdGEuc3ViYXJyYXkoMCwgb2Zmc2V0KTsKICB9CgogIGdldERhdGEoewogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBmb3JjZVJHQiA9IGZhbHNlLAogICAgaXNTb3VyY2VQREYgPSBmYWxzZQogIH0pIHsKICAgIGlmICh0aGlzLm51bUNvbXBvbmVudHMgPiA0KSB7CiAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoIlVuc3VwcG9ydGVkIGNvbG9yIG1vZGUiKTsKICAgIH0KCiAgICBjb25zdCBkYXRhID0gdGhpcy5fZ2V0TGluZWFyaXplZEJsb2NrRGF0YSh3aWR0aCwgaGVpZ2h0LCBpc1NvdXJjZVBERik7CgogICAgaWYgKHRoaXMubnVtQ29tcG9uZW50cyA9PT0gMSAmJiBmb3JjZVJHQikgewogICAgICBjb25zdCBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICAgIGNvbnN0IHJnYkRhdGEgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoZGF0YUxlbmd0aCAqIDMpOwogICAgICBsZXQgb2Zmc2V0ID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgZ3JheUNvbG9yID0gZGF0YVtpXTsKICAgICAgICByZ2JEYXRhW29mZnNldCsrXSA9IGdyYXlDb2xvcjsKICAgICAgICByZ2JEYXRhW29mZnNldCsrXSA9IGdyYXlDb2xvcjsKICAgICAgICByZ2JEYXRhW29mZnNldCsrXSA9IGdyYXlDb2xvcjsKICAgICAgfQoKICAgICAgcmV0dXJuIHJnYkRhdGE7CiAgICB9IGVsc2UgaWYgKHRoaXMubnVtQ29tcG9uZW50cyA9PT0gMyAmJiB0aGlzLl9pc0NvbG9yQ29udmVyc2lvbk5lZWRlZCkgewogICAgICByZXR1cm4gdGhpcy5fY29udmVydFljY1RvUmdiKGRhdGEpOwogICAgfSBlbHNlIGlmICh0aGlzLm51bUNvbXBvbmVudHMgPT09IDQpIHsKICAgICAgaWYgKHRoaXMuX2lzQ29sb3JDb252ZXJzaW9uTmVlZGVkKSB7CiAgICAgICAgaWYgKGZvcmNlUkdCKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydFljY2tUb1JnYihkYXRhKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0WWNja1RvQ215ayhkYXRhKTsKICAgICAgfSBlbHNlIGlmIChmb3JjZVJHQikgewogICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0Q215a1RvUmdiKGRhdGEpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKfQoKZXhwb3J0cy5KcGVnSW1hZ2UgPSBKcGVnSW1hZ2U7CgovKioqLyB9KSwKLyogMjkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5KcHhTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKCnZhciBfanB4ID0gX193X3BkZmpzX3JlcXVpcmVfXygzMCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY2xhc3MgSnB4U3RyZWFtIGV4dGVuZHMgX2RlY29kZV9zdHJlYW0uRGVjb2RlU3RyZWFtIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHN1cGVyKG1heWJlTGVuZ3RoKTsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5kaWN0ID0gc3RyZWFtLmRpY3Q7CiAgICB0aGlzLm1heWJlTGVuZ3RoID0gbWF5YmVMZW5ndGg7CiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICB9CgogIGdldCBieXRlcygpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYnl0ZXMiLCB0aGlzLnN0cmVhbS5nZXRCeXRlcyh0aGlzLm1heWJlTGVuZ3RoKSk7CiAgfQoKICBlbnN1cmVCdWZmZXIocmVxdWVzdGVkKSB7fQoKICByZWFkQmxvY2soKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGpweEltYWdlID0gbmV3IF9qcHguSnB4SW1hZ2UoKTsKICAgIGpweEltYWdlLnBhcnNlKHRoaXMuYnl0ZXMpOwogICAgY29uc3Qgd2lkdGggPSBqcHhJbWFnZS53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IGpweEltYWdlLmhlaWdodDsKICAgIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IGpweEltYWdlLmNvbXBvbmVudHNDb3VudDsKICAgIGNvbnN0IHRpbGVDb3VudCA9IGpweEltYWdlLnRpbGVzLmxlbmd0aDsKCiAgICBpZiAodGlsZUNvdW50ID09PSAxKSB7CiAgICAgIHRoaXMuYnVmZmVyID0ganB4SW1hZ2UudGlsZXNbMF0uaXRlbXM7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHdpZHRoICogaGVpZ2h0ICogY29tcG9uZW50c0NvdW50KTsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgdGlsZUNvdW50OyBrKyspIHsKICAgICAgICBjb25zdCB0aWxlQ29tcG9uZW50cyA9IGpweEltYWdlLnRpbGVzW2tdOwogICAgICAgIGNvbnN0IHRpbGVXaWR0aCA9IHRpbGVDb21wb25lbnRzLndpZHRoOwogICAgICAgIGNvbnN0IHRpbGVIZWlnaHQgPSB0aWxlQ29tcG9uZW50cy5oZWlnaHQ7CiAgICAgICAgY29uc3QgdGlsZUxlZnQgPSB0aWxlQ29tcG9uZW50cy5sZWZ0OwogICAgICAgIGNvbnN0IHRpbGVUb3AgPSB0aWxlQ29tcG9uZW50cy50b3A7CiAgICAgICAgY29uc3Qgc3JjID0gdGlsZUNvbXBvbmVudHMuaXRlbXM7CiAgICAgICAgbGV0IHNyY1Bvc2l0aW9uID0gMDsKICAgICAgICBsZXQgZGF0YVBvc2l0aW9uID0gKHdpZHRoICogdGlsZVRvcCArIHRpbGVMZWZ0KSAqIGNvbXBvbmVudHNDb3VudDsKICAgICAgICBjb25zdCBpbWdSb3dTaXplID0gd2lkdGggKiBjb21wb25lbnRzQ291bnQ7CiAgICAgICAgY29uc3QgdGlsZVJvd1NpemUgPSB0aWxlV2lkdGggKiBjb21wb25lbnRzQ291bnQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGlsZUhlaWdodDsgaisrKSB7CiAgICAgICAgICBjb25zdCByb3dCeXRlcyA9IHNyYy5zdWJhcnJheShzcmNQb3NpdGlvbiwgc3JjUG9zaXRpb24gKyB0aWxlUm93U2l6ZSk7CiAgICAgICAgICBkYXRhLnNldChyb3dCeXRlcywgZGF0YVBvc2l0aW9uKTsKICAgICAgICAgIHNyY1Bvc2l0aW9uICs9IHRpbGVSb3dTaXplOwogICAgICAgICAgZGF0YVBvc2l0aW9uICs9IGltZ1Jvd1NpemU7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlci5sZW5ndGg7CiAgICB0aGlzLmVvZiA9IHRydWU7CiAgfQoKfQoKZXhwb3J0cy5KcHhTdHJlYW0gPSBKcHhTdHJlYW07CgovKioqLyB9KSwKLyogMzAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5KcHhJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9hcml0aG1ldGljX2RlY29kZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKCmNsYXNzIEpweEVycm9yIGV4dGVuZHMgX3V0aWwuQmFzZUV4Y2VwdGlvbiB7CiAgY29uc3RydWN0b3IobXNnKSB7CiAgICBzdXBlcihgSlBYIGVycm9yOiAke21zZ31gLCAiSnB4RXJyb3IiKTsKICB9Cgp9Cgpjb25zdCBTdWJiYW5kc0dhaW5Mb2cyID0gewogIExMOiAwLAogIExIOiAxLAogIEhMOiAxLAogIEhIOiAyCn07CgpjbGFzcyBKcHhJbWFnZSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmZhaWxPbkNvcnJ1cHRlZEltYWdlID0gZmFsc2U7CiAgfQoKICBwYXJzZShkYXRhKSB7CiAgICBjb25zdCBoZWFkID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIDApOwoKICAgIGlmIChoZWFkID09PSAweGZmNGYpIHsKICAgICAgdGhpcy5wYXJzZUNvZGVzdHJlYW0oZGF0YSwgMCwgZGF0YS5sZW5ndGgpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgbGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICBsZXQgcG9zaXRpb24gPSAwOwoKICAgIHdoaWxlIChwb3NpdGlvbiA8IGxlbmd0aCkgewogICAgICBsZXQgaGVhZGVyU2l6ZSA9IDg7CiAgICAgIGxldCBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgY29uc3QgdGJveCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICBwb3NpdGlvbiArPSBoZWFkZXJTaXplOwoKICAgICAgaWYgKGxib3ggPT09IDEpIHsKICAgICAgICBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAqIDQyOTQ5NjcyOTYgKyAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICBwb3NpdGlvbiArPSA4OwogICAgICAgIGhlYWRlclNpemUgKz0gODsKICAgICAgfQoKICAgICAgaWYgKGxib3ggPT09IDApIHsKICAgICAgICBsYm94ID0gbGVuZ3RoIC0gcG9zaXRpb24gKyBoZWFkZXJTaXplOwogICAgICB9CgogICAgICBpZiAobGJveCA8IGhlYWRlclNpemUpIHsKICAgICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIkludmFsaWQgYm94IGZpZWxkIHNpemUiKTsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IGxib3ggLSBoZWFkZXJTaXplOwogICAgICBsZXQganVtcERhdGFMZW5ndGggPSB0cnVlOwoKICAgICAgc3dpdGNoICh0Ym94KSB7CiAgICAgICAgY2FzZSAweDZhNzAzMjY4OgogICAgICAgICAganVtcERhdGFMZW5ndGggPSBmYWxzZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDB4NjM2ZjZjNzI6CiAgICAgICAgICBjb25zdCBtZXRob2QgPSBkYXRhW3Bvc2l0aW9uXTsKCiAgICAgICAgICBpZiAobWV0aG9kID09PSAxKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbG9yc3BhY2UgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAzKTsKCiAgICAgICAgICAgIHN3aXRjaCAoY29sb3JzcGFjZSkgewogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVua25vd24gY29sb3JzcGFjZSAiICsgY29sb3JzcGFjZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IDIpIHsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJQ0MgcHJvZmlsZSBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTcwMzI2MzoKICAgICAgICAgIHRoaXMucGFyc2VDb2Rlc3RyZWFtKGRhdGEsIHBvc2l0aW9uLCBwb3NpdGlvbiArIGRhdGFMZW5ndGgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTUwMjAyMDoKICAgICAgICAgIGlmICgoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pICE9PSAweDBkMGE4NzBhKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBKUDIgc2lnbmF0dXJlIik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMHg2YTUwMWExYToKICAgICAgICBjYXNlIDB4NjY3NDc5NzA6CiAgICAgICAgY2FzZSAweDcyNzI2NTcxOgogICAgICAgIGNhc2UgMHg3MjY1NzMyMDoKICAgICAgICBjYXNlIDB4Njk2ODY0NzI6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNvbnN0IGhlYWRlclR5cGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRib3ggPj4gMjQgJiAweGZmLCB0Ym94ID4+IDE2ICYgMHhmZiwgdGJveCA+PiA4ICYgMHhmZiwgdGJveCAmIDB4ZmYpOwogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBVbnN1cHBvcnRlZCBoZWFkZXIgdHlwZSAke3Rib3h9ICgke2hlYWRlclR5cGV9KS5gKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoanVtcERhdGFMZW5ndGgpIHsKICAgICAgICBwb3NpdGlvbiArPSBkYXRhTGVuZ3RoOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUltYWdlUHJvcGVydGllcyhzdHJlYW0pIHsKICAgIGxldCBuZXdCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKCiAgICB3aGlsZSAobmV3Qnl0ZSA+PSAwKSB7CiAgICAgIGNvbnN0IG9sZEJ5dGUgPSBuZXdCeXRlOwogICAgICBuZXdCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgY29uc3QgY29kZSA9IG9sZEJ5dGUgPDwgOCB8IG5ld0J5dGU7CgogICAgICBpZiAoY29kZSA9PT0gMHhmZjUxKSB7CiAgICAgICAgc3RyZWFtLnNraXAoNCk7CiAgICAgICAgY29uc3QgWHNpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIGNvbnN0IFlzaXogPSBzdHJlYW0uZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICBjb25zdCBYT3NpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIGNvbnN0IFlPc2l6ID0gc3RyZWFtLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgc3RyZWFtLnNraXAoMTYpOwogICAgICAgIGNvbnN0IENzaXogPSBzdHJlYW0uZ2V0VWludDE2KCk7CiAgICAgICAgdGhpcy53aWR0aCA9IFhzaXogLSBYT3NpejsKICAgICAgICB0aGlzLmhlaWdodCA9IFlzaXogLSBZT3NpejsKICAgICAgICB0aGlzLmNvbXBvbmVudHNDb3VudCA9IENzaXo7CiAgICAgICAgdGhpcy5iaXRzUGVyQ29tcG9uZW50ID0gODsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk5vIHNpemUgbWFya2VyIGZvdW5kIGluIEpQWCBzdHJlYW0iKTsKICB9CgogIHBhcnNlQ29kZXN0cmVhbShkYXRhLCBzdGFydCwgZW5kKSB7CiAgICBjb25zdCBjb250ZXh0ID0ge307CiAgICBsZXQgZG9Ob3RSZWNvdmVyID0gZmFsc2U7CgogICAgdHJ5IHsKICAgICAgbGV0IHBvc2l0aW9uID0gc3RhcnQ7CgogICAgICB3aGlsZSAocG9zaXRpb24gKyAxIDwgZW5kKSB7CiAgICAgICAgY29uc3QgY29kZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgICBsZXQgbGVuZ3RoID0gMCwKICAgICAgICAgICAgaiwKICAgICAgICAgICAgc3FjZCwKICAgICAgICAgICAgc3BxY2RzLAogICAgICAgICAgICBzcHFjZFNpemUsCiAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCwKICAgICAgICAgICAgdGlsZTsKCiAgICAgICAgc3dpdGNoIChjb2RlKSB7CiAgICAgICAgICBjYXNlIDB4ZmY0ZjoKICAgICAgICAgICAgY29udGV4dC5tYWluSGVhZGVyID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmZDk6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZjUxOgogICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICBjb25zdCBzaXogPSB7fTsKICAgICAgICAgICAgc2l6LlhzaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICAgICAgc2l6LllzaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA4KTsKICAgICAgICAgICAgc2l6LlhPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMTIpOwogICAgICAgICAgICBzaXouWU9zaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAxNik7CiAgICAgICAgICAgIHNpei5YVHNpeiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDIwKTsKICAgICAgICAgICAgc2l6LllUc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjQpOwogICAgICAgICAgICBzaXouWFRPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjgpOwogICAgICAgICAgICBzaXouWVRPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMzIpOwogICAgICAgICAgICBjb25zdCBjb21wb25lbnRzQ291bnQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24gKyAzNik7CiAgICAgICAgICAgIHNpei5Dc2l6ID0gY29tcG9uZW50c0NvdW50OwogICAgICAgICAgICBjb25zdCBjb21wb25lbnRzID0gW107CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDM4OwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wb25lbnRzQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHsKICAgICAgICAgICAgICAgIHByZWNpc2lvbjogKGRhdGFbal0gJiAweDdmKSArIDEsCiAgICAgICAgICAgICAgICBpc1NpZ25lZDogISEoZGF0YVtqXSAmIDB4ODApLAogICAgICAgICAgICAgICAgWFJzaXo6IGRhdGFbaiArIDFdLAogICAgICAgICAgICAgICAgWVJzaXo6IGRhdGFbaiArIDJdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBqICs9IDM7CiAgICAgICAgICAgICAgY2FsY3VsYXRlQ29tcG9uZW50RGltZW5zaW9ucyhjb21wb25lbnQsIHNpeik7CiAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnRleHQuU0laID0gc2l6OwogICAgICAgICAgICBjb250ZXh0LmNvbXBvbmVudHMgPSBjb21wb25lbnRzOwogICAgICAgICAgICBjYWxjdWxhdGVUaWxlR3JpZHMoY29udGV4dCwgY29tcG9uZW50cyk7CiAgICAgICAgICAgIGNvbnRleHQuUUNDID0gW107CiAgICAgICAgICAgIGNvbnRleHQuQ09DID0gW107CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZjVjOgogICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICBjb25zdCBxY2QgPSB7fTsKICAgICAgICAgICAgaiA9IHBvc2l0aW9uICsgMjsKICAgICAgICAgICAgc3FjZCA9IGRhdGFbaisrXTsKCiAgICAgICAgICAgIHN3aXRjaCAoc3FjZCAmIDB4MWYpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSA4OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSAxNjsKICAgICAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDE2OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIFNRY2QgdmFsdWUgIiArIHNxY2QpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxY2Qubm9RdWFudGl6YXRpb24gPSBzcHFjZFNpemUgPT09IDg7CiAgICAgICAgICAgIHFjZC5zY2FsYXJFeHBvdW5kZWQgPSBzY2FsYXJFeHBvdW5kZWQ7CiAgICAgICAgICAgIHFjZC5ndWFyZEJpdHMgPSBzcWNkID4+IDU7CiAgICAgICAgICAgIHNwcWNkcyA9IFtdOwoKICAgICAgICAgICAgd2hpbGUgKGogPCBsZW5ndGggKyBwb3NpdGlvbikgewogICAgICAgICAgICAgIGNvbnN0IHNwcWNkID0ge307CgogICAgICAgICAgICAgIGlmIChzcHFjZFNpemUgPT09IDgpIHsKICAgICAgICAgICAgICAgIHNwcWNkLmVwc2lsb24gPSBkYXRhW2orK10gPj4gMzsKICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gMDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3BxY2QuZXBzaWxvbiA9IGRhdGFbal0gPj4gMzsKICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gKGRhdGFbal0gJiAweDcpIDw8IDggfCBkYXRhW2ogKyAxXTsKICAgICAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNwcWNkcy5wdXNoKHNwcWNkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcWNkLlNQcWNkcyA9IHNwcWNkczsKCiAgICAgICAgICAgIGlmIChjb250ZXh0Lm1haW5IZWFkZXIpIHsKICAgICAgICAgICAgICBjb250ZXh0LlFDRCA9IHFjZDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDRCA9IHFjZDsKICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQyA9IFtdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmY1ZDoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgY29uc3QgcWNjID0ge307CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDI7CiAgICAgICAgICAgIGxldCBjcWNjOwoKICAgICAgICAgICAgaWYgKGNvbnRleHQuU0laLkNzaXogPCAyNTcpIHsKICAgICAgICAgICAgICBjcWNjID0gZGF0YVtqKytdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNxY2MgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgaik7CiAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzcWNkID0gZGF0YVtqKytdOwoKICAgICAgICAgICAgc3dpdGNoIChzcWNkICYgMHgxZikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDg7CiAgICAgICAgICAgICAgICBzY2FsYXJFeHBvdW5kZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHNwcWNkU2l6ZSA9IDE2OwogICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgc3BxY2RTaXplID0gMTY7CiAgICAgICAgICAgICAgICBzY2FsYXJFeHBvdW5kZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgU1FjZCB2YWx1ZSAiICsgc3FjZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHFjYy5ub1F1YW50aXphdGlvbiA9IHNwcWNkU2l6ZSA9PT0gODsKICAgICAgICAgICAgcWNjLnNjYWxhckV4cG91bmRlZCA9IHNjYWxhckV4cG91bmRlZDsKICAgICAgICAgICAgcWNjLmd1YXJkQml0cyA9IHNxY2QgPj4gNTsKICAgICAgICAgICAgc3BxY2RzID0gW107CgogICAgICAgICAgICB3aGlsZSAoaiA8IGxlbmd0aCArIHBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgY29uc3Qgc3BxY2QgPSB7fTsKCiAgICAgICAgICAgICAgaWYgKHNwcWNkU2l6ZSA9PT0gOCkgewogICAgICAgICAgICAgICAgc3BxY2QuZXBzaWxvbiA9IGRhdGFbaisrXSA+PiAzOwogICAgICAgICAgICAgICAgc3BxY2QubXUgPSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzcHFjZC5lcHNpbG9uID0gZGF0YVtqXSA+PiAzOwogICAgICAgICAgICAgICAgc3BxY2QubXUgPSAoZGF0YVtqXSAmIDB4NykgPDwgOCB8IGRhdGFbaiArIDFdOwogICAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3BxY2RzLnB1c2goc3BxY2QpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxY2MuU1BxY2RzID0gc3BxY2RzOwoKICAgICAgICAgICAgaWYgKGNvbnRleHQubWFpbkhlYWRlcikgewogICAgICAgICAgICAgIGNvbnRleHQuUUNDW2NxY2NdID0gcWNjOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRpbGUuUUNDW2NxY2NdID0gcWNjOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmY1MjoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgY29uc3QgY29kID0ge307CiAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDI7CiAgICAgICAgICAgIGNvbnN0IHNjb2QgPSBkYXRhW2orK107CiAgICAgICAgICAgIGNvZC5lbnRyb3B5Q29kZXJXaXRoQ3VzdG9tUHJlY2luY3RzID0gISEoc2NvZCAmIDEpOwogICAgICAgICAgICBjb2Quc29wTWFya2VyVXNlZCA9ICEhKHNjb2QgJiAyKTsKICAgICAgICAgICAgY29kLmVwaE1hcmtlclVzZWQgPSAhIShzY29kICYgNCk7CiAgICAgICAgICAgIGNvZC5wcm9ncmVzc2lvbk9yZGVyID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QubGF5ZXJzQ291bnQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgaik7CiAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgY29kLm11bHRpcGxlQ29tcG9uZW50VHJhbnNmb3JtID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2QueGNiID0gKGRhdGFbaisrXSAmIDB4ZikgKyAyOwogICAgICAgICAgICBjb2QueWNiID0gKGRhdGFbaisrXSAmIDB4ZikgKyAyOwogICAgICAgICAgICBjb25zdCBibG9ja1N0eWxlID0gZGF0YVtqKytdOwogICAgICAgICAgICBjb2Quc2VsZWN0aXZlQXJpdGhtZXRpY0NvZGluZ0J5cGFzcyA9ICEhKGJsb2NrU3R5bGUgJiAxKTsKICAgICAgICAgICAgY29kLnJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXMgPSAhIShibG9ja1N0eWxlICYgMik7CiAgICAgICAgICAgIGNvZC50ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MgPSAhIShibG9ja1N0eWxlICYgNCk7CiAgICAgICAgICAgIGNvZC52ZXJ0aWNhbGx5U3RyaXBlID0gISEoYmxvY2tTdHlsZSAmIDgpOwogICAgICAgICAgICBjb2QucHJlZGljdGFibGVUZXJtaW5hdGlvbiA9ICEhKGJsb2NrU3R5bGUgJiAxNik7CiAgICAgICAgICAgIGNvZC5zZWdtZW50YXRpb25TeW1ib2xVc2VkID0gISEoYmxvY2tTdHlsZSAmIDMyKTsKICAgICAgICAgICAgY29kLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbiA9IGRhdGFbaisrXTsKCiAgICAgICAgICAgIGlmIChjb2QuZW50cm9weUNvZGVyV2l0aEN1c3RvbVByZWNpbmN0cykgewogICAgICAgICAgICAgIGNvbnN0IHByZWNpbmN0c1NpemVzID0gW107CgogICAgICAgICAgICAgIHdoaWxlIChqIDwgbGVuZ3RoICsgcG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIGNvbnN0IHByZWNpbmN0c1NpemUgPSBkYXRhW2orK107CiAgICAgICAgICAgICAgICBwcmVjaW5jdHNTaXplcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgUFB4OiBwcmVjaW5jdHNTaXplICYgMHhmLAogICAgICAgICAgICAgICAgICBQUHk6IHByZWNpbmN0c1NpemUgPj4gNAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb2QucHJlY2luY3RzU2l6ZXMgPSBwcmVjaW5jdHNTaXplczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgdW5zdXBwb3J0ZWQgPSBbXTsKCiAgICAgICAgICAgIGlmIChjb2Quc2VsZWN0aXZlQXJpdGhtZXRpY0NvZGluZ0J5cGFzcykgewogICAgICAgICAgICAgIHVuc3VwcG9ydGVkLnB1c2goInNlbGVjdGl2ZUFyaXRobWV0aWNDb2RpbmdCeXBhc3MiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNvZC50ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MpIHsKICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJ0ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGNvZC52ZXJ0aWNhbGx5U3RyaXBlKSB7CiAgICAgICAgICAgICAgdW5zdXBwb3J0ZWQucHVzaCgidmVydGljYWxseVN0cmlwZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29kLnByZWRpY3RhYmxlVGVybWluYXRpb24pIHsKICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJwcmVkaWN0YWJsZVRlcm1pbmF0aW9uIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh1bnN1cHBvcnRlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgZG9Ob3RSZWNvdmVyID0gdHJ1ZTsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYEpQWDogVW5zdXBwb3J0ZWQgQ09EIG9wdGlvbnMgKCR7dW5zdXBwb3J0ZWQuam9pbigiLCAiKX0pLmApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29udGV4dC5tYWluSGVhZGVyKSB7CiAgICAgICAgICAgICAgY29udGV4dC5DT0QgPSBjb2Q7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZS5DT0QgPSBjb2Q7CiAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZS5DT0MgPSBbXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmOTA6CiAgICAgICAgICAgIGxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgICAgIHRpbGUgPSB7fTsKICAgICAgICAgICAgdGlsZS5pbmRleCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbiArIDIpOwogICAgICAgICAgICB0aWxlLmxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICAgICAgICB0aWxlLmRhdGFFbmQgPSB0aWxlLmxlbmd0aCArIHBvc2l0aW9uIC0gMjsKICAgICAgICAgICAgdGlsZS5wYXJ0SW5kZXggPSBkYXRhW3Bvc2l0aW9uICsgOF07CiAgICAgICAgICAgIHRpbGUucGFydHNDb3VudCA9IGRhdGFbcG9zaXRpb24gKyA5XTsKICAgICAgICAgICAgY29udGV4dC5tYWluSGVhZGVyID0gZmFsc2U7CgogICAgICAgICAgICBpZiAodGlsZS5wYXJ0SW5kZXggPT09IDApIHsKICAgICAgICAgICAgICB0aWxlLkNPRCA9IGNvbnRleHQuQ09EOwogICAgICAgICAgICAgIHRpbGUuQ09DID0gY29udGV4dC5DT0Muc2xpY2UoMCk7CiAgICAgICAgICAgICAgdGlsZS5RQ0QgPSBjb250ZXh0LlFDRDsKICAgICAgICAgICAgICB0aWxlLlFDQyA9IGNvbnRleHQuUUNDLnNsaWNlKDApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlID0gdGlsZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmOTM6CiAgICAgICAgICAgIHRpbGUgPSBjb250ZXh0LmN1cnJlbnRUaWxlOwoKICAgICAgICAgICAgaWYgKHRpbGUucGFydEluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgaW5pdGlhbGl6ZVRpbGUoY29udGV4dCwgdGlsZS5pbmRleCk7CiAgICAgICAgICAgICAgYnVpbGRQYWNrZXRzKGNvbnRleHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZW5ndGggPSB0aWxlLmRhdGFFbmQgLSBwb3NpdGlvbjsKICAgICAgICAgICAgcGFyc2VUaWxlUGFja2V0cyhjb250ZXh0LCBkYXRhLCBwb3NpdGlvbiwgbGVuZ3RoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmNTM6CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSlBYOiBDb2Rlc3RyZWFtIGNvZGUgMHhGRjUzIChDT0MpIGlzIG5vdCBpbXBsZW1lbnRlZC4iKTsKCiAgICAgICAgICBjYXNlIDB4ZmY1NToKICAgICAgICAgIGNhc2UgMHhmZjU3OgogICAgICAgICAgY2FzZSAweGZmNTg6CiAgICAgICAgICBjYXNlIDB4ZmY2NDoKICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIGNvZGVzdHJlYW0gY29kZTogIiArIGNvZGUudG9TdHJpbmcoMTYpKTsKICAgICAgICB9CgogICAgICAgIHBvc2l0aW9uICs9IGxlbmd0aDsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAoZG9Ob3RSZWNvdmVyIHx8IHRoaXMuZmFpbE9uQ29ycnVwdGVkSW1hZ2UpIHsKICAgICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoZS5tZXNzYWdlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYEpQWDogVHJ5aW5nIHRvIHJlY292ZXIgZnJvbTogIiR7ZS5tZXNzYWdlfSIuYCk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnRpbGVzID0gdHJhbnNmb3JtQ29tcG9uZW50cyhjb250ZXh0KTsKICAgIHRoaXMud2lkdGggPSBjb250ZXh0LlNJWi5Yc2l6IC0gY29udGV4dC5TSVouWE9zaXo7CiAgICB0aGlzLmhlaWdodCA9IGNvbnRleHQuU0laLllzaXogLSBjb250ZXh0LlNJWi5ZT3NpejsKICAgIHRoaXMuY29tcG9uZW50c0NvdW50ID0gY29udGV4dC5TSVouQ3NpejsKICB9Cgp9CgpleHBvcnRzLkpweEltYWdlID0gSnB4SW1hZ2U7CgpmdW5jdGlvbiBjYWxjdWxhdGVDb21wb25lbnREaW1lbnNpb25zKGNvbXBvbmVudCwgc2l6KSB7CiAgY29tcG9uZW50LngwID0gTWF0aC5jZWlsKHNpei5YT3NpeiAvIGNvbXBvbmVudC5YUnNpeik7CiAgY29tcG9uZW50LngxID0gTWF0aC5jZWlsKHNpei5Yc2l6IC8gY29tcG9uZW50LlhSc2l6KTsKICBjb21wb25lbnQueTAgPSBNYXRoLmNlaWwoc2l6LllPc2l6IC8gY29tcG9uZW50LllSc2l6KTsKICBjb21wb25lbnQueTEgPSBNYXRoLmNlaWwoc2l6LllzaXogLyBjb21wb25lbnQuWVJzaXopOwogIGNvbXBvbmVudC53aWR0aCA9IGNvbXBvbmVudC54MSAtIGNvbXBvbmVudC54MDsKICBjb21wb25lbnQuaGVpZ2h0ID0gY29tcG9uZW50LnkxIC0gY29tcG9uZW50LnkwOwp9CgpmdW5jdGlvbiBjYWxjdWxhdGVUaWxlR3JpZHMoY29udGV4dCwgY29tcG9uZW50cykgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVzID0gW107CiAgbGV0IHRpbGU7CiAgY29uc3QgbnVtWHRpbGVzID0gTWF0aC5jZWlsKChzaXouWHNpeiAtIHNpei5YVE9zaXopIC8gc2l6LlhUc2l6KTsKICBjb25zdCBudW1ZdGlsZXMgPSBNYXRoLmNlaWwoKHNpei5Zc2l6IC0gc2l6LllUT3NpeikgLyBzaXouWVRzaXopOwoKICBmb3IgKGxldCBxID0gMDsgcSA8IG51bVl0aWxlczsgcSsrKSB7CiAgICBmb3IgKGxldCBwID0gMDsgcCA8IG51bVh0aWxlczsgcCsrKSB7CiAgICAgIHRpbGUgPSB7fTsKICAgICAgdGlsZS50eDAgPSBNYXRoLm1heChzaXouWFRPc2l6ICsgcCAqIHNpei5YVHNpeiwgc2l6LlhPc2l6KTsKICAgICAgdGlsZS50eTAgPSBNYXRoLm1heChzaXouWVRPc2l6ICsgcSAqIHNpei5ZVHNpeiwgc2l6LllPc2l6KTsKICAgICAgdGlsZS50eDEgPSBNYXRoLm1pbihzaXouWFRPc2l6ICsgKHAgKyAxKSAqIHNpei5YVHNpeiwgc2l6LlhzaXopOwogICAgICB0aWxlLnR5MSA9IE1hdGgubWluKHNpei5ZVE9zaXogKyAocSArIDEpICogc2l6LllUc2l6LCBzaXouWXNpeik7CiAgICAgIHRpbGUud2lkdGggPSB0aWxlLnR4MSAtIHRpbGUudHgwOwogICAgICB0aWxlLmhlaWdodCA9IHRpbGUudHkxIC0gdGlsZS50eTA7CiAgICAgIHRpbGUuY29tcG9uZW50cyA9IFtdOwogICAgICB0aWxlcy5wdXNoKHRpbGUpOwogICAgfQogIH0KCiAgY29udGV4dC50aWxlcyA9IHRpbGVzOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb21wb25lbnRzQ291bnQ7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldOwoKICAgIGZvciAobGV0IGogPSAwLCBqaiA9IHRpbGVzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgY29uc3QgdGlsZUNvbXBvbmVudCA9IHt9OwogICAgICB0aWxlID0gdGlsZXNbal07CiAgICAgIHRpbGVDb21wb25lbnQudGN4MCA9IE1hdGguY2VpbCh0aWxlLnR4MCAvIGNvbXBvbmVudC5YUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN5MCA9IE1hdGguY2VpbCh0aWxlLnR5MCAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN4MSA9IE1hdGguY2VpbCh0aWxlLnR4MSAvIGNvbXBvbmVudC5YUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQudGN5MSA9IE1hdGguY2VpbCh0aWxlLnR5MSAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICAgIHRpbGVDb21wb25lbnQud2lkdGggPSB0aWxlQ29tcG9uZW50LnRjeDEgLSB0aWxlQ29tcG9uZW50LnRjeDA7CiAgICAgIHRpbGVDb21wb25lbnQuaGVpZ2h0ID0gdGlsZUNvbXBvbmVudC50Y3kxIC0gdGlsZUNvbXBvbmVudC50Y3kwOwogICAgICB0aWxlLmNvbXBvbmVudHNbaV0gPSB0aWxlQ29tcG9uZW50OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZ2V0QmxvY2tzRGltZW5zaW9ucyhjb250ZXh0LCBjb21wb25lbnQsIHIpIHsKICBjb25zdCBjb2RPckNvYyA9IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnM7CiAgY29uc3QgcmVzdWx0ID0ge307CgogIGlmICghY29kT3JDb2MuZW50cm9weUNvZGVyV2l0aEN1c3RvbVByZWNpbmN0cykgewogICAgcmVzdWx0LlBQeCA9IDE1OwogICAgcmVzdWx0LlBQeSA9IDE1OwogIH0gZWxzZSB7CiAgICByZXN1bHQuUFB4ID0gY29kT3JDb2MucHJlY2luY3RzU2l6ZXNbcl0uUFB4OwogICAgcmVzdWx0LlBQeSA9IGNvZE9yQ29jLnByZWNpbmN0c1NpemVzW3JdLlBQeTsKICB9CgogIHJlc3VsdC54Y2JfID0gciA+IDAgPyBNYXRoLm1pbihjb2RPckNvYy54Y2IsIHJlc3VsdC5QUHggLSAxKSA6IE1hdGgubWluKGNvZE9yQ29jLnhjYiwgcmVzdWx0LlBQeCk7CiAgcmVzdWx0LnljYl8gPSByID4gMCA/IE1hdGgubWluKGNvZE9yQ29jLnljYiwgcmVzdWx0LlBQeSAtIDEpIDogTWF0aC5taW4oY29kT3JDb2MueWNiLCByZXN1bHQuUFB5KTsKICByZXR1cm4gcmVzdWx0Owp9CgpmdW5jdGlvbiBidWlsZFByZWNpbmN0cyhjb250ZXh0LCByZXNvbHV0aW9uLCBkaW1lbnNpb25zKSB7CiAgY29uc3QgcHJlY2luY3RXaWR0aCA9IDEgPDwgZGltZW5zaW9ucy5QUHg7CiAgY29uc3QgcHJlY2luY3RIZWlnaHQgPSAxIDw8IGRpbWVuc2lvbnMuUFB5OwogIGNvbnN0IGlzWmVyb1JlcyA9IHJlc29sdXRpb24ucmVzTGV2ZWwgPT09IDA7CiAgY29uc3QgcHJlY2luY3RXaWR0aEluU3ViYmFuZCA9IDEgPDwgZGltZW5zaW9ucy5QUHggKyAoaXNaZXJvUmVzID8gMCA6IC0xKTsKICBjb25zdCBwcmVjaW5jdEhlaWdodEluU3ViYmFuZCA9IDEgPDwgZGltZW5zaW9ucy5QUHkgKyAoaXNaZXJvUmVzID8gMCA6IC0xKTsKICBjb25zdCBudW1wcmVjaW5jdHN3aWRlID0gcmVzb2x1dGlvbi50cngxID4gcmVzb2x1dGlvbi50cngwID8gTWF0aC5jZWlsKHJlc29sdXRpb24udHJ4MSAvIHByZWNpbmN0V2lkdGgpIC0gTWF0aC5mbG9vcihyZXNvbHV0aW9uLnRyeDAgLyBwcmVjaW5jdFdpZHRoKSA6IDA7CiAgY29uc3QgbnVtcHJlY2luY3RzaGlnaCA9IHJlc29sdXRpb24udHJ5MSA+IHJlc29sdXRpb24udHJ5MCA/IE1hdGguY2VpbChyZXNvbHV0aW9uLnRyeTEgLyBwcmVjaW5jdEhlaWdodCkgLSBNYXRoLmZsb29yKHJlc29sdXRpb24udHJ5MCAvIHByZWNpbmN0SGVpZ2h0KSA6IDA7CiAgY29uc3QgbnVtcHJlY2luY3RzID0gbnVtcHJlY2luY3Rzd2lkZSAqIG51bXByZWNpbmN0c2hpZ2g7CiAgcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMgPSB7CiAgICBwcmVjaW5jdFdpZHRoLAogICAgcHJlY2luY3RIZWlnaHQsCiAgICBudW1wcmVjaW5jdHN3aWRlLAogICAgbnVtcHJlY2luY3RzaGlnaCwKICAgIG51bXByZWNpbmN0cywKICAgIHByZWNpbmN0V2lkdGhJblN1YmJhbmQsCiAgICBwcmVjaW5jdEhlaWdodEluU3ViYmFuZAogIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBkaW1lbnNpb25zKSB7CiAgY29uc3QgeGNiXyA9IGRpbWVuc2lvbnMueGNiXzsKICBjb25zdCB5Y2JfID0gZGltZW5zaW9ucy55Y2JfOwogIGNvbnN0IGNvZGVibG9ja1dpZHRoID0gMSA8PCB4Y2JfOwogIGNvbnN0IGNvZGVibG9ja0hlaWdodCA9IDEgPDwgeWNiXzsKICBjb25zdCBjYngwID0gc3ViYmFuZC50YngwID4+IHhjYl87CiAgY29uc3QgY2J5MCA9IHN1YmJhbmQudGJ5MCA+PiB5Y2JfOwogIGNvbnN0IGNieDEgPSBzdWJiYW5kLnRieDEgKyBjb2RlYmxvY2tXaWR0aCAtIDEgPj4geGNiXzsKICBjb25zdCBjYnkxID0gc3ViYmFuZC50YnkxICsgY29kZWJsb2NrSGVpZ2h0IC0gMSA+PiB5Y2JfOwogIGNvbnN0IHByZWNpbmN0UGFyYW1ldGVycyA9IHN1YmJhbmQucmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnM7CiAgY29uc3QgY29kZWJsb2NrcyA9IFtdOwogIGNvbnN0IHByZWNpbmN0cyA9IFtdOwogIGxldCBpLCBqLCBjb2RlYmxvY2ssIHByZWNpbmN0TnVtYmVyOwoKICBmb3IgKGogPSBjYnkwOyBqIDwgY2J5MTsgaisrKSB7CiAgICBmb3IgKGkgPSBjYngwOyBpIDwgY2J4MTsgaSsrKSB7CiAgICAgIGNvZGVibG9jayA9IHsKICAgICAgICBjYng6IGksCiAgICAgICAgY2J5OiBqLAogICAgICAgIHRieDA6IGNvZGVibG9ja1dpZHRoICogaSwKICAgICAgICB0YnkwOiBjb2RlYmxvY2tIZWlnaHQgKiBqLAogICAgICAgIHRieDE6IGNvZGVibG9ja1dpZHRoICogKGkgKyAxKSwKICAgICAgICB0YnkxOiBjb2RlYmxvY2tIZWlnaHQgKiAoaiArIDEpCiAgICAgIH07CiAgICAgIGNvZGVibG9jay50YngwXyA9IE1hdGgubWF4KHN1YmJhbmQudGJ4MCwgY29kZWJsb2NrLnRieDApOwogICAgICBjb2RlYmxvY2sudGJ5MF8gPSBNYXRoLm1heChzdWJiYW5kLnRieTAsIGNvZGVibG9jay50YnkwKTsKICAgICAgY29kZWJsb2NrLnRieDFfID0gTWF0aC5taW4oc3ViYmFuZC50YngxLCBjb2RlYmxvY2sudGJ4MSk7CiAgICAgIGNvZGVibG9jay50YnkxXyA9IE1hdGgubWluKHN1YmJhbmQudGJ5MSwgY29kZWJsb2NrLnRieTEpOwogICAgICBjb25zdCBwaSA9IE1hdGguZmxvb3IoKGNvZGVibG9jay50YngwXyAtIHN1YmJhbmQudGJ4MCkgLyBwcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RXaWR0aEluU3ViYmFuZCk7CiAgICAgIGNvbnN0IHBqID0gTWF0aC5mbG9vcigoY29kZWJsb2NrLnRieTBfIC0gc3ViYmFuZC50YnkwKSAvIHByZWNpbmN0UGFyYW1ldGVycy5wcmVjaW5jdEhlaWdodEluU3ViYmFuZCk7CiAgICAgIHByZWNpbmN0TnVtYmVyID0gcGkgKyBwaiAqIHByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHN3aWRlOwogICAgICBjb2RlYmxvY2sucHJlY2luY3ROdW1iZXIgPSBwcmVjaW5jdE51bWJlcjsKICAgICAgY29kZWJsb2NrLnN1YmJhbmRUeXBlID0gc3ViYmFuZC50eXBlOwogICAgICBjb2RlYmxvY2suTGJsb2NrID0gMzsKCiAgICAgIGlmIChjb2RlYmxvY2sudGJ4MV8gPD0gY29kZWJsb2NrLnRieDBfIHx8IGNvZGVibG9jay50YnkxXyA8PSBjb2RlYmxvY2sudGJ5MF8pIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29kZWJsb2Nrcy5wdXNoKGNvZGVibG9jayk7CiAgICAgIGxldCBwcmVjaW5jdCA9IHByZWNpbmN0c1twcmVjaW5jdE51bWJlcl07CgogICAgICBpZiAocHJlY2luY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChpIDwgcHJlY2luY3QuY2J4TWluKSB7CiAgICAgICAgICBwcmVjaW5jdC5jYnhNaW4gPSBpOwogICAgICAgIH0gZWxzZSBpZiAoaSA+IHByZWNpbmN0LmNieE1heCkgewogICAgICAgICAgcHJlY2luY3QuY2J4TWF4ID0gaTsKICAgICAgICB9CgogICAgICAgIGlmIChqIDwgcHJlY2luY3QuY2J5TWluKSB7CiAgICAgICAgICBwcmVjaW5jdC5jYnhNaW4gPSBqOwogICAgICAgIH0gZWxzZSBpZiAoaiA+IHByZWNpbmN0LmNieU1heCkgewogICAgICAgICAgcHJlY2luY3QuY2J5TWF4ID0gajsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcHJlY2luY3RzW3ByZWNpbmN0TnVtYmVyXSA9IHByZWNpbmN0ID0gewogICAgICAgICAgY2J4TWluOiBpLAogICAgICAgICAgY2J5TWluOiBqLAogICAgICAgICAgY2J4TWF4OiBpLAogICAgICAgICAgY2J5TWF4OiBqCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgY29kZWJsb2NrLnByZWNpbmN0ID0gcHJlY2luY3Q7CiAgICB9CiAgfQoKICBzdWJiYW5kLmNvZGVibG9ja1BhcmFtZXRlcnMgPSB7CiAgICBjb2RlYmxvY2tXaWR0aDogeGNiXywKICAgIGNvZGVibG9ja0hlaWdodDogeWNiXywKICAgIG51bWNvZGVibG9ja3dpZGU6IGNieDEgLSBjYngwICsgMSwKICAgIG51bWNvZGVibG9ja2hpZ2g6IGNieTEgLSBjYnkwICsgMQogIH07CiAgc3ViYmFuZC5jb2RlYmxvY2tzID0gY29kZWJsb2NrczsKICBzdWJiYW5kLnByZWNpbmN0cyA9IHByZWNpbmN0czsKfQoKZnVuY3Rpb24gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIHByZWNpbmN0TnVtYmVyLCBsYXllck51bWJlcikgewogIGNvbnN0IHByZWNpbmN0Q29kZWJsb2NrcyA9IFtdOwogIGNvbnN0IHN1YmJhbmRzID0gcmVzb2x1dGlvbi5zdWJiYW5kczsKCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3ViYmFuZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3Qgc3ViYmFuZCA9IHN1YmJhbmRzW2ldOwogICAgY29uc3QgY29kZWJsb2NrcyA9IHN1YmJhbmQuY29kZWJsb2NrczsKCiAgICBmb3IgKGxldCBqID0gMCwgamogPSBjb2RlYmxvY2tzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgY29uc3QgY29kZWJsb2NrID0gY29kZWJsb2Nrc1tqXTsKCiAgICAgIGlmIChjb2RlYmxvY2sucHJlY2luY3ROdW1iZXIgIT09IHByZWNpbmN0TnVtYmVyKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHByZWNpbmN0Q29kZWJsb2Nrcy5wdXNoKGNvZGVibG9jayk7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgbGF5ZXJOdW1iZXIsCiAgICBjb2RlYmxvY2tzOiBwcmVjaW5jdENvZGVibG9ja3MKICB9Owp9CgpmdW5jdGlvbiBMYXllclJlc29sdXRpb25Db21wb25lbnRQb3NpdGlvbkl0ZXJhdG9yKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgY29uc3QgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgbGV0IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IDA7CgogIGZvciAobGV0IHEgPSAwOyBxIDwgY29tcG9uZW50c0NvdW50OyBxKyspIHsKICAgIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IE1hdGgubWF4KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCwgdGlsZS5jb21wb25lbnRzW3FdLmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpOwogIH0KCiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgaSA9IDAsCiAgICAgIGsgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IGwgPCBsYXllcnNDb3VudDsgbCsrKSB7CiAgICAgIGZvciAoOyByIDw9IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgcisrKSB7CiAgICAgICAgZm9yICg7IGkgPCBjb21wb25lbnRzQ291bnQ7IGkrKykgewogICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2ldOwoKICAgICAgICAgIGlmIChyID4gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgIGNvbnN0IG51bXByZWNpbmN0cyA9IHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0czsKCiAgICAgICAgICBmb3IgKDsgayA8IG51bXByZWNpbmN0czspIHsKICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICBrKys7CiAgICAgICAgICAgIHJldHVybiBwYWNrZXQ7CiAgICAgICAgICB9CgogICAgICAgICAgayA9IDA7CiAgICAgICAgfQoKICAgICAgICBpID0gMDsKICAgICAgfQoKICAgICAgciA9IDA7CiAgICB9CgogICAgdGhyb3cgbmV3IEpweEVycm9yKCJPdXQgb2YgcGFja2V0cyIpOwogIH07Cn0KCmZ1bmN0aW9uIFJlc29sdXRpb25MYXllckNvbXBvbmVudFBvc2l0aW9uSXRlcmF0b3IoY29udGV4dCkgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVJbmRleCA9IGNvbnRleHQuY3VycmVudFRpbGUuaW5kZXg7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKICBjb25zdCBsYXllcnNDb3VudCA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5sYXllcnNDb3VudDsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKICBsZXQgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gMDsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb21wb25lbnRzQ291bnQ7IHErKykgewogICAgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gTWF0aC5tYXgobWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50LCB0aWxlLmNvbXBvbmVudHNbcV0uY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudCk7CiAgfQoKICBsZXQgciA9IDAsCiAgICAgIGwgPSAwLAogICAgICBpID0gMCwKICAgICAgayA9IDA7CgogIHRoaXMubmV4dFBhY2tldCA9IGZ1bmN0aW9uIEpweEltYWdlX25leHRQYWNrZXQoKSB7CiAgICBmb3IgKDsgciA8PSBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IHIrKykgewogICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OyBsKyspIHsKICAgICAgICBmb3IgKDsgaSA8IGNvbXBvbmVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbaV07CgogICAgICAgICAgaWYgKHIgPiBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICAgICAgY29uc3QgbnVtcHJlY2luY3RzID0gcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMubnVtcHJlY2luY3RzOwoKICAgICAgICAgIGZvciAoOyBrIDwgbnVtcHJlY2luY3RzOykgewogICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBjcmVhdGVQYWNrZXQocmVzb2x1dGlvbiwgaywgbCk7CiAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgcmV0dXJuIHBhY2tldDsKICAgICAgICAgIH0KCiAgICAgICAgICBrID0gMDsKICAgICAgICB9CgogICAgICAgIGkgPSAwOwogICAgICB9CgogICAgICBsID0gMDsKICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgfTsKfQoKZnVuY3Rpb24gUmVzb2x1dGlvblBvc2l0aW9uQ29tcG9uZW50TGF5ZXJJdGVyYXRvcihjb250ZXh0KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IGxheWVyc0NvdW50ID0gdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzLmxheWVyc0NvdW50OwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogIGxldCBsLCByLCBjLCBwOwogIGxldCBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSAwOwoKICBmb3IgKGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IE1hdGgubWF4KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCwgY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpOwogIH0KCiAgY29uc3QgbWF4TnVtUHJlY2luY3RzSW5MZXZlbCA9IG5ldyBJbnQzMkFycmF5KG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCArIDEpOwoKICBmb3IgKHIgPSAwOyByIDw9IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgKytyKSB7CiAgICBsZXQgbWF4TnVtUHJlY2luY3RzID0gMDsKCiAgICBmb3IgKGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyArK2MpIHsKICAgICAgY29uc3QgcmVzb2x1dGlvbnMgPSB0aWxlLmNvbXBvbmVudHNbY10ucmVzb2x1dGlvbnM7CgogICAgICBpZiAociA8IHJlc29sdXRpb25zLmxlbmd0aCkgewogICAgICAgIG1heE51bVByZWNpbmN0cyA9IE1hdGgubWF4KG1heE51bVByZWNpbmN0cywgcmVzb2x1dGlvbnNbcl0ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0cyk7CiAgICAgIH0KICAgIH0KCiAgICBtYXhOdW1QcmVjaW5jdHNJbkxldmVsW3JdID0gbWF4TnVtUHJlY2luY3RzOwogIH0KCiAgbCA9IDA7CiAgciA9IDA7CiAgYyA9IDA7CiAgcCA9IDA7CgogIHRoaXMubmV4dFBhY2tldCA9IGZ1bmN0aW9uIEpweEltYWdlX25leHRQYWNrZXQoKSB7CiAgICBmb3IgKDsgciA8PSBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IHIrKykgewogICAgICBmb3IgKDsgcCA8IG1heE51bVByZWNpbmN0c0luTGV2ZWxbcl07IHArKykgewogICAgICAgIGZvciAoOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKCiAgICAgICAgICBpZiAociA+IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50KSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSBjb21wb25lbnQucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICBjb25zdCBudW1wcmVjaW5jdHMgPSByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHM7CgogICAgICAgICAgaWYgKHAgPj0gbnVtcHJlY2luY3RzKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAoOyBsIDwgbGF5ZXJzQ291bnQ7KSB7CiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IGNyZWF0ZVBhY2tldChyZXNvbHV0aW9uLCBwLCBsKTsKICAgICAgICAgICAgbCsrOwogICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgfQoKICAgICAgICAgIGwgPSAwOwogICAgICAgIH0KCiAgICAgICAgYyA9IDA7CiAgICAgIH0KCiAgICAgIHAgPSAwOwogICAgfQoKICAgIHRocm93IG5ldyBKcHhFcnJvcigiT3V0IG9mIHBhY2tldHMiKTsKICB9Owp9CgpmdW5jdGlvbiBQb3NpdGlvbkNvbXBvbmVudFJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgY29uc3QgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgY29uc3QgcHJlY2luY3RzU2l6ZXMgPSBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpOwogIGNvbnN0IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXM7CiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgYyA9IDAsCiAgICAgIHB4ID0gMCwKICAgICAgcHkgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IHB5IDwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMubWF4TnVtSGlnaDsgcHkrKykgewogICAgICBmb3IgKDsgcHggPCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcy5tYXhOdW1XaWRlOyBweCsrKSB7CiAgICAgICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgICAgICAgY29uc3QgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICAgICAgZm9yICg7IHIgPD0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgY29uc3Qgc2l6ZUluSW1hZ2VTY2FsZSA9IHByZWNpbmN0c1NpemVzLmNvbXBvbmVudHNbY10ucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICAgIGNvbnN0IGsgPSBnZXRQcmVjaW5jdEluZGV4SWZFeGlzdChweCwgcHksIHNpemVJbkltYWdlU2NhbGUsIHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLCByZXNvbHV0aW9uKTsKCiAgICAgICAgICAgIGlmIChrID09PSBudWxsKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAoOyBsIDwgbGF5ZXJzQ291bnQ7KSB7CiAgICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICAgIGwrKzsKICAgICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBsID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICByID0gMDsKICAgICAgICB9CgogICAgICAgIGMgPSAwOwogICAgICB9CgogICAgICBweCA9IDA7CiAgICB9CgogICAgdGhyb3cgbmV3IEpweEVycm9yKCJPdXQgb2YgcGFja2V0cyIpOwogIH07Cn0KCmZ1bmN0aW9uIENvbXBvbmVudFBvc2l0aW9uUmVzb2x1dGlvbkxheWVySXRlcmF0b3IoY29udGV4dCkgewogIGNvbnN0IHNpeiA9IGNvbnRleHQuU0laOwogIGNvbnN0IHRpbGVJbmRleCA9IGNvbnRleHQuY3VycmVudFRpbGUuaW5kZXg7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKICBjb25zdCBsYXllcnNDb3VudCA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5sYXllcnNDb3VudDsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKICBjb25zdCBwcmVjaW5jdHNTaXplcyA9IGdldFByZWNpbmN0U2l6ZXNJbkltYWdlU2NhbGUodGlsZSk7CiAgbGV0IGwgPSAwLAogICAgICByID0gMCwKICAgICAgYyA9IDAsCiAgICAgIHB4ID0gMCwKICAgICAgcHkgPSAwOwoKICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7ICsrYykgewogICAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbY107CiAgICAgIGNvbnN0IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXMuY29tcG9uZW50c1tjXTsKICAgICAgY29uc3QgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICBmb3IgKDsgcHkgPCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcy5tYXhOdW1IaWdoOyBweSsrKSB7CiAgICAgICAgZm9yICg7IHB4IDwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMubWF4TnVtV2lkZTsgcHgrKykgewogICAgICAgICAgZm9yICg7IHIgPD0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgY29uc3Qgc2l6ZUluSW1hZ2VTY2FsZSA9IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLnJlc29sdXRpb25zW3JdOwogICAgICAgICAgICBjb25zdCBrID0gZ2V0UHJlY2luY3RJbmRleElmRXhpc3QocHgsIHB5LCBzaXplSW5JbWFnZVNjYWxlLCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcywgcmVzb2x1dGlvbik7CgogICAgICAgICAgICBpZiAoayA9PT0gbnVsbCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OykgewogICAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IGNyZWF0ZVBhY2tldChyZXNvbHV0aW9uLCBrLCBsKTsKICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgICAgcmV0dXJuIHBhY2tldDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbCA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgciA9IDA7CiAgICAgICAgfQoKICAgICAgICBweCA9IDA7CiAgICAgIH0KCiAgICAgIHB5ID0gMDsKICAgIH0KCiAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgfTsKfQoKZnVuY3Rpb24gZ2V0UHJlY2luY3RJbmRleElmRXhpc3QocHhJbmRleCwgcHlJbmRleCwgc2l6ZUluSW1hZ2VTY2FsZSwgcHJlY2luY3RJdGVyYXRpb25TaXplcywgcmVzb2x1dGlvbikgewogIGNvbnN0IHBvc1ggPSBweEluZGV4ICogcHJlY2luY3RJdGVyYXRpb25TaXplcy5taW5XaWR0aDsKICBjb25zdCBwb3NZID0gcHlJbmRleCAqIHByZWNpbmN0SXRlcmF0aW9uU2l6ZXMubWluSGVpZ2h0OwoKICBpZiAocG9zWCAlIHNpemVJbkltYWdlU2NhbGUud2lkdGggIT09IDAgfHwgcG9zWSAlIHNpemVJbkltYWdlU2NhbGUuaGVpZ2h0ICE9PSAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IHN0YXJ0UHJlY2luY3RSb3dJbmRleCA9IHBvc1kgLyBzaXplSW5JbWFnZVNjYWxlLndpZHRoICogcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMubnVtcHJlY2luY3Rzd2lkZTsKICByZXR1cm4gcG9zWCAvIHNpemVJbkltYWdlU2NhbGUuaGVpZ2h0ICsgc3RhcnRQcmVjaW5jdFJvd0luZGV4Owp9CgpmdW5jdGlvbiBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpIHsKICBjb25zdCBjb21wb25lbnRzQ291bnQgPSB0aWxlLmNvbXBvbmVudHMubGVuZ3RoOwogIGxldCBtaW5XaWR0aCA9IE51bWJlci5NQVhfVkFMVUU7CiAgbGV0IG1pbkhlaWdodCA9IE51bWJlci5NQVhfVkFMVUU7CiAgbGV0IG1heE51bVdpZGUgPSAwOwogIGxldCBtYXhOdW1IaWdoID0gMDsKICBjb25zdCBzaXplUGVyQ29tcG9uZW50ID0gbmV3IEFycmF5KGNvbXBvbmVudHNDb3VudCk7CgogIGZvciAobGV0IGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgIGNvbnN0IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogICAgY29uc3Qgc2l6ZVBlclJlc29sdXRpb24gPSBuZXcgQXJyYXkoZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ICsgMSk7CiAgICBsZXQgbWluV2lkdGhDdXJyZW50Q29tcG9uZW50ID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50ID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIGxldCBtYXhOdW1XaWRlQ3VycmVudENvbXBvbmVudCA9IDA7CiAgICBsZXQgbWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQgPSAwOwogICAgbGV0IHNjYWxlID0gMTsKCiAgICBmb3IgKGxldCByID0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByID49IDA7IC0tcikgewogICAgICBjb25zdCByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICBjb25zdCB3aWR0aEN1cnJlbnRSZXNvbHV0aW9uID0gc2NhbGUgKiByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5wcmVjaW5jdFdpZHRoOwogICAgICBjb25zdCBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbiA9IHNjYWxlICogcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RIZWlnaHQ7CiAgICAgIG1pbldpZHRoQ3VycmVudENvbXBvbmVudCA9IE1hdGgubWluKG1pbldpZHRoQ3VycmVudENvbXBvbmVudCwgd2lkdGhDdXJyZW50UmVzb2x1dGlvbik7CiAgICAgIG1pbkhlaWdodEN1cnJlbnRDb21wb25lbnQgPSBNYXRoLm1pbihtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50LCBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbik7CiAgICAgIG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5tYXgobWF4TnVtV2lkZUN1cnJlbnRDb21wb25lbnQsIHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0c3dpZGUpOwogICAgICBtYXhOdW1IaWdoQ3VycmVudENvbXBvbmVudCA9IE1hdGgubWF4KG1heE51bUhpZ2hDdXJyZW50Q29tcG9uZW50LCByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHNoaWdoKTsKICAgICAgc2l6ZVBlclJlc29sdXRpb25bcl0gPSB7CiAgICAgICAgd2lkdGg6IHdpZHRoQ3VycmVudFJlc29sdXRpb24sCiAgICAgICAgaGVpZ2h0OiBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbgogICAgICB9OwogICAgICBzY2FsZSA8PD0gMTsKICAgIH0KCiAgICBtaW5XaWR0aCA9IE1hdGgubWluKG1pbldpZHRoLCBtaW5XaWR0aEN1cnJlbnRDb21wb25lbnQpOwogICAgbWluSGVpZ2h0ID0gTWF0aC5taW4obWluSGVpZ2h0LCBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50KTsKICAgIG1heE51bVdpZGUgPSBNYXRoLm1heChtYXhOdW1XaWRlLCBtYXhOdW1XaWRlQ3VycmVudENvbXBvbmVudCk7CiAgICBtYXhOdW1IaWdoID0gTWF0aC5tYXgobWF4TnVtSGlnaCwgbWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQpOwogICAgc2l6ZVBlckNvbXBvbmVudFtjXSA9IHsKICAgICAgcmVzb2x1dGlvbnM6IHNpemVQZXJSZXNvbHV0aW9uLAogICAgICBtaW5XaWR0aDogbWluV2lkdGhDdXJyZW50Q29tcG9uZW50LAogICAgICBtaW5IZWlnaHQ6IG1pbkhlaWdodEN1cnJlbnRDb21wb25lbnQsCiAgICAgIG1heE51bVdpZGU6IG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50LAogICAgICBtYXhOdW1IaWdoOiBtYXhOdW1IaWdoQ3VycmVudENvbXBvbmVudAogICAgfTsKICB9CgogIHJldHVybiB7CiAgICBjb21wb25lbnRzOiBzaXplUGVyQ29tcG9uZW50LAogICAgbWluV2lkdGgsCiAgICBtaW5IZWlnaHQsCiAgICBtYXhOdW1XaWRlLAogICAgbWF4TnVtSGlnaAogIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkUGFja2V0cyhjb250ZXh0KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwoKICBmb3IgKGxldCBjID0gMDsgYyA8IGNvbXBvbmVudHNDb3VudDsgYysrKSB7CiAgICBjb25zdCBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbY107CiAgICBjb25zdCBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudDsKICAgIGNvbnN0IHJlc29sdXRpb25zID0gW107CiAgICBjb25zdCBzdWJiYW5kcyA9IFtdOwoKICAgIGZvciAobGV0IHIgPSAwOyByIDw9IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgcisrKSB7CiAgICAgIGNvbnN0IGJsb2Nrc0RpbWVuc2lvbnMgPSBnZXRCbG9ja3NEaW1lbnNpb25zKGNvbnRleHQsIGNvbXBvbmVudCwgcik7CiAgICAgIGNvbnN0IHJlc29sdXRpb24gPSB7fTsKICAgICAgY29uc3Qgc2NhbGUgPSAxIDw8IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCAtIHI7CiAgICAgIHJlc29sdXRpb24udHJ4MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MCAvIHNjYWxlKTsKICAgICAgcmVzb2x1dGlvbi50cnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gc2NhbGUpOwogICAgICByZXNvbHV0aW9uLnRyeDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBzY2FsZSk7CiAgICAgIHJlc29sdXRpb24udHJ5MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MSAvIHNjYWxlKTsKICAgICAgcmVzb2x1dGlvbi5yZXNMZXZlbCA9IHI7CiAgICAgIGJ1aWxkUHJlY2luY3RzKGNvbnRleHQsIHJlc29sdXRpb24sIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICByZXNvbHV0aW9ucy5wdXNoKHJlc29sdXRpb24pOwogICAgICBsZXQgc3ViYmFuZDsKCiAgICAgIGlmIChyID09PSAwKSB7CiAgICAgICAgc3ViYmFuZCA9IHt9OwogICAgICAgIHN1YmJhbmQudHlwZSA9ICJMTCI7CiAgICAgICAgc3ViYmFuZC50YngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gc2NhbGUpOwogICAgICAgIHN1YmJhbmQudGJ5MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MCAvIHNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBzY2FsZSk7CiAgICAgICAgc3ViYmFuZC50YnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gc2NhbGUpOwogICAgICAgIHN1YmJhbmQucmVzb2x1dGlvbiA9IHJlc29sdXRpb247CiAgICAgICAgYnVpbGRDb2RlYmxvY2tzKGNvbnRleHQsIHN1YmJhbmQsIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgcmVzb2x1dGlvbi5zdWJiYW5kcyA9IFtzdWJiYW5kXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBic2NhbGUgPSAxIDw8IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCAtIHIgKyAxOwogICAgICAgIGNvbnN0IHJlc29sdXRpb25TdWJiYW5kcyA9IFtdOwogICAgICAgIHN1YmJhbmQgPSB7fTsKICAgICAgICBzdWJiYW5kLnR5cGUgPSAiSEwiOwogICAgICAgIHN1YmJhbmQudGJ4MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MCAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gYnNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQudGJ5MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MSAvIGJzY2FsZSk7CiAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICBidWlsZENvZGVibG9ja3MoY29udGV4dCwgc3ViYmFuZCwgYmxvY2tzRGltZW5zaW9ucyk7CiAgICAgICAgc3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICByZXNvbHV0aW9uU3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICBzdWJiYW5kID0ge307CiAgICAgICAgc3ViYmFuZC50eXBlID0gIkxIIjsKICAgICAgICBzdWJiYW5kLnRieDAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDAgLyBic2NhbGUpOwogICAgICAgIHN1YmJhbmQudGJ5MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MCAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YngxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gxIC8gYnNjYWxlKTsKICAgICAgICBzdWJiYW5kLnRieTEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQucmVzb2x1dGlvbiA9IHJlc29sdXRpb247CiAgICAgICAgYnVpbGRDb2RlYmxvY2tzKGNvbnRleHQsIHN1YmJhbmQsIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgcmVzb2x1dGlvblN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgc3ViYmFuZCA9IHt9OwogICAgICAgIHN1YmJhbmQudHlwZSA9ICJISCI7CiAgICAgICAgc3ViYmFuZC50YngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICBzdWJiYW5kLnRieTAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTAgLyBic2NhbGUgLSAwLjUpOwogICAgICAgIHN1YmJhbmQudGJ4MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MSAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgc3ViYmFuZC50YnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICBzdWJiYW5kLnJlc29sdXRpb24gPSByZXNvbHV0aW9uOwogICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICBzdWJiYW5kcy5wdXNoKHN1YmJhbmQpOwogICAgICAgIHJlc29sdXRpb25TdWJiYW5kcy5wdXNoKHN1YmJhbmQpOwogICAgICAgIHJlc29sdXRpb24uc3ViYmFuZHMgPSByZXNvbHV0aW9uU3ViYmFuZHM7CiAgICAgIH0KICAgIH0KCiAgICBjb21wb25lbnQucmVzb2x1dGlvbnMgPSByZXNvbHV0aW9uczsKICAgIGNvbXBvbmVudC5zdWJiYW5kcyA9IHN1YmJhbmRzOwogIH0KCiAgY29uc3QgcHJvZ3Jlc3Npb25PcmRlciA9IHRpbGUuY29kaW5nU3R5bGVEZWZhdWx0UGFyYW1ldGVycy5wcm9ncmVzc2lvbk9yZGVyOwoKICBzd2l0Y2ggKHByb2dyZXNzaW9uT3JkZXIpIHsKICAgIGNhc2UgMDoKICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgTGF5ZXJSZXNvbHV0aW9uQ29tcG9uZW50UG9zaXRpb25JdGVyYXRvcihjb250ZXh0KTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAxOgogICAgICB0aWxlLnBhY2tldHNJdGVyYXRvciA9IG5ldyBSZXNvbHV0aW9uTGF5ZXJDb21wb25lbnRQb3NpdGlvbkl0ZXJhdG9yKGNvbnRleHQpOwogICAgICBicmVhazsKCiAgICBjYXNlIDI6CiAgICAgIHRpbGUucGFja2V0c0l0ZXJhdG9yID0gbmV3IFJlc29sdXRpb25Qb3NpdGlvbkNvbXBvbmVudExheWVySXRlcmF0b3IoY29udGV4dCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgMzoKICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgUG9zaXRpb25Db21wb25lbnRSZXNvbHV0aW9uTGF5ZXJJdGVyYXRvcihjb250ZXh0KTsKICAgICAgYnJlYWs7CgogICAgY2FzZSA0OgogICAgICB0aWxlLnBhY2tldHNJdGVyYXRvciA9IG5ldyBDb21wb25lbnRQb3NpdGlvblJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoYFVuc3VwcG9ydGVkIHByb2dyZXNzaW9uIG9yZGVyICR7cHJvZ3Jlc3Npb25PcmRlcn1gKTsKICB9Cn0KCmZ1bmN0aW9uIHBhcnNlVGlsZVBhY2tldHMoY29udGV4dCwgZGF0YSwgb2Zmc2V0LCBkYXRhTGVuZ3RoKSB7CiAgbGV0IHBvc2l0aW9uID0gMDsKICBsZXQgYnVmZmVyLAogICAgICBidWZmZXJTaXplID0gMCwKICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gcmVhZEJpdHMoY291bnQpIHsKICAgIHdoaWxlIChidWZmZXJTaXplIDwgY291bnQpIHsKICAgICAgY29uc3QgYiA9IGRhdGFbb2Zmc2V0ICsgcG9zaXRpb25dOwogICAgICBwb3NpdGlvbisrOwoKICAgICAgaWYgKHNraXBOZXh0Qml0KSB7CiAgICAgICAgYnVmZmVyID0gYnVmZmVyIDw8IDcgfCBiOwogICAgICAgIGJ1ZmZlclNpemUgKz0gNzsKICAgICAgICBza2lwTmV4dEJpdCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA4IHwgYjsKICAgICAgICBidWZmZXJTaXplICs9IDg7CiAgICAgIH0KCiAgICAgIGlmIChiID09PSAweGZmKSB7CiAgICAgICAgc2tpcE5leHRCaXQgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgYnVmZmVyU2l6ZSAtPSBjb3VudDsKICAgIHJldHVybiBidWZmZXIgPj4+IGJ1ZmZlclNpemUgJiAoMSA8PCBjb3VudCkgLSAxOwogIH0KCiAgZnVuY3Rpb24gc2tpcE1hcmtlcklmRXF1YWwodmFsdWUpIHsKICAgIGlmIChkYXRhW29mZnNldCArIHBvc2l0aW9uIC0gMV0gPT09IDB4ZmYgJiYgZGF0YVtvZmZzZXQgKyBwb3NpdGlvbl0gPT09IHZhbHVlKSB7CiAgICAgIHNraXBCeXRlcygxKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgaWYgKGRhdGFbb2Zmc2V0ICsgcG9zaXRpb25dID09PSAweGZmICYmIGRhdGFbb2Zmc2V0ICsgcG9zaXRpb24gKyAxXSA9PT0gdmFsdWUpIHsKICAgICAgc2tpcEJ5dGVzKDIpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBza2lwQnl0ZXMoY291bnQpIHsKICAgIHBvc2l0aW9uICs9IGNvdW50OwogIH0KCiAgZnVuY3Rpb24gYWxpZ25Ub0J5dGUoKSB7CiAgICBidWZmZXJTaXplID0gMDsKCiAgICBpZiAoc2tpcE5leHRCaXQpIHsKICAgICAgcG9zaXRpb24rKzsKICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlYWRDb2RpbmdwYXNzZXMoKSB7CiAgICBpZiAocmVhZEJpdHMoMSkgPT09IDApIHsKICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAgaWYgKHJlYWRCaXRzKDEpID09PSAwKSB7CiAgICAgIHJldHVybiAyOwogICAgfQoKICAgIGxldCB2YWx1ZSA9IHJlYWRCaXRzKDIpOwoKICAgIGlmICh2YWx1ZSA8IDMpIHsKICAgICAgcmV0dXJuIHZhbHVlICsgMzsKICAgIH0KCiAgICB2YWx1ZSA9IHJlYWRCaXRzKDUpOwoKICAgIGlmICh2YWx1ZSA8IDMxKSB7CiAgICAgIHJldHVybiB2YWx1ZSArIDY7CiAgICB9CgogICAgdmFsdWUgPSByZWFkQml0cyg3KTsKICAgIHJldHVybiB2YWx1ZSArIDM3OwogIH0KCiAgY29uc3QgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICBjb25zdCB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogIGNvbnN0IHNvcE1hcmtlclVzZWQgPSBjb250ZXh0LkNPRC5zb3BNYXJrZXJVc2VkOwogIGNvbnN0IGVwaE1hcmtlclVzZWQgPSBjb250ZXh0LkNPRC5lcGhNYXJrZXJVc2VkOwogIGNvbnN0IHBhY2tldHNJdGVyYXRvciA9IHRpbGUucGFja2V0c0l0ZXJhdG9yOwoKICB3aGlsZSAocG9zaXRpb24gPCBkYXRhTGVuZ3RoKSB7CiAgICBhbGlnblRvQnl0ZSgpOwoKICAgIGlmIChzb3BNYXJrZXJVc2VkICYmIHNraXBNYXJrZXJJZkVxdWFsKDB4OTEpKSB7CiAgICAgIHNraXBCeXRlcyg0KTsKICAgIH0KCiAgICBjb25zdCBwYWNrZXQgPSBwYWNrZXRzSXRlcmF0b3IubmV4dFBhY2tldCgpOwoKICAgIGlmICghcmVhZEJpdHMoMSkpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3QgbGF5ZXJOdW1iZXIgPSBwYWNrZXQubGF5ZXJOdW1iZXIsCiAgICAgICAgICBxdWV1ZSA9IFtdOwogICAgbGV0IGNvZGVibG9jazsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBwYWNrZXQuY29kZWJsb2Nrcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvZGVibG9jayA9IHBhY2tldC5jb2RlYmxvY2tzW2ldOwogICAgICBsZXQgcHJlY2luY3QgPSBjb2RlYmxvY2sucHJlY2luY3Q7CiAgICAgIGNvbnN0IGNvZGVibG9ja0NvbHVtbiA9IGNvZGVibG9jay5jYnggLSBwcmVjaW5jdC5jYnhNaW47CiAgICAgIGNvbnN0IGNvZGVibG9ja1JvdyA9IGNvZGVibG9jay5jYnkgLSBwcmVjaW5jdC5jYnlNaW47CiAgICAgIGxldCBjb2RlYmxvY2tJbmNsdWRlZCA9IGZhbHNlOwogICAgICBsZXQgZmlyc3RUaW1lSW5jbHVzaW9uID0gZmFsc2U7CiAgICAgIGxldCB2YWx1ZVJlYWR5LCB6ZXJvQml0UGxhbmVzVHJlZTsKCiAgICAgIGlmIChjb2RlYmxvY2suaW5jbHVkZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvZGVibG9ja0luY2x1ZGVkID0gISFyZWFkQml0cygxKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwcmVjaW5jdCA9IGNvZGVibG9jay5wcmVjaW5jdDsKICAgICAgICBsZXQgaW5jbHVzaW9uVHJlZTsKCiAgICAgICAgaWYgKHByZWNpbmN0LmluY2x1c2lvblRyZWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaW5jbHVzaW9uVHJlZSA9IHByZWNpbmN0LmluY2x1c2lvblRyZWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHdpZHRoID0gcHJlY2luY3QuY2J4TWF4IC0gcHJlY2luY3QuY2J4TWluICsgMTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IHByZWNpbmN0LmNieU1heCAtIHByZWNpbmN0LmNieU1pbiArIDE7CiAgICAgICAgICBpbmNsdXNpb25UcmVlID0gbmV3IEluY2x1c2lvblRyZWUod2lkdGgsIGhlaWdodCwgbGF5ZXJOdW1iZXIpOwogICAgICAgICAgemVyb0JpdFBsYW5lc1RyZWUgPSBuZXcgVGFnVHJlZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgIHByZWNpbmN0LmluY2x1c2lvblRyZWUgPSBpbmNsdXNpb25UcmVlOwogICAgICAgICAgcHJlY2luY3QuemVyb0JpdFBsYW5lc1RyZWUgPSB6ZXJvQml0UGxhbmVzVHJlZTsKCiAgICAgICAgICBmb3IgKGxldCBsID0gMDsgbCA8IGxheWVyTnVtYmVyOyBsKyspIHsKICAgICAgICAgICAgaWYgKHJlYWRCaXRzKDEpICE9PSAwKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIHRhZyB0cmVlIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChpbmNsdXNpb25UcmVlLnJlc2V0KGNvZGVibG9ja0NvbHVtbiwgY29kZWJsb2NrUm93LCBsYXllck51bWJlcikpIHsKICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGlmIChyZWFkQml0cygxKSkgewogICAgICAgICAgICAgIHZhbHVlUmVhZHkgPSAhaW5jbHVzaW9uVHJlZS5uZXh0TGV2ZWwoKTsKCiAgICAgICAgICAgICAgaWYgKHZhbHVlUmVhZHkpIHsKICAgICAgICAgICAgICAgIGNvZGVibG9jay5pbmNsdWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb2RlYmxvY2tJbmNsdWRlZCA9IGZpcnN0VGltZUluY2x1c2lvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaW5jbHVzaW9uVHJlZS5pbmNyZW1lbnRWYWx1ZShsYXllck51bWJlcik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghY29kZWJsb2NrSW5jbHVkZWQpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGZpcnN0VGltZUluY2x1c2lvbikgewogICAgICAgIHplcm9CaXRQbGFuZXNUcmVlID0gcHJlY2luY3QuemVyb0JpdFBsYW5lc1RyZWU7CiAgICAgICAgemVyb0JpdFBsYW5lc1RyZWUucmVzZXQoY29kZWJsb2NrQ29sdW1uLCBjb2RlYmxvY2tSb3cpOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgaWYgKHJlYWRCaXRzKDEpKSB7CiAgICAgICAgICAgIHZhbHVlUmVhZHkgPSAhemVyb0JpdFBsYW5lc1RyZWUubmV4dExldmVsKCk7CgogICAgICAgICAgICBpZiAodmFsdWVSZWFkeSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB6ZXJvQml0UGxhbmVzVHJlZS5pbmNyZW1lbnRWYWx1ZSgpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29kZWJsb2NrLnplcm9CaXRQbGFuZXMgPSB6ZXJvQml0UGxhbmVzVHJlZS52YWx1ZTsKICAgICAgfQoKICAgICAgY29uc3QgY29kaW5ncGFzc2VzID0gcmVhZENvZGluZ3Bhc3NlcygpOwoKICAgICAgd2hpbGUgKHJlYWRCaXRzKDEpKSB7CiAgICAgICAgY29kZWJsb2NrLkxibG9jaysrOwogICAgICB9CgogICAgICBjb25zdCBjb2RpbmdwYXNzZXNMb2cyID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKGNvZGluZ3Bhc3Nlcyk7CiAgICAgIGNvbnN0IGJpdHMgPSAoY29kaW5ncGFzc2VzIDwgMSA8PCBjb2RpbmdwYXNzZXNMb2cyID8gY29kaW5ncGFzc2VzTG9nMiAtIDEgOiBjb2RpbmdwYXNzZXNMb2cyKSArIGNvZGVibG9jay5MYmxvY2s7CiAgICAgIGNvbnN0IGNvZGVkRGF0YUxlbmd0aCA9IHJlYWRCaXRzKGJpdHMpOwogICAgICBxdWV1ZS5wdXNoKHsKICAgICAgICBjb2RlYmxvY2ssCiAgICAgICAgY29kaW5ncGFzc2VzLAogICAgICAgIGRhdGFMZW5ndGg6IGNvZGVkRGF0YUxlbmd0aAogICAgICB9KTsKICAgIH0KCiAgICBhbGlnblRvQnl0ZSgpOwoKICAgIGlmIChlcGhNYXJrZXJVc2VkKSB7CiAgICAgIHNraXBNYXJrZXJJZkVxdWFsKDB4OTIpOwogICAgfQoKICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IHBhY2tldEl0ZW0gPSBxdWV1ZS5zaGlmdCgpOwogICAgICBjb2RlYmxvY2sgPSBwYWNrZXRJdGVtLmNvZGVibG9jazsKCiAgICAgIGlmIChjb2RlYmxvY2suZGF0YSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29kZWJsb2NrLmRhdGEgPSBbXTsKICAgICAgfQoKICAgICAgY29kZWJsb2NrLmRhdGEucHVzaCh7CiAgICAgICAgZGF0YSwKICAgICAgICBzdGFydDogb2Zmc2V0ICsgcG9zaXRpb24sCiAgICAgICAgZW5kOiBvZmZzZXQgKyBwb3NpdGlvbiArIHBhY2tldEl0ZW0uZGF0YUxlbmd0aCwKICAgICAgICBjb2RpbmdwYXNzZXM6IHBhY2tldEl0ZW0uY29kaW5ncGFzc2VzCiAgICAgIH0pOwogICAgICBwb3NpdGlvbiArPSBwYWNrZXRJdGVtLmRhdGFMZW5ndGg7CiAgICB9CiAgfQoKICByZXR1cm4gcG9zaXRpb247Cn0KCmZ1bmN0aW9uIGNvcHlDb2VmZmljaWVudHMoY29lZmZpY2llbnRzLCBsZXZlbFdpZHRoLCBsZXZlbEhlaWdodCwgc3ViYmFuZCwgZGVsdGEsIG1iLCByZXZlcnNpYmxlLCBzZWdtZW50YXRpb25TeW1ib2xVc2VkLCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKSB7CiAgY29uc3QgeDAgPSBzdWJiYW5kLnRieDA7CiAgY29uc3QgeTAgPSBzdWJiYW5kLnRieTA7CiAgY29uc3Qgd2lkdGggPSBzdWJiYW5kLnRieDEgLSBzdWJiYW5kLnRieDA7CiAgY29uc3QgY29kZWJsb2NrcyA9IHN1YmJhbmQuY29kZWJsb2NrczsKICBjb25zdCByaWdodCA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMCkgPT09ICJIIiA/IDEgOiAwOwogIGNvbnN0IGJvdHRvbSA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMSkgPT09ICJIIiA/IGxldmVsV2lkdGggOiAwOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb2RlYmxvY2tzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgIGNvbnN0IGNvZGVibG9jayA9IGNvZGVibG9ja3NbaV07CiAgICBjb25zdCBibG9ja1dpZHRoID0gY29kZWJsb2NrLnRieDFfIC0gY29kZWJsb2NrLnRieDBfOwogICAgY29uc3QgYmxvY2tIZWlnaHQgPSBjb2RlYmxvY2sudGJ5MV8gLSBjb2RlYmxvY2sudGJ5MF87CgogICAgaWYgKGJsb2NrV2lkdGggPT09IDAgfHwgYmxvY2tIZWlnaHQgPT09IDApIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKGNvZGVibG9jay5kYXRhID09PSB1bmRlZmluZWQpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3QgYml0TW9kZWwgPSBuZXcgQml0TW9kZWwoYmxvY2tXaWR0aCwgYmxvY2tIZWlnaHQsIGNvZGVibG9jay5zdWJiYW5kVHlwZSwgY29kZWJsb2NrLnplcm9CaXRQbGFuZXMsIG1iKTsKICAgIGxldCBjdXJyZW50Q29kaW5ncGFzc1R5cGUgPSAyOwogICAgY29uc3QgZGF0YSA9IGNvZGVibG9jay5kYXRhOwogICAgbGV0IHRvdGFsTGVuZ3RoID0gMCwKICAgICAgICBjb2RpbmdwYXNzZXMgPSAwOwogICAgbGV0IGosIGpqLCBkYXRhSXRlbTsKCiAgICBmb3IgKGogPSAwLCBqaiA9IGRhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBkYXRhSXRlbSA9IGRhdGFbal07CiAgICAgIHRvdGFsTGVuZ3RoICs9IGRhdGFJdGVtLmVuZCAtIGRhdGFJdGVtLnN0YXJ0OwogICAgICBjb2RpbmdwYXNzZXMgKz0gZGF0YUl0ZW0uY29kaW5ncGFzc2VzOwogICAgfQoKICAgIGNvbnN0IGVuY29kZWREYXRhID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpOwogICAgbGV0IHBvc2l0aW9uID0gMDsKCiAgICBmb3IgKGogPSAwLCBqaiA9IGRhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICBkYXRhSXRlbSA9IGRhdGFbal07CiAgICAgIGNvbnN0IGNodW5rID0gZGF0YUl0ZW0uZGF0YS5zdWJhcnJheShkYXRhSXRlbS5zdGFydCwgZGF0YUl0ZW0uZW5kKTsKICAgICAgZW5jb2RlZERhdGEuc2V0KGNodW5rLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IGNodW5rLmxlbmd0aDsKICAgIH0KCiAgICBjb25zdCBkZWNvZGVyID0gbmV3IF9hcml0aG1ldGljX2RlY29kZXIuQXJpdGhtZXRpY0RlY29kZXIoZW5jb2RlZERhdGEsIDAsIHRvdGFsTGVuZ3RoKTsKICAgIGJpdE1vZGVsLnNldERlY29kZXIoZGVjb2Rlcik7CgogICAgZm9yIChqID0gMDsgaiA8IGNvZGluZ3Bhc3NlczsgaisrKSB7CiAgICAgIHN3aXRjaCAoY3VycmVudENvZGluZ3Bhc3NUeXBlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgYml0TW9kZWwucnVuU2lnbmlmaWNhbmNlUHJvcGFnYXRpb25QYXNzKCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgYml0TW9kZWwucnVuTWFnbml0dWRlUmVmaW5lbWVudFBhc3MoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBiaXRNb2RlbC5ydW5DbGVhbnVwUGFzcygpOwoKICAgICAgICAgIGlmIChzZWdtZW50YXRpb25TeW1ib2xVc2VkKSB7CiAgICAgICAgICAgIGJpdE1vZGVsLmNoZWNrU2VnbWVudGF0aW9uU3ltYm9sKCk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChyZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKSB7CiAgICAgICAgYml0TW9kZWwucmVzZXQoKTsKICAgICAgfQoKICAgICAgY3VycmVudENvZGluZ3Bhc3NUeXBlID0gKGN1cnJlbnRDb2RpbmdwYXNzVHlwZSArIDEpICUgMzsKICAgIH0KCiAgICBsZXQgb2Zmc2V0ID0gY29kZWJsb2NrLnRieDBfIC0geDAgKyAoY29kZWJsb2NrLnRieTBfIC0geTApICogd2lkdGg7CiAgICBjb25zdCBzaWduID0gYml0TW9kZWwuY29lZmZpY2VudHNTaWduOwogICAgY29uc3QgbWFnbml0dWRlID0gYml0TW9kZWwuY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICBjb25zdCBiaXRzRGVjb2RlZCA9IGJpdE1vZGVsLmJpdHNEZWNvZGVkOwogICAgY29uc3QgbWFnbml0dWRlQ29ycmVjdGlvbiA9IHJldmVyc2libGUgPyAwIDogMC41OwogICAgbGV0IGssIG4sIG5iOwogICAgcG9zaXRpb24gPSAwOwogICAgY29uc3QgaW50ZXJsZWF2ZSA9IHN1YmJhbmQudHlwZSAhPT0gIkxMIjsKCiAgICBmb3IgKGogPSAwOyBqIDwgYmxvY2tIZWlnaHQ7IGorKykgewogICAgICBjb25zdCByb3cgPSBvZmZzZXQgLyB3aWR0aCB8IDA7CiAgICAgIGNvbnN0IGxldmVsT2Zmc2V0ID0gMiAqIHJvdyAqIChsZXZlbFdpZHRoIC0gd2lkdGgpICsgcmlnaHQgKyBib3R0b207CgogICAgICBmb3IgKGsgPSAwOyBrIDwgYmxvY2tXaWR0aDsgaysrKSB7CiAgICAgICAgbiA9IG1hZ25pdHVkZVtwb3NpdGlvbl07CgogICAgICAgIGlmIChuICE9PSAwKSB7CiAgICAgICAgICBuID0gKG4gKyBtYWduaXR1ZGVDb3JyZWN0aW9uKSAqIGRlbHRhOwoKICAgICAgICAgIGlmIChzaWduW3Bvc2l0aW9uXSAhPT0gMCkgewogICAgICAgICAgICBuID0gLW47CiAgICAgICAgICB9CgogICAgICAgICAgbmIgPSBiaXRzRGVjb2RlZFtwb3NpdGlvbl07CiAgICAgICAgICBjb25zdCBwb3MgPSBpbnRlcmxlYXZlID8gbGV2ZWxPZmZzZXQgKyAob2Zmc2V0IDw8IDEpIDogb2Zmc2V0OwoKICAgICAgICAgIGlmIChyZXZlcnNpYmxlICYmIG5iID49IG1iKSB7CiAgICAgICAgICAgIGNvZWZmaWNpZW50c1twb3NdID0gbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvZWZmaWNpZW50c1twb3NdID0gbiAqICgxIDw8IG1iIC0gbmIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb2Zmc2V0Kys7CiAgICAgICAgcG9zaXRpb24rKzsKICAgICAgfQoKICAgICAgb2Zmc2V0ICs9IHdpZHRoIC0gYmxvY2tXaWR0aDsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYykgewogIGNvbnN0IGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICBjb25zdCBjb2RpbmdTdHlsZVBhcmFtZXRlcnMgPSBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzOwogIGNvbnN0IHF1YW50aXphdGlvblBhcmFtZXRlcnMgPSBjb21wb25lbnQucXVhbnRpemF0aW9uUGFyYW1ldGVyczsKICBjb25zdCBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogIGNvbnN0IHNwcWNkcyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuU1BxY2RzOwogIGNvbnN0IHNjYWxhckV4cG91bmRlZCA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuc2NhbGFyRXhwb3VuZGVkOwogIGNvbnN0IGd1YXJkQml0cyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuZ3VhcmRCaXRzOwogIGNvbnN0IHNlZ21lbnRhdGlvblN5bWJvbFVzZWQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuc2VnbWVudGF0aW9uU3ltYm9sVXNlZDsKICBjb25zdCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzID0gY29kaW5nU3R5bGVQYXJhbWV0ZXJzLnJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXM7CiAgY29uc3QgcHJlY2lzaW9uID0gY29udGV4dC5jb21wb25lbnRzW2NdLnByZWNpc2lvbjsKICBjb25zdCByZXZlcnNpYmxlID0gY29kaW5nU3R5bGVQYXJhbWV0ZXJzLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbjsKICBjb25zdCB0cmFuc2Zvcm0gPSByZXZlcnNpYmxlID8gbmV3IFJldmVyc2libGVUcmFuc2Zvcm0oKSA6IG5ldyBJcnJldmVyc2libGVUcmFuc2Zvcm0oKTsKICBjb25zdCBzdWJiYW5kQ29lZmZpY2llbnRzID0gW107CiAgbGV0IGIgPSAwOwoKICBmb3IgKGxldCBpID0gMDsgaSA8PSBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IGkrKykgewogICAgY29uc3QgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tpXTsKICAgIGNvbnN0IHdpZHRoID0gcmVzb2x1dGlvbi50cngxIC0gcmVzb2x1dGlvbi50cngwOwogICAgY29uc3QgaGVpZ2h0ID0gcmVzb2x1dGlvbi50cnkxIC0gcmVzb2x1dGlvbi50cnkwOwogICAgY29uc3QgY29lZmZpY2llbnRzID0gbmV3IEZsb2F0MzJBcnJheSh3aWR0aCAqIGhlaWdodCk7CgogICAgZm9yIChsZXQgaiA9IDAsIGpqID0gcmVzb2x1dGlvbi5zdWJiYW5kcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIGxldCBtdSwgZXBzaWxvbjsKCiAgICAgIGlmICghc2NhbGFyRXhwb3VuZGVkKSB7CiAgICAgICAgbXUgPSBzcHFjZHNbMF0ubXU7CiAgICAgICAgZXBzaWxvbiA9IHNwcWNkc1swXS5lcHNpbG9uICsgKGkgPiAwID8gMSAtIGkgOiAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtdSA9IHNwcWNkc1tiXS5tdTsKICAgICAgICBlcHNpbG9uID0gc3BxY2RzW2JdLmVwc2lsb247CiAgICAgICAgYisrOwogICAgICB9CgogICAgICBjb25zdCBzdWJiYW5kID0gcmVzb2x1dGlvbi5zdWJiYW5kc1tqXTsKICAgICAgY29uc3QgZ2FpbkxvZzIgPSBTdWJiYW5kc0dhaW5Mb2cyW3N1YmJhbmQudHlwZV07CiAgICAgIGNvbnN0IGRlbHRhID0gcmV2ZXJzaWJsZSA/IDEgOiAyICoqIChwcmVjaXNpb24gKyBnYWluTG9nMiAtIGVwc2lsb24pICogKDEgKyBtdSAvIDIwNDgpOwogICAgICBjb25zdCBtYiA9IGd1YXJkQml0cyArIGVwc2lsb24gLSAxOwogICAgICBjb3B5Q29lZmZpY2llbnRzKGNvZWZmaWNpZW50cywgd2lkdGgsIGhlaWdodCwgc3ViYmFuZCwgZGVsdGEsIG1iLCByZXZlcnNpYmxlLCBzZWdtZW50YXRpb25TeW1ib2xVc2VkLCByZXNldENvbnRleHRQcm9iYWJpbGl0aWVzKTsKICAgIH0KCiAgICBzdWJiYW5kQ29lZmZpY2llbnRzLnB1c2goewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpdGVtczogY29lZmZpY2llbnRzCiAgICB9KTsKICB9CgogIGNvbnN0IHJlc3VsdCA9IHRyYW5zZm9ybS5jYWxjdWxhdGUoc3ViYmFuZENvZWZmaWNpZW50cywgY29tcG9uZW50LnRjeDAsIGNvbXBvbmVudC50Y3kwKTsKICByZXR1cm4gewogICAgbGVmdDogY29tcG9uZW50LnRjeDAsCiAgICB0b3A6IGNvbXBvbmVudC50Y3kwLAogICAgd2lkdGg6IHJlc3VsdC53aWR0aCwKICAgIGhlaWdodDogcmVzdWx0LmhlaWdodCwKICAgIGl0ZW1zOiByZXN1bHQuaXRlbXMKICB9Owp9CgpmdW5jdGlvbiB0cmFuc2Zvcm1Db21wb25lbnRzKGNvbnRleHQpIHsKICBjb25zdCBzaXogPSBjb250ZXh0LlNJWjsKICBjb25zdCBjb21wb25lbnRzID0gY29udGV4dC5jb21wb25lbnRzOwogIGNvbnN0IGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogIGNvbnN0IHJlc3VsdEltYWdlcyA9IFtdOwoKICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb250ZXh0LnRpbGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGNvbnN0IHRpbGUgPSBjb250ZXh0LnRpbGVzW2ldOwogICAgY29uc3QgdHJhbnNmb3JtZWRUaWxlcyA9IFtdOwoKICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgdHJhbnNmb3JtZWRUaWxlc1tjXSA9IHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYyk7CiAgICB9CgogICAgY29uc3QgdGlsZTAgPSB0cmFuc2Zvcm1lZFRpbGVzWzBdOwogICAgY29uc3Qgb3V0ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRpbGUwLml0ZW1zLmxlbmd0aCAqIGNvbXBvbmVudHNDb3VudCk7CiAgICBjb25zdCByZXN1bHQgPSB7CiAgICAgIGxlZnQ6IHRpbGUwLmxlZnQsCiAgICAgIHRvcDogdGlsZTAudG9wLAogICAgICB3aWR0aDogdGlsZTAud2lkdGgsCiAgICAgIGhlaWdodDogdGlsZTAuaGVpZ2h0LAogICAgICBpdGVtczogb3V0CiAgICB9OwogICAgbGV0IHNoaWZ0LCBvZmZzZXQ7CiAgICBsZXQgcG9zID0gMCwKICAgICAgICBqLAogICAgICAgIGpqLAogICAgICAgIHkwLAogICAgICAgIHkxLAogICAgICAgIHkyOwoKICAgIGlmICh0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubXVsdGlwbGVDb21wb25lbnRUcmFuc2Zvcm0pIHsKICAgICAgY29uc3QgZm91ckNvbXBvbmVudHMgPSBjb21wb25lbnRzQ291bnQgPT09IDQ7CiAgICAgIGNvbnN0IHkwaXRlbXMgPSB0cmFuc2Zvcm1lZFRpbGVzWzBdLml0ZW1zOwogICAgICBjb25zdCB5MWl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1sxXS5pdGVtczsKICAgICAgY29uc3QgeTJpdGVtcyA9IHRyYW5zZm9ybWVkVGlsZXNbMl0uaXRlbXM7CiAgICAgIGNvbnN0IHkzaXRlbXMgPSBmb3VyQ29tcG9uZW50cyA/IHRyYW5zZm9ybWVkVGlsZXNbM10uaXRlbXMgOiBudWxsOwogICAgICBzaGlmdCA9IGNvbXBvbmVudHNbMF0ucHJlY2lzaW9uIC0gODsKICAgICAgb2Zmc2V0ID0gKDEyOCA8PCBzaGlmdCkgKyAwLjU7CiAgICAgIGNvbnN0IGNvbXBvbmVudDAgPSB0aWxlLmNvbXBvbmVudHNbMF07CiAgICAgIGNvbnN0IGFscGhhMDEgPSBjb21wb25lbnRzQ291bnQgLSAzOwogICAgICBqaiA9IHkwaXRlbXMubGVuZ3RoOwoKICAgICAgaWYgKCFjb21wb25lbnQwLmNvZGluZ1N0eWxlUGFyYW1ldGVycy5yZXZlcnNpYmxlVHJhbnNmb3JtYXRpb24pIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgamo7IGorKywgcG9zICs9IGFscGhhMDEpIHsKICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgIHkxID0geTFpdGVtc1tqXTsKICAgICAgICAgIHkyID0geTJpdGVtc1tqXTsKICAgICAgICAgIG91dFtwb3MrK10gPSB5MCArIDEuNDAyICogeTIgPj4gc2hpZnQ7CiAgICAgICAgICBvdXRbcG9zKytdID0geTAgLSAwLjM0NDEzICogeTEgLSAwLjcxNDE0ICogeTIgPj4gc2hpZnQ7CiAgICAgICAgICBvdXRbcG9zKytdID0geTAgKyAxLjc3MiAqIHkxID4+IHNoaWZ0OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgamo7IGorKywgcG9zICs9IGFscGhhMDEpIHsKICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgIHkxID0geTFpdGVtc1tqXTsKICAgICAgICAgIHkyID0geTJpdGVtc1tqXTsKICAgICAgICAgIGNvbnN0IGcgPSB5MCAtICh5MiArIHkxID4+IDIpOwogICAgICAgICAgb3V0W3BvcysrXSA9IGcgKyB5MiA+PiBzaGlmdDsKICAgICAgICAgIG91dFtwb3MrK10gPSBnID4+IHNoaWZ0OwogICAgICAgICAgb3V0W3BvcysrXSA9IGcgKyB5MSA+PiBzaGlmdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChmb3VyQ29tcG9uZW50cykgewogICAgICAgIGZvciAoaiA9IDAsIHBvcyA9IDM7IGogPCBqajsgaisrLCBwb3MgKz0gNCkgewogICAgICAgICAgb3V0W3Bvc10gPSB5M2l0ZW1zW2pdICsgb2Zmc2V0ID4+IHNoaWZ0OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgIGNvbnN0IGl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1tjXS5pdGVtczsKICAgICAgICBzaGlmdCA9IGNvbXBvbmVudHNbY10ucHJlY2lzaW9uIC0gODsKICAgICAgICBvZmZzZXQgPSAoMTI4IDw8IHNoaWZ0KSArIDAuNTsKCiAgICAgICAgZm9yIChwb3MgPSBjLCBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICBvdXRbcG9zXSA9IGl0ZW1zW2pdICsgb2Zmc2V0ID4+IHNoaWZ0OwogICAgICAgICAgcG9zICs9IGNvbXBvbmVudHNDb3VudDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXN1bHRJbWFnZXMucHVzaChyZXN1bHQpOwogIH0KCiAgcmV0dXJuIHJlc3VsdEltYWdlczsKfQoKZnVuY3Rpb24gaW5pdGlhbGl6ZVRpbGUoY29udGV4dCwgdGlsZUluZGV4KSB7CiAgY29uc3Qgc2l6ID0gY29udGV4dC5TSVo7CiAgY29uc3QgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgY29uc3QgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKCiAgZm9yIChsZXQgYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgY29uc3QgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgY29uc3QgcWNkT3JRY2MgPSBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQ1tjXSAhPT0gdW5kZWZpbmVkID8gY29udGV4dC5jdXJyZW50VGlsZS5RQ0NbY10gOiBjb250ZXh0LmN1cnJlbnRUaWxlLlFDRDsKICAgIGNvbXBvbmVudC5xdWFudGl6YXRpb25QYXJhbWV0ZXJzID0gcWNkT3JRY2M7CiAgICBjb25zdCBjb2RPckNvYyA9IGNvbnRleHQuY3VycmVudFRpbGUuQ09DW2NdICE9PSB1bmRlZmluZWQgPyBjb250ZXh0LmN1cnJlbnRUaWxlLkNPQ1tjXSA6IGNvbnRleHQuY3VycmVudFRpbGUuQ09EOwogICAgY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycyA9IGNvZE9yQ29jOwogIH0KCiAgdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzID0gY29udGV4dC5jdXJyZW50VGlsZS5DT0Q7Cn0KCmNsYXNzIFRhZ1RyZWUgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQpIHsKICAgIGNvbnN0IGxldmVsc0xlbmd0aCA9ICgwLCBfY29yZV91dGlscy5sb2cyKShNYXRoLm1heCh3aWR0aCwgaGVpZ2h0KSkgKyAxOwogICAgdGhpcy5sZXZlbHMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxldmVsc0xlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGxldmVsID0gewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpdGVtczogW10KICAgICAgfTsKICAgICAgdGhpcy5sZXZlbHMucHVzaChsZXZlbCk7CiAgICAgIHdpZHRoID0gTWF0aC5jZWlsKHdpZHRoIC8gMik7CiAgICAgIGhlaWdodCA9IE1hdGguY2VpbChoZWlnaHQgLyAyKTsKICAgIH0KICB9CgogIHJlc2V0KGksIGopIHsKICAgIGxldCBjdXJyZW50TGV2ZWwgPSAwLAogICAgICAgIHZhbHVlID0gMCwKICAgICAgICBsZXZlbDsKCiAgICB3aGlsZSAoY3VycmVudExldmVsIDwgdGhpcy5sZXZlbHMubGVuZ3RoKSB7CiAgICAgIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgY29uc3QgaW5kZXggPSBpICsgaiAqIGxldmVsLndpZHRoOwoKICAgICAgaWYgKGxldmVsLml0ZW1zW2luZGV4XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFsdWUgPSBsZXZlbC5pdGVtc1tpbmRleF07CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxldmVsLmluZGV4ID0gaW5kZXg7CiAgICAgIGkgPj49IDE7CiAgICAgIGogPj49IDE7CiAgICAgIGN1cnJlbnRMZXZlbCsrOwogICAgfQoKICAgIGN1cnJlbnRMZXZlbC0tOwogICAgbGV2ZWwgPSB0aGlzLmxldmVsc1tjdXJyZW50TGV2ZWxdOwogICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gdmFsdWU7CiAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IGN1cnJlbnRMZXZlbDsKICAgIGRlbGV0ZSB0aGlzLnZhbHVlOwogIH0KCiAgaW5jcmVtZW50VmFsdWUoKSB7CiAgICBjb25zdCBsZXZlbCA9IHRoaXMubGV2ZWxzW3RoaXMuY3VycmVudExldmVsXTsKICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSsrOwogIH0KCiAgbmV4dExldmVsKCkgewogICAgbGV0IGN1cnJlbnRMZXZlbCA9IHRoaXMuY3VycmVudExldmVsOwogICAgbGV0IGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgIGNvbnN0IHZhbHVlID0gbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdOwogICAgY3VycmVudExldmVsLS07CgogICAgaWYgKGN1cnJlbnRMZXZlbCA8IDApIHsKICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNsYXNzIEluY2x1c2lvblRyZWUgewogIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIGRlZmF1bHRWYWx1ZSkgewogICAgY29uc3QgbGV2ZWxzTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKE1hdGgubWF4KHdpZHRoLCBoZWlnaHQpKSArIDE7CiAgICB0aGlzLmxldmVscyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGV2ZWxzTGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgaXRlbXMgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCk7CgogICAgICBmb3IgKGxldCBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgaXRlbXNbal0gPSBkZWZhdWx0VmFsdWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxldmVsID0gewogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpdGVtcwogICAgICB9OwogICAgICB0aGlzLmxldmVscy5wdXNoKGxldmVsKTsKICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGggLyAyKTsKICAgICAgaGVpZ2h0ID0gTWF0aC5jZWlsKGhlaWdodCAvIDIpOwogICAgfQogIH0KCiAgcmVzZXQoaSwgaiwgc3RvcFZhbHVlKSB7CiAgICBsZXQgY3VycmVudExldmVsID0gMDsKCiAgICB3aGlsZSAoY3VycmVudExldmVsIDwgdGhpcy5sZXZlbHMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgY29uc3QgaW5kZXggPSBpICsgaiAqIGxldmVsLndpZHRoOwogICAgICBsZXZlbC5pbmRleCA9IGluZGV4OwogICAgICBjb25zdCB2YWx1ZSA9IGxldmVsLml0ZW1zW2luZGV4XTsKCiAgICAgIGlmICh2YWx1ZSA9PT0gMHhmZikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAodmFsdWUgPiBzdG9wVmFsdWUpIHsKICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IGN1cnJlbnRMZXZlbDsKICAgICAgICB0aGlzLnByb3BhZ2F0ZVZhbHVlcygpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaSA+Pj0gMTsKICAgICAgaiA+Pj0gMTsKICAgICAgY3VycmVudExldmVsKys7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWwgLSAxOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBpbmNyZW1lbnRWYWx1ZShzdG9wVmFsdWUpIHsKICAgIGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbHNbdGhpcy5jdXJyZW50TGV2ZWxdOwogICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gc3RvcFZhbHVlICsgMTsKICAgIHRoaXMucHJvcGFnYXRlVmFsdWVzKCk7CiAgfQoKICBwcm9wYWdhdGVWYWx1ZXMoKSB7CiAgICBsZXQgbGV2ZWxJbmRleCA9IHRoaXMuY3VycmVudExldmVsOwogICAgbGV0IGxldmVsID0gdGhpcy5sZXZlbHNbbGV2ZWxJbmRleF07CiAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF07CgogICAgd2hpbGUgKC0tbGV2ZWxJbmRleCA+PSAwKSB7CiAgICAgIGxldmVsID0gdGhpcy5sZXZlbHNbbGV2ZWxJbmRleF07CiAgICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSA9IGN1cnJlbnRWYWx1ZTsKICAgIH0KICB9CgogIG5leHRMZXZlbCgpIHsKICAgIGxldCBjdXJyZW50TGV2ZWwgPSB0aGlzLmN1cnJlbnRMZXZlbDsKICAgIGxldCBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBjb25zdCB2YWx1ZSA9IGxldmVsLml0ZW1zW2xldmVsLmluZGV4XTsKICAgIGxldmVsLml0ZW1zW2xldmVsLmluZGV4XSA9IDB4ZmY7CiAgICBjdXJyZW50TGV2ZWwtLTsKCiAgICBpZiAoY3VycmVudExldmVsIDwgMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNvbnN0IEJpdE1vZGVsID0gZnVuY3Rpb24gQml0TW9kZWxDbG9zdXJlKCkgewogIGNvbnN0IFVOSUZPUk1fQ09OVEVYVCA9IDE3OwogIGNvbnN0IFJVTkxFTkdUSF9DT05URVhUID0gMTg7CiAgY29uc3QgTExBbmRMSENvbnRleHRzTGFiZWwgPSBuZXcgVWludDhBcnJheShbMCwgNSwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMSwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOF0pOwogIGNvbnN0IEhMQ29udGV4dExhYmVsID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDMsIDQsIDAsIDUsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDEsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDhdKTsKICBjb25zdCBISENvbnRleHRMYWJlbCA9IG5ldyBVaW50OEFycmF5KFswLCAxLCAyLCAwLCAxLCAyLCAyLCAwLCAyLCAyLCAyLCAwLCAwLCAwLCAwLCAwLCAzLCA0LCA1LCAwLCA0LCA1LCA1LCAwLCA1LCA1LCA1LCAwLCAwLCAwLCAwLCAwLCA2LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4XSk7CgogIGNsYXNzIEJpdE1vZGVsIHsKICAgIGNvbnN0cnVjdG9yKHdpZHRoLCBoZWlnaHQsIHN1YmJhbmQsIHplcm9CaXRQbGFuZXMsIG1iKSB7CiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIGxldCBjb250ZXh0TGFiZWxUYWJsZTsKCiAgICAgIGlmIChzdWJiYW5kID09PSAiSEgiKSB7CiAgICAgICAgY29udGV4dExhYmVsVGFibGUgPSBISENvbnRleHRMYWJlbDsKICAgICAgfSBlbHNlIGlmIChzdWJiYW5kID09PSAiSEwiKSB7CiAgICAgICAgY29udGV4dExhYmVsVGFibGUgPSBITENvbnRleHRMYWJlbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250ZXh0TGFiZWxUYWJsZSA9IExMQW5kTEhDb250ZXh0c0xhYmVsOwogICAgICB9CgogICAgICB0aGlzLmNvbnRleHRMYWJlbFRhYmxlID0gY29udGV4dExhYmVsVGFibGU7CiAgICAgIGNvbnN0IGNvZWZmaWNpZW50Q291bnQgPSB3aWR0aCAqIGhlaWdodDsKICAgICAgdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2UgPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgdGhpcy5jb2VmZmljZW50c1NpZ24gPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgbGV0IGNvZWZmaWNlbnRzTWFnbml0dWRlOwoKICAgICAgaWYgKG1iID4gMTQpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MzJBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIGlmIChtYiA+IDYpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MTZBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50OEFycmF5KGNvZWZmaWNpZW50Q291bnQpOwogICAgICB9CgogICAgICB0aGlzLmNvZWZmaWNlbnRzTWFnbml0dWRlID0gY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICAgIHRoaXMucHJvY2Vzc2luZ0ZsYWdzID0gbmV3IFVpbnQ4QXJyYXkoY29lZmZpY2llbnRDb3VudCk7CiAgICAgIGNvbnN0IGJpdHNEZWNvZGVkID0gbmV3IFVpbnQ4QXJyYXkoY29lZmZpY2llbnRDb3VudCk7CgogICAgICBpZiAoemVyb0JpdFBsYW5lcyAhPT0gMCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29lZmZpY2llbnRDb3VudDsgaSsrKSB7CiAgICAgICAgICBiaXRzRGVjb2RlZFtpXSA9IHplcm9CaXRQbGFuZXM7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJpdHNEZWNvZGVkID0gYml0c0RlY29kZWQ7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0KCiAgICBzZXREZWNvZGVyKGRlY29kZXIpIHsKICAgICAgdGhpcy5kZWNvZGVyID0gZGVjb2RlcjsKICAgIH0KCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5jb250ZXh0cyA9IG5ldyBJbnQ4QXJyYXkoMTkpOwogICAgICB0aGlzLmNvbnRleHRzWzBdID0gNCA8PCAxIHwgMDsKICAgICAgdGhpcy5jb250ZXh0c1tVTklGT1JNX0NPTlRFWFRdID0gNDYgPDwgMSB8IDA7CiAgICAgIHRoaXMuY29udGV4dHNbUlVOTEVOR1RIX0NPTlRFWFRdID0gMyA8PCAxIHwgMDsKICAgIH0KCiAgICBzZXROZWlnaGJvcnNTaWduaWZpY2FuY2Uocm93LCBjb2x1bW4sIGluZGV4KSB7CiAgICAgIGNvbnN0IG5laWdoYm9yc1NpZ25pZmljYW5jZSA9IHRoaXMubmVpZ2hib3JzU2lnbmlmaWNhbmNlOwogICAgICBjb25zdCB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICBjb25zdCBsZWZ0ID0gY29sdW1uID4gMDsKICAgICAgY29uc3QgcmlnaHQgPSBjb2x1bW4gKyAxIDwgd2lkdGg7CiAgICAgIGxldCBpOwoKICAgICAgaWYgKHJvdyA+IDApIHsKICAgICAgICBpID0gaW5kZXggLSB3aWR0aDsKCiAgICAgICAgaWYgKGxlZnQpIHsKICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpIC0gMV0gKz0gMHgxMDsKICAgICAgICB9CgogICAgICAgIGlmIChyaWdodCkgewogICAgICAgICAgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2kgKyAxXSArPSAweDEwOwogICAgICAgIH0KCiAgICAgICAgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2ldICs9IDB4MDQ7CiAgICAgIH0KCiAgICAgIGlmIChyb3cgKyAxIDwgaGVpZ2h0KSB7CiAgICAgICAgaSA9IGluZGV4ICsgd2lkdGg7CgogICAgICAgIGlmIChsZWZ0KSB7CiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaSAtIDFdICs9IDB4MTA7CiAgICAgICAgfQoKICAgICAgICBpZiAocmlnaHQpIHsKICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpICsgMV0gKz0gMHgxMDsKICAgICAgICB9CgogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpXSArPSAweDA0OwogICAgICB9CgogICAgICBpZiAobGVmdCkgewogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleCAtIDFdICs9IDB4MDE7CiAgICAgIH0KCiAgICAgIGlmIChyaWdodCkgewogICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleCArIDFdICs9IDB4MDE7CiAgICAgIH0KCiAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF0gfD0gMHg4MDsKICAgIH0KCiAgICBydW5TaWduaWZpY2FuY2VQcm9wYWdhdGlvblBhc3MoKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgY29lZmZpY2VudHNTaWduID0gdGhpcy5jb2VmZmljZW50c1NpZ247CiAgICAgIGNvbnN0IG5laWdoYm9yc1NpZ25pZmljYW5jZSA9IHRoaXMubmVpZ2hib3JzU2lnbmlmaWNhbmNlOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgY29udGV4dHMgPSB0aGlzLmNvbnRleHRzOwogICAgICBjb25zdCBsYWJlbHMgPSB0aGlzLmNvbnRleHRMYWJlbFRhYmxlOwogICAgICBjb25zdCBiaXRzRGVjb2RlZCA9IHRoaXMuYml0c0RlY29kZWQ7CiAgICAgIGNvbnN0IHByb2Nlc3NlZEludmVyc2VNYXNrID0gfjE7CiAgICAgIGNvbnN0IHByb2Nlc3NlZE1hc2sgPSAxOwogICAgICBjb25zdCBmaXJzdE1hZ25pdHVkZUJpdE1hc2sgPSAyOwoKICAgICAgZm9yIChsZXQgaTAgPSAwOyBpMCA8IGhlaWdodDsgaTAgKz0gNCkgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgbGV0IGluZGV4ID0gaTAgKiB3aWR0aCArIGo7CgogICAgICAgICAgZm9yIChsZXQgaTEgPSAwOyBpMSA8IDQ7IGkxKyssIGluZGV4ICs9IHdpZHRoKSB7CiAgICAgICAgICAgIGNvbnN0IGkgPSBpMCArIGkxOwoKICAgICAgICAgICAgaWYgKGkgPj0gaGVpZ2h0KSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gJj0gcHJvY2Vzc2VkSW52ZXJzZU1hc2s7CgogICAgICAgICAgICBpZiAoY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdIHx8ICFuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRMYWJlbCA9IGxhYmVsc1tuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdXTsKICAgICAgICAgICAgY29uc3QgZGVjaXNpb24gPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CgogICAgICAgICAgICBpZiAoZGVjaXNpb24pIHsKICAgICAgICAgICAgICBjb25zdCBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBjb2VmZmljZW50c1NpZ25baW5kZXhdID0gc2lnbjsKICAgICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSAxOwogICAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdIHw9IGZpcnN0TWFnbml0dWRlQml0TWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gcHJvY2Vzc2VkTWFzazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBkZWNvZGVTaWduQml0KHJvdywgY29sdW1uLCBpbmRleCkgewogICAgICBjb25zdCB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICBjb25zdCBjb2VmZmljZW50c01hZ25pdHVkZSA9IHRoaXMuY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzU2lnbiA9IHRoaXMuY29lZmZpY2VudHNTaWduOwogICAgICBsZXQgY29udHJpYnV0aW9uLCBzaWduMCwgc2lnbjEsIHNpZ25pZmljYW5jZTE7CiAgICAgIGxldCBjb250ZXh0TGFiZWwsIGRlY29kZWQ7CiAgICAgIHNpZ25pZmljYW5jZTEgPSBjb2x1bW4gPiAwICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4IC0gMV0gIT09IDA7CgogICAgICBpZiAoY29sdW1uICsgMSA8IHdpZHRoICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4ICsgMV0gIT09IDApIHsKICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIDFdOwoKICAgICAgICBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgICAgc2lnbjAgPSBjb2VmZmljZW50c1NpZ25baW5kZXggLSAxXTsKICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IDEgLSBzaWduMSAtIHNpZ24wOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjEgLSBzaWduMTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgIHNpZ24wID0gY29lZmZpY2VudHNTaWduW2luZGV4IC0gMV07CiAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24wIC0gc2lnbjA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udHJpYnV0aW9uID0gMDsKICAgICAgfQoKICAgICAgY29uc3QgaG9yaXpvbnRhbENvbnRyaWJ1dGlvbiA9IDMgKiBjb250cmlidXRpb247CiAgICAgIHNpZ25pZmljYW5jZTEgPSByb3cgPiAwICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4IC0gd2lkdGhdICE9PSAwOwoKICAgICAgaWYgKHJvdyArIDEgPCBoZWlnaHQgJiYgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXggKyB3aWR0aF0gIT09IDApIHsKICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIHdpZHRoXTsKCiAgICAgICAgaWYgKHNpZ25pZmljYW5jZTEpIHsKICAgICAgICAgIHNpZ24wID0gY29lZmZpY2VudHNTaWduW2luZGV4IC0gd2lkdGhdOwogICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24xIC0gc2lnbjAgKyBob3Jpem9udGFsQ29udHJpYnV0aW9uOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjEgLSBzaWduMSArIGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHNpZ25pZmljYW5jZTEpIHsKICAgICAgICBzaWduMCA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCAtIHdpZHRoXTsKICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjAgLSBzaWduMCArIGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udHJpYnV0aW9uID0gaG9yaXpvbnRhbENvbnRyaWJ1dGlvbjsKICAgICAgfQoKICAgICAgaWYgKGNvbnRyaWJ1dGlvbiA+PSAwKSB7CiAgICAgICAgY29udGV4dExhYmVsID0gOSArIGNvbnRyaWJ1dGlvbjsKICAgICAgICBkZWNvZGVkID0gdGhpcy5kZWNvZGVyLnJlYWRCaXQodGhpcy5jb250ZXh0cywgY29udGV4dExhYmVsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250ZXh0TGFiZWwgPSA5IC0gY29udHJpYnV0aW9uOwogICAgICAgIGRlY29kZWQgPSB0aGlzLmRlY29kZXIucmVhZEJpdCh0aGlzLmNvbnRleHRzLCBjb250ZXh0TGFiZWwpIF4gMTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRlY29kZWQ7CiAgICB9CgogICAgcnVuTWFnbml0dWRlUmVmaW5lbWVudFBhc3MoKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3QgYml0c0RlY29kZWQgPSB0aGlzLmJpdHNEZWNvZGVkOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgIGNvbnN0IGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CiAgICAgIGNvbnN0IGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0OwogICAgICBjb25zdCB3aWR0aDQgPSB3aWR0aCAqIDQ7CgogICAgICBmb3IgKGxldCBpbmRleDAgPSAwLCBpbmRleE5leHQ7IGluZGV4MCA8IGxlbmd0aDsgaW5kZXgwID0gaW5kZXhOZXh0KSB7CiAgICAgICAgaW5kZXhOZXh0ID0gTWF0aC5taW4obGVuZ3RoLCBpbmRleDAgKyB3aWR0aDQpOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gaW5kZXgwICsgajsgaW5kZXggPCBpbmRleE5leHQ7IGluZGV4ICs9IHdpZHRoKSB7CiAgICAgICAgICAgIGlmICghY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdIHx8IChwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdICYgcHJvY2Vzc2VkTWFzaykgIT09IDApIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGNvbnRleHRMYWJlbCA9IDE2OwoKICAgICAgICAgICAgaWYgKChwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdICYgZmlyc3RNYWduaXR1ZGVCaXRNYXNrKSAhPT0gMCkgewogICAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gXj0gZmlyc3RNYWduaXR1ZGVCaXRNYXNrOwogICAgICAgICAgICAgIGNvbnN0IHNpZ25pZmljYW5jZSA9IG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF0gJiAxMjc7CiAgICAgICAgICAgICAgY29udGV4dExhYmVsID0gc2lnbmlmaWNhbmNlID09PSAwID8gMTUgOiAxNDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgYml0ID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPDwgMSB8IGJpdDsKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gcHJvY2Vzc2VkTWFzazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBydW5DbGVhbnVwUGFzcygpIHsKICAgICAgY29uc3QgZGVjb2RlciA9IHRoaXMuZGVjb2RlcjsKICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLndpZHRoLAogICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodDsKICAgICAgY29uc3QgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgIGNvbnN0IGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgY29uc3QgY29lZmZpY2VudHNTaWduID0gdGhpcy5jb2VmZmljZW50c1NpZ247CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3QgbGFiZWxzID0gdGhpcy5jb250ZXh0TGFiZWxUYWJsZTsKICAgICAgY29uc3QgYml0c0RlY29kZWQgPSB0aGlzLmJpdHNEZWNvZGVkOwogICAgICBjb25zdCBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgY29uc3QgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgIGNvbnN0IGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CiAgICAgIGNvbnN0IG9uZVJvd0Rvd24gPSB3aWR0aDsKICAgICAgY29uc3QgdHdvUm93c0Rvd24gPSB3aWR0aCAqIDI7CiAgICAgIGNvbnN0IHRocmVlUm93c0Rvd24gPSB3aWR0aCAqIDM7CiAgICAgIGxldCBpTmV4dDsKCiAgICAgIGZvciAobGV0IGkwID0gMDsgaTAgPCBoZWlnaHQ7IGkwID0gaU5leHQpIHsKICAgICAgICBpTmV4dCA9IE1hdGgubWluKGkwICsgNCwgaGVpZ2h0KTsKICAgICAgICBjb25zdCBpbmRleEJhc2UgPSBpMCAqIHdpZHRoOwogICAgICAgIGNvbnN0IGNoZWNrQWxsRW1wdHkgPSBpMCArIDMgPCBoZWlnaHQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgY29uc3QgaW5kZXgwID0gaW5kZXhCYXNlICsgajsKICAgICAgICAgIGNvbnN0IGFsbEVtcHR5ID0gY2hlY2tBbGxFbXB0eSAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwXSA9PT0gMCAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwICsgb25lUm93RG93bl0gPT09IDAgJiYgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4MCArIHR3b1Jvd3NEb3duXSA9PT0gMCAmJiBwcm9jZXNzaW5nRmxhZ3NbaW5kZXgwICsgdGhyZWVSb3dzRG93bl0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MF0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MCArIG9uZVJvd0Rvd25dID09PSAwICYmIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleDAgKyB0d29Sb3dzRG93bl0gPT09IDAgJiYgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4MCArIHRocmVlUm93c0Rvd25dID09PSAwOwogICAgICAgICAgbGV0IGkxID0gMCwKICAgICAgICAgICAgICBpbmRleCA9IGluZGV4MDsKICAgICAgICAgIGxldCBpID0gaTAsCiAgICAgICAgICAgICAgc2lnbjsKCiAgICAgICAgICBpZiAoYWxsRW1wdHkpIHsKICAgICAgICAgICAgY29uc3QgaGFzU2lnbmlmaWNhbnRDb2VmZmljZW50ID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBSVU5MRU5HVEhfQ09OVEVYVCk7CgogICAgICAgICAgICBpZiAoIWhhc1NpZ25pZmljYW50Q29lZmZpY2VudCkgewogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MF0rKzsKICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleDAgKyBvbmVSb3dEb3duXSsrOwogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIHR3b1Jvd3NEb3duXSsrOwogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIHRocmVlUm93c0Rvd25dKys7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkxID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDEgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCk7CgogICAgICAgICAgICBpZiAoaTEgIT09IDApIHsKICAgICAgICAgICAgICBpID0gaTAgKyBpMTsKICAgICAgICAgICAgICBpbmRleCArPSBpMSAqIHdpZHRoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgY29lZmZpY2VudHNTaWduW2luZGV4XSA9IHNpZ247CiAgICAgICAgICAgIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSA9IDE7CiAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSB8PSBmaXJzdE1hZ25pdHVkZUJpdE1hc2s7CiAgICAgICAgICAgIGluZGV4ID0gaW5kZXgwOwoKICAgICAgICAgICAgZm9yIChsZXQgaTIgPSBpMDsgaTIgPD0gaTsgaTIrKywgaW5kZXggKz0gd2lkdGgpIHsKICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleF0rKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaTErKzsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGkgPSBpMCArIGkxOyBpIDwgaU5leHQ7IGkrKywgaW5kZXggKz0gd2lkdGgpIHsKICAgICAgICAgICAgaWYgKGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSB8fCAocHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSAmIHByb2Nlc3NlZE1hc2spICE9PSAwKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGNvbnRleHRMYWJlbCA9IGxhYmVsc1tuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdXTsKICAgICAgICAgICAgY29uc3QgZGVjaXNpb24gPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CgogICAgICAgICAgICBpZiAoZGVjaXNpb24gPT09IDEpIHsKICAgICAgICAgICAgICBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBjb2VmZmljZW50c1NpZ25baW5kZXhdID0gc2lnbjsKICAgICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSAxOwogICAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgICBwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdIHw9IGZpcnN0TWFnbml0dWRlQml0TWFzazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY2hlY2tTZWdtZW50YXRpb25TeW1ib2woKSB7CiAgICAgIGNvbnN0IGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgIGNvbnN0IGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgY29uc3Qgc3ltYm9sID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDMgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCkgPDwgMiB8IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgVU5JRk9STV9DT05URVhUKSA8PCAxIHwgZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpOwoKICAgICAgaWYgKHN5bWJvbCAhPT0gMHhhKSB7CiAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIHNlZ21lbnRhdGlvbiBzeW1ib2wiKTsKICAgICAgfQogICAgfQoKICB9CgogIHJldHVybiBCaXRNb2RlbDsKfSgpOwoKY2xhc3MgVHJhbnNmb3JtIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBUcmFuc2Zvcm0pIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgVHJhbnNmb3JtLiIpOwogICAgfQogIH0KCiAgY2FsY3VsYXRlKHN1YmJhbmRzLCB1MCwgdjApIHsKICAgIGxldCBsbCA9IHN1YmJhbmRzWzBdOwoKICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IHN1YmJhbmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgbGwgPSB0aGlzLml0ZXJhdGUobGwsIHN1YmJhbmRzW2ldLCB1MCwgdjApOwogICAgfQoKICAgIHJldHVybiBsbDsKICB9CgogIGV4dGVuZChidWZmZXIsIG9mZnNldCwgc2l6ZSkgewogICAgbGV0IGkxID0gb2Zmc2V0IC0gMSwKICAgICAgICBqMSA9IG9mZnNldCArIDE7CiAgICBsZXQgaTIgPSBvZmZzZXQgKyBzaXplIC0gMiwKICAgICAgICBqMiA9IG9mZnNldCArIHNpemU7CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICBidWZmZXJbaTFdID0gYnVmZmVyW2oxXTsKICAgIGJ1ZmZlcltqMl0gPSBidWZmZXJbaTJdOwogIH0KCiAgZmlsdGVyKHgsIG9mZnNldCwgbGVuZ3RoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYGZpbHRlcmAgY2FsbGVkIik7CiAgfQoKICBpdGVyYXRlKGxsLCBobF9saF9oaCwgdTAsIHYwKSB7CiAgICBjb25zdCBsbFdpZHRoID0gbGwud2lkdGgsCiAgICAgICAgICBsbEhlaWdodCA9IGxsLmhlaWdodDsKICAgIGxldCBsbEl0ZW1zID0gbGwuaXRlbXM7CiAgICBjb25zdCB3aWR0aCA9IGhsX2xoX2hoLndpZHRoOwogICAgY29uc3QgaGVpZ2h0ID0gaGxfbGhfaGguaGVpZ2h0OwogICAgY29uc3QgaXRlbXMgPSBobF9saF9oaC5pdGVtczsKICAgIGxldCBpLCBqLCBrLCBsLCB1LCB2OwoKICAgIGZvciAoayA9IDAsIGkgPSAwOyBpIDwgbGxIZWlnaHQ7IGkrKykgewogICAgICBsID0gaSAqIDIgKiB3aWR0aDsKCiAgICAgIGZvciAoaiA9IDA7IGogPCBsbFdpZHRoOyBqKyssIGsrKywgbCArPSAyKSB7CiAgICAgICAgaXRlbXNbbF0gPSBsbEl0ZW1zW2tdOwogICAgICB9CiAgICB9CgogICAgbGxJdGVtcyA9IGxsLml0ZW1zID0gbnVsbDsKICAgIGNvbnN0IGJ1ZmZlclBhZGRpbmcgPSA0OwogICAgY29uc3Qgcm93QnVmZmVyID0gbmV3IEZsb2F0MzJBcnJheSh3aWR0aCArIDIgKiBidWZmZXJQYWRkaW5nKTsKCiAgICBpZiAod2lkdGggPT09IDEpIHsKICAgICAgaWYgKCh1MCAmIDEpICE9PSAwKSB7CiAgICAgICAgZm9yICh2ID0gMCwgayA9IDA7IHYgPCBoZWlnaHQ7IHYrKywgayArPSB3aWR0aCkgewogICAgICAgICAgaXRlbXNba10gKj0gMC41OwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yICh2ID0gMCwgayA9IDA7IHYgPCBoZWlnaHQ7IHYrKywgayArPSB3aWR0aCkgewogICAgICAgIHJvd0J1ZmZlci5zZXQoaXRlbXMuc3ViYXJyYXkoaywgayArIHdpZHRoKSwgYnVmZmVyUGFkZGluZyk7CiAgICAgICAgdGhpcy5leHRlbmQocm93QnVmZmVyLCBidWZmZXJQYWRkaW5nLCB3aWR0aCk7CiAgICAgICAgdGhpcy5maWx0ZXIocm93QnVmZmVyLCBidWZmZXJQYWRkaW5nLCB3aWR0aCk7CiAgICAgICAgaXRlbXMuc2V0KHJvd0J1ZmZlci5zdWJhcnJheShidWZmZXJQYWRkaW5nLCBidWZmZXJQYWRkaW5nICsgd2lkdGgpLCBrKTsKICAgICAgfQogICAgfQoKICAgIGxldCBudW1CdWZmZXJzID0gMTY7CiAgICBjb25zdCBjb2xCdWZmZXJzID0gW107CgogICAgZm9yIChpID0gMDsgaSA8IG51bUJ1ZmZlcnM7IGkrKykgewogICAgICBjb2xCdWZmZXJzLnB1c2gobmV3IEZsb2F0MzJBcnJheShoZWlnaHQgKyAyICogYnVmZmVyUGFkZGluZykpOwogICAgfQoKICAgIGxldCBiLAogICAgICAgIGN1cnJlbnRCdWZmZXIgPSAwOwogICAgbGwgPSBidWZmZXJQYWRkaW5nICsgaGVpZ2h0OwoKICAgIGlmIChoZWlnaHQgPT09IDEpIHsKICAgICAgaWYgKCh2MCAmIDEpICE9PSAwKSB7CiAgICAgICAgZm9yICh1ID0gMDsgdSA8IHdpZHRoOyB1KyspIHsKICAgICAgICAgIGl0ZW1zW3VdICo9IDAuNTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAodSA9IDA7IHUgPCB3aWR0aDsgdSsrKSB7CiAgICAgICAgaWYgKGN1cnJlbnRCdWZmZXIgPT09IDApIHsKICAgICAgICAgIG51bUJ1ZmZlcnMgPSBNYXRoLm1pbih3aWR0aCAtIHUsIG51bUJ1ZmZlcnMpOwoKICAgICAgICAgIGZvciAoayA9IHUsIGwgPSBidWZmZXJQYWRkaW5nOyBsIDwgbGw7IGsgKz0gd2lkdGgsIGwrKykgewogICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgbnVtQnVmZmVyczsgYisrKSB7CiAgICAgICAgICAgICAgY29sQnVmZmVyc1tiXVtsXSA9IGl0ZW1zW2sgKyBiXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRCdWZmZXIgPSBudW1CdWZmZXJzOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudEJ1ZmZlci0tOwogICAgICAgIGNvbnN0IGJ1ZmZlciA9IGNvbEJ1ZmZlcnNbY3VycmVudEJ1ZmZlcl07CiAgICAgICAgdGhpcy5leHRlbmQoYnVmZmVyLCBidWZmZXJQYWRkaW5nLCBoZWlnaHQpOwogICAgICAgIHRoaXMuZmlsdGVyKGJ1ZmZlciwgYnVmZmVyUGFkZGluZywgaGVpZ2h0KTsKCiAgICAgICAgaWYgKGN1cnJlbnRCdWZmZXIgPT09IDApIHsKICAgICAgICAgIGsgPSB1IC0gbnVtQnVmZmVycyArIDE7CgogICAgICAgICAgZm9yIChsID0gYnVmZmVyUGFkZGluZzsgbCA8IGxsOyBrICs9IHdpZHRoLCBsKyspIHsKICAgICAgICAgICAgZm9yIChiID0gMDsgYiA8IG51bUJ1ZmZlcnM7IGIrKykgewogICAgICAgICAgICAgIGl0ZW1zW2sgKyBiXSA9IGNvbEJ1ZmZlcnNbYl1bbF07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpdGVtcwogICAgfTsKICB9Cgp9CgpjbGFzcyBJcnJldmVyc2libGVUcmFuc2Zvcm0gZXh0ZW5kcyBUcmFuc2Zvcm0gewogIGZpbHRlcih4LCBvZmZzZXQsIGxlbmd0aCkgewogICAgY29uc3QgbGVuID0gbGVuZ3RoID4+IDE7CiAgICBvZmZzZXQgfD0gMDsKICAgIGxldCBqLCBuLCBjdXJyZW50LCBuZXh0OwogICAgY29uc3QgYWxwaGEgPSAtMS41ODYxMzQzNDIwNTk5MjQ7CiAgICBjb25zdCBiZXRhID0gLTAuMDUyOTgwMTE4NTcyOTYxOwogICAgY29uc3QgZ2FtbWEgPSAwLjg4MjkxMTA3NTUzMDkzNDsKICAgIGNvbnN0IGRlbHRhID0gMC40NDM1MDY4NTIwNDM5NzE7CiAgICBjb25zdCBLID0gMS4yMzAxNzQxMDQ5MTQwMDE7CiAgICBjb25zdCBLXyA9IDEgLyBLOwogICAgaiA9IG9mZnNldCAtIDM7CgogICAgZm9yIChuID0gbGVuICsgNDsgbi0tOyBqICs9IDIpIHsKICAgICAgeFtqXSAqPSBLXzsKICAgIH0KCiAgICBqID0gb2Zmc2V0IC0gMjsKICAgIGN1cnJlbnQgPSBkZWx0YSAqIHhbaiAtIDFdOwoKICAgIGZvciAobiA9IGxlbiArIDM7IG4tLTsgaiArPSAyKSB7CiAgICAgIG5leHQgPSBkZWx0YSAqIHhbaiArIDFdOwogICAgICB4W2pdID0gSyAqIHhbal0gLSBjdXJyZW50IC0gbmV4dDsKCiAgICAgIGlmIChuLS0pIHsKICAgICAgICBqICs9IDI7CiAgICAgICAgY3VycmVudCA9IGRlbHRhICogeFtqICsgMV07CiAgICAgICAgeFtqXSA9IEsgKiB4W2pdIC0gY3VycmVudCAtIG5leHQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBqID0gb2Zmc2V0IC0gMTsKICAgIGN1cnJlbnQgPSBnYW1tYSAqIHhbaiAtIDFdOwoKICAgIGZvciAobiA9IGxlbiArIDI7IG4tLTsgaiArPSAyKSB7CiAgICAgIG5leHQgPSBnYW1tYSAqIHhbaiArIDFdOwogICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwoKICAgICAgaWYgKG4tLSkgewogICAgICAgIGogKz0gMjsKICAgICAgICBjdXJyZW50ID0gZ2FtbWEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaiA9IG9mZnNldDsKICAgIGN1cnJlbnQgPSBiZXRhICogeFtqIC0gMV07CgogICAgZm9yIChuID0gbGVuICsgMTsgbi0tOyBqICs9IDIpIHsKICAgICAgbmV4dCA9IGJldGEgKiB4W2ogKyAxXTsKICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKCiAgICAgIGlmIChuLS0pIHsKICAgICAgICBqICs9IDI7CiAgICAgICAgY3VycmVudCA9IGJldGEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGxlbiAhPT0gMCkgewogICAgICBqID0gb2Zmc2V0ICsgMTsKICAgICAgY3VycmVudCA9IGFscGhhICogeFtqIC0gMV07CgogICAgICBmb3IgKG4gPSBsZW47IG4tLTsgaiArPSAyKSB7CiAgICAgICAgbmV4dCA9IGFscGhhICogeFtqICsgMV07CiAgICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKCiAgICAgICAgaWYgKG4tLSkgewogICAgICAgICAgaiArPSAyOwogICAgICAgICAgY3VycmVudCA9IGFscGhhICogeFtqICsgMV07CiAgICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBSZXZlcnNpYmxlVHJhbnNmb3JtIGV4dGVuZHMgVHJhbnNmb3JtIHsKICBmaWx0ZXIoeCwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIGNvbnN0IGxlbiA9IGxlbmd0aCA+PiAxOwogICAgb2Zmc2V0IHw9IDA7CiAgICBsZXQgaiwgbjsKCiAgICBmb3IgKGogPSBvZmZzZXQsIG4gPSBsZW4gKyAxOyBuLS07IGogKz0gMikgewogICAgICB4W2pdIC09IHhbaiAtIDFdICsgeFtqICsgMV0gKyAyID4+IDI7CiAgICB9CgogICAgZm9yIChqID0gb2Zmc2V0ICsgMSwgbiA9IGxlbjsgbi0tOyBqICs9IDIpIHsKICAgICAgeFtqXSArPSB4W2ogLSAxXSArIHhbaiArIDFdID4+IDE7CiAgICB9CiAgfQoKfQoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTFpXU3RyZWFtID0gdm9pZCAwOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CgpjbGFzcyBMWldTdHJlYW0gZXh0ZW5kcyBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0ciwgbWF5YmVMZW5ndGgsIGVhcmx5Q2hhbmdlKSB7CiAgICBzdXBlcihtYXliZUxlbmd0aCk7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdGhpcy5jYWNoZWREYXRhID0gMDsKICAgIHRoaXMuYml0c0NhY2hlZCA9IDA7CiAgICBjb25zdCBtYXhMendEaWN0aW9uYXJ5U2l6ZSA9IDQwOTY7CiAgICBjb25zdCBsendTdGF0ZSA9IHsKICAgICAgZWFybHlDaGFuZ2UsCiAgICAgIGNvZGVMZW5ndGg6IDksCiAgICAgIG5leHRDb2RlOiAyNTgsCiAgICAgIGRpY3Rpb25hcnlWYWx1ZXM6IG5ldyBVaW50OEFycmF5KG1heEx6d0RpY3Rpb25hcnlTaXplKSwKICAgICAgZGljdGlvbmFyeUxlbmd0aHM6IG5ldyBVaW50MTZBcnJheShtYXhMendEaWN0aW9uYXJ5U2l6ZSksCiAgICAgIGRpY3Rpb25hcnlQcmV2Q29kZXM6IG5ldyBVaW50MTZBcnJheShtYXhMendEaWN0aW9uYXJ5U2l6ZSksCiAgICAgIGN1cnJlbnRTZXF1ZW5jZTogbmV3IFVpbnQ4QXJyYXkobWF4THp3RGljdGlvbmFyeVNpemUpLAogICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGg6IDAKICAgIH07CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkgewogICAgICBsendTdGF0ZS5kaWN0aW9uYXJ5VmFsdWVzW2ldID0gaTsKICAgICAgbHp3U3RhdGUuZGljdGlvbmFyeUxlbmd0aHNbaV0gPSAxOwogICAgfQoKICAgIHRoaXMubHp3U3RhdGUgPSBsendTdGF0ZTsKICB9CgogIHJlYWRCaXRzKG4pIHsKICAgIGxldCBiaXRzQ2FjaGVkID0gdGhpcy5iaXRzQ2FjaGVkOwogICAgbGV0IGNhY2hlZERhdGEgPSB0aGlzLmNhY2hlZERhdGE7CgogICAgd2hpbGUgKGJpdHNDYWNoZWQgPCBuKSB7CiAgICAgIGNvbnN0IGMgPSB0aGlzLnN0ci5nZXRCeXRlKCk7CgogICAgICBpZiAoYyA9PT0gLTEpIHsKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNhY2hlZERhdGEgPSBjYWNoZWREYXRhIDw8IDggfCBjOwogICAgICBiaXRzQ2FjaGVkICs9IDg7CiAgICB9CgogICAgdGhpcy5iaXRzQ2FjaGVkID0gYml0c0NhY2hlZCAtPSBuOwogICAgdGhpcy5jYWNoZWREYXRhID0gY2FjaGVkRGF0YTsKICAgIHRoaXMubGFzdENvZGUgPSBudWxsOwogICAgcmV0dXJuIGNhY2hlZERhdGEgPj4+IGJpdHNDYWNoZWQgJiAoMSA8PCBuKSAtIDE7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICBjb25zdCBibG9ja1NpemUgPSA1MTIsCiAgICAgICAgICBkZWNvZGVkU2l6ZURlbHRhID0gYmxvY2tTaXplOwogICAgbGV0IGVzdGltYXRlZERlY29kZWRTaXplID0gYmxvY2tTaXplICogMjsKICAgIGxldCBpLCBqLCBxOwogICAgY29uc3QgbHp3U3RhdGUgPSB0aGlzLmx6d1N0YXRlOwoKICAgIGlmICghbHp3U3RhdGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGVhcmx5Q2hhbmdlID0gbHp3U3RhdGUuZWFybHlDaGFuZ2U7CiAgICBsZXQgbmV4dENvZGUgPSBsendTdGF0ZS5uZXh0Q29kZTsKICAgIGNvbnN0IGRpY3Rpb25hcnlWYWx1ZXMgPSBsendTdGF0ZS5kaWN0aW9uYXJ5VmFsdWVzOwogICAgY29uc3QgZGljdGlvbmFyeUxlbmd0aHMgPSBsendTdGF0ZS5kaWN0aW9uYXJ5TGVuZ3RoczsKICAgIGNvbnN0IGRpY3Rpb25hcnlQcmV2Q29kZXMgPSBsendTdGF0ZS5kaWN0aW9uYXJ5UHJldkNvZGVzOwogICAgbGV0IGNvZGVMZW5ndGggPSBsendTdGF0ZS5jb2RlTGVuZ3RoOwogICAgbGV0IHByZXZDb2RlID0gbHp3U3RhdGUucHJldkNvZGU7CiAgICBjb25zdCBjdXJyZW50U2VxdWVuY2UgPSBsendTdGF0ZS5jdXJyZW50U2VxdWVuY2U7CiAgICBsZXQgY3VycmVudFNlcXVlbmNlTGVuZ3RoID0gbHp3U3RhdGUuY3VycmVudFNlcXVlbmNlTGVuZ3RoOwogICAgbGV0IGRlY29kZWRMZW5ndGggPSAwOwogICAgbGV0IGN1cnJlbnRCdWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGxldCBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcih0aGlzLmJ1ZmZlckxlbmd0aCArIGVzdGltYXRlZERlY29kZWRTaXplKTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgYmxvY2tTaXplOyBpKyspIHsKICAgICAgY29uc3QgY29kZSA9IHRoaXMucmVhZEJpdHMoY29kZUxlbmd0aCk7CiAgICAgIGNvbnN0IGhhc1ByZXYgPSBjdXJyZW50U2VxdWVuY2VMZW5ndGggPiAwOwoKICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKICAgICAgICBjdXJyZW50U2VxdWVuY2VbMF0gPSBjb2RlOwogICAgICAgIGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IDE7CiAgICAgIH0gZWxzZSBpZiAoY29kZSA+PSAyNTgpIHsKICAgICAgICBpZiAoY29kZSA8IG5leHRDb2RlKSB7CiAgICAgICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGggPSBkaWN0aW9uYXJ5TGVuZ3Roc1tjb2RlXTsKCiAgICAgICAgICBmb3IgKGogPSBjdXJyZW50U2VxdWVuY2VMZW5ndGggLSAxLCBxID0gY29kZTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgICAgY3VycmVudFNlcXVlbmNlW2pdID0gZGljdGlvbmFyeVZhbHVlc1txXTsKICAgICAgICAgICAgcSA9IGRpY3Rpb25hcnlQcmV2Q29kZXNbcV07CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRTZXF1ZW5jZVtjdXJyZW50U2VxdWVuY2VMZW5ndGgrK10gPSBjdXJyZW50U2VxdWVuY2VbMF07CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IDI1NikgewogICAgICAgIGNvZGVMZW5ndGggPSA5OwogICAgICAgIG5leHRDb2RlID0gMjU4OwogICAgICAgIGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IDA7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIGRlbGV0ZSB0aGlzLmx6d1N0YXRlOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoaGFzUHJldikgewogICAgICAgIGRpY3Rpb25hcnlQcmV2Q29kZXNbbmV4dENvZGVdID0gcHJldkNvZGU7CiAgICAgICAgZGljdGlvbmFyeUxlbmd0aHNbbmV4dENvZGVdID0gZGljdGlvbmFyeUxlbmd0aHNbcHJldkNvZGVdICsgMTsKICAgICAgICBkaWN0aW9uYXJ5VmFsdWVzW25leHRDb2RlXSA9IGN1cnJlbnRTZXF1ZW5jZVswXTsKICAgICAgICBuZXh0Q29kZSsrOwogICAgICAgIGNvZGVMZW5ndGggPSBuZXh0Q29kZSArIGVhcmx5Q2hhbmdlICYgbmV4dENvZGUgKyBlYXJseUNoYW5nZSAtIDEgPyBjb2RlTGVuZ3RoIDogTWF0aC5taW4oTWF0aC5sb2cobmV4dENvZGUgKyBlYXJseUNoYW5nZSkgLyAwLjY5MzE0NzE4MDU1OTk0NTMgKyAxLCAxMikgfCAwOwogICAgICB9CgogICAgICBwcmV2Q29kZSA9IGNvZGU7CiAgICAgIGRlY29kZWRMZW5ndGggKz0gY3VycmVudFNlcXVlbmNlTGVuZ3RoOwoKICAgICAgaWYgKGVzdGltYXRlZERlY29kZWRTaXplIDwgZGVjb2RlZExlbmd0aCkgewogICAgICAgIGRvIHsKICAgICAgICAgIGVzdGltYXRlZERlY29kZWRTaXplICs9IGRlY29kZWRTaXplRGVsdGE7CiAgICAgICAgfSB3aGlsZSAoZXN0aW1hdGVkRGVjb2RlZFNpemUgPCBkZWNvZGVkTGVuZ3RoKTsKCiAgICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIodGhpcy5idWZmZXJMZW5ndGggKyBlc3RpbWF0ZWREZWNvZGVkU2l6ZSk7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDA7IGogPCBjdXJyZW50U2VxdWVuY2VMZW5ndGg7IGorKykgewogICAgICAgIGJ1ZmZlcltjdXJyZW50QnVmZmVyTGVuZ3RoKytdID0gY3VycmVudFNlcXVlbmNlW2pdOwogICAgICB9CiAgICB9CgogICAgbHp3U3RhdGUubmV4dENvZGUgPSBuZXh0Q29kZTsKICAgIGx6d1N0YXRlLmNvZGVMZW5ndGggPSBjb2RlTGVuZ3RoOwogICAgbHp3U3RhdGUucHJldkNvZGUgPSBwcmV2Q29kZTsKICAgIGx6d1N0YXRlLmN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IGN1cnJlbnRTZXF1ZW5jZUxlbmd0aDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gY3VycmVudEJ1ZmZlckxlbmd0aDsKICB9Cgp9CgpleHBvcnRzLkxaV1N0cmVhbSA9IExaV1N0cmVhbTsKCi8qKiovIH0pLAovKiAzMiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlByZWRpY3RvclN0cmVhbSA9IHZvaWQgMDsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBQcmVkaWN0b3JTdHJlYW0gZXh0ZW5kcyBfZGVjb2RlX3N0cmVhbS5EZWNvZGVTdHJlYW0gewogIGNvbnN0cnVjdG9yKHN0ciwgbWF5YmVMZW5ndGgsIHBhcmFtcykgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwoKICAgIGlmICghKHBhcmFtcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBzdHI7CiAgICB9CgogICAgY29uc3QgcHJlZGljdG9yID0gdGhpcy5wcmVkaWN0b3IgPSBwYXJhbXMuZ2V0KCJQcmVkaWN0b3IiKSB8fCAxOwoKICAgIGlmIChwcmVkaWN0b3IgPD0gMSkgewogICAgICByZXR1cm4gc3RyOwogICAgfQoKICAgIGlmIChwcmVkaWN0b3IgIT09IDIgJiYgKHByZWRpY3RvciA8IDEwIHx8IHByZWRpY3RvciA+IDE1KSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuc3VwcG9ydGVkIHByZWRpY3RvcjogJHtwcmVkaWN0b3J9YCk7CiAgICB9CgogICAgaWYgKHByZWRpY3RvciA9PT0gMikgewogICAgICB0aGlzLnJlYWRCbG9jayA9IHRoaXMucmVhZEJsb2NrVGlmZjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVhZEJsb2NrID0gdGhpcy5yZWFkQmxvY2tQbmc7CiAgICB9CgogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzID0gcGFyYW1zLmdldCgiQ29sb3JzIikgfHwgMTsKICAgIGNvbnN0IGJpdHMgPSB0aGlzLmJpdHMgPSBwYXJhbXMuZ2V0KCJCUEMiLCAiQml0c1BlckNvbXBvbmVudCIpIHx8IDg7CiAgICBjb25zdCBjb2x1bW5zID0gdGhpcy5jb2x1bW5zID0gcGFyYW1zLmdldCgiQ29sdW1ucyIpIHx8IDE7CiAgICB0aGlzLnBpeEJ5dGVzID0gY29sb3JzICogYml0cyArIDcgPj4gMzsKICAgIHRoaXMucm93Qnl0ZXMgPSBjb2x1bW5zICogY29sb3JzICogYml0cyArIDcgPj4gMzsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgcmVhZEJsb2NrVGlmZigpIHsKICAgIGNvbnN0IHJvd0J5dGVzID0gdGhpcy5yb3dCeXRlczsKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgcm93Qnl0ZXMpOwogICAgY29uc3QgYml0cyA9IHRoaXMuYml0czsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3QgcmF3Qnl0ZXMgPSB0aGlzLnN0ci5nZXRCeXRlcyhyb3dCeXRlcyk7CiAgICB0aGlzLmVvZiA9ICFyYXdCeXRlcy5sZW5ndGg7CgogICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgaW5idWYgPSAwLAogICAgICAgIG91dGJ1ZiA9IDA7CiAgICBsZXQgaW5iaXRzID0gMCwKICAgICAgICBvdXRiaXRzID0gMDsKICAgIGxldCBwb3MgPSBidWZmZXJMZW5ndGg7CiAgICBsZXQgaTsKCiAgICBpZiAoYml0cyA9PT0gMSAmJiBjb2xvcnMgPT09IDEpIHsKICAgICAgZm9yIChpID0gMDsgaSA8IHJvd0J5dGVzOyArK2kpIHsKICAgICAgICBsZXQgYyA9IHJhd0J5dGVzW2ldIF4gaW5idWY7CiAgICAgICAgYyBePSBjID4+IDE7CiAgICAgICAgYyBePSBjID4+IDI7CiAgICAgICAgYyBePSBjID4+IDQ7CiAgICAgICAgaW5idWYgPSAoYyAmIDEpIDw8IDc7CiAgICAgICAgYnVmZmVyW3BvcysrXSA9IGM7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoYml0cyA9PT0gOCkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgY29sb3JzOyArK2kpIHsKICAgICAgICBidWZmZXJbcG9zKytdID0gcmF3Qnl0ZXNbaV07CiAgICAgIH0KCiAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgIGJ1ZmZlcltwb3NdID0gYnVmZmVyW3BvcyAtIGNvbG9yc10gKyByYXdCeXRlc1tpXTsKICAgICAgICBwb3MrKzsKICAgICAgfQogICAgfSBlbHNlIGlmIChiaXRzID09PSAxNikgewogICAgICBjb25zdCBieXRlc1BlclBpeGVsID0gY29sb3JzICogMjsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBieXRlc1BlclBpeGVsOyArK2kpIHsKICAgICAgICBidWZmZXJbcG9zKytdID0gcmF3Qnl0ZXNbaV07CiAgICAgIH0KCiAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7IGkgKz0gMikgewogICAgICAgIGNvbnN0IHN1bSA9ICgocmF3Qnl0ZXNbaV0gJiAweGZmKSA8PCA4KSArIChyYXdCeXRlc1tpICsgMV0gJiAweGZmKSArICgoYnVmZmVyW3BvcyAtIGJ5dGVzUGVyUGl4ZWxdICYgMHhmZikgPDwgOCkgKyAoYnVmZmVyW3BvcyAtIGJ5dGVzUGVyUGl4ZWwgKyAxXSAmIDB4ZmYpOwogICAgICAgIGJ1ZmZlcltwb3MrK10gPSBzdW0gPj4gOCAmIDB4ZmY7CiAgICAgICAgYnVmZmVyW3BvcysrXSA9IHN1bSAmIDB4ZmY7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGNvbXBBcnJheSA9IG5ldyBVaW50OEFycmF5KGNvbG9ycyArIDEpOwogICAgICBjb25zdCBiaXRNYXNrID0gKDEgPDwgYml0cykgLSAxOwogICAgICBsZXQgaiA9IDAsCiAgICAgICAgICBrID0gYnVmZmVyTGVuZ3RoOwogICAgICBjb25zdCBjb2x1bW5zID0gdGhpcy5jb2x1bW5zOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGNvbHVtbnM7ICsraSkgewogICAgICAgIGZvciAobGV0IGtrID0gMDsga2sgPCBjb2xvcnM7ICsra2spIHsKICAgICAgICAgIGlmIChpbmJpdHMgPCBiaXRzKSB7CiAgICAgICAgICAgIGluYnVmID0gaW5idWYgPDwgOCB8IHJhd0J5dGVzW2orK10gJiAweGZmOwogICAgICAgICAgICBpbmJpdHMgKz0gODsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21wQXJyYXlba2tdID0gY29tcEFycmF5W2trXSArIChpbmJ1ZiA+PiBpbmJpdHMgLSBiaXRzKSAmIGJpdE1hc2s7CiAgICAgICAgICBpbmJpdHMgLT0gYml0czsKICAgICAgICAgIG91dGJ1ZiA9IG91dGJ1ZiA8PCBiaXRzIHwgY29tcEFycmF5W2trXTsKICAgICAgICAgIG91dGJpdHMgKz0gYml0czsKCiAgICAgICAgICBpZiAob3V0Yml0cyA+PSA4KSB7CiAgICAgICAgICAgIGJ1ZmZlcltrKytdID0gb3V0YnVmID4+IG91dGJpdHMgLSA4ICYgMHhmZjsKICAgICAgICAgICAgb3V0Yml0cyAtPSA4OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG91dGJpdHMgPiAwKSB7CiAgICAgICAgYnVmZmVyW2srK10gPSAob3V0YnVmIDw8IDggLSBvdXRiaXRzKSArIChpbmJ1ZiAmICgxIDw8IDggLSBvdXRiaXRzKSAtIDEpOwogICAgICB9CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggKz0gcm93Qnl0ZXM7CiAgfQoKICByZWFkQmxvY2tQbmcoKSB7CiAgICBjb25zdCByb3dCeXRlcyA9IHRoaXMucm93Qnl0ZXM7CiAgICBjb25zdCBwaXhCeXRlcyA9IHRoaXMucGl4Qnl0ZXM7CiAgICBjb25zdCBwcmVkaWN0b3IgPSB0aGlzLnN0ci5nZXRCeXRlKCk7CiAgICBjb25zdCByYXdCeXRlcyA9IHRoaXMuc3RyLmdldEJ5dGVzKHJvd0J5dGVzKTsKICAgIHRoaXMuZW9mID0gIXJhd0J5dGVzLmxlbmd0aDsKCiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgY29uc3QgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgcm93Qnl0ZXMpOwogICAgbGV0IHByZXZSb3cgPSBidWZmZXIuc3ViYXJyYXkoYnVmZmVyTGVuZ3RoIC0gcm93Qnl0ZXMsIGJ1ZmZlckxlbmd0aCk7CgogICAgaWYgKHByZXZSb3cubGVuZ3RoID09PSAwKSB7CiAgICAgIHByZXZSb3cgPSBuZXcgVWludDhBcnJheShyb3dCeXRlcyk7CiAgICB9CgogICAgbGV0IGksCiAgICAgICAgaiA9IGJ1ZmZlckxlbmd0aCwKICAgICAgICB1cCwKICAgICAgICBjOwoKICAgIHN3aXRjaCAocHJlZGljdG9yKSB7CiAgICAgIGNhc2UgMDoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSByYXdCeXRlc1tpXTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwaXhCeXRlczsgKytpKSB7CiAgICAgICAgICBidWZmZXJbaisrXSA9IHJhd0J5dGVzW2ldOwogICAgICAgIH0KCiAgICAgICAgZm9yICg7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgICBidWZmZXJbal0gPSBidWZmZXJbaiAtIHBpeEJ5dGVzXSArIHJhd0J5dGVzW2ldICYgMHhmZjsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgICBidWZmZXJbaisrXSA9IHByZXZSb3dbaV0gKyByYXdCeXRlc1tpXSAmIDB4ZmY7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGl4Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSAocHJldlJvd1tpXSA+PiAxKSArIHJhd0J5dGVzW2ldOwogICAgICAgIH0KCiAgICAgICAgZm9yICg7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgICBidWZmZXJbal0gPSAocHJldlJvd1tpXSArIGJ1ZmZlcltqIC0gcGl4Qnl0ZXNdID4+IDEpICsgcmF3Qnl0ZXNbaV0gJiAweGZmOwogICAgICAgICAgaisrOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDQ6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHBpeEJ5dGVzOyArK2kpIHsKICAgICAgICAgIHVwID0gcHJldlJvd1tpXTsKICAgICAgICAgIGMgPSByYXdCeXRlc1tpXTsKICAgICAgICAgIGJ1ZmZlcltqKytdID0gdXAgKyBjOwogICAgICAgIH0KCiAgICAgICAgZm9yICg7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgICB1cCA9IHByZXZSb3dbaV07CiAgICAgICAgICBjb25zdCB1cExlZnQgPSBwcmV2Um93W2kgLSBwaXhCeXRlc107CiAgICAgICAgICBjb25zdCBsZWZ0ID0gYnVmZmVyW2ogLSBwaXhCeXRlc107CiAgICAgICAgICBjb25zdCBwID0gbGVmdCArIHVwIC0gdXBMZWZ0OwogICAgICAgICAgbGV0IHBhID0gcCAtIGxlZnQ7CgogICAgICAgICAgaWYgKHBhIDwgMCkgewogICAgICAgICAgICBwYSA9IC1wYTsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcGIgPSBwIC0gdXA7CgogICAgICAgICAgaWYgKHBiIDwgMCkgewogICAgICAgICAgICBwYiA9IC1wYjsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcGMgPSBwIC0gdXBMZWZ0OwoKICAgICAgICAgIGlmIChwYyA8IDApIHsKICAgICAgICAgICAgcGMgPSAtcGM7CiAgICAgICAgICB9CgogICAgICAgICAgYyA9IHJhd0J5dGVzW2ldOwoKICAgICAgICAgIGlmIChwYSA8PSBwYiAmJiBwYSA8PSBwYykgewogICAgICAgICAgICBidWZmZXJbaisrXSA9IGxlZnQgKyBjOwogICAgICAgICAgfSBlbHNlIGlmIChwYiA8PSBwYykgewogICAgICAgICAgICBidWZmZXJbaisrXSA9IHVwICsgYzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJ1ZmZlcltqKytdID0gdXBMZWZ0ICsgYzsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuc3VwcG9ydGVkIHByZWRpY3RvcjogJHtwcmVkaWN0b3J9YCk7CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggKz0gcm93Qnl0ZXM7CiAgfQoKfQoKZXhwb3J0cy5QcmVkaWN0b3JTdHJlYW0gPSBQcmVkaWN0b3JTdHJlYW07CgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5SdW5MZW5ndGhTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX2RlY29kZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKCmNsYXNzIFJ1bkxlbmd0aFN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCkgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICB9CgogIHJlYWRCbG9jaygpIHsKICAgIGNvbnN0IHJlcGVhdEhlYWRlciA9IHRoaXMuc3RyLmdldEJ5dGVzKDIpOwoKICAgIGlmICghcmVwZWF0SGVhZGVyIHx8IHJlcGVhdEhlYWRlci5sZW5ndGggPCAyIHx8IHJlcGVhdEhlYWRlclswXSA9PT0gMTI4KSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBidWZmZXI7CiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICBsZXQgbiA9IHJlcGVhdEhlYWRlclswXTsKCiAgICBpZiAobiA8IDEyOCkgewogICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyBuICsgMSk7CiAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGgrK10gPSByZXBlYXRIZWFkZXJbMV07CgogICAgICBpZiAobiA+IDApIHsKICAgICAgICBjb25zdCBzb3VyY2UgPSB0aGlzLnN0ci5nZXRCeXRlcyhuKTsKICAgICAgICBidWZmZXIuc2V0KHNvdXJjZSwgYnVmZmVyTGVuZ3RoKTsKICAgICAgICBidWZmZXJMZW5ndGggKz0gbjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbiA9IDI1NyAtIG47CiAgICAgIGNvbnN0IGIgPSByZXBlYXRIZWFkZXJbMV07CiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIG4gKyAxKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aCsrXSA9IGI7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICB9Cgp9CgpleHBvcnRzLlJ1bkxlbmd0aFN0cmVhbSA9IFJ1bkxlbmd0aFN0cmVhbTsKCi8qKiovIH0pLAovKiAzNCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkZvbnQgPSBleHBvcnRzLkVycm9yRm9udCA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NmZl9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM1KTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKCnZhciBfdW5pY29kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDApOwoKdmFyIF9nbHlwaGxpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygzNyk7Cgp2YXIgX3N0YW5kYXJkX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXyg0MSk7Cgp2YXIgX3RvX3VuaWNvZGVfbWFwID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7Cgp2YXIgX2NmZl9mb250ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cgp2YXIgX2ZvbnRfcmVuZGVyZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ0KTsKCnZhciBfbWV0cmljcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDUpOwoKdmFyIF9nbHlmID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nik7Cgp2YXIgX2NtYXAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKCnZhciBfb3BlbnR5cGVfZmlsZV9idWlsZGVyID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKCnZhciBfdHlwZTFfZm9udCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDgpOwoKY29uc3QgUFJJVkFURV9VU0VfQVJFQVMgPSBbWzB4ZTAwMCwgMHhmOGZmXSwgWzB4MTAwMDAwLCAweDEwZmZmZF1dOwpjb25zdCBQREZfR0xZUEhfU1BBQ0VfVU5JVFMgPSAxMDAwOwpjb25zdCBFWFBPUlRfREFUQV9QUk9QRVJUSUVTID0gWyJhc2NlbnQiLCAiYmJveCIsICJibGFjayIsICJib2xkIiwgImNoYXJQcm9jT3BlcmF0b3JMaXN0IiwgImNvbXBvc2l0ZSIsICJjc3NGb250SW5mbyIsICJkYXRhIiwgImRlZmF1bHRWTWV0cmljcyIsICJkZWZhdWx0V2lkdGgiLCAiZGVzY2VudCIsICJmYWxsYmFja05hbWUiLCAiZm9udE1hdHJpeCIsICJmb250VHlwZSIsICJpc1R5cGUzRm9udCIsICJpdGFsaWMiLCAibG9hZGVkTmFtZSIsICJtaW1ldHlwZSIsICJtaXNzaW5nRmlsZSIsICJuYW1lIiwgInJlbWVhc3VyZSIsICJzdWJ0eXBlIiwgInR5cGUiLCAidmVydGljYWwiXTsKY29uc3QgRVhQT1JUX0RBVEFfRVhUUkFfUFJPUEVSVElFUyA9IFsiY01hcCIsICJkZWZhdWx0RW5jb2RpbmciLCAiZGlmZmVyZW5jZXMiLCAiaXNNb25vc3BhY2UiLCAiaXNTZXJpZkZvbnQiLCAiaXNTeW1ib2xpY0ZvbnQiLCAic2VhY01hcCIsICJ0b0ZvbnRDaGFyIiwgInRvVW5pY29kZSIsICJ2bWV0cmljcyIsICJ3aWR0aHMiXTsKCmZ1bmN0aW9uIGFkanVzdFdpZHRocyhwcm9wZXJ0aWVzKSB7CiAgaWYgKCFwcm9wZXJ0aWVzLmZvbnRNYXRyaXgpIHsKICAgIHJldHVybjsKICB9CgogIGlmIChwcm9wZXJ0aWVzLmZvbnRNYXRyaXhbMF0gPT09IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYWzBdKSB7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBzY2FsZSA9IDAuMDAxIC8gcHJvcGVydGllcy5mb250TWF0cml4WzBdOwogIGNvbnN0IGdseXBoc1dpZHRocyA9IHByb3BlcnRpZXMud2lkdGhzOwoKICBmb3IgKGNvbnN0IGdseXBoIGluIGdseXBoc1dpZHRocykgewogICAgZ2x5cGhzV2lkdGhzW2dseXBoXSAqPSBzY2FsZTsKICB9CgogIHByb3BlcnRpZXMuZGVmYXVsdFdpZHRoICo9IHNjYWxlOwp9CgpmdW5jdGlvbiBhZGp1c3RUb1VuaWNvZGUocHJvcGVydGllcywgYnVpbHRJbkVuY29kaW5nKSB7CiAgaWYgKHByb3BlcnRpZXMuaXNJbnRlcm5hbEZvbnQpIHsKICAgIHJldHVybjsKICB9CgogIGlmIChidWlsdEluRW5jb2RpbmcgPT09IHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nKSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAocHJvcGVydGllcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IHRvVW5pY29kZSA9IFtdLAogICAgICAgIGdseXBoc1VuaWNvZGVNYXAgPSAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwoKICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIGJ1aWx0SW5FbmNvZGluZykgewogICAgaWYgKHByb3BlcnRpZXMuaGFzSW5jbHVkZWRUb1VuaWNvZGVNYXApIHsKICAgICAgaWYgKHByb3BlcnRpZXMudG9Vbmljb2RlLmhhcyhjaGFyQ29kZSkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfSBlbHNlIGlmIChwcm9wZXJ0aWVzLmhhc0VuY29kaW5nKSB7CiAgICAgIGlmIChwcm9wZXJ0aWVzLmRpZmZlcmVuY2VzLmxlbmd0aCA9PT0gMCB8fCBwcm9wZXJ0aWVzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBnbHlwaE5hbWUgPSBidWlsdEluRW5jb2RpbmdbY2hhckNvZGVdOwogICAgY29uc3QgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKGdseXBoTmFtZSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgIHRvVW5pY29kZVtjaGFyQ29kZV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHVuaWNvZGUpOwogICAgfQogIH0KCiAgaWYgKHRvVW5pY29kZS5sZW5ndGggPiAwKSB7CiAgICBwcm9wZXJ0aWVzLnRvVW5pY29kZS5hbWVuZCh0b1VuaWNvZGUpOwogIH0KfQoKZnVuY3Rpb24gYW1lbmRGYWxsYmFja1RvVW5pY29kZShwcm9wZXJ0aWVzKSB7CiAgaWYgKCFwcm9wZXJ0aWVzLmZhbGxiYWNrVG9Vbmljb2RlKSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAocHJvcGVydGllcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IHRvVW5pY29kZSA9IFtdOwoKICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIHByb3BlcnRpZXMuZmFsbGJhY2tUb1VuaWNvZGUpIHsKICAgIGlmIChwcm9wZXJ0aWVzLnRvVW5pY29kZS5oYXMoY2hhckNvZGUpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIHRvVW5pY29kZVtjaGFyQ29kZV0gPSBwcm9wZXJ0aWVzLmZhbGxiYWNrVG9Vbmljb2RlW2NoYXJDb2RlXTsKICB9CgogIGlmICh0b1VuaWNvZGUubGVuZ3RoID4gMCkgewogICAgcHJvcGVydGllcy50b1VuaWNvZGUuYW1lbmQodG9Vbmljb2RlKTsKICB9Cn0KCmNsYXNzIEdseXBoIHsKICBjb25zdHJ1Y3RvcihvcmlnaW5hbENoYXJDb2RlLCBmb250Q2hhciwgdW5pY29kZSwgYWNjZW50LCB3aWR0aCwgdm1ldHJpYywgb3BlcmF0b3JMaXN0SWQsIGlzU3BhY2UsIGlzSW5Gb250KSB7CiAgICB0aGlzLm9yaWdpbmFsQ2hhckNvZGUgPSBvcmlnaW5hbENoYXJDb2RlOwogICAgdGhpcy5mb250Q2hhciA9IGZvbnRDaGFyOwogICAgdGhpcy51bmljb2RlID0gdW5pY29kZTsKICAgIHRoaXMuYWNjZW50ID0gYWNjZW50OwogICAgdGhpcy53aWR0aCA9IHdpZHRoOwogICAgdGhpcy52bWV0cmljID0gdm1ldHJpYzsKICAgIHRoaXMub3BlcmF0b3JMaXN0SWQgPSBvcGVyYXRvckxpc3RJZDsKICAgIHRoaXMuaXNTcGFjZSA9IGlzU3BhY2U7CiAgICB0aGlzLmlzSW5Gb250ID0gaXNJbkZvbnQ7CiAgICBjb25zdCBjYXRlZ29yeSA9ICgwLCBfdW5pY29kZS5nZXRDaGFyVW5pY29kZUNhdGVnb3J5KSh1bmljb2RlKTsKICAgIHRoaXMuaXNXaGl0ZXNwYWNlID0gY2F0ZWdvcnkuaXNXaGl0ZXNwYWNlOwogICAgdGhpcy5pc1plcm9XaWR0aERpYWNyaXRpYyA9IGNhdGVnb3J5LmlzWmVyb1dpZHRoRGlhY3JpdGljOwogICAgdGhpcy5pc0ludmlzaWJsZUZvcm1hdE1hcmsgPSBjYXRlZ29yeS5pc0ludmlzaWJsZUZvcm1hdE1hcms7CiAgfQoKICBtYXRjaGVzRm9yQ2FjaGUob3JpZ2luYWxDaGFyQ29kZSwgZm9udENoYXIsIHVuaWNvZGUsIGFjY2VudCwgd2lkdGgsIHZtZXRyaWMsIG9wZXJhdG9yTGlzdElkLCBpc1NwYWNlLCBpc0luRm9udCkgewogICAgcmV0dXJuIHRoaXMub3JpZ2luYWxDaGFyQ29kZSA9PT0gb3JpZ2luYWxDaGFyQ29kZSAmJiB0aGlzLmZvbnRDaGFyID09PSBmb250Q2hhciAmJiB0aGlzLnVuaWNvZGUgPT09IHVuaWNvZGUgJiYgdGhpcy5hY2NlbnQgPT09IGFjY2VudCAmJiB0aGlzLndpZHRoID09PSB3aWR0aCAmJiB0aGlzLnZtZXRyaWMgPT09IHZtZXRyaWMgJiYgdGhpcy5vcGVyYXRvckxpc3RJZCA9PT0gb3BlcmF0b3JMaXN0SWQgJiYgdGhpcy5pc1NwYWNlID09PSBpc1NwYWNlICYmIHRoaXMuaXNJbkZvbnQgPT09IGlzSW5Gb250OwogIH0KCn0KCmZ1bmN0aW9uIGludDE2KGIwLCBiMSkgewogIHJldHVybiAoYjAgPDwgOCkgKyBiMTsKfQoKZnVuY3Rpb24gd3JpdGVTaWduZWRJbnQxNihieXRlcywgaW5kZXgsIHZhbHVlKSB7CiAgYnl0ZXNbaW5kZXggKyAxXSA9IHZhbHVlOwogIGJ5dGVzW2luZGV4XSA9IHZhbHVlID4+PiA4Owp9CgpmdW5jdGlvbiBzaWduZWRJbnQxNihiMCwgYjEpIHsKICBjb25zdCB2YWx1ZSA9IChiMCA8PCA4KSArIGIxOwogIHJldHVybiB2YWx1ZSAmIDEgPDwgMTUgPyB2YWx1ZSAtIDB4MTAwMDAgOiB2YWx1ZTsKfQoKZnVuY3Rpb24gaW50MzIoYjAsIGIxLCBiMiwgYjMpIHsKICByZXR1cm4gKGIwIDw8IDI0KSArIChiMSA8PCAxNikgKyAoYjIgPDwgOCkgKyBiMzsKfQoKZnVuY3Rpb24gc3RyaW5nMTYodmFsdWUpIHsKICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSh2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKfQoKZnVuY3Rpb24gc2FmZVN0cmluZzE2KHZhbHVlKSB7CiAgaWYgKHZhbHVlID4gMHg3ZmZmKSB7CiAgICB2YWx1ZSA9IDB4N2ZmZjsKICB9IGVsc2UgaWYgKHZhbHVlIDwgLTB4ODAwMCkgewogICAgdmFsdWUgPSAtMHg4MDAwOwogIH0KCiAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7Cn0KCmZ1bmN0aW9uIGlzVHJ1ZVR5cGVGaWxlKGZpbGUpIHsKICBjb25zdCBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKICByZXR1cm4gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGhlYWRlciwgMCkgPT09IDB4MDAwMTAwMDAgfHwgKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGhlYWRlcikgPT09ICJ0cnVlIjsKfQoKZnVuY3Rpb24gaXNUcnVlVHlwZUNvbGxlY3Rpb25GaWxlKGZpbGUpIHsKICBjb25zdCBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKICByZXR1cm4gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGhlYWRlcikgPT09ICJ0dGNmIjsKfQoKZnVuY3Rpb24gaXNPcGVuVHlwZUZpbGUoZmlsZSkgewogIGNvbnN0IGhlYWRlciA9IGZpbGUucGVla0J5dGVzKDQpOwogIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoaGVhZGVyKSA9PT0gIk9UVE8iOwp9CgpmdW5jdGlvbiBpc1R5cGUxRmlsZShmaWxlKSB7CiAgY29uc3QgaGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoMik7CgogIGlmIChoZWFkZXJbMF0gPT09IDB4MjUgJiYgaGVhZGVyWzFdID09PSAweDIxKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChoZWFkZXJbMF0gPT09IDB4ODAgJiYgaGVhZGVyWzFdID09PSAweDAxKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24gaXNDRkZGaWxlKGZpbGUpIHsKICBjb25zdCBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKCiAgaWYgKGhlYWRlclswXSA+PSAxICYmIGhlYWRlclszXSA+PSAxICYmIGhlYWRlclszXSA8PSA0KSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24gZ2V0Rm9udEZpbGVUeXBlKGZpbGUsIHsKICB0eXBlLAogIHN1YnR5cGUsCiAgY29tcG9zaXRlCn0pIHsKICBsZXQgZmlsZVR5cGUsIGZpbGVTdWJ0eXBlOwoKICBpZiAoaXNUcnVlVHlwZUZpbGUoZmlsZSkgfHwgaXNUcnVlVHlwZUNvbGxlY3Rpb25GaWxlKGZpbGUpKSB7CiAgICBpZiAoY29tcG9zaXRlKSB7CiAgICAgIGZpbGVUeXBlID0gIkNJREZvbnRUeXBlMiI7CiAgICB9IGVsc2UgewogICAgICBmaWxlVHlwZSA9ICJUcnVlVHlwZSI7CiAgICB9CiAgfSBlbHNlIGlmIChpc09wZW5UeXBlRmlsZShmaWxlKSkgewogICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICBmaWxlVHlwZSA9ICJDSURGb250VHlwZTIiOwogICAgfSBlbHNlIHsKICAgICAgZmlsZVR5cGUgPSAiT3BlblR5cGUiOwogICAgfQogIH0gZWxzZSBpZiAoaXNUeXBlMUZpbGUoZmlsZSkpIHsKICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgZmlsZVR5cGUgPSAiQ0lERm9udFR5cGUwIjsKICAgIH0gZWxzZSB7CiAgICAgIGZpbGVUeXBlID0gdHlwZSA9PT0gIk1NVHlwZTEiID8gIk1NVHlwZTEiIDogIlR5cGUxIjsKICAgIH0KICB9IGVsc2UgaWYgKGlzQ0ZGRmlsZShmaWxlKSkgewogICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICBmaWxlVHlwZSA9ICJDSURGb250VHlwZTAiOwogICAgICBmaWxlU3VidHlwZSA9ICJDSURGb250VHlwZTBDIjsKICAgIH0gZWxzZSB7CiAgICAgIGZpbGVUeXBlID0gdHlwZSA9PT0gIk1NVHlwZTEiID8gIk1NVHlwZTEiIDogIlR5cGUxIjsKICAgICAgZmlsZVN1YnR5cGUgPSAiVHlwZTFDIjsKICAgIH0KICB9IGVsc2UgewogICAgKDAsIF91dGlsLndhcm4pKCJnZXRGb250RmlsZVR5cGU6IFVuYWJsZSB0byBkZXRlY3QgY29ycmVjdCBmb250IGZpbGUgVHlwZS9TdWJ0eXBlLiIpOwogICAgZmlsZVR5cGUgPSB0eXBlOwogICAgZmlsZVN1YnR5cGUgPSBzdWJ0eXBlOwogIH0KCiAgcmV0dXJuIFtmaWxlVHlwZSwgZmlsZVN1YnR5cGVdOwp9CgpmdW5jdGlvbiBhcHBseVN0YW5kYXJkRm9udEdseXBoTWFwKG1hcCwgZ2x5cGhNYXApIHsKICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIGdseXBoTWFwKSB7CiAgICBtYXBbK2NoYXJDb2RlXSA9IGdseXBoTWFwW2NoYXJDb2RlXTsKICB9Cn0KCmZ1bmN0aW9uIGJ1aWxkVG9Gb250Q2hhcihlbmNvZGluZywgZ2x5cGhzVW5pY29kZU1hcCwgZGlmZmVyZW5jZXMpIHsKICBjb25zdCB0b0ZvbnRDaGFyID0gW107CiAgbGV0IHVuaWNvZGU7CgogIGZvciAobGV0IGkgPSAwLCBpaSA9IGVuY29kaW5nLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShlbmNvZGluZ1tpXSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgIHRvRm9udENoYXJbaV0gPSB1bmljb2RlOwogICAgfQogIH0KCiAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBkaWZmZXJlbmNlcykgewogICAgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKGRpZmZlcmVuY2VzW2NoYXJDb2RlXSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgIHRvRm9udENoYXJbK2NoYXJDb2RlXSA9IHVuaWNvZGU7CiAgICB9CiAgfQoKICByZXR1cm4gdG9Gb250Q2hhcjsKfQoKZnVuY3Rpb24gY29udmVydENpZFN0cmluZyhjaGFyQ29kZSwgY2lkLCBzaG91bGRUaHJvdyA9IGZhbHNlKSB7CiAgc3dpdGNoIChjaWQubGVuZ3RoKSB7CiAgICBjYXNlIDE6CiAgICAgIHJldHVybiBjaWQuY2hhckNvZGVBdCgwKTsKCiAgICBjYXNlIDI6CiAgICAgIHJldHVybiBjaWQuY2hhckNvZGVBdCgwKSA8PCA4IHwgY2lkLmNoYXJDb2RlQXQoMSk7CiAgfQoKICBjb25zdCBtc2cgPSBgVW5zdXBwb3J0ZWQgQ0lEIHN0cmluZyAoY2hhckNvZGUgJHtjaGFyQ29kZX0pOiAiJHtjaWR9Ii5gOwoKICBpZiAoc2hvdWxkVGhyb3cpIHsKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihtc2cpOwogIH0KCiAgKDAsIF91dGlsLndhcm4pKG1zZyk7CiAgcmV0dXJuIGNpZDsKfQoKZnVuY3Rpb24gYWRqdXN0TWFwcGluZyhjaGFyQ29kZVRvR2x5cGhJZCwgaGFzR2x5cGgsIG5ld0dseXBoWmVyb0lkLCB0b1VuaWNvZGUpIHsKICBjb25zdCBuZXdNYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIGNvbnN0IHRvVW5pY29kZUV4dHJhTWFwID0gbmV3IE1hcCgpOwogIGNvbnN0IHRvRm9udENoYXIgPSBbXTsKICBjb25zdCB1c2VkR2x5cGhJZHMgPSBuZXcgU2V0KCk7CiAgbGV0IHByaXZhdGVVc2VBcmVhSW5kZXggPSAwOwogIGNvbnN0IHByaXZhdGVVc2VPZmZldFN0YXJ0ID0gUFJJVkFURV9VU0VfQVJFQVNbcHJpdmF0ZVVzZUFyZWFJbmRleF1bMF07CiAgbGV0IG5leHRBdmFpbGFibGVGb250Q2hhckNvZGUgPSBwcml2YXRlVXNlT2ZmZXRTdGFydDsKICBsZXQgcHJpdmF0ZVVzZU9mZmV0RW5kID0gUFJJVkFURV9VU0VfQVJFQVNbcHJpdmF0ZVVzZUFyZWFJbmRleF1bMV07CgogIGZvciAobGV0IG9yaWdpbmFsQ2hhckNvZGUgaW4gY2hhckNvZGVUb0dseXBoSWQpIHsKICAgIG9yaWdpbmFsQ2hhckNvZGUgfD0gMDsKICAgIGxldCBnbHlwaElkID0gY2hhckNvZGVUb0dseXBoSWRbb3JpZ2luYWxDaGFyQ29kZV07CgogICAgaWYgKCFoYXNHbHlwaChnbHlwaElkKSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAobmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZSA+IHByaXZhdGVVc2VPZmZldEVuZCkgewogICAgICBwcml2YXRlVXNlQXJlYUluZGV4Kys7CgogICAgICBpZiAocHJpdmF0ZVVzZUFyZWFJbmRleCA+PSBQUklWQVRFX1VTRV9BUkVBUy5sZW5ndGgpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlJhbiBvdXQgb2Ygc3BhY2UgaW4gZm9udCBwcml2YXRlIHVzZSBhcmVhLiIpOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlID0gUFJJVkFURV9VU0VfQVJFQVNbcHJpdmF0ZVVzZUFyZWFJbmRleF1bMF07CiAgICAgIHByaXZhdGVVc2VPZmZldEVuZCA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzFdOwogICAgfQoKICAgIGNvbnN0IGZvbnRDaGFyQ29kZSA9IG5leHRBdmFpbGFibGVGb250Q2hhckNvZGUrKzsKCiAgICBpZiAoZ2x5cGhJZCA9PT0gMCkgewogICAgICBnbHlwaElkID0gbmV3R2x5cGhaZXJvSWQ7CiAgICB9CgogICAgbGV0IHVuaWNvZGUgPSB0b1VuaWNvZGUuZ2V0KG9yaWdpbmFsQ2hhckNvZGUpOwoKICAgIGlmICh0eXBlb2YgdW5pY29kZSA9PT0gInN0cmluZyIpIHsKICAgICAgdW5pY29kZSA9IHVuaWNvZGUuY29kZVBvaW50QXQoMCk7CiAgICB9CgogICAgaWYgKHVuaWNvZGUgJiYgdW5pY29kZSA8IHByaXZhdGVVc2VPZmZldFN0YXJ0ICYmICF1c2VkR2x5cGhJZHMuaGFzKGdseXBoSWQpKSB7CiAgICAgIHRvVW5pY29kZUV4dHJhTWFwLnNldCh1bmljb2RlLCBnbHlwaElkKTsKICAgICAgdXNlZEdseXBoSWRzLmFkZChnbHlwaElkKTsKICAgIH0KCiAgICBuZXdNYXBbZm9udENoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICB0b0ZvbnRDaGFyW29yaWdpbmFsQ2hhckNvZGVdID0gZm9udENoYXJDb2RlOwogIH0KCiAgcmV0dXJuIHsKICAgIHRvRm9udENoYXIsCiAgICBjaGFyQ29kZVRvR2x5cGhJZDogbmV3TWFwLAogICAgdG9Vbmljb2RlRXh0cmFNYXAsCiAgICBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlCiAgfTsKfQoKZnVuY3Rpb24gZ2V0UmFuZ2VzKGdseXBocywgdG9Vbmljb2RlRXh0cmFNYXAsIG51bUdseXBocykgewogIGNvbnN0IGNvZGVzID0gW107CgogIGZvciAoY29uc3QgY2hhckNvZGUgaW4gZ2x5cGhzKSB7CiAgICBpZiAoZ2x5cGhzW2NoYXJDb2RlXSA+PSBudW1HbHlwaHMpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29kZXMucHVzaCh7CiAgICAgIGZvbnRDaGFyQ29kZTogY2hhckNvZGUgfCAwLAogICAgICBnbHlwaElkOiBnbHlwaHNbY2hhckNvZGVdCiAgICB9KTsKICB9CgogIGlmICh0b1VuaWNvZGVFeHRyYU1hcCkgewogICAgZm9yIChjb25zdCBbdW5pY29kZSwgZ2x5cGhJZF0gb2YgdG9Vbmljb2RlRXh0cmFNYXApIHsKICAgICAgaWYgKGdseXBoSWQgPj0gbnVtR2x5cGhzKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvZGVzLnB1c2goewogICAgICAgIGZvbnRDaGFyQ29kZTogdW5pY29kZSwKICAgICAgICBnbHlwaElkCiAgICAgIH0pOwogICAgfQogIH0KCiAgaWYgKGNvZGVzLmxlbmd0aCA9PT0gMCkgewogICAgY29kZXMucHVzaCh7CiAgICAgIGZvbnRDaGFyQ29kZTogMCwKICAgICAgZ2x5cGhJZDogMAogICAgfSk7CiAgfQoKICBjb2Rlcy5zb3J0KGZ1bmN0aW9uIGZvbnRHZXRSYW5nZXNTb3J0KGEsIGIpIHsKICAgIHJldHVybiBhLmZvbnRDaGFyQ29kZSAtIGIuZm9udENoYXJDb2RlOwogIH0pOwogIGNvbnN0IHJhbmdlcyA9IFtdOwogIGNvbnN0IGxlbmd0aCA9IGNvZGVzLmxlbmd0aDsKCiAgZm9yIChsZXQgbiA9IDA7IG4gPCBsZW5ndGg7KSB7CiAgICBjb25zdCBzdGFydCA9IGNvZGVzW25dLmZvbnRDaGFyQ29kZTsKICAgIGNvbnN0IGNvZGVJbmRpY2VzID0gW2NvZGVzW25dLmdseXBoSWRdOwogICAgKytuOwogICAgbGV0IGVuZCA9IHN0YXJ0OwoKICAgIHdoaWxlIChuIDwgbGVuZ3RoICYmIGVuZCArIDEgPT09IGNvZGVzW25dLmZvbnRDaGFyQ29kZSkgewogICAgICBjb2RlSW5kaWNlcy5wdXNoKGNvZGVzW25dLmdseXBoSWQpOwogICAgICArK2VuZDsKICAgICAgKytuOwoKICAgICAgaWYgKGVuZCA9PT0gMHhmZmZmKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICByYW5nZXMucHVzaChbc3RhcnQsIGVuZCwgY29kZUluZGljZXNdKTsKICB9CgogIHJldHVybiByYW5nZXM7Cn0KCmZ1bmN0aW9uIGNyZWF0ZUNtYXBUYWJsZShnbHlwaHMsIHRvVW5pY29kZUV4dHJhTWFwLCBudW1HbHlwaHMpIHsKICBjb25zdCByYW5nZXMgPSBnZXRSYW5nZXMoZ2x5cGhzLCB0b1VuaWNvZGVFeHRyYU1hcCwgbnVtR2x5cGhzKTsKICBjb25zdCBudW1UYWJsZXMgPSByYW5nZXMuYXQoLTEpWzFdID4gMHhmZmZmID8gMiA6IDE7CiAgbGV0IGNtYXAgPSAiXHgwMFx4MDAiICsgc3RyaW5nMTYobnVtVGFibGVzKSArICJceDAwXHgwMyIgKyAiXHgwMFx4MDEiICsgKDAsIF91dGlsLnN0cmluZzMyKSg0ICsgbnVtVGFibGVzICogOCk7CiAgbGV0IGksIGlpLCBqLCBqajsKCiAgZm9yIChpID0gcmFuZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7CiAgICBpZiAocmFuZ2VzW2ldWzBdIDw9IDB4ZmZmZikgewogICAgICBicmVhazsKICAgIH0KICB9CgogIGNvbnN0IGJtcExlbmd0aCA9IGkgKyAxOwoKICBpZiAocmFuZ2VzW2ldWzBdIDwgMHhmZmZmICYmIHJhbmdlc1tpXVsxXSA9PT0gMHhmZmZmKSB7CiAgICByYW5nZXNbaV1bMV0gPSAweGZmZmU7CiAgfQoKICBjb25zdCB0cmFpbGluZ1Jhbmdlc0NvdW50ID0gcmFuZ2VzW2ldWzFdIDwgMHhmZmZmID8gMSA6IDA7CiAgY29uc3Qgc2VnQ291bnQgPSBibXBMZW5ndGggKyB0cmFpbGluZ1Jhbmdlc0NvdW50OwoKICBjb25zdCBzZWFyY2hQYXJhbXMgPSBfb3BlbnR5cGVfZmlsZV9idWlsZGVyLk9wZW5UeXBlRmlsZUJ1aWxkZXIuZ2V0U2VhcmNoUGFyYW1zKHNlZ0NvdW50LCAyKTsKCiAgbGV0IHN0YXJ0Q291bnQgPSAiIjsKICBsZXQgZW5kQ291bnQgPSAiIjsKICBsZXQgaWREZWx0YXMgPSAiIjsKICBsZXQgaWRSYW5nZU9mZnNldHMgPSAiIjsKICBsZXQgZ2x5cGhzSWRzID0gIiI7CiAgbGV0IGJpYXMgPSAwOwogIGxldCByYW5nZSwgc3RhcnQsIGVuZCwgY29kZXM7CgogIGZvciAoaSA9IDAsIGlpID0gYm1wTGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgcmFuZ2UgPSByYW5nZXNbaV07CiAgICBzdGFydCA9IHJhbmdlWzBdOwogICAgZW5kID0gcmFuZ2VbMV07CiAgICBzdGFydENvdW50ICs9IHN0cmluZzE2KHN0YXJ0KTsKICAgIGVuZENvdW50ICs9IHN0cmluZzE2KGVuZCk7CiAgICBjb2RlcyA9IHJhbmdlWzJdOwogICAgbGV0IGNvbnRpZ3VvdXMgPSB0cnVlOwoKICAgIGZvciAoaiA9IDEsIGpqID0gY29kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICBpZiAoY29kZXNbal0gIT09IGNvZGVzW2ogLSAxXSArIDEpIHsKICAgICAgICBjb250aWd1b3VzID0gZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWNvbnRpZ3VvdXMpIHsKICAgICAgY29uc3Qgb2Zmc2V0ID0gKHNlZ0NvdW50IC0gaSkgKiAyICsgYmlhcyAqIDI7CiAgICAgIGJpYXMgKz0gZW5kIC0gc3RhcnQgKyAxOwogICAgICBpZERlbHRhcyArPSBzdHJpbmcxNigwKTsKICAgICAgaWRSYW5nZU9mZnNldHMgKz0gc3RyaW5nMTYob2Zmc2V0KTsKCiAgICAgIGZvciAoaiA9IDAsIGpqID0gY29kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICAgIGdseXBoc0lkcyArPSBzdHJpbmcxNihjb2Rlc1tqXSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHN0YXJ0Q29kZSA9IGNvZGVzWzBdOwogICAgICBpZERlbHRhcyArPSBzdHJpbmcxNihzdGFydENvZGUgLSBzdGFydCAmIDB4ZmZmZik7CiAgICAgIGlkUmFuZ2VPZmZzZXRzICs9IHN0cmluZzE2KDApOwogICAgfQogIH0KCiAgaWYgKHRyYWlsaW5nUmFuZ2VzQ291bnQgPiAwKSB7CiAgICBlbmRDb3VudCArPSAiXHhGRlx4RkYiOwogICAgc3RhcnRDb3VudCArPSAiXHhGRlx4RkYiOwogICAgaWREZWx0YXMgKz0gIlx4MDBceDAxIjsKICAgIGlkUmFuZ2VPZmZzZXRzICs9ICJceDAwXHgwMCI7CiAgfQoKICBjb25zdCBmb3JtYXQzMTQgPSAiXHgwMFx4MDAiICsgc3RyaW5nMTYoMiAqIHNlZ0NvdW50KSArIHN0cmluZzE2KHNlYXJjaFBhcmFtcy5yYW5nZSkgKyBzdHJpbmcxNihzZWFyY2hQYXJhbXMuZW50cnkpICsgc3RyaW5nMTYoc2VhcmNoUGFyYW1zLnJhbmdlU2hpZnQpICsgZW5kQ291bnQgKyAiXHgwMFx4MDAiICsgc3RhcnRDb3VudCArIGlkRGVsdGFzICsgaWRSYW5nZU9mZnNldHMgKyBnbHlwaHNJZHM7CiAgbGV0IGZvcm1hdDMxMDEyID0gIiI7CiAgbGV0IGhlYWRlcjMxMDEyID0gIiI7CgogIGlmIChudW1UYWJsZXMgPiAxKSB7CiAgICBjbWFwICs9ICJceDAwXHgwMyIgKyAiXHgwMFx4MEEiICsgKDAsIF91dGlsLnN0cmluZzMyKSg0ICsgbnVtVGFibGVzICogOCArIDQgKyBmb3JtYXQzMTQubGVuZ3RoKTsKICAgIGZvcm1hdDMxMDEyID0gIiI7CgogICAgZm9yIChpID0gMCwgaWkgPSByYW5nZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICByYW5nZSA9IHJhbmdlc1tpXTsKICAgICAgc3RhcnQgPSByYW5nZVswXTsKICAgICAgY29kZXMgPSByYW5nZVsyXTsKICAgICAgbGV0IGNvZGUgPSBjb2Rlc1swXTsKCiAgICAgIGZvciAoaiA9IDEsIGpqID0gY29kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICAgIGlmIChjb2Rlc1tqXSAhPT0gY29kZXNbaiAtIDFdICsgMSkgewogICAgICAgICAgZW5kID0gcmFuZ2VbMF0gKyBqIC0gMTsKICAgICAgICAgIGZvcm1hdDMxMDEyICs9ICgwLCBfdXRpbC5zdHJpbmczMikoc3RhcnQpICsgKDAsIF91dGlsLnN0cmluZzMyKShlbmQpICsgKDAsIF91dGlsLnN0cmluZzMyKShjb2RlKTsKICAgICAgICAgIHN0YXJ0ID0gZW5kICsgMTsKICAgICAgICAgIGNvZGUgPSBjb2Rlc1tqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvcm1hdDMxMDEyICs9ICgwLCBfdXRpbC5zdHJpbmczMikoc3RhcnQpICsgKDAsIF91dGlsLnN0cmluZzMyKShyYW5nZVsxXSkgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGNvZGUpOwogICAgfQoKICAgIGhlYWRlcjMxMDEyID0gIlx4MDBceDBDIiArICJceDAwXHgwMCIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGZvcm1hdDMxMDEyLmxlbmd0aCArIDE2KSArICJceDAwXHgwMFx4MDBceDAwIiArICgwLCBfdXRpbC5zdHJpbmczMikoZm9ybWF0MzEwMTIubGVuZ3RoIC8gMTIpOwogIH0KCiAgcmV0dXJuIGNtYXAgKyAiXHgwMFx4MDQiICsgc3RyaW5nMTYoZm9ybWF0MzE0Lmxlbmd0aCArIDQpICsgZm9ybWF0MzE0ICsgaGVhZGVyMzEwMTIgKyBmb3JtYXQzMTAxMjsKfQoKZnVuY3Rpb24gdmFsaWRhdGVPUzJUYWJsZShvczIsIGZpbGUpIHsKICBmaWxlLnBvcyA9IChmaWxlLnN0YXJ0IHx8IDApICsgb3MyLm9mZnNldDsKICBjb25zdCB2ZXJzaW9uID0gZmlsZS5nZXRVaW50MTYoKTsKICBmaWxlLnNraXAoNjApOwogIGNvbnN0IHNlbGVjdGlvbiA9IGZpbGUuZ2V0VWludDE2KCk7CgogIGlmICh2ZXJzaW9uIDwgNCAmJiBzZWxlY3Rpb24gJiAweDAzMDApIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGNvbnN0IGZpcnN0Q2hhciA9IGZpbGUuZ2V0VWludDE2KCk7CiAgY29uc3QgbGFzdENoYXIgPSBmaWxlLmdldFVpbnQxNigpOwoKICBpZiAoZmlyc3RDaGFyID4gbGFzdENoYXIpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZpbGUuc2tpcCg2KTsKICBjb25zdCB1c1dpbkFzY2VudCA9IGZpbGUuZ2V0VWludDE2KCk7CgogIGlmICh1c1dpbkFzY2VudCA9PT0gMCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgb3MyLmRhdGFbOF0gPSBvczIuZGF0YVs5XSA9IDA7CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIGNyZWF0ZU9TMlRhYmxlKHByb3BlcnRpZXMsIGNoYXJzdHJpbmdzLCBvdmVycmlkZSkgewogIG92ZXJyaWRlID0gb3ZlcnJpZGUgfHwgewogICAgdW5pdHNQZXJFbTogMCwKICAgIHlNYXg6IDAsCiAgICB5TWluOiAwLAogICAgYXNjZW50OiAwLAogICAgZGVzY2VudDogMAogIH07CiAgbGV0IHVsVW5pY29kZVJhbmdlMSA9IDA7CiAgbGV0IHVsVW5pY29kZVJhbmdlMiA9IDA7CiAgbGV0IHVsVW5pY29kZVJhbmdlMyA9IDA7CiAgbGV0IHVsVW5pY29kZVJhbmdlNCA9IDA7CiAgbGV0IGZpcnN0Q2hhckluZGV4ID0gbnVsbDsKICBsZXQgbGFzdENoYXJJbmRleCA9IDA7CgogIGlmIChjaGFyc3RyaW5ncykgewogICAgZm9yIChsZXQgY29kZSBpbiBjaGFyc3RyaW5ncykgewogICAgICBjb2RlIHw9IDA7CgogICAgICBpZiAoZmlyc3RDaGFySW5kZXggPiBjb2RlIHx8ICFmaXJzdENoYXJJbmRleCkgewogICAgICAgIGZpcnN0Q2hhckluZGV4ID0gY29kZTsKICAgICAgfQoKICAgICAgaWYgKGxhc3RDaGFySW5kZXggPCBjb2RlKSB7CiAgICAgICAgbGFzdENoYXJJbmRleCA9IGNvZGU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBvc2l0aW9uID0gKDAsIF91bmljb2RlLmdldFVuaWNvZGVSYW5nZUZvcikoY29kZSk7CgogICAgICBpZiAocG9zaXRpb24gPCAzMikgewogICAgICAgIHVsVW5pY29kZVJhbmdlMSB8PSAxIDw8IHBvc2l0aW9uOwogICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uIDwgNjQpIHsKICAgICAgICB1bFVuaWNvZGVSYW5nZTIgfD0gMSA8PCBwb3NpdGlvbiAtIDMyOwogICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uIDwgOTYpIHsKICAgICAgICB1bFVuaWNvZGVSYW5nZTMgfD0gMSA8PCBwb3NpdGlvbiAtIDY0OwogICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uIDwgMTIzKSB7CiAgICAgICAgdWxVbmljb2RlUmFuZ2U0IHw9IDEgPDwgcG9zaXRpb24gLSA5NjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVuaWNvZGUgcmFuZ2VzIEJpdHMgPiAxMjMgYXJlIHJlc2VydmVkIGZvciBpbnRlcm5hbCB1c2FnZSIpOwogICAgICB9CiAgICB9CgogICAgaWYgKGxhc3RDaGFySW5kZXggPiAweGZmZmYpIHsKICAgICAgbGFzdENoYXJJbmRleCA9IDB4ZmZmZjsKICAgIH0KICB9IGVsc2UgewogICAgZmlyc3RDaGFySW5kZXggPSAwOwogICAgbGFzdENoYXJJbmRleCA9IDI1NTsKICB9CgogIGNvbnN0IGJib3ggPSBwcm9wZXJ0aWVzLmJib3ggfHwgWzAsIDAsIDAsIDBdOwogIGNvbnN0IHVuaXRzUGVyRW0gPSBvdmVycmlkZS51bml0c1BlckVtIHx8IDEgLyAocHJvcGVydGllcy5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYKVswXTsKICBjb25zdCBzY2FsZSA9IHByb3BlcnRpZXMuYXNjZW50U2NhbGVkID8gMS4wIDogdW5pdHNQZXJFbSAvIFBERl9HTFlQSF9TUEFDRV9VTklUUzsKICBjb25zdCB0eXBvQXNjZW50ID0gb3ZlcnJpZGUuYXNjZW50IHx8IE1hdGgucm91bmQoc2NhbGUgKiAocHJvcGVydGllcy5hc2NlbnQgfHwgYmJveFszXSkpOwogIGxldCB0eXBvRGVzY2VudCA9IG92ZXJyaWRlLmRlc2NlbnQgfHwgTWF0aC5yb3VuZChzY2FsZSAqIChwcm9wZXJ0aWVzLmRlc2NlbnQgfHwgYmJveFsxXSkpOwoKICBpZiAodHlwb0Rlc2NlbnQgPiAwICYmIHByb3BlcnRpZXMuZGVzY2VudCA+IDAgJiYgYmJveFsxXSA8IDApIHsKICAgIHR5cG9EZXNjZW50ID0gLXR5cG9EZXNjZW50OwogIH0KCiAgY29uc3Qgd2luQXNjZW50ID0gb3ZlcnJpZGUueU1heCB8fCB0eXBvQXNjZW50OwogIGNvbnN0IHdpbkRlc2NlbnQgPSAtb3ZlcnJpZGUueU1pbiB8fCAtdHlwb0Rlc2NlbnQ7CiAgcmV0dXJuICJceDAwXHgwMyIgKyAiXHgwMlx4MjQiICsgIlx4MDFceEY0IiArICJceDAwXHgwNSIgKyAiXHgwMFx4MDAiICsgIlx4MDJceDhBIiArICJceDAyXHhCQiIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDhDIiArICJceDAyXHg4QSIgKyAiXHgwMlx4QkIiICsgIlx4MDBceDAwIiArICJceDAxXHhERiIgKyAiXHgwMFx4MzEiICsgIlx4MDFceDAyIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDBceDA2IiArIFN0cmluZy5mcm9tQ2hhckNvZGUocHJvcGVydGllcy5maXhlZFBpdGNoID8gMHgwOSA6IDB4MDApICsgIlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKHVsVW5pY29kZVJhbmdlMSkgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKHVsVW5pY29kZVJhbmdlMikgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKHVsVW5pY29kZVJhbmdlMykgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKHVsVW5pY29kZVJhbmdlNCkgKyAiXHgyQVx4MzJceDMxXHgyQSIgKyBzdHJpbmcxNihwcm9wZXJ0aWVzLml0YWxpY0FuZ2xlID8gMSA6IDApICsgc3RyaW5nMTYoZmlyc3RDaGFySW5kZXggfHwgcHJvcGVydGllcy5maXJzdENoYXIpICsgc3RyaW5nMTYobGFzdENoYXJJbmRleCB8fCBwcm9wZXJ0aWVzLmxhc3RDaGFyKSArIHN0cmluZzE2KHR5cG9Bc2NlbnQpICsgc3RyaW5nMTYodHlwb0Rlc2NlbnQpICsgIlx4MDBceDY0IiArIHN0cmluZzE2KHdpbkFzY2VudCkgKyBzdHJpbmcxNih3aW5EZXNjZW50KSArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArIHN0cmluZzE2KHByb3BlcnRpZXMueEhlaWdodCkgKyBzdHJpbmcxNihwcm9wZXJ0aWVzLmNhcEhlaWdodCkgKyBzdHJpbmcxNigwKSArIHN0cmluZzE2KGZpcnN0Q2hhckluZGV4IHx8IHByb3BlcnRpZXMuZmlyc3RDaGFyKSArICJceDAwXHgwMyI7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVBvc3RUYWJsZShwcm9wZXJ0aWVzKSB7CiAgY29uc3QgYW5nbGUgPSBNYXRoLmZsb29yKHByb3BlcnRpZXMuaXRhbGljQW5nbGUgKiAyICoqIDE2KTsKICByZXR1cm4gIlx4MDBceDAzXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKShhbmdsZSkgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICgwLCBfdXRpbC5zdHJpbmczMikocHJvcGVydGllcy5maXhlZFBpdGNoID8gMSA6IDApICsgIlx4MDBceDAwXHgwMFx4MDAiICsgIlx4MDBceDAwXHgwMFx4MDAiICsgIlx4MDBceDAwXHgwMFx4MDAiICsgIlx4MDBceDAwXHgwMFx4MDAiOwp9CgpmdW5jdGlvbiBjcmVhdGVQb3N0c2NyaXB0TmFtZShuYW1lKSB7CiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvW15ceDIxLVx4N0VdfFtbXF0oKXt9PD4vJV0vZywgIiIpLnNsaWNlKDAsIDYzKTsKfQoKZnVuY3Rpb24gY3JlYXRlTmFtZVRhYmxlKG5hbWUsIHByb3RvKSB7CiAgaWYgKCFwcm90bykgewogICAgcHJvdG8gPSBbW10sIFtdXTsKICB9CgogIGNvbnN0IHN0cmluZ3MgPSBbcHJvdG9bMF1bMF0gfHwgIk9yaWdpbmFsIGxpY2VuY2UiLCBwcm90b1swXVsxXSB8fCBuYW1lLCBwcm90b1swXVsyXSB8fCAiVW5rbm93biIsIHByb3RvWzBdWzNdIHx8ICJ1bmlxdWVJRCIsIHByb3RvWzBdWzRdIHx8IG5hbWUsIHByb3RvWzBdWzVdIHx8ICJWZXJzaW9uIDAuMTEiLCBwcm90b1swXVs2XSB8fCBjcmVhdGVQb3N0c2NyaXB0TmFtZShuYW1lKSwgcHJvdG9bMF1bN10gfHwgIlVua25vd24iLCBwcm90b1swXVs4XSB8fCAiVW5rbm93biIsIHByb3RvWzBdWzldIHx8ICJVbmtub3duIl07CiAgY29uc3Qgc3RyaW5nc1VuaWNvZGUgPSBbXTsKICBsZXQgaSwgaWksIGosIGpqLCBzdHI7CgogIGZvciAoaSA9IDAsIGlpID0gc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBzdHIgPSBwcm90b1sxXVtpXSB8fCBzdHJpbmdzW2ldOwogICAgY29uc3Qgc3RyQnVmVW5pY29kZSA9IFtdOwoKICAgIGZvciAoaiA9IDAsIGpqID0gc3RyLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgc3RyQnVmVW5pY29kZS5wdXNoKHN0cmluZzE2KHN0ci5jaGFyQ29kZUF0KGopKSk7CiAgICB9CgogICAgc3RyaW5nc1VuaWNvZGUucHVzaChzdHJCdWZVbmljb2RlLmpvaW4oIiIpKTsKICB9CgogIGNvbnN0IG5hbWVzID0gW3N0cmluZ3MsIHN0cmluZ3NVbmljb2RlXTsKICBjb25zdCBwbGF0Zm9ybXMgPSBbIlx4MDBceDAxIiwgIlx4MDBceDAzIl07CiAgY29uc3QgZW5jb2RpbmdzID0gWyJceDAwXHgwMCIsICJceDAwXHgwMSJdOwogIGNvbnN0IGxhbmd1YWdlcyA9IFsiXHgwMFx4MDAiLCAiXHgwNFx4MDkiXTsKICBjb25zdCBuYW1lc1JlY29yZENvdW50ID0gc3RyaW5ncy5sZW5ndGggKiBwbGF0Zm9ybXMubGVuZ3RoOwogIGxldCBuYW1lVGFibGUgPSAiXHgwMFx4MDAiICsgc3RyaW5nMTYobmFtZXNSZWNvcmRDb3VudCkgKyBzdHJpbmcxNihuYW1lc1JlY29yZENvdW50ICogMTIgKyA2KTsKICBsZXQgc3RyT2Zmc2V0ID0gMDsKCiAgZm9yIChpID0gMCwgaWkgPSBwbGF0Zm9ybXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgY29uc3Qgc3RycyA9IG5hbWVzW2ldOwoKICAgIGZvciAoaiA9IDAsIGpqID0gc3Rycy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIHN0ciA9IHN0cnNbal07CiAgICAgIGNvbnN0IG5hbWVSZWNvcmQgPSBwbGF0Zm9ybXNbaV0gKyBlbmNvZGluZ3NbaV0gKyBsYW5ndWFnZXNbaV0gKyBzdHJpbmcxNihqKSArIHN0cmluZzE2KHN0ci5sZW5ndGgpICsgc3RyaW5nMTYoc3RyT2Zmc2V0KTsKICAgICAgbmFtZVRhYmxlICs9IG5hbWVSZWNvcmQ7CiAgICAgIHN0ck9mZnNldCArPSBzdHIubGVuZ3RoOwogICAgfQogIH0KCiAgbmFtZVRhYmxlICs9IHN0cmluZ3Muam9pbigiIikgKyBzdHJpbmdzVW5pY29kZS5qb2luKCIiKTsKICByZXR1cm4gbmFtZVRhYmxlOwp9CgpjbGFzcyBGb250IHsKICBjb25zdHJ1Y3RvcihuYW1lLCBmaWxlLCBwcm9wZXJ0aWVzKSB7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5wc05hbWUgPSBudWxsOwogICAgdGhpcy5taW1ldHlwZSA9IG51bGw7CiAgICB0aGlzLmRpc2FibGVGb250RmFjZSA9IGZhbHNlOwogICAgdGhpcy5sb2FkZWROYW1lID0gcHJvcGVydGllcy5sb2FkZWROYW1lOwogICAgdGhpcy5pc1R5cGUzRm9udCA9IHByb3BlcnRpZXMuaXNUeXBlM0ZvbnQ7CiAgICB0aGlzLm1pc3NpbmdGaWxlID0gZmFsc2U7CiAgICB0aGlzLmNzc0ZvbnRJbmZvID0gcHJvcGVydGllcy5jc3NGb250SW5mbzsKICAgIHRoaXMuX2NoYXJzQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5fZ2x5cGhDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBsZXQgaXNTZXJpZkZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5TZXJpZik7CgogICAgaWYgKCFpc1NlcmlmRm9udCAmJiAhcHJvcGVydGllcy5pc1NpbXVsYXRlZEZsYWdzKSB7CiAgICAgIGNvbnN0IGJhc2VOYW1lID0gbmFtZS5yZXBsYWNlKC9bLF9dL2csICItIikuc3BsaXQoIi0iKVswXSwKICAgICAgICAgICAgc2VyaWZGb250cyA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U2VyaWZGb250cykoKTsKCiAgICAgIGZvciAoY29uc3QgbmFtZVBhcnQgb2YgYmFzZU5hbWUuc3BsaXQoIisiKSkgewogICAgICAgIGlmIChzZXJpZkZvbnRzW25hbWVQYXJ0XSkgewogICAgICAgICAgaXNTZXJpZkZvbnQgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpcy5pc1NlcmlmRm9udCA9IGlzU2VyaWZGb250OwogICAgdGhpcy5pc1N5bWJvbGljRm9udCA9ICEhKHByb3BlcnRpZXMuZmxhZ3MgJiBfZm9udHNfdXRpbHMuRm9udEZsYWdzLlN5bWJvbGljKTsKICAgIHRoaXMuaXNNb25vc3BhY2UgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgX2ZvbnRzX3V0aWxzLkZvbnRGbGFncy5GaXhlZFBpdGNoKTsKICAgIGxldCB0eXBlID0gcHJvcGVydGllcy50eXBlOwogICAgbGV0IHN1YnR5cGUgPSBwcm9wZXJ0aWVzLnN1YnR5cGU7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgdGhpcy5zdWJ0eXBlID0gc3VidHlwZTsKICAgIGxldCBmYWxsYmFja05hbWUgPSAic2Fucy1zZXJpZiI7CgogICAgaWYgKHRoaXMuaXNNb25vc3BhY2UpIHsKICAgICAgZmFsbGJhY2tOYW1lID0gIm1vbm9zcGFjZSI7CiAgICB9IGVsc2UgaWYgKHRoaXMuaXNTZXJpZkZvbnQpIHsKICAgICAgZmFsbGJhY2tOYW1lID0gInNlcmlmIjsKICAgIH0KCiAgICB0aGlzLmZhbGxiYWNrTmFtZSA9IGZhbGxiYWNrTmFtZTsKICAgIHRoaXMuZGlmZmVyZW5jZXMgPSBwcm9wZXJ0aWVzLmRpZmZlcmVuY2VzOwogICAgdGhpcy53aWR0aHMgPSBwcm9wZXJ0aWVzLndpZHRoczsKICAgIHRoaXMuZGVmYXVsdFdpZHRoID0gcHJvcGVydGllcy5kZWZhdWx0V2lkdGg7CiAgICB0aGlzLmNvbXBvc2l0ZSA9IHByb3BlcnRpZXMuY29tcG9zaXRlOwogICAgdGhpcy5jTWFwID0gcHJvcGVydGllcy5jTWFwOwogICAgdGhpcy5jYXBIZWlnaHQgPSBwcm9wZXJ0aWVzLmNhcEhlaWdodCAvIFBERl9HTFlQSF9TUEFDRV9VTklUUzsKICAgIHRoaXMuYXNjZW50ID0gcHJvcGVydGllcy5hc2NlbnQgLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgICB0aGlzLmRlc2NlbnQgPSBwcm9wZXJ0aWVzLmRlc2NlbnQgLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgICB0aGlzLmxpbmVIZWlnaHQgPSB0aGlzLmFzY2VudCAtIHRoaXMuZGVzY2VudDsKICAgIHRoaXMuZm9udE1hdHJpeCA9IHByb3BlcnRpZXMuZm9udE1hdHJpeDsKICAgIHRoaXMuYmJveCA9IHByb3BlcnRpZXMuYmJveDsKICAgIHRoaXMuZGVmYXVsdEVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmc7CiAgICB0aGlzLnRvVW5pY29kZSA9IHByb3BlcnRpZXMudG9Vbmljb2RlOwogICAgdGhpcy50b0ZvbnRDaGFyID0gW107CgogICAgaWYgKHByb3BlcnRpZXMudHlwZSA9PT0gIlR5cGUzIikgewogICAgICBmb3IgKGxldCBjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgMjU2OyBjaGFyQ29kZSsrKSB7CiAgICAgICAgdGhpcy50b0ZvbnRDaGFyW2NoYXJDb2RlXSA9IHRoaXMuZGlmZmVyZW5jZXNbY2hhckNvZGVdIHx8IHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nW2NoYXJDb2RlXTsKICAgICAgfQoKICAgICAgdGhpcy5mb250VHlwZSA9IF91dGlsLkZvbnRUeXBlLlRZUEUzOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5jaWRFbmNvZGluZyA9IHByb3BlcnRpZXMuY2lkRW5jb2RpbmcgfHwgIiI7CiAgICB0aGlzLnZlcnRpY2FsID0gISFwcm9wZXJ0aWVzLnZlcnRpY2FsOwoKICAgIGlmICh0aGlzLnZlcnRpY2FsKSB7CiAgICAgIHRoaXMudm1ldHJpY3MgPSBwcm9wZXJ0aWVzLnZtZXRyaWNzOwogICAgICB0aGlzLmRlZmF1bHRWTWV0cmljcyA9IHByb3BlcnRpZXMuZGVmYXVsdFZNZXRyaWNzOwogICAgfQoKICAgIGlmICghZmlsZSB8fCBmaWxlLmlzRW1wdHkpIHsKICAgICAgaWYgKGZpbGUpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoJ0ZvbnQgZmlsZSBpcyBlbXB0eSBpbiAiJyArIG5hbWUgKyAnIiAoJyArIHRoaXMubG9hZGVkTmFtZSArICIpIik7CiAgICAgIH0KCiAgICAgIHRoaXMuZmFsbGJhY2tUb1N5c3RlbUZvbnQocHJvcGVydGllcyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBbdHlwZSwgc3VidHlwZV0gPSBnZXRGb250RmlsZVR5cGUoZmlsZSwgcHJvcGVydGllcyk7CgogICAgaWYgKHR5cGUgIT09IHRoaXMudHlwZSB8fCBzdWJ0eXBlICE9PSB0aGlzLnN1YnR5cGUpIHsKICAgICAgKDAsIF91dGlsLmluZm8pKCJJbmNvbnNpc3RlbnQgZm9udCBmaWxlIFR5cGUvU3ViVHlwZSwgZXhwZWN0ZWQ6ICIgKyBgJHt0aGlzLnR5cGV9LyR7dGhpcy5zdWJ0eXBlfSBidXQgZm91bmQ6ICR7dHlwZX0vJHtzdWJ0eXBlfS5gKTsKICAgIH0KCiAgICBsZXQgZGF0YTsKCiAgICB0cnkgewogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlICJNTVR5cGUxIjoKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiTU1UeXBlMSBmb250ICgiICsgbmFtZSArICIpLCBmYWxsaW5nIGJhY2sgdG8gVHlwZTEuIik7CgogICAgICAgIGNhc2UgIlR5cGUxIjoKICAgICAgICBjYXNlICJDSURGb250VHlwZTAiOgogICAgICAgICAgdGhpcy5taW1ldHlwZSA9ICJmb250L29wZW50eXBlIjsKICAgICAgICAgIGNvbnN0IGNmZiA9IHN1YnR5cGUgPT09ICJUeXBlMUMiIHx8IHN1YnR5cGUgPT09ICJDSURGb250VHlwZTBDIiA/IG5ldyBfY2ZmX2ZvbnQuQ0ZGRm9udChmaWxlLCBwcm9wZXJ0aWVzKSA6IG5ldyBfdHlwZTFfZm9udC5UeXBlMUZvbnQobmFtZSwgZmlsZSwgcHJvcGVydGllcyk7CiAgICAgICAgICBhZGp1c3RXaWR0aHMocHJvcGVydGllcyk7CiAgICAgICAgICBkYXRhID0gdGhpcy5jb252ZXJ0KG5hbWUsIGNmZiwgcHJvcGVydGllcyk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiT3BlblR5cGUiOgogICAgICAgIGNhc2UgIlRydWVUeXBlIjoKICAgICAgICBjYXNlICJDSURGb250VHlwZTIiOgogICAgICAgICAgdGhpcy5taW1ldHlwZSA9ICJmb250L29wZW50eXBlIjsKICAgICAgICAgIGRhdGEgPSB0aGlzLmNoZWNrQW5kUmVwYWlyKG5hbWUsIGZpbGUsIHByb3BlcnRpZXMpOwoKICAgICAgICAgIGlmICh0aGlzLmlzT3BlblR5cGUpIHsKICAgICAgICAgICAgYWRqdXN0V2lkdGhzKHByb3BlcnRpZXMpOwogICAgICAgICAgICB0eXBlID0gIk9wZW5UeXBlIjsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgRm9udCAke3R5cGV9IGlzIG5vdCBzdXBwb3J0ZWRgKTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAoMCwgX3V0aWwud2FybikoZSk7CiAgICAgIHRoaXMuZmFsbGJhY2tUb1N5c3RlbUZvbnQocHJvcGVydGllcyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBhbWVuZEZhbGxiYWNrVG9Vbmljb2RlKHByb3BlcnRpZXMpOwogICAgdGhpcy5kYXRhID0gZGF0YTsKICAgIHRoaXMuZm9udFR5cGUgPSAoMCwgX2ZvbnRzX3V0aWxzLmdldEZvbnRUeXBlKSh0eXBlLCBzdWJ0eXBlLCBwcm9wZXJ0aWVzLmlzU3RhbmRhcmRGb250KTsKICAgIHRoaXMuZm9udE1hdHJpeCA9IHByb3BlcnRpZXMuZm9udE1hdHJpeDsKICAgIHRoaXMud2lkdGhzID0gcHJvcGVydGllcy53aWR0aHM7CiAgICB0aGlzLmRlZmF1bHRXaWR0aCA9IHByb3BlcnRpZXMuZGVmYXVsdFdpZHRoOwogICAgdGhpcy50b1VuaWNvZGUgPSBwcm9wZXJ0aWVzLnRvVW5pY29kZTsKICAgIHRoaXMuc2VhY01hcCA9IHByb3BlcnRpZXMuc2VhY01hcDsKICB9CgogIGdldCByZW5kZXJlcigpIHsKICAgIGNvbnN0IHJlbmRlcmVyID0gX2ZvbnRfcmVuZGVyZXIuRm9udFJlbmRlcmVyRmFjdG9yeS5jcmVhdGUodGhpcywgX2ZvbnRzX3V0aWxzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCk7CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJyZW5kZXJlciIsIHJlbmRlcmVyKTsKICB9CgogIGV4cG9ydERhdGEoZXh0cmFQcm9wZXJ0aWVzID0gZmFsc2UpIHsKICAgIGNvbnN0IGV4cG9ydERhdGFQcm9wZXJ0aWVzID0gZXh0cmFQcm9wZXJ0aWVzID8gWy4uLkVYUE9SVF9EQVRBX1BST1BFUlRJRVMsIC4uLkVYUE9SVF9EQVRBX0VYVFJBX1BST1BFUlRJRVNdIDogRVhQT1JUX0RBVEFfUFJPUEVSVElFUzsKICAgIGNvbnN0IGRhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgbGV0IHByb3BlcnR5LCB2YWx1ZTsKCiAgICBmb3IgKHByb3BlcnR5IG9mIGV4cG9ydERhdGFQcm9wZXJ0aWVzKSB7CiAgICAgIHZhbHVlID0gdGhpc1twcm9wZXJ0eV07CgogICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGRhdGFbcHJvcGVydHldID0gdmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZGF0YTsKICB9CgogIGZhbGxiYWNrVG9TeXN0ZW1Gb250KHByb3BlcnRpZXMpIHsKICAgIHRoaXMubWlzc2luZ0ZpbGUgPSB0cnVlOwogICAgY29uc3QgbmFtZSA9IHRoaXMubmFtZTsKICAgIGNvbnN0IHR5cGUgPSB0aGlzLnR5cGU7CiAgICBjb25zdCBzdWJ0eXBlID0gdGhpcy5zdWJ0eXBlOwogICAgbGV0IGZvbnROYW1lID0gKDAsIF9mb250c191dGlscy5ub3JtYWxpemVGb250TmFtZSkobmFtZSk7CiAgICBjb25zdCBzdGRGb250TWFwID0gKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTdGRGb250TWFwKSgpLAogICAgICAgICAgbm9uU3RkRm9udE1hcCA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0Tm9uU3RkRm9udE1hcCkoKTsKICAgIGNvbnN0IGlzU3RhbmRhcmRGb250ID0gISFzdGRGb250TWFwW2ZvbnROYW1lXTsKICAgIGNvbnN0IGlzTWFwcGVkVG9TdGFuZGFyZEZvbnQgPSAhIShub25TdGRGb250TWFwW2ZvbnROYW1lXSAmJiBzdGRGb250TWFwW25vblN0ZEZvbnRNYXBbZm9udE5hbWVdXSk7CiAgICBmb250TmFtZSA9IHN0ZEZvbnRNYXBbZm9udE5hbWVdIHx8IG5vblN0ZEZvbnRNYXBbZm9udE5hbWVdIHx8IGZvbnROYW1lOwogICAgY29uc3QgZm9udEJhc2ljTWV0cmljc01hcCA9ICgwLCBfbWV0cmljcy5nZXRGb250QmFzaWNNZXRyaWNzKSgpOwogICAgY29uc3QgbWV0cmljcyA9IGZvbnRCYXNpY01ldHJpY3NNYXBbZm9udE5hbWVdOwoKICAgIGlmIChtZXRyaWNzKSB7CiAgICAgIGlmIChpc05hTih0aGlzLmFzY2VudCkpIHsKICAgICAgICB0aGlzLmFzY2VudCA9IG1ldHJpY3MuYXNjZW50IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgICB9CgogICAgICBpZiAoaXNOYU4odGhpcy5kZXNjZW50KSkgewogICAgICAgIHRoaXMuZGVzY2VudCA9IG1ldHJpY3MuZGVzY2VudCAvIFBERl9HTFlQSF9TUEFDRV9VTklUUzsKICAgICAgfQoKICAgICAgaWYgKGlzTmFOKHRoaXMuY2FwSGVpZ2h0KSkgewogICAgICAgIHRoaXMuY2FwSGVpZ2h0ID0gbWV0cmljcy5jYXBIZWlnaHQgLyBQREZfR0xZUEhfU1BBQ0VfVU5JVFM7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmJvbGQgPSBmb250TmFtZS5zZWFyY2goL2JvbGQvZ2kpICE9PSAtMTsKICAgIHRoaXMuaXRhbGljID0gZm9udE5hbWUuc2VhcmNoKC9vYmxpcXVlL2dpKSAhPT0gLTEgfHwgZm9udE5hbWUuc2VhcmNoKC9pdGFsaWMvZ2kpICE9PSAtMTsKICAgIHRoaXMuYmxhY2sgPSBuYW1lLnNlYXJjaCgvQmxhY2svZykgIT09IC0xOwogICAgY29uc3QgaXNOYXJyb3cgPSBuYW1lLnNlYXJjaCgvTmFycm93L2cpICE9PSAtMTsKICAgIHRoaXMucmVtZWFzdXJlID0gKCFpc1N0YW5kYXJkRm9udCB8fCBpc05hcnJvdykgJiYgT2JqZWN0LmtleXModGhpcy53aWR0aHMpLmxlbmd0aCA+IDA7CgogICAgaWYgKChpc1N0YW5kYXJkRm9udCB8fCBpc01hcHBlZFRvU3RhbmRhcmRGb250KSAmJiB0eXBlID09PSAiQ0lERm9udFR5cGUyIiAmJiB0aGlzLmNpZEVuY29kaW5nLnN0YXJ0c1dpdGgoIklkZW50aXR5LSIpKSB7CiAgICAgIGNvbnN0IGNpZFRvR2lkTWFwID0gcHJvcGVydGllcy5jaWRUb0dpZE1hcDsKICAgICAgY29uc3QgbWFwID0gW107CiAgICAgIGFwcGx5U3RhbmRhcmRGb250R2x5cGhNYXAobWFwLCAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cykoKSk7CgogICAgICBpZiAoL0FyaWFsLT9CbGFjay9pLnRlc3QobmFtZSkpIHsKICAgICAgICBhcHBseVN0YW5kYXJkRm9udEdseXBoTWFwKG1hcCwgKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2spKCkpOwogICAgICB9IGVsc2UgaWYgKC9DYWxpYnJpL2kudGVzdChuYW1lKSkgewogICAgICAgIGFwcGx5U3RhbmRhcmRGb250R2x5cGhNYXAobWFwLCAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaSkoKSk7CiAgICAgIH0KCiAgICAgIGlmIChjaWRUb0dpZE1hcCkgewogICAgICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gbWFwKSB7CiAgICAgICAgICBjb25zdCBjaWQgPSBtYXBbY2hhckNvZGVdOwoKICAgICAgICAgIGlmIChjaWRUb0dpZE1hcFtjaWRdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgbWFwWytjaGFyQ29kZV0gPSBjaWRUb0dpZE1hcFtjaWRdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNpZFRvR2lkTWFwLmxlbmd0aCAhPT0gdGhpcy50b1VuaWNvZGUubGVuZ3RoICYmIHByb3BlcnRpZXMuaGFzSW5jbHVkZWRUb1VuaWNvZGVNYXAgJiYgdGhpcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgICAgICAgIHRoaXMudG9Vbmljb2RlLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB1bmljb2RlQ2hhckNvZGUpIHsKICAgICAgICAgICAgY29uc3QgY2lkID0gbWFwW2NoYXJDb2RlXTsKCiAgICAgICAgICAgIGlmIChjaWRUb0dpZE1hcFtjaWRdID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBtYXBbK2NoYXJDb2RlXSA9IHVuaWNvZGVDaGFyQ29kZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoISh0aGlzLnRvVW5pY29kZSBpbnN0YW5jZW9mIF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCkpIHsKICAgICAgICB0aGlzLnRvVW5pY29kZS5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyQ29kZSwgdW5pY29kZUNoYXJDb2RlKSB7CiAgICAgICAgICBtYXBbK2NoYXJDb2RlXSA9IHVuaWNvZGVDaGFyQ29kZTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gbWFwOwogICAgICB0aGlzLnRvVW5pY29kZSA9IG5ldyBfdG9fdW5pY29kZV9tYXAuVG9Vbmljb2RlTWFwKG1hcCk7CiAgICB9IGVsc2UgaWYgKC9TeW1ib2wvaS50ZXN0KGZvbnROYW1lKSkgewogICAgICB0aGlzLnRvRm9udENoYXIgPSBidWlsZFRvRm9udENoYXIoX2VuY29kaW5ncy5TeW1ib2xTZXRFbmNvZGluZywgKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKSwgdGhpcy5kaWZmZXJlbmNlcyk7CiAgICB9IGVsc2UgaWYgKC9EaW5nYmF0cy9pLnRlc3QoZm9udE5hbWUpKSB7CiAgICAgIGlmICgvV2luZ2RpbmdzL2kudGVzdChuYW1lKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm9uLWVtYmVkZGVkIFdpbmdkaW5ncyBmb250LCBmYWxsaW5nIGJhY2sgdG8gWmFwZkRpbmdiYXRzLiIpOwogICAgICB9CgogICAgICB0aGlzLnRvRm9udENoYXIgPSBidWlsZFRvRm9udENoYXIoX2VuY29kaW5ncy5aYXBmRGluZ2JhdHNFbmNvZGluZywgKDAsIF9nbHlwaGxpc3QuZ2V0RGluZ2JhdHNHbHlwaHNVbmljb2RlKSgpLCB0aGlzLmRpZmZlcmVuY2VzKTsKICAgIH0gZWxzZSBpZiAoaXNTdGFuZGFyZEZvbnQpIHsKICAgICAgY29uc3QgbWFwID0gYnVpbGRUb0ZvbnRDaGFyKHRoaXMuZGVmYXVsdEVuY29kaW5nLCAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpLCB0aGlzLmRpZmZlcmVuY2VzKTsKCiAgICAgIGlmICh0eXBlID09PSAiQ0lERm9udFR5cGUyIiAmJiAhdGhpcy5jaWRFbmNvZGluZy5zdGFydHNXaXRoKCJJZGVudGl0eS0iKSAmJiAhKHRoaXMudG9Vbmljb2RlIGluc3RhbmNlb2YgX3RvX3VuaWNvZGVfbWFwLklkZW50aXR5VG9Vbmljb2RlTWFwKSkgewogICAgICAgIHRoaXMudG9Vbmljb2RlLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB1bmljb2RlQ2hhckNvZGUpIHsKICAgICAgICAgIG1hcFsrY2hhckNvZGVdID0gdW5pY29kZUNoYXJDb2RlOwogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLnRvRm9udENoYXIgPSBtYXA7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKICAgICAgY29uc3QgbWFwID0gW107CiAgICAgIHRoaXMudG9Vbmljb2RlLmZvckVhY2goKGNoYXJDb2RlLCB1bmljb2RlQ2hhckNvZGUpID0+IHsKICAgICAgICBpZiAoIXRoaXMuY29tcG9zaXRlKSB7CiAgICAgICAgICBjb25zdCBnbHlwaE5hbWUgPSB0aGlzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXSB8fCB0aGlzLmRlZmF1bHRFbmNvZGluZ1tjaGFyQ29kZV07CiAgICAgICAgICBjb25zdCB1bmljb2RlID0gKDAsIF91bmljb2RlLmdldFVuaWNvZGVGb3JHbHlwaCkoZ2x5cGhOYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgICAgICAgICBpZiAodW5pY29kZSAhPT0gLTEpIHsKICAgICAgICAgICAgdW5pY29kZUNoYXJDb2RlID0gdW5pY29kZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG1hcFsrY2hhckNvZGVdID0gdW5pY29kZUNoYXJDb2RlOwogICAgICB9KTsKCiAgICAgIGlmICh0aGlzLmNvbXBvc2l0ZSAmJiB0aGlzLnRvVW5pY29kZSBpbnN0YW5jZW9mIF90b191bmljb2RlX21hcC5JZGVudGl0eVRvVW5pY29kZU1hcCkgewogICAgICAgIGlmICgvVmVyZGFuYS9pLnRlc3QobmFtZSkpIHsKICAgICAgICAgIGFwcGx5U3RhbmRhcmRGb250R2x5cGhNYXAobWFwLCAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cykoKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnRvRm9udENoYXIgPSBtYXA7CiAgICB9CgogICAgYW1lbmRGYWxsYmFja1RvVW5pY29kZShwcm9wZXJ0aWVzKTsKICAgIHRoaXMubG9hZGVkTmFtZSA9IGZvbnROYW1lLnNwbGl0KCItIilbMF07CiAgICB0aGlzLmZvbnRUeXBlID0gKDAsIF9mb250c191dGlscy5nZXRGb250VHlwZSkodHlwZSwgc3VidHlwZSwgcHJvcGVydGllcy5pc1N0YW5kYXJkRm9udCk7CiAgfQoKICBjaGVja0FuZFJlcGFpcihuYW1lLCBmb250LCBwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCBWQUxJRF9UQUJMRVMgPSBbIk9TLzIiLCAiY21hcCIsICJoZWFkIiwgImhoZWEiLCAiaG10eCIsICJtYXhwIiwgIm5hbWUiLCAicG9zdCIsICJsb2NhIiwgImdseWYiLCAiZnBnbSIsICJwcmVwIiwgImN2dCAiLCAiQ0ZGICJdOwoKICAgIGZ1bmN0aW9uIHJlYWRUYWJsZXMoZmlsZSwgbnVtVGFibGVzKSB7CiAgICAgIGNvbnN0IHRhYmxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIHRhYmxlc1siT1MvMiJdID0gbnVsbDsKICAgICAgdGFibGVzLmNtYXAgPSBudWxsOwogICAgICB0YWJsZXMuaGVhZCA9IG51bGw7CiAgICAgIHRhYmxlcy5oaGVhID0gbnVsbDsKICAgICAgdGFibGVzLmhtdHggPSBudWxsOwogICAgICB0YWJsZXMubWF4cCA9IG51bGw7CiAgICAgIHRhYmxlcy5uYW1lID0gbnVsbDsKICAgICAgdGFibGVzLnBvc3QgPSBudWxsOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1UYWJsZXM7IGkrKykgewogICAgICAgIGNvbnN0IHRhYmxlID0gcmVhZFRhYmxlRW50cnkoZmlsZSk7CgogICAgICAgIGlmICghVkFMSURfVEFCTEVTLmluY2x1ZGVzKHRhYmxlLnRhZykpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRhYmxlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0YWJsZXNbdGFibGUudGFnXSA9IHRhYmxlOwogICAgICB9CgogICAgICByZXR1cm4gdGFibGVzOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRUYWJsZUVudHJ5KGZpbGUpIHsKICAgICAgY29uc3QgdGFnID0gZmlsZS5nZXRTdHJpbmcoNCk7CiAgICAgIGNvbnN0IGNoZWNrc3VtID0gZmlsZS5nZXRJbnQzMigpID4+PiAwOwogICAgICBjb25zdCBvZmZzZXQgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgY29uc3QgcHJldmlvdXNQb3NpdGlvbiA9IGZpbGUucG9zOwogICAgICBmaWxlLnBvcyA9IGZpbGUuc3RhcnQgfHwgMDsKICAgICAgZmlsZS5za2lwKG9mZnNldCk7CiAgICAgIGNvbnN0IGRhdGEgPSBmaWxlLmdldEJ5dGVzKGxlbmd0aCk7CiAgICAgIGZpbGUucG9zID0gcHJldmlvdXNQb3NpdGlvbjsKCiAgICAgIGlmICh0YWcgPT09ICJoZWFkIikgewogICAgICAgIGRhdGFbOF0gPSBkYXRhWzldID0gZGF0YVsxMF0gPSBkYXRhWzExXSA9IDA7CiAgICAgICAgZGF0YVsxN10gfD0gMHgyMDsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICB0YWcsCiAgICAgICAgY2hlY2tzdW0sCiAgICAgICAgbGVuZ3RoLAogICAgICAgIG9mZnNldCwKICAgICAgICBkYXRhCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gcmVhZE9wZW5UeXBlSGVhZGVyKHR0ZikgewogICAgICByZXR1cm4gewogICAgICAgIHZlcnNpb246IHR0Zi5nZXRTdHJpbmcoNCksCiAgICAgICAgbnVtVGFibGVzOiB0dGYuZ2V0VWludDE2KCksCiAgICAgICAgc2VhcmNoUmFuZ2U6IHR0Zi5nZXRVaW50MTYoKSwKICAgICAgICBlbnRyeVNlbGVjdG9yOiB0dGYuZ2V0VWludDE2KCksCiAgICAgICAgcmFuZ2VTaGlmdDogdHRmLmdldFVpbnQxNigpCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gcmVhZFRydWVUeXBlQ29sbGVjdGlvbkhlYWRlcih0dGMpIHsKICAgICAgY29uc3QgdHRjVGFnID0gdHRjLmdldFN0cmluZyg0KTsKICAgICAgKDAsIF91dGlsLmFzc2VydCkodHRjVGFnID09PSAidHRjZiIsICJNdXN0IGJlIGEgVHJ1ZVR5cGUgQ29sbGVjdGlvbiBmb250LiIpOwogICAgICBjb25zdCBtYWpvclZlcnNpb24gPSB0dGMuZ2V0VWludDE2KCk7CiAgICAgIGNvbnN0IG1pbm9yVmVyc2lvbiA9IHR0Yy5nZXRVaW50MTYoKTsKICAgICAgY29uc3QgbnVtRm9udHMgPSB0dGMuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgY29uc3Qgb2Zmc2V0VGFibGUgPSBbXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtRm9udHM7IGkrKykgewogICAgICAgIG9mZnNldFRhYmxlLnB1c2godHRjLmdldEludDMyKCkgPj4+IDApOwogICAgICB9CgogICAgICBjb25zdCBoZWFkZXIgPSB7CiAgICAgICAgdHRjVGFnLAogICAgICAgIG1ham9yVmVyc2lvbiwKICAgICAgICBtaW5vclZlcnNpb24sCiAgICAgICAgbnVtRm9udHMsCiAgICAgICAgb2Zmc2V0VGFibGUKICAgICAgfTsKCiAgICAgIHN3aXRjaCAobWFqb3JWZXJzaW9uKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuIGhlYWRlcjsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaGVhZGVyLmRzaWdUYWcgPSB0dGMuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICAgIGhlYWRlci5kc2lnTGVuZ3RoID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICBoZWFkZXIuZHNpZ09mZnNldCA9IHR0Yy5nZXRJbnQzMigpID4+PiAwOwogICAgICAgICAgcmV0dXJuIGhlYWRlcjsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIFRydWVUeXBlIENvbGxlY3Rpb24gbWFqb3JWZXJzaW9uOiAke21ham9yVmVyc2lvbn0uYCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVhZFRydWVUeXBlQ29sbGVjdGlvbkRhdGEodHRjLCBmb250TmFtZSkgewogICAgICBjb25zdCB7CiAgICAgICAgbnVtRm9udHMsCiAgICAgICAgb2Zmc2V0VGFibGUKICAgICAgfSA9IHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25IZWFkZXIodHRjKTsKICAgICAgY29uc3QgZm9udE5hbWVQYXJ0cyA9IGZvbnROYW1lLnNwbGl0KCIrIik7CiAgICAgIGxldCBmYWxsYmFja0RhdGE7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUZvbnRzOyBpKyspIHsKICAgICAgICB0dGMucG9zID0gKHR0Yy5zdGFydCB8fCAwKSArIG9mZnNldFRhYmxlW2ldOwogICAgICAgIGNvbnN0IHBvdGVudGlhbEhlYWRlciA9IHJlYWRPcGVuVHlwZUhlYWRlcih0dGMpOwogICAgICAgIGNvbnN0IHBvdGVudGlhbFRhYmxlcyA9IHJlYWRUYWJsZXModHRjLCBwb3RlbnRpYWxIZWFkZXIubnVtVGFibGVzKTsKCiAgICAgICAgaWYgKCFwb3RlbnRpYWxUYWJsZXMubmFtZSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdUcnVlVHlwZSBDb2xsZWN0aW9uIGZvbnQgbXVzdCBjb250YWluIGEgIm5hbWUiIHRhYmxlLicpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbmFtZVRhYmxlID0gcmVhZE5hbWVUYWJsZShwb3RlbnRpYWxUYWJsZXMubmFtZSk7CgogICAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IG5hbWVUYWJsZS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICBmb3IgKGxldCBrID0gMCwga2sgPSBuYW1lVGFibGVbal0ubGVuZ3RoOyBrIDwga2s7IGsrKykgewogICAgICAgICAgICBjb25zdCBuYW1lRW50cnkgPSBuYW1lVGFibGVbal1ba10gJiYgbmFtZVRhYmxlW2pdW2tdLnJlcGxhY2UoL1xzL2csICIiKTsKCiAgICAgICAgICAgIGlmICghbmFtZUVudHJ5KSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChuYW1lRW50cnkgPT09IGZvbnROYW1lKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGhlYWRlcjogcG90ZW50aWFsSGVhZGVyLAogICAgICAgICAgICAgICAgdGFibGVzOiBwb3RlbnRpYWxUYWJsZXMKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZm9udE5hbWVQYXJ0cy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBmb250TmFtZVBhcnRzKSB7CiAgICAgICAgICAgICAgaWYgKG5hbWVFbnRyeSA9PT0gcGFydCkgewogICAgICAgICAgICAgICAgZmFsbGJhY2tEYXRhID0gewogICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LAogICAgICAgICAgICAgICAgICBoZWFkZXI6IHBvdGVudGlhbEhlYWRlciwKICAgICAgICAgICAgICAgICAgdGFibGVzOiBwb3RlbnRpYWxUYWJsZXMKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZmFsbGJhY2tEYXRhKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBUcnVlVHlwZSBDb2xsZWN0aW9uIGRvZXMgbm90IGNvbnRhaW4gIiR7Zm9udE5hbWV9IiBmb250LCBgICsgYGZhbGxpbmcgYmFjayB0byAiJHtmYWxsYmFja0RhdGEubmFtZX0iIGZvbnQgaW5zdGVhZC5gKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaGVhZGVyOiBmYWxsYmFja0RhdGEuaGVhZGVyLAogICAgICAgICAgdGFibGVzOiBmYWxsYmFja0RhdGEudGFibGVzCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBUcnVlVHlwZSBDb2xsZWN0aW9uIGRvZXMgbm90IGNvbnRhaW4gIiR7Zm9udE5hbWV9IiBmb250LmApOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRDbWFwVGFibGUoY21hcCwgZmlsZSwgaXNTeW1ib2xpY0ZvbnQsIGhhc0VuY29kaW5nKSB7CiAgICAgIGlmICghY21hcCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm8gY21hcCB0YWJsZSBhdmFpbGFibGUuIik7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBsYXRmb3JtSWQ6IC0xLAogICAgICAgICAgZW5jb2RpbmdJZDogLTEsCiAgICAgICAgICBtYXBwaW5nczogW10sCiAgICAgICAgICBoYXNTaG9ydENtYXA6IGZhbHNlCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgbGV0IHNlZ21lbnQ7CiAgICAgIGxldCBzdGFydCA9IChmaWxlLnN0YXJ0IHx8IDApICsgY21hcC5vZmZzZXQ7CiAgICAgIGZpbGUucG9zID0gc3RhcnQ7CiAgICAgIGZpbGUuc2tpcCgyKTsKICAgICAgY29uc3QgbnVtVGFibGVzID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgbGV0IHBvdGVudGlhbFRhYmxlOwogICAgICBsZXQgY2FuQnJlYWsgPSBmYWxzZTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgICBjb25zdCBwbGF0Zm9ybUlkID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICBjb25zdCBlbmNvZGluZ0lkID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICBjb25zdCBvZmZzZXQgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgbGV0IHVzZVRhYmxlID0gZmFsc2U7CgogICAgICAgIGlmIChwb3RlbnRpYWxUYWJsZSAmJiBwb3RlbnRpYWxUYWJsZS5wbGF0Zm9ybUlkID09PSBwbGF0Zm9ybUlkICYmIHBvdGVudGlhbFRhYmxlLmVuY29kaW5nSWQgPT09IGVuY29kaW5nSWQpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBsYXRmb3JtSWQgPT09IDAgJiYgKGVuY29kaW5nSWQgPT09IDAgfHwgZW5jb2RpbmdJZCA9PT0gMSB8fCBlbmNvZGluZ0lkID09PSAzKSkgewogICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAocGxhdGZvcm1JZCA9PT0gMSAmJiBlbmNvZGluZ0lkID09PSAwKSB7CiAgICAgICAgICB1c2VUYWJsZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChwbGF0Zm9ybUlkID09PSAzICYmIGVuY29kaW5nSWQgPT09IDEgJiYgKGhhc0VuY29kaW5nIHx8ICFwb3RlbnRpYWxUYWJsZSkpIHsKICAgICAgICAgIHVzZVRhYmxlID0gdHJ1ZTsKCiAgICAgICAgICBpZiAoIWlzU3ltYm9saWNGb250KSB7CiAgICAgICAgICAgIGNhbkJyZWFrID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGlzU3ltYm9saWNGb250ICYmIHBsYXRmb3JtSWQgPT09IDMgJiYgZW5jb2RpbmdJZCA9PT0gMCkgewogICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgICAgbGV0IGNvcnJlY3RseVNvcnRlZCA9IHRydWU7CgogICAgICAgICAgaWYgKGkgPCBudW1UYWJsZXMgLSAxKSB7CiAgICAgICAgICAgIGNvbnN0IG5leHRCeXRlcyA9IGZpbGUucGVla0J5dGVzKDIpLAogICAgICAgICAgICAgICAgICBuZXh0UGxhdGZvcm1JZCA9IGludDE2KG5leHRCeXRlc1swXSwgbmV4dEJ5dGVzWzFdKTsKCiAgICAgICAgICAgIGlmIChuZXh0UGxhdGZvcm1JZCA8IHBsYXRmb3JtSWQpIHsKICAgICAgICAgICAgICBjb3JyZWN0bHlTb3J0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjb3JyZWN0bHlTb3J0ZWQpIHsKICAgICAgICAgICAgY2FuQnJlYWsgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHVzZVRhYmxlKSB7CiAgICAgICAgICBwb3RlbnRpYWxUYWJsZSA9IHsKICAgICAgICAgICAgcGxhdGZvcm1JZCwKICAgICAgICAgICAgZW5jb2RpbmdJZCwKICAgICAgICAgICAgb2Zmc2V0CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKGNhbkJyZWFrKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwb3RlbnRpYWxUYWJsZSkgewogICAgICAgIGZpbGUucG9zID0gc3RhcnQgKyBwb3RlbnRpYWxUYWJsZS5vZmZzZXQ7CiAgICAgIH0KCiAgICAgIGlmICghcG90ZW50aWFsVGFibGUgfHwgZmlsZS5wZWVrQnl0ZSgpID09PSAtMSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiQ291bGQgbm90IGZpbmQgYSBwcmVmZXJyZWQgY21hcCB0YWJsZS4iKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgcGxhdGZvcm1JZDogLTEsCiAgICAgICAgICBlbmNvZGluZ0lkOiAtMSwKICAgICAgICAgIG1hcHBpbmdzOiBbXSwKICAgICAgICAgIGhhc1Nob3J0Q21hcDogZmFsc2UKICAgICAgICB9OwogICAgICB9CgogICAgICBjb25zdCBmb3JtYXQgPSBmaWxlLmdldFVpbnQxNigpOwogICAgICBsZXQgaGFzU2hvcnRDbWFwID0gZmFsc2U7CiAgICAgIGNvbnN0IG1hcHBpbmdzID0gW107CiAgICAgIGxldCBqLCBnbHlwaElkOwoKICAgICAgaWYgKGZvcm1hdCA9PT0gMCkgewogICAgICAgIGZpbGUuc2tpcCgyICsgMik7CgogICAgICAgIGZvciAoaiA9IDA7IGogPCAyNTY7IGorKykgewogICAgICAgICAgY29uc3QgaW5kZXggPSBmaWxlLmdldEJ5dGUoKTsKCiAgICAgICAgICBpZiAoIWluZGV4KSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIG1hcHBpbmdzLnB1c2goewogICAgICAgICAgICBjaGFyQ29kZTogaiwKICAgICAgICAgICAgZ2x5cGhJZDogaW5kZXgKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaGFzU2hvcnRDbWFwID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IDIpIHsKICAgICAgICBmaWxlLnNraXAoMiArIDIpOwogICAgICAgIGNvbnN0IHN1YkhlYWRlcktleXMgPSBbXTsKICAgICAgICBsZXQgbWF4U3ViSGVhZGVyS2V5ID0gMDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICAgICAgY29uc3Qgc3ViSGVhZGVyS2V5ID0gZmlsZS5nZXRVaW50MTYoKSA+PiAzOwogICAgICAgICAgc3ViSGVhZGVyS2V5cy5wdXNoKHN1YkhlYWRlcktleSk7CiAgICAgICAgICBtYXhTdWJIZWFkZXJLZXkgPSBNYXRoLm1heChzdWJIZWFkZXJLZXksIG1heFN1YkhlYWRlcktleSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdWJIZWFkZXJzID0gW107CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IG1heFN1YkhlYWRlcktleTsgaSsrKSB7CiAgICAgICAgICBzdWJIZWFkZXJzLnB1c2goewogICAgICAgICAgICBmaXJzdENvZGU6IGZpbGUuZ2V0VWludDE2KCksCiAgICAgICAgICAgIGVudHJ5Q291bnQ6IGZpbGUuZ2V0VWludDE2KCksCiAgICAgICAgICAgIGlkRGVsdGE6IHNpZ25lZEludDE2KGZpbGUuZ2V0Qnl0ZSgpLCBmaWxlLmdldEJ5dGUoKSksCiAgICAgICAgICAgIGlkUmFuZ2VQb3M6IGZpbGUucG9zICsgZmlsZS5nZXRVaW50MTYoKQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgaSsrKSB7CiAgICAgICAgICBpZiAoc3ViSGVhZGVyS2V5c1tpXSA9PT0gMCkgewogICAgICAgICAgICBmaWxlLnBvcyA9IHN1YkhlYWRlcnNbMF0uaWRSYW5nZVBvcyArIDIgKiBpOwogICAgICAgICAgICBnbHlwaElkID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICAgICAgbWFwcGluZ3MucHVzaCh7CiAgICAgICAgICAgICAgY2hhckNvZGU6IGksCiAgICAgICAgICAgICAgZ2x5cGhJZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHMgPSBzdWJIZWFkZXJzW3N1YkhlYWRlcktleXNbaV1dOwoKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHMuZW50cnlDb3VudDsgaisrKSB7CiAgICAgICAgICAgICAgY29uc3QgY2hhckNvZGUgPSAoaSA8PCA4KSArIGogKyBzLmZpcnN0Q29kZTsKICAgICAgICAgICAgICBmaWxlLnBvcyA9IHMuaWRSYW5nZVBvcyArIDIgKiBqOwogICAgICAgICAgICAgIGdseXBoSWQgPSBmaWxlLmdldFVpbnQxNigpOwoKICAgICAgICAgICAgICBpZiAoZ2x5cGhJZCAhPT0gMCkgewogICAgICAgICAgICAgICAgZ2x5cGhJZCA9IChnbHlwaElkICsgcy5pZERlbHRhKSAlIDY1NTM2OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbWFwcGluZ3MucHVzaCh7CiAgICAgICAgICAgICAgICBjaGFyQ29kZSwKICAgICAgICAgICAgICAgIGdseXBoSWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IDQpIHsKICAgICAgICBmaWxlLnNraXAoMiArIDIpOwogICAgICAgIGNvbnN0IHNlZ0NvdW50ID0gZmlsZS5nZXRVaW50MTYoKSA+PiAxOwogICAgICAgIGZpbGUuc2tpcCg2KTsKICAgICAgICBjb25zdCBzZWdtZW50cyA9IFtdOwogICAgICAgIGxldCBzZWdJbmRleDsKCiAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgIHNlZ21lbnRzLnB1c2goewogICAgICAgICAgICBlbmQ6IGZpbGUuZ2V0VWludDE2KCkKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZmlsZS5za2lwKDIpOwoKICAgICAgICBmb3IgKHNlZ0luZGV4ID0gMDsgc2VnSW5kZXggPCBzZWdDb3VudDsgc2VnSW5kZXgrKykgewogICAgICAgICAgc2VnbWVudHNbc2VnSW5kZXhdLnN0YXJ0ID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICB9CgogICAgICAgIGZvciAoc2VnSW5kZXggPSAwOyBzZWdJbmRleCA8IHNlZ0NvdW50OyBzZWdJbmRleCsrKSB7CiAgICAgICAgICBzZWdtZW50c1tzZWdJbmRleF0uZGVsdGEgPSBmaWxlLmdldFVpbnQxNigpOwogICAgICAgIH0KCiAgICAgICAgbGV0IG9mZnNldHNDb3VudCA9IDAsCiAgICAgICAgICAgIG9mZnNldEluZGV4OwoKICAgICAgICBmb3IgKHNlZ0luZGV4ID0gMDsgc2VnSW5kZXggPCBzZWdDb3VudDsgc2VnSW5kZXgrKykgewogICAgICAgICAgc2VnbWVudCA9IHNlZ21lbnRzW3NlZ0luZGV4XTsKICAgICAgICAgIGNvbnN0IHJhbmdlT2Zmc2V0ID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICAgICAgICBpZiAoIXJhbmdlT2Zmc2V0KSB7CiAgICAgICAgICAgIHNlZ21lbnQub2Zmc2V0SW5kZXggPSAtMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0SW5kZXggPSAocmFuZ2VPZmZzZXQgPj4gMSkgLSAoc2VnQ291bnQgLSBzZWdJbmRleCk7CiAgICAgICAgICBzZWdtZW50Lm9mZnNldEluZGV4ID0gb2Zmc2V0SW5kZXg7CiAgICAgICAgICBvZmZzZXRzQ291bnQgPSBNYXRoLm1heChvZmZzZXRzQ291bnQsIG9mZnNldEluZGV4ICsgc2VnbWVudC5lbmQgLSBzZWdtZW50LnN0YXJ0ICsgMSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBvZmZzZXRzID0gW107CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBvZmZzZXRzQ291bnQ7IGorKykgewogICAgICAgICAgb2Zmc2V0cy5wdXNoKGZpbGUuZ2V0VWludDE2KCkpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgIHNlZ21lbnQgPSBzZWdtZW50c1tzZWdJbmRleF07CiAgICAgICAgICBzdGFydCA9IHNlZ21lbnQuc3RhcnQ7CiAgICAgICAgICBjb25zdCBlbmQgPSBzZWdtZW50LmVuZDsKICAgICAgICAgIGNvbnN0IGRlbHRhID0gc2VnbWVudC5kZWx0YTsKICAgICAgICAgIG9mZnNldEluZGV4ID0gc2VnbWVudC5vZmZzZXRJbmRleDsKCiAgICAgICAgICBmb3IgKGogPSBzdGFydDsgaiA8PSBlbmQ7IGorKykgewogICAgICAgICAgICBpZiAoaiA9PT0gMHhmZmZmKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdseXBoSWQgPSBvZmZzZXRJbmRleCA8IDAgPyBqIDogb2Zmc2V0c1tvZmZzZXRJbmRleCArIGogLSBzdGFydF07CiAgICAgICAgICAgIGdseXBoSWQgPSBnbHlwaElkICsgZGVsdGEgJiAweGZmZmY7CiAgICAgICAgICAgIG1hcHBpbmdzLnB1c2goewogICAgICAgICAgICAgIGNoYXJDb2RlOiBqLAogICAgICAgICAgICAgIGdseXBoSWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gNikgewogICAgICAgIGZpbGUuc2tpcCgyICsgMik7CiAgICAgICAgY29uc3QgZmlyc3RDb2RlID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICBjb25zdCBlbnRyeUNvdW50ID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICAgICAgZm9yIChqID0gMDsgaiA8IGVudHJ5Q291bnQ7IGorKykgewogICAgICAgICAgZ2x5cGhJZCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgICBjb25zdCBjaGFyQ29kZSA9IGZpcnN0Q29kZSArIGo7CiAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgY2hhckNvZGUsCiAgICAgICAgICAgIGdseXBoSWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IDEyKSB7CiAgICAgICAgZmlsZS5za2lwKDIgKyA0ICsgNCk7CiAgICAgICAgY29uc3Qgbkdyb3VwcyA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKCiAgICAgICAgZm9yIChqID0gMDsgaiA8IG5Hcm91cHM7IGorKykgewogICAgICAgICAgY29uc3Qgc3RhcnRDaGFyQ29kZSA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICAgIGNvbnN0IGVuZENoYXJDb2RlID0gZmlsZS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgICAgbGV0IGdseXBoQ29kZSA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKCiAgICAgICAgICBmb3IgKGxldCBjaGFyQ29kZSA9IHN0YXJ0Q2hhckNvZGU7IGNoYXJDb2RlIDw9IGVuZENoYXJDb2RlOyBjaGFyQ29kZSsrKSB7CiAgICAgICAgICAgIG1hcHBpbmdzLnB1c2goewogICAgICAgICAgICAgIGNoYXJDb2RlLAogICAgICAgICAgICAgIGdseXBoSWQ6IGdseXBoQ29kZSsrCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoImNtYXAgdGFibGUgaGFzIHVuc3VwcG9ydGVkIGZvcm1hdDogIiArIGZvcm1hdCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBsYXRmb3JtSWQ6IC0xLAogICAgICAgICAgZW5jb2RpbmdJZDogLTEsCiAgICAgICAgICBtYXBwaW5nczogW10sCiAgICAgICAgICBoYXNTaG9ydENtYXA6IGZhbHNlCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgbWFwcGluZ3Muc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgIHJldHVybiBhLmNoYXJDb2RlIC0gYi5jaGFyQ29kZTsKICAgICAgfSk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IG1hcHBpbmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG1hcHBpbmdzW2kgLSAxXS5jaGFyQ29kZSA9PT0gbWFwcGluZ3NbaV0uY2hhckNvZGUpIHsKICAgICAgICAgIG1hcHBpbmdzLnNwbGljZShpLCAxKTsKICAgICAgICAgIGktLTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgcGxhdGZvcm1JZDogcG90ZW50aWFsVGFibGUucGxhdGZvcm1JZCwKICAgICAgICBlbmNvZGluZ0lkOiBwb3RlbnRpYWxUYWJsZS5lbmNvZGluZ0lkLAogICAgICAgIG1hcHBpbmdzLAogICAgICAgIGhhc1Nob3J0Q21hcAogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIHNhbml0aXplTWV0cmljcyhmaWxlLCBoZWFkZXIsIG1ldHJpY3MsIGhlYWRUYWJsZSwgbnVtR2x5cGhzLCBkdXBGaXJzdEVudHJ5KSB7CiAgICAgIGlmICghaGVhZGVyKSB7CiAgICAgICAgaWYgKG1ldHJpY3MpIHsKICAgICAgICAgIG1ldHJpY3MuZGF0YSA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGZpbGUucG9zID0gKGZpbGUuc3RhcnQgfHwgMCkgKyBoZWFkZXIub2Zmc2V0OwogICAgICBmaWxlLnBvcyArPSA0OwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBmaWxlLnBvcyArPSAyOwogICAgICBjb25zdCBjYXJldE9mZnNldCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgIGZpbGUucG9zICs9IDg7CiAgICAgIGZpbGUucG9zICs9IDI7CiAgICAgIGxldCBudW1PZk1ldHJpY3MgPSBmaWxlLmdldFVpbnQxNigpOwoKICAgICAgaWYgKGNhcmV0T2Zmc2V0ICE9PSAwKSB7CiAgICAgICAgY29uc3QgbWFjU3R5bGUgPSBpbnQxNihoZWFkVGFibGUuZGF0YVs0NF0sIGhlYWRUYWJsZS5kYXRhWzQ1XSk7CgogICAgICAgIGlmICghKG1hY1N0eWxlICYgMikpIHsKICAgICAgICAgIGhlYWRlci5kYXRhWzIyXSA9IDA7CiAgICAgICAgICBoZWFkZXIuZGF0YVsyM10gPSAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG51bU9mTWV0cmljcyA+IG51bUdseXBocykgewogICAgICAgICgwLCBfdXRpbC5pbmZvKShgVGhlIG51bU9mTWV0cmljcyAoJHtudW1PZk1ldHJpY3N9KSBzaG91bGQgbm90IGJlIGAgKyBgZ3JlYXRlciB0aGFuIHRoZSBudW1HbHlwaHMgKCR7bnVtR2x5cGhzfSkuYCk7CiAgICAgICAgbnVtT2ZNZXRyaWNzID0gbnVtR2x5cGhzOwogICAgICAgIGhlYWRlci5kYXRhWzM0XSA9IChudW1PZk1ldHJpY3MgJiAweGZmMDApID4+IDg7CiAgICAgICAgaGVhZGVyLmRhdGFbMzVdID0gbnVtT2ZNZXRyaWNzICYgMHgwMGZmOwogICAgICB9CgogICAgICBjb25zdCBudW1PZlNpZGViZWFyaW5ncyA9IG51bUdseXBocyAtIG51bU9mTWV0cmljczsKICAgICAgY29uc3QgbnVtTWlzc2luZyA9IG51bU9mU2lkZWJlYXJpbmdzIC0gKG1ldHJpY3MubGVuZ3RoIC0gbnVtT2ZNZXRyaWNzICogNCA+PiAxKTsKCiAgICAgIGlmIChudW1NaXNzaW5nID4gMCkgewogICAgICAgIGNvbnN0IGVudHJpZXMgPSBuZXcgVWludDhBcnJheShtZXRyaWNzLmxlbmd0aCArIG51bU1pc3NpbmcgKiAyKTsKICAgICAgICBlbnRyaWVzLnNldChtZXRyaWNzLmRhdGEpOwoKICAgICAgICBpZiAoZHVwRmlyc3RFbnRyeSkgewogICAgICAgICAgZW50cmllc1ttZXRyaWNzLmxlbmd0aF0gPSBtZXRyaWNzLmRhdGFbMl07CiAgICAgICAgICBlbnRyaWVzW21ldHJpY3MubGVuZ3RoICsgMV0gPSBtZXRyaWNzLmRhdGFbM107CiAgICAgICAgfQoKICAgICAgICBtZXRyaWNzLmRhdGEgPSBlbnRyaWVzOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc2FuaXRpemVHbHlwaChzb3VyY2UsIHNvdXJjZVN0YXJ0LCBzb3VyY2VFbmQsIGRlc3QsIGRlc3RTdGFydCwgaGludHNWYWxpZCkgewogICAgICBjb25zdCBnbHlwaFByb2ZpbGUgPSB7CiAgICAgICAgbGVuZ3RoOiAwLAogICAgICAgIHNpemVPZkluc3RydWN0aW9uczogMAogICAgICB9OwoKICAgICAgaWYgKHNvdXJjZUVuZCAtIHNvdXJjZVN0YXJ0IDw9IDEyKSB7CiAgICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgICAgfQoKICAgICAgY29uc3QgZ2x5ZiA9IHNvdXJjZS5zdWJhcnJheShzb3VyY2VTdGFydCwgc291cmNlRW5kKTsKICAgICAgbGV0IGNvbnRvdXJzQ291bnQgPSBzaWduZWRJbnQxNihnbHlmWzBdLCBnbHlmWzFdKTsKCiAgICAgIGlmIChjb250b3Vyc0NvdW50IDwgMCkgewogICAgICAgIGNvbnRvdXJzQ291bnQgPSAtMTsKICAgICAgICB3cml0ZVNpZ25lZEludDE2KGdseWYsIDAsIGNvbnRvdXJzQ291bnQpOwogICAgICAgIGRlc3Quc2V0KGdseWYsIGRlc3RTdGFydCk7CiAgICAgICAgZ2x5cGhQcm9maWxlLmxlbmd0aCA9IGdseWYubGVuZ3RoOwogICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgIH0KCiAgICAgIGxldCBpLAogICAgICAgICAgaiA9IDEwLAogICAgICAgICAgZmxhZ3NDb3VudCA9IDA7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgY29udG91cnNDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgZW5kUG9pbnQgPSBnbHlmW2pdIDw8IDggfCBnbHlmW2ogKyAxXTsKICAgICAgICBmbGFnc0NvdW50ID0gZW5kUG9pbnQgKyAxOwogICAgICAgIGogKz0gMjsKICAgICAgfQoKICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zU3RhcnQgPSBqOwogICAgICBjb25zdCBpbnN0cnVjdGlvbnNMZW5ndGggPSBnbHlmW2pdIDw8IDggfCBnbHlmW2ogKyAxXTsKICAgICAgZ2x5cGhQcm9maWxlLnNpemVPZkluc3RydWN0aW9ucyA9IGluc3RydWN0aW9uc0xlbmd0aDsKICAgICAgaiArPSAyICsgaW5zdHJ1Y3Rpb25zTGVuZ3RoOwogICAgICBjb25zdCBpbnN0cnVjdGlvbnNFbmQgPSBqOwogICAgICBsZXQgY29vcmRpbmF0ZXNMZW5ndGggPSAwOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGZsYWdzQ291bnQ7IGkrKykgewogICAgICAgIGNvbnN0IGZsYWcgPSBnbHlmW2orK107CgogICAgICAgIGlmIChmbGFnICYgMHhjMCkgewogICAgICAgICAgZ2x5ZltqIC0gMV0gPSBmbGFnICYgMHgzZjsKICAgICAgICB9CgogICAgICAgIGxldCB4TGVuZ3RoID0gMjsKCiAgICAgICAgaWYgKGZsYWcgJiAyKSB7CiAgICAgICAgICB4TGVuZ3RoID0gMTsKICAgICAgICB9IGVsc2UgaWYgKGZsYWcgJiAxNikgewogICAgICAgICAgeExlbmd0aCA9IDA7CiAgICAgICAgfQoKICAgICAgICBsZXQgeUxlbmd0aCA9IDI7CgogICAgICAgIGlmIChmbGFnICYgNCkgewogICAgICAgICAgeUxlbmd0aCA9IDE7CiAgICAgICAgfSBlbHNlIGlmIChmbGFnICYgMzIpIHsKICAgICAgICAgIHlMZW5ndGggPSAwOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgeHlMZW5ndGggPSB4TGVuZ3RoICsgeUxlbmd0aDsKICAgICAgICBjb29yZGluYXRlc0xlbmd0aCArPSB4eUxlbmd0aDsKCiAgICAgICAgaWYgKGZsYWcgJiA4KSB7CiAgICAgICAgICBjb25zdCByZXBlYXQgPSBnbHlmW2orK107CiAgICAgICAgICBpICs9IHJlcGVhdDsKICAgICAgICAgIGNvb3JkaW5hdGVzTGVuZ3RoICs9IHJlcGVhdCAqIHh5TGVuZ3RoOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNvb3JkaW5hdGVzTGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgICAgfQoKICAgICAgbGV0IGdseXBoRGF0YUxlbmd0aCA9IGogKyBjb29yZGluYXRlc0xlbmd0aDsKCiAgICAgIGlmIChnbHlwaERhdGFMZW5ndGggPiBnbHlmLmxlbmd0aCkgewogICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgIH0KCiAgICAgIGlmICghaGludHNWYWxpZCAmJiBpbnN0cnVjdGlvbnNMZW5ndGggPiAwKSB7CiAgICAgICAgZGVzdC5zZXQoZ2x5Zi5zdWJhcnJheSgwLCBpbnN0cnVjdGlvbnNTdGFydCksIGRlc3RTdGFydCk7CiAgICAgICAgZGVzdC5zZXQoWzAsIDBdLCBkZXN0U3RhcnQgKyBpbnN0cnVjdGlvbnNTdGFydCk7CiAgICAgICAgZGVzdC5zZXQoZ2x5Zi5zdWJhcnJheShpbnN0cnVjdGlvbnNFbmQsIGdseXBoRGF0YUxlbmd0aCksIGRlc3RTdGFydCArIGluc3RydWN0aW9uc1N0YXJ0ICsgMik7CiAgICAgICAgZ2x5cGhEYXRhTGVuZ3RoIC09IGluc3RydWN0aW9uc0xlbmd0aDsKCiAgICAgICAgaWYgKGdseWYubGVuZ3RoIC0gZ2x5cGhEYXRhTGVuZ3RoID4gMykgewogICAgICAgICAgZ2x5cGhEYXRhTGVuZ3RoID0gZ2x5cGhEYXRhTGVuZ3RoICsgMyAmIH4zOwogICAgICAgIH0KCiAgICAgICAgZ2x5cGhQcm9maWxlLmxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aDsKICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICB9CgogICAgICBpZiAoZ2x5Zi5sZW5ndGggLSBnbHlwaERhdGFMZW5ndGggPiAzKSB7CiAgICAgICAgZ2x5cGhEYXRhTGVuZ3RoID0gZ2x5cGhEYXRhTGVuZ3RoICsgMyAmIH4zOwogICAgICAgIGRlc3Quc2V0KGdseWYuc3ViYXJyYXkoMCwgZ2x5cGhEYXRhTGVuZ3RoKSwgZGVzdFN0YXJ0KTsKICAgICAgICBnbHlwaFByb2ZpbGUubGVuZ3RoID0gZ2x5cGhEYXRhTGVuZ3RoOwogICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgIH0KCiAgICAgIGRlc3Quc2V0KGdseWYsIGRlc3RTdGFydCk7CiAgICAgIGdseXBoUHJvZmlsZS5sZW5ndGggPSBnbHlmLmxlbmd0aDsKICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYW5pdGl6ZUhlYWQoaGVhZCwgbnVtR2x5cGhzLCBsb2NhTGVuZ3RoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBoZWFkLmRhdGE7CiAgICAgIGNvbnN0IHZlcnNpb24gPSBpbnQzMihkYXRhWzBdLCBkYXRhWzFdLCBkYXRhWzJdLCBkYXRhWzNdKTsKCiAgICAgIGlmICh2ZXJzaW9uID4+IDE2ICE9PSAxKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJBdHRlbXB0aW5nIHRvIGZpeCBpbnZhbGlkIHZlcnNpb24gaW4gaGVhZCB0YWJsZTogIiArIHZlcnNpb24pOwogICAgICAgIGRhdGFbMF0gPSAwOwogICAgICAgIGRhdGFbMV0gPSAxOwogICAgICAgIGRhdGFbMl0gPSAwOwogICAgICAgIGRhdGFbM10gPSAwOwogICAgICB9CgogICAgICBjb25zdCBpbmRleFRvTG9jRm9ybWF0ID0gaW50MTYoZGF0YVs1MF0sIGRhdGFbNTFdKTsKCiAgICAgIGlmIChpbmRleFRvTG9jRm9ybWF0IDwgMCB8fCBpbmRleFRvTG9jRm9ybWF0ID4gMSkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiQXR0ZW1wdGluZyB0byBmaXggaW52YWxpZCBpbmRleFRvTG9jRm9ybWF0IGluIGhlYWQgdGFibGU6ICIgKyBpbmRleFRvTG9jRm9ybWF0KTsKICAgICAgICBjb25zdCBudW1HbHlwaHNQbHVzT25lID0gbnVtR2x5cGhzICsgMTsKCiAgICAgICAgaWYgKGxvY2FMZW5ndGggPT09IG51bUdseXBoc1BsdXNPbmUgPDwgMSkgewogICAgICAgICAgZGF0YVs1MF0gPSAwOwogICAgICAgICAgZGF0YVs1MV0gPSAwOwogICAgICAgIH0gZWxzZSBpZiAobG9jYUxlbmd0aCA9PT0gbnVtR2x5cGhzUGx1c09uZSA8PCAyKSB7CiAgICAgICAgICBkYXRhWzUwXSA9IDA7CiAgICAgICAgICBkYXRhWzUxXSA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQ291bGQgbm90IGZpeCBpbmRleFRvTG9jRm9ybWF0OiAiICsgaW5kZXhUb0xvY0Zvcm1hdCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gc2FuaXRpemVHbHlwaExvY2F0aW9ucyhsb2NhLCBnbHlmLCBudW1HbHlwaHMsIGlzR2x5cGhMb2NhdGlvbnNMb25nLCBoaW50c1ZhbGlkLCBkdXBGaXJzdEVudHJ5LCBtYXhTaXplT2ZJbnN0cnVjdGlvbnMpIHsKICAgICAgbGV0IGl0ZW1TaXplLCBpdGVtRGVjb2RlLCBpdGVtRW5jb2RlOwoKICAgICAgaWYgKGlzR2x5cGhMb2NhdGlvbnNMb25nKSB7CiAgICAgICAgaXRlbVNpemUgPSA0OwoKICAgICAgICBpdGVtRGVjb2RlID0gZnVuY3Rpb24gZm9udEl0ZW1EZWNvZGVMb25nKGRhdGEsIG9mZnNldCkgewogICAgICAgICAgcmV0dXJuIGRhdGFbb2Zmc2V0XSA8PCAyNCB8IGRhdGFbb2Zmc2V0ICsgMV0gPDwgMTYgfCBkYXRhW29mZnNldCArIDJdIDw8IDggfCBkYXRhW29mZnNldCArIDNdOwogICAgICAgIH07CgogICAgICAgIGl0ZW1FbmNvZGUgPSBmdW5jdGlvbiBmb250SXRlbUVuY29kZUxvbmcoZGF0YSwgb2Zmc2V0LCB2YWx1ZSkgewogICAgICAgICAgZGF0YVtvZmZzZXRdID0gdmFsdWUgPj4+IDI0ICYgMHhmZjsKICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgMV0gPSB2YWx1ZSA+PiAxNiAmIDB4ZmY7CiAgICAgICAgICBkYXRhW29mZnNldCArIDJdID0gdmFsdWUgPj4gOCAmIDB4ZmY7CiAgICAgICAgICBkYXRhW29mZnNldCArIDNdID0gdmFsdWUgJiAweGZmOwogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbVNpemUgPSAyOwoKICAgICAgICBpdGVtRGVjb2RlID0gZnVuY3Rpb24gZm9udEl0ZW1EZWNvZGUoZGF0YSwgb2Zmc2V0KSB7CiAgICAgICAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDkgfCBkYXRhW29mZnNldCArIDFdIDw8IDE7CiAgICAgICAgfTsKCiAgICAgICAgaXRlbUVuY29kZSA9IGZ1bmN0aW9uIGZvbnRJdGVtRW5jb2RlKGRhdGEsIG9mZnNldCwgdmFsdWUpIHsKICAgICAgICAgIGRhdGFbb2Zmc2V0XSA9IHZhbHVlID4+IDkgJiAweGZmOwogICAgICAgICAgZGF0YVtvZmZzZXQgKyAxXSA9IHZhbHVlID4+IDEgJiAweGZmOwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGNvbnN0IG51bUdseXBoc091dCA9IGR1cEZpcnN0RW50cnkgPyBudW1HbHlwaHMgKyAxIDogbnVtR2x5cGhzOwogICAgICBjb25zdCBsb2NhRGF0YVNpemUgPSBpdGVtU2l6ZSAqICgxICsgbnVtR2x5cGhzT3V0KTsKICAgICAgY29uc3QgbG9jYURhdGEgPSBuZXcgVWludDhBcnJheShsb2NhRGF0YVNpemUpOwogICAgICBsb2NhRGF0YS5zZXQobG9jYS5kYXRhLnN1YmFycmF5KDAsIGxvY2FEYXRhU2l6ZSkpOwogICAgICBsb2NhLmRhdGEgPSBsb2NhRGF0YTsKICAgICAgY29uc3Qgb2xkR2x5ZkRhdGEgPSBnbHlmLmRhdGE7CiAgICAgIGNvbnN0IG9sZEdseWZEYXRhTGVuZ3RoID0gb2xkR2x5ZkRhdGEubGVuZ3RoOwogICAgICBjb25zdCBuZXdHbHlmRGF0YSA9IG5ldyBVaW50OEFycmF5KG9sZEdseWZEYXRhTGVuZ3RoKTsKICAgICAgbGV0IGksIGo7CiAgICAgIGNvbnN0IGxvY2FFbnRyaWVzID0gW107CgogICAgICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IG51bUdseXBocyArIDE7IGkrKywgaiArPSBpdGVtU2l6ZSkgewogICAgICAgIGxldCBvZmZzZXQgPSBpdGVtRGVjb2RlKGxvY2FEYXRhLCBqKTsKCiAgICAgICAgaWYgKG9mZnNldCA+IG9sZEdseWZEYXRhTGVuZ3RoKSB7CiAgICAgICAgICBvZmZzZXQgPSBvbGRHbHlmRGF0YUxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGxvY2FFbnRyaWVzLnB1c2goewogICAgICAgICAgaW5kZXg6IGksCiAgICAgICAgICBvZmZzZXQsCiAgICAgICAgICBlbmRPZmZzZXQ6IDAKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgbG9jYUVudHJpZXMuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiBhLm9mZnNldCAtIGIub2Zmc2V0OwogICAgICB9KTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1HbHlwaHM7IGkrKykgewogICAgICAgIGxvY2FFbnRyaWVzW2ldLmVuZE9mZnNldCA9IGxvY2FFbnRyaWVzW2kgKyAxXS5vZmZzZXQ7CiAgICAgIH0KCiAgICAgIGxvY2FFbnRyaWVzLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gYS5pbmRleCAtIGIuaW5kZXg7CiAgICAgIH0pOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bUdseXBoczsgaSsrKSB7CiAgICAgICAgY29uc3QgewogICAgICAgICAgb2Zmc2V0LAogICAgICAgICAgZW5kT2Zmc2V0CiAgICAgICAgfSA9IGxvY2FFbnRyaWVzW2ldOwoKICAgICAgICBpZiAob2Zmc2V0ICE9PSAwIHx8IGVuZE9mZnNldCAhPT0gMCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBuZXh0T2Zmc2V0ID0gbG9jYUVudHJpZXNbaSArIDFdLm9mZnNldDsKCiAgICAgICAgaWYgKG5leHRPZmZzZXQgPT09IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgbG9jYUVudHJpZXNbaV0uZW5kT2Zmc2V0ID0gbmV4dE9mZnNldDsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29uc3QgbWlzc2luZ0dseXBocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIGxldCB3cml0ZU9mZnNldCA9IDA7CiAgICAgIGl0ZW1FbmNvZGUobG9jYURhdGEsIDAsIHdyaXRlT2Zmc2V0KTsKCiAgICAgIGZvciAoaSA9IDAsIGogPSBpdGVtU2l6ZTsgaSA8IG51bUdseXBoczsgaSsrLCBqICs9IGl0ZW1TaXplKSB7CiAgICAgICAgY29uc3QgZ2x5cGhQcm9maWxlID0gc2FuaXRpemVHbHlwaChvbGRHbHlmRGF0YSwgbG9jYUVudHJpZXNbaV0ub2Zmc2V0LCBsb2NhRW50cmllc1tpXS5lbmRPZmZzZXQsIG5ld0dseWZEYXRhLCB3cml0ZU9mZnNldCwgaGludHNWYWxpZCk7CiAgICAgICAgY29uc3QgbmV3TGVuZ3RoID0gZ2x5cGhQcm9maWxlLmxlbmd0aDsKCiAgICAgICAgaWYgKG5ld0xlbmd0aCA9PT0gMCkgewogICAgICAgICAgbWlzc2luZ0dseXBoc1tpXSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoZ2x5cGhQcm9maWxlLnNpemVPZkluc3RydWN0aW9ucyA+IG1heFNpemVPZkluc3RydWN0aW9ucykgewogICAgICAgICAgbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zID0gZ2x5cGhQcm9maWxlLnNpemVPZkluc3RydWN0aW9uczsKICAgICAgICB9CgogICAgICAgIHdyaXRlT2Zmc2V0ICs9IG5ld0xlbmd0aDsKICAgICAgICBpdGVtRW5jb2RlKGxvY2FEYXRhLCBqLCB3cml0ZU9mZnNldCk7CiAgICAgIH0KCiAgICAgIGlmICh3cml0ZU9mZnNldCA9PT0gMCkgewogICAgICAgIGNvbnN0IHNpbXBsZUdseXBoID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDQ5LCAwXSk7CgogICAgICAgIGZvciAoaSA9IDAsIGogPSBpdGVtU2l6ZTsgaSA8IG51bUdseXBoc091dDsgaSsrLCBqICs9IGl0ZW1TaXplKSB7CiAgICAgICAgICBpdGVtRW5jb2RlKGxvY2FEYXRhLCBqLCBzaW1wbGVHbHlwaC5sZW5ndGgpOwogICAgICAgIH0KCiAgICAgICAgZ2x5Zi5kYXRhID0gc2ltcGxlR2x5cGg7CiAgICAgIH0gZWxzZSBpZiAoZHVwRmlyc3RFbnRyeSkgewogICAgICAgIGNvbnN0IGZpcnN0RW50cnlMZW5ndGggPSBpdGVtRGVjb2RlKGxvY2FEYXRhLCBpdGVtU2l6ZSk7CgogICAgICAgIGlmIChuZXdHbHlmRGF0YS5sZW5ndGggPiBmaXJzdEVudHJ5TGVuZ3RoICsgd3JpdGVPZmZzZXQpIHsKICAgICAgICAgIGdseWYuZGF0YSA9IG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIGZpcnN0RW50cnlMZW5ndGggKyB3cml0ZU9mZnNldCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGdseWYuZGF0YSA9IG5ldyBVaW50OEFycmF5KGZpcnN0RW50cnlMZW5ndGggKyB3cml0ZU9mZnNldCk7CiAgICAgICAgICBnbHlmLmRhdGEuc2V0KG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIHdyaXRlT2Zmc2V0KSk7CiAgICAgICAgfQoKICAgICAgICBnbHlmLmRhdGEuc2V0KG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIGZpcnN0RW50cnlMZW5ndGgpLCB3cml0ZU9mZnNldCk7CiAgICAgICAgaXRlbUVuY29kZShsb2NhLmRhdGEsIGxvY2FEYXRhLmxlbmd0aCAtIGl0ZW1TaXplLCB3cml0ZU9mZnNldCArIGZpcnN0RW50cnlMZW5ndGgpOwogICAgICB9IGVsc2UgewogICAgICAgIGdseWYuZGF0YSA9IG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIHdyaXRlT2Zmc2V0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBtaXNzaW5nR2x5cGhzLAogICAgICAgIG1heFNpemVPZkluc3RydWN0aW9ucwogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRQb3N0U2NyaXB0VGFibGUocG9zdCwgcHJvcGVydGllc09iaiwgbWF4cE51bUdseXBocykgewogICAgICBjb25zdCBzdGFydCA9IChmb250LnN0YXJ0IHx8IDApICsgcG9zdC5vZmZzZXQ7CiAgICAgIGZvbnQucG9zID0gc3RhcnQ7CiAgICAgIGNvbnN0IGxlbmd0aCA9IHBvc3QubGVuZ3RoLAogICAgICAgICAgICBlbmQgPSBzdGFydCArIGxlbmd0aDsKICAgICAgY29uc3QgdmVyc2lvbiA9IGZvbnQuZ2V0SW50MzIoKTsKICAgICAgZm9udC5za2lwKDI4KTsKICAgICAgbGV0IGdseXBoTmFtZXM7CiAgICAgIGxldCB2YWxpZCA9IHRydWU7CiAgICAgIGxldCBpOwoKICAgICAgc3dpdGNoICh2ZXJzaW9uKSB7CiAgICAgICAgY2FzZSAweDAwMDEwMDAwOgogICAgICAgICAgZ2x5cGhOYW1lcyA9IF9mb250c191dGlscy5NYWNTdGFuZGFyZEdseXBoT3JkZXJpbmc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDAwMDIwMDAwOgogICAgICAgICAgY29uc3QgbnVtR2x5cGhzID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICAgICAgICBpZiAobnVtR2x5cGhzICE9PSBtYXhwTnVtR2x5cGhzKSB7CiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGdseXBoTmFtZUluZGV4ZXMgPSBbXTsKCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtR2x5cGhzOyArK2kpIHsKICAgICAgICAgICAgY29uc3QgaW5kZXggPSBmb250LmdldFVpbnQxNigpOwoKICAgICAgICAgICAgaWYgKGluZGV4ID49IDMyNzY4KSB7CiAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2x5cGhOYW1lSW5kZXhlcy5wdXNoKGluZGV4KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIXZhbGlkKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGN1c3RvbU5hbWVzID0gW10sCiAgICAgICAgICAgICAgICBzdHJCdWYgPSBbXTsKCiAgICAgICAgICB3aGlsZSAoZm9udC5wb3MgPCBlbmQpIHsKICAgICAgICAgICAgY29uc3Qgc3RyaW5nTGVuZ3RoID0gZm9udC5nZXRCeXRlKCk7CiAgICAgICAgICAgIHN0ckJ1Zi5sZW5ndGggPSBzdHJpbmdMZW5ndGg7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3RyaW5nTGVuZ3RoOyArK2kpIHsKICAgICAgICAgICAgICBzdHJCdWZbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGZvbnQuZ2V0Qnl0ZSgpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VzdG9tTmFtZXMucHVzaChzdHJCdWYuam9pbigiIikpOwogICAgICAgICAgfQoKICAgICAgICAgIGdseXBoTmFtZXMgPSBbXTsKCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtR2x5cGhzOyArK2kpIHsKICAgICAgICAgICAgY29uc3QgaiA9IGdseXBoTmFtZUluZGV4ZXNbaV07CgogICAgICAgICAgICBpZiAoaiA8IDI1OCkgewogICAgICAgICAgICAgIGdseXBoTmFtZXMucHVzaChfZm9udHNfdXRpbHMuTWFjU3RhbmRhcmRHbHlwaE9yZGVyaW5nW2pdKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2x5cGhOYW1lcy5wdXNoKGN1c3RvbU5hbWVzW2ogLSAyNThdKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDAwMDMwMDAwOgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVua25vd24vdW5zdXBwb3J0ZWQgcG9zdCB0YWJsZSB2ZXJzaW9uICIgKyB2ZXJzaW9uKTsKICAgICAgICAgIHZhbGlkID0gZmFsc2U7CgogICAgICAgICAgaWYgKHByb3BlcnRpZXNPYmouZGVmYXVsdEVuY29kaW5nKSB7CiAgICAgICAgICAgIGdseXBoTmFtZXMgPSBwcm9wZXJ0aWVzT2JqLmRlZmF1bHRFbmNvZGluZzsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcHJvcGVydGllc09iai5nbHlwaE5hbWVzID0gZ2x5cGhOYW1lczsKICAgICAgcmV0dXJuIHZhbGlkOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWROYW1lVGFibGUobmFtZVRhYmxlKSB7CiAgICAgIGNvbnN0IHN0YXJ0ID0gKGZvbnQuc3RhcnQgfHwgMCkgKyBuYW1lVGFibGUub2Zmc2V0OwogICAgICBmb250LnBvcyA9IHN0YXJ0OwogICAgICBjb25zdCBuYW1lcyA9IFtbXSwgW11dOwogICAgICBjb25zdCBsZW5ndGggPSBuYW1lVGFibGUubGVuZ3RoLAogICAgICAgICAgICBlbmQgPSBzdGFydCArIGxlbmd0aDsKICAgICAgY29uc3QgZm9ybWF0ID0gZm9udC5nZXRVaW50MTYoKTsKICAgICAgY29uc3QgRk9STUFUXzBfSEVBREVSX0xFTkdUSCA9IDY7CgogICAgICBpZiAoZm9ybWF0ICE9PSAwIHx8IGxlbmd0aCA8IEZPUk1BVF8wX0hFQURFUl9MRU5HVEgpIHsKICAgICAgICByZXR1cm4gbmFtZXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IG51bVJlY29yZHMgPSBmb250LmdldFVpbnQxNigpOwogICAgICBjb25zdCBzdHJpbmdzU3RhcnQgPSBmb250LmdldFVpbnQxNigpOwogICAgICBjb25zdCByZWNvcmRzID0gW107CiAgICAgIGNvbnN0IE5BTUVfUkVDT1JEX0xFTkdUSCA9IDEyOwogICAgICBsZXQgaSwgaWk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtUmVjb3JkcyAmJiBmb250LnBvcyArIE5BTUVfUkVDT1JEX0xFTkdUSCA8PSBlbmQ7IGkrKykgewogICAgICAgIGNvbnN0IHIgPSB7CiAgICAgICAgICBwbGF0Zm9ybTogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgIGVuY29kaW5nOiBmb250LmdldFVpbnQxNigpLAogICAgICAgICAgbGFuZ3VhZ2U6IGZvbnQuZ2V0VWludDE2KCksCiAgICAgICAgICBuYW1lOiBmb250LmdldFVpbnQxNigpLAogICAgICAgICAgbGVuZ3RoOiBmb250LmdldFVpbnQxNigpLAogICAgICAgICAgb2Zmc2V0OiBmb250LmdldFVpbnQxNigpCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHIucGxhdGZvcm0gPT09IDEgJiYgci5lbmNvZGluZyA9PT0gMCAmJiByLmxhbmd1YWdlID09PSAwIHx8IHIucGxhdGZvcm0gPT09IDMgJiYgci5lbmNvZGluZyA9PT0gMSAmJiByLmxhbmd1YWdlID09PSAweDQwOSkgewogICAgICAgICAgcmVjb3Jkcy5wdXNoKHIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzW2ldOwoKICAgICAgICBpZiAocmVjb3JkLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBvcyA9IHN0YXJ0ICsgc3RyaW5nc1N0YXJ0ICsgcmVjb3JkLm9mZnNldDsKCiAgICAgICAgaWYgKHBvcyArIHJlY29yZC5sZW5ndGggPiBlbmQpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgZm9udC5wb3MgPSBwb3M7CiAgICAgICAgY29uc3QgbmFtZUluZGV4ID0gcmVjb3JkLm5hbWU7CgogICAgICAgIGlmIChyZWNvcmQuZW5jb2RpbmcpIHsKICAgICAgICAgIGxldCBzdHIgPSAiIjsKCiAgICAgICAgICBmb3IgKGxldCBqID0gMCwgamogPSByZWNvcmQubGVuZ3RoOyBqIDwgamo7IGogKz0gMikgewogICAgICAgICAgICBzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShmb250LmdldFVpbnQxNigpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBuYW1lc1sxXVtuYW1lSW5kZXhdID0gc3RyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuYW1lc1swXVtuYW1lSW5kZXhdID0gZm9udC5nZXRTdHJpbmcocmVjb3JkLmxlbmd0aCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbmFtZXM7CiAgICB9CgogICAgY29uc3QgVFRPcHNTdGFja0RlbHRhcyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAtMiwgLTIsIC0yLCAtMiwgMCwgMCwgLTIsIC01LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDAsIDAsIC0xLCAwLCAtMSwgLTEsIC0xLCAtMSwgMSwgLTEsIC05OTksIDAsIDEsIDAsIC0xLCAtMiwgMCwgLTEsIC0yLCAtMSwgLTEsIDAsIC0xLCAtMSwgMCwgMCwgLTk5OSwgLTk5OSwgLTEsIC0xLCAtMSwgLTEsIC0yLCAtOTk5LCAtMiwgLTIsIC05OTksIDAsIC0yLCAtMiwgMCwgMCwgLTIsIDAsIC0yLCAwLCAwLCAwLCAtMiwgLTEsIC0xLCAxLCAxLCAwLCAwLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMCwgMCwgLTEsIDAsIC0xLCAtMSwgMCwgLTk5OSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgLTIsIC05OTksIC05OTksIC05OTksIC05OTksIC05OTksIC0xLCAtMSwgLTIsIC0yLCAwLCAwLCAwLCAwLCAtMSwgLTEsIC05OTksIC0yLCAtMiwgMCwgMCwgLTEsIC0yLCAtMiwgMCwgMCwgMCwgLTEsIC0xLCAtMSwgLTJdOwoKICAgIGZ1bmN0aW9uIHNhbml0aXplVFRQcm9ncmFtKHRhYmxlLCB0dENvbnRleHQpIHsKICAgICAgbGV0IGRhdGEgPSB0YWJsZS5kYXRhOwogICAgICBsZXQgaSA9IDAsCiAgICAgICAgICBqLAogICAgICAgICAgbiwKICAgICAgICAgIGIsCiAgICAgICAgICBmdW5jSWQsCiAgICAgICAgICBwYywKICAgICAgICAgIGxhc3RFbmRmID0gMCwKICAgICAgICAgIGxhc3REZWZmID0gMDsKICAgICAgY29uc3Qgc3RhY2sgPSBbXTsKICAgICAgY29uc3QgY2FsbHN0YWNrID0gW107CiAgICAgIGNvbnN0IGZ1bmN0aW9uc0NhbGxlZCA9IFtdOwogICAgICBsZXQgdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zID0gdHRDb250ZXh0LnRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9uczsKICAgICAgbGV0IGluRkRFRiA9IGZhbHNlLAogICAgICAgICAgaWZMZXZlbCA9IDAsCiAgICAgICAgICBpbkVMU0UgPSAwOwoKICAgICAgZm9yIChsZXQgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOykgewogICAgICAgIGNvbnN0IG9wID0gZGF0YVtpKytdOwoKICAgICAgICBpZiAob3AgPT09IDB4NDApIHsKICAgICAgICAgIG4gPSBkYXRhW2krK107CgogICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgaSArPSBuOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG47IGorKykgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goZGF0YVtpKytdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4NDEpIHsKICAgICAgICAgIG4gPSBkYXRhW2krK107CgogICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgaSArPSBuICogMjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgICAgICBiID0gZGF0YVtpKytdOwogICAgICAgICAgICAgIHN0YWNrLnB1c2goYiA8PCA4IHwgZGF0YVtpKytdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoKG9wICYgMHhmOCkgPT09IDB4YjApIHsKICAgICAgICAgIG4gPSBvcCAtIDB4YjAgKyAxOwoKICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgIGkgKz0gbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGRhdGFbaSsrXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKChvcCAmIDB4ZjgpID09PSAweGI4KSB7CiAgICAgICAgICBuID0gb3AgLSAweGI4ICsgMTsKCiAgICAgICAgICBpZiAoaW5GREVGIHx8IGluRUxTRSkgewogICAgICAgICAgICBpICs9IG4gKiAyOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG47IGorKykgewogICAgICAgICAgICAgIGIgPSBkYXRhW2krK107CiAgICAgICAgICAgICAgc3RhY2sucHVzaChiIDw8IDggfCBkYXRhW2krK10pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgyYiAmJiAhdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zKSB7CiAgICAgICAgICBpZiAoIWluRkRFRiAmJiAhaW5FTFNFKSB7CiAgICAgICAgICAgIGZ1bmNJZCA9IHN0YWNrLmF0KC0xKTsKCiAgICAgICAgICAgIGlmIChpc05hTihmdW5jSWQpKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJUVDogQ0FMTCBlbXB0eSBzdGFjayAob3IgaW52YWxpZCBlbnRyeSkuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdHRDb250ZXh0LmZ1bmN0aW9uc1VzZWRbZnVuY0lkXSA9IHRydWU7CgogICAgICAgICAgICAgIGlmIChmdW5jSWQgaW4gdHRDb250ZXh0LmZ1bmN0aW9uc1N0YWNrRGVsdGFzKSB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXdTdGFja0xlbmd0aCA9IHN0YWNrLmxlbmd0aCArIHR0Q29udGV4dC5mdW5jdGlvbnNTdGFja0RlbHRhc1tmdW5jSWRdOwoKICAgICAgICAgICAgICAgIGlmIChuZXdTdGFja0xlbmd0aCA8IDApIHsKICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogQ0FMTCBpbnZhbGlkIGZ1bmN0aW9ucyBzdGFjayBkZWx0YS4iKTsKICAgICAgICAgICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHN0YWNrLmxlbmd0aCA9IG5ld1N0YWNrTGVuZ3RoOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnVuY0lkIGluIHR0Q29udGV4dC5mdW5jdGlvbnNEZWZpbmVkICYmICFmdW5jdGlvbnNDYWxsZWQuaW5jbHVkZXMoZnVuY0lkKSkgewogICAgICAgICAgICAgICAgY2FsbHN0YWNrLnB1c2goewogICAgICAgICAgICAgICAgICBkYXRhLAogICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICBzdGFja1RvcDogc3RhY2subGVuZ3RoIC0gMQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBmdW5jdGlvbnNDYWxsZWQucHVzaChmdW5jSWQpOwogICAgICAgICAgICAgICAgcGMgPSB0dENvbnRleHQuZnVuY3Rpb25zRGVmaW5lZFtmdW5jSWRdOwoKICAgICAgICAgICAgICAgIGlmICghcGMpIHsKICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogQ0FMTCBub24tZXhpc3RlbnQgZnVuY3Rpb24iKTsKICAgICAgICAgICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGRhdGEgPSBwYy5kYXRhOwogICAgICAgICAgICAgICAgaSA9IHBjLmk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgyYyAmJiAhdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zKSB7CiAgICAgICAgICBpZiAoaW5GREVGIHx8IGluRUxTRSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiBuZXN0ZWQgRkRFRnMgbm90IGFsbG93ZWQiKTsKICAgICAgICAgICAgdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpbkZERUYgPSB0cnVlOwogICAgICAgICAgbGFzdERlZmYgPSBpOwogICAgICAgICAgZnVuY0lkID0gc3RhY2sucG9wKCk7CiAgICAgICAgICB0dENvbnRleHQuZnVuY3Rpb25zRGVmaW5lZFtmdW5jSWRdID0gewogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4MmQpIHsKICAgICAgICAgIGlmIChpbkZERUYpIHsKICAgICAgICAgICAgaW5GREVGID0gZmFsc2U7CiAgICAgICAgICAgIGxhc3RFbmRmID0gaTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBjID0gY2FsbHN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKCFwYykgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IEVOREYgYmFkIHN0YWNrIik7CiAgICAgICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmNJZCA9IGZ1bmN0aW9uc0NhbGxlZC5wb3AoKTsKICAgICAgICAgICAgZGF0YSA9IHBjLmRhdGE7CiAgICAgICAgICAgIGkgPSBwYy5pOwogICAgICAgICAgICB0dENvbnRleHQuZnVuY3Rpb25zU3RhY2tEZWx0YXNbZnVuY0lkXSA9IHN0YWNrLmxlbmd0aCAtIHBjLnN0YWNrVG9wOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4ODkpIHsKICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IG5lc3RlZCBJREVGcyBub3QgYWxsb3dlZCIpOwogICAgICAgICAgICB0b29Db21wbGV4VG9Gb2xsb3dGdW5jdGlvbnMgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGluRkRFRiA9IHRydWU7CiAgICAgICAgICBsYXN0RGVmZiA9IGk7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHg1OCkgewogICAgICAgICAgKytpZkxldmVsOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4MWIpIHsKICAgICAgICAgIGluRUxTRSA9IGlmTGV2ZWw7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHg1OSkgewogICAgICAgICAgaWYgKGluRUxTRSA9PT0gaWZMZXZlbCkgewogICAgICAgICAgICBpbkVMU0UgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIC0taWZMZXZlbDsKICAgICAgICB9IGVsc2UgaWYgKG9wID09PSAweDFjKSB7CiAgICAgICAgICBpZiAoIWluRkRFRiAmJiAhaW5FTFNFKSB7CiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHN0YWNrLmF0KC0xKTsKCiAgICAgICAgICAgIGlmIChvZmZzZXQgPiAwKSB7CiAgICAgICAgICAgICAgaSArPSBvZmZzZXQgLSAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIWluRkRFRiAmJiAhaW5FTFNFKSB7CiAgICAgICAgICBsZXQgc3RhY2tEZWx0YSA9IDA7CgogICAgICAgICAgaWYgKG9wIDw9IDB4OGUpIHsKICAgICAgICAgICAgc3RhY2tEZWx0YSA9IFRUT3BzU3RhY2tEZWx0YXNbb3BdOwogICAgICAgICAgfSBlbHNlIGlmIChvcCA+PSAweGMwICYmIG9wIDw9IDB4ZGYpIHsKICAgICAgICAgICAgc3RhY2tEZWx0YSA9IC0xOwogICAgICAgICAgfSBlbHNlIGlmIChvcCA+PSAweGUwKSB7CiAgICAgICAgICAgIHN0YWNrRGVsdGEgPSAtMjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAob3AgPj0gMHg3MSAmJiBvcCA8PSAweDc1KSB7CiAgICAgICAgICAgIG4gPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICAgIGlmICghaXNOYU4obikpIHsKICAgICAgICAgICAgICBzdGFja0RlbHRhID0gLW4gKiAyOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKHN0YWNrRGVsdGEgPCAwICYmIHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrRGVsdGErKzsKICAgICAgICAgIH0KCiAgICAgICAgICB3aGlsZSAoc3RhY2tEZWx0YSA+IDApIHsKICAgICAgICAgICAgc3RhY2sucHVzaChOYU4pOwogICAgICAgICAgICBzdGFja0RlbHRhLS07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0dENvbnRleHQudG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zID0gdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zOwogICAgICBjb25zdCBjb250ZW50ID0gW2RhdGFdOwoKICAgICAgaWYgKGkgPiBkYXRhLmxlbmd0aCkgewogICAgICAgIGNvbnRlbnQucHVzaChuZXcgVWludDhBcnJheShpIC0gZGF0YS5sZW5ndGgpKTsKICAgICAgfQoKICAgICAgaWYgKGxhc3REZWZmID4gbGFzdEVuZGYpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiBjb21wbGVtZW50aW5nIGEgbWlzc2luZyBmdW5jdGlvbiB0YWlsIik7CiAgICAgICAgY29udGVudC5wdXNoKG5ldyBVaW50OEFycmF5KFsweDIyLCAweDJkXSkpOwogICAgICB9CgogICAgICBmb2xkVFRUYWJsZSh0YWJsZSwgY29udGVudCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hlY2tJbnZhbGlkRnVuY3Rpb25zKHR0Q29udGV4dCwgbWF4RnVuY3Rpb25EZWZzKSB7CiAgICAgIGlmICh0dENvbnRleHQudG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWQubGVuZ3RoID4gbWF4RnVuY3Rpb25EZWZzKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogbW9yZSBmdW5jdGlvbnMgZGVmaW5lZCB0aGFuIGV4cGVjdGVkIik7CiAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IHR0Q29udGV4dC5mdW5jdGlvbnNVc2VkLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICBpZiAoaiA+IG1heEZ1bmN0aW9uRGVmcykgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogaW52YWxpZCBmdW5jdGlvbiBpZDogIiArIGopOwogICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0dENvbnRleHQuZnVuY3Rpb25zVXNlZFtqXSAmJiAhdHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWRbal0pIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IHVuZGVmaW5lZCBmdW5jdGlvbjogIiArIGopOwogICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmb2xkVFRUYWJsZSh0YWJsZSwgY29udGVudCkgewogICAgICBpZiAoY29udGVudC5sZW5ndGggPiAxKSB7CiAgICAgICAgbGV0IG5ld0xlbmd0aCA9IDA7CiAgICAgICAgbGV0IGosIGpqOwoKICAgICAgICBmb3IgKGogPSAwLCBqaiA9IGNvbnRlbnQubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgbmV3TGVuZ3RoICs9IGNvbnRlbnRbal0ubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgbmV3TGVuZ3RoID0gbmV3TGVuZ3RoICsgMyAmIH4zOwogICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KG5ld0xlbmd0aCk7CiAgICAgICAgbGV0IHBvcyA9IDA7CgogICAgICAgIGZvciAoaiA9IDAsIGpqID0gY29udGVudC5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICByZXN1bHQuc2V0KGNvbnRlbnRbal0sIHBvcyk7CiAgICAgICAgICBwb3MgKz0gY29udGVudFtqXS5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICB0YWJsZS5kYXRhID0gcmVzdWx0OwogICAgICAgIHRhYmxlLmxlbmd0aCA9IG5ld0xlbmd0aDsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNhbml0aXplVFRQcm9ncmFtcyhmcGdtLCBwcmVwLCBjdnQsIG1heEZ1bmN0aW9uRGVmcykgewogICAgICBjb25zdCB0dENvbnRleHQgPSB7CiAgICAgICAgZnVuY3Rpb25zRGVmaW5lZDogW10sCiAgICAgICAgZnVuY3Rpb25zVXNlZDogW10sCiAgICAgICAgZnVuY3Rpb25zU3RhY2tEZWx0YXM6IFtdLAogICAgICAgIHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9uczogZmFsc2UsCiAgICAgICAgaGludHNWYWxpZDogdHJ1ZQogICAgICB9OwoKICAgICAgaWYgKGZwZ20pIHsKICAgICAgICBzYW5pdGl6ZVRUUHJvZ3JhbShmcGdtLCB0dENvbnRleHQpOwogICAgICB9CgogICAgICBpZiAocHJlcCkgewogICAgICAgIHNhbml0aXplVFRQcm9ncmFtKHByZXAsIHR0Q29udGV4dCk7CiAgICAgIH0KCiAgICAgIGlmIChmcGdtKSB7CiAgICAgICAgY2hlY2tJbnZhbGlkRnVuY3Rpb25zKHR0Q29udGV4dCwgbWF4RnVuY3Rpb25EZWZzKTsKICAgICAgfQoKICAgICAgaWYgKGN2dCAmJiBjdnQubGVuZ3RoICYgMSkgewogICAgICAgIGNvbnN0IGN2dERhdGEgPSBuZXcgVWludDhBcnJheShjdnQubGVuZ3RoICsgMSk7CiAgICAgICAgY3Z0RGF0YS5zZXQoY3Z0LmRhdGEpOwogICAgICAgIGN2dC5kYXRhID0gY3Z0RGF0YTsKICAgICAgfQoKICAgICAgcmV0dXJuIHR0Q29udGV4dC5oaW50c1ZhbGlkOwogICAgfQoKICAgIGZvbnQgPSBuZXcgX3N0cmVhbS5TdHJlYW0obmV3IFVpbnQ4QXJyYXkoZm9udC5nZXRCeXRlcygpKSk7CiAgICBsZXQgaGVhZGVyLCB0YWJsZXM7CgogICAgaWYgKGlzVHJ1ZVR5cGVDb2xsZWN0aW9uRmlsZShmb250KSkgewogICAgICBjb25zdCB0dGNEYXRhID0gcmVhZFRydWVUeXBlQ29sbGVjdGlvbkRhdGEoZm9udCwgdGhpcy5uYW1lKTsKICAgICAgaGVhZGVyID0gdHRjRGF0YS5oZWFkZXI7CiAgICAgIHRhYmxlcyA9IHR0Y0RhdGEudGFibGVzOwogICAgfSBlbHNlIHsKICAgICAgaGVhZGVyID0gcmVhZE9wZW5UeXBlSGVhZGVyKGZvbnQpOwogICAgICB0YWJsZXMgPSByZWFkVGFibGVzKGZvbnQsIGhlYWRlci5udW1UYWJsZXMpOwogICAgfQoKICAgIGxldCBjZmYsIGNmZkZpbGU7CiAgICBjb25zdCBpc1RydWVUeXBlID0gIXRhYmxlc1siQ0ZGICJdOwoKICAgIGlmICghaXNUcnVlVHlwZSkgewogICAgICBjb25zdCBpc0NvbXBvc2l0ZSA9IHByb3BlcnRpZXMuY29tcG9zaXRlICYmICgocHJvcGVydGllcy5jaWRUb0dpZE1hcCB8fCBbXSkubGVuZ3RoID4gMCB8fCAhKHByb3BlcnRpZXMuY01hcCBpbnN0YW5jZW9mIF9jbWFwLklkZW50aXR5Q01hcCkpOwoKICAgICAgaWYgKGhlYWRlci52ZXJzaW9uID09PSAiT1RUTyIgJiYgIWlzQ29tcG9zaXRlIHx8ICF0YWJsZXMuaGVhZCB8fCAhdGFibGVzLmhoZWEgfHwgIXRhYmxlcy5tYXhwIHx8ICF0YWJsZXMucG9zdCkgewogICAgICAgIGNmZkZpbGUgPSBuZXcgX3N0cmVhbS5TdHJlYW0odGFibGVzWyJDRkYgIl0uZGF0YSk7CiAgICAgICAgY2ZmID0gbmV3IF9jZmZfZm9udC5DRkZGb250KGNmZkZpbGUsIHByb3BlcnRpZXMpOwogICAgICAgIGFkanVzdFdpZHRocyhwcm9wZXJ0aWVzKTsKICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0KG5hbWUsIGNmZiwgcHJvcGVydGllcyk7CiAgICAgIH0KCiAgICAgIGRlbGV0ZSB0YWJsZXMuZ2x5ZjsKICAgICAgZGVsZXRlIHRhYmxlcy5sb2NhOwogICAgICBkZWxldGUgdGFibGVzLmZwZ207CiAgICAgIGRlbGV0ZSB0YWJsZXMucHJlcDsKICAgICAgZGVsZXRlIHRhYmxlc1siY3Z0ICJdOwogICAgICB0aGlzLmlzT3BlblR5cGUgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYgKCF0YWJsZXMubG9jYSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcignUmVxdWlyZWQgImxvY2EiIHRhYmxlIGlzIG5vdCBmb3VuZCcpOwogICAgICB9CgogICAgICBpZiAoIXRhYmxlcy5nbHlmKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdSZXF1aXJlZCAiZ2x5ZiIgdGFibGUgaXMgbm90IGZvdW5kIC0tIHRyeWluZyB0byByZWNvdmVyLicpOwogICAgICAgIHRhYmxlcy5nbHlmID0gewogICAgICAgICAgdGFnOiAiZ2x5ZiIsCiAgICAgICAgICBkYXRhOiBuZXcgVWludDhBcnJheSgwKQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHRoaXMuaXNPcGVuVHlwZSA9IGZhbHNlOwogICAgfQoKICAgIGlmICghdGFibGVzLm1heHApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdSZXF1aXJlZCAibWF4cCIgdGFibGUgaXMgbm90IGZvdW5kJyk7CiAgICB9CgogICAgZm9udC5wb3MgPSAoZm9udC5zdGFydCB8fCAwKSArIHRhYmxlcy5tYXhwLm9mZnNldDsKICAgIGNvbnN0IHZlcnNpb24gPSBmb250LmdldEludDMyKCk7CiAgICBjb25zdCBudW1HbHlwaHMgPSBmb250LmdldFVpbnQxNigpOwoKICAgIGlmIChwcm9wZXJ0aWVzLnNjYWxlRmFjdG9ycyAmJiBwcm9wZXJ0aWVzLnNjYWxlRmFjdG9ycy5sZW5ndGggPT09IG51bUdseXBocyAmJiBpc1RydWVUeXBlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBzY2FsZUZhY3RvcnMKICAgICAgfSA9IHByb3BlcnRpZXM7CiAgICAgIGNvbnN0IGlzR2x5cGhMb2NhdGlvbnNMb25nID0gaW50MTYodGFibGVzLmhlYWQuZGF0YVs1MF0sIHRhYmxlcy5oZWFkLmRhdGFbNTFdKTsKICAgICAgY29uc3QgZ2x5cGhzID0gbmV3IF9nbHlmLkdseWZUYWJsZSh7CiAgICAgICAgZ2x5ZlRhYmxlOiB0YWJsZXMuZ2x5Zi5kYXRhLAogICAgICAgIGlzR2x5cGhMb2NhdGlvbnNMb25nLAogICAgICAgIGxvY2FUYWJsZTogdGFibGVzLmxvY2EuZGF0YSwKICAgICAgICBudW1HbHlwaHMKICAgICAgfSk7CiAgICAgIGdseXBocy5zY2FsZShzY2FsZUZhY3RvcnMpOwogICAgICBjb25zdCB7CiAgICAgICAgZ2x5ZiwKICAgICAgICBsb2NhLAogICAgICAgIGlzTG9jYXRpb25Mb25nCiAgICAgIH0gPSBnbHlwaHMud3JpdGUoKTsKICAgICAgdGFibGVzLmdseWYuZGF0YSA9IGdseWY7CiAgICAgIHRhYmxlcy5sb2NhLmRhdGEgPSBsb2NhOwoKICAgICAgaWYgKGlzTG9jYXRpb25Mb25nICE9PSAhIWlzR2x5cGhMb2NhdGlvbnNMb25nKSB7CiAgICAgICAgdGFibGVzLmhlYWQuZGF0YVs1MF0gPSAwOwogICAgICAgIHRhYmxlcy5oZWFkLmRhdGFbNTFdID0gaXNMb2NhdGlvbkxvbmcgPyAxIDogMDsKICAgICAgfQoKICAgICAgY29uc3QgbWV0cmljcyA9IHRhYmxlcy5obXR4LmRhdGE7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUdseXBoczsgaSsrKSB7CiAgICAgICAgY29uc3QgaiA9IDQgKiBpOwogICAgICAgIGNvbnN0IGFkdmFuY2VXaWR0aCA9IE1hdGgucm91bmQoc2NhbGVGYWN0b3JzW2ldICogaW50MTYobWV0cmljc1tqXSwgbWV0cmljc1tqICsgMV0pKTsKICAgICAgICBtZXRyaWNzW2pdID0gYWR2YW5jZVdpZHRoID4+IDggJiAweGZmOwogICAgICAgIG1ldHJpY3NbaiArIDFdID0gYWR2YW5jZVdpZHRoICYgMHhmZjsKICAgICAgICBjb25zdCBsc2IgPSBNYXRoLnJvdW5kKHNjYWxlRmFjdG9yc1tpXSAqIHNpZ25lZEludDE2KG1ldHJpY3NbaiArIDJdLCBtZXRyaWNzW2ogKyAzXSkpOwogICAgICAgIHdyaXRlU2lnbmVkSW50MTYobWV0cmljcywgaiArIDIsIGxzYik7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgbnVtR2x5cGhzT3V0ID0gbnVtR2x5cGhzICsgMTsKICAgIGxldCBkdXBGaXJzdEVudHJ5ID0gdHJ1ZTsKCiAgICBpZiAobnVtR2x5cGhzT3V0ID4gMHhmZmZmKSB7CiAgICAgIGR1cEZpcnN0RW50cnkgPSBmYWxzZTsKICAgICAgbnVtR2x5cGhzT3V0ID0gbnVtR2x5cGhzOwogICAgICAoMCwgX3V0aWwud2FybikoIk5vdCBlbm91Z2ggc3BhY2UgaW4gZ2x5ZnMgdG8gZHVwbGljYXRlIGZpcnN0IGdseXBoLiIpOwogICAgfQoKICAgIGxldCBtYXhGdW5jdGlvbkRlZnMgPSAwOwogICAgbGV0IG1heFNpemVPZkluc3RydWN0aW9ucyA9IDA7CgogICAgaWYgKHZlcnNpb24gPj0gMHgwMDAxMDAwMCAmJiB0YWJsZXMubWF4cC5sZW5ndGggPj0gMjIpIHsKICAgICAgZm9udC5wb3MgKz0gODsKICAgICAgY29uc3QgbWF4Wm9uZXMgPSBmb250LmdldFVpbnQxNigpOwoKICAgICAgaWYgKG1heFpvbmVzID4gMikgewogICAgICAgIHRhYmxlcy5tYXhwLmRhdGFbMTRdID0gMDsKICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzE1XSA9IDI7CiAgICAgIH0KCiAgICAgIGZvbnQucG9zICs9IDQ7CiAgICAgIG1heEZ1bmN0aW9uRGVmcyA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICAgIGZvbnQucG9zICs9IDQ7CiAgICAgIG1heFNpemVPZkluc3RydWN0aW9ucyA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICB9CgogICAgdGFibGVzLm1heHAuZGF0YVs0XSA9IG51bUdseXBoc091dCA+PiA4OwogICAgdGFibGVzLm1heHAuZGF0YVs1XSA9IG51bUdseXBoc091dCAmIDI1NTsKICAgIGNvbnN0IGhpbnRzVmFsaWQgPSBzYW5pdGl6ZVRUUHJvZ3JhbXModGFibGVzLmZwZ20sIHRhYmxlcy5wcmVwLCB0YWJsZXNbImN2dCAiXSwgbWF4RnVuY3Rpb25EZWZzKTsKCiAgICBpZiAoIWhpbnRzVmFsaWQpIHsKICAgICAgZGVsZXRlIHRhYmxlcy5mcGdtOwogICAgICBkZWxldGUgdGFibGVzLnByZXA7CiAgICAgIGRlbGV0ZSB0YWJsZXNbImN2dCAiXTsKICAgIH0KCiAgICBzYW5pdGl6ZU1ldHJpY3MoZm9udCwgdGFibGVzLmhoZWEsIHRhYmxlcy5obXR4LCB0YWJsZXMuaGVhZCwgbnVtR2x5cGhzT3V0LCBkdXBGaXJzdEVudHJ5KTsKCiAgICBpZiAoIXRhYmxlcy5oZWFkKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcignUmVxdWlyZWQgImhlYWQiIHRhYmxlIGlzIG5vdCBmb3VuZCcpOwogICAgfQoKICAgIHNhbml0aXplSGVhZCh0YWJsZXMuaGVhZCwgbnVtR2x5cGhzLCBpc1RydWVUeXBlID8gdGFibGVzLmxvY2EubGVuZ3RoIDogMCk7CiAgICBsZXQgbWlzc2luZ0dseXBocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgaWYgKGlzVHJ1ZVR5cGUpIHsKICAgICAgY29uc3QgaXNHbHlwaExvY2F0aW9uc0xvbmcgPSBpbnQxNih0YWJsZXMuaGVhZC5kYXRhWzUwXSwgdGFibGVzLmhlYWQuZGF0YVs1MV0pOwogICAgICBjb25zdCBnbHlwaHNJbmZvID0gc2FuaXRpemVHbHlwaExvY2F0aW9ucyh0YWJsZXMubG9jYSwgdGFibGVzLmdseWYsIG51bUdseXBocywgaXNHbHlwaExvY2F0aW9uc0xvbmcsIGhpbnRzVmFsaWQsIGR1cEZpcnN0RW50cnksIG1heFNpemVPZkluc3RydWN0aW9ucyk7CiAgICAgIG1pc3NpbmdHbHlwaHMgPSBnbHlwaHNJbmZvLm1pc3NpbmdHbHlwaHM7CgogICAgICBpZiAodmVyc2lvbiA+PSAweDAwMDEwMDAwICYmIHRhYmxlcy5tYXhwLmxlbmd0aCA+PSAyMikgewogICAgICAgIHRhYmxlcy5tYXhwLmRhdGFbMjZdID0gZ2x5cGhzSW5mby5tYXhTaXplT2ZJbnN0cnVjdGlvbnMgPj4gODsKICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzI3XSA9IGdseXBoc0luZm8ubWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zICYgMjU1OwogICAgICB9CiAgICB9CgogICAgaWYgKCF0YWJsZXMuaGhlYSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ1JlcXVpcmVkICJoaGVhIiB0YWJsZSBpcyBub3QgZm91bmQnKTsKICAgIH0KCiAgICBpZiAodGFibGVzLmhoZWEuZGF0YVsxMF0gPT09IDAgJiYgdGFibGVzLmhoZWEuZGF0YVsxMV0gPT09IDApIHsKICAgICAgdGFibGVzLmhoZWEuZGF0YVsxMF0gPSAweGZmOwogICAgICB0YWJsZXMuaGhlYS5kYXRhWzExXSA9IDB4ZmY7CiAgICB9CgogICAgY29uc3QgbWV0cmljc092ZXJyaWRlID0gewogICAgICB1bml0c1BlckVtOiBpbnQxNih0YWJsZXMuaGVhZC5kYXRhWzE4XSwgdGFibGVzLmhlYWQuZGF0YVsxOV0pLAogICAgICB5TWF4OiBpbnQxNih0YWJsZXMuaGVhZC5kYXRhWzQyXSwgdGFibGVzLmhlYWQuZGF0YVs0M10pLAogICAgICB5TWluOiBzaWduZWRJbnQxNih0YWJsZXMuaGVhZC5kYXRhWzM4XSwgdGFibGVzLmhlYWQuZGF0YVszOV0pLAogICAgICBhc2NlbnQ6IHNpZ25lZEludDE2KHRhYmxlcy5oaGVhLmRhdGFbNF0sIHRhYmxlcy5oaGVhLmRhdGFbNV0pLAogICAgICBkZXNjZW50OiBzaWduZWRJbnQxNih0YWJsZXMuaGhlYS5kYXRhWzZdLCB0YWJsZXMuaGhlYS5kYXRhWzddKSwKICAgICAgbGluZUdhcDogc2lnbmVkSW50MTYodGFibGVzLmhoZWEuZGF0YVs4XSwgdGFibGVzLmhoZWEuZGF0YVs5XSkKICAgIH07CiAgICB0aGlzLmFzY2VudCA9IG1ldHJpY3NPdmVycmlkZS5hc2NlbnQgLyBtZXRyaWNzT3ZlcnJpZGUudW5pdHNQZXJFbTsKICAgIHRoaXMuZGVzY2VudCA9IG1ldHJpY3NPdmVycmlkZS5kZXNjZW50IC8gbWV0cmljc092ZXJyaWRlLnVuaXRzUGVyRW07CiAgICB0aGlzLmxpbmVHYXAgPSBtZXRyaWNzT3ZlcnJpZGUubGluZUdhcCAvIG1ldHJpY3NPdmVycmlkZS51bml0c1BlckVtOwoKICAgIGlmICh0aGlzLmNzc0ZvbnRJbmZvICYmIHRoaXMuY3NzRm9udEluZm8ubGluZUhlaWdodCkgewogICAgICB0aGlzLmxpbmVIZWlnaHQgPSB0aGlzLmNzc0ZvbnRJbmZvLm1ldHJpY3MubGluZUhlaWdodDsKICAgICAgdGhpcy5saW5lR2FwID0gdGhpcy5jc3NGb250SW5mby5tZXRyaWNzLmxpbmVHYXA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmxpbmVIZWlnaHQgPSB0aGlzLmFzY2VudCAtIHRoaXMuZGVzY2VudCArIHRoaXMubGluZUdhcDsKICAgIH0KCiAgICBpZiAodGFibGVzLnBvc3QpIHsKICAgICAgcmVhZFBvc3RTY3JpcHRUYWJsZSh0YWJsZXMucG9zdCwgcHJvcGVydGllcywgbnVtR2x5cGhzKTsKICAgIH0KCiAgICB0YWJsZXMucG9zdCA9IHsKICAgICAgdGFnOiAicG9zdCIsCiAgICAgIGRhdGE6IGNyZWF0ZVBvc3RUYWJsZShwcm9wZXJ0aWVzKQogICAgfTsKICAgIGNvbnN0IGNoYXJDb2RlVG9HbHlwaElkID0gW107CgogICAgZnVuY3Rpb24gaGFzR2x5cGgoZ2x5cGhJZCkgewogICAgICByZXR1cm4gIW1pc3NpbmdHbHlwaHNbZ2x5cGhJZF07CiAgICB9CgogICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgIGNvbnN0IGNpZFRvR2lkTWFwID0gcHJvcGVydGllcy5jaWRUb0dpZE1hcCB8fCBbXTsKICAgICAgY29uc3QgaXNDaWRUb0dpZE1hcEVtcHR5ID0gY2lkVG9HaWRNYXAubGVuZ3RoID09PSAwOwogICAgICBwcm9wZXJ0aWVzLmNNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhckNvZGUsIGNpZCkgewogICAgICAgIGlmICh0eXBlb2YgY2lkID09PSAic3RyaW5nIikgewogICAgICAgICAgY2lkID0gY29udmVydENpZFN0cmluZyhjaGFyQ29kZSwgY2lkLCB0cnVlKTsKICAgICAgICB9CgogICAgICAgIGlmIChjaWQgPiAweGZmZmYpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWF4IHNpemUgb2YgQ0lEIGlzIDY1LDUzNSIpOwogICAgICAgIH0KCiAgICAgICAgbGV0IGdseXBoSWQgPSAtMTsKCiAgICAgICAgaWYgKGlzQ2lkVG9HaWRNYXBFbXB0eSkgewogICAgICAgICAgZ2x5cGhJZCA9IGNpZDsKICAgICAgICB9IGVsc2UgaWYgKGNpZFRvR2lkTWFwW2NpZF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZ2x5cGhJZCA9IGNpZFRvR2lkTWFwW2NpZF07CiAgICAgICAgfQoKICAgICAgICBpZiAoZ2x5cGhJZCA+PSAwICYmIGdseXBoSWQgPCBudW1HbHlwaHMgJiYgaGFzR2x5cGgoZ2x5cGhJZCkpIHsKICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGNtYXBUYWJsZSA9IHJlYWRDbWFwVGFibGUodGFibGVzLmNtYXAsIGZvbnQsIHRoaXMuaXNTeW1ib2xpY0ZvbnQsIHByb3BlcnRpZXMuaGFzRW5jb2RpbmcpOwogICAgICBjb25zdCBjbWFwUGxhdGZvcm1JZCA9IGNtYXBUYWJsZS5wbGF0Zm9ybUlkOwogICAgICBjb25zdCBjbWFwRW5jb2RpbmdJZCA9IGNtYXBUYWJsZS5lbmNvZGluZ0lkOwogICAgICBjb25zdCBjbWFwTWFwcGluZ3MgPSBjbWFwVGFibGUubWFwcGluZ3M7CiAgICAgIGNvbnN0IGNtYXBNYXBwaW5nc0xlbmd0aCA9IGNtYXBNYXBwaW5ncy5sZW5ndGg7CiAgICAgIGxldCBiYXNlRW5jb2RpbmcgPSBbXSwKICAgICAgICAgIGZvcmNlUG9zdFRhYmxlID0gZmFsc2U7CgogICAgICBpZiAocHJvcGVydGllcy5oYXNFbmNvZGluZyAmJiAocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lID09PSAiTWFjUm9tYW5FbmNvZGluZyIgfHwgcHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lID09PSAiV2luQW5zaUVuY29kaW5nIikpIHsKICAgICAgICBiYXNlRW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKTsKICAgICAgfQoKICAgICAgaWYgKHByb3BlcnRpZXMuaGFzRW5jb2RpbmcgJiYgIXRoaXMuaXNTeW1ib2xpY0ZvbnQgJiYgKGNtYXBQbGF0Zm9ybUlkID09PSAzICYmIGNtYXBFbmNvZGluZ0lkID09PSAxIHx8IGNtYXBQbGF0Zm9ybUlkID09PSAxICYmIGNtYXBFbmNvZGluZ0lkID09PSAwKSkgewogICAgICAgIGNvbnN0IGdseXBoc1VuaWNvZGVNYXAgPSAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwoKICAgICAgICBmb3IgKGxldCBjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgMjU2OyBjaGFyQ29kZSsrKSB7CiAgICAgICAgICBsZXQgZ2x5cGhOYW1lOwoKICAgICAgICAgIGlmICh0aGlzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGdseXBoTmFtZSA9IHRoaXMuZGlmZmVyZW5jZXNbY2hhckNvZGVdOwogICAgICAgICAgfSBlbHNlIGlmIChiYXNlRW5jb2RpbmcubGVuZ3RoICYmIGJhc2VFbmNvZGluZ1tjaGFyQ29kZV0gIT09ICIiKSB7CiAgICAgICAgICAgIGdseXBoTmFtZSA9IGJhc2VFbmNvZGluZ1tjaGFyQ29kZV07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBnbHlwaE5hbWUgPSBfZW5jb2RpbmdzLlN0YW5kYXJkRW5jb2RpbmdbY2hhckNvZGVdOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghZ2x5cGhOYW1lKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHN0YW5kYXJkR2x5cGhOYW1lID0gKDAsIF9mb250c191dGlscy5yZWNvdmVyR2x5cGhOYW1lKShnbHlwaE5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwogICAgICAgICAgbGV0IHVuaWNvZGVPckNoYXJDb2RlOwoKICAgICAgICAgIGlmIChjbWFwUGxhdGZvcm1JZCA9PT0gMyAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMSkgewogICAgICAgICAgICB1bmljb2RlT3JDaGFyQ29kZSA9IGdseXBoc1VuaWNvZGVNYXBbc3RhbmRhcmRHbHlwaE5hbWVdOwogICAgICAgICAgfSBlbHNlIGlmIChjbWFwUGxhdGZvcm1JZCA9PT0gMSAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMCkgewogICAgICAgICAgICB1bmljb2RlT3JDaGFyQ29kZSA9IF9lbmNvZGluZ3MuTWFjUm9tYW5FbmNvZGluZy5pbmRleE9mKHN0YW5kYXJkR2x5cGhOYW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodW5pY29kZU9yQ2hhckNvZGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBpZiAoIXByb3BlcnRpZXMuZ2x5cGhOYW1lcyAmJiBwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwICYmICEodGhpcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXApKSB7CiAgICAgICAgICAgICAgY29uc3QgdW5pY29kZSA9IHRoaXMudG9Vbmljb2RlLmdldChjaGFyQ29kZSk7CgogICAgICAgICAgICAgIGlmICh1bmljb2RlKSB7CiAgICAgICAgICAgICAgICB1bmljb2RlT3JDaGFyQ29kZSA9IHVuaWNvZGUuY29kZVBvaW50QXQoMCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodW5pY29kZU9yQ2hhckNvZGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbWFwTWFwcGluZ3NMZW5ndGg7ICsraSkgewogICAgICAgICAgICBpZiAoY21hcE1hcHBpbmdzW2ldLmNoYXJDb2RlICE9PSB1bmljb2RlT3JDaGFyQ29kZSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBjbWFwTWFwcGluZ3NbaV0uZ2x5cGhJZDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNtYXBQbGF0Zm9ybUlkID09PSAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbWFwTWFwcGluZ3NMZW5ndGg7ICsraSkgewogICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY21hcE1hcHBpbmdzW2ldLmNoYXJDb2RlXSA9IGNtYXBNYXBwaW5nc1tpXS5nbHlwaElkOwogICAgICAgIH0KCiAgICAgICAgZm9yY2VQb3N0VGFibGUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY21hcE1hcHBpbmdzTGVuZ3RoOyArK2kpIHsKICAgICAgICAgIGxldCBjaGFyQ29kZSA9IGNtYXBNYXBwaW5nc1tpXS5jaGFyQ29kZTsKCiAgICAgICAgICBpZiAoY21hcFBsYXRmb3JtSWQgPT09IDMgJiYgY2hhckNvZGUgPj0gMHhmMDAwICYmIGNoYXJDb2RlIDw9IDB4ZjBmZikgewogICAgICAgICAgICBjaGFyQ29kZSAmPSAweGZmOwogICAgICAgICAgfQoKICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGNtYXBNYXBwaW5nc1tpXS5nbHlwaElkOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHByb3BlcnRpZXMuZ2x5cGhOYW1lcyAmJiAoYmFzZUVuY29kaW5nLmxlbmd0aCB8fCB0aGlzLmRpZmZlcmVuY2VzLmxlbmd0aCkpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7CiAgICAgICAgICBpZiAoIWZvcmNlUG9zdFRhYmxlICYmIGNoYXJDb2RlVG9HbHlwaElkW2ldICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgZ2x5cGhOYW1lID0gdGhpcy5kaWZmZXJlbmNlc1tpXSB8fCBiYXNlRW5jb2RpbmdbaV07CgogICAgICAgICAgaWYgKCFnbHlwaE5hbWUpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgZ2x5cGhJZCA9IHByb3BlcnRpZXMuZ2x5cGhOYW1lcy5pbmRleE9mKGdseXBoTmFtZSk7CgogICAgICAgICAgaWYgKGdseXBoSWQgPiAwICYmIGhhc0dseXBoKGdseXBoSWQpKSB7CiAgICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2ldID0gZ2x5cGhJZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY2hhckNvZGVUb0dseXBoSWQubGVuZ3RoID09PSAwKSB7CiAgICAgIGNoYXJDb2RlVG9HbHlwaElkWzBdID0gMDsKICAgIH0KCiAgICBsZXQgZ2x5cGhaZXJvSWQgPSBudW1HbHlwaHNPdXQgLSAxOwoKICAgIGlmICghZHVwRmlyc3RFbnRyeSkgewogICAgICBnbHlwaFplcm9JZCA9IDA7CiAgICB9CgogICAgaWYgKCFwcm9wZXJ0aWVzLmNzc0ZvbnRJbmZvKSB7CiAgICAgIGNvbnN0IG5ld01hcHBpbmcgPSBhZGp1c3RNYXBwaW5nKGNoYXJDb2RlVG9HbHlwaElkLCBoYXNHbHlwaCwgZ2x5cGhaZXJvSWQsIHRoaXMudG9Vbmljb2RlKTsKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gbmV3TWFwcGluZy50b0ZvbnRDaGFyOwogICAgICB0YWJsZXMuY21hcCA9IHsKICAgICAgICB0YWc6ICJjbWFwIiwKICAgICAgICBkYXRhOiBjcmVhdGVDbWFwVGFibGUobmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZCwgbmV3TWFwcGluZy50b1VuaWNvZGVFeHRyYU1hcCwgbnVtR2x5cGhzT3V0KQogICAgICB9OwoKICAgICAgaWYgKCF0YWJsZXNbIk9TLzIiXSB8fCAhdmFsaWRhdGVPUzJUYWJsZSh0YWJsZXNbIk9TLzIiXSwgZm9udCkpIHsKICAgICAgICB0YWJsZXNbIk9TLzIiXSA9IHsKICAgICAgICAgIHRhZzogIk9TLzIiLAogICAgICAgICAgZGF0YTogY3JlYXRlT1MyVGFibGUocHJvcGVydGllcywgbmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZCwgbWV0cmljc092ZXJyaWRlKQogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWlzVHJ1ZVR5cGUpIHsKICAgICAgdHJ5IHsKICAgICAgICBjZmZGaWxlID0gbmV3IF9zdHJlYW0uU3RyZWFtKHRhYmxlc1siQ0ZGICJdLmRhdGEpOwogICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQYXJzZXIoY2ZmRmlsZSwgcHJvcGVydGllcywgX2ZvbnRzX3V0aWxzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCk7CiAgICAgICAgY2ZmID0gcGFyc2VyLnBhcnNlKCk7CiAgICAgICAgY2ZmLmR1cGxpY2F0ZUZpcnN0R2x5cGgoKTsKICAgICAgICBjb25zdCBjb21waWxlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZDb21waWxlcihjZmYpOwogICAgICAgIHRhYmxlc1siQ0ZGICJdLmRhdGEgPSBjb21waWxlci5jb21waWxlKCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkZhaWxlZCB0byBjb21waWxlIGZvbnQgIiArIHByb3BlcnRpZXMubG9hZGVkTmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRhYmxlcy5uYW1lKSB7CiAgICAgIHRhYmxlcy5uYW1lID0gewogICAgICAgIHRhZzogIm5hbWUiLAogICAgICAgIGRhdGE6IGNyZWF0ZU5hbWVUYWJsZSh0aGlzLm5hbWUpCiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBjb25zdCBuYW1lUHJvdG90eXBlID0gcmVhZE5hbWVUYWJsZSh0YWJsZXMubmFtZSk7CiAgICAgIHRhYmxlcy5uYW1lLmRhdGEgPSBjcmVhdGVOYW1lVGFibGUobmFtZSwgbmFtZVByb3RvdHlwZSk7CiAgICAgIHRoaXMucHNOYW1lID0gbmFtZVByb3RvdHlwZVswXVs2XSB8fCBudWxsOwogICAgfQoKICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgX29wZW50eXBlX2ZpbGVfYnVpbGRlci5PcGVuVHlwZUZpbGVCdWlsZGVyKGhlYWRlci52ZXJzaW9uKTsKCiAgICBmb3IgKGNvbnN0IHRhYmxlVGFnIGluIHRhYmxlcykgewogICAgICBidWlsZGVyLmFkZFRhYmxlKHRhYmxlVGFnLCB0YWJsZXNbdGFibGVUYWddLmRhdGEpOwogICAgfQoKICAgIHJldHVybiBidWlsZGVyLnRvQXJyYXkoKTsKICB9CgogIGNvbnZlcnQoZm9udE5hbWUsIGZvbnQsIHByb3BlcnRpZXMpIHsKICAgIHByb3BlcnRpZXMuZml4ZWRQaXRjaCA9IGZhbHNlOwoKICAgIGlmIChwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZykgewogICAgICBhZGp1c3RUb1VuaWNvZGUocHJvcGVydGllcywgcHJvcGVydGllcy5idWlsdEluRW5jb2RpbmcpOwogICAgfQoKICAgIGxldCBnbHlwaFplcm9JZCA9IDE7CgogICAgaWYgKGZvbnQgaW5zdGFuY2VvZiBfY2ZmX2ZvbnQuQ0ZGRm9udCkgewogICAgICBnbHlwaFplcm9JZCA9IGZvbnQubnVtR2x5cGhzIC0gMTsKICAgIH0KCiAgICBjb25zdCBtYXBwaW5nID0gZm9udC5nZXRHbHlwaE1hcHBpbmcocHJvcGVydGllcyk7CiAgICBsZXQgbmV3TWFwcGluZyA9IG51bGw7CiAgICBsZXQgbmV3Q2hhckNvZGVUb0dseXBoSWQgPSBtYXBwaW5nOwogICAgbGV0IHRvVW5pY29kZUV4dHJhTWFwID0gbnVsbDsKCiAgICBpZiAoIXByb3BlcnRpZXMuY3NzRm9udEluZm8pIHsKICAgICAgbmV3TWFwcGluZyA9IGFkanVzdE1hcHBpbmcobWFwcGluZywgZm9udC5oYXNHbHlwaElkLmJpbmQoZm9udCksIGdseXBoWmVyb0lkLCB0aGlzLnRvVW5pY29kZSk7CiAgICAgIHRoaXMudG9Gb250Q2hhciA9IG5ld01hcHBpbmcudG9Gb250Q2hhcjsKICAgICAgbmV3Q2hhckNvZGVUb0dseXBoSWQgPSBuZXdNYXBwaW5nLmNoYXJDb2RlVG9HbHlwaElkOwogICAgICB0b1VuaWNvZGVFeHRyYU1hcCA9IG5ld01hcHBpbmcudG9Vbmljb2RlRXh0cmFNYXA7CiAgICB9CgogICAgY29uc3QgbnVtR2x5cGhzID0gZm9udC5udW1HbHlwaHM7CgogICAgZnVuY3Rpb24gZ2V0Q2hhckNvZGVzKGNoYXJDb2RlVG9HbHlwaElkLCBnbHlwaElkKSB7CiAgICAgIGxldCBjaGFyQ29kZXMgPSBudWxsOwoKICAgICAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBjaGFyQ29kZVRvR2x5cGhJZCkgewogICAgICAgIGlmIChnbHlwaElkID09PSBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0pIHsKICAgICAgICAgIGlmICghY2hhckNvZGVzKSB7CiAgICAgICAgICAgIGNoYXJDb2RlcyA9IFtdOwogICAgICAgICAgfQoKICAgICAgICAgIGNoYXJDb2Rlcy5wdXNoKGNoYXJDb2RlIHwgMCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gY2hhckNvZGVzOwogICAgfQoKICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYXJDb2RlKGNoYXJDb2RlVG9HbHlwaElkLCBnbHlwaElkKSB7CiAgICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gY2hhckNvZGVUb0dseXBoSWQpIHsKICAgICAgICBpZiAoZ2x5cGhJZCA9PT0gY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdKSB7CiAgICAgICAgICByZXR1cm4gY2hhckNvZGUgfCAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZFtuZXdNYXBwaW5nLm5leHRBdmFpbGFibGVGb250Q2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgcmV0dXJuIG5ld01hcHBpbmcubmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZSsrOwogICAgfQoKICAgIGNvbnN0IHNlYWNzID0gZm9udC5zZWFjczsKCiAgICBpZiAobmV3TWFwcGluZyAmJiBfZm9udHNfdXRpbHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEICYmIHNlYWNzICYmIHNlYWNzLmxlbmd0aCkgewogICAgICBjb25zdCBtYXRyaXggPSBwcm9wZXJ0aWVzLmZvbnRNYXRyaXggfHwgX3V0aWwuRk9OVF9JREVOVElUWV9NQVRSSVg7CiAgICAgIGNvbnN0IGNoYXJzZXQgPSBmb250LmdldENoYXJzZXQoKTsKICAgICAgY29uc3Qgc2VhY01hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBmb3IgKGxldCBnbHlwaElkIGluIHNlYWNzKSB7CiAgICAgICAgZ2x5cGhJZCB8PSAwOwogICAgICAgIGNvbnN0IHNlYWMgPSBzZWFjc1tnbHlwaElkXTsKICAgICAgICBjb25zdCBiYXNlR2x5cGhOYW1lID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW3NlYWNbMl1dOwogICAgICAgIGNvbnN0IGFjY2VudEdseXBoTmFtZSA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZ1tzZWFjWzNdXTsKICAgICAgICBjb25zdCBiYXNlR2x5cGhJZCA9IGNoYXJzZXQuaW5kZXhPZihiYXNlR2x5cGhOYW1lKTsKICAgICAgICBjb25zdCBhY2NlbnRHbHlwaElkID0gY2hhcnNldC5pbmRleE9mKGFjY2VudEdseXBoTmFtZSk7CgogICAgICAgIGlmIChiYXNlR2x5cGhJZCA8IDAgfHwgYWNjZW50R2x5cGhJZCA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgYWNjZW50T2Zmc2V0ID0gewogICAgICAgICAgeDogc2VhY1swXSAqIG1hdHJpeFswXSArIHNlYWNbMV0gKiBtYXRyaXhbMl0gKyBtYXRyaXhbNF0sCiAgICAgICAgICB5OiBzZWFjWzBdICogbWF0cml4WzFdICsgc2VhY1sxXSAqIG1hdHJpeFszXSArIG1hdHJpeFs1XQogICAgICAgIH07CiAgICAgICAgY29uc3QgY2hhckNvZGVzID0gZ2V0Q2hhckNvZGVzKG1hcHBpbmcsIGdseXBoSWQpOwoKICAgICAgICBpZiAoIWNoYXJDb2RlcykgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGFyQ29kZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgY29uc3QgY2hhckNvZGUgPSBjaGFyQ29kZXNbaV07CiAgICAgICAgICBjb25zdCBjaGFyQ29kZVRvR2x5cGhJZCA9IG5ld01hcHBpbmcuY2hhckNvZGVUb0dseXBoSWQ7CiAgICAgICAgICBjb25zdCBiYXNlRm9udENoYXJDb2RlID0gY3JlYXRlQ2hhckNvZGUoY2hhckNvZGVUb0dseXBoSWQsIGJhc2VHbHlwaElkKTsKICAgICAgICAgIGNvbnN0IGFjY2VudEZvbnRDaGFyQ29kZSA9IGNyZWF0ZUNoYXJDb2RlKGNoYXJDb2RlVG9HbHlwaElkLCBhY2NlbnRHbHlwaElkKTsKICAgICAgICAgIHNlYWNNYXBbY2hhckNvZGVdID0gewogICAgICAgICAgICBiYXNlRm9udENoYXJDb2RlLAogICAgICAgICAgICBhY2NlbnRGb250Q2hhckNvZGUsCiAgICAgICAgICAgIGFjY2VudE9mZnNldAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHByb3BlcnRpZXMuc2VhY01hcCA9IHNlYWNNYXA7CiAgICB9CgogICAgY29uc3QgdW5pdHNQZXJFbSA9IDEgLyAocHJvcGVydGllcy5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYKVswXTsKICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgX29wZW50eXBlX2ZpbGVfYnVpbGRlci5PcGVuVHlwZUZpbGVCdWlsZGVyKCJceDRGXHg1NFx4NTRceDRGIik7CiAgICBidWlsZGVyLmFkZFRhYmxlKCJDRkYgIiwgZm9udC5kYXRhKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoIk9TLzIiLCBjcmVhdGVPUzJUYWJsZShwcm9wZXJ0aWVzLCBuZXdDaGFyQ29kZVRvR2x5cGhJZCkpOwogICAgYnVpbGRlci5hZGRUYWJsZSgiY21hcCIsIGNyZWF0ZUNtYXBUYWJsZShuZXdDaGFyQ29kZVRvR2x5cGhJZCwgdG9Vbmljb2RlRXh0cmFNYXAsIG51bUdseXBocykpOwogICAgYnVpbGRlci5hZGRUYWJsZSgiaGVhZCIsICJceDAwXHgwMVx4MDBceDAwIiArICJceDAwXHgwMFx4MTBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDVGXHgwRlx4M0NceEY1IiArICJceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYodW5pdHNQZXJFbSkgKyAiXHgwMFx4MDBceDAwXHgwMFx4OWVceDBiXHg3ZVx4MjciICsgIlx4MDBceDAwXHgwMFx4MDBceDllXHgwYlx4N2VceDI3IiArICJceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5kZXNjZW50KSArICJceDBGXHhGRiIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5hc2NlbnQpICsgc3RyaW5nMTYocHJvcGVydGllcy5pdGFsaWNBbmdsZSA/IDIgOiAwKSArICJceDAwXHgxMSIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIpOwogICAgYnVpbGRlci5hZGRUYWJsZSgiaGhlYSIsICJceDAwXHgwMVx4MDBceDAwIiArIHNhZmVTdHJpbmcxNihwcm9wZXJ0aWVzLmFzY2VudCkgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5kZXNjZW50KSArICJceDAwXHgwMCIgKyAiXHhGRlx4RkYiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgc2FmZVN0cmluZzE2KHByb3BlcnRpZXMuY2FwSGVpZ2h0KSArIHNhZmVTdHJpbmcxNihNYXRoLnRhbihwcm9wZXJ0aWVzLml0YWxpY0FuZ2xlKSAqIHByb3BlcnRpZXMueEhlaWdodCkgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyBzdHJpbmcxNihudW1HbHlwaHMpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoImhtdHgiLCBmdW5jdGlvbiBmb250RmllbGRzSG10eCgpIHsKICAgICAgY29uc3QgY2hhcnN0cmluZ3MgPSBmb250LmNoYXJzdHJpbmdzOwogICAgICBjb25zdCBjZmZXaWR0aHMgPSBmb250LmNmZiA/IGZvbnQuY2ZmLndpZHRocyA6IG51bGw7CiAgICAgIGxldCBobXR4ID0gIlx4MDBceDAwXHgwMFx4MDAiOwoKICAgICAgZm9yIChsZXQgaSA9IDEsIGlpID0gbnVtR2x5cGhzOyBpIDwgaWk7IGkrKykgewogICAgICAgIGxldCB3aWR0aCA9IDA7CgogICAgICAgIGlmIChjaGFyc3RyaW5ncykgewogICAgICAgICAgY29uc3QgY2hhcnN0cmluZyA9IGNoYXJzdHJpbmdzW2kgLSAxXTsKICAgICAgICAgIHdpZHRoID0gIndpZHRoIiBpbiBjaGFyc3RyaW5nID8gY2hhcnN0cmluZy53aWR0aCA6IDA7CiAgICAgICAgfSBlbHNlIGlmIChjZmZXaWR0aHMpIHsKICAgICAgICAgIHdpZHRoID0gTWF0aC5jZWlsKGNmZldpZHRoc1tpXSB8fCAwKTsKICAgICAgICB9CgogICAgICAgIGhtdHggKz0gc3RyaW5nMTYod2lkdGgpICsgc3RyaW5nMTYoMCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBobXR4OwogICAgfSgpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoIm1heHAiLCAiXHgwMFx4MDBceDUwXHgwMCIgKyBzdHJpbmcxNihudW1HbHlwaHMpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoIm5hbWUiLCBjcmVhdGVOYW1lVGFibGUoZm9udE5hbWUpKTsKICAgIGJ1aWxkZXIuYWRkVGFibGUoInBvc3QiLCBjcmVhdGVQb3N0VGFibGUocHJvcGVydGllcykpOwogICAgcmV0dXJuIGJ1aWxkZXIudG9BcnJheSgpOwogIH0KCiAgZ2V0IHNwYWNlV2lkdGgoKSB7CiAgICBjb25zdCBwb3NzaWJsZVNwYWNlUmVwbGFjZW1lbnRzID0gWyJzcGFjZSIsICJtaW51cyIsICJvbmUiLCAiaSIsICJJIl07CiAgICBsZXQgd2lkdGg7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcG9zc2libGVTcGFjZVJlcGxhY2VtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IHBvc3NpYmxlU3BhY2VSZXBsYWNlbWVudHNbaV07CgogICAgICBpZiAoZ2x5cGhOYW1lIGluIHRoaXMud2lkdGhzKSB7CiAgICAgICAgd2lkdGggPSB0aGlzLndpZHRoc1tnbHlwaE5hbWVdOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjb25zdCBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKICAgICAgY29uc3QgZ2x5cGhVbmljb2RlID0gZ2x5cGhzVW5pY29kZU1hcFtnbHlwaE5hbWVdOwogICAgICBsZXQgY2hhcmNvZGUgPSAwOwoKICAgICAgaWYgKHRoaXMuY29tcG9zaXRlICYmIHRoaXMuY01hcC5jb250YWlucyhnbHlwaFVuaWNvZGUpKSB7CiAgICAgICAgY2hhcmNvZGUgPSB0aGlzLmNNYXAubG9va3VwKGdseXBoVW5pY29kZSk7CgogICAgICAgIGlmICh0eXBlb2YgY2hhcmNvZGUgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICBjaGFyY29kZSA9IGNvbnZlcnRDaWRTdHJpbmcoZ2x5cGhVbmljb2RlLCBjaGFyY29kZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWNoYXJjb2RlICYmIHRoaXMudG9Vbmljb2RlKSB7CiAgICAgICAgY2hhcmNvZGUgPSB0aGlzLnRvVW5pY29kZS5jaGFyQ29kZU9mKGdseXBoVW5pY29kZSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFyY29kZSA8PSAwKSB7CiAgICAgICAgY2hhcmNvZGUgPSBnbHlwaFVuaWNvZGU7CiAgICAgIH0KCiAgICAgIHdpZHRoID0gdGhpcy53aWR0aHNbY2hhcmNvZGVdOwoKICAgICAgaWYgKHdpZHRoKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB3aWR0aCA9IHdpZHRoIHx8IHRoaXMuZGVmYXVsdFdpZHRoOwogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJzcGFjZVdpZHRoIiwgd2lkdGgpOwogIH0KCiAgX2NoYXJUb0dseXBoKGNoYXJjb2RlLCBpc1NwYWNlID0gZmFsc2UpIHsKICAgIGxldCBmb250Q2hhckNvZGUsIHdpZHRoLCBvcGVyYXRvckxpc3RJZDsKICAgIGxldCB3aWR0aENvZGUgPSBjaGFyY29kZTsKCiAgICBpZiAodGhpcy5jTWFwICYmIHRoaXMuY01hcC5jb250YWlucyhjaGFyY29kZSkpIHsKICAgICAgd2lkdGhDb2RlID0gdGhpcy5jTWFwLmxvb2t1cChjaGFyY29kZSk7CgogICAgICBpZiAodHlwZW9mIHdpZHRoQ29kZSA9PT0gInN0cmluZyIpIHsKICAgICAgICB3aWR0aENvZGUgPSBjb252ZXJ0Q2lkU3RyaW5nKGNoYXJjb2RlLCB3aWR0aENvZGUpOwogICAgICB9CiAgICB9CgogICAgd2lkdGggPSB0aGlzLndpZHRoc1t3aWR0aENvZGVdOwoKICAgIGlmICh0eXBlb2Ygd2lkdGggIT09ICJudW1iZXIiKSB7CiAgICAgIHdpZHRoID0gdGhpcy5kZWZhdWx0V2lkdGg7CiAgICB9CgogICAgY29uc3Qgdm1ldHJpYyA9IHRoaXMudm1ldHJpY3MgJiYgdGhpcy52bWV0cmljc1t3aWR0aENvZGVdOwogICAgbGV0IHVuaWNvZGUgPSB0aGlzLnRvVW5pY29kZS5nZXQoY2hhcmNvZGUpIHx8IGNoYXJjb2RlOwoKICAgIGlmICh0eXBlb2YgdW5pY29kZSA9PT0gIm51bWJlciIpIHsKICAgICAgdW5pY29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodW5pY29kZSk7CiAgICB9CgogICAgbGV0IGlzSW5Gb250ID0gdGhpcy50b0ZvbnRDaGFyW2NoYXJjb2RlXSAhPT0gdW5kZWZpbmVkOwogICAgZm9udENoYXJDb2RlID0gdGhpcy50b0ZvbnRDaGFyW2NoYXJjb2RlXSB8fCBjaGFyY29kZTsKCiAgICBpZiAodGhpcy5taXNzaW5nRmlsZSkgewogICAgICBjb25zdCBnbHlwaE5hbWUgPSB0aGlzLmRpZmZlcmVuY2VzW2NoYXJjb2RlXSB8fCB0aGlzLmRlZmF1bHRFbmNvZGluZ1tjaGFyY29kZV07CgogICAgICBpZiAoKGdseXBoTmFtZSA9PT0gIi5ub3RkZWYiIHx8IGdseXBoTmFtZSA9PT0gIiIpICYmIHRoaXMudHlwZSA9PT0gIlR5cGUxIikgewogICAgICAgIGZvbnRDaGFyQ29kZSA9IDB4MjA7CiAgICAgIH0KCiAgICAgIGZvbnRDaGFyQ29kZSA9ICgwLCBfdW5pY29kZS5tYXBTcGVjaWFsVW5pY29kZVZhbHVlcykoZm9udENoYXJDb2RlKTsKICAgIH0KCiAgICBpZiAodGhpcy5pc1R5cGUzRm9udCkgewogICAgICBvcGVyYXRvckxpc3RJZCA9IGZvbnRDaGFyQ29kZTsKICAgIH0KCiAgICBsZXQgYWNjZW50ID0gbnVsbDsKCiAgICBpZiAodGhpcy5zZWFjTWFwICYmIHRoaXMuc2VhY01hcFtjaGFyY29kZV0pIHsKICAgICAgaXNJbkZvbnQgPSB0cnVlOwogICAgICBjb25zdCBzZWFjID0gdGhpcy5zZWFjTWFwW2NoYXJjb2RlXTsKICAgICAgZm9udENoYXJDb2RlID0gc2VhYy5iYXNlRm9udENoYXJDb2RlOwogICAgICBhY2NlbnQgPSB7CiAgICAgICAgZm9udENoYXI6IFN0cmluZy5mcm9tQ29kZVBvaW50KHNlYWMuYWNjZW50Rm9udENoYXJDb2RlKSwKICAgICAgICBvZmZzZXQ6IHNlYWMuYWNjZW50T2Zmc2V0CiAgICAgIH07CiAgICB9CgogICAgbGV0IGZvbnRDaGFyID0gIiI7CgogICAgaWYgKHR5cGVvZiBmb250Q2hhckNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChmb250Q2hhckNvZGUgPD0gMHgxMGZmZmYpIHsKICAgICAgICBmb250Q2hhciA9IFN0cmluZy5mcm9tQ29kZVBvaW50KGZvbnRDaGFyQ29kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBjaGFyVG9HbHlwaCAtIGludmFsaWQgZm9udENoYXJDb2RlOiAke2ZvbnRDaGFyQ29kZX1gKTsKICAgICAgfQogICAgfQoKICAgIGxldCBnbHlwaCA9IHRoaXMuX2dseXBoQ2FjaGVbY2hhcmNvZGVdOwoKICAgIGlmICghZ2x5cGggfHwgIWdseXBoLm1hdGNoZXNGb3JDYWNoZShjaGFyY29kZSwgZm9udENoYXIsIHVuaWNvZGUsIGFjY2VudCwgd2lkdGgsIHZtZXRyaWMsIG9wZXJhdG9yTGlzdElkLCBpc1NwYWNlLCBpc0luRm9udCkpIHsKICAgICAgZ2x5cGggPSBuZXcgR2x5cGgoY2hhcmNvZGUsIGZvbnRDaGFyLCB1bmljb2RlLCBhY2NlbnQsIHdpZHRoLCB2bWV0cmljLCBvcGVyYXRvckxpc3RJZCwgaXNTcGFjZSwgaXNJbkZvbnQpOwogICAgICB0aGlzLl9nbHlwaENhY2hlW2NoYXJjb2RlXSA9IGdseXBoOwogICAgfQoKICAgIHJldHVybiBnbHlwaDsKICB9CgogIGNoYXJzVG9HbHlwaHMoY2hhcnMpIHsKICAgIGxldCBnbHlwaHMgPSB0aGlzLl9jaGFyc0NhY2hlW2NoYXJzXTsKCiAgICBpZiAoZ2x5cGhzKSB7CiAgICAgIHJldHVybiBnbHlwaHM7CiAgICB9CgogICAgZ2x5cGhzID0gW107CgogICAgaWYgKHRoaXMuY01hcCkgewogICAgICBjb25zdCBjID0gT2JqZWN0LmNyZWF0ZShudWxsKSwKICAgICAgICAgICAgaWkgPSBjaGFycy5sZW5ndGg7CiAgICAgIGxldCBpID0gMDsKCiAgICAgIHdoaWxlIChpIDwgaWkpIHsKICAgICAgICB0aGlzLmNNYXAucmVhZENoYXJDb2RlKGNoYXJzLCBpLCBjKTsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBjaGFyY29kZSwKICAgICAgICAgIGxlbmd0aAogICAgICAgIH0gPSBjOwogICAgICAgIGkgKz0gbGVuZ3RoOwoKICAgICAgICBjb25zdCBnbHlwaCA9IHRoaXMuX2NoYXJUb0dseXBoKGNoYXJjb2RlLCBsZW5ndGggPT09IDEgJiYgY2hhcnMuY2hhckNvZGVBdChpIC0gMSkgPT09IDB4MjApOwoKICAgICAgICBnbHlwaHMucHVzaChnbHlwaCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoYXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBjb25zdCBjaGFyY29kZSA9IGNoYXJzLmNoYXJDb2RlQXQoaSk7CgogICAgICAgIGNvbnN0IGdseXBoID0gdGhpcy5fY2hhclRvR2x5cGgoY2hhcmNvZGUsIGNoYXJjb2RlID09PSAweDIwKTsKCiAgICAgICAgZ2x5cGhzLnB1c2goZ2x5cGgpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXMuX2NoYXJzQ2FjaGVbY2hhcnNdID0gZ2x5cGhzOwogIH0KCiAgZ2V0Q2hhclBvc2l0aW9ucyhjaGFycykgewogICAgY29uc3QgcG9zaXRpb25zID0gW107CgogICAgaWYgKHRoaXMuY01hcCkgewogICAgICBjb25zdCBjID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgd2hpbGUgKGkgPCBjaGFycy5sZW5ndGgpIHsKICAgICAgICB0aGlzLmNNYXAucmVhZENoYXJDb2RlKGNoYXJzLCBpLCBjKTsKICAgICAgICBjb25zdCBsZW5ndGggPSBjLmxlbmd0aDsKICAgICAgICBwb3NpdGlvbnMucHVzaChbaSwgaSArIGxlbmd0aF0pOwogICAgICAgIGkgKz0gbGVuZ3RoOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGFycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgcG9zaXRpb25zLnB1c2goW2ksIGkgKyAxXSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcG9zaXRpb25zOwogIH0KCiAgZ2V0IGdseXBoQ2FjaGVWYWx1ZXMoKSB7CiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLl9nbHlwaENhY2hlKTsKICB9CgogIGVuY29kZVN0cmluZyhzdHIpIHsKICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTsKICAgIGNvbnN0IGN1cnJlbnRCdWYgPSBbXTsKCiAgICBjb25zdCBoYXNDdXJyZW50QnVmRXJyb3JzID0gKCkgPT4gYnVmZmVycy5sZW5ndGggJSAyID09PSAxOwoKICAgIGNvbnN0IGdldENoYXJDb2RlID0gdGhpcy50b1VuaWNvZGUgaW5zdGFuY2VvZiBfdG9fdW5pY29kZV9tYXAuSWRlbnRpdHlUb1VuaWNvZGVNYXAgPyB1bmljb2RlID0+IHRoaXMudG9Vbmljb2RlLmNoYXJDb2RlT2YodW5pY29kZSkgOiB1bmljb2RlID0+IHRoaXMudG9Vbmljb2RlLmNoYXJDb2RlT2YoU3RyaW5nLmZyb21Db2RlUG9pbnQodW5pY29kZSkpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHN0ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHVuaWNvZGUgPSBzdHIuY29kZVBvaW50QXQoaSk7CgogICAgICBpZiAodW5pY29kZSA+IDB4ZDdmZiAmJiAodW5pY29kZSA8IDB4ZTAwMCB8fCB1bmljb2RlID4gMHhmZmZkKSkgewogICAgICAgIGkrKzsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudG9Vbmljb2RlKSB7CiAgICAgICAgY29uc3QgY2hhckNvZGUgPSBnZXRDaGFyQ29kZSh1bmljb2RlKTsKCiAgICAgICAgaWYgKGNoYXJDb2RlICE9PSAtMSkgewogICAgICAgICAgaWYgKGhhc0N1cnJlbnRCdWZFcnJvcnMoKSkgewogICAgICAgICAgICBidWZmZXJzLnB1c2goY3VycmVudEJ1Zi5qb2luKCIiKSk7CiAgICAgICAgICAgIGN1cnJlbnRCdWYubGVuZ3RoID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBjaGFyQ29kZUxlbmd0aCA9IHRoaXMuY01hcCA/IHRoaXMuY01hcC5nZXRDaGFyQ29kZUxlbmd0aChjaGFyQ29kZSkgOiAxOwoKICAgICAgICAgIGZvciAobGV0IGogPSBjaGFyQ29kZUxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICAgIGN1cnJlbnRCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJDb2RlID4+IDggKiBqICYgMHhmZikpOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCFoYXNDdXJyZW50QnVmRXJyb3JzKCkpIHsKICAgICAgICBidWZmZXJzLnB1c2goY3VycmVudEJ1Zi5qb2luKCIiKSk7CiAgICAgICAgY3VycmVudEJ1Zi5sZW5ndGggPSAwOwogICAgICB9CgogICAgICBjdXJyZW50QnVmLnB1c2goU3RyaW5nLmZyb21Db2RlUG9pbnQodW5pY29kZSkpOwogICAgfQoKICAgIGJ1ZmZlcnMucHVzaChjdXJyZW50QnVmLmpvaW4oIiIpKTsKICAgIHJldHVybiBidWZmZXJzOwogIH0KCn0KCmV4cG9ydHMuRm9udCA9IEZvbnQ7CgpjbGFzcyBFcnJvckZvbnQgewogIGNvbnN0cnVjdG9yKGVycm9yKSB7CiAgICB0aGlzLmVycm9yID0gZXJyb3I7CiAgICB0aGlzLmxvYWRlZE5hbWUgPSAiZ19mb250X2Vycm9yIjsKICAgIHRoaXMubWlzc2luZ0ZpbGUgPSB0cnVlOwogIH0KCiAgY2hhcnNUb0dseXBocygpIHsKICAgIHJldHVybiBbXTsKICB9CgogIGVuY29kZVN0cmluZyhjaGFycykgewogICAgcmV0dXJuIFtjaGFyc107CiAgfQoKICBleHBvcnREYXRhKGV4dHJhUHJvcGVydGllcyA9IGZhbHNlKSB7CiAgICByZXR1cm4gewogICAgICBlcnJvcjogdGhpcy5lcnJvcgogICAgfTsKICB9Cgp9CgpleHBvcnRzLkVycm9yRm9udCA9IEVycm9yRm9udDsKCi8qKiovIH0pLAovKiAzNSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNGRlRvcERpY3QgPSBleHBvcnRzLkNGRlN0cmluZ3MgPSBleHBvcnRzLkNGRlN0YW5kYXJkU3RyaW5ncyA9IGV4cG9ydHMuQ0ZGUHJpdmF0ZURpY3QgPSBleHBvcnRzLkNGRlBhcnNlciA9IGV4cG9ydHMuQ0ZGSW5kZXggPSBleHBvcnRzLkNGRkhlYWRlciA9IGV4cG9ydHMuQ0ZGRkRTZWxlY3QgPSBleHBvcnRzLkNGRkNvbXBpbGVyID0gZXhwb3J0cy5DRkZDaGFyc2V0ID0gZXhwb3J0cy5DRkYgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jaGFyc2V0cyA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKCmNvbnN0IE1BWF9TVUJSX05FU1RJTkcgPSAxMDsKY29uc3QgQ0ZGU3RhbmRhcmRTdHJpbmdzID0gWyIubm90ZGVmIiwgInNwYWNlIiwgImV4Y2xhbSIsICJxdW90ZWRibCIsICJudW1iZXJzaWduIiwgImRvbGxhciIsICJwZXJjZW50IiwgImFtcGVyc2FuZCIsICJxdW90ZXJpZ2h0IiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJxdW90ZWxlZnQiLCAiYSIsICJiIiwgImMiLCAiZCIsICJlIiwgImYiLCAiZyIsICJoIiwgImkiLCAiaiIsICJrIiwgImwiLCAibSIsICJuIiwgIm8iLCAicCIsICJxIiwgInIiLCAicyIsICJ0IiwgInUiLCAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwgImJyYWNlbGVmdCIsICJiYXIiLCAiYnJhY2VyaWdodCIsICJhc2NpaXRpbGRlIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJmcmFjdGlvbiIsICJ5ZW4iLCAiZmxvcmluIiwgInNlY3Rpb24iLCAiY3VycmVuY3kiLCAicXVvdGVzaW5nbGUiLCAicXVvdGVkYmxsZWZ0IiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICJlbmRhc2giLCAiZGFnZ2VyIiwgImRhZ2dlcmRibCIsICJwZXJpb2RjZW50ZXJlZCIsICJwYXJhZ3JhcGgiLCAiYnVsbGV0IiwgInF1b3Rlc2luZ2xiYXNlIiwgInF1b3RlZGJsYmFzZSIsICJxdW90ZWRibHJpZ2h0IiwgImd1aWxsZW1vdHJpZ2h0IiwgImVsbGlwc2lzIiwgInBlcnRob3VzYW5kIiwgInF1ZXN0aW9uZG93biIsICJncmF2ZSIsICJhY3V0ZSIsICJjaXJjdW1mbGV4IiwgInRpbGRlIiwgIm1hY3JvbiIsICJicmV2ZSIsICJkb3RhY2NlbnQiLCAiZGllcmVzaXMiLCAicmluZyIsICJjZWRpbGxhIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iLCAiZW1kYXNoIiwgIkFFIiwgIm9yZGZlbWluaW5lIiwgIkxzbGFzaCIsICJPc2xhc2giLCAiT0UiLCAib3JkbWFzY3VsaW5lIiwgImFlIiwgImRvdGxlc3NpIiwgImxzbGFzaCIsICJvc2xhc2giLCAib2UiLCAiZ2VybWFuZGJscyIsICJvbmVzdXBlcmlvciIsICJsb2dpY2Fsbm90IiwgIm11IiwgInRyYWRlbWFyayIsICJFdGgiLCAib25laGFsZiIsICJwbHVzbWludXMiLCAiVGhvcm4iLCAib25lcXVhcnRlciIsICJkaXZpZGUiLCAiYnJva2VuYmFyIiwgImRlZ3JlZSIsICJ0aG9ybiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInR3b3N1cGVyaW9yIiwgInJlZ2lzdGVyZWQiLCAibWludXMiLCAiZXRoIiwgIm11bHRpcGx5IiwgInRocmVlc3VwZXJpb3IiLCAiY29weXJpZ2h0IiwgIkFhY3V0ZSIsICJBY2lyY3VtZmxleCIsICJBZGllcmVzaXMiLCAiQWdyYXZlIiwgIkFyaW5nIiwgIkF0aWxkZSIsICJDY2VkaWxsYSIsICJFYWN1dGUiLCAiRWNpcmN1bWZsZXgiLCAiRWRpZXJlc2lzIiwgIkVncmF2ZSIsICJJYWN1dGUiLCAiSWNpcmN1bWZsZXgiLCAiSWRpZXJlc2lzIiwgIklncmF2ZSIsICJOdGlsZGUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgIk9kaWVyZXNpcyIsICJPZ3JhdmUiLCAiT3RpbGRlIiwgIlNjYXJvbiIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWRpZXJlc2lzIiwgIlVncmF2ZSIsICJZYWN1dGUiLCAiWWRpZXJlc2lzIiwgIlpjYXJvbiIsICJhYWN1dGUiLCAiYWNpcmN1bWZsZXgiLCAiYWRpZXJlc2lzIiwgImFncmF2ZSIsICJhcmluZyIsICJhdGlsZGUiLCAiY2NlZGlsbGEiLCAiZWFjdXRlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJlZ3JhdmUiLCAiaWFjdXRlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJpZ3JhdmUiLCAibnRpbGRlIiwgIm9hY3V0ZSIsICJvY2lyY3VtZmxleCIsICJvZGllcmVzaXMiLCAib2dyYXZlIiwgIm90aWxkZSIsICJzY2Fyb24iLCAidWFjdXRlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJ1Z3JhdmUiLCAieWFjdXRlIiwgInlkaWVyZXNpcyIsICJ6Y2Fyb24iLCAiZXhjbGFtc21hbGwiLCAiSHVuZ2FydW1sYXV0c21hbGwiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAiYW1wZXJzYW5kc21hbGwiLCAiQWN1dGVzbWFsbCIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbW1hc3VwZXJpb3IiLCAidGhyZWVxdWFydGVyc2VtZGFzaCIsICJwZXJpb2RzdXBlcmlvciIsICJxdWVzdGlvbnNtYWxsIiwgImFzdXBlcmlvciIsICJic3VwZXJpb3IiLCAiY2VudHN1cGVyaW9yIiwgImRzdXBlcmlvciIsICJlc3VwZXJpb3IiLCAiaXN1cGVyaW9yIiwgImxzdXBlcmlvciIsICJtc3VwZXJpb3IiLCAibnN1cGVyaW9yIiwgIm9zdXBlcmlvciIsICJyc3VwZXJpb3IiLCAic3N1cGVyaW9yIiwgInRzdXBlcmlvciIsICJmZiIsICJmZmkiLCAiZmZsIiwgInBhcmVubGVmdGluZmVyaW9yIiwgInBhcmVucmlnaHRpbmZlcmlvciIsICJDaXJjdW1mbGV4c21hbGwiLCAiaHlwaGVuc3VwZXJpb3IiLCAiR3JhdmVzbWFsbCIsICJBc21hbGwiLCAiQnNtYWxsIiwgIkNzbWFsbCIsICJEc21hbGwiLCAiRXNtYWxsIiwgIkZzbWFsbCIsICJHc21hbGwiLCAiSHNtYWxsIiwgIklzbWFsbCIsICJKc21hbGwiLCAiS3NtYWxsIiwgIkxzbWFsbCIsICJNc21hbGwiLCAiTnNtYWxsIiwgIk9zbWFsbCIsICJQc21hbGwiLCAiUXNtYWxsIiwgIlJzbWFsbCIsICJTc21hbGwiLCAiVHNtYWxsIiwgIlVzbWFsbCIsICJWc21hbGwiLCAiV3NtYWxsIiwgIlhzbWFsbCIsICJZc21hbGwiLCAiWnNtYWxsIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJUaWxkZXNtYWxsIiwgImV4Y2xhbWRvd25zbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiTHNsYXNoc21hbGwiLCAiU2Nhcm9uc21hbGwiLCAiWmNhcm9uc21hbGwiLCAiRGllcmVzaXNzbWFsbCIsICJCcmV2ZXNtYWxsIiwgIkNhcm9uc21hbGwiLCAiRG90YWNjZW50c21hbGwiLCAiTWFjcm9uc21hbGwiLCAiZmlndXJlZGFzaCIsICJoeXBoZW5pbmZlcmlvciIsICJPZ29uZWtzbWFsbCIsICJSaW5nc21hbGwiLCAiQ2VkaWxsYXNtYWxsIiwgInF1ZXN0aW9uZG93bnNtYWxsIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICJ6ZXJvc3VwZXJpb3IiLCAiZm91cnN1cGVyaW9yIiwgImZpdmVzdXBlcmlvciIsICJzaXhzdXBlcmlvciIsICJzZXZlbnN1cGVyaW9yIiwgImVpZ2h0c3VwZXJpb3IiLCAibmluZXN1cGVyaW9yIiwgInplcm9pbmZlcmlvciIsICJvbmVpbmZlcmlvciIsICJ0d29pbmZlcmlvciIsICJ0aHJlZWluZmVyaW9yIiwgImZvdXJpbmZlcmlvciIsICJmaXZlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAic2V2ZW5pbmZlcmlvciIsICJlaWdodGluZmVyaW9yIiwgIm5pbmVpbmZlcmlvciIsICJjZW50aW5mZXJpb3IiLCAiZG9sbGFyaW5mZXJpb3IiLCAicGVyaW9kaW5mZXJpb3IiLCAiY29tbWFpbmZlcmlvciIsICJBZ3JhdmVzbWFsbCIsICJBYWN1dGVzbWFsbCIsICJBY2lyY3VtZmxleHNtYWxsIiwgIkF0aWxkZXNtYWxsIiwgIkFkaWVyZXNpc3NtYWxsIiwgIkFyaW5nc21hbGwiLCAiQUVzbWFsbCIsICJDY2VkaWxsYXNtYWxsIiwgIkVncmF2ZXNtYWxsIiwgIkVhY3V0ZXNtYWxsIiwgIkVjaXJjdW1mbGV4c21hbGwiLCAiRWRpZXJlc2lzc21hbGwiLCAiSWdyYXZlc21hbGwiLCAiSWFjdXRlc21hbGwiLCAiSWNpcmN1bWZsZXhzbWFsbCIsICJJZGllcmVzaXNzbWFsbCIsICJFdGhzbWFsbCIsICJOdGlsZGVzbWFsbCIsICJPZ3JhdmVzbWFsbCIsICJPYWN1dGVzbWFsbCIsICJPY2lyY3VtZmxleHNtYWxsIiwgIk90aWxkZXNtYWxsIiwgIk9kaWVyZXNpc3NtYWxsIiwgIk9Fc21hbGwiLCAiT3NsYXNoc21hbGwiLCAiVWdyYXZlc21hbGwiLCAiVWFjdXRlc21hbGwiLCAiVWNpcmN1bWZsZXhzbWFsbCIsICJVZGllcmVzaXNzbWFsbCIsICJZYWN1dGVzbWFsbCIsICJUaG9ybnNtYWxsIiwgIllkaWVyZXNpc3NtYWxsIiwgIjAwMS4wMDAiLCAiMDAxLjAwMSIsICIwMDEuMDAyIiwgIjAwMS4wMDMiLCAiQmxhY2siLCAiQm9sZCIsICJCb29rIiwgIkxpZ2h0IiwgIk1lZGl1bSIsICJSZWd1bGFyIiwgIlJvbWFuIiwgIlNlbWlib2xkIl07CmV4cG9ydHMuQ0ZGU3RhbmRhcmRTdHJpbmdzID0gQ0ZGU3RhbmRhcmRTdHJpbmdzOwpjb25zdCBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1MgPSAzOTE7CmNvbnN0IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YSA9IFtudWxsLCB7CiAgaWQ6ICJoc3RlbSIsCiAgbWluOiAyLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgc3RlbTogdHJ1ZQp9LCBudWxsLCB7CiAgaWQ6ICJ2c3RlbSIsCiAgbWluOiAyLAogIHN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgc3RlbTogdHJ1ZQp9LCB7CiAgaWQ6ICJ2bW92ZXRvIiwKICBtaW46IDEsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCB7CiAgaWQ6ICJybGluZXRvIiwKICBtaW46IDIsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJobGluZXRvIiwKICBtaW46IDEsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJ2bGluZXRvIiwKICBtaW46IDEsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJycmN1cnZldG8iLAogIG1pbjogNiwKICByZXNldFN0YWNrOiB0cnVlCn0sIG51bGwsIHsKICBpZDogImNhbGxzdWJyIiwKICBtaW46IDEsCiAgdW5kZWZTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJyZXR1cm4iLAogIG1pbjogMCwKICB1bmRlZlN0YWNrOiB0cnVlCn0sIG51bGwsIG51bGwsIHsKICBpZDogImVuZGNoYXIiLAogIG1pbjogMCwKICBzdGFja0NsZWFyaW5nOiB0cnVlCn0sIG51bGwsIG51bGwsIG51bGwsIHsKICBpZDogImhzdGVtaG0iLAogIG1pbjogMiwKICBzdGFja0NsZWFyaW5nOiB0cnVlLAogIHN0ZW06IHRydWUKfSwgewogIGlkOiAiaGludG1hc2siLAogIG1pbjogMCwKICBzdGFja0NsZWFyaW5nOiB0cnVlCn0sIHsKICBpZDogImNudHJtYXNrIiwKICBtaW46IDAsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCB7CiAgaWQ6ICJybW92ZXRvIiwKICBtaW46IDIsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCB7CiAgaWQ6ICJobW92ZXRvIiwKICBtaW46IDEsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZQp9LCB7CiAgaWQ6ICJ2c3RlbWhtIiwKICBtaW46IDIsCiAgc3RhY2tDbGVhcmluZzogdHJ1ZSwKICBzdGVtOiB0cnVlCn0sIHsKICBpZDogInJjdXJ2ZWxpbmUiLAogIG1pbjogOCwKICByZXNldFN0YWNrOiB0cnVlCn0sIHsKICBpZDogInJsaW5lY3VydmUiLAogIG1pbjogOCwKICByZXNldFN0YWNrOiB0cnVlCn0sIHsKICBpZDogInZ2Y3VydmV0byIsCiAgbWluOiA0LAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiaGhjdXJ2ZXRvIiwKICBtaW46IDQsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCBudWxsLCB7CiAgaWQ6ICJjYWxsZ3N1YnIiLAogIG1pbjogMSwKICB1bmRlZlN0YWNrOiB0cnVlCn0sIHsKICBpZDogInZoY3VydmV0byIsCiAgbWluOiA0LAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiaHZjdXJ2ZXRvIiwKICBtaW46IDQsCiAgcmVzZXRTdGFjazogdHJ1ZQp9XTsKY29uc3QgQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhMTIgPSBbbnVsbCwgbnVsbCwgbnVsbCwgewogIGlkOiAiYW5kIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEKfSwgewogIGlkOiAib3IiLAogIG1pbjogMiwKICBzdGFja0RlbHRhOiAtMQp9LCB7CiAgaWQ6ICJub3QiLAogIG1pbjogMSwKICBzdGFja0RlbHRhOiAwCn0sIG51bGwsIG51bGwsIG51bGwsIHsKICBpZDogImFicyIsCiAgbWluOiAxLAogIHN0YWNrRGVsdGE6IDAKfSwgewogIGlkOiAiYWRkIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEsCgogIHN0YWNrRm4oc3RhY2ssIGluZGV4KSB7CiAgICBzdGFja1tpbmRleCAtIDJdID0gc3RhY2tbaW5kZXggLSAyXSArIHN0YWNrW2luZGV4IC0gMV07CiAgfQoKfSwgewogIGlkOiAic3ViIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEsCgogIHN0YWNrRm4oc3RhY2ssIGluZGV4KSB7CiAgICBzdGFja1tpbmRleCAtIDJdID0gc3RhY2tbaW5kZXggLSAyXSAtIHN0YWNrW2luZGV4IC0gMV07CiAgfQoKfSwgewogIGlkOiAiZGl2IiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEsCgogIHN0YWNrRm4oc3RhY2ssIGluZGV4KSB7CiAgICBzdGFja1tpbmRleCAtIDJdID0gc3RhY2tbaW5kZXggLSAyXSAvIHN0YWNrW2luZGV4IC0gMV07CiAgfQoKfSwgbnVsbCwgewogIGlkOiAibmVnIiwKICBtaW46IDEsCiAgc3RhY2tEZWx0YTogMCwKCiAgc3RhY2tGbihzdGFjaywgaW5kZXgpIHsKICAgIHN0YWNrW2luZGV4IC0gMV0gPSAtc3RhY2tbaW5kZXggLSAxXTsKICB9Cgp9LCB7CiAgaWQ6ICJlcSIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IC0xCn0sIG51bGwsIG51bGwsIHsKICBpZDogImRyb3AiLAogIG1pbjogMSwKICBzdGFja0RlbHRhOiAtMQp9LCBudWxsLCB7CiAgaWQ6ICJwdXQiLAogIG1pbjogMiwKICBzdGFja0RlbHRhOiAtMgp9LCB7CiAgaWQ6ICJnZXQiLAogIG1pbjogMSwKICBzdGFja0RlbHRhOiAwCn0sIHsKICBpZDogImlmZWxzZSIsCiAgbWluOiA0LAogIHN0YWNrRGVsdGE6IC0zCn0sIHsKICBpZDogInJhbmRvbSIsCiAgbWluOiAwLAogIHN0YWNrRGVsdGE6IDEKfSwgewogIGlkOiAibXVsIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogLTEsCgogIHN0YWNrRm4oc3RhY2ssIGluZGV4KSB7CiAgICBzdGFja1tpbmRleCAtIDJdID0gc3RhY2tbaW5kZXggLSAyXSAqIHN0YWNrW2luZGV4IC0gMV07CiAgfQoKfSwgbnVsbCwgewogIGlkOiAic3FydCIsCiAgbWluOiAxLAogIHN0YWNrRGVsdGE6IDAKfSwgewogIGlkOiAiZHVwIiwKICBtaW46IDEsCiAgc3RhY2tEZWx0YTogMQp9LCB7CiAgaWQ6ICJleGNoIiwKICBtaW46IDIsCiAgc3RhY2tEZWx0YTogMAp9LCB7CiAgaWQ6ICJpbmRleCIsCiAgbWluOiAyLAogIHN0YWNrRGVsdGE6IDAKfSwgewogIGlkOiAicm9sbCIsCiAgbWluOiAzLAogIHN0YWNrRGVsdGE6IC0yCn0sIG51bGwsIG51bGwsIG51bGwsIHsKICBpZDogImhmbGV4IiwKICBtaW46IDcsCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJmbGV4IiwKICBtaW46IDEzLAogIHJlc2V0U3RhY2s6IHRydWUKfSwgewogIGlkOiAiaGZsZXgxIiwKICBtaW46IDksCiAgcmVzZXRTdGFjazogdHJ1ZQp9LCB7CiAgaWQ6ICJmbGV4MSIsCiAgbWluOiAxMSwKICByZXNldFN0YWNrOiB0cnVlCn1dOwoKY2xhc3MgQ0ZGUGFyc2VyIHsKICBjb25zdHJ1Y3RvcihmaWxlLCBwcm9wZXJ0aWVzLCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICB0aGlzLmJ5dGVzID0gZmlsZS5nZXRCeXRlcygpOwogICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllczsKICAgIHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCA9ICEhc2VhY0FuYWx5c2lzRW5hYmxlZDsKICB9CgogIHBhcnNlKCkgewogICAgY29uc3QgcHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllczsKICAgIGNvbnN0IGNmZiA9IG5ldyBDRkYoKTsKICAgIHRoaXMuY2ZmID0gY2ZmOwogICAgY29uc3QgaGVhZGVyID0gdGhpcy5wYXJzZUhlYWRlcigpOwogICAgY29uc3QgbmFtZUluZGV4ID0gdGhpcy5wYXJzZUluZGV4KGhlYWRlci5lbmRQb3MpOwogICAgY29uc3QgdG9wRGljdEluZGV4ID0gdGhpcy5wYXJzZUluZGV4KG5hbWVJbmRleC5lbmRQb3MpOwogICAgY29uc3Qgc3RyaW5nSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgodG9wRGljdEluZGV4LmVuZFBvcyk7CiAgICBjb25zdCBnbG9iYWxTdWJySW5kZXggPSB0aGlzLnBhcnNlSW5kZXgoc3RyaW5nSW5kZXguZW5kUG9zKTsKICAgIGNvbnN0IHRvcERpY3RQYXJzZWQgPSB0aGlzLnBhcnNlRGljdCh0b3BEaWN0SW5kZXgub2JqLmdldCgwKSk7CiAgICBjb25zdCB0b3BEaWN0ID0gdGhpcy5jcmVhdGVEaWN0KENGRlRvcERpY3QsIHRvcERpY3RQYXJzZWQsIGNmZi5zdHJpbmdzKTsKICAgIGNmZi5oZWFkZXIgPSBoZWFkZXIub2JqOwogICAgY2ZmLm5hbWVzID0gdGhpcy5wYXJzZU5hbWVJbmRleChuYW1lSW5kZXgub2JqKTsKICAgIGNmZi5zdHJpbmdzID0gdGhpcy5wYXJzZVN0cmluZ0luZGV4KHN0cmluZ0luZGV4Lm9iaik7CiAgICBjZmYudG9wRGljdCA9IHRvcERpY3Q7CiAgICBjZmYuZ2xvYmFsU3VickluZGV4ID0gZ2xvYmFsU3VickluZGV4Lm9iajsKICAgIHRoaXMucGFyc2VQcml2YXRlRGljdChjZmYudG9wRGljdCk7CiAgICBjZmYuaXNDSURGb250ID0gdG9wRGljdC5oYXNOYW1lKCJST1MiKTsKICAgIGNvbnN0IGNoYXJTdHJpbmdPZmZzZXQgPSB0b3BEaWN0LmdldEJ5TmFtZSgiQ2hhclN0cmluZ3MiKTsKICAgIGNvbnN0IGNoYXJTdHJpbmdJbmRleCA9IHRoaXMucGFyc2VJbmRleChjaGFyU3RyaW5nT2Zmc2V0KS5vYmo7CiAgICBjb25zdCBmb250TWF0cml4ID0gdG9wRGljdC5nZXRCeU5hbWUoIkZvbnRNYXRyaXgiKTsKCiAgICBpZiAoZm9udE1hdHJpeCkgewogICAgICBwcm9wZXJ0aWVzLmZvbnRNYXRyaXggPSBmb250TWF0cml4OwogICAgfQoKICAgIGNvbnN0IGZvbnRCQm94ID0gdG9wRGljdC5nZXRCeU5hbWUoIkZvbnRCQm94Iik7CgogICAgaWYgKGZvbnRCQm94KSB7CiAgICAgIHByb3BlcnRpZXMuYXNjZW50ID0gTWF0aC5tYXgoZm9udEJCb3hbM10sIGZvbnRCQm94WzFdKTsKICAgICAgcHJvcGVydGllcy5kZXNjZW50ID0gTWF0aC5taW4oZm9udEJCb3hbMV0sIGZvbnRCQm94WzNdKTsKICAgICAgcHJvcGVydGllcy5hc2NlbnRTY2FsZWQgPSB0cnVlOwogICAgfQoKICAgIGxldCBjaGFyc2V0LCBlbmNvZGluZzsKCiAgICBpZiAoY2ZmLmlzQ0lERm9udCkgewogICAgICBjb25zdCBmZEFycmF5SW5kZXggPSB0aGlzLnBhcnNlSW5kZXgodG9wRGljdC5nZXRCeU5hbWUoIkZEQXJyYXkiKSkub2JqOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZmRBcnJheUluZGV4LmNvdW50OyBpIDwgaWk7ICsraSkgewogICAgICAgIGNvbnN0IGRpY3RSYXcgPSBmZEFycmF5SW5kZXguZ2V0KGkpOwogICAgICAgIGNvbnN0IGZvbnREaWN0ID0gdGhpcy5jcmVhdGVEaWN0KENGRlRvcERpY3QsIHRoaXMucGFyc2VEaWN0KGRpY3RSYXcpLCBjZmYuc3RyaW5ncyk7CiAgICAgICAgdGhpcy5wYXJzZVByaXZhdGVEaWN0KGZvbnREaWN0KTsKICAgICAgICBjZmYuZmRBcnJheS5wdXNoKGZvbnREaWN0KTsKICAgICAgfQoKICAgICAgZW5jb2RpbmcgPSBudWxsOwogICAgICBjaGFyc2V0ID0gdGhpcy5wYXJzZUNoYXJzZXRzKHRvcERpY3QuZ2V0QnlOYW1lKCJjaGFyc2V0IiksIGNoYXJTdHJpbmdJbmRleC5jb3VudCwgY2ZmLnN0cmluZ3MsIHRydWUpOwogICAgICBjZmYuZmRTZWxlY3QgPSB0aGlzLnBhcnNlRkRTZWxlY3QodG9wRGljdC5nZXRCeU5hbWUoIkZEU2VsZWN0IiksIGNoYXJTdHJpbmdJbmRleC5jb3VudCk7CiAgICB9IGVsc2UgewogICAgICBjaGFyc2V0ID0gdGhpcy5wYXJzZUNoYXJzZXRzKHRvcERpY3QuZ2V0QnlOYW1lKCJjaGFyc2V0IiksIGNoYXJTdHJpbmdJbmRleC5jb3VudCwgY2ZmLnN0cmluZ3MsIGZhbHNlKTsKICAgICAgZW5jb2RpbmcgPSB0aGlzLnBhcnNlRW5jb2RpbmcodG9wRGljdC5nZXRCeU5hbWUoIkVuY29kaW5nIiksIHByb3BlcnRpZXMsIGNmZi5zdHJpbmdzLCBjaGFyc2V0LmNoYXJzZXQpOwogICAgfQoKICAgIGNmZi5jaGFyc2V0ID0gY2hhcnNldDsKICAgIGNmZi5lbmNvZGluZyA9IGVuY29kaW5nOwogICAgY29uc3QgY2hhclN0cmluZ3NBbmRTZWFjcyA9IHRoaXMucGFyc2VDaGFyU3RyaW5ncyh7CiAgICAgIGNoYXJTdHJpbmdzOiBjaGFyU3RyaW5nSW5kZXgsCiAgICAgIGxvY2FsU3VickluZGV4OiB0b3BEaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXgsCiAgICAgIGdsb2JhbFN1YnJJbmRleDogZ2xvYmFsU3VickluZGV4Lm9iaiwKICAgICAgZmRTZWxlY3Q6IGNmZi5mZFNlbGVjdCwKICAgICAgZmRBcnJheTogY2ZmLmZkQXJyYXksCiAgICAgIHByaXZhdGVEaWN0OiB0b3BEaWN0LnByaXZhdGVEaWN0CiAgICB9KTsKICAgIGNmZi5jaGFyU3RyaW5ncyA9IGNoYXJTdHJpbmdzQW5kU2VhY3MuY2hhclN0cmluZ3M7CiAgICBjZmYuc2VhY3MgPSBjaGFyU3RyaW5nc0FuZFNlYWNzLnNlYWNzOwogICAgY2ZmLndpZHRocyA9IGNoYXJTdHJpbmdzQW5kU2VhY3Mud2lkdGhzOwogICAgcmV0dXJuIGNmZjsKICB9CgogIHBhcnNlSGVhZGVyKCkgewogICAgbGV0IGJ5dGVzID0gdGhpcy5ieXRlczsKICAgIGNvbnN0IGJ5dGVzTGVuZ3RoID0gYnl0ZXMubGVuZ3RoOwogICAgbGV0IG9mZnNldCA9IDA7CgogICAgd2hpbGUgKG9mZnNldCA8IGJ5dGVzTGVuZ3RoICYmIGJ5dGVzW29mZnNldF0gIT09IDEpIHsKICAgICAgKytvZmZzZXQ7CiAgICB9CgogICAgaWYgKG9mZnNldCA+PSBieXRlc0xlbmd0aCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgQ0ZGIGhlYWRlciIpOwogICAgfQoKICAgIGlmIChvZmZzZXQgIT09IDApIHsKICAgICAgKDAsIF91dGlsLmluZm8pKCJjZmYgZGF0YSBpcyBzaGlmdGVkIik7CiAgICAgIGJ5dGVzID0gYnl0ZXMuc3ViYXJyYXkob2Zmc2V0KTsKICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwogICAgfQoKICAgIGNvbnN0IG1ham9yID0gYnl0ZXNbMF07CiAgICBjb25zdCBtaW5vciA9IGJ5dGVzWzFdOwogICAgY29uc3QgaGRyU2l6ZSA9IGJ5dGVzWzJdOwogICAgY29uc3Qgb2ZmU2l6ZSA9IGJ5dGVzWzNdOwogICAgY29uc3QgaGVhZGVyID0gbmV3IENGRkhlYWRlcihtYWpvciwgbWlub3IsIGhkclNpemUsIG9mZlNpemUpOwogICAgcmV0dXJuIHsKICAgICAgb2JqOiBoZWFkZXIsCiAgICAgIGVuZFBvczogaGRyU2l6ZQogICAgfTsKICB9CgogIHBhcnNlRGljdChkaWN0KSB7CiAgICBsZXQgcG9zID0gMDsKCiAgICBmdW5jdGlvbiBwYXJzZU9wZXJhbmQoKSB7CiAgICAgIGxldCB2YWx1ZSA9IGRpY3RbcG9zKytdOwoKICAgICAgaWYgKHZhbHVlID09PSAzMCkgewogICAgICAgIHJldHVybiBwYXJzZUZsb2F0T3BlcmFuZCgpOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAyOCkgewogICAgICAgIHZhbHVlID0gZGljdFtwb3MrK107CiAgICAgICAgdmFsdWUgPSAodmFsdWUgPDwgMjQgfCBkaWN0W3BvcysrXSA8PCAxNikgPj4gMTY7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAyOSkgewogICAgICAgIHZhbHVlID0gZGljdFtwb3MrK107CiAgICAgICAgdmFsdWUgPSB2YWx1ZSA8PCA4IHwgZGljdFtwb3MrK107CiAgICAgICAgdmFsdWUgPSB2YWx1ZSA8PCA4IHwgZGljdFtwb3MrK107CiAgICAgICAgdmFsdWUgPSB2YWx1ZSA8PCA4IHwgZGljdFtwb3MrK107CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID49IDMyICYmIHZhbHVlIDw9IDI0NikgewogICAgICAgIHJldHVybiB2YWx1ZSAtIDEzOTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAyNDcgJiYgdmFsdWUgPD0gMjUwKSB7CiAgICAgICAgcmV0dXJuICh2YWx1ZSAtIDI0NykgKiAyNTYgKyBkaWN0W3BvcysrXSArIDEwODsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAyNTEgJiYgdmFsdWUgPD0gMjU0KSB7CiAgICAgICAgcmV0dXJuIC0oKHZhbHVlIC0gMjUxKSAqIDI1NikgLSBkaWN0W3BvcysrXSAtIDEwODsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCdDRkZQYXJzZXJfcGFyc2VEaWN0OiAiJyArIHZhbHVlICsgJyIgaXMgYSByZXNlcnZlZCBjb21tYW5kLicpOwogICAgICByZXR1cm4gTmFOOwogICAgfQoKICAgIGZ1bmN0aW9uIHBhcnNlRmxvYXRPcGVyYW5kKCkgewogICAgICBsZXQgc3RyID0gIiI7CiAgICAgIGNvbnN0IGVvZiA9IDE1OwogICAgICBjb25zdCBsb29rdXAgPSBbIjAiLCAiMSIsICIyIiwgIjMiLCAiNCIsICI1IiwgIjYiLCAiNyIsICI4IiwgIjkiLCAiLiIsICJFIiwgIkUtIiwgbnVsbCwgIi0iXTsKICAgICAgY29uc3QgbGVuZ3RoID0gZGljdC5sZW5ndGg7CgogICAgICB3aGlsZSAocG9zIDwgbGVuZ3RoKSB7CiAgICAgICAgY29uc3QgYiA9IGRpY3RbcG9zKytdOwogICAgICAgIGNvbnN0IGIxID0gYiA+PiA0OwogICAgICAgIGNvbnN0IGIyID0gYiAmIDE1OwoKICAgICAgICBpZiAoYjEgPT09IGVvZikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBzdHIgKz0gbG9va3VwW2IxXTsKCiAgICAgICAgaWYgKGIyID09PSBlb2YpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgc3RyICs9IGxvb2t1cFtiMl07CiAgICAgIH0KCiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHN0cik7CiAgICB9CgogICAgbGV0IG9wZXJhbmRzID0gW107CiAgICBjb25zdCBlbnRyaWVzID0gW107CiAgICBwb3MgPSAwOwogICAgY29uc3QgZW5kID0gZGljdC5sZW5ndGg7CgogICAgd2hpbGUgKHBvcyA8IGVuZCkgewogICAgICBsZXQgYiA9IGRpY3RbcG9zXTsKCiAgICAgIGlmIChiIDw9IDIxKSB7CiAgICAgICAgaWYgKGIgPT09IDEyKSB7CiAgICAgICAgICBiID0gYiA8PCA4IHwgZGljdFsrK3Bvc107CiAgICAgICAgfQoKICAgICAgICBlbnRyaWVzLnB1c2goW2IsIG9wZXJhbmRzXSk7CiAgICAgICAgb3BlcmFuZHMgPSBbXTsKICAgICAgICArK3BvczsKICAgICAgfSBlbHNlIHsKICAgICAgICBvcGVyYW5kcy5wdXNoKHBhcnNlT3BlcmFuZCgpKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBlbnRyaWVzOwogIH0KCiAgcGFyc2VJbmRleChwb3MpIHsKICAgIGNvbnN0IGNmZkluZGV4ID0gbmV3IENGRkluZGV4KCk7CiAgICBjb25zdCBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICBjb25zdCBjb3VudCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwogICAgY29uc3Qgb2Zmc2V0cyA9IFtdOwogICAgbGV0IGVuZCA9IHBvczsKICAgIGxldCBpLCBpaTsKCiAgICBpZiAoY291bnQgIT09IDApIHsKICAgICAgY29uc3Qgb2Zmc2V0U2l6ZSA9IGJ5dGVzW3BvcysrXTsKICAgICAgY29uc3Qgc3RhcnRQb3MgPSBwb3MgKyAoY291bnQgKyAxKSAqIG9mZnNldFNpemUgLSAxOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBjb3VudCArIDE7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgbGV0IG9mZnNldCA9IDA7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgb2Zmc2V0U2l6ZTsgKytqKSB7CiAgICAgICAgICBvZmZzZXQgPDw9IDg7CiAgICAgICAgICBvZmZzZXQgKz0gYnl0ZXNbcG9zKytdOwogICAgICAgIH0KCiAgICAgICAgb2Zmc2V0cy5wdXNoKHN0YXJ0UG9zICsgb2Zmc2V0KTsKICAgICAgfQoKICAgICAgZW5kID0gb2Zmc2V0c1tjb3VudF07CiAgICB9CgogICAgZm9yIChpID0gMCwgaWkgPSBvZmZzZXRzLmxlbmd0aCAtIDE7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IG9mZnNldFN0YXJ0ID0gb2Zmc2V0c1tpXTsKICAgICAgY29uc3Qgb2Zmc2V0RW5kID0gb2Zmc2V0c1tpICsgMV07CiAgICAgIGNmZkluZGV4LmFkZChieXRlcy5zdWJhcnJheShvZmZzZXRTdGFydCwgb2Zmc2V0RW5kKSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgb2JqOiBjZmZJbmRleCwKICAgICAgZW5kUG9zOiBlbmQKICAgIH07CiAgfQoKICBwYXJzZU5hbWVJbmRleChpbmRleCkgewogICAgY29uc3QgbmFtZXMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBpbmRleC5jb3VudDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgbmFtZSA9IGluZGV4LmdldChpKTsKICAgICAgbmFtZXMucHVzaCgoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykobmFtZSkpOwogICAgfQoKICAgIHJldHVybiBuYW1lczsKICB9CgogIHBhcnNlU3RyaW5nSW5kZXgoaW5kZXgpIHsKICAgIGNvbnN0IHN0cmluZ3MgPSBuZXcgQ0ZGU3RyaW5ncygpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGluZGV4LmNvdW50OyBpIDwgaWk7ICsraSkgewogICAgICBjb25zdCBkYXRhID0gaW5kZXguZ2V0KGkpOwogICAgICBzdHJpbmdzLmFkZCgoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZGF0YSkpOwogICAgfQoKICAgIHJldHVybiBzdHJpbmdzOwogIH0KCiAgY3JlYXRlRGljdChUeXBlLCBkaWN0LCBzdHJpbmdzKSB7CiAgICBjb25zdCBjZmZEaWN0ID0gbmV3IFR5cGUoc3RyaW5ncyk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGljdC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IHBhaXIgPSBkaWN0W2ldOwogICAgICBjb25zdCBrZXkgPSBwYWlyWzBdOwogICAgICBjb25zdCB2YWx1ZSA9IHBhaXJbMV07CiAgICAgIGNmZkRpY3Quc2V0QnlLZXkoa2V5LCB2YWx1ZSk7CiAgICB9CgogICAgcmV0dXJuIGNmZkRpY3Q7CiAgfQoKICBwYXJzZUNoYXJTdHJpbmcoc3RhdGUsIGRhdGEsIGxvY2FsU3VickluZGV4LCBnbG9iYWxTdWJySW5kZXgpIHsKICAgIGlmICghZGF0YSB8fCBzdGF0ZS5jYWxsRGVwdGggPiBNQVhfU1VCUl9ORVNUSU5HKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBsZXQgc3RhY2tTaXplID0gc3RhdGUuc3RhY2tTaXplOwogICAgY29uc3Qgc3RhY2sgPSBzdGF0ZS5zdGFjazsKICAgIGNvbnN0IGxlbmd0aCA9IGRhdGEubGVuZ3RoOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGVuZ3RoOykgewogICAgICBjb25zdCB2YWx1ZSA9IGRhdGFbaisrXTsKICAgICAgbGV0IHZhbGlkYXRpb25Db21tYW5kID0gbnVsbDsKCiAgICAgIGlmICh2YWx1ZSA9PT0gMTIpIHsKICAgICAgICBjb25zdCBxID0gZGF0YVtqKytdOwoKICAgICAgICBpZiAocSA9PT0gMCkgewogICAgICAgICAgZGF0YVtqIC0gMl0gPSAxMzk7CiAgICAgICAgICBkYXRhW2ogLSAxXSA9IDIyOwogICAgICAgICAgc3RhY2tTaXplID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQgPSBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGExMltxXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDI4KSB7CiAgICAgICAgc3RhY2tbc3RhY2tTaXplXSA9IChkYXRhW2pdIDw8IDI0IHwgZGF0YVtqICsgMV0gPDwgMTYpID4+IDE2OwogICAgICAgIGogKz0gMjsKICAgICAgICBzdGFja1NpemUrKzsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMTQpIHsKICAgICAgICBpZiAoc3RhY2tTaXplID49IDQpIHsKICAgICAgICAgIHN0YWNrU2l6ZSAtPSA0OwoKICAgICAgICAgIGlmICh0aGlzLnNlYWNBbmFseXNpc0VuYWJsZWQpIHsKICAgICAgICAgICAgc3RhdGUuc2VhYyA9IHN0YWNrLnNsaWNlKHN0YWNrU2l6ZSwgc3RhY2tTaXplICsgNCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAzMiAmJiB2YWx1ZSA8PSAyNDYpIHsKICAgICAgICBzdGFja1tzdGFja1NpemVdID0gdmFsdWUgLSAxMzk7CiAgICAgICAgc3RhY2tTaXplKys7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPj0gMjQ3ICYmIHZhbHVlIDw9IDI1NCkgewogICAgICAgIHN0YWNrW3N0YWNrU2l6ZV0gPSB2YWx1ZSA8IDI1MSA/ICh2YWx1ZSAtIDI0NyA8PCA4KSArIGRhdGFbal0gKyAxMDggOiAtKHZhbHVlIC0gMjUxIDw8IDgpIC0gZGF0YVtqXSAtIDEwODsKICAgICAgICBqKys7CiAgICAgICAgc3RhY2tTaXplKys7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDI1NSkgewogICAgICAgIHN0YWNrW3N0YWNrU2l6ZV0gPSAoZGF0YVtqXSA8PCAyNCB8IGRhdGFbaiArIDFdIDw8IDE2IHwgZGF0YVtqICsgMl0gPDwgOCB8IGRhdGFbaiArIDNdKSAvIDY1NTM2OwogICAgICAgIGogKz0gNDsKICAgICAgICBzdGFja1NpemUrKzsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMTkgfHwgdmFsdWUgPT09IDIwKSB7CiAgICAgICAgc3RhdGUuaGludHMgKz0gc3RhY2tTaXplID4+IDE7CiAgICAgICAgaiArPSBzdGF0ZS5oaW50cyArIDcgPj4gMzsKICAgICAgICBzdGFja1NpemUgJT0gMjsKICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDEwIHx8IHZhbHVlID09PSAyOSkgewogICAgICAgIGxldCBzdWJyc0luZGV4OwoKICAgICAgICBpZiAodmFsdWUgPT09IDEwKSB7CiAgICAgICAgICBzdWJyc0luZGV4ID0gbG9jYWxTdWJySW5kZXg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN1YnJzSW5kZXggPSBnbG9iYWxTdWJySW5kZXg7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXN1YnJzSW5kZXgpIHsKICAgICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTWlzc2luZyBzdWJyc0luZGV4IGZvciAiICsgdmFsaWRhdGlvbkNvbW1hbmQuaWQpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgbGV0IGJpYXMgPSAzMjc2ODsKCiAgICAgICAgaWYgKHN1YnJzSW5kZXguY291bnQgPCAxMjQwKSB7CiAgICAgICAgICBiaWFzID0gMTA3OwogICAgICAgIH0gZWxzZSBpZiAoc3VicnNJbmRleC5jb3VudCA8IDMzOTAwKSB7CiAgICAgICAgICBiaWFzID0gMTEzMTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHN1YnJOdW1iZXIgPSBzdGFja1stLXN0YWNrU2l6ZV0gKyBiaWFzOwoKICAgICAgICBpZiAoc3Vick51bWJlciA8IDAgfHwgc3Vick51bWJlciA+PSBzdWJyc0luZGV4LmNvdW50IHx8IGlzTmFOKHN1YnJOdW1iZXIpKSB7CiAgICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIk91dCBvZiBib3VuZHMgc3VickluZGV4IGZvciAiICsgdmFsaWRhdGlvbkNvbW1hbmQuaWQpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgc3RhdGUuc3RhY2tTaXplID0gc3RhY2tTaXplOwogICAgICAgIHN0YXRlLmNhbGxEZXB0aCsrOwogICAgICAgIGNvbnN0IHZhbGlkID0gdGhpcy5wYXJzZUNoYXJTdHJpbmcoc3RhdGUsIHN1YnJzSW5kZXguZ2V0KHN1YnJOdW1iZXIpLCBsb2NhbFN1YnJJbmRleCwgZ2xvYmFsU3VickluZGV4KTsKCiAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgc3RhdGUuY2FsbERlcHRoLS07CiAgICAgICAgc3RhY2tTaXplID0gc3RhdGUuc3RhY2tTaXplOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAxMSkgewogICAgICAgIHN0YXRlLnN0YWNrU2l6ZSA9IHN0YWNrU2l6ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMCAmJiBqID09PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGRhdGFbaiAtIDFdID0gMTQ7CiAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQgPSBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGFbMTRdOwogICAgICB9IGVsc2UgewogICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgfQoKICAgICAgaWYgKHZhbGlkYXRpb25Db21tYW5kKSB7CiAgICAgICAgaWYgKHZhbGlkYXRpb25Db21tYW5kLnN0ZW0pIHsKICAgICAgICAgIHN0YXRlLmhpbnRzICs9IHN0YWNrU2l6ZSA+PiAxOwoKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMyB8fCB2YWx1ZSA9PT0gMjMpIHsKICAgICAgICAgICAgc3RhdGUuaGFzVlN0ZW1zID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUuaGFzVlN0ZW1zICYmICh2YWx1ZSA9PT0gMSB8fCB2YWx1ZSA9PT0gMTgpKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiQ0ZGIHN0ZW0gaGludHMgYXJlIGluIHdyb25nIG9yZGVyIik7CiAgICAgICAgICAgIGRhdGFbaiAtIDFdID0gdmFsdWUgPT09IDEgPyAzIDogMjM7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIm1pbiIgaW4gdmFsaWRhdGlvbkNvbW1hbmQpIHsKICAgICAgICAgIGlmICghc3RhdGUudW5kZWZTdGFjayAmJiBzdGFja1NpemUgPCB2YWxpZGF0aW9uQ29tbWFuZC5taW4pIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJOb3QgZW5vdWdoIHBhcmFtZXRlcnMgZm9yICIgKyB2YWxpZGF0aW9uQ29tbWFuZC5pZCArICI7IGFjdHVhbDogIiArIHN0YWNrU2l6ZSArICIsIGV4cGVjdGVkOiAiICsgdmFsaWRhdGlvbkNvbW1hbmQubWluKTsKCiAgICAgICAgICAgIGlmIChzdGFja1NpemUgPT09IDApIHsKICAgICAgICAgICAgICBkYXRhW2ogLSAxXSA9IDE0OwogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUuZmlyc3RTdGFja0NsZWFyaW5nICYmIHZhbGlkYXRpb25Db21tYW5kLnN0YWNrQ2xlYXJpbmcpIHsKICAgICAgICAgIHN0YXRlLmZpcnN0U3RhY2tDbGVhcmluZyA9IGZhbHNlOwogICAgICAgICAgc3RhY2tTaXplIC09IHZhbGlkYXRpb25Db21tYW5kLm1pbjsKCiAgICAgICAgICBpZiAoc3RhY2tTaXplID49IDIgJiYgdmFsaWRhdGlvbkNvbW1hbmQuc3RlbSkgewogICAgICAgICAgICBzdGFja1NpemUgJT0gMjsKICAgICAgICAgIH0gZWxzZSBpZiAoc3RhY2tTaXplID4gMSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkZvdW5kIHRvbyBtYW55IHBhcmFtZXRlcnMgZm9yIHN0YWNrLWNsZWFyaW5nIGNvbW1hbmQiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoc3RhY2tTaXplID4gMCkgewogICAgICAgICAgICBzdGF0ZS53aWR0aCA9IHN0YWNrW3N0YWNrU2l6ZSAtIDFdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCJzdGFja0RlbHRhIiBpbiB2YWxpZGF0aW9uQ29tbWFuZCkgewogICAgICAgICAgaWYgKCJzdGFja0ZuIiBpbiB2YWxpZGF0aW9uQ29tbWFuZCkgewogICAgICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZC5zdGFja0ZuKHN0YWNrLCBzdGFja1NpemUpOwogICAgICAgICAgfQoKICAgICAgICAgIHN0YWNrU2l6ZSArPSB2YWxpZGF0aW9uQ29tbWFuZC5zdGFja0RlbHRhOwogICAgICAgIH0gZWxzZSBpZiAodmFsaWRhdGlvbkNvbW1hbmQuc3RhY2tDbGVhcmluZykgewogICAgICAgICAgc3RhY2tTaXplID0gMDsKICAgICAgICB9IGVsc2UgaWYgKHZhbGlkYXRpb25Db21tYW5kLnJlc2V0U3RhY2spIHsKICAgICAgICAgIHN0YWNrU2l6ZSA9IDA7CiAgICAgICAgICBzdGF0ZS51bmRlZlN0YWNrID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmICh2YWxpZGF0aW9uQ29tbWFuZC51bmRlZlN0YWNrKSB7CiAgICAgICAgICBzdGFja1NpemUgPSAwOwogICAgICAgICAgc3RhdGUudW5kZWZTdGFjayA9IHRydWU7CiAgICAgICAgICBzdGF0ZS5maXJzdFN0YWNrQ2xlYXJpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzdGF0ZS5zdGFja1NpemUgPSBzdGFja1NpemU7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHBhcnNlQ2hhclN0cmluZ3MoewogICAgY2hhclN0cmluZ3MsCiAgICBsb2NhbFN1YnJJbmRleCwKICAgIGdsb2JhbFN1YnJJbmRleCwKICAgIGZkU2VsZWN0LAogICAgZmRBcnJheSwKICAgIHByaXZhdGVEaWN0CiAgfSkgewogICAgY29uc3Qgc2VhY3MgPSBbXTsKICAgIGNvbnN0IHdpZHRocyA9IFtdOwogICAgY29uc3QgY291bnQgPSBjaGFyU3RyaW5ncy5jb3VudDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgY2hhcnN0cmluZyA9IGNoYXJTdHJpbmdzLmdldChpKTsKICAgICAgY29uc3Qgc3RhdGUgPSB7CiAgICAgICAgY2FsbERlcHRoOiAwLAogICAgICAgIHN0YWNrU2l6ZTogMCwKICAgICAgICBzdGFjazogW10sCiAgICAgICAgdW5kZWZTdGFjazogdHJ1ZSwKICAgICAgICBoaW50czogMCwKICAgICAgICBmaXJzdFN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgICAgICAgc2VhYzogbnVsbCwKICAgICAgICB3aWR0aDogbnVsbCwKICAgICAgICBoYXNWU3RlbXM6IGZhbHNlCiAgICAgIH07CiAgICAgIGxldCB2YWxpZCA9IHRydWU7CiAgICAgIGxldCBsb2NhbFN1YnJUb1VzZSA9IG51bGw7CiAgICAgIGxldCBwcml2YXRlRGljdFRvVXNlID0gcHJpdmF0ZURpY3Q7CgogICAgICBpZiAoZmRTZWxlY3QgJiYgZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBmZEluZGV4ID0gZmRTZWxlY3QuZ2V0RkRJbmRleChpKTsKCiAgICAgICAgaWYgKGZkSW5kZXggPT09IC0xKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkdseXBoIGluZGV4IGlzIG5vdCBpbiBmZCBzZWxlY3QuIik7CiAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZkSW5kZXggPj0gZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBmZCBpbmRleCBmb3IgZ2x5cGggaW5kZXguIik7CiAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBwcml2YXRlRGljdFRvVXNlID0gZmRBcnJheVtmZEluZGV4XS5wcml2YXRlRGljdDsKICAgICAgICAgIGxvY2FsU3ViclRvVXNlID0gcHJpdmF0ZURpY3RUb1VzZS5zdWJyc0luZGV4OwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChsb2NhbFN1YnJJbmRleCkgewogICAgICAgIGxvY2FsU3ViclRvVXNlID0gbG9jYWxTdWJySW5kZXg7CiAgICAgIH0KCiAgICAgIGlmICh2YWxpZCkgewogICAgICAgIHZhbGlkID0gdGhpcy5wYXJzZUNoYXJTdHJpbmcoc3RhdGUsIGNoYXJzdHJpbmcsIGxvY2FsU3ViclRvVXNlLCBnbG9iYWxTdWJySW5kZXgpOwogICAgICB9CgogICAgICBpZiAoc3RhdGUud2lkdGggIT09IG51bGwpIHsKICAgICAgICBjb25zdCBub21pbmFsV2lkdGggPSBwcml2YXRlRGljdFRvVXNlLmdldEJ5TmFtZSgibm9taW5hbFdpZHRoWCIpOwogICAgICAgIHdpZHRoc1tpXSA9IG5vbWluYWxXaWR0aCArIHN0YXRlLndpZHRoOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGRlZmF1bHRXaWR0aCA9IHByaXZhdGVEaWN0VG9Vc2UuZ2V0QnlOYW1lKCJkZWZhdWx0V2lkdGhYIik7CiAgICAgICAgd2lkdGhzW2ldID0gZGVmYXVsdFdpZHRoOwogICAgICB9CgogICAgICBpZiAoc3RhdGUuc2VhYyAhPT0gbnVsbCkgewogICAgICAgIHNlYWNzW2ldID0gc3RhdGUuc2VhYzsKICAgICAgfQoKICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgIGNoYXJTdHJpbmdzLnNldChpLCBuZXcgVWludDhBcnJheShbMTRdKSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBjaGFyU3RyaW5ncywKICAgICAgc2VhY3MsCiAgICAgIHdpZHRocwogICAgfTsKICB9CgogIGVtcHR5UHJpdmF0ZURpY3Rpb25hcnkocGFyZW50RGljdCkgewogICAgY29uc3QgcHJpdmF0ZURpY3QgPSB0aGlzLmNyZWF0ZURpY3QoQ0ZGUHJpdmF0ZURpY3QsIFtdLCBwYXJlbnREaWN0LnN0cmluZ3MpOwogICAgcGFyZW50RGljdC5zZXRCeUtleSgxOCwgWzAsIDBdKTsKICAgIHBhcmVudERpY3QucHJpdmF0ZURpY3QgPSBwcml2YXRlRGljdDsKICB9CgogIHBhcnNlUHJpdmF0ZURpY3QocGFyZW50RGljdCkgewogICAgaWYgKCFwYXJlbnREaWN0Lmhhc05hbWUoIlByaXZhdGUiKSkgewogICAgICB0aGlzLmVtcHR5UHJpdmF0ZURpY3Rpb25hcnkocGFyZW50RGljdCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwcml2YXRlT2Zmc2V0ID0gcGFyZW50RGljdC5nZXRCeU5hbWUoIlByaXZhdGUiKTsKCiAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJpdmF0ZU9mZnNldCkgfHwgcHJpdmF0ZU9mZnNldC5sZW5ndGggIT09IDIpIHsKICAgICAgcGFyZW50RGljdC5yZW1vdmVCeU5hbWUoIlByaXZhdGUiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHNpemUgPSBwcml2YXRlT2Zmc2V0WzBdOwogICAgY29uc3Qgb2Zmc2V0ID0gcHJpdmF0ZU9mZnNldFsxXTsKCiAgICBpZiAoc2l6ZSA9PT0gMCB8fCBvZmZzZXQgPj0gdGhpcy5ieXRlcy5sZW5ndGgpIHsKICAgICAgdGhpcy5lbXB0eVByaXZhdGVEaWN0aW9uYXJ5KHBhcmVudERpY3QpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcHJpdmF0ZURpY3RFbmQgPSBvZmZzZXQgKyBzaXplOwogICAgY29uc3QgZGljdERhdGEgPSB0aGlzLmJ5dGVzLnN1YmFycmF5KG9mZnNldCwgcHJpdmF0ZURpY3RFbmQpOwogICAgY29uc3QgZGljdCA9IHRoaXMucGFyc2VEaWN0KGRpY3REYXRhKTsKICAgIGNvbnN0IHByaXZhdGVEaWN0ID0gdGhpcy5jcmVhdGVEaWN0KENGRlByaXZhdGVEaWN0LCBkaWN0LCBwYXJlbnREaWN0LnN0cmluZ3MpOwogICAgcGFyZW50RGljdC5wcml2YXRlRGljdCA9IHByaXZhdGVEaWN0OwoKICAgIGlmICghcHJpdmF0ZURpY3QuZ2V0QnlOYW1lKCJTdWJycyIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzdWJyc09mZnNldCA9IHByaXZhdGVEaWN0LmdldEJ5TmFtZSgiU3VicnMiKTsKICAgIGNvbnN0IHJlbGF0aXZlT2Zmc2V0ID0gb2Zmc2V0ICsgc3VicnNPZmZzZXQ7CgogICAgaWYgKHN1YnJzT2Zmc2V0ID09PSAwIHx8IHJlbGF0aXZlT2Zmc2V0ID49IHRoaXMuYnl0ZXMubGVuZ3RoKSB7CiAgICAgIHRoaXMuZW1wdHlQcml2YXRlRGljdGlvbmFyeShwYXJlbnREaWN0KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHN1YnJzSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgocmVsYXRpdmVPZmZzZXQpOwogICAgcHJpdmF0ZURpY3Quc3VicnNJbmRleCA9IHN1YnJzSW5kZXgub2JqOwogIH0KCiAgcGFyc2VDaGFyc2V0cyhwb3MsIGxlbmd0aCwgc3RyaW5ncywgY2lkKSB7CiAgICBpZiAocG9zID09PSAwKSB7CiAgICAgIHJldHVybiBuZXcgQ0ZGQ2hhcnNldCh0cnVlLCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzLklTT19BRE9CRSwgX2NoYXJzZXRzLklTT0Fkb2JlQ2hhcnNldCk7CiAgICB9IGVsc2UgaWYgKHBvcyA9PT0gMSkgewogICAgICByZXR1cm4gbmV3IENGRkNoYXJzZXQodHJ1ZSwgQ0ZGQ2hhcnNldFByZWRlZmluZWRUeXBlcy5FWFBFUlQsIF9jaGFyc2V0cy5FeHBlcnRDaGFyc2V0KTsKICAgIH0gZWxzZSBpZiAocG9zID09PSAyKSB7CiAgICAgIHJldHVybiBuZXcgQ0ZGQ2hhcnNldCh0cnVlLCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzLkVYUEVSVF9TVUJTRVQsIF9jaGFyc2V0cy5FeHBlcnRTdWJzZXRDaGFyc2V0KTsKICAgIH0KCiAgICBjb25zdCBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICBjb25zdCBzdGFydCA9IHBvczsKICAgIGNvbnN0IGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKICAgIGNvbnN0IGNoYXJzZXQgPSBbY2lkID8gMCA6ICIubm90ZGVmIl07CiAgICBsZXQgaWQsIGNvdW50LCBpOwogICAgbGVuZ3RoIC09IDE7CgogICAgc3dpdGNoIChmb3JtYXQpIHsKICAgICAgY2FzZSAwOgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCA6IHN0cmluZ3MuZ2V0KGlkKSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMToKICAgICAgICB3aGlsZSAoY2hhcnNldC5sZW5ndGggPD0gbGVuZ3RoKSB7CiAgICAgICAgICBpZCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwogICAgICAgICAgY291bnQgPSBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDI6CiAgICAgICAgd2hpbGUgKGNoYXJzZXQubGVuZ3RoIDw9IGxlbmd0aCkgewogICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGNvdW50ID0gYnl0ZXNbcG9zKytdIDw8IDggfCBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjaGFyc2V0IGZvcm1hdCIpOwogICAgfQoKICAgIGNvbnN0IGVuZCA9IHBvczsKICAgIGNvbnN0IHJhdyA9IGJ5dGVzLnN1YmFycmF5KHN0YXJ0LCBlbmQpOwogICAgcmV0dXJuIG5ldyBDRkZDaGFyc2V0KGZhbHNlLCBmb3JtYXQsIGNoYXJzZXQsIHJhdyk7CiAgfQoKICBwYXJzZUVuY29kaW5nKHBvcywgcHJvcGVydGllcywgc3RyaW5ncywgY2hhcnNldCkgewogICAgY29uc3QgZW5jb2RpbmcgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgY29uc3QgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgbGV0IHByZWRlZmluZWQgPSBmYWxzZTsKICAgIGxldCBmb3JtYXQsIGksIGlpOwogICAgbGV0IHJhdyA9IG51bGw7CgogICAgZnVuY3Rpb24gcmVhZFN1cHBsZW1lbnQoKSB7CiAgICAgIGNvbnN0IHN1cHBsZW1lbnRzQ291bnQgPSBieXRlc1twb3MrK107CgogICAgICBmb3IgKGkgPSAwOyBpIDwgc3VwcGxlbWVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgY29uc3QgY29kZSA9IGJ5dGVzW3BvcysrXTsKICAgICAgICBjb25zdCBzaWQgPSAoYnl0ZXNbcG9zKytdIDw8IDgpICsgKGJ5dGVzW3BvcysrXSAmIDB4ZmYpOwogICAgICAgIGVuY29kaW5nW2NvZGVdID0gY2hhcnNldC5pbmRleE9mKHN0cmluZ3MuZ2V0KHNpZCkpOwogICAgICB9CiAgICB9CgogICAgaWYgKHBvcyA9PT0gMCB8fCBwb3MgPT09IDEpIHsKICAgICAgcHJlZGVmaW5lZCA9IHRydWU7CiAgICAgIGZvcm1hdCA9IHBvczsKICAgICAgY29uc3QgYmFzZUVuY29kaW5nID0gcG9zID8gX2VuY29kaW5ncy5FeHBlcnRFbmNvZGluZyA6IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZzsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hhcnNldC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29uc3QgaW5kZXggPSBiYXNlRW5jb2RpbmcuaW5kZXhPZihjaGFyc2V0W2ldKTsKCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgZW5jb2RpbmdbaW5kZXhdID0gaTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGRhdGFTdGFydCA9IHBvczsKICAgICAgZm9ybWF0ID0gYnl0ZXNbcG9zKytdOwoKICAgICAgc3dpdGNoIChmb3JtYXQgJiAweDdmKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgY29uc3QgZ2x5cGhzQ291bnQgPSBieXRlc1twb3MrK107CgogICAgICAgICAgZm9yIChpID0gMTsgaSA8PSBnbHlwaHNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGVuY29kaW5nW2J5dGVzW3BvcysrXV0gPSBpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjb25zdCByYW5nZXNDb3VudCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGxldCBnaWQgPSAxOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCByYW5nZXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgICBjb25zdCBsZWZ0ID0gYnl0ZXNbcG9zKytdOwoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0OyBqIDw9IHN0YXJ0ICsgbGVmdDsgaisrKSB7CiAgICAgICAgICAgICAgZW5jb2Rpbmdbal0gPSBnaWQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbmtub3duIGVuY29kaW5nIGZvcm1hdDogJHtmb3JtYXR9IGluIENGRmApOwogICAgICB9CgogICAgICBjb25zdCBkYXRhRW5kID0gcG9zOwoKICAgICAgaWYgKGZvcm1hdCAmIDB4ODApIHsKICAgICAgICBieXRlc1tkYXRhU3RhcnRdICY9IDB4N2Y7CiAgICAgICAgcmVhZFN1cHBsZW1lbnQoKTsKICAgICAgfQoKICAgICAgcmF3ID0gYnl0ZXMuc3ViYXJyYXkoZGF0YVN0YXJ0LCBkYXRhRW5kKTsKICAgIH0KCiAgICBmb3JtYXQgJj0gMHg3ZjsKICAgIHJldHVybiBuZXcgQ0ZGRW5jb2RpbmcocHJlZGVmaW5lZCwgZm9ybWF0LCBlbmNvZGluZywgcmF3KTsKICB9CgogIHBhcnNlRkRTZWxlY3QocG9zLCBsZW5ndGgpIHsKICAgIGNvbnN0IGJ5dGVzID0gdGhpcy5ieXRlczsKICAgIGNvbnN0IGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKICAgIGNvbnN0IGZkU2VsZWN0ID0gW107CiAgICBsZXQgaTsKCiAgICBzd2l0Y2ggKGZvcm1hdCkgewogICAgICBjYXNlIDA6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICBjb25zdCBpZCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIGZkU2VsZWN0LnB1c2goaWQpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgY29uc3QgcmFuZ2VzQ291bnQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJhbmdlc0NvdW50OyArK2kpIHsKICAgICAgICAgIGxldCBmaXJzdCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwoKICAgICAgICAgIGlmIChpID09PSAwICYmIGZpcnN0ICE9PSAwKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VGRFNlbGVjdDogVGhlIGZpcnN0IHJhbmdlIG11c3QgaGF2ZSBhIGZpcnN0IEdJRCBvZiAwIiArICIgLS0gdHJ5aW5nIHRvIHJlY292ZXIuIik7CiAgICAgICAgICAgIGZpcnN0ID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBmZEluZGV4ID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgY29uc3QgbmV4dCA9IGJ5dGVzW3Bvc10gPDwgOCB8IGJ5dGVzW3BvcyArIDFdOwoKICAgICAgICAgIGZvciAobGV0IGogPSBmaXJzdDsgaiA8IG5leHQ7ICsraikgewogICAgICAgICAgICBmZFNlbGVjdC5wdXNoKGZkSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcG9zICs9IDI7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgcGFyc2VGRFNlbGVjdDogVW5rbm93biBmb3JtYXQgIiR7Zm9ybWF0fSIuYCk7CiAgICB9CgogICAgaWYgKGZkU2VsZWN0Lmxlbmd0aCAhPT0gbGVuZ3RoKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigicGFyc2VGRFNlbGVjdDogSW52YWxpZCBmb250IGRhdGEuIik7CiAgICB9CgogICAgcmV0dXJuIG5ldyBDRkZGRFNlbGVjdChmb3JtYXQsIGZkU2VsZWN0KTsKICB9Cgp9CgpleHBvcnRzLkNGRlBhcnNlciA9IENGRlBhcnNlcjsKCmNsYXNzIENGRiB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmhlYWRlciA9IG51bGw7CiAgICB0aGlzLm5hbWVzID0gW107CiAgICB0aGlzLnRvcERpY3QgPSBudWxsOwogICAgdGhpcy5zdHJpbmdzID0gbmV3IENGRlN0cmluZ3MoKTsKICAgIHRoaXMuZ2xvYmFsU3VickluZGV4ID0gbnVsbDsKICAgIHRoaXMuZW5jb2RpbmcgPSBudWxsOwogICAgdGhpcy5jaGFyc2V0ID0gbnVsbDsKICAgIHRoaXMuY2hhclN0cmluZ3MgPSBudWxsOwogICAgdGhpcy5mZEFycmF5ID0gW107CiAgICB0aGlzLmZkU2VsZWN0ID0gbnVsbDsKICAgIHRoaXMuaXNDSURGb250ID0gZmFsc2U7CiAgfQoKICBkdXBsaWNhdGVGaXJzdEdseXBoKCkgewogICAgaWYgKHRoaXMuY2hhclN0cmluZ3MuY291bnQgPj0gNjU1MzUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJOb3QgZW5vdWdoIHNwYWNlIGluIGNoYXJzdHJpbmdzIHRvIGR1cGxpY2F0ZSBmaXJzdCBnbHlwaC4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGdseXBoWmVybyA9IHRoaXMuY2hhclN0cmluZ3MuZ2V0KDApOwogICAgdGhpcy5jaGFyU3RyaW5ncy5hZGQoZ2x5cGhaZXJvKTsKCiAgICBpZiAodGhpcy5pc0NJREZvbnQpIHsKICAgICAgdGhpcy5mZFNlbGVjdC5mZFNlbGVjdC5wdXNoKHRoaXMuZmRTZWxlY3QuZmRTZWxlY3RbMF0pOwogICAgfQogIH0KCiAgaGFzR2x5cGhJZChpZCkgewogICAgaWYgKGlkIDwgMCB8fCBpZCA+PSB0aGlzLmNoYXJTdHJpbmdzLmNvdW50KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjb25zdCBnbHlwaCA9IHRoaXMuY2hhclN0cmluZ3MuZ2V0KGlkKTsKICAgIHJldHVybiBnbHlwaC5sZW5ndGggPiAwOwogIH0KCn0KCmV4cG9ydHMuQ0ZGID0gQ0ZGOwoKY2xhc3MgQ0ZGSGVhZGVyIHsKICBjb25zdHJ1Y3RvcihtYWpvciwgbWlub3IsIGhkclNpemUsIG9mZlNpemUpIHsKICAgIHRoaXMubWFqb3IgPSBtYWpvcjsKICAgIHRoaXMubWlub3IgPSBtaW5vcjsKICAgIHRoaXMuaGRyU2l6ZSA9IGhkclNpemU7CiAgICB0aGlzLm9mZlNpemUgPSBvZmZTaXplOwogIH0KCn0KCmV4cG9ydHMuQ0ZGSGVhZGVyID0gQ0ZGSGVhZGVyOwoKY2xhc3MgQ0ZGU3RyaW5ncyB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLnN0cmluZ3MgPSBbXTsKICB9CgogIGdldChpbmRleCkgewogICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPD0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTIC0gMSkgewogICAgICByZXR1cm4gQ0ZGU3RhbmRhcmRTdHJpbmdzW2luZGV4XTsKICAgIH0KCiAgICBpZiAoaW5kZXggLSBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1MgPD0gdGhpcy5zdHJpbmdzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5zdHJpbmdzW2luZGV4IC0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTXTsKICAgIH0KCiAgICByZXR1cm4gQ0ZGU3RhbmRhcmRTdHJpbmdzWzBdOwogIH0KCiAgZ2V0U0lEKHN0cikgewogICAgbGV0IGluZGV4ID0gQ0ZGU3RhbmRhcmRTdHJpbmdzLmluZGV4T2Yoc3RyKTsKCiAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgIHJldHVybiBpbmRleDsKICAgIH0KCiAgICBpbmRleCA9IHRoaXMuc3RyaW5ncy5pbmRleE9mKHN0cik7CgogICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICByZXR1cm4gaW5kZXggKyBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1M7CiAgICB9CgogICAgcmV0dXJuIC0xOwogIH0KCiAgYWRkKHZhbHVlKSB7CiAgICB0aGlzLnN0cmluZ3MucHVzaCh2YWx1ZSk7CiAgfQoKICBnZXQgY291bnQoKSB7CiAgICByZXR1cm4gdGhpcy5zdHJpbmdzLmxlbmd0aDsKICB9Cgp9CgpleHBvcnRzLkNGRlN0cmluZ3MgPSBDRkZTdHJpbmdzOwoKY2xhc3MgQ0ZGSW5kZXggewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5vYmplY3RzID0gW107CiAgICB0aGlzLmxlbmd0aCA9IDA7CiAgfQoKICBhZGQoZGF0YSkgewogICAgdGhpcy5sZW5ndGggKz0gZGF0YS5sZW5ndGg7CiAgICB0aGlzLm9iamVjdHMucHVzaChkYXRhKTsKICB9CgogIHNldChpbmRleCwgZGF0YSkgewogICAgdGhpcy5sZW5ndGggKz0gZGF0YS5sZW5ndGggLSB0aGlzLm9iamVjdHNbaW5kZXhdLmxlbmd0aDsKICAgIHRoaXMub2JqZWN0c1tpbmRleF0gPSBkYXRhOwogIH0KCiAgZ2V0KGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5vYmplY3RzW2luZGV4XTsKICB9CgogIGdldCBjb3VudCgpIHsKICAgIHJldHVybiB0aGlzLm9iamVjdHMubGVuZ3RoOwogIH0KCn0KCmV4cG9ydHMuQ0ZGSW5kZXggPSBDRkZJbmRleDsKCmNsYXNzIENGRkRpY3QgewogIGNvbnN0cnVjdG9yKHRhYmxlcywgc3RyaW5ncykgewogICAgdGhpcy5rZXlUb05hbWVNYXAgPSB0YWJsZXMua2V5VG9OYW1lTWFwOwogICAgdGhpcy5uYW1lVG9LZXlNYXAgPSB0YWJsZXMubmFtZVRvS2V5TWFwOwogICAgdGhpcy5kZWZhdWx0cyA9IHRhYmxlcy5kZWZhdWx0czsKICAgIHRoaXMudHlwZXMgPSB0YWJsZXMudHlwZXM7CiAgICB0aGlzLm9wY29kZXMgPSB0YWJsZXMub3Bjb2RlczsKICAgIHRoaXMub3JkZXIgPSB0YWJsZXMub3JkZXI7CiAgICB0aGlzLnN0cmluZ3MgPSBzdHJpbmdzOwogICAgdGhpcy52YWx1ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgc2V0QnlLZXkoa2V5LCB2YWx1ZSkgewogICAgaWYgKCEoa2V5IGluIHRoaXMua2V5VG9OYW1lTWFwKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgY29uc3QgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7CgogICAgaWYgKHZhbHVlTGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWVMZW5ndGg7IGkrKykgewogICAgICBpZiAoaXNOYU4odmFsdWVbaV0pKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdJbnZhbGlkIENGRkRpY3QgdmFsdWU6ICInICsgdmFsdWUgKyAnIiBmb3Iga2V5ICInICsga2V5ICsgJyIuJyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB0eXBlID0gdGhpcy50eXBlc1trZXldOwoKICAgIGlmICh0eXBlID09PSAibnVtIiB8fCB0eXBlID09PSAic2lkIiB8fCB0eXBlID09PSAib2Zmc2V0IikgewogICAgICB2YWx1ZSA9IHZhbHVlWzBdOwogICAgfQoKICAgIHRoaXMudmFsdWVzW2tleV0gPSB2YWx1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgc2V0QnlOYW1lKG5hbWUsIHZhbHVlKSB7CiAgICBpZiAoIShuYW1lIGluIHRoaXMubmFtZVRvS2V5TWFwKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZGljdGlvbmFyeSBuYW1lICIke25hbWV9ImApOwogICAgfQoKICAgIHRoaXMudmFsdWVzW3RoaXMubmFtZVRvS2V5TWFwW25hbWVdXSA9IHZhbHVlOwogIH0KCiAgaGFzTmFtZShuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV0gaW4gdGhpcy52YWx1ZXM7CiAgfQoKICBnZXRCeU5hbWUobmFtZSkgewogICAgaWYgKCEobmFtZSBpbiB0aGlzLm5hbWVUb0tleU1hcCkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBJbnZhbGlkIGRpY3Rpb25hcnkgbmFtZSAke25hbWV9ImApOwogICAgfQoKICAgIGNvbnN0IGtleSA9IHRoaXMubmFtZVRvS2V5TWFwW25hbWVdOwoKICAgIGlmICghKGtleSBpbiB0aGlzLnZhbHVlcykpIHsKICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdHNba2V5XTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy52YWx1ZXNba2V5XTsKICB9CgogIHJlbW92ZUJ5TmFtZShuYW1lKSB7CiAgICBkZWxldGUgdGhpcy52YWx1ZXNbdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV1dOwogIH0KCiAgc3RhdGljIGNyZWF0ZVRhYmxlcyhsYXlvdXQpIHsKICAgIGNvbnN0IHRhYmxlcyA9IHsKICAgICAga2V5VG9OYW1lTWFwOiB7fSwKICAgICAgbmFtZVRvS2V5TWFwOiB7fSwKICAgICAgZGVmYXVsdHM6IHt9LAogICAgICB0eXBlczoge30sCiAgICAgIG9wY29kZXM6IHt9LAogICAgICBvcmRlcjogW10KICAgIH07CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gbGF5b3V0Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgZW50cnkgPSBsYXlvdXRbaV07CiAgICAgIGNvbnN0IGtleSA9IEFycmF5LmlzQXJyYXkoZW50cnlbMF0pID8gKGVudHJ5WzBdWzBdIDw8IDgpICsgZW50cnlbMF1bMV0gOiBlbnRyeVswXTsKICAgICAgdGFibGVzLmtleVRvTmFtZU1hcFtrZXldID0gZW50cnlbMV07CiAgICAgIHRhYmxlcy5uYW1lVG9LZXlNYXBbZW50cnlbMV1dID0ga2V5OwogICAgICB0YWJsZXMudHlwZXNba2V5XSA9IGVudHJ5WzJdOwogICAgICB0YWJsZXMuZGVmYXVsdHNba2V5XSA9IGVudHJ5WzNdOwogICAgICB0YWJsZXMub3Bjb2Rlc1trZXldID0gQXJyYXkuaXNBcnJheShlbnRyeVswXSkgPyBlbnRyeVswXSA6IFtlbnRyeVswXV07CiAgICAgIHRhYmxlcy5vcmRlci5wdXNoKGtleSk7CiAgICB9CgogICAgcmV0dXJuIHRhYmxlczsKICB9Cgp9Cgpjb25zdCBDRkZUb3BEaWN0TGF5b3V0ID0gW1tbMTIsIDMwXSwgIlJPUyIsIFsic2lkIiwgInNpZCIsICJudW0iXSwgbnVsbF0sIFtbMTIsIDIwXSwgIlN5bnRoZXRpY0Jhc2UiLCAibnVtIiwgbnVsbF0sIFswLCAidmVyc2lvbiIsICJzaWQiLCBudWxsXSwgWzEsICJOb3RpY2UiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDBdLCAiQ29weXJpZ2h0IiwgInNpZCIsIG51bGxdLCBbMiwgIkZ1bGxOYW1lIiwgInNpZCIsIG51bGxdLCBbMywgIkZhbWlseU5hbWUiLCAic2lkIiwgbnVsbF0sIFs0LCAiV2VpZ2h0IiwgInNpZCIsIG51bGxdLCBbWzEyLCAxXSwgImlzRml4ZWRQaXRjaCIsICJudW0iLCAwXSwgW1sxMiwgMl0sICJJdGFsaWNBbmdsZSIsICJudW0iLCAwXSwgW1sxMiwgM10sICJVbmRlcmxpbmVQb3NpdGlvbiIsICJudW0iLCAtMTAwXSwgW1sxMiwgNF0sICJVbmRlcmxpbmVUaGlja25lc3MiLCAibnVtIiwgNTBdLCBbWzEyLCA1XSwgIlBhaW50VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgNl0sICJDaGFyc3RyaW5nVHlwZSIsICJudW0iLCAyXSwgW1sxMiwgN10sICJGb250TWF0cml4IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iLCAibnVtIiwgIm51bSJdLCBbMC4wMDEsIDAsIDAsIDAuMDAxLCAwLCAwXV0sIFsxMywgIlVuaXF1ZUlEIiwgIm51bSIsIG51bGxdLCBbNSwgIkZvbnRCQm94IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iXSwgWzAsIDAsIDAsIDBdXSwgW1sxMiwgOF0sICJTdHJva2VXaWR0aCIsICJudW0iLCAwXSwgWzE0LCAiWFVJRCIsICJhcnJheSIsIG51bGxdLCBbMTUsICJjaGFyc2V0IiwgIm9mZnNldCIsIDBdLCBbMTYsICJFbmNvZGluZyIsICJvZmZzZXQiLCAwXSwgWzE3LCAiQ2hhclN0cmluZ3MiLCAib2Zmc2V0IiwgMF0sIFsxOCwgIlByaXZhdGUiLCBbIm9mZnNldCIsICJvZmZzZXQiXSwgbnVsbF0sIFtbMTIsIDIxXSwgIlBvc3RTY3JpcHQiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDIyXSwgIkJhc2VGb250TmFtZSIsICJzaWQiLCBudWxsXSwgW1sxMiwgMjNdLCAiQmFzZUZvbnRCbGVuZCIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAzMV0sICJDSURGb250VmVyc2lvbiIsICJudW0iLCAwXSwgW1sxMiwgMzJdLCAiQ0lERm9udFJldmlzaW9uIiwgIm51bSIsIDBdLCBbWzEyLCAzM10sICJDSURGb250VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgMzRdLCAiQ0lEQ291bnQiLCAibnVtIiwgODcyMF0sIFtbMTIsIDM1XSwgIlVJREJhc2UiLCAibnVtIiwgbnVsbF0sIFtbMTIsIDM3XSwgIkZEU2VsZWN0IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzNl0sICJGREFycmF5IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzOF0sICJGb250TmFtZSIsICJzaWQiLCBudWxsXV07CgpjbGFzcyBDRkZUb3BEaWN0IGV4dGVuZHMgQ0ZGRGljdCB7CiAgc3RhdGljIGdldCB0YWJsZXMoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInRhYmxlcyIsIHRoaXMuY3JlYXRlVGFibGVzKENGRlRvcERpY3RMYXlvdXQpKTsKICB9CgogIGNvbnN0cnVjdG9yKHN0cmluZ3MpIHsKICAgIHN1cGVyKENGRlRvcERpY3QudGFibGVzLCBzdHJpbmdzKTsKICAgIHRoaXMucHJpdmF0ZURpY3QgPSBudWxsOwogIH0KCn0KCmV4cG9ydHMuQ0ZGVG9wRGljdCA9IENGRlRvcERpY3Q7CmNvbnN0IENGRlByaXZhdGVEaWN0TGF5b3V0ID0gW1s2LCAiQmx1ZVZhbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbNywgIk90aGVyQmx1ZXMiLCAiZGVsdGEiLCBudWxsXSwgWzgsICJGYW1pbHlCbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbOSwgIkZhbWlseU90aGVyQmx1ZXMiLCAiZGVsdGEiLCBudWxsXSwgW1sxMiwgOV0sICJCbHVlU2NhbGUiLCAibnVtIiwgMC4wMzk2MjVdLCBbWzEyLCAxMF0sICJCbHVlU2hpZnQiLCAibnVtIiwgN10sIFtbMTIsIDExXSwgIkJsdWVGdXp6IiwgIm51bSIsIDFdLCBbMTAsICJTdGRIVyIsICJudW0iLCBudWxsXSwgWzExLCAiU3RkVlciLCAibnVtIiwgbnVsbF0sIFtbMTIsIDEyXSwgIlN0ZW1TbmFwSCIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAxM10sICJTdGVtU25hcFYiLCAiZGVsdGEiLCBudWxsXSwgW1sxMiwgMTRdLCAiRm9yY2VCb2xkIiwgIm51bSIsIDBdLCBbWzEyLCAxN10sICJMYW5ndWFnZUdyb3VwIiwgIm51bSIsIDBdLCBbWzEyLCAxOF0sICJFeHBhbnNpb25GYWN0b3IiLCAibnVtIiwgMC4wNl0sIFtbMTIsIDE5XSwgImluaXRpYWxSYW5kb21TZWVkIiwgIm51bSIsIDBdLCBbMjAsICJkZWZhdWx0V2lkdGhYIiwgIm51bSIsIDBdLCBbMjEsICJub21pbmFsV2lkdGhYIiwgIm51bSIsIDBdLCBbMTksICJTdWJycyIsICJvZmZzZXQiLCBudWxsXV07CgpjbGFzcyBDRkZQcml2YXRlRGljdCBleHRlbmRzIENGRkRpY3QgewogIHN0YXRpYyBnZXQgdGFibGVzKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ0YWJsZXMiLCB0aGlzLmNyZWF0ZVRhYmxlcyhDRkZQcml2YXRlRGljdExheW91dCkpOwogIH0KCiAgY29uc3RydWN0b3Ioc3RyaW5ncykgewogICAgc3VwZXIoQ0ZGUHJpdmF0ZURpY3QudGFibGVzLCBzdHJpbmdzKTsKICAgIHRoaXMuc3VicnNJbmRleCA9IG51bGw7CiAgfQoKfQoKZXhwb3J0cy5DRkZQcml2YXRlRGljdCA9IENGRlByaXZhdGVEaWN0Owpjb25zdCBDRkZDaGFyc2V0UHJlZGVmaW5lZFR5cGVzID0gewogIElTT19BRE9CRTogMCwKICBFWFBFUlQ6IDEsCiAgRVhQRVJUX1NVQlNFVDogMgp9OwoKY2xhc3MgQ0ZGQ2hhcnNldCB7CiAgY29uc3RydWN0b3IocHJlZGVmaW5lZCwgZm9ybWF0LCBjaGFyc2V0LCByYXcpIHsKICAgIHRoaXMucHJlZGVmaW5lZCA9IHByZWRlZmluZWQ7CiAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKICAgIHRoaXMuY2hhcnNldCA9IGNoYXJzZXQ7CiAgICB0aGlzLnJhdyA9IHJhdzsKICB9Cgp9CgpleHBvcnRzLkNGRkNoYXJzZXQgPSBDRkZDaGFyc2V0OwoKY2xhc3MgQ0ZGRW5jb2RpbmcgewogIGNvbnN0cnVjdG9yKHByZWRlZmluZWQsIGZvcm1hdCwgZW5jb2RpbmcsIHJhdykgewogICAgdGhpcy5wcmVkZWZpbmVkID0gcHJlZGVmaW5lZDsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwogICAgdGhpcy5yYXcgPSByYXc7CiAgfQoKfQoKY2xhc3MgQ0ZGRkRTZWxlY3QgewogIGNvbnN0cnVjdG9yKGZvcm1hdCwgZmRTZWxlY3QpIHsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5mZFNlbGVjdCA9IGZkU2VsZWN0OwogIH0KCiAgZ2V0RkRJbmRleChnbHlwaEluZGV4KSB7CiAgICBpZiAoZ2x5cGhJbmRleCA8IDAgfHwgZ2x5cGhJbmRleCA+PSB0aGlzLmZkU2VsZWN0Lmxlbmd0aCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZmRTZWxlY3RbZ2x5cGhJbmRleF07CiAgfQoKfQoKZXhwb3J0cy5DRkZGRFNlbGVjdCA9IENGRkZEU2VsZWN0OwoKY2xhc3MgQ0ZGT2Zmc2V0VHJhY2tlciB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLm9mZnNldHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgaXNUcmFja2luZyhrZXkpIHsKICAgIHJldHVybiBrZXkgaW4gdGhpcy5vZmZzZXRzOwogIH0KCiAgdHJhY2soa2V5LCBsb2NhdGlvbikgewogICAgaWYgKGtleSBpbiB0aGlzLm9mZnNldHMpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBBbHJlYWR5IHRyYWNraW5nIGxvY2F0aW9uIG9mICR7a2V5fWApOwogICAgfQoKICAgIHRoaXMub2Zmc2V0c1trZXldID0gbG9jYXRpb247CiAgfQoKICBvZmZzZXQodmFsdWUpIHsKICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMub2Zmc2V0cykgewogICAgICB0aGlzLm9mZnNldHNba2V5XSArPSB2YWx1ZTsKICAgIH0KICB9CgogIHNldEVudHJ5TG9jYXRpb24oa2V5LCB2YWx1ZXMsIG91dHB1dCkgewogICAgaWYgKCEoa2V5IGluIHRoaXMub2Zmc2V0cykpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBOb3QgdHJhY2tpbmcgbG9jYXRpb24gb2YgJHtrZXl9YCk7CiAgICB9CgogICAgY29uc3QgZGF0YSA9IG91dHB1dC5kYXRhOwogICAgY29uc3QgZGF0YU9mZnNldCA9IHRoaXMub2Zmc2V0c1trZXldOwogICAgY29uc3Qgc2l6ZSA9IDU7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdmFsdWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3Qgb2Zmc2V0MCA9IGkgKiBzaXplICsgZGF0YU9mZnNldDsKICAgICAgY29uc3Qgb2Zmc2V0MSA9IG9mZnNldDAgKyAxOwogICAgICBjb25zdCBvZmZzZXQyID0gb2Zmc2V0MCArIDI7CiAgICAgIGNvbnN0IG9mZnNldDMgPSBvZmZzZXQwICsgMzsKICAgICAgY29uc3Qgb2Zmc2V0NCA9IG9mZnNldDAgKyA0OwoKICAgICAgaWYgKGRhdGFbb2Zmc2V0MF0gIT09IDB4MWQgfHwgZGF0YVtvZmZzZXQxXSAhPT0gMCB8fCBkYXRhW29mZnNldDJdICE9PSAwIHx8IGRhdGFbb2Zmc2V0M10gIT09IDAgfHwgZGF0YVtvZmZzZXQ0XSAhPT0gMCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigid3JpdGluZyB0byBhbiBvZmZzZXQgdGhhdCBpcyBub3QgZW1wdHkiKTsKICAgICAgfQoKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07CiAgICAgIGRhdGFbb2Zmc2V0MF0gPSAweDFkOwogICAgICBkYXRhW29mZnNldDFdID0gdmFsdWUgPj4gMjQgJiAweGZmOwogICAgICBkYXRhW29mZnNldDJdID0gdmFsdWUgPj4gMTYgJiAweGZmOwogICAgICBkYXRhW29mZnNldDNdID0gdmFsdWUgPj4gOCAmIDB4ZmY7CiAgICAgIGRhdGFbb2Zmc2V0NF0gPSB2YWx1ZSAmIDB4ZmY7CiAgICB9CiAgfQoKfQoKY2xhc3MgQ0ZGQ29tcGlsZXIgewogIGNvbnN0cnVjdG9yKGNmZikgewogICAgdGhpcy5jZmYgPSBjZmY7CiAgfQoKICBjb21waWxlKCkgewogICAgY29uc3QgY2ZmID0gdGhpcy5jZmY7CiAgICBjb25zdCBvdXRwdXQgPSB7CiAgICAgIGRhdGE6IFtdLAogICAgICBsZW5ndGg6IDAsCgogICAgICBhZGQoZGF0YSkgewogICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuZGF0YS5jb25jYXQoZGF0YSk7CiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmRhdGEubGVuZ3RoOwogICAgICB9CgogICAgfTsKICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuY29tcGlsZUhlYWRlcihjZmYuaGVhZGVyKTsKICAgIG91dHB1dC5hZGQoaGVhZGVyKTsKICAgIGNvbnN0IG5hbWVJbmRleCA9IHRoaXMuY29tcGlsZU5hbWVJbmRleChjZmYubmFtZXMpOwogICAgb3V0cHV0LmFkZChuYW1lSW5kZXgpOwoKICAgIGlmIChjZmYuaXNDSURGb250KSB7CiAgICAgIGlmIChjZmYudG9wRGljdC5oYXNOYW1lKCJGb250TWF0cml4IikpIHsKICAgICAgICBjb25zdCBiYXNlID0gY2ZmLnRvcERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4Iik7CiAgICAgICAgY2ZmLnRvcERpY3QucmVtb3ZlQnlOYW1lKCJGb250TWF0cml4Iik7CgogICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNmZi5mZEFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHN1YkRpY3QgPSBjZmYuZmRBcnJheVtpXTsKICAgICAgICAgIGxldCBtYXRyaXggPSBiYXNlLnNsaWNlKDApOwoKICAgICAgICAgIGlmIChzdWJEaWN0Lmhhc05hbWUoIkZvbnRNYXRyaXgiKSkgewogICAgICAgICAgICBtYXRyaXggPSBfdXRpbC5VdGlsLnRyYW5zZm9ybShtYXRyaXgsIHN1YkRpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4IikpOwogICAgICAgICAgfQoKICAgICAgICAgIHN1YkRpY3Quc2V0QnlOYW1lKCJGb250TWF0cml4IiwgbWF0cml4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB4dWlkID0gY2ZmLnRvcERpY3QuZ2V0QnlOYW1lKCJYVUlEIik7CgogICAgaWYgKHh1aWQgJiYgeHVpZC5sZW5ndGggPiAxNikgewogICAgICBjZmYudG9wRGljdC5yZW1vdmVCeU5hbWUoIlhVSUQiKTsKICAgIH0KCiAgICBjZmYudG9wRGljdC5zZXRCeU5hbWUoImNoYXJzZXQiLCAwKTsKICAgIGxldCBjb21waWxlZCA9IHRoaXMuY29tcGlsZVRvcERpY3RzKFtjZmYudG9wRGljdF0sIG91dHB1dC5sZW5ndGgsIGNmZi5pc0NJREZvbnQpOwogICAgb3V0cHV0LmFkZChjb21waWxlZC5vdXRwdXQpOwogICAgY29uc3QgdG9wRGljdFRyYWNrZXIgPSBjb21waWxlZC50cmFja2Vyc1swXTsKICAgIGNvbnN0IHN0cmluZ0luZGV4ID0gdGhpcy5jb21waWxlU3RyaW5nSW5kZXgoY2ZmLnN0cmluZ3Muc3RyaW5ncyk7CiAgICBvdXRwdXQuYWRkKHN0cmluZ0luZGV4KTsKICAgIGNvbnN0IGdsb2JhbFN1YnJJbmRleCA9IHRoaXMuY29tcGlsZUluZGV4KGNmZi5nbG9iYWxTdWJySW5kZXgpOwogICAgb3V0cHV0LmFkZChnbG9iYWxTdWJySW5kZXgpOwoKICAgIGlmIChjZmYuZW5jb2RpbmcgJiYgY2ZmLnRvcERpY3QuaGFzTmFtZSgiRW5jb2RpbmciKSkgewogICAgICBpZiAoY2ZmLmVuY29kaW5nLnByZWRlZmluZWQpIHsKICAgICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJFbmNvZGluZyIsIFtjZmYuZW5jb2RpbmcuZm9ybWF0XSwgb3V0cHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBlbmNvZGluZyA9IHRoaXMuY29tcGlsZUVuY29kaW5nKGNmZi5lbmNvZGluZyk7CiAgICAgICAgdG9wRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiRW5jb2RpbmciLCBbb3V0cHV0Lmxlbmd0aF0sIG91dHB1dCk7CiAgICAgICAgb3V0cHV0LmFkZChlbmNvZGluZyk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBjaGFyc2V0ID0gdGhpcy5jb21waWxlQ2hhcnNldChjZmYuY2hhcnNldCwgY2ZmLmNoYXJTdHJpbmdzLmNvdW50LCBjZmYuc3RyaW5ncywgY2ZmLmlzQ0lERm9udCk7CiAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJjaGFyc2V0IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChjaGFyc2V0KTsKICAgIGNvbnN0IGNoYXJTdHJpbmdzID0gdGhpcy5jb21waWxlQ2hhclN0cmluZ3MoY2ZmLmNoYXJTdHJpbmdzKTsKICAgIHRvcERpY3RUcmFja2VyLnNldEVudHJ5TG9jYXRpb24oIkNoYXJTdHJpbmdzIiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChjaGFyU3RyaW5ncyk7CgogICAgaWYgKGNmZi5pc0NJREZvbnQpIHsKICAgICAgdG9wRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiRkRTZWxlY3QiLCBbb3V0cHV0Lmxlbmd0aF0sIG91dHB1dCk7CiAgICAgIGNvbnN0IGZkU2VsZWN0ID0gdGhpcy5jb21waWxlRkRTZWxlY3QoY2ZmLmZkU2VsZWN0KTsKICAgICAgb3V0cHV0LmFkZChmZFNlbGVjdCk7CiAgICAgIGNvbXBpbGVkID0gdGhpcy5jb21waWxlVG9wRGljdHMoY2ZmLmZkQXJyYXksIG91dHB1dC5sZW5ndGgsIHRydWUpOwogICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJGREFycmF5IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKGNvbXBpbGVkLm91dHB1dCk7CiAgICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlcnMgPSBjb21waWxlZC50cmFja2VyczsKICAgICAgdGhpcy5jb21waWxlUHJpdmF0ZURpY3RzKGNmZi5mZEFycmF5LCBmb250RGljdFRyYWNrZXJzLCBvdXRwdXQpOwogICAgfQoKICAgIHRoaXMuY29tcGlsZVByaXZhdGVEaWN0cyhbY2ZmLnRvcERpY3RdLCBbdG9wRGljdFRyYWNrZXJdLCBvdXRwdXQpOwogICAgb3V0cHV0LmFkZChbMF0pOwogICAgcmV0dXJuIG91dHB1dC5kYXRhOwogIH0KCiAgZW5jb2RlTnVtYmVyKHZhbHVlKSB7CiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkpIHsKICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlSW50ZWdlcih2YWx1ZSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZW5jb2RlRmxvYXQodmFsdWUpOwogIH0KCiAgc3RhdGljIGdldCBFbmNvZGVGbG9hdFJlZ0V4cCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiRW5jb2RlRmxvYXRSZWdFeHAiLCAvXC4oXGQqPykoPzo5ezUsMjB9fDB7NSwyMH0pXGR7MCwyfSg/OmUoLispfCQpLyk7CiAgfQoKICBlbmNvZGVGbG9hdChudW0pIHsKICAgIGxldCB2YWx1ZSA9IG51bS50b1N0cmluZygpOwogICAgY29uc3QgbSA9IENGRkNvbXBpbGVyLkVuY29kZUZsb2F0UmVnRXhwLmV4ZWModmFsdWUpOwoKICAgIGlmIChtKSB7CiAgICAgIGNvbnN0IGVwc2lsb24gPSBwYXJzZUZsb2F0KCIxZSIgKyAoKG1bMl0gPyArbVsyXSA6IDApICsgbVsxXS5sZW5ndGgpKTsKICAgICAgdmFsdWUgPSAoTWF0aC5yb3VuZChudW0gKiBlcHNpbG9uKSAvIGVwc2lsb24pLnRvU3RyaW5nKCk7CiAgICB9CgogICAgbGV0IG5pYmJsZXMgPSAiIjsKICAgIGxldCBpLCBpaTsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IHZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgYSA9IHZhbHVlW2ldOwoKICAgICAgaWYgKGEgPT09ICJlIikgewogICAgICAgIG5pYmJsZXMgKz0gdmFsdWVbKytpXSA9PT0gIi0iID8gImMiIDogImIiOwogICAgICB9IGVsc2UgaWYgKGEgPT09ICIuIikgewogICAgICAgIG5pYmJsZXMgKz0gImEiOwogICAgICB9IGVsc2UgaWYgKGEgPT09ICItIikgewogICAgICAgIG5pYmJsZXMgKz0gImUiOwogICAgICB9IGVsc2UgewogICAgICAgIG5pYmJsZXMgKz0gYTsKICAgICAgfQogICAgfQoKICAgIG5pYmJsZXMgKz0gbmliYmxlcy5sZW5ndGggJiAxID8gImYiIDogImZmIjsKICAgIGNvbnN0IG91dCA9IFszMF07CgogICAgZm9yIChpID0gMCwgaWkgPSBuaWJibGVzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgb3V0LnB1c2gocGFyc2VJbnQobmliYmxlcy5zdWJzdHJpbmcoaSwgaSArIDIpLCAxNikpOwogICAgfQoKICAgIHJldHVybiBvdXQ7CiAgfQoKICBlbmNvZGVJbnRlZ2VyKHZhbHVlKSB7CiAgICBsZXQgY29kZTsKCiAgICBpZiAodmFsdWUgPj0gLTEwNyAmJiB2YWx1ZSA8PSAxMDcpIHsKICAgICAgY29kZSA9IFt2YWx1ZSArIDEzOV07CiAgICB9IGVsc2UgaWYgKHZhbHVlID49IDEwOCAmJiB2YWx1ZSA8PSAxMTMxKSB7CiAgICAgIHZhbHVlIC09IDEwODsKICAgICAgY29kZSA9IFsodmFsdWUgPj4gOCkgKyAyNDcsIHZhbHVlICYgMHhmZl07CiAgICB9IGVsc2UgaWYgKHZhbHVlID49IC0xMTMxICYmIHZhbHVlIDw9IC0xMDgpIHsKICAgICAgdmFsdWUgPSAtdmFsdWUgLSAxMDg7CiAgICAgIGNvZGUgPSBbKHZhbHVlID4+IDgpICsgMjUxLCB2YWx1ZSAmIDB4ZmZdOwogICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAtMzI3NjggJiYgdmFsdWUgPD0gMzI3NjcpIHsKICAgICAgY29kZSA9IFsweDFjLCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmXTsKICAgIH0gZWxzZSB7CiAgICAgIGNvZGUgPSBbMHgxZCwgdmFsdWUgPj4gMjQgJiAweGZmLCB2YWx1ZSA+PiAxNiAmIDB4ZmYsIHZhbHVlID4+IDggJiAweGZmLCB2YWx1ZSAmIDB4ZmZdOwogICAgfQoKICAgIHJldHVybiBjb2RlOwogIH0KCiAgY29tcGlsZUhlYWRlcihoZWFkZXIpIHsKICAgIHJldHVybiBbaGVhZGVyLm1ham9yLCBoZWFkZXIubWlub3IsIDQsIGhlYWRlci5vZmZTaXplXTsKICB9CgogIGNvbXBpbGVOYW1lSW5kZXgobmFtZXMpIHsKICAgIGNvbnN0IG5hbWVJbmRleCA9IG5ldyBDRkZJbmRleCgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IG5hbWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgY29uc3QgbmFtZSA9IG5hbWVzW2ldOwogICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1pbihuYW1lLmxlbmd0aCwgMTI3KTsKICAgICAgbGV0IHNhbml0aXplZE5hbWUgPSBuZXcgQXJyYXkobGVuZ3RoKTsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGVuZ3RoOyBqKyspIHsKICAgICAgICBsZXQgY2hhciA9IG5hbWVbal07CgogICAgICAgIGlmIChjaGFyIDwgIiEiIHx8IGNoYXIgPiAifiIgfHwgY2hhciA9PT0gIlsiIHx8IGNoYXIgPT09ICJdIiB8fCBjaGFyID09PSAiKCIgfHwgY2hhciA9PT0gIikiIHx8IGNoYXIgPT09ICJ7IiB8fCBjaGFyID09PSAifSIgfHwgY2hhciA9PT0gIjwiIHx8IGNoYXIgPT09ICI+IiB8fCBjaGFyID09PSAiLyIgfHwgY2hhciA9PT0gIiUiKSB7CiAgICAgICAgICBjaGFyID0gIl8iOwogICAgICAgIH0KCiAgICAgICAgc2FuaXRpemVkTmFtZVtqXSA9IGNoYXI7CiAgICAgIH0KCiAgICAgIHNhbml0aXplZE5hbWUgPSBzYW5pdGl6ZWROYW1lLmpvaW4oIiIpOwoKICAgICAgaWYgKHNhbml0aXplZE5hbWUgPT09ICIiKSB7CiAgICAgICAgc2FuaXRpemVkTmFtZSA9ICJCYWRfRm9udF9OYW1lIjsKICAgICAgfQoKICAgICAgbmFtZUluZGV4LmFkZCgoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc2FuaXRpemVkTmFtZSkpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVJbmRleChuYW1lSW5kZXgpOwogIH0KCiAgY29tcGlsZVRvcERpY3RzKGRpY3RzLCBsZW5ndGgsIHJlbW92ZUNpZEtleXMpIHsKICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlcnMgPSBbXTsKICAgIGxldCBmZEFycmF5SW5kZXggPSBuZXcgQ0ZGSW5kZXgoKTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBkaWN0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGNvbnN0IGZvbnREaWN0ID0gZGljdHNbaV07CgogICAgICBpZiAocmVtb3ZlQ2lkS2V5cykgewogICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFZlcnNpb24iKTsKICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJREZvbnRSZXZpc2lvbiIpOwogICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFR5cGUiKTsKICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJRENvdW50Iik7CiAgICAgICAgZm9udERpY3QucmVtb3ZlQnlOYW1lKCJVSURCYXNlIik7CiAgICAgIH0KCiAgICAgIGNvbnN0IGZvbnREaWN0VHJhY2tlciA9IG5ldyBDRkZPZmZzZXRUcmFja2VyKCk7CiAgICAgIGNvbnN0IGZvbnREaWN0RGF0YSA9IHRoaXMuY29tcGlsZURpY3QoZm9udERpY3QsIGZvbnREaWN0VHJhY2tlcik7CiAgICAgIGZvbnREaWN0VHJhY2tlcnMucHVzaChmb250RGljdFRyYWNrZXIpOwogICAgICBmZEFycmF5SW5kZXguYWRkKGZvbnREaWN0RGF0YSk7CiAgICAgIGZvbnREaWN0VHJhY2tlci5vZmZzZXQobGVuZ3RoKTsKICAgIH0KCiAgICBmZEFycmF5SW5kZXggPSB0aGlzLmNvbXBpbGVJbmRleChmZEFycmF5SW5kZXgsIGZvbnREaWN0VHJhY2tlcnMpOwogICAgcmV0dXJuIHsKICAgICAgdHJhY2tlcnM6IGZvbnREaWN0VHJhY2tlcnMsCiAgICAgIG91dHB1dDogZmRBcnJheUluZGV4CiAgICB9OwogIH0KCiAgY29tcGlsZVByaXZhdGVEaWN0cyhkaWN0cywgdHJhY2tlcnMsIG91dHB1dCkgewogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGljdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICBjb25zdCBmb250RGljdCA9IGRpY3RzW2ldOwogICAgICBjb25zdCBwcml2YXRlRGljdCA9IGZvbnREaWN0LnByaXZhdGVEaWN0OwoKICAgICAgaWYgKCFwcml2YXRlRGljdCB8fCAhZm9udERpY3QuaGFzTmFtZSgiUHJpdmF0ZSIpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUaGVyZSBtdXN0IGJlIGEgcHJpdmF0ZSBkaWN0aW9uYXJ5LiIpOwogICAgICB9CgogICAgICBjb25zdCBwcml2YXRlRGljdFRyYWNrZXIgPSBuZXcgQ0ZGT2Zmc2V0VHJhY2tlcigpOwogICAgICBjb25zdCBwcml2YXRlRGljdERhdGEgPSB0aGlzLmNvbXBpbGVEaWN0KHByaXZhdGVEaWN0LCBwcml2YXRlRGljdFRyYWNrZXIpOwogICAgICBsZXQgb3V0cHV0TGVuZ3RoID0gb3V0cHV0Lmxlbmd0aDsKICAgICAgcHJpdmF0ZURpY3RUcmFja2VyLm9mZnNldChvdXRwdXRMZW5ndGgpOwoKICAgICAgaWYgKCFwcml2YXRlRGljdERhdGEubGVuZ3RoKSB7CiAgICAgICAgb3V0cHV0TGVuZ3RoID0gMDsKICAgICAgfQoKICAgICAgdHJhY2tlcnNbaV0uc2V0RW50cnlMb2NhdGlvbigiUHJpdmF0ZSIsIFtwcml2YXRlRGljdERhdGEubGVuZ3RoLCBvdXRwdXRMZW5ndGhdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKHByaXZhdGVEaWN0RGF0YSk7CgogICAgICBpZiAocHJpdmF0ZURpY3Quc3VicnNJbmRleCAmJiBwcml2YXRlRGljdC5oYXNOYW1lKCJTdWJycyIpKSB7CiAgICAgICAgY29uc3Qgc3VicnMgPSB0aGlzLmNvbXBpbGVJbmRleChwcml2YXRlRGljdC5zdWJyc0luZGV4KTsKICAgICAgICBwcml2YXRlRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiU3VicnMiLCBbcHJpdmF0ZURpY3REYXRhLmxlbmd0aF0sIG91dHB1dCk7CiAgICAgICAgb3V0cHV0LmFkZChzdWJycyk7CiAgICAgIH0KICAgIH0KICB9CgogIGNvbXBpbGVEaWN0KGRpY3QsIG9mZnNldFRyYWNrZXIpIHsKICAgIGNvbnN0IG91dCA9IFtdOwoKICAgIGZvciAoY29uc3Qga2V5IG9mIGRpY3Qub3JkZXIpIHsKICAgICAgaWYgKCEoa2V5IGluIGRpY3QudmFsdWVzKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgdmFsdWVzID0gZGljdC52YWx1ZXNba2V5XTsKICAgICAgbGV0IHR5cGVzID0gZGljdC50eXBlc1trZXldOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHR5cGVzKSkgewogICAgICAgIHR5cGVzID0gW3R5cGVzXTsKICAgICAgfQoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlcykpIHsKICAgICAgICB2YWx1ZXMgPSBbdmFsdWVzXTsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IDAsIGpqID0gdHlwZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICAgIGNvbnN0IHR5cGUgPSB0eXBlc1tqXTsKICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tqXTsKCiAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICBjYXNlICJudW0iOgogICAgICAgICAgY2FzZSAic2lkIjoKICAgICAgICAgICAgb3V0LnB1c2goLi4udGhpcy5lbmNvZGVOdW1iZXIodmFsdWUpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAib2Zmc2V0IjoKICAgICAgICAgICAgY29uc3QgbmFtZSA9IGRpY3Qua2V5VG9OYW1lTWFwW2tleV07CgogICAgICAgICAgICBpZiAoIW9mZnNldFRyYWNrZXIuaXNUcmFja2luZyhuYW1lKSkgewogICAgICAgICAgICAgIG9mZnNldFRyYWNrZXIudHJhY2sobmFtZSwgb3V0Lmxlbmd0aCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG91dC5wdXNoKDB4MWQsIDAsIDAsIDAsIDApOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhcnJheSI6CiAgICAgICAgICBjYXNlICJkZWx0YSI6CiAgICAgICAgICAgIG91dC5wdXNoKC4uLnRoaXMuZW5jb2RlTnVtYmVyKHZhbHVlKSk7CgogICAgICAgICAgICBmb3IgKGxldCBrID0gMSwga2sgPSB2YWx1ZXMubGVuZ3RoOyBrIDwga2s7ICsraykgewogICAgICAgICAgICAgIG91dC5wdXNoKC4uLnRoaXMuZW5jb2RlTnVtYmVyKHZhbHVlc1trXSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVua25vd24gZGF0YSB0eXBlIG9mICR7dHlwZX1gKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG91dC5wdXNoKC4uLmRpY3Qub3Bjb2Rlc1trZXldKTsKICAgIH0KCiAgICByZXR1cm4gb3V0OwogIH0KCiAgY29tcGlsZVN0cmluZ0luZGV4KHN0cmluZ3MpIHsKICAgIGNvbnN0IHN0cmluZ0luZGV4ID0gbmV3IENGRkluZGV4KCk7CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIHN0cmluZ0luZGV4LmFkZCgoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc3RyaW5nc1tpXSkpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVJbmRleChzdHJpbmdJbmRleCk7CiAgfQoKICBjb21waWxlR2xvYmFsU3VickluZGV4KCkgewogICAgY29uc3QgZ2xvYmFsU3VickluZGV4ID0gdGhpcy5jZmYuZ2xvYmFsU3VickluZGV4OwogICAgdGhpcy5vdXQud3JpdGVCeXRlQXJyYXkodGhpcy5jb21waWxlSW5kZXgoZ2xvYmFsU3VickluZGV4KSk7CiAgfQoKICBjb21waWxlQ2hhclN0cmluZ3MoY2hhclN0cmluZ3MpIHsKICAgIGNvbnN0IGNoYXJTdHJpbmdzSW5kZXggPSBuZXcgQ0ZGSW5kZXgoKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYXJTdHJpbmdzLmNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZ2x5cGggPSBjaGFyU3RyaW5ncy5nZXQoaSk7CgogICAgICBpZiAoZ2x5cGgubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQobmV3IFVpbnQ4QXJyYXkoWzB4OGIsIDB4MGVdKSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNoYXJTdHJpbmdzSW5kZXguYWRkKGdseXBoKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jb21waWxlSW5kZXgoY2hhclN0cmluZ3NJbmRleCk7CiAgfQoKICBjb21waWxlQ2hhcnNldChjaGFyc2V0LCBudW1HbHlwaHMsIHN0cmluZ3MsIGlzQ0lERm9udCkgewogICAgbGV0IG91dDsKICAgIGNvbnN0IG51bUdseXBoc0xlc3NOb3REZWYgPSBudW1HbHlwaHMgLSAxOwoKICAgIGlmIChpc0NJREZvbnQpIHsKICAgICAgb3V0ID0gbmV3IFVpbnQ4QXJyYXkoWzIsIDAsIDAsIG51bUdseXBoc0xlc3NOb3REZWYgPj4gOCAmIDB4ZmYsIG51bUdseXBoc0xlc3NOb3REZWYgJiAweGZmXSk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBsZW5ndGggPSAxICsgbnVtR2x5cGhzTGVzc05vdERlZiAqIDI7CiAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICAgIG91dFswXSA9IDA7CiAgICAgIGxldCBjaGFyc2V0SW5kZXggPSAwOwogICAgICBjb25zdCBudW1DaGFyc2V0cyA9IGNoYXJzZXQuY2hhcnNldC5sZW5ndGg7CiAgICAgIGxldCB3YXJuZWQgPSBmYWxzZTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgb3V0Lmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgbGV0IHNpZCA9IDA7CgogICAgICAgIGlmIChjaGFyc2V0SW5kZXggPCBudW1DaGFyc2V0cykgewogICAgICAgICAgY29uc3QgbmFtZSA9IGNoYXJzZXQuY2hhcnNldFtjaGFyc2V0SW5kZXgrK107CiAgICAgICAgICBzaWQgPSBzdHJpbmdzLmdldFNJRChuYW1lKTsKCiAgICAgICAgICBpZiAoc2lkID09PSAtMSkgewogICAgICAgICAgICBzaWQgPSAwOwoKICAgICAgICAgICAgaWYgKCF3YXJuZWQpIHsKICAgICAgICAgICAgICB3YXJuZWQgPSB0cnVlOwogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgQ291bGRuJ3QgZmluZCAke25hbWV9IGluIENGRiBzdHJpbmdzYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG91dFtpXSA9IHNpZCA+PiA4ICYgMHhmZjsKICAgICAgICBvdXRbaSArIDFdID0gc2lkICYgMHhmZjsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzLmNvbXBpbGVUeXBlZEFycmF5KG91dCk7CiAgfQoKICBjb21waWxlRW5jb2RpbmcoZW5jb2RpbmcpIHsKICAgIHJldHVybiB0aGlzLmNvbXBpbGVUeXBlZEFycmF5KGVuY29kaW5nLnJhdyk7CiAgfQoKICBjb21waWxlRkRTZWxlY3QoZmRTZWxlY3QpIHsKICAgIGNvbnN0IGZvcm1hdCA9IGZkU2VsZWN0LmZvcm1hdDsKICAgIGxldCBvdXQsIGk7CgogICAgc3dpdGNoIChmb3JtYXQpIHsKICAgICAgY2FzZSAwOgogICAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KDEgKyBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGgpOwogICAgICAgIG91dFswXSA9IGZvcm1hdDsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGZkU2VsZWN0LmZkU2VsZWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBvdXRbaSArIDFdID0gZmRTZWxlY3QuZmRTZWxlY3RbaV07CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICBjb25zdCBzdGFydCA9IDA7CiAgICAgICAgbGV0IGxhc3RGRCA9IGZkU2VsZWN0LmZkU2VsZWN0WzBdOwogICAgICAgIGNvbnN0IHJhbmdlcyA9IFtmb3JtYXQsIDAsIDAsIHN0YXJ0ID4+IDggJiAweGZmLCBzdGFydCAmIDB4ZmYsIGxhc3RGRF07CgogICAgICAgIGZvciAoaSA9IDE7IGkgPCBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgY3VycmVudEZEID0gZmRTZWxlY3QuZmRTZWxlY3RbaV07CgogICAgICAgICAgaWYgKGN1cnJlbnRGRCAhPT0gbGFzdEZEKSB7CiAgICAgICAgICAgIHJhbmdlcy5wdXNoKGkgPj4gOCAmIDB4ZmYsIGkgJiAweGZmLCBjdXJyZW50RkQpOwogICAgICAgICAgICBsYXN0RkQgPSBjdXJyZW50RkQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCBudW1SYW5nZXMgPSAocmFuZ2VzLmxlbmd0aCAtIDMpIC8gMzsKICAgICAgICByYW5nZXNbMV0gPSBudW1SYW5nZXMgPj4gOCAmIDB4ZmY7CiAgICAgICAgcmFuZ2VzWzJdID0gbnVtUmFuZ2VzICYgMHhmZjsKICAgICAgICByYW5nZXMucHVzaChpID4+IDggJiAweGZmLCBpICYgMHhmZik7CiAgICAgICAgb3V0ID0gbmV3IFVpbnQ4QXJyYXkocmFuZ2VzKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jb21waWxlVHlwZWRBcnJheShvdXQpOwogIH0KCiAgY29tcGlsZVR5cGVkQXJyYXkoZGF0YSkgewogICAgY29uc3Qgb3V0ID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGF0YS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIG91dFtpXSA9IGRhdGFbaV07CiAgICB9CgogICAgcmV0dXJuIG91dDsKICB9CgogIGNvbXBpbGVJbmRleChpbmRleCwgdHJhY2tlcnMgPSBbXSkgewogICAgY29uc3Qgb2JqZWN0cyA9IGluZGV4Lm9iamVjdHM7CiAgICBjb25zdCBjb3VudCA9IG9iamVjdHMubGVuZ3RoOwoKICAgIGlmIChjb3VudCA9PT0gMCkgewogICAgICByZXR1cm4gWzAsIDBdOwogICAgfQoKICAgIGNvbnN0IGRhdGEgPSBbY291bnQgPj4gOCAmIDB4ZmYsIGNvdW50ICYgMHhmZl07CiAgICBsZXQgbGFzdE9mZnNldCA9IDEsCiAgICAgICAgaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICBsYXN0T2Zmc2V0ICs9IG9iamVjdHNbaV0ubGVuZ3RoOwogICAgfQoKICAgIGxldCBvZmZzZXRTaXplOwoKICAgIGlmIChsYXN0T2Zmc2V0IDwgMHgxMDApIHsKICAgICAgb2Zmc2V0U2l6ZSA9IDE7CiAgICB9IGVsc2UgaWYgKGxhc3RPZmZzZXQgPCAweDEwMDAwKSB7CiAgICAgIG9mZnNldFNpemUgPSAyOwogICAgfSBlbHNlIGlmIChsYXN0T2Zmc2V0IDwgMHgxMDAwMDAwKSB7CiAgICAgIG9mZnNldFNpemUgPSAzOwogICAgfSBlbHNlIHsKICAgICAgb2Zmc2V0U2l6ZSA9IDQ7CiAgICB9CgogICAgZGF0YS5wdXNoKG9mZnNldFNpemUpOwogICAgbGV0IHJlbGF0aXZlT2Zmc2V0ID0gMTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQgKyAxOyBpKyspIHsKICAgICAgaWYgKG9mZnNldFNpemUgPT09IDEpIHsKICAgICAgICBkYXRhLnB1c2gocmVsYXRpdmVPZmZzZXQgJiAweGZmKTsKICAgICAgfSBlbHNlIGlmIChvZmZzZXRTaXplID09PSAyKSB7CiAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ID4+IDggJiAweGZmLCByZWxhdGl2ZU9mZnNldCAmIDB4ZmYpOwogICAgICB9IGVsc2UgaWYgKG9mZnNldFNpemUgPT09IDMpIHsKICAgICAgICBkYXRhLnB1c2gocmVsYXRpdmVPZmZzZXQgPj4gMTYgJiAweGZmLCByZWxhdGl2ZU9mZnNldCA+PiA4ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgJiAweGZmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhLnB1c2gocmVsYXRpdmVPZmZzZXQgPj4+IDI0ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgPj4gMTYgJiAweGZmLCByZWxhdGl2ZU9mZnNldCA+PiA4ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgJiAweGZmKTsKICAgICAgfQoKICAgICAgaWYgKG9iamVjdHNbaV0pIHsKICAgICAgICByZWxhdGl2ZU9mZnNldCArPSBvYmplY3RzW2ldLmxlbmd0aDsKICAgICAgfQogICAgfQoKICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIGlmICh0cmFja2Vyc1tpXSkgewogICAgICAgIHRyYWNrZXJzW2ldLm9mZnNldChkYXRhLmxlbmd0aCk7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IG9iamVjdHNbaV0ubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgIGRhdGEucHVzaChvYmplY3RzW2ldW2pdKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0KCn0KCmV4cG9ydHMuQ0ZGQ29tcGlsZXIgPSBDRkZDb21waWxlcjsKCi8qKiovIH0pLAovKiAzNiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLklTT0Fkb2JlQ2hhcnNldCA9IGV4cG9ydHMuRXhwZXJ0U3Vic2V0Q2hhcnNldCA9IGV4cG9ydHMuRXhwZXJ0Q2hhcnNldCA9IHZvaWQgMDsKY29uc3QgSVNPQWRvYmVDaGFyc2V0ID0gWyIubm90ZGVmIiwgInNwYWNlIiwgImV4Y2xhbSIsICJxdW90ZWRibCIsICJudW1iZXJzaWduIiwgImRvbGxhciIsICJwZXJjZW50IiwgImFtcGVyc2FuZCIsICJxdW90ZXJpZ2h0IiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJxdW90ZWxlZnQiLCAiYSIsICJiIiwgImMiLCAiZCIsICJlIiwgImYiLCAiZyIsICJoIiwgImkiLCAiaiIsICJrIiwgImwiLCAibSIsICJuIiwgIm8iLCAicCIsICJxIiwgInIiLCAicyIsICJ0IiwgInUiLCAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwgImJyYWNlbGVmdCIsICJiYXIiLCAiYnJhY2VyaWdodCIsICJhc2NpaXRpbGRlIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJmcmFjdGlvbiIsICJ5ZW4iLCAiZmxvcmluIiwgInNlY3Rpb24iLCAiY3VycmVuY3kiLCAicXVvdGVzaW5nbGUiLCAicXVvdGVkYmxsZWZ0IiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICJlbmRhc2giLCAiZGFnZ2VyIiwgImRhZ2dlcmRibCIsICJwZXJpb2RjZW50ZXJlZCIsICJwYXJhZ3JhcGgiLCAiYnVsbGV0IiwgInF1b3Rlc2luZ2xiYXNlIiwgInF1b3RlZGJsYmFzZSIsICJxdW90ZWRibHJpZ2h0IiwgImd1aWxsZW1vdHJpZ2h0IiwgImVsbGlwc2lzIiwgInBlcnRob3VzYW5kIiwgInF1ZXN0aW9uZG93biIsICJncmF2ZSIsICJhY3V0ZSIsICJjaXJjdW1mbGV4IiwgInRpbGRlIiwgIm1hY3JvbiIsICJicmV2ZSIsICJkb3RhY2NlbnQiLCAiZGllcmVzaXMiLCAicmluZyIsICJjZWRpbGxhIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iLCAiZW1kYXNoIiwgIkFFIiwgIm9yZGZlbWluaW5lIiwgIkxzbGFzaCIsICJPc2xhc2giLCAiT0UiLCAib3JkbWFzY3VsaW5lIiwgImFlIiwgImRvdGxlc3NpIiwgImxzbGFzaCIsICJvc2xhc2giLCAib2UiLCAiZ2VybWFuZGJscyIsICJvbmVzdXBlcmlvciIsICJsb2dpY2Fsbm90IiwgIm11IiwgInRyYWRlbWFyayIsICJFdGgiLCAib25laGFsZiIsICJwbHVzbWludXMiLCAiVGhvcm4iLCAib25lcXVhcnRlciIsICJkaXZpZGUiLCAiYnJva2VuYmFyIiwgImRlZ3JlZSIsICJ0aG9ybiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInR3b3N1cGVyaW9yIiwgInJlZ2lzdGVyZWQiLCAibWludXMiLCAiZXRoIiwgIm11bHRpcGx5IiwgInRocmVlc3VwZXJpb3IiLCAiY29weXJpZ2h0IiwgIkFhY3V0ZSIsICJBY2lyY3VtZmxleCIsICJBZGllcmVzaXMiLCAiQWdyYXZlIiwgIkFyaW5nIiwgIkF0aWxkZSIsICJDY2VkaWxsYSIsICJFYWN1dGUiLCAiRWNpcmN1bWZsZXgiLCAiRWRpZXJlc2lzIiwgIkVncmF2ZSIsICJJYWN1dGUiLCAiSWNpcmN1bWZsZXgiLCAiSWRpZXJlc2lzIiwgIklncmF2ZSIsICJOdGlsZGUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgIk9kaWVyZXNpcyIsICJPZ3JhdmUiLCAiT3RpbGRlIiwgIlNjYXJvbiIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWRpZXJlc2lzIiwgIlVncmF2ZSIsICJZYWN1dGUiLCAiWWRpZXJlc2lzIiwgIlpjYXJvbiIsICJhYWN1dGUiLCAiYWNpcmN1bWZsZXgiLCAiYWRpZXJlc2lzIiwgImFncmF2ZSIsICJhcmluZyIsICJhdGlsZGUiLCAiY2NlZGlsbGEiLCAiZWFjdXRlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJlZ3JhdmUiLCAiaWFjdXRlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJpZ3JhdmUiLCAibnRpbGRlIiwgIm9hY3V0ZSIsICJvY2lyY3VtZmxleCIsICJvZGllcmVzaXMiLCAib2dyYXZlIiwgIm90aWxkZSIsICJzY2Fyb24iLCAidWFjdXRlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJ1Z3JhdmUiLCAieWFjdXRlIiwgInlkaWVyZXNpcyIsICJ6Y2Fyb24iXTsKZXhwb3J0cy5JU09BZG9iZUNoYXJzZXQgPSBJU09BZG9iZUNoYXJzZXQ7CmNvbnN0IEV4cGVydENoYXJzZXQgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZXhjbGFtc21hbGwiLCAiSHVuZ2FydW1sYXV0c21hbGwiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAiYW1wZXJzYW5kc21hbGwiLCAiQWN1dGVzbWFsbCIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJmcmFjdGlvbiIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImNvbW1hc3VwZXJpb3IiLCAidGhyZWVxdWFydGVyc2VtZGFzaCIsICJwZXJpb2RzdXBlcmlvciIsICJxdWVzdGlvbnNtYWxsIiwgImFzdXBlcmlvciIsICJic3VwZXJpb3IiLCAiY2VudHN1cGVyaW9yIiwgImRzdXBlcmlvciIsICJlc3VwZXJpb3IiLCAiaXN1cGVyaW9yIiwgImxzdXBlcmlvciIsICJtc3VwZXJpb3IiLCAibnN1cGVyaW9yIiwgIm9zdXBlcmlvciIsICJyc3VwZXJpb3IiLCAic3N1cGVyaW9yIiwgInRzdXBlcmlvciIsICJmZiIsICJmaSIsICJmbCIsICJmZmkiLCAiZmZsIiwgInBhcmVubGVmdGluZmVyaW9yIiwgInBhcmVucmlnaHRpbmZlcmlvciIsICJDaXJjdW1mbGV4c21hbGwiLCAiaHlwaGVuc3VwZXJpb3IiLCAiR3JhdmVzbWFsbCIsICJBc21hbGwiLCAiQnNtYWxsIiwgIkNzbWFsbCIsICJEc21hbGwiLCAiRXNtYWxsIiwgIkZzbWFsbCIsICJHc21hbGwiLCAiSHNtYWxsIiwgIklzbWFsbCIsICJKc21hbGwiLCAiS3NtYWxsIiwgIkxzbWFsbCIsICJNc21hbGwiLCAiTnNtYWxsIiwgIk9zbWFsbCIsICJQc21hbGwiLCAiUXNtYWxsIiwgIlJzbWFsbCIsICJTc21hbGwiLCAiVHNtYWxsIiwgIlVzbWFsbCIsICJWc21hbGwiLCAiV3NtYWxsIiwgIlhzbWFsbCIsICJZc21hbGwiLCAiWnNtYWxsIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJUaWxkZXNtYWxsIiwgImV4Y2xhbWRvd25zbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiTHNsYXNoc21hbGwiLCAiU2Nhcm9uc21hbGwiLCAiWmNhcm9uc21hbGwiLCAiRGllcmVzaXNzbWFsbCIsICJCcmV2ZXNtYWxsIiwgIkNhcm9uc21hbGwiLCAiRG90YWNjZW50c21hbGwiLCAiTWFjcm9uc21hbGwiLCAiZmlndXJlZGFzaCIsICJoeXBoZW5pbmZlcmlvciIsICJPZ29uZWtzbWFsbCIsICJSaW5nc21hbGwiLCAiQ2VkaWxsYXNtYWxsIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInF1ZXN0aW9uZG93bnNtYWxsIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICJ6ZXJvc3VwZXJpb3IiLCAib25lc3VwZXJpb3IiLCAidHdvc3VwZXJpb3IiLCAidGhyZWVzdXBlcmlvciIsICJmb3Vyc3VwZXJpb3IiLCAiZml2ZXN1cGVyaW9yIiwgInNpeHN1cGVyaW9yIiwgInNldmVuc3VwZXJpb3IiLCAiZWlnaHRzdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIm9uZWluZmVyaW9yIiwgInR3b2luZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgImZpdmVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgImVpZ2h0aW5mZXJpb3IiLCAibmluZWluZmVyaW9yIiwgImNlbnRpbmZlcmlvciIsICJkb2xsYXJpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJjb21tYWluZmVyaW9yIiwgIkFncmF2ZXNtYWxsIiwgIkFhY3V0ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXJpbmdzbWFsbCIsICJBRXNtYWxsIiwgIkNjZWRpbGxhc21hbGwiLCAiRWdyYXZlc21hbGwiLCAiRWFjdXRlc21hbGwiLCAiRWNpcmN1bWZsZXhzbWFsbCIsICJFZGllcmVzaXNzbWFsbCIsICJJZ3JhdmVzbWFsbCIsICJJYWN1dGVzbWFsbCIsICJJY2lyY3VtZmxleHNtYWxsIiwgIklkaWVyZXNpc3NtYWxsIiwgIkV0aHNtYWxsIiwgIk50aWxkZXNtYWxsIiwgIk9ncmF2ZXNtYWxsIiwgIk9hY3V0ZXNtYWxsIiwgIk9jaXJjdW1mbGV4c21hbGwiLCAiT3RpbGRlc21hbGwiLCAiT2RpZXJlc2lzc21hbGwiLCAiT0VzbWFsbCIsICJPc2xhc2hzbWFsbCIsICJVZ3JhdmVzbWFsbCIsICJVYWN1dGVzbWFsbCIsICJVY2lyY3VtZmxleHNtYWxsIiwgIlVkaWVyZXNpc3NtYWxsIiwgIllhY3V0ZXNtYWxsIiwgIlRob3Juc21hbGwiLCAiWWRpZXJlc2lzc21hbGwiXTsKZXhwb3J0cy5FeHBlcnRDaGFyc2V0ID0gRXhwZXJ0Q2hhcnNldDsKY29uc3QgRXhwZXJ0U3Vic2V0Q2hhcnNldCA9IFsiLm5vdGRlZiIsICJzcGFjZSIsICJkb2xsYXJvbGRzdHlsZSIsICJkb2xsYXJzdXBlcmlvciIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJmcmFjdGlvbiIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImNvbW1hc3VwZXJpb3IiLCAidGhyZWVxdWFydGVyc2VtZGFzaCIsICJwZXJpb2RzdXBlcmlvciIsICJhc3VwZXJpb3IiLCAiYnN1cGVyaW9yIiwgImNlbnRzdXBlcmlvciIsICJkc3VwZXJpb3IiLCAiZXN1cGVyaW9yIiwgImlzdXBlcmlvciIsICJsc3VwZXJpb3IiLCAibXN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJvc3VwZXJpb3IiLCAicnN1cGVyaW9yIiwgInNzdXBlcmlvciIsICJ0c3VwZXJpb3IiLCAiZmYiLCAiZmkiLCAiZmwiLCAiZmZpIiwgImZmbCIsICJwYXJlbmxlZnRpbmZlcmlvciIsICJwYXJlbnJpZ2h0aW5mZXJpb3IiLCAiaHlwaGVuc3VwZXJpb3IiLCAiY29sb25tb25ldGFyeSIsICJvbmVmaXR0ZWQiLCAicnVwaWFoIiwgImNlbnRvbGRzdHlsZSIsICJmaWd1cmVkYXNoIiwgImh5cGhlbmluZmVyaW9yIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICJ6ZXJvc3VwZXJpb3IiLCAib25lc3VwZXJpb3IiLCAidHdvc3VwZXJpb3IiLCAidGhyZWVzdXBlcmlvciIsICJmb3Vyc3VwZXJpb3IiLCAiZml2ZXN1cGVyaW9yIiwgInNpeHN1cGVyaW9yIiwgInNldmVuc3VwZXJpb3IiLCAiZWlnaHRzdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIm9uZWluZmVyaW9yIiwgInR3b2luZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgImZpdmVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgImVpZ2h0aW5mZXJpb3IiLCAibmluZWluZmVyaW9yIiwgImNlbnRpbmZlcmlvciIsICJkb2xsYXJpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJjb21tYWluZmVyaW9yIl07CmV4cG9ydHMuRXhwZXJ0U3Vic2V0Q2hhcnNldCA9IEV4cGVydFN1YnNldENoYXJzZXQ7CgovKioqLyB9KSwKLyogMzcgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5aYXBmRGluZ2JhdHNFbmNvZGluZyA9IGV4cG9ydHMuV2luQW5zaUVuY29kaW5nID0gZXhwb3J0cy5TeW1ib2xTZXRFbmNvZGluZyA9IGV4cG9ydHMuU3RhbmRhcmRFbmNvZGluZyA9IGV4cG9ydHMuTWFjUm9tYW5FbmNvZGluZyA9IGV4cG9ydHMuRXhwZXJ0RW5jb2RpbmcgPSB2b2lkIDA7CmV4cG9ydHMuZ2V0RW5jb2RpbmcgPSBnZXRFbmNvZGluZzsKY29uc3QgRXhwZXJ0RW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtc21hbGwiLCAiSHVuZ2FydW1sYXV0c21hbGwiLCAiIiwgImRvbGxhcm9sZHN0eWxlIiwgImRvbGxhcnN1cGVyaW9yIiwgImFtcGVyc2FuZHNtYWxsIiwgIkFjdXRlc21hbGwiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAiZnJhY3Rpb24iLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAicXVlc3Rpb25zbWFsbCIsICIiLCAiYXN1cGVyaW9yIiwgImJzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgImVzdXBlcmlvciIsICIiLCAiIiwgIiIsICJpc3VwZXJpb3IiLCAiIiwgIiIsICJsc3VwZXJpb3IiLCAibXN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJvc3VwZXJpb3IiLCAiIiwgIiIsICJyc3VwZXJpb3IiLCAic3N1cGVyaW9yIiwgInRzdXBlcmlvciIsICIiLCAiZmYiLCAiZmkiLCAiZmwiLCAiZmZpIiwgImZmbCIsICJwYXJlbmxlZnRpbmZlcmlvciIsICIiLCAicGFyZW5yaWdodGluZmVyaW9yIiwgIkNpcmN1bWZsZXhzbWFsbCIsICJoeXBoZW5zdXBlcmlvciIsICJHcmF2ZXNtYWxsIiwgIkFzbWFsbCIsICJCc21hbGwiLCAiQ3NtYWxsIiwgIkRzbWFsbCIsICJFc21hbGwiLCAiRnNtYWxsIiwgIkdzbWFsbCIsICJIc21hbGwiLCAiSXNtYWxsIiwgIkpzbWFsbCIsICJLc21hbGwiLCAiTHNtYWxsIiwgIk1zbWFsbCIsICJOc21hbGwiLCAiT3NtYWxsIiwgIlBzbWFsbCIsICJRc21hbGwiLCAiUnNtYWxsIiwgIlNzbWFsbCIsICJUc21hbGwiLCAiVXNtYWxsIiwgIlZzbWFsbCIsICJXc21hbGwiLCAiWHNtYWxsIiwgIllzbWFsbCIsICJac21hbGwiLCAiY29sb25tb25ldGFyeSIsICJvbmVmaXR0ZWQiLCAicnVwaWFoIiwgIlRpbGRlc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgImV4Y2xhbWRvd25zbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiTHNsYXNoc21hbGwiLCAiIiwgIiIsICJTY2Fyb25zbWFsbCIsICJaY2Fyb25zbWFsbCIsICJEaWVyZXNpc3NtYWxsIiwgIkJyZXZlc21hbGwiLCAiQ2Fyb25zbWFsbCIsICIiLCAiRG90YWNjZW50c21hbGwiLCAiIiwgIiIsICJNYWNyb25zbWFsbCIsICIiLCAiIiwgImZpZ3VyZWRhc2giLCAiaHlwaGVuaW5mZXJpb3IiLCAiIiwgIiIsICJPZ29uZWtzbWFsbCIsICJSaW5nc21hbGwiLCAiQ2VkaWxsYXNtYWxsIiwgIiIsICIiLCAiIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInF1ZXN0aW9uZG93bnNtYWxsIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICIiLCAiIiwgInplcm9zdXBlcmlvciIsICJvbmVzdXBlcmlvciIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImZvdXJzdXBlcmlvciIsICJmaXZlc3VwZXJpb3IiLCAic2l4c3VwZXJpb3IiLCAic2V2ZW5zdXBlcmlvciIsICJlaWdodHN1cGVyaW9yIiwgIm5pbmVzdXBlcmlvciIsICJ6ZXJvaW5mZXJpb3IiLCAib25laW5mZXJpb3IiLCAidHdvaW5mZXJpb3IiLCAidGhyZWVpbmZlcmlvciIsICJmb3VyaW5mZXJpb3IiLCAiZml2ZWluZmVyaW9yIiwgInNpeGluZmVyaW9yIiwgInNldmVuaW5mZXJpb3IiLCAiZWlnaHRpbmZlcmlvciIsICJuaW5laW5mZXJpb3IiLCAiY2VudGluZmVyaW9yIiwgImRvbGxhcmluZmVyaW9yIiwgInBlcmlvZGluZmVyaW9yIiwgImNvbW1haW5mZXJpb3IiLCAiQWdyYXZlc21hbGwiLCAiQWFjdXRlc21hbGwiLCAiQWNpcmN1bWZsZXhzbWFsbCIsICJBdGlsZGVzbWFsbCIsICJBZGllcmVzaXNzbWFsbCIsICJBcmluZ3NtYWxsIiwgIkFFc21hbGwiLCAiQ2NlZGlsbGFzbWFsbCIsICJFZ3JhdmVzbWFsbCIsICJFYWN1dGVzbWFsbCIsICJFY2lyY3VtZmxleHNtYWxsIiwgIkVkaWVyZXNpc3NtYWxsIiwgIklncmF2ZXNtYWxsIiwgIklhY3V0ZXNtYWxsIiwgIkljaXJjdW1mbGV4c21hbGwiLCAiSWRpZXJlc2lzc21hbGwiLCAiRXRoc21hbGwiLCAiTnRpbGRlc21hbGwiLCAiT2dyYXZlc21hbGwiLCAiT2FjdXRlc21hbGwiLCAiT2NpcmN1bWZsZXhzbWFsbCIsICJPdGlsZGVzbWFsbCIsICJPZGllcmVzaXNzbWFsbCIsICJPRXNtYWxsIiwgIk9zbGFzaHNtYWxsIiwgIlVncmF2ZXNtYWxsIiwgIlVhY3V0ZXNtYWxsIiwgIlVjaXJjdW1mbGV4c21hbGwiLCAiVWRpZXJlc2lzc21hbGwiLCAiWWFjdXRlc21hbGwiLCAiVGhvcm5zbWFsbCIsICJZZGllcmVzaXNzbWFsbCJdOwpleHBvcnRzLkV4cGVydEVuY29kaW5nID0gRXhwZXJ0RW5jb2Rpbmc7CmNvbnN0IE1hY0V4cGVydEVuY29kaW5nID0gWyIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgInNwYWNlIiwgImV4Y2xhbXNtYWxsIiwgIkh1bmdhcnVtbGF1dHNtYWxsIiwgImNlbnRvbGRzdHlsZSIsICJkb2xsYXJvbGRzdHlsZSIsICJkb2xsYXJzdXBlcmlvciIsICJhbXBlcnNhbmRzbWFsbCIsICJBY3V0ZXNtYWxsIiwgInBhcmVubGVmdHN1cGVyaW9yIiwgInBhcmVucmlnaHRzdXBlcmlvciIsICJ0d29kb3RlbmxlYWRlciIsICJvbmVkb3RlbmxlYWRlciIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgImZyYWN0aW9uIiwgInplcm9vbGRzdHlsZSIsICJvbmVvbGRzdHlsZSIsICJ0d29vbGRzdHlsZSIsICJ0aHJlZW9sZHN0eWxlIiwgImZvdXJvbGRzdHlsZSIsICJmaXZlb2xkc3R5bGUiLCAic2l4b2xkc3R5bGUiLCAic2V2ZW5vbGRzdHlsZSIsICJlaWdodG9sZHN0eWxlIiwgIm5pbmVvbGRzdHlsZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAiIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAiIiwgInF1ZXN0aW9uc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIkV0aHNtYWxsIiwgIiIsICIiLCAib25lcXVhcnRlciIsICJvbmVoYWxmIiwgInRocmVlcXVhcnRlcnMiLCAib25lZWlnaHRoIiwgInRocmVlZWlnaHRocyIsICJmaXZlZWlnaHRocyIsICJzZXZlbmVpZ2h0aHMiLCAib25ldGhpcmQiLCAidHdvdGhpcmRzIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgImZmIiwgImZpIiwgImZsIiwgImZmaSIsICJmZmwiLCAicGFyZW5sZWZ0aW5mZXJpb3IiLCAiIiwgInBhcmVucmlnaHRpbmZlcmlvciIsICJDaXJjdW1mbGV4c21hbGwiLCAiaHlwaGVuaW5mZXJpb3IiLCAiR3JhdmVzbWFsbCIsICJBc21hbGwiLCAiQnNtYWxsIiwgIkNzbWFsbCIsICJEc21hbGwiLCAiRXNtYWxsIiwgIkZzbWFsbCIsICJHc21hbGwiLCAiSHNtYWxsIiwgIklzbWFsbCIsICJKc21hbGwiLCAiS3NtYWxsIiwgIkxzbWFsbCIsICJNc21hbGwiLCAiTnNtYWxsIiwgIk9zbWFsbCIsICJQc21hbGwiLCAiUXNtYWxsIiwgIlJzbWFsbCIsICJTc21hbGwiLCAiVHNtYWxsIiwgIlVzbWFsbCIsICJWc21hbGwiLCAiV3NtYWxsIiwgIlhzbWFsbCIsICJZc21hbGwiLCAiWnNtYWxsIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJUaWxkZXNtYWxsIiwgIiIsICIiLCAiYXN1cGVyaW9yIiwgImNlbnRzdXBlcmlvciIsICIiLCAiIiwgIiIsICIiLCAiQWFjdXRlc21hbGwiLCAiQWdyYXZlc21hbGwiLCAiQWNpcmN1bWZsZXhzbWFsbCIsICJBZGllcmVzaXNzbWFsbCIsICJBdGlsZGVzbWFsbCIsICJBcmluZ3NtYWxsIiwgIkNjZWRpbGxhc21hbGwiLCAiRWFjdXRlc21hbGwiLCAiRWdyYXZlc21hbGwiLCAiRWNpcmN1bWZsZXhzbWFsbCIsICJFZGllcmVzaXNzbWFsbCIsICJJYWN1dGVzbWFsbCIsICJJZ3JhdmVzbWFsbCIsICJJY2lyY3VtZmxleHNtYWxsIiwgIklkaWVyZXNpc3NtYWxsIiwgIk50aWxkZXNtYWxsIiwgIk9hY3V0ZXNtYWxsIiwgIk9ncmF2ZXNtYWxsIiwgIk9jaXJjdW1mbGV4c21hbGwiLCAiT2RpZXJlc2lzc21hbGwiLCAiT3RpbGRlc21hbGwiLCAiVWFjdXRlc21hbGwiLCAiVWdyYXZlc21hbGwiLCAiVWNpcmN1bWZsZXhzbWFsbCIsICJVZGllcmVzaXNzbWFsbCIsICIiLCAiZWlnaHRzdXBlcmlvciIsICJmb3VyaW5mZXJpb3IiLCAidGhyZWVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJlaWdodGluZmVyaW9yIiwgInNldmVuaW5mZXJpb3IiLCAiU2Nhcm9uc21hbGwiLCAiIiwgImNlbnRpbmZlcmlvciIsICJ0d29pbmZlcmlvciIsICIiLCAiRGllcmVzaXNzbWFsbCIsICIiLCAiQ2Fyb25zbWFsbCIsICJvc3VwZXJpb3IiLCAiZml2ZWluZmVyaW9yIiwgIiIsICJjb21tYWluZmVyaW9yIiwgInBlcmlvZGluZmVyaW9yIiwgIllhY3V0ZXNtYWxsIiwgIiIsICJkb2xsYXJpbmZlcmlvciIsICIiLCAiIiwgIlRob3Juc21hbGwiLCAiIiwgIm5pbmVpbmZlcmlvciIsICJ6ZXJvaW5mZXJpb3IiLCAiWmNhcm9uc21hbGwiLCAiQUVzbWFsbCIsICJPc2xhc2hzbWFsbCIsICJxdWVzdGlvbmRvd25zbWFsbCIsICJvbmVpbmZlcmlvciIsICJMc2xhc2hzbWFsbCIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJDZWRpbGxhc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJPRXNtYWxsIiwgImZpZ3VyZWRhc2giLCAiaHlwaGVuc3VwZXJpb3IiLCAiIiwgIiIsICIiLCAiIiwgImV4Y2xhbWRvd25zbWFsbCIsICIiLCAiWWRpZXJlc2lzc21hbGwiLCAiIiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAiZm91cnN1cGVyaW9yIiwgImZpdmVzdXBlcmlvciIsICJzaXhzdXBlcmlvciIsICJzZXZlbnN1cGVyaW9yIiwgIm5pbmVzdXBlcmlvciIsICJ6ZXJvc3VwZXJpb3IiLCAiIiwgImVzdXBlcmlvciIsICJyc3VwZXJpb3IiLCAidHN1cGVyaW9yIiwgIiIsICIiLCAiaXN1cGVyaW9yIiwgInNzdXBlcmlvciIsICJkc3VwZXJpb3IiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJsc3VwZXJpb3IiLCAiT2dvbmVrc21hbGwiLCAiQnJldmVzbWFsbCIsICJNYWNyb25zbWFsbCIsICJic3VwZXJpb3IiLCAibnN1cGVyaW9yIiwgIm1zdXBlcmlvciIsICJjb21tYXN1cGVyaW9yIiwgInBlcmlvZHN1cGVyaW9yIiwgIkRvdGFjY2VudHNtYWxsIiwgIlJpbmdzbWFsbCIsICIiLCAiIiwgIiIsICIiXTsKY29uc3QgTWFjUm9tYW5FbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVzaW5nbGUiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgImdyYXZlIiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICIiLCAiQWRpZXJlc2lzIiwgIkFyaW5nIiwgIkNjZWRpbGxhIiwgIkVhY3V0ZSIsICJOdGlsZGUiLCAiT2RpZXJlc2lzIiwgIlVkaWVyZXNpcyIsICJhYWN1dGUiLCAiYWdyYXZlIiwgImFjaXJjdW1mbGV4IiwgImFkaWVyZXNpcyIsICJhdGlsZGUiLCAiYXJpbmciLCAiY2NlZGlsbGEiLCAiZWFjdXRlIiwgImVncmF2ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiaWFjdXRlIiwgImlncmF2ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAibnRpbGRlIiwgIm9hY3V0ZSIsICJvZ3JhdmUiLCAib2NpcmN1bWZsZXgiLCAib2RpZXJlc2lzIiwgIm90aWxkZSIsICJ1YWN1dGUiLCAidWdyYXZlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJkYWdnZXIiLCAiZGVncmVlIiwgImNlbnQiLCAic3RlcmxpbmciLCAic2VjdGlvbiIsICJidWxsZXQiLCAicGFyYWdyYXBoIiwgImdlcm1hbmRibHMiLCAicmVnaXN0ZXJlZCIsICJjb3B5cmlnaHQiLCAidHJhZGVtYXJrIiwgImFjdXRlIiwgImRpZXJlc2lzIiwgIm5vdGVxdWFsIiwgIkFFIiwgIk9zbGFzaCIsICJpbmZpbml0eSIsICJwbHVzbWludXMiLCAibGVzc2VxdWFsIiwgImdyZWF0ZXJlcXVhbCIsICJ5ZW4iLCAibXUiLCAicGFydGlhbGRpZmYiLCAic3VtbWF0aW9uIiwgInByb2R1Y3QiLCAicGkiLCAiaW50ZWdyYWwiLCAib3JkZmVtaW5pbmUiLCAib3JkbWFzY3VsaW5lIiwgIk9tZWdhIiwgImFlIiwgIm9zbGFzaCIsICJxdWVzdGlvbmRvd24iLCAiZXhjbGFtZG93biIsICJsb2dpY2Fsbm90IiwgInJhZGljYWwiLCAiZmxvcmluIiwgImFwcHJveGVxdWFsIiwgIkRlbHRhIiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAic3BhY2UiLCAiQWdyYXZlIiwgIkF0aWxkZSIsICJPdGlsZGUiLCAiT0UiLCAib2UiLCAiZW5kYXNoIiwgImVtZGFzaCIsICJxdW90ZWRibGxlZnQiLCAicXVvdGVkYmxyaWdodCIsICJxdW90ZWxlZnQiLCAicXVvdGVyaWdodCIsICJkaXZpZGUiLCAibG96ZW5nZSIsICJ5ZGllcmVzaXMiLCAiWWRpZXJlc2lzIiwgImZyYWN0aW9uIiwgImN1cnJlbmN5IiwgImd1aWxzaW5nbGxlZnQiLCAiZ3VpbHNpbmdscmlnaHQiLCAiZmkiLCAiZmwiLCAiZGFnZ2VyZGJsIiwgInBlcmlvZGNlbnRlcmVkIiwgInF1b3Rlc2luZ2xiYXNlIiwgInF1b3RlZGJsYmFzZSIsICJwZXJ0aG91c2FuZCIsICJBY2lyY3VtZmxleCIsICJFY2lyY3VtZmxleCIsICJBYWN1dGUiLCAiRWRpZXJlc2lzIiwgIkVncmF2ZSIsICJJYWN1dGUiLCAiSWNpcmN1bWZsZXgiLCAiSWRpZXJlc2lzIiwgIklncmF2ZSIsICJPYWN1dGUiLCAiT2NpcmN1bWZsZXgiLCAiYXBwbGUiLCAiT2dyYXZlIiwgIlVhY3V0ZSIsICJVY2lyY3VtZmxleCIsICJVZ3JhdmUiLCAiZG90bGVzc2kiLCAiY2lyY3VtZmxleCIsICJ0aWxkZSIsICJtYWNyb24iLCAiYnJldmUiLCAiZG90YWNjZW50IiwgInJpbmciLCAiY2VkaWxsYSIsICJodW5nYXJ1bWxhdXQiLCAib2dvbmVrIiwgImNhcm9uIl07CmV4cG9ydHMuTWFjUm9tYW5FbmNvZGluZyA9IE1hY1JvbWFuRW5jb2Rpbmc7CmNvbnN0IFN0YW5kYXJkRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3RlcmlnaHQiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgInF1b3RlbGVmdCIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJmcmFjdGlvbiIsICJ5ZW4iLCAiZmxvcmluIiwgInNlY3Rpb24iLCAiY3VycmVuY3kiLCAicXVvdGVzaW5nbGUiLCAicXVvdGVkYmxsZWZ0IiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICIiLCAiZW5kYXNoIiwgImRhZ2dlciIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAiIiwgInBhcmFncmFwaCIsICJidWxsZXQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInF1b3RlZGJscmlnaHQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAicGVydGhvdXNhbmQiLCAiIiwgInF1ZXN0aW9uZG93biIsICIiLCAiZ3JhdmUiLCAiYWN1dGUiLCAiY2lyY3VtZmxleCIsICJ0aWxkZSIsICJtYWNyb24iLCAiYnJldmUiLCAiZG90YWNjZW50IiwgImRpZXJlc2lzIiwgIiIsICJyaW5nIiwgImNlZGlsbGEiLCAiIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iLCAiZW1kYXNoIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJBRSIsICIiLCAib3JkZmVtaW5pbmUiLCAiIiwgIiIsICIiLCAiIiwgIkxzbGFzaCIsICJPc2xhc2giLCAiT0UiLCAib3JkbWFzY3VsaW5lIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiYWUiLCAiIiwgIiIsICIiLCAiZG90bGVzc2kiLCAiIiwgIiIsICJsc2xhc2giLCAib3NsYXNoIiwgIm9lIiwgImdlcm1hbmRibHMiLCAiIiwgIiIsICIiLCAiIl07CmV4cG9ydHMuU3RhbmRhcmRFbmNvZGluZyA9IFN0YW5kYXJkRW5jb2Rpbmc7CmNvbnN0IFdpbkFuc2lFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVzaW5nbGUiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgImdyYXZlIiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICJidWxsZXQiLCAiRXVybyIsICJidWxsZXQiLCAicXVvdGVzaW5nbGJhc2UiLCAiZmxvcmluIiwgInF1b3RlZGJsYmFzZSIsICJlbGxpcHNpcyIsICJkYWdnZXIiLCAiZGFnZ2VyZGJsIiwgImNpcmN1bWZsZXgiLCAicGVydGhvdXNhbmQiLCAiU2Nhcm9uIiwgImd1aWxzaW5nbGxlZnQiLCAiT0UiLCAiYnVsbGV0IiwgIlpjYXJvbiIsICJidWxsZXQiLCAiYnVsbGV0IiwgInF1b3RlbGVmdCIsICJxdW90ZXJpZ2h0IiwgInF1b3RlZGJsbGVmdCIsICJxdW90ZWRibHJpZ2h0IiwgImJ1bGxldCIsICJlbmRhc2giLCAiZW1kYXNoIiwgInRpbGRlIiwgInRyYWRlbWFyayIsICJzY2Fyb24iLCAiZ3VpbHNpbmdscmlnaHQiLCAib2UiLCAiYnVsbGV0IiwgInpjYXJvbiIsICJZZGllcmVzaXMiLCAic3BhY2UiLCAiZXhjbGFtZG93biIsICJjZW50IiwgInN0ZXJsaW5nIiwgImN1cnJlbmN5IiwgInllbiIsICJicm9rZW5iYXIiLCAic2VjdGlvbiIsICJkaWVyZXNpcyIsICJjb3B5cmlnaHQiLCAib3JkZmVtaW5pbmUiLCAiZ3VpbGxlbW90bGVmdCIsICJsb2dpY2Fsbm90IiwgImh5cGhlbiIsICJyZWdpc3RlcmVkIiwgIm1hY3JvbiIsICJkZWdyZWUiLCAicGx1c21pbnVzIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAiYWN1dGUiLCAibXUiLCAicGFyYWdyYXBoIiwgInBlcmlvZGNlbnRlcmVkIiwgImNlZGlsbGEiLCAib25lc3VwZXJpb3IiLCAib3JkbWFzY3VsaW5lIiwgImd1aWxsZW1vdHJpZ2h0IiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInF1ZXN0aW9uZG93biIsICJBZ3JhdmUiLCAiQWFjdXRlIiwgIkFjaXJjdW1mbGV4IiwgIkF0aWxkZSIsICJBZGllcmVzaXMiLCAiQXJpbmciLCAiQUUiLCAiQ2NlZGlsbGEiLCAiRWdyYXZlIiwgIkVhY3V0ZSIsICJFY2lyY3VtZmxleCIsICJFZGllcmVzaXMiLCAiSWdyYXZlIiwgIklhY3V0ZSIsICJJY2lyY3VtZmxleCIsICJJZGllcmVzaXMiLCAiRXRoIiwgIk50aWxkZSIsICJPZ3JhdmUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgIk90aWxkZSIsICJPZGllcmVzaXMiLCAibXVsdGlwbHkiLCAiT3NsYXNoIiwgIlVncmF2ZSIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWRpZXJlc2lzIiwgIllhY3V0ZSIsICJUaG9ybiIsICJnZXJtYW5kYmxzIiwgImFncmF2ZSIsICJhYWN1dGUiLCAiYWNpcmN1bWZsZXgiLCAiYXRpbGRlIiwgImFkaWVyZXNpcyIsICJhcmluZyIsICJhZSIsICJjY2VkaWxsYSIsICJlZ3JhdmUiLCAiZWFjdXRlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJpZ3JhdmUiLCAiaWFjdXRlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJldGgiLCAibnRpbGRlIiwgIm9ncmF2ZSIsICJvYWN1dGUiLCAib2NpcmN1bWZsZXgiLCAib3RpbGRlIiwgIm9kaWVyZXNpcyIsICJkaXZpZGUiLCAib3NsYXNoIiwgInVncmF2ZSIsICJ1YWN1dGUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgInlhY3V0ZSIsICJ0aG9ybiIsICJ5ZGllcmVzaXMiXTsKZXhwb3J0cy5XaW5BbnNpRW5jb2RpbmcgPSBXaW5BbnNpRW5jb2Rpbmc7CmNvbnN0IFN5bWJvbFNldEVuY29kaW5nID0gWyIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgInNwYWNlIiwgImV4Y2xhbSIsICJ1bml2ZXJzYWwiLCAibnVtYmVyc2lnbiIsICJleGlzdGVudGlhbCIsICJwZXJjZW50IiwgImFtcGVyc2FuZCIsICJzdWNodGhhdCIsICJwYXJlbmxlZnQiLCAicGFyZW5yaWdodCIsICJhc3Rlcmlza21hdGgiLCAicGx1cyIsICJjb21tYSIsICJtaW51cyIsICJwZXJpb2QiLCAic2xhc2giLCAiemVybyIsICJvbmUiLCAidHdvIiwgInRocmVlIiwgImZvdXIiLCAiZml2ZSIsICJzaXgiLCAic2V2ZW4iLCAiZWlnaHQiLCAibmluZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAibGVzcyIsICJlcXVhbCIsICJncmVhdGVyIiwgInF1ZXN0aW9uIiwgImNvbmdydWVudCIsICJBbHBoYSIsICJCZXRhIiwgIkNoaSIsICJEZWx0YSIsICJFcHNpbG9uIiwgIlBoaSIsICJHYW1tYSIsICJFdGEiLCAiSW90YSIsICJ0aGV0YTEiLCAiS2FwcGEiLCAiTGFtYmRhIiwgIk11IiwgIk51IiwgIk9taWNyb24iLCAiUGkiLCAiVGhldGEiLCAiUmhvIiwgIlNpZ21hIiwgIlRhdSIsICJVcHNpbG9uIiwgInNpZ21hMSIsICJPbWVnYSIsICJYaSIsICJQc2kiLCAiWmV0YSIsICJicmFja2V0bGVmdCIsICJ0aGVyZWZvcmUiLCAiYnJhY2tldHJpZ2h0IiwgInBlcnBlbmRpY3VsYXIiLCAidW5kZXJzY29yZSIsICJyYWRpY2FsZXgiLCAiYWxwaGEiLCAiYmV0YSIsICJjaGkiLCAiZGVsdGEiLCAiZXBzaWxvbiIsICJwaGkiLCAiZ2FtbWEiLCAiZXRhIiwgImlvdGEiLCAicGhpMSIsICJrYXBwYSIsICJsYW1iZGEiLCAibXUiLCAibnUiLCAib21pY3JvbiIsICJwaSIsICJ0aGV0YSIsICJyaG8iLCAic2lnbWEiLCAidGF1IiwgInVwc2lsb24iLCAib21lZ2ExIiwgIm9tZWdhIiwgInhpIiwgInBzaSIsICJ6ZXRhIiwgImJyYWNlbGVmdCIsICJiYXIiLCAiYnJhY2VyaWdodCIsICJzaW1pbGFyIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIkV1cm8iLCAiVXBzaWxvbjEiLCAibWludXRlIiwgImxlc3NlcXVhbCIsICJmcmFjdGlvbiIsICJpbmZpbml0eSIsICJmbG9yaW4iLCAiY2x1YiIsICJkaWFtb25kIiwgImhlYXJ0IiwgInNwYWRlIiwgImFycm93Ym90aCIsICJhcnJvd2xlZnQiLCAiYXJyb3d1cCIsICJhcnJvd3JpZ2h0IiwgImFycm93ZG93biIsICJkZWdyZWUiLCAicGx1c21pbnVzIiwgInNlY29uZCIsICJncmVhdGVyZXF1YWwiLCAibXVsdGlwbHkiLCAicHJvcG9ydGlvbmFsIiwgInBhcnRpYWxkaWZmIiwgImJ1bGxldCIsICJkaXZpZGUiLCAibm90ZXF1YWwiLCAiZXF1aXZhbGVuY2UiLCAiYXBwcm94ZXF1YWwiLCAiZWxsaXBzaXMiLCAiYXJyb3d2ZXJ0ZXgiLCAiYXJyb3dob3JpemV4IiwgImNhcnJpYWdlcmV0dXJuIiwgImFsZXBoIiwgIklmcmFrdHVyIiwgIlJmcmFrdHVyIiwgIndlaWVyc3RyYXNzIiwgImNpcmNsZW11bHRpcGx5IiwgImNpcmNsZXBsdXMiLCAiZW1wdHlzZXQiLCAiaW50ZXJzZWN0aW9uIiwgInVuaW9uIiwgInByb3BlcnN1cGVyc2V0IiwgInJlZmxleHN1cGVyc2V0IiwgIm5vdHN1YnNldCIsICJwcm9wZXJzdWJzZXQiLCAicmVmbGV4c3Vic2V0IiwgImVsZW1lbnQiLCAibm90ZWxlbWVudCIsICJhbmdsZSIsICJncmFkaWVudCIsICJyZWdpc3RlcnNlcmlmIiwgImNvcHlyaWdodHNlcmlmIiwgInRyYWRlbWFya3NlcmlmIiwgInByb2R1Y3QiLCAicmFkaWNhbCIsICJkb3RtYXRoIiwgImxvZ2ljYWxub3QiLCAibG9naWNhbGFuZCIsICJsb2dpY2Fsb3IiLCAiYXJyb3dkYmxib3RoIiwgImFycm93ZGJsbGVmdCIsICJhcnJvd2RibHVwIiwgImFycm93ZGJscmlnaHQiLCAiYXJyb3dkYmxkb3duIiwgImxvemVuZ2UiLCAiYW5nbGVsZWZ0IiwgInJlZ2lzdGVyc2FucyIsICJjb3B5cmlnaHRzYW5zIiwgInRyYWRlbWFya3NhbnMiLCAic3VtbWF0aW9uIiwgInBhcmVubGVmdHRwIiwgInBhcmVubGVmdGV4IiwgInBhcmVubGVmdGJ0IiwgImJyYWNrZXRsZWZ0dHAiLCAiYnJhY2tldGxlZnRleCIsICJicmFja2V0bGVmdGJ0IiwgImJyYWNlbGVmdHRwIiwgImJyYWNlbGVmdG1pZCIsICJicmFjZWxlZnRidCIsICJicmFjZWV4IiwgIiIsICJhbmdsZXJpZ2h0IiwgImludGVncmFsIiwgImludGVncmFsdHAiLCAiaW50ZWdyYWxleCIsICJpbnRlZ3JhbGJ0IiwgInBhcmVucmlnaHR0cCIsICJwYXJlbnJpZ2h0ZXgiLCAicGFyZW5yaWdodGJ0IiwgImJyYWNrZXRyaWdodHRwIiwgImJyYWNrZXRyaWdodGV4IiwgImJyYWNrZXRyaWdodGJ0IiwgImJyYWNlcmlnaHR0cCIsICJicmFjZXJpZ2h0bWlkIiwgImJyYWNlcmlnaHRidCIsICIiXTsKZXhwb3J0cy5TeW1ib2xTZXRFbmNvZGluZyA9IFN5bWJvbFNldEVuY29kaW5nOwpjb25zdCBaYXBmRGluZ2JhdHNFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJhMSIsICJhMiIsICJhMjAyIiwgImEzIiwgImE0IiwgImE1IiwgImExMTkiLCAiYTExOCIsICJhMTE3IiwgImExMSIsICJhMTIiLCAiYTEzIiwgImExNCIsICJhMTUiLCAiYTE2IiwgImExMDUiLCAiYTE3IiwgImExOCIsICJhMTkiLCAiYTIwIiwgImEyMSIsICJhMjIiLCAiYTIzIiwgImEyNCIsICJhMjUiLCAiYTI2IiwgImEyNyIsICJhMjgiLCAiYTYiLCAiYTciLCAiYTgiLCAiYTkiLCAiYTEwIiwgImEyOSIsICJhMzAiLCAiYTMxIiwgImEzMiIsICJhMzMiLCAiYTM0IiwgImEzNSIsICJhMzYiLCAiYTM3IiwgImEzOCIsICJhMzkiLCAiYTQwIiwgImE0MSIsICJhNDIiLCAiYTQzIiwgImE0NCIsICJhNDUiLCAiYTQ2IiwgImE0NyIsICJhNDgiLCAiYTQ5IiwgImE1MCIsICJhNTEiLCAiYTUyIiwgImE1MyIsICJhNTQiLCAiYTU1IiwgImE1NiIsICJhNTciLCAiYTU4IiwgImE1OSIsICJhNjAiLCAiYTYxIiwgImE2MiIsICJhNjMiLCAiYTY0IiwgImE2NSIsICJhNjYiLCAiYTY3IiwgImE2OCIsICJhNjkiLCAiYTcwIiwgImE3MSIsICJhNzIiLCAiYTczIiwgImE3NCIsICJhMjAzIiwgImE3NSIsICJhMjA0IiwgImE3NiIsICJhNzciLCAiYTc4IiwgImE3OSIsICJhODEiLCAiYTgyIiwgImE4MyIsICJhODQiLCAiYTk3IiwgImE5OCIsICJhOTkiLCAiYTEwMCIsICIiLCAiYTg5IiwgImE5MCIsICJhOTMiLCAiYTk0IiwgImE5MSIsICJhOTIiLCAiYTIwNSIsICJhODUiLCAiYTIwNiIsICJhODYiLCAiYTg3IiwgImE4OCIsICJhOTUiLCAiYTk2IiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJhMTAxIiwgImExMDIiLCAiYTEwMyIsICJhMTA0IiwgImExMDYiLCAiYTEwNyIsICJhMTA4IiwgImExMTIiLCAiYTExMSIsICJhMTEwIiwgImExMDkiLCAiYTEyMCIsICJhMTIxIiwgImExMjIiLCAiYTEyMyIsICJhMTI0IiwgImExMjUiLCAiYTEyNiIsICJhMTI3IiwgImExMjgiLCAiYTEyOSIsICJhMTMwIiwgImExMzEiLCAiYTEzMiIsICJhMTMzIiwgImExMzQiLCAiYTEzNSIsICJhMTM2IiwgImExMzciLCAiYTEzOCIsICJhMTM5IiwgImExNDAiLCAiYTE0MSIsICJhMTQyIiwgImExNDMiLCAiYTE0NCIsICJhMTQ1IiwgImExNDYiLCAiYTE0NyIsICJhMTQ4IiwgImExNDkiLCAiYTE1MCIsICJhMTUxIiwgImExNTIiLCAiYTE1MyIsICJhMTU0IiwgImExNTUiLCAiYTE1NiIsICJhMTU3IiwgImExNTgiLCAiYTE1OSIsICJhMTYwIiwgImExNjEiLCAiYTE2MyIsICJhMTY0IiwgImExOTYiLCAiYTE2NSIsICJhMTkyIiwgImExNjYiLCAiYTE2NyIsICJhMTY4IiwgImExNjkiLCAiYTE3MCIsICJhMTcxIiwgImExNzIiLCAiYTE3MyIsICJhMTYyIiwgImExNzQiLCAiYTE3NSIsICJhMTc2IiwgImExNzciLCAiYTE3OCIsICJhMTc5IiwgImExOTMiLCAiYTE4MCIsICJhMTk5IiwgImExODEiLCAiYTIwMCIsICJhMTgyIiwgIiIsICJhMjAxIiwgImExODMiLCAiYTE4NCIsICJhMTk3IiwgImExODUiLCAiYTE5NCIsICJhMTk4IiwgImExODYiLCAiYTE5NSIsICJhMTg3IiwgImExODgiLCAiYTE4OSIsICJhMTkwIiwgImExOTEiLCAiIl07CmV4cG9ydHMuWmFwZkRpbmdiYXRzRW5jb2RpbmcgPSBaYXBmRGluZ2JhdHNFbmNvZGluZzsKCmZ1bmN0aW9uIGdldEVuY29kaW5nKGVuY29kaW5nTmFtZSkgewogIHN3aXRjaCAoZW5jb2RpbmdOYW1lKSB7CiAgICBjYXNlICJXaW5BbnNpRW5jb2RpbmciOgogICAgICByZXR1cm4gV2luQW5zaUVuY29kaW5nOwoKICAgIGNhc2UgIlN0YW5kYXJkRW5jb2RpbmciOgogICAgICByZXR1cm4gU3RhbmRhcmRFbmNvZGluZzsKCiAgICBjYXNlICJNYWNSb21hbkVuY29kaW5nIjoKICAgICAgcmV0dXJuIE1hY1JvbWFuRW5jb2Rpbmc7CgogICAgY2FzZSAiU3ltYm9sU2V0RW5jb2RpbmciOgogICAgICByZXR1cm4gU3ltYm9sU2V0RW5jb2Rpbmc7CgogICAgY2FzZSAiWmFwZkRpbmdiYXRzRW5jb2RpbmciOgogICAgICByZXR1cm4gWmFwZkRpbmdiYXRzRW5jb2Rpbmc7CgogICAgY2FzZSAiRXhwZXJ0RW5jb2RpbmciOgogICAgICByZXR1cm4gRXhwZXJ0RW5jb2Rpbmc7CgogICAgY2FzZSAiTWFjRXhwZXJ0RW5jb2RpbmciOgogICAgICByZXR1cm4gTWFjRXhwZXJ0RW5jb2Rpbmc7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIG51bGw7CiAgfQp9CgovKioqLyB9KSwKLyogMzggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TRUFDX0FOQUxZU0lTX0VOQUJMRUQgPSBleHBvcnRzLk1hY1N0YW5kYXJkR2x5cGhPcmRlcmluZyA9IGV4cG9ydHMuRm9udEZsYWdzID0gdm9pZCAwOwpleHBvcnRzLmdldEZvbnRUeXBlID0gZ2V0Rm9udFR5cGU7CmV4cG9ydHMubm9ybWFsaXplRm9udE5hbWUgPSBub3JtYWxpemVGb250TmFtZTsKZXhwb3J0cy5yZWNvdmVyR2x5cGhOYW1lID0gcmVjb3ZlckdseXBoTmFtZTsKZXhwb3J0cy50eXBlMUZvbnRHbHlwaE1hcHBpbmcgPSB0eXBlMUZvbnRHbHlwaE1hcHBpbmc7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKCnZhciBfZ2x5cGhsaXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygzOSk7Cgp2YXIgX3VuaWNvZGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQwKTsKCmNvbnN0IFNFQUNfQU5BTFlTSVNfRU5BQkxFRCA9IHRydWU7CmV4cG9ydHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEID0gU0VBQ19BTkFMWVNJU19FTkFCTEVEOwpjb25zdCBGb250RmxhZ3MgPSB7CiAgRml4ZWRQaXRjaDogMSwKICBTZXJpZjogMiwKICBTeW1ib2xpYzogNCwKICBTY3JpcHQ6IDgsCiAgTm9uc3ltYm9saWM6IDMyLAogIEl0YWxpYzogNjQsCiAgQWxsQ2FwOiA2NTUzNiwKICBTbWFsbENhcDogMTMxMDcyLAogIEZvcmNlQm9sZDogMjYyMTQ0Cn07CmV4cG9ydHMuRm9udEZsYWdzID0gRm9udEZsYWdzOwpjb25zdCBNYWNTdGFuZGFyZEdseXBoT3JkZXJpbmcgPSBbIi5ub3RkZWYiLCAiLm51bGwiLCAibm9ubWFya2luZ3JldHVybiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVzaW5nbGUiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgImdyYXZlIiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICJBZGllcmVzaXMiLCAiQXJpbmciLCAiQ2NlZGlsbGEiLCAiRWFjdXRlIiwgIk50aWxkZSIsICJPZGllcmVzaXMiLCAiVWRpZXJlc2lzIiwgImFhY3V0ZSIsICJhZ3JhdmUiLCAiYWNpcmN1bWZsZXgiLCAiYWRpZXJlc2lzIiwgImF0aWxkZSIsICJhcmluZyIsICJjY2VkaWxsYSIsICJlYWN1dGUiLCAiZWdyYXZlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJpYWN1dGUiLCAiaWdyYXZlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJudGlsZGUiLCAib2FjdXRlIiwgIm9ncmF2ZSIsICJvY2lyY3VtZmxleCIsICJvZGllcmVzaXMiLCAib3RpbGRlIiwgInVhY3V0ZSIsICJ1Z3JhdmUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgImRhZ2dlciIsICJkZWdyZWUiLCAiY2VudCIsICJzdGVybGluZyIsICJzZWN0aW9uIiwgImJ1bGxldCIsICJwYXJhZ3JhcGgiLCAiZ2VybWFuZGJscyIsICJyZWdpc3RlcmVkIiwgImNvcHlyaWdodCIsICJ0cmFkZW1hcmsiLCAiYWN1dGUiLCAiZGllcmVzaXMiLCAibm90ZXF1YWwiLCAiQUUiLCAiT3NsYXNoIiwgImluZmluaXR5IiwgInBsdXNtaW51cyIsICJsZXNzZXF1YWwiLCAiZ3JlYXRlcmVxdWFsIiwgInllbiIsICJtdSIsICJwYXJ0aWFsZGlmZiIsICJzdW1tYXRpb24iLCAicHJvZHVjdCIsICJwaSIsICJpbnRlZ3JhbCIsICJvcmRmZW1pbmluZSIsICJvcmRtYXNjdWxpbmUiLCAiT21lZ2EiLCAiYWUiLCAib3NsYXNoIiwgInF1ZXN0aW9uZG93biIsICJleGNsYW1kb3duIiwgImxvZ2ljYWxub3QiLCAicmFkaWNhbCIsICJmbG9yaW4iLCAiYXBwcm94ZXF1YWwiLCAiRGVsdGEiLCAiZ3VpbGxlbW90bGVmdCIsICJndWlsbGVtb3RyaWdodCIsICJlbGxpcHNpcyIsICJub25icmVha2luZ3NwYWNlIiwgIkFncmF2ZSIsICJBdGlsZGUiLCAiT3RpbGRlIiwgIk9FIiwgIm9lIiwgImVuZGFzaCIsICJlbWRhc2giLCAicXVvdGVkYmxsZWZ0IiwgInF1b3RlZGJscmlnaHQiLCAicXVvdGVsZWZ0IiwgInF1b3RlcmlnaHQiLCAiZGl2aWRlIiwgImxvemVuZ2UiLCAieWRpZXJlc2lzIiwgIllkaWVyZXNpcyIsICJmcmFjdGlvbiIsICJjdXJyZW5jeSIsICJndWlsc2luZ2xsZWZ0IiwgImd1aWxzaW5nbHJpZ2h0IiwgImZpIiwgImZsIiwgImRhZ2dlcmRibCIsICJwZXJpb2RjZW50ZXJlZCIsICJxdW90ZXNpbmdsYmFzZSIsICJxdW90ZWRibGJhc2UiLCAicGVydGhvdXNhbmQiLCAiQWNpcmN1bWZsZXgiLCAiRWNpcmN1bWZsZXgiLCAiQWFjdXRlIiwgIkVkaWVyZXNpcyIsICJFZ3JhdmUiLCAiSWFjdXRlIiwgIkljaXJjdW1mbGV4IiwgIklkaWVyZXNpcyIsICJJZ3JhdmUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgImFwcGxlIiwgIk9ncmF2ZSIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWdyYXZlIiwgImRvdGxlc3NpIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJyaW5nIiwgImNlZGlsbGEiLCAiaHVuZ2FydW1sYXV0IiwgIm9nb25layIsICJjYXJvbiIsICJMc2xhc2giLCAibHNsYXNoIiwgIlNjYXJvbiIsICJzY2Fyb24iLCAiWmNhcm9uIiwgInpjYXJvbiIsICJicm9rZW5iYXIiLCAiRXRoIiwgImV0aCIsICJZYWN1dGUiLCAieWFjdXRlIiwgIlRob3JuIiwgInRob3JuIiwgIm1pbnVzIiwgIm11bHRpcGx5IiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAib25laGFsZiIsICJvbmVxdWFydGVyIiwgInRocmVlcXVhcnRlcnMiLCAiZnJhbmMiLCAiR2JyZXZlIiwgImdicmV2ZSIsICJJZG90YWNjZW50IiwgIlNjZWRpbGxhIiwgInNjZWRpbGxhIiwgIkNhY3V0ZSIsICJjYWN1dGUiLCAiQ2Nhcm9uIiwgImNjYXJvbiIsICJkY3JvYXQiXTsKZXhwb3J0cy5NYWNTdGFuZGFyZEdseXBoT3JkZXJpbmcgPSBNYWNTdGFuZGFyZEdseXBoT3JkZXJpbmc7CgpmdW5jdGlvbiBnZXRGb250VHlwZSh0eXBlLCBzdWJ0eXBlLCBpc1N0YW5kYXJkRm9udCA9IGZhbHNlKSB7CiAgc3dpdGNoICh0eXBlKSB7CiAgICBjYXNlICJUeXBlMSI6CiAgICAgIGlmIChpc1N0YW5kYXJkRm9udCkgewogICAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5UWVBFMVNUQU5EQVJEOwogICAgICB9CgogICAgICByZXR1cm4gc3VidHlwZSA9PT0gIlR5cGUxQyIgPyBfdXRpbC5Gb250VHlwZS5UWVBFMUMgOiBfdXRpbC5Gb250VHlwZS5UWVBFMTsKCiAgICBjYXNlICJDSURGb250VHlwZTAiOgogICAgICByZXR1cm4gc3VidHlwZSA9PT0gIkNJREZvbnRUeXBlMEMiID8gX3V0aWwuRm9udFR5cGUuQ0lERk9OVFRZUEUwQyA6IF91dGlsLkZvbnRUeXBlLkNJREZPTlRUWVBFMDsKCiAgICBjYXNlICJPcGVuVHlwZSI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5PUEVOVFlQRTsKCiAgICBjYXNlICJUcnVlVHlwZSI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5UUlVFVFlQRTsKCiAgICBjYXNlICJDSURGb250VHlwZTIiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuQ0lERk9OVFRZUEUyOwoKICAgIGNhc2UgIk1NVHlwZTEiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuTU1UWVBFMTsKCiAgICBjYXNlICJUeXBlMCI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5UWVBFMDsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuVU5LTk9XTjsKICB9Cn0KCmZ1bmN0aW9uIHJlY292ZXJHbHlwaE5hbWUobmFtZSwgZ2x5cGhzVW5pY29kZU1hcCkgewogIGlmIChnbHlwaHNVbmljb2RlTWFwW25hbWVdICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBuYW1lOwogIH0KCiAgY29uc3QgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKG5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwoKICBpZiAodW5pY29kZSAhPT0gLTEpIHsKICAgIGZvciAoY29uc3Qga2V5IGluIGdseXBoc1VuaWNvZGVNYXApIHsKICAgICAgaWYgKGdseXBoc1VuaWNvZGVNYXBba2V5XSA9PT0gdW5pY29kZSkgewogICAgICAgIHJldHVybiBrZXk7CiAgICAgIH0KICAgIH0KICB9CgogICgwLCBfdXRpbC5pbmZvKSgiVW5hYmxlIHRvIHJlY292ZXIgYSBzdGFuZGFyZCBnbHlwaCBuYW1lIGZvcjogIiArIG5hbWUpOwogIHJldHVybiBuYW1lOwp9CgpmdW5jdGlvbiB0eXBlMUZvbnRHbHlwaE1hcHBpbmcocHJvcGVydGllcywgYnVpbHRJbkVuY29kaW5nLCBnbHlwaE5hbWVzKSB7CiAgY29uc3QgY2hhckNvZGVUb0dseXBoSWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIGxldCBnbHlwaElkLCBjaGFyQ29kZSwgYmFzZUVuY29kaW5nOwogIGNvbnN0IGlzU3ltYm9saWNGb250ID0gISEocHJvcGVydGllcy5mbGFncyAmIEZvbnRGbGFncy5TeW1ib2xpYyk7CgogIGlmIChwcm9wZXJ0aWVzLmlzSW50ZXJuYWxGb250KSB7CiAgICBiYXNlRW5jb2RpbmcgPSBidWlsdEluRW5jb2Rpbmc7CgogICAgZm9yIChjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgYmFzZUVuY29kaW5nLmxlbmd0aDsgY2hhckNvZGUrKykgewogICAgICBnbHlwaElkID0gZ2x5cGhOYW1lcy5pbmRleE9mKGJhc2VFbmNvZGluZ1tjaGFyQ29kZV0pOwoKICAgICAgaWYgKGdseXBoSWQgPj0gMCkgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gMDsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKSB7CiAgICBiYXNlRW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKTsKCiAgICBmb3IgKGNoYXJDb2RlID0gMDsgY2hhckNvZGUgPCBiYXNlRW5jb2RpbmcubGVuZ3RoOyBjaGFyQ29kZSsrKSB7CiAgICAgIGdseXBoSWQgPSBnbHlwaE5hbWVzLmluZGV4T2YoYmFzZUVuY29kaW5nW2NoYXJDb2RlXSk7CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSAwOwogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChpc1N5bWJvbGljRm9udCkgewogICAgZm9yIChjaGFyQ29kZSBpbiBidWlsdEluRW5jb2RpbmcpIHsKICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gYnVpbHRJbkVuY29kaW5nW2NoYXJDb2RlXTsKICAgIH0KICB9IGVsc2UgewogICAgYmFzZUVuY29kaW5nID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nOwoKICAgIGZvciAoY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IGJhc2VFbmNvZGluZy5sZW5ndGg7IGNoYXJDb2RlKyspIHsKICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihiYXNlRW5jb2RpbmdbY2hhckNvZGVdKTsKCiAgICAgIGlmIChnbHlwaElkID49IDApIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICB9IGVsc2UgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IDA7CiAgICAgIH0KICAgIH0KICB9CgogIGNvbnN0IGRpZmZlcmVuY2VzID0gcHJvcGVydGllcy5kaWZmZXJlbmNlczsKICBsZXQgZ2x5cGhzVW5pY29kZU1hcDsKCiAgaWYgKGRpZmZlcmVuY2VzKSB7CiAgICBmb3IgKGNoYXJDb2RlIGluIGRpZmZlcmVuY2VzKSB7CiAgICAgIGNvbnN0IGdseXBoTmFtZSA9IGRpZmZlcmVuY2VzW2NoYXJDb2RlXTsKICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihnbHlwaE5hbWUpOwoKICAgICAgaWYgKGdseXBoSWQgPT09IC0xKSB7CiAgICAgICAgaWYgKCFnbHlwaHNVbmljb2RlTWFwKSB7CiAgICAgICAgICBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHN0YW5kYXJkR2x5cGhOYW1lID0gcmVjb3ZlckdseXBoTmFtZShnbHlwaE5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwoKICAgICAgICBpZiAoc3RhbmRhcmRHbHlwaE5hbWUgIT09IGdseXBoTmFtZSkgewogICAgICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihzdGFuZGFyZEdseXBoTmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSAwOwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gY2hhckNvZGVUb0dseXBoSWQ7Cn0KCmZ1bmN0aW9uIG5vcm1hbGl6ZUZvbnROYW1lKG5hbWUpIHsKICByZXR1cm4gbmFtZS5yZXBsYWNlKC9bLF9dL2csICItIikucmVwbGFjZSgvXHMvZywgIiIpOwp9CgovKioqLyB9KSwKLyogMzkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKX193X3BkZmpzX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pOwovKiBoYXJtb255IGV4cG9ydCAqLyBfX3dfcGRmanNfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgewovKiBoYXJtb255IGV4cG9ydCAqLyAgICJnZXREaW5nYmF0c0dseXBoc1VuaWNvZGUiOiAoKSA9PiAoLyogYmluZGluZyAqLyBnZXREaW5nYmF0c0dseXBoc1VuaWNvZGUpLAovKiBoYXJtb255IGV4cG9ydCAqLyAgICJnZXRHbHlwaHNVbmljb2RlIjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gZ2V0R2x5cGhzVW5pY29kZSkKLyogaGFybW9ueSBleHBvcnQgKi8gfSk7Ci8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCmNvbnN0IGdldEdseXBoc1VuaWNvZGUgPSAoMCxfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fLmdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAoKSB7CiByZXR1cm4gWwogICJBIiwKICAweDAwNDEsCiAgIkFFIiwKICAweDAwYzYsCiAgIkFFYWN1dGUiLAogIDB4MDFmYywKICAiQUVtYWNyb24iLAogIDB4MDFlMiwKICAiQUVzbWFsbCIsCiAgMHhmN2U2LAogICJBYWN1dGUiLAogIDB4MDBjMSwKICAiQWFjdXRlc21hbGwiLAogIDB4ZjdlMSwKICAiQWJyZXZlIiwKICAweDAxMDIsCiAgIkFicmV2ZWFjdXRlIiwKICAweDFlYWUsCiAgIkFicmV2ZWN5cmlsbGljIiwKICAweDA0ZDAsCiAgIkFicmV2ZWRvdGJlbG93IiwKICAweDFlYjYsCiAgIkFicmV2ZWdyYXZlIiwKICAweDFlYjAsCiAgIkFicmV2ZWhvb2thYm92ZSIsCiAgMHgxZWIyLAogICJBYnJldmV0aWxkZSIsCiAgMHgxZWI0LAogICJBY2Fyb24iLAogIDB4MDFjZCwKICAiQWNpcmNsZSIsCiAgMHgyNGI2LAogICJBY2lyY3VtZmxleCIsCiAgMHgwMGMyLAogICJBY2lyY3VtZmxleGFjdXRlIiwKICAweDFlYTQsCiAgIkFjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVhYywKICAiQWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWE2LAogICJBY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWE4LAogICJBY2lyY3VtZmxleHNtYWxsIiwKICAweGY3ZTIsCiAgIkFjaXJjdW1mbGV4dGlsZGUiLAogIDB4MWVhYSwKICAiQWN1dGUiLAogIDB4ZjZjOSwKICAiQWN1dGVzbWFsbCIsCiAgMHhmN2I0LAogICJBY3lyaWxsaWMiLAogIDB4MDQxMCwKICAiQWRibGdyYXZlIiwKICAweDAyMDAsCiAgIkFkaWVyZXNpcyIsCiAgMHgwMGM0LAogICJBZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGQyLAogICJBZGllcmVzaXNtYWNyb24iLAogIDB4MDFkZSwKICAiQWRpZXJlc2lzc21hbGwiLAogIDB4ZjdlNCwKICAiQWRvdGJlbG93IiwKICAweDFlYTAsCiAgIkFkb3RtYWNyb24iLAogIDB4MDFlMCwKICAiQWdyYXZlIiwKICAweDAwYzAsCiAgIkFncmF2ZXNtYWxsIiwKICAweGY3ZTAsCiAgIkFob29rYWJvdmUiLAogIDB4MWVhMiwKICAiQWllY3lyaWxsaWMiLAogIDB4MDRkNCwKICAiQWludmVydGVkYnJldmUiLAogIDB4MDIwMiwKICAiQWxwaGEiLAogIDB4MDM5MSwKICAiQWxwaGF0b25vcyIsCiAgMHgwMzg2LAogICJBbWFjcm9uIiwKICAweDAxMDAsCiAgIkFtb25vc3BhY2UiLAogIDB4ZmYyMSwKICAiQW9nb25layIsCiAgMHgwMTA0LAogICJBcmluZyIsCiAgMHgwMGM1LAogICJBcmluZ2FjdXRlIiwKICAweDAxZmEsCiAgIkFyaW5nYmVsb3ciLAogIDB4MWUwMCwKICAiQXJpbmdzbWFsbCIsCiAgMHhmN2U1LAogICJBc21hbGwiLAogIDB4Zjc2MSwKICAiQXRpbGRlIiwKICAweDAwYzMsCiAgIkF0aWxkZXNtYWxsIiwKICAweGY3ZTMsCiAgIkF5YmFybWVuaWFuIiwKICAweDA1MzEsCiAgIkIiLAogIDB4MDA0MiwKICAiQmNpcmNsZSIsCiAgMHgyNGI3LAogICJCZG90YWNjZW50IiwKICAweDFlMDIsCiAgIkJkb3RiZWxvdyIsCiAgMHgxZTA0LAogICJCZWN5cmlsbGljIiwKICAweDA0MTEsCiAgIkJlbmFybWVuaWFuIiwKICAweDA1MzIsCiAgIkJldGEiLAogIDB4MDM5MiwKICAiQmhvb2siLAogIDB4MDE4MSwKICAiQmxpbmViZWxvdyIsCiAgMHgxZTA2LAogICJCbW9ub3NwYWNlIiwKICAweGZmMjIsCiAgIkJyZXZlc21hbGwiLAogIDB4ZjZmNCwKICAiQnNtYWxsIiwKICAweGY3NjIsCiAgIkJ0b3BiYXIiLAogIDB4MDE4MiwKICAiQyIsCiAgMHgwMDQzLAogICJDYWFybWVuaWFuIiwKICAweDA1M2UsCiAgIkNhY3V0ZSIsCiAgMHgwMTA2LAogICJDYXJvbiIsCiAgMHhmNmNhLAogICJDYXJvbnNtYWxsIiwKICAweGY2ZjUsCiAgIkNjYXJvbiIsCiAgMHgwMTBjLAogICJDY2VkaWxsYSIsCiAgMHgwMGM3LAogICJDY2VkaWxsYWFjdXRlIiwKICAweDFlMDgsCiAgIkNjZWRpbGxhc21hbGwiLAogIDB4ZjdlNywKICAiQ2NpcmNsZSIsCiAgMHgyNGI4LAogICJDY2lyY3VtZmxleCIsCiAgMHgwMTA4LAogICJDZG90IiwKICAweDAxMGEsCiAgIkNkb3RhY2NlbnQiLAogIDB4MDEwYSwKICAiQ2VkaWxsYXNtYWxsIiwKICAweGY3YjgsCiAgIkNoYWFybWVuaWFuIiwKICAweDA1NDksCiAgIkNoZWFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0YmMsCiAgIkNoZWN5cmlsbGljIiwKICAweDA0MjcsCiAgIkNoZWRlc2NlbmRlcmFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0YmUsCiAgIkNoZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YjYsCiAgIkNoZWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRmNCwKICAiQ2hlaGFybWVuaWFuIiwKICAweDA1NDMsCiAgIkNoZWtoYWthc3NpYW5jeXJpbGxpYyIsCiAgMHgwNGNiLAogICJDaGV2ZXJ0aWNhbHN0cm9rZWN5cmlsbGljIiwKICAweDA0YjgsCiAgIkNoaSIsCiAgMHgwM2E3LAogICJDaG9vayIsCiAgMHgwMTg3LAogICJDaXJjdW1mbGV4c21hbGwiLAogIDB4ZjZmNiwKICAiQ21vbm9zcGFjZSIsCiAgMHhmZjIzLAogICJDb2FybWVuaWFuIiwKICAweDA1NTEsCiAgIkNzbWFsbCIsCiAgMHhmNzYzLAogICJEIiwKICAweDAwNDQsCiAgIkRaIiwKICAweDAxZjEsCiAgIkRaY2Fyb24iLAogIDB4MDFjNCwKICAiRGFhcm1lbmlhbiIsCiAgMHgwNTM0LAogICJEYWZyaWNhbiIsCiAgMHgwMTg5LAogICJEY2Fyb24iLAogIDB4MDEwZSwKICAiRGNlZGlsbGEiLAogIDB4MWUxMCwKICAiRGNpcmNsZSIsCiAgMHgyNGI5LAogICJEY2lyY3VtZmxleGJlbG93IiwKICAweDFlMTIsCiAgIkRjcm9hdCIsCiAgMHgwMTEwLAogICJEZG90YWNjZW50IiwKICAweDFlMGEsCiAgIkRkb3RiZWxvdyIsCiAgMHgxZTBjLAogICJEZWN5cmlsbGljIiwKICAweDA0MTQsCiAgIkRlaWNvcHRpYyIsCiAgMHgwM2VlLAogICJEZWx0YSIsCiAgMHgyMjA2LAogICJEZWx0YWdyZWVrIiwKICAweDAzOTQsCiAgIkRob29rIiwKICAweDAxOGEsCiAgIkRpZXJlc2lzIiwKICAweGY2Y2IsCiAgIkRpZXJlc2lzQWN1dGUiLAogIDB4ZjZjYywKICAiRGllcmVzaXNHcmF2ZSIsCiAgMHhmNmNkLAogICJEaWVyZXNpc3NtYWxsIiwKICAweGY3YTgsCiAgIkRpZ2FtbWFncmVlayIsCiAgMHgwM2RjLAogICJEamVjeXJpbGxpYyIsCiAgMHgwNDAyLAogICJEbGluZWJlbG93IiwKICAweDFlMGUsCiAgIkRtb25vc3BhY2UiLAogIDB4ZmYyNCwKICAiRG90YWNjZW50c21hbGwiLAogIDB4ZjZmNywKICAiRHNsYXNoIiwKICAweDAxMTAsCiAgIkRzbWFsbCIsCiAgMHhmNzY0LAogICJEdG9wYmFyIiwKICAweDAxOGIsCiAgIkR6IiwKICAweDAxZjIsCiAgIkR6Y2Fyb24iLAogIDB4MDFjNSwKICAiRHplYWJraGFzaWFuY3lyaWxsaWMiLAogIDB4MDRlMCwKICAiRHplY3lyaWxsaWMiLAogIDB4MDQwNSwKICAiRHpoZWN5cmlsbGljIiwKICAweDA0MGYsCiAgIkUiLAogIDB4MDA0NSwKICAiRWFjdXRlIiwKICAweDAwYzksCiAgIkVhY3V0ZXNtYWxsIiwKICAweGY3ZTksCiAgIkVicmV2ZSIsCiAgMHgwMTE0LAogICJFY2Fyb24iLAogIDB4MDExYSwKICAiRWNlZGlsbGFicmV2ZSIsCiAgMHgxZTFjLAogICJFY2hhcm1lbmlhbiIsCiAgMHgwNTM1LAogICJFY2lyY2xlIiwKICAweDI0YmEsCiAgIkVjaXJjdW1mbGV4IiwKICAweDAwY2EsCiAgIkVjaXJjdW1mbGV4YWN1dGUiLAogIDB4MWViZSwKICAiRWNpcmN1bWZsZXhiZWxvdyIsCiAgMHgxZTE4LAogICJFY2lyY3VtZmxleGRvdGJlbG93IiwKICAweDFlYzYsCiAgIkVjaXJjdW1mbGV4Z3JhdmUiLAogIDB4MWVjMCwKICAiRWNpcmN1bWZsZXhob29rYWJvdmUiLAogIDB4MWVjMiwKICAiRWNpcmN1bWZsZXhzbWFsbCIsCiAgMHhmN2VhLAogICJFY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYzQsCiAgIkVjeXJpbGxpYyIsCiAgMHgwNDA0LAogICJFZGJsZ3JhdmUiLAogIDB4MDIwNCwKICAiRWRpZXJlc2lzIiwKICAweDAwY2IsCiAgIkVkaWVyZXNpc3NtYWxsIiwKICAweGY3ZWIsCiAgIkVkb3QiLAogIDB4MDExNiwKICAiRWRvdGFjY2VudCIsCiAgMHgwMTE2LAogICJFZG90YmVsb3ciLAogIDB4MWViOCwKICAiRWZjeXJpbGxpYyIsCiAgMHgwNDI0LAogICJFZ3JhdmUiLAogIDB4MDBjOCwKICAiRWdyYXZlc21hbGwiLAogIDB4ZjdlOCwKICAiRWhhcm1lbmlhbiIsCiAgMHgwNTM3LAogICJFaG9va2Fib3ZlIiwKICAweDFlYmEsCiAgIkVpZ2h0cm9tYW4iLAogIDB4MjE2NywKICAiRWludmVydGVkYnJldmUiLAogIDB4MDIwNiwKICAiRWlvdGlmaWVkY3lyaWxsaWMiLAogIDB4MDQ2NCwKICAiRWxjeXJpbGxpYyIsCiAgMHgwNDFiLAogICJFbGV2ZW5yb21hbiIsCiAgMHgyMTZhLAogICJFbWFjcm9uIiwKICAweDAxMTIsCiAgIkVtYWNyb25hY3V0ZSIsCiAgMHgxZTE2LAogICJFbWFjcm9uZ3JhdmUiLAogIDB4MWUxNCwKICAiRW1jeXJpbGxpYyIsCiAgMHgwNDFjLAogICJFbW9ub3NwYWNlIiwKICAweGZmMjUsCiAgIkVuY3lyaWxsaWMiLAogIDB4MDQxZCwKICAiRW5kZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGEyLAogICJFbmciLAogIDB4MDE0YSwKICAiRW5naGVjeXJpbGxpYyIsCiAgMHgwNGE0LAogICJFbmhvb2tjeXJpbGxpYyIsCiAgMHgwNGM3LAogICJFb2dvbmVrIiwKICAweDAxMTgsCiAgIkVvcGVuIiwKICAweDAxOTAsCiAgIkVwc2lsb24iLAogIDB4MDM5NSwKICAiRXBzaWxvbnRvbm9zIiwKICAweDAzODgsCiAgIkVyY3lyaWxsaWMiLAogIDB4MDQyMCwKICAiRXJldmVyc2VkIiwKICAweDAxOGUsCiAgIkVyZXZlcnNlZGN5cmlsbGljIiwKICAweDA0MmQsCiAgIkVzY3lyaWxsaWMiLAogIDB4MDQyMSwKICAiRXNkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGFhLAogICJFc2giLAogIDB4MDFhOSwKICAiRXNtYWxsIiwKICAweGY3NjUsCiAgIkV0YSIsCiAgMHgwMzk3LAogICJFdGFybWVuaWFuIiwKICAweDA1MzgsCiAgIkV0YXRvbm9zIiwKICAweDAzODksCiAgIkV0aCIsCiAgMHgwMGQwLAogICJFdGhzbWFsbCIsCiAgMHhmN2YwLAogICJFdGlsZGUiLAogIDB4MWViYywKICAiRXRpbGRlYmVsb3ciLAogIDB4MWUxYSwKICAiRXVybyIsCiAgMHgyMGFjLAogICJFemgiLAogIDB4MDFiNywKICAiRXpoY2Fyb24iLAogIDB4MDFlZSwKICAiRXpocmV2ZXJzZWQiLAogIDB4MDFiOCwKICAiRiIsCiAgMHgwMDQ2LAogICJGY2lyY2xlIiwKICAweDI0YmIsCiAgIkZkb3RhY2NlbnQiLAogIDB4MWUxZSwKICAiRmVoYXJtZW5pYW4iLAogIDB4MDU1NiwKICAiRmVpY29wdGljIiwKICAweDAzZTQsCiAgIkZob29rIiwKICAweDAxOTEsCiAgIkZpdGFjeXJpbGxpYyIsCiAgMHgwNDcyLAogICJGaXZlcm9tYW4iLAogIDB4MjE2NCwKICAiRm1vbm9zcGFjZSIsCiAgMHhmZjI2LAogICJGb3Vycm9tYW4iLAogIDB4MjE2MywKICAiRnNtYWxsIiwKICAweGY3NjYsCiAgIkciLAogIDB4MDA0NywKICAiR0JzcXVhcmUiLAogIDB4MzM4NywKICAiR2FjdXRlIiwKICAweDAxZjQsCiAgIkdhbW1hIiwKICAweDAzOTMsCiAgIkdhbW1hYWZyaWNhbiIsCiAgMHgwMTk0LAogICJHYW5naWFjb3B0aWMiLAogIDB4MDNlYSwKICAiR2JyZXZlIiwKICAweDAxMWUsCiAgIkdjYXJvbiIsCiAgMHgwMWU2LAogICJHY2VkaWxsYSIsCiAgMHgwMTIyLAogICJHY2lyY2xlIiwKICAweDI0YmMsCiAgIkdjaXJjdW1mbGV4IiwKICAweDAxMWMsCiAgIkdjb21tYWFjY2VudCIsCiAgMHgwMTIyLAogICJHZG90IiwKICAweDAxMjAsCiAgIkdkb3RhY2NlbnQiLAogIDB4MDEyMCwKICAiR2VjeXJpbGxpYyIsCiAgMHgwNDEzLAogICJHaGFkYXJtZW5pYW4iLAogIDB4MDU0MiwKICAiR2hlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0OTQsCiAgIkdoZXN0cm9rZWN5cmlsbGljIiwKICAweDA0OTIsCiAgIkdoZXVwdHVybmN5cmlsbGljIiwKICAweDA0OTAsCiAgIkdob29rIiwKICAweDAxOTMsCiAgIkdpbWFybWVuaWFuIiwKICAweDA1MzMsCiAgIkdqZWN5cmlsbGljIiwKICAweDA0MDMsCiAgIkdtYWNyb24iLAogIDB4MWUyMCwKICAiR21vbm9zcGFjZSIsCiAgMHhmZjI3LAogICJHcmF2ZSIsCiAgMHhmNmNlLAogICJHcmF2ZXNtYWxsIiwKICAweGY3NjAsCiAgIkdzbWFsbCIsCiAgMHhmNzY3LAogICJHc21hbGxob29rIiwKICAweDAyOWIsCiAgIkdzdHJva2UiLAogIDB4MDFlNCwKICAiSCIsCiAgMHgwMDQ4LAogICJIMTg1MzMiLAogIDB4MjVjZiwKICAiSDE4NTQzIiwKICAweDI1YWEsCiAgIkgxODU1MSIsCiAgMHgyNWFiLAogICJIMjIwNzMiLAogIDB4MjVhMSwKICAiSFBzcXVhcmUiLAogIDB4MzNjYiwKICAiSGFhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGE4LAogICJIYWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YjIsCiAgIkhhcmRzaWduY3lyaWxsaWMiLAogIDB4MDQyYSwKICAiSGJhciIsCiAgMHgwMTI2LAogICJIYnJldmViZWxvdyIsCiAgMHgxZTJhLAogICJIY2VkaWxsYSIsCiAgMHgxZTI4LAogICJIY2lyY2xlIiwKICAweDI0YmQsCiAgIkhjaXJjdW1mbGV4IiwKICAweDAxMjQsCiAgIkhkaWVyZXNpcyIsCiAgMHgxZTI2LAogICJIZG90YWNjZW50IiwKICAweDFlMjIsCiAgIkhkb3RiZWxvdyIsCiAgMHgxZTI0LAogICJIbW9ub3NwYWNlIiwKICAweGZmMjgsCiAgIkhvYXJtZW5pYW4iLAogIDB4MDU0MCwKICAiSG9yaWNvcHRpYyIsCiAgMHgwM2U4LAogICJIc21hbGwiLAogIDB4Zjc2OCwKICAiSHVuZ2FydW1sYXV0IiwKICAweGY2Y2YsCiAgIkh1bmdhcnVtbGF1dHNtYWxsIiwKICAweGY2ZjgsCiAgIkh6c3F1YXJlIiwKICAweDMzOTAsCiAgIkkiLAogIDB4MDA0OSwKICAiSUFjeXJpbGxpYyIsCiAgMHgwNDJmLAogICJJSiIsCiAgMHgwMTMyLAogICJJVWN5cmlsbGljIiwKICAweDA0MmUsCiAgIklhY3V0ZSIsCiAgMHgwMGNkLAogICJJYWN1dGVzbWFsbCIsCiAgMHhmN2VkLAogICJJYnJldmUiLAogIDB4MDEyYywKICAiSWNhcm9uIiwKICAweDAxY2YsCiAgIkljaXJjbGUiLAogIDB4MjRiZSwKICAiSWNpcmN1bWZsZXgiLAogIDB4MDBjZSwKICAiSWNpcmN1bWZsZXhzbWFsbCIsCiAgMHhmN2VlLAogICJJY3lyaWxsaWMiLAogIDB4MDQwNiwKICAiSWRibGdyYXZlIiwKICAweDAyMDgsCiAgIklkaWVyZXNpcyIsCiAgMHgwMGNmLAogICJJZGllcmVzaXNhY3V0ZSIsCiAgMHgxZTJlLAogICJJZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU0LAogICJJZGllcmVzaXNzbWFsbCIsCiAgMHhmN2VmLAogICJJZG90IiwKICAweDAxMzAsCiAgIklkb3RhY2NlbnQiLAogIDB4MDEzMCwKICAiSWRvdGJlbG93IiwKICAweDFlY2EsCiAgIkllYnJldmVjeXJpbGxpYyIsCiAgMHgwNGQ2LAogICJJZWN5cmlsbGljIiwKICAweDA0MTUsCiAgIklmcmFrdHVyIiwKICAweDIxMTEsCiAgIklncmF2ZSIsCiAgMHgwMGNjLAogICJJZ3JhdmVzbWFsbCIsCiAgMHhmN2VjLAogICJJaG9va2Fib3ZlIiwKICAweDFlYzgsCiAgIklpY3lyaWxsaWMiLAogIDB4MDQxOCwKICAiSWludmVydGVkYnJldmUiLAogIDB4MDIwYSwKICAiSWlzaG9ydGN5cmlsbGljIiwKICAweDA0MTksCiAgIkltYWNyb24iLAogIDB4MDEyYSwKICAiSW1hY3JvbmN5cmlsbGljIiwKICAweDA0ZTIsCiAgIkltb25vc3BhY2UiLAogIDB4ZmYyOSwKICAiSW5pYXJtZW5pYW4iLAogIDB4MDUzYiwKICAiSW9jeXJpbGxpYyIsCiAgMHgwNDAxLAogICJJb2dvbmVrIiwKICAweDAxMmUsCiAgIklvdGEiLAogIDB4MDM5OSwKICAiSW90YWFmcmljYW4iLAogIDB4MDE5NiwKICAiSW90YWRpZXJlc2lzIiwKICAweDAzYWEsCiAgIklvdGF0b25vcyIsCiAgMHgwMzhhLAogICJJc21hbGwiLAogIDB4Zjc2OSwKICAiSXN0cm9rZSIsCiAgMHgwMTk3LAogICJJdGlsZGUiLAogIDB4MDEyOCwKICAiSXRpbGRlYmVsb3ciLAogIDB4MWUyYywKICAiSXpoaXRzYWN5cmlsbGljIiwKICAweDA0NzQsCiAgIkl6aGl0c2FkYmxncmF2ZWN5cmlsbGljIiwKICAweDA0NzYsCiAgIkoiLAogIDB4MDA0YSwKICAiSmFhcm1lbmlhbiIsCiAgMHgwNTQxLAogICJKY2lyY2xlIiwKICAweDI0YmYsCiAgIkpjaXJjdW1mbGV4IiwKICAweDAxMzQsCiAgIkplY3lyaWxsaWMiLAogIDB4MDQwOCwKICAiSmhlaGFybWVuaWFuIiwKICAweDA1NGIsCiAgIkptb25vc3BhY2UiLAogIDB4ZmYyYSwKICAiSnNtYWxsIiwKICAweGY3NmEsCiAgIksiLAogIDB4MDA0YiwKICAiS0JzcXVhcmUiLAogIDB4MzM4NSwKICAiS0tzcXVhcmUiLAogIDB4MzNjZCwKICAiS2FiYXNoa2lyY3lyaWxsaWMiLAogIDB4MDRhMCwKICAiS2FjdXRlIiwKICAweDFlMzAsCiAgIkthY3lyaWxsaWMiLAogIDB4MDQxYSwKICAiS2FkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNDlhLAogICJLYWhvb2tjeXJpbGxpYyIsCiAgMHgwNGMzLAogICJLYXBwYSIsCiAgMHgwMzlhLAogICJLYXN0cm9rZWN5cmlsbGljIiwKICAweDA0OWUsCiAgIkthdmVydGljYWxzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDljLAogICJLY2Fyb24iLAogIDB4MDFlOCwKICAiS2NlZGlsbGEiLAogIDB4MDEzNiwKICAiS2NpcmNsZSIsCiAgMHgyNGMwLAogICJLY29tbWFhY2NlbnQiLAogIDB4MDEzNiwKICAiS2RvdGJlbG93IiwKICAweDFlMzIsCiAgIktlaGFybWVuaWFuIiwKICAweDA1NTQsCiAgIktlbmFybWVuaWFuIiwKICAweDA1M2YsCiAgIktoYWN5cmlsbGljIiwKICAweDA0MjUsCiAgIktoZWljb3B0aWMiLAogIDB4MDNlNiwKICAiS2hvb2siLAogIDB4MDE5OCwKICAiS2plY3lyaWxsaWMiLAogIDB4MDQwYywKICAiS2xpbmViZWxvdyIsCiAgMHgxZTM0LAogICJLbW9ub3NwYWNlIiwKICAweGZmMmIsCiAgIktvcHBhY3lyaWxsaWMiLAogIDB4MDQ4MCwKICAiS29wcGFncmVlayIsCiAgMHgwM2RlLAogICJLc2ljeXJpbGxpYyIsCiAgMHgwNDZlLAogICJLc21hbGwiLAogIDB4Zjc2YiwKICAiTCIsCiAgMHgwMDRjLAogICJMSiIsCiAgMHgwMWM3LAogICJMTCIsCiAgMHhmNmJmLAogICJMYWN1dGUiLAogIDB4MDEzOSwKICAiTGFtYmRhIiwKICAweDAzOWIsCiAgIkxjYXJvbiIsCiAgMHgwMTNkLAogICJMY2VkaWxsYSIsCiAgMHgwMTNiLAogICJMY2lyY2xlIiwKICAweDI0YzEsCiAgIkxjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUzYywKICAiTGNvbW1hYWNjZW50IiwKICAweDAxM2IsCiAgIkxkb3QiLAogIDB4MDEzZiwKICAiTGRvdGFjY2VudCIsCiAgMHgwMTNmLAogICJMZG90YmVsb3ciLAogIDB4MWUzNiwKICAiTGRvdGJlbG93bWFjcm9uIiwKICAweDFlMzgsCiAgIkxpd25hcm1lbmlhbiIsCiAgMHgwNTNjLAogICJMaiIsCiAgMHgwMWM4LAogICJMamVjeXJpbGxpYyIsCiAgMHgwNDA5LAogICJMbGluZWJlbG93IiwKICAweDFlM2EsCiAgIkxtb25vc3BhY2UiLAogIDB4ZmYyYywKICAiTHNsYXNoIiwKICAweDAxNDEsCiAgIkxzbGFzaHNtYWxsIiwKICAweGY2ZjksCiAgIkxzbWFsbCIsCiAgMHhmNzZjLAogICJNIiwKICAweDAwNGQsCiAgIk1Cc3F1YXJlIiwKICAweDMzODYsCiAgIk1hY3JvbiIsCiAgMHhmNmQwLAogICJNYWNyb25zbWFsbCIsCiAgMHhmN2FmLAogICJNYWN1dGUiLAogIDB4MWUzZSwKICAiTWNpcmNsZSIsCiAgMHgyNGMyLAogICJNZG90YWNjZW50IiwKICAweDFlNDAsCiAgIk1kb3RiZWxvdyIsCiAgMHgxZTQyLAogICJNZW5hcm1lbmlhbiIsCiAgMHgwNTQ0LAogICJNbW9ub3NwYWNlIiwKICAweGZmMmQsCiAgIk1zbWFsbCIsCiAgMHhmNzZkLAogICJNdHVybmVkIiwKICAweDAxOWMsCiAgIk11IiwKICAweDAzOWMsCiAgIk4iLAogIDB4MDA0ZSwKICAiTkoiLAogIDB4MDFjYSwKICAiTmFjdXRlIiwKICAweDAxNDMsCiAgIk5jYXJvbiIsCiAgMHgwMTQ3LAogICJOY2VkaWxsYSIsCiAgMHgwMTQ1LAogICJOY2lyY2xlIiwKICAweDI0YzMsCiAgIk5jaXJjdW1mbGV4YmVsb3ciLAogIDB4MWU0YSwKICAiTmNvbW1hYWNjZW50IiwKICAweDAxNDUsCiAgIk5kb3RhY2NlbnQiLAogIDB4MWU0NCwKICAiTmRvdGJlbG93IiwKICAweDFlNDYsCiAgIk5ob29rbGVmdCIsCiAgMHgwMTlkLAogICJOaW5lcm9tYW4iLAogIDB4MjE2OCwKICAiTmoiLAogIDB4MDFjYiwKICAiTmplY3lyaWxsaWMiLAogIDB4MDQwYSwKICAiTmxpbmViZWxvdyIsCiAgMHgxZTQ4LAogICJObW9ub3NwYWNlIiwKICAweGZmMmUsCiAgIk5vd2FybWVuaWFuIiwKICAweDA1NDYsCiAgIk5zbWFsbCIsCiAgMHhmNzZlLAogICJOdGlsZGUiLAogIDB4MDBkMSwKICAiTnRpbGRlc21hbGwiLAogIDB4ZjdmMSwKICAiTnUiLAogIDB4MDM5ZCwKICAiTyIsCiAgMHgwMDRmLAogICJPRSIsCiAgMHgwMTUyLAogICJPRXNtYWxsIiwKICAweGY2ZmEsCiAgIk9hY3V0ZSIsCiAgMHgwMGQzLAogICJPYWN1dGVzbWFsbCIsCiAgMHhmN2YzLAogICJPYmFycmVkY3lyaWxsaWMiLAogIDB4MDRlOCwKICAiT2JhcnJlZGRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRlYSwKICAiT2JyZXZlIiwKICAweDAxNGUsCiAgIk9jYXJvbiIsCiAgMHgwMWQxLAogICJPY2VudGVyZWR0aWxkZSIsCiAgMHgwMTlmLAogICJPY2lyY2xlIiwKICAweDI0YzQsCiAgIk9jaXJjdW1mbGV4IiwKICAweDAwZDQsCiAgIk9jaXJjdW1mbGV4YWN1dGUiLAogIDB4MWVkMCwKICAiT2NpcmN1bWZsZXhkb3RiZWxvdyIsCiAgMHgxZWQ4LAogICJPY2lyY3VtZmxleGdyYXZlIiwKICAweDFlZDIsCiAgIk9jaXJjdW1mbGV4aG9va2Fib3ZlIiwKICAweDFlZDQsCiAgIk9jaXJjdW1mbGV4c21hbGwiLAogIDB4ZjdmNCwKICAiT2NpcmN1bWZsZXh0aWxkZSIsCiAgMHgxZWQ2LAogICJPY3lyaWxsaWMiLAogIDB4MDQxZSwKICAiT2RibGFjdXRlIiwKICAweDAxNTAsCiAgIk9kYmxncmF2ZSIsCiAgMHgwMjBjLAogICJPZGllcmVzaXMiLAogIDB4MDBkNiwKICAiT2RpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRlNiwKICAiT2RpZXJlc2lzc21hbGwiLAogIDB4ZjdmNiwKICAiT2RvdGJlbG93IiwKICAweDFlY2MsCiAgIk9nb25la3NtYWxsIiwKICAweGY2ZmIsCiAgIk9ncmF2ZSIsCiAgMHgwMGQyLAogICJPZ3JhdmVzbWFsbCIsCiAgMHhmN2YyLAogICJPaGFybWVuaWFuIiwKICAweDA1NTUsCiAgIk9obSIsCiAgMHgyMTI2LAogICJPaG9va2Fib3ZlIiwKICAweDFlY2UsCiAgIk9ob3JuIiwKICAweDAxYTAsCiAgIk9ob3JuYWN1dGUiLAogIDB4MWVkYSwKICAiT2hvcm5kb3RiZWxvdyIsCiAgMHgxZWUyLAogICJPaG9ybmdyYXZlIiwKICAweDFlZGMsCiAgIk9ob3JuaG9va2Fib3ZlIiwKICAweDFlZGUsCiAgIk9ob3JudGlsZGUiLAogIDB4MWVlMCwKICAiT2h1bmdhcnVtbGF1dCIsCiAgMHgwMTUwLAogICJPaSIsCiAgMHgwMWEyLAogICJPaW52ZXJ0ZWRicmV2ZSIsCiAgMHgwMjBlLAogICJPbWFjcm9uIiwKICAweDAxNGMsCiAgIk9tYWNyb25hY3V0ZSIsCiAgMHgxZTUyLAogICJPbWFjcm9uZ3JhdmUiLAogIDB4MWU1MCwKICAiT21lZ2EiLAogIDB4MjEyNiwKICAiT21lZ2FjeXJpbGxpYyIsCiAgMHgwNDYwLAogICJPbWVnYWdyZWVrIiwKICAweDAzYTksCiAgIk9tZWdhcm91bmRjeXJpbGxpYyIsCiAgMHgwNDdhLAogICJPbWVnYXRpdGxvY3lyaWxsaWMiLAogIDB4MDQ3YywKICAiT21lZ2F0b25vcyIsCiAgMHgwMzhmLAogICJPbWljcm9uIiwKICAweDAzOWYsCiAgIk9taWNyb250b25vcyIsCiAgMHgwMzhjLAogICJPbW9ub3NwYWNlIiwKICAweGZmMmYsCiAgIk9uZXJvbWFuIiwKICAweDIxNjAsCiAgIk9vZ29uZWsiLAogIDB4MDFlYSwKICAiT29nb25la21hY3JvbiIsCiAgMHgwMWVjLAogICJPb3BlbiIsCiAgMHgwMTg2LAogICJPc2xhc2giLAogIDB4MDBkOCwKICAiT3NsYXNoYWN1dGUiLAogIDB4MDFmZSwKICAiT3NsYXNoc21hbGwiLAogIDB4ZjdmOCwKICAiT3NtYWxsIiwKICAweGY3NmYsCiAgIk9zdHJva2VhY3V0ZSIsCiAgMHgwMWZlLAogICJPdGN5cmlsbGljIiwKICAweDA0N2UsCiAgIk90aWxkZSIsCiAgMHgwMGQ1LAogICJPdGlsZGVhY3V0ZSIsCiAgMHgxZTRjLAogICJPdGlsZGVkaWVyZXNpcyIsCiAgMHgxZTRlLAogICJPdGlsZGVzbWFsbCIsCiAgMHhmN2Y1LAogICJQIiwKICAweDAwNTAsCiAgIlBhY3V0ZSIsCiAgMHgxZTU0LAogICJQY2lyY2xlIiwKICAweDI0YzUsCiAgIlBkb3RhY2NlbnQiLAogIDB4MWU1NiwKICAiUGVjeXJpbGxpYyIsCiAgMHgwNDFmLAogICJQZWhhcm1lbmlhbiIsCiAgMHgwNTRhLAogICJQZW1pZGRsZWhvb2tjeXJpbGxpYyIsCiAgMHgwNGE2LAogICJQaGkiLAogIDB4MDNhNiwKICAiUGhvb2siLAogIDB4MDFhNCwKICAiUGkiLAogIDB4MDNhMCwKICAiUGl3cmFybWVuaWFuIiwKICAweDA1NTMsCiAgIlBtb25vc3BhY2UiLAogIDB4ZmYzMCwKICAiUHNpIiwKICAweDAzYTgsCiAgIlBzaWN5cmlsbGljIiwKICAweDA0NzAsCiAgIlBzbWFsbCIsCiAgMHhmNzcwLAogICJRIiwKICAweDAwNTEsCiAgIlFjaXJjbGUiLAogIDB4MjRjNiwKICAiUW1vbm9zcGFjZSIsCiAgMHhmZjMxLAogICJRc21hbGwiLAogIDB4Zjc3MSwKICAiUiIsCiAgMHgwMDUyLAogICJSYWFybWVuaWFuIiwKICAweDA1NGMsCiAgIlJhY3V0ZSIsCiAgMHgwMTU0LAogICJSY2Fyb24iLAogIDB4MDE1OCwKICAiUmNlZGlsbGEiLAogIDB4MDE1NiwKICAiUmNpcmNsZSIsCiAgMHgyNGM3LAogICJSY29tbWFhY2NlbnQiLAogIDB4MDE1NiwKICAiUmRibGdyYXZlIiwKICAweDAyMTAsCiAgIlJkb3RhY2NlbnQiLAogIDB4MWU1OCwKICAiUmRvdGJlbG93IiwKICAweDFlNWEsCiAgIlJkb3RiZWxvd21hY3JvbiIsCiAgMHgxZTVjLAogICJSZWhhcm1lbmlhbiIsCiAgMHgwNTUwLAogICJSZnJha3R1ciIsCiAgMHgyMTFjLAogICJSaG8iLAogIDB4MDNhMSwKICAiUmluZ3NtYWxsIiwKICAweGY2ZmMsCiAgIlJpbnZlcnRlZGJyZXZlIiwKICAweDAyMTIsCiAgIlJsaW5lYmVsb3ciLAogIDB4MWU1ZSwKICAiUm1vbm9zcGFjZSIsCiAgMHhmZjMyLAogICJSc21hbGwiLAogIDB4Zjc3MiwKICAiUnNtYWxsaW52ZXJ0ZWQiLAogIDB4MDI4MSwKICAiUnNtYWxsaW52ZXJ0ZWRzdXBlcmlvciIsCiAgMHgwMmI2LAogICJTIiwKICAweDAwNTMsCiAgIlNGMDEwMDAwIiwKICAweDI1MGMsCiAgIlNGMDIwMDAwIiwKICAweDI1MTQsCiAgIlNGMDMwMDAwIiwKICAweDI1MTAsCiAgIlNGMDQwMDAwIiwKICAweDI1MTgsCiAgIlNGMDUwMDAwIiwKICAweDI1M2MsCiAgIlNGMDYwMDAwIiwKICAweDI1MmMsCiAgIlNGMDcwMDAwIiwKICAweDI1MzQsCiAgIlNGMDgwMDAwIiwKICAweDI1MWMsCiAgIlNGMDkwMDAwIiwKICAweDI1MjQsCiAgIlNGMTAwMDAwIiwKICAweDI1MDAsCiAgIlNGMTEwMDAwIiwKICAweDI1MDIsCiAgIlNGMTkwMDAwIiwKICAweDI1NjEsCiAgIlNGMjAwMDAwIiwKICAweDI1NjIsCiAgIlNGMjEwMDAwIiwKICAweDI1NTYsCiAgIlNGMjIwMDAwIiwKICAweDI1NTUsCiAgIlNGMjMwMDAwIiwKICAweDI1NjMsCiAgIlNGMjQwMDAwIiwKICAweDI1NTEsCiAgIlNGMjUwMDAwIiwKICAweDI1NTcsCiAgIlNGMjYwMDAwIiwKICAweDI1NWQsCiAgIlNGMjcwMDAwIiwKICAweDI1NWMsCiAgIlNGMjgwMDAwIiwKICAweDI1NWIsCiAgIlNGMzYwMDAwIiwKICAweDI1NWUsCiAgIlNGMzcwMDAwIiwKICAweDI1NWYsCiAgIlNGMzgwMDAwIiwKICAweDI1NWEsCiAgIlNGMzkwMDAwIiwKICAweDI1NTQsCiAgIlNGNDAwMDAwIiwKICAweDI1NjksCiAgIlNGNDEwMDAwIiwKICAweDI1NjYsCiAgIlNGNDIwMDAwIiwKICAweDI1NjAsCiAgIlNGNDMwMDAwIiwKICAweDI1NTAsCiAgIlNGNDQwMDAwIiwKICAweDI1NmMsCiAgIlNGNDUwMDAwIiwKICAweDI1NjcsCiAgIlNGNDYwMDAwIiwKICAweDI1NjgsCiAgIlNGNDcwMDAwIiwKICAweDI1NjQsCiAgIlNGNDgwMDAwIiwKICAweDI1NjUsCiAgIlNGNDkwMDAwIiwKICAweDI1NTksCiAgIlNGNTAwMDAwIiwKICAweDI1NTgsCiAgIlNGNTEwMDAwIiwKICAweDI1NTIsCiAgIlNGNTIwMDAwIiwKICAweDI1NTMsCiAgIlNGNTMwMDAwIiwKICAweDI1NmIsCiAgIlNGNTQwMDAwIiwKICAweDI1NmEsCiAgIlNhY3V0ZSIsCiAgMHgwMTVhLAogICJTYWN1dGVkb3RhY2NlbnQiLAogIDB4MWU2NCwKICAiU2FtcGlncmVlayIsCiAgMHgwM2UwLAogICJTY2Fyb24iLAogIDB4MDE2MCwKICAiU2Nhcm9uZG90YWNjZW50IiwKICAweDFlNjYsCiAgIlNjYXJvbnNtYWxsIiwKICAweGY2ZmQsCiAgIlNjZWRpbGxhIiwKICAweDAxNWUsCiAgIlNjaHdhIiwKICAweDAxOGYsCiAgIlNjaHdhY3lyaWxsaWMiLAogIDB4MDRkOCwKICAiU2Nod2FkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZGEsCiAgIlNjaXJjbGUiLAogIDB4MjRjOCwKICAiU2NpcmN1bWZsZXgiLAogIDB4MDE1YywKICAiU2NvbW1hYWNjZW50IiwKICAweDAyMTgsCiAgIlNkb3RhY2NlbnQiLAogIDB4MWU2MCwKICAiU2RvdGJlbG93IiwKICAweDFlNjIsCiAgIlNkb3RiZWxvd2RvdGFjY2VudCIsCiAgMHgxZTY4LAogICJTZWhhcm1lbmlhbiIsCiAgMHgwNTRkLAogICJTZXZlbnJvbWFuIiwKICAweDIxNjYsCiAgIlNoYWFybWVuaWFuIiwKICAweDA1NDcsCiAgIlNoYWN5cmlsbGljIiwKICAweDA0MjgsCiAgIlNoY2hhY3lyaWxsaWMiLAogIDB4MDQyOSwKICAiU2hlaWNvcHRpYyIsCiAgMHgwM2UyLAogICJTaGhhY3lyaWxsaWMiLAogIDB4MDRiYSwKICAiU2hpbWFjb3B0aWMiLAogIDB4MDNlYywKICAiU2lnbWEiLAogIDB4MDNhMywKICAiU2l4cm9tYW4iLAogIDB4MjE2NSwKICAiU21vbm9zcGFjZSIsCiAgMHhmZjMzLAogICJTb2Z0c2lnbmN5cmlsbGljIiwKICAweDA0MmMsCiAgIlNzbWFsbCIsCiAgMHhmNzczLAogICJTdGlnbWFncmVlayIsCiAgMHgwM2RhLAogICJUIiwKICAweDAwNTQsCiAgIlRhdSIsCiAgMHgwM2E0LAogICJUYmFyIiwKICAweDAxNjYsCiAgIlRjYXJvbiIsCiAgMHgwMTY0LAogICJUY2VkaWxsYSIsCiAgMHgwMTYyLAogICJUY2lyY2xlIiwKICAweDI0YzksCiAgIlRjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWU3MCwKICAiVGNvbW1hYWNjZW50IiwKICAweDAxNjIsCiAgIlRkb3RhY2NlbnQiLAogIDB4MWU2YSwKICAiVGRvdGJlbG93IiwKICAweDFlNmMsCiAgIlRlY3lyaWxsaWMiLAogIDB4MDQyMiwKICAiVGVkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGFjLAogICJUZW5yb21hbiIsCiAgMHgyMTY5LAogICJUZXRzZWN5cmlsbGljIiwKICAweDA0YjQsCiAgIlRoZXRhIiwKICAweDAzOTgsCiAgIlRob29rIiwKICAweDAxYWMsCiAgIlRob3JuIiwKICAweDAwZGUsCiAgIlRob3Juc21hbGwiLAogIDB4ZjdmZSwKICAiVGhyZWVyb21hbiIsCiAgMHgyMTYyLAogICJUaWxkZXNtYWxsIiwKICAweGY2ZmUsCiAgIlRpd25hcm1lbmlhbiIsCiAgMHgwNTRmLAogICJUbGluZWJlbG93IiwKICAweDFlNmUsCiAgIlRtb25vc3BhY2UiLAogIDB4ZmYzNCwKICAiVG9hcm1lbmlhbiIsCiAgMHgwNTM5LAogICJUb25lZml2ZSIsCiAgMHgwMWJjLAogICJUb25lc2l4IiwKICAweDAxODQsCiAgIlRvbmV0d28iLAogIDB4MDFhNywKICAiVHJldHJvZmxleGhvb2siLAogIDB4MDFhZSwKICAiVHNlY3lyaWxsaWMiLAogIDB4MDQyNiwKICAiVHNoZWN5cmlsbGljIiwKICAweDA0MGIsCiAgIlRzbWFsbCIsCiAgMHhmNzc0LAogICJUd2VsdmVyb21hbiIsCiAgMHgyMTZiLAogICJUd29yb21hbiIsCiAgMHgyMTYxLAogICJVIiwKICAweDAwNTUsCiAgIlVhY3V0ZSIsCiAgMHgwMGRhLAogICJVYWN1dGVzbWFsbCIsCiAgMHhmN2ZhLAogICJVYnJldmUiLAogIDB4MDE2YywKICAiVWNhcm9uIiwKICAweDAxZDMsCiAgIlVjaXJjbGUiLAogIDB4MjRjYSwKICAiVWNpcmN1bWZsZXgiLAogIDB4MDBkYiwKICAiVWNpcmN1bWZsZXhiZWxvdyIsCiAgMHgxZTc2LAogICJVY2lyY3VtZmxleHNtYWxsIiwKICAweGY3ZmIsCiAgIlVjeXJpbGxpYyIsCiAgMHgwNDIzLAogICJVZGJsYWN1dGUiLAogIDB4MDE3MCwKICAiVWRibGdyYXZlIiwKICAweDAyMTQsCiAgIlVkaWVyZXNpcyIsCiAgMHgwMGRjLAogICJVZGllcmVzaXNhY3V0ZSIsCiAgMHgwMWQ3LAogICJVZGllcmVzaXNiZWxvdyIsCiAgMHgxZTcyLAogICJVZGllcmVzaXNjYXJvbiIsCiAgMHgwMWQ5LAogICJVZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGYwLAogICJVZGllcmVzaXNncmF2ZSIsCiAgMHgwMWRiLAogICJVZGllcmVzaXNtYWNyb24iLAogIDB4MDFkNSwKICAiVWRpZXJlc2lzc21hbGwiLAogIDB4ZjdmYywKICAiVWRvdGJlbG93IiwKICAweDFlZTQsCiAgIlVncmF2ZSIsCiAgMHgwMGQ5LAogICJVZ3JhdmVzbWFsbCIsCiAgMHhmN2Y5LAogICJVaG9va2Fib3ZlIiwKICAweDFlZTYsCiAgIlVob3JuIiwKICAweDAxYWYsCiAgIlVob3JuYWN1dGUiLAogIDB4MWVlOCwKICAiVWhvcm5kb3RiZWxvdyIsCiAgMHgxZWYwLAogICJVaG9ybmdyYXZlIiwKICAweDFlZWEsCiAgIlVob3JuaG9va2Fib3ZlIiwKICAweDFlZWMsCiAgIlVob3JudGlsZGUiLAogIDB4MWVlZSwKICAiVWh1bmdhcnVtbGF1dCIsCiAgMHgwMTcwLAogICJVaHVuZ2FydW1sYXV0Y3lyaWxsaWMiLAogIDB4MDRmMiwKICAiVWludmVydGVkYnJldmUiLAogIDB4MDIxNiwKICAiVWtjeXJpbGxpYyIsCiAgMHgwNDc4LAogICJVbWFjcm9uIiwKICAweDAxNmEsCiAgIlVtYWNyb25jeXJpbGxpYyIsCiAgMHgwNGVlLAogICJVbWFjcm9uZGllcmVzaXMiLAogIDB4MWU3YSwKICAiVW1vbm9zcGFjZSIsCiAgMHhmZjM1LAogICJVb2dvbmVrIiwKICAweDAxNzIsCiAgIlVwc2lsb24iLAogIDB4MDNhNSwKICAiVXBzaWxvbjEiLAogIDB4MDNkMiwKICAiVXBzaWxvbmFjdXRlaG9va3N5bWJvbGdyZWVrIiwKICAweDAzZDMsCiAgIlVwc2lsb25hZnJpY2FuIiwKICAweDAxYjEsCiAgIlVwc2lsb25kaWVyZXNpcyIsCiAgMHgwM2FiLAogICJVcHNpbG9uZGllcmVzaXNob29rc3ltYm9sZ3JlZWsiLAogIDB4MDNkNCwKICAiVXBzaWxvbmhvb2tzeW1ib2wiLAogIDB4MDNkMiwKICAiVXBzaWxvbnRvbm9zIiwKICAweDAzOGUsCiAgIlVyaW5nIiwKICAweDAxNmUsCiAgIlVzaG9ydGN5cmlsbGljIiwKICAweDA0MGUsCiAgIlVzbWFsbCIsCiAgMHhmNzc1LAogICJVc3RyYWlnaHRjeXJpbGxpYyIsCiAgMHgwNGFlLAogICJVc3RyYWlnaHRzdHJva2VjeXJpbGxpYyIsCiAgMHgwNGIwLAogICJVdGlsZGUiLAogIDB4MDE2OCwKICAiVXRpbGRlYWN1dGUiLAogIDB4MWU3OCwKICAiVXRpbGRlYmVsb3ciLAogIDB4MWU3NCwKICAiViIsCiAgMHgwMDU2LAogICJWY2lyY2xlIiwKICAweDI0Y2IsCiAgIlZkb3RiZWxvdyIsCiAgMHgxZTdlLAogICJWZWN5cmlsbGljIiwKICAweDA0MTIsCiAgIlZld2FybWVuaWFuIiwKICAweDA1NGUsCiAgIlZob29rIiwKICAweDAxYjIsCiAgIlZtb25vc3BhY2UiLAogIDB4ZmYzNiwKICAiVm9hcm1lbmlhbiIsCiAgMHgwNTQ4LAogICJWc21hbGwiLAogIDB4Zjc3NiwKICAiVnRpbGRlIiwKICAweDFlN2MsCiAgIlciLAogIDB4MDA1NywKICAiV2FjdXRlIiwKICAweDFlODIsCiAgIldjaXJjbGUiLAogIDB4MjRjYywKICAiV2NpcmN1bWZsZXgiLAogIDB4MDE3NCwKICAiV2RpZXJlc2lzIiwKICAweDFlODQsCiAgIldkb3RhY2NlbnQiLAogIDB4MWU4NiwKICAiV2RvdGJlbG93IiwKICAweDFlODgsCiAgIldncmF2ZSIsCiAgMHgxZTgwLAogICJXbW9ub3NwYWNlIiwKICAweGZmMzcsCiAgIldzbWFsbCIsCiAgMHhmNzc3LAogICJYIiwKICAweDAwNTgsCiAgIlhjaXJjbGUiLAogIDB4MjRjZCwKICAiWGRpZXJlc2lzIiwKICAweDFlOGMsCiAgIlhkb3RhY2NlbnQiLAogIDB4MWU4YSwKICAiWGVoYXJtZW5pYW4iLAogIDB4MDUzZCwKICAiWGkiLAogIDB4MDM5ZSwKICAiWG1vbm9zcGFjZSIsCiAgMHhmZjM4LAogICJYc21hbGwiLAogIDB4Zjc3OCwKICAiWSIsCiAgMHgwMDU5LAogICJZYWN1dGUiLAogIDB4MDBkZCwKICAiWWFjdXRlc21hbGwiLAogIDB4ZjdmZCwKICAiWWF0Y3lyaWxsaWMiLAogIDB4MDQ2MiwKICAiWWNpcmNsZSIsCiAgMHgyNGNlLAogICJZY2lyY3VtZmxleCIsCiAgMHgwMTc2LAogICJZZGllcmVzaXMiLAogIDB4MDE3OCwKICAiWWRpZXJlc2lzc21hbGwiLAogIDB4ZjdmZiwKICAiWWRvdGFjY2VudCIsCiAgMHgxZThlLAogICJZZG90YmVsb3ciLAogIDB4MWVmNCwKICAiWWVyaWN5cmlsbGljIiwKICAweDA0MmIsCiAgIlllcnVkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZjgsCiAgIllncmF2ZSIsCiAgMHgxZWYyLAogICJZaG9vayIsCiAgMHgwMWIzLAogICJZaG9va2Fib3ZlIiwKICAweDFlZjYsCiAgIllpYXJtZW5pYW4iLAogIDB4MDU0NSwKICAiWWljeXJpbGxpYyIsCiAgMHgwNDA3LAogICJZaXduYXJtZW5pYW4iLAogIDB4MDU1MiwKICAiWW1vbm9zcGFjZSIsCiAgMHhmZjM5LAogICJZc21hbGwiLAogIDB4Zjc3OSwKICAiWXRpbGRlIiwKICAweDFlZjgsCiAgIll1c2JpZ2N5cmlsbGljIiwKICAweDA0NmEsCiAgIll1c2JpZ2lvdGlmaWVkY3lyaWxsaWMiLAogIDB4MDQ2YywKICAiWXVzbGl0dGxlY3lyaWxsaWMiLAogIDB4MDQ2NiwKICAiWXVzbGl0dGxlaW90aWZpZWRjeXJpbGxpYyIsCiAgMHgwNDY4LAogICJaIiwKICAweDAwNWEsCiAgIlphYXJtZW5pYW4iLAogIDB4MDUzNiwKICAiWmFjdXRlIiwKICAweDAxNzksCiAgIlpjYXJvbiIsCiAgMHgwMTdkLAogICJaY2Fyb25zbWFsbCIsCiAgMHhmNmZmLAogICJaY2lyY2xlIiwKICAweDI0Y2YsCiAgIlpjaXJjdW1mbGV4IiwKICAweDFlOTAsCiAgIlpkb3QiLAogIDB4MDE3YiwKICAiWmRvdGFjY2VudCIsCiAgMHgwMTdiLAogICJaZG90YmVsb3ciLAogIDB4MWU5MiwKICAiWmVjeXJpbGxpYyIsCiAgMHgwNDE3LAogICJaZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTgsCiAgIlplZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRlLAogICJaZXRhIiwKICAweDAzOTYsCiAgIlpoZWFybWVuaWFuIiwKICAweDA1M2EsCiAgIlpoZWJyZXZlY3lyaWxsaWMiLAogIDB4MDRjMSwKICAiWmhlY3lyaWxsaWMiLAogIDB4MDQxNiwKICAiWmhlZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDQ5NiwKICAiWmhlZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRjLAogICJabGluZWJlbG93IiwKICAweDFlOTQsCiAgIlptb25vc3BhY2UiLAogIDB4ZmYzYSwKICAiWnNtYWxsIiwKICAweGY3N2EsCiAgIlpzdHJva2UiLAogIDB4MDFiNSwKICAiYSIsCiAgMHgwMDYxLAogICJhYWJlbmdhbGkiLAogIDB4MDk4NiwKICAiYWFjdXRlIiwKICAweDAwZTEsCiAgImFhZGV2YSIsCiAgMHgwOTA2LAogICJhYWd1amFyYXRpIiwKICAweDBhODYsCiAgImFhZ3VybXVraGkiLAogIDB4MGEwNiwKICAiYWFtYXRyYWd1cm11a2hpIiwKICAweDBhM2UsCiAgImFhcnVzcXVhcmUiLAogIDB4MzMwMywKICAiYWF2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YmUsCiAgImFhdm93ZWxzaWduZGV2YSIsCiAgMHgwOTNlLAogICJhYXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYmUsCiAgImFiYnJldmlhdGlvbm1hcmthcm1lbmlhbiIsCiAgMHgwNTVmLAogICJhYmJyZXZpYXRpb25zaWduZGV2YSIsCiAgMHgwOTcwLAogICJhYmVuZ2FsaSIsCiAgMHgwOTg1LAogICJhYm9wb21vZm8iLAogIDB4MzExYSwKICAiYWJyZXZlIiwKICAweDAxMDMsCiAgImFicmV2ZWFjdXRlIiwKICAweDFlYWYsCiAgImFicmV2ZWN5cmlsbGljIiwKICAweDA0ZDEsCiAgImFicmV2ZWRvdGJlbG93IiwKICAweDFlYjcsCiAgImFicmV2ZWdyYXZlIiwKICAweDFlYjEsCiAgImFicmV2ZWhvb2thYm92ZSIsCiAgMHgxZWIzLAogICJhYnJldmV0aWxkZSIsCiAgMHgxZWI1LAogICJhY2Fyb24iLAogIDB4MDFjZSwKICAiYWNpcmNsZSIsCiAgMHgyNGQwLAogICJhY2lyY3VtZmxleCIsCiAgMHgwMGUyLAogICJhY2lyY3VtZmxleGFjdXRlIiwKICAweDFlYTUsCiAgImFjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVhZCwKICAiYWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWE3LAogICJhY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWE5LAogICJhY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYWIsCiAgImFjdXRlIiwKICAweDAwYjQsCiAgImFjdXRlYmVsb3djbWIiLAogIDB4MDMxNywKICAiYWN1dGVjbWIiLAogIDB4MDMwMSwKICAiYWN1dGVjb21iIiwKICAweDAzMDEsCiAgImFjdXRlZGV2YSIsCiAgMHgwOTU0LAogICJhY3V0ZWxvd21vZCIsCiAgMHgwMmNmLAogICJhY3V0ZXRvbmVjbWIiLAogIDB4MDM0MSwKICAiYWN5cmlsbGljIiwKICAweDA0MzAsCiAgImFkYmxncmF2ZSIsCiAgMHgwMjAxLAogICJhZGRha2d1cm11a2hpIiwKICAweDBhNzEsCiAgImFkZXZhIiwKICAweDA5MDUsCiAgImFkaWVyZXNpcyIsCiAgMHgwMGU0LAogICJhZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGQzLAogICJhZGllcmVzaXNtYWNyb24iLAogIDB4MDFkZiwKICAiYWRvdGJlbG93IiwKICAweDFlYTEsCiAgImFkb3RtYWNyb24iLAogIDB4MDFlMSwKICAiYWUiLAogIDB4MDBlNiwKICAiYWVhY3V0ZSIsCiAgMHgwMWZkLAogICJhZWtvcmVhbiIsCiAgMHgzMTUwLAogICJhZW1hY3JvbiIsCiAgMHgwMWUzLAogICJhZmlpMDAyMDgiLAogIDB4MjAxNSwKICAiYWZpaTA4OTQxIiwKICAweDIwYTQsCiAgImFmaWkxMDAxNyIsCiAgMHgwNDEwLAogICJhZmlpMTAwMTgiLAogIDB4MDQxMSwKICAiYWZpaTEwMDE5IiwKICAweDA0MTIsCiAgImFmaWkxMDAyMCIsCiAgMHgwNDEzLAogICJhZmlpMTAwMjEiLAogIDB4MDQxNCwKICAiYWZpaTEwMDIyIiwKICAweDA0MTUsCiAgImFmaWkxMDAyMyIsCiAgMHgwNDAxLAogICJhZmlpMTAwMjQiLAogIDB4MDQxNiwKICAiYWZpaTEwMDI1IiwKICAweDA0MTcsCiAgImFmaWkxMDAyNiIsCiAgMHgwNDE4LAogICJhZmlpMTAwMjciLAogIDB4MDQxOSwKICAiYWZpaTEwMDI4IiwKICAweDA0MWEsCiAgImFmaWkxMDAyOSIsCiAgMHgwNDFiLAogICJhZmlpMTAwMzAiLAogIDB4MDQxYywKICAiYWZpaTEwMDMxIiwKICAweDA0MWQsCiAgImFmaWkxMDAzMiIsCiAgMHgwNDFlLAogICJhZmlpMTAwMzMiLAogIDB4MDQxZiwKICAiYWZpaTEwMDM0IiwKICAweDA0MjAsCiAgImFmaWkxMDAzNSIsCiAgMHgwNDIxLAogICJhZmlpMTAwMzYiLAogIDB4MDQyMiwKICAiYWZpaTEwMDM3IiwKICAweDA0MjMsCiAgImFmaWkxMDAzOCIsCiAgMHgwNDI0LAogICJhZmlpMTAwMzkiLAogIDB4MDQyNSwKICAiYWZpaTEwMDQwIiwKICAweDA0MjYsCiAgImFmaWkxMDA0MSIsCiAgMHgwNDI3LAogICJhZmlpMTAwNDIiLAogIDB4MDQyOCwKICAiYWZpaTEwMDQzIiwKICAweDA0MjksCiAgImFmaWkxMDA0NCIsCiAgMHgwNDJhLAogICJhZmlpMTAwNDUiLAogIDB4MDQyYiwKICAiYWZpaTEwMDQ2IiwKICAweDA0MmMsCiAgImFmaWkxMDA0NyIsCiAgMHgwNDJkLAogICJhZmlpMTAwNDgiLAogIDB4MDQyZSwKICAiYWZpaTEwMDQ5IiwKICAweDA0MmYsCiAgImFmaWkxMDA1MCIsCiAgMHgwNDkwLAogICJhZmlpMTAwNTEiLAogIDB4MDQwMiwKICAiYWZpaTEwMDUyIiwKICAweDA0MDMsCiAgImFmaWkxMDA1MyIsCiAgMHgwNDA0LAogICJhZmlpMTAwNTQiLAogIDB4MDQwNSwKICAiYWZpaTEwMDU1IiwKICAweDA0MDYsCiAgImFmaWkxMDA1NiIsCiAgMHgwNDA3LAogICJhZmlpMTAwNTciLAogIDB4MDQwOCwKICAiYWZpaTEwMDU4IiwKICAweDA0MDksCiAgImFmaWkxMDA1OSIsCiAgMHgwNDBhLAogICJhZmlpMTAwNjAiLAogIDB4MDQwYiwKICAiYWZpaTEwMDYxIiwKICAweDA0MGMsCiAgImFmaWkxMDA2MiIsCiAgMHgwNDBlLAogICJhZmlpMTAwNjMiLAogIDB4ZjZjNCwKICAiYWZpaTEwMDY0IiwKICAweGY2YzUsCiAgImFmaWkxMDA2NSIsCiAgMHgwNDMwLAogICJhZmlpMTAwNjYiLAogIDB4MDQzMSwKICAiYWZpaTEwMDY3IiwKICAweDA0MzIsCiAgImFmaWkxMDA2OCIsCiAgMHgwNDMzLAogICJhZmlpMTAwNjkiLAogIDB4MDQzNCwKICAiYWZpaTEwMDcwIiwKICAweDA0MzUsCiAgImFmaWkxMDA3MSIsCiAgMHgwNDUxLAogICJhZmlpMTAwNzIiLAogIDB4MDQzNiwKICAiYWZpaTEwMDczIiwKICAweDA0MzcsCiAgImFmaWkxMDA3NCIsCiAgMHgwNDM4LAogICJhZmlpMTAwNzUiLAogIDB4MDQzOSwKICAiYWZpaTEwMDc2IiwKICAweDA0M2EsCiAgImFmaWkxMDA3NyIsCiAgMHgwNDNiLAogICJhZmlpMTAwNzgiLAogIDB4MDQzYywKICAiYWZpaTEwMDc5IiwKICAweDA0M2QsCiAgImFmaWkxMDA4MCIsCiAgMHgwNDNlLAogICJhZmlpMTAwODEiLAogIDB4MDQzZiwKICAiYWZpaTEwMDgyIiwKICAweDA0NDAsCiAgImFmaWkxMDA4MyIsCiAgMHgwNDQxLAogICJhZmlpMTAwODQiLAogIDB4MDQ0MiwKICAiYWZpaTEwMDg1IiwKICAweDA0NDMsCiAgImFmaWkxMDA4NiIsCiAgMHgwNDQ0LAogICJhZmlpMTAwODciLAogIDB4MDQ0NSwKICAiYWZpaTEwMDg4IiwKICAweDA0NDYsCiAgImFmaWkxMDA4OSIsCiAgMHgwNDQ3LAogICJhZmlpMTAwOTAiLAogIDB4MDQ0OCwKICAiYWZpaTEwMDkxIiwKICAweDA0NDksCiAgImFmaWkxMDA5MiIsCiAgMHgwNDRhLAogICJhZmlpMTAwOTMiLAogIDB4MDQ0YiwKICAiYWZpaTEwMDk0IiwKICAweDA0NGMsCiAgImFmaWkxMDA5NSIsCiAgMHgwNDRkLAogICJhZmlpMTAwOTYiLAogIDB4MDQ0ZSwKICAiYWZpaTEwMDk3IiwKICAweDA0NGYsCiAgImFmaWkxMDA5OCIsCiAgMHgwNDkxLAogICJhZmlpMTAwOTkiLAogIDB4MDQ1MiwKICAiYWZpaTEwMTAwIiwKICAweDA0NTMsCiAgImFmaWkxMDEwMSIsCiAgMHgwNDU0LAogICJhZmlpMTAxMDIiLAogIDB4MDQ1NSwKICAiYWZpaTEwMTAzIiwKICAweDA0NTYsCiAgImFmaWkxMDEwNCIsCiAgMHgwNDU3LAogICJhZmlpMTAxMDUiLAogIDB4MDQ1OCwKICAiYWZpaTEwMTA2IiwKICAweDA0NTksCiAgImFmaWkxMDEwNyIsCiAgMHgwNDVhLAogICJhZmlpMTAxMDgiLAogIDB4MDQ1YiwKICAiYWZpaTEwMTA5IiwKICAweDA0NWMsCiAgImFmaWkxMDExMCIsCiAgMHgwNDVlLAogICJhZmlpMTAxNDUiLAogIDB4MDQwZiwKICAiYWZpaTEwMTQ2IiwKICAweDA0NjIsCiAgImFmaWkxMDE0NyIsCiAgMHgwNDcyLAogICJhZmlpMTAxNDgiLAogIDB4MDQ3NCwKICAiYWZpaTEwMTkyIiwKICAweGY2YzYsCiAgImFmaWkxMDE5MyIsCiAgMHgwNDVmLAogICJhZmlpMTAxOTQiLAogIDB4MDQ2MywKICAiYWZpaTEwMTk1IiwKICAweDA0NzMsCiAgImFmaWkxMDE5NiIsCiAgMHgwNDc1LAogICJhZmlpMTA4MzEiLAogIDB4ZjZjNywKICAiYWZpaTEwODMyIiwKICAweGY2YzgsCiAgImFmaWkxMDg0NiIsCiAgMHgwNGQ5LAogICJhZmlpMjk5IiwKICAweDIwMGUsCiAgImFmaWkzMDAiLAogIDB4MjAwZiwKICAiYWZpaTMwMSIsCiAgMHgyMDBkLAogICJhZmlpNTczODEiLAogIDB4MDY2YSwKICAiYWZpaTU3Mzg4IiwKICAweDA2MGMsCiAgImFmaWk1NzM5MiIsCiAgMHgwNjYwLAogICJhZmlpNTczOTMiLAogIDB4MDY2MSwKICAiYWZpaTU3Mzk0IiwKICAweDA2NjIsCiAgImFmaWk1NzM5NSIsCiAgMHgwNjYzLAogICJhZmlpNTczOTYiLAogIDB4MDY2NCwKICAiYWZpaTU3Mzk3IiwKICAweDA2NjUsCiAgImFmaWk1NzM5OCIsCiAgMHgwNjY2LAogICJhZmlpNTczOTkiLAogIDB4MDY2NywKICAiYWZpaTU3NDAwIiwKICAweDA2NjgsCiAgImFmaWk1NzQwMSIsCiAgMHgwNjY5LAogICJhZmlpNTc0MDMiLAogIDB4MDYxYiwKICAiYWZpaTU3NDA3IiwKICAweDA2MWYsCiAgImFmaWk1NzQwOSIsCiAgMHgwNjIxLAogICJhZmlpNTc0MTAiLAogIDB4MDYyMiwKICAiYWZpaTU3NDExIiwKICAweDA2MjMsCiAgImFmaWk1NzQxMiIsCiAgMHgwNjI0LAogICJhZmlpNTc0MTMiLAogIDB4MDYyNSwKICAiYWZpaTU3NDE0IiwKICAweDA2MjYsCiAgImFmaWk1NzQxNSIsCiAgMHgwNjI3LAogICJhZmlpNTc0MTYiLAogIDB4MDYyOCwKICAiYWZpaTU3NDE3IiwKICAweDA2MjksCiAgImFmaWk1NzQxOCIsCiAgMHgwNjJhLAogICJhZmlpNTc0MTkiLAogIDB4MDYyYiwKICAiYWZpaTU3NDIwIiwKICAweDA2MmMsCiAgImFmaWk1NzQyMSIsCiAgMHgwNjJkLAogICJhZmlpNTc0MjIiLAogIDB4MDYyZSwKICAiYWZpaTU3NDIzIiwKICAweDA2MmYsCiAgImFmaWk1NzQyNCIsCiAgMHgwNjMwLAogICJhZmlpNTc0MjUiLAogIDB4MDYzMSwKICAiYWZpaTU3NDI2IiwKICAweDA2MzIsCiAgImFmaWk1NzQyNyIsCiAgMHgwNjMzLAogICJhZmlpNTc0MjgiLAogIDB4MDYzNCwKICAiYWZpaTU3NDI5IiwKICAweDA2MzUsCiAgImFmaWk1NzQzMCIsCiAgMHgwNjM2LAogICJhZmlpNTc0MzEiLAogIDB4MDYzNywKICAiYWZpaTU3NDMyIiwKICAweDA2MzgsCiAgImFmaWk1NzQzMyIsCiAgMHgwNjM5LAogICJhZmlpNTc0MzQiLAogIDB4MDYzYSwKICAiYWZpaTU3NDQwIiwKICAweDA2NDAsCiAgImFmaWk1NzQ0MSIsCiAgMHgwNjQxLAogICJhZmlpNTc0NDIiLAogIDB4MDY0MiwKICAiYWZpaTU3NDQzIiwKICAweDA2NDMsCiAgImFmaWk1NzQ0NCIsCiAgMHgwNjQ0LAogICJhZmlpNTc0NDUiLAogIDB4MDY0NSwKICAiYWZpaTU3NDQ2IiwKICAweDA2NDYsCiAgImFmaWk1NzQ0OCIsCiAgMHgwNjQ4LAogICJhZmlpNTc0NDkiLAogIDB4MDY0OSwKICAiYWZpaTU3NDUwIiwKICAweDA2NGEsCiAgImFmaWk1NzQ1MSIsCiAgMHgwNjRiLAogICJhZmlpNTc0NTIiLAogIDB4MDY0YywKICAiYWZpaTU3NDUzIiwKICAweDA2NGQsCiAgImFmaWk1NzQ1NCIsCiAgMHgwNjRlLAogICJhZmlpNTc0NTUiLAogIDB4MDY0ZiwKICAiYWZpaTU3NDU2IiwKICAweDA2NTAsCiAgImFmaWk1NzQ1NyIsCiAgMHgwNjUxLAogICJhZmlpNTc0NTgiLAogIDB4MDY1MiwKICAiYWZpaTU3NDcwIiwKICAweDA2NDcsCiAgImFmaWk1NzUwNSIsCiAgMHgwNmE0LAogICJhZmlpNTc1MDYiLAogIDB4MDY3ZSwKICAiYWZpaTU3NTA3IiwKICAweDA2ODYsCiAgImFmaWk1NzUwOCIsCiAgMHgwNjk4LAogICJhZmlpNTc1MDkiLAogIDB4MDZhZiwKICAiYWZpaTU3NTExIiwKICAweDA2NzksCiAgImFmaWk1NzUxMiIsCiAgMHgwNjg4LAogICJhZmlpNTc1MTMiLAogIDB4MDY5MSwKICAiYWZpaTU3NTE0IiwKICAweDA2YmEsCiAgImFmaWk1NzUxOSIsCiAgMHgwNmQyLAogICJhZmlpNTc1MzQiLAogIDB4MDZkNSwKICAiYWZpaTU3NjM2IiwKICAweDIwYWEsCiAgImFmaWk1NzY0NSIsCiAgMHgwNWJlLAogICJhZmlpNTc2NTgiLAogIDB4MDVjMywKICAiYWZpaTU3NjY0IiwKICAweDA1ZDAsCiAgImFmaWk1NzY2NSIsCiAgMHgwNWQxLAogICJhZmlpNTc2NjYiLAogIDB4MDVkMiwKICAiYWZpaTU3NjY3IiwKICAweDA1ZDMsCiAgImFmaWk1NzY2OCIsCiAgMHgwNWQ0LAogICJhZmlpNTc2NjkiLAogIDB4MDVkNSwKICAiYWZpaTU3NjcwIiwKICAweDA1ZDYsCiAgImFmaWk1NzY3MSIsCiAgMHgwNWQ3LAogICJhZmlpNTc2NzIiLAogIDB4MDVkOCwKICAiYWZpaTU3NjczIiwKICAweDA1ZDksCiAgImFmaWk1NzY3NCIsCiAgMHgwNWRhLAogICJhZmlpNTc2NzUiLAogIDB4MDVkYiwKICAiYWZpaTU3Njc2IiwKICAweDA1ZGMsCiAgImFmaWk1NzY3NyIsCiAgMHgwNWRkLAogICJhZmlpNTc2NzgiLAogIDB4MDVkZSwKICAiYWZpaTU3Njc5IiwKICAweDA1ZGYsCiAgImFmaWk1NzY4MCIsCiAgMHgwNWUwLAogICJhZmlpNTc2ODEiLAogIDB4MDVlMSwKICAiYWZpaTU3NjgyIiwKICAweDA1ZTIsCiAgImFmaWk1NzY4MyIsCiAgMHgwNWUzLAogICJhZmlpNTc2ODQiLAogIDB4MDVlNCwKICAiYWZpaTU3Njg1IiwKICAweDA1ZTUsCiAgImFmaWk1NzY4NiIsCiAgMHgwNWU2LAogICJhZmlpNTc2ODciLAogIDB4MDVlNywKICAiYWZpaTU3Njg4IiwKICAweDA1ZTgsCiAgImFmaWk1NzY4OSIsCiAgMHgwNWU5LAogICJhZmlpNTc2OTAiLAogIDB4MDVlYSwKICAiYWZpaTU3Njk0IiwKICAweGZiMmEsCiAgImFmaWk1NzY5NSIsCiAgMHhmYjJiLAogICJhZmlpNTc3MDAiLAogIDB4ZmI0YiwKICAiYWZpaTU3NzA1IiwKICAweGZiMWYsCiAgImFmaWk1NzcxNiIsCiAgMHgwNWYwLAogICJhZmlpNTc3MTciLAogIDB4MDVmMSwKICAiYWZpaTU3NzE4IiwKICAweDA1ZjIsCiAgImFmaWk1NzcyMyIsCiAgMHhmYjM1LAogICJhZmlpNTc3OTMiLAogIDB4MDViNCwKICAiYWZpaTU3Nzk0IiwKICAweDA1YjUsCiAgImFmaWk1Nzc5NSIsCiAgMHgwNWI2LAogICJhZmlpNTc3OTYiLAogIDB4MDViYiwKICAiYWZpaTU3Nzk3IiwKICAweDA1YjgsCiAgImFmaWk1Nzc5OCIsCiAgMHgwNWI3LAogICJhZmlpNTc3OTkiLAogIDB4MDViMCwKICAiYWZpaTU3ODAwIiwKICAweDA1YjIsCiAgImFmaWk1NzgwMSIsCiAgMHgwNWIxLAogICJhZmlpNTc4MDIiLAogIDB4MDViMywKICAiYWZpaTU3ODAzIiwKICAweDA1YzIsCiAgImFmaWk1NzgwNCIsCiAgMHgwNWMxLAogICJhZmlpNTc4MDYiLAogIDB4MDViOSwKICAiYWZpaTU3ODA3IiwKICAweDA1YmMsCiAgImFmaWk1NzgzOSIsCiAgMHgwNWJkLAogICJhZmlpNTc4NDEiLAogIDB4MDViZiwKICAiYWZpaTU3ODQyIiwKICAweDA1YzAsCiAgImFmaWk1NzkyOSIsCiAgMHgwMmJjLAogICJhZmlpNjEyNDgiLAogIDB4MjEwNSwKICAiYWZpaTYxMjg5IiwKICAweDIxMTMsCiAgImFmaWk2MTM1MiIsCiAgMHgyMTE2LAogICJhZmlpNjE1NzMiLAogIDB4MjAyYywKICAiYWZpaTYxNTc0IiwKICAweDIwMmQsCiAgImFmaWk2MTU3NSIsCiAgMHgyMDJlLAogICJhZmlpNjE2NjQiLAogIDB4MjAwYywKICAiYWZpaTYzMTY3IiwKICAweDA2NmQsCiAgImFmaWk2NDkzNyIsCiAgMHgwMmJkLAogICJhZ3JhdmUiLAogIDB4MDBlMCwKICAiYWd1amFyYXRpIiwKICAweDBhODUsCiAgImFndXJtdWtoaSIsCiAgMHgwYTA1LAogICJhaGlyYWdhbmEiLAogIDB4MzA0MiwKICAiYWhvb2thYm92ZSIsCiAgMHgxZWEzLAogICJhaWJlbmdhbGkiLAogIDB4MDk5MCwKICAiYWlib3BvbW9mbyIsCiAgMHgzMTFlLAogICJhaWRldmEiLAogIDB4MDkxMCwKICAiYWllY3lyaWxsaWMiLAogIDB4MDRkNSwKICAiYWlndWphcmF0aSIsCiAgMHgwYTkwLAogICJhaWd1cm11a2hpIiwKICAweDBhMTAsCiAgImFpbWF0cmFndXJtdWtoaSIsCiAgMHgwYTQ4LAogICJhaW5hcmFiaWMiLAogIDB4MDYzOSwKICAiYWluZmluYWxhcmFiaWMiLAogIDB4ZmVjYSwKICAiYWluaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWNiLAogICJhaW5tZWRpYWxhcmFiaWMiLAogIDB4ZmVjYywKICAiYWludmVydGVkYnJldmUiLAogIDB4MDIwMywKICAiYWl2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YzgsCiAgImFpdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ4LAogICJhaXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzgsCiAgImFrYXRha2FuYSIsCiAgMHgzMGEyLAogICJha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3MSwKICAiYWtvcmVhbiIsCiAgMHgzMTRmLAogICJhbGVmIiwKICAweDA1ZDAsCiAgImFsZWZhcmFiaWMiLAogIDB4MDYyNywKICAiYWxlZmRhZ2VzaGhlYnJldyIsCiAgMHhmYjMwLAogICJhbGVmZmluYWxhcmFiaWMiLAogIDB4ZmU4ZSwKICAiYWxlZmhhbXphYWJvdmVhcmFiaWMiLAogIDB4MDYyMywKICAiYWxlZmhhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmZTg0LAogICJhbGVmaGFtemFiZWxvd2FyYWJpYyIsCiAgMHgwNjI1LAogICJhbGVmaGFtemFiZWxvd2ZpbmFsYXJhYmljIiwKICAweGZlODgsCiAgImFsZWZoZWJyZXciLAogIDB4MDVkMCwKICAiYWxlZmxhbWVkaGVicmV3IiwKICAweGZiNGYsCiAgImFsZWZtYWRkYWFib3ZlYXJhYmljIiwKICAweDA2MjIsCiAgImFsZWZtYWRkYWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmU4MiwKICAiYWxlZm1ha3N1cmFhcmFiaWMiLAogIDB4MDY0OSwKICAiYWxlZm1ha3N1cmFmaW5hbGFyYWJpYyIsCiAgMHhmZWYwLAogICJhbGVmbWFrc3VyYWluaXRpYWxhcmFiaWMiLAogIDB4ZmVmMywKICAiYWxlZm1ha3N1cmFtZWRpYWxhcmFiaWMiLAogIDB4ZmVmNCwKICAiYWxlZnBhdGFoaGVicmV3IiwKICAweGZiMmUsCiAgImFsZWZxYW1hdHNoZWJyZXciLAogIDB4ZmIyZiwKICAiYWxlcGgiLAogIDB4MjEzNSwKICAiYWxsZXF1YWwiLAogIDB4MjI0YywKICAiYWxwaGEiLAogIDB4MDNiMSwKICAiYWxwaGF0b25vcyIsCiAgMHgwM2FjLAogICJhbWFjcm9uIiwKICAweDAxMDEsCiAgImFtb25vc3BhY2UiLAogIDB4ZmY0MSwKICAiYW1wZXJzYW5kIiwKICAweDAwMjYsCiAgImFtcGVyc2FuZG1vbm9zcGFjZSIsCiAgMHhmZjA2LAogICJhbXBlcnNhbmRzbWFsbCIsCiAgMHhmNzI2LAogICJhbXNxdWFyZSIsCiAgMHgzM2MyLAogICJhbmJvcG9tb2ZvIiwKICAweDMxMjIsCiAgImFuZ2JvcG9tb2ZvIiwKICAweDMxMjQsCiAgImFuZ2JyYWNrZXRsZWZ0IiwKICAweDMwMDgsCiAgImFuZ2JyYWNrZXRyaWdodCIsCiAgMHgzMDA5LAogICJhbmdraGFua2h1dGhhaSIsCiAgMHgwZTVhLAogICJhbmdsZSIsCiAgMHgyMjIwLAogICJhbmdsZWJyYWNrZXRsZWZ0IiwKICAweDMwMDgsCiAgImFuZ2xlYnJhY2tldGxlZnR2ZXJ0aWNhbCIsCiAgMHhmZTNmLAogICJhbmdsZWJyYWNrZXRyaWdodCIsCiAgMHgzMDA5LAogICJhbmdsZWJyYWNrZXRyaWdodHZlcnRpY2FsIiwKICAweGZlNDAsCiAgImFuZ2xlbGVmdCIsCiAgMHgyMzI5LAogICJhbmdsZXJpZ2h0IiwKICAweDIzMmEsCiAgImFuZ3N0cm9tIiwKICAweDIxMmIsCiAgImFub3RlbGVpYSIsCiAgMHgwMzg3LAogICJhbnVkYXR0YWRldmEiLAogIDB4MDk1MiwKICAiYW51c3ZhcmFiZW5nYWxpIiwKICAweDA5ODIsCiAgImFudXN2YXJhZGV2YSIsCiAgMHgwOTAyLAogICJhbnVzdmFyYWd1amFyYXRpIiwKICAweDBhODIsCiAgImFvZ29uZWsiLAogIDB4MDEwNSwKICAiYXBhYXRvc3F1YXJlIiwKICAweDMzMDAsCiAgImFwYXJlbiIsCiAgMHgyNDljLAogICJhcG9zdHJvcGhlYXJtZW5pYW4iLAogIDB4MDU1YSwKICAiYXBvc3Ryb3BoZW1vZCIsCiAgMHgwMmJjLAogICJhcHBsZSIsCiAgMHhmOGZmLAogICJhcHByb2FjaGVzIiwKICAweDIyNTAsCiAgImFwcHJveGVxdWFsIiwKICAweDIyNDgsCiAgImFwcHJveGVxdWFsb3JpbWFnZSIsCiAgMHgyMjUyLAogICJhcHByb3hpbWF0ZWx5ZXF1YWwiLAogIDB4MjI0NSwKICAiYXJhZWFla29yZWFuIiwKICAweDMxOGUsCiAgImFyYWVha29yZWFuIiwKICAweDMxOGQsCiAgImFyYyIsCiAgMHgyMzEyLAogICJhcmlnaHRoYWxmcmluZyIsCiAgMHgxZTlhLAogICJhcmluZyIsCiAgMHgwMGU1LAogICJhcmluZ2FjdXRlIiwKICAweDAxZmIsCiAgImFyaW5nYmVsb3ciLAogIDB4MWUwMSwKICAiYXJyb3dib3RoIiwKICAweDIxOTQsCiAgImFycm93ZGFzaGRvd24iLAogIDB4MjFlMywKICAiYXJyb3dkYXNobGVmdCIsCiAgMHgyMWUwLAogICJhcnJvd2Rhc2hyaWdodCIsCiAgMHgyMWUyLAogICJhcnJvd2Rhc2h1cCIsCiAgMHgyMWUxLAogICJhcnJvd2RibGJvdGgiLAogIDB4MjFkNCwKICAiYXJyb3dkYmxkb3duIiwKICAweDIxZDMsCiAgImFycm93ZGJsbGVmdCIsCiAgMHgyMWQwLAogICJhcnJvd2RibHJpZ2h0IiwKICAweDIxZDIsCiAgImFycm93ZGJsdXAiLAogIDB4MjFkMSwKICAiYXJyb3dkb3duIiwKICAweDIxOTMsCiAgImFycm93ZG93bmxlZnQiLAogIDB4MjE5OSwKICAiYXJyb3dkb3ducmlnaHQiLAogIDB4MjE5OCwKICAiYXJyb3dkb3dud2hpdGUiLAogIDB4MjFlOSwKICAiYXJyb3doZWFkZG93bm1vZCIsCiAgMHgwMmM1LAogICJhcnJvd2hlYWRsZWZ0bW9kIiwKICAweDAyYzIsCiAgImFycm93aGVhZHJpZ2h0bW9kIiwKICAweDAyYzMsCiAgImFycm93aGVhZHVwbW9kIiwKICAweDAyYzQsCiAgImFycm93aG9yaXpleCIsCiAgMHhmOGU3LAogICJhcnJvd2xlZnQiLAogIDB4MjE5MCwKICAiYXJyb3dsZWZ0ZGJsIiwKICAweDIxZDAsCiAgImFycm93bGVmdGRibHN0cm9rZSIsCiAgMHgyMWNkLAogICJhcnJvd2xlZnRvdmVycmlnaHQiLAogIDB4MjFjNiwKICAiYXJyb3dsZWZ0d2hpdGUiLAogIDB4MjFlNiwKICAiYXJyb3dyaWdodCIsCiAgMHgyMTkyLAogICJhcnJvd3JpZ2h0ZGJsc3Ryb2tlIiwKICAweDIxY2YsCiAgImFycm93cmlnaHRoZWF2eSIsCiAgMHgyNzllLAogICJhcnJvd3JpZ2h0b3ZlcmxlZnQiLAogIDB4MjFjNCwKICAiYXJyb3dyaWdodHdoaXRlIiwKICAweDIxZTgsCiAgImFycm93dGFibGVmdCIsCiAgMHgyMWU0LAogICJhcnJvd3RhYnJpZ2h0IiwKICAweDIxZTUsCiAgImFycm93dXAiLAogIDB4MjE5MSwKICAiYXJyb3d1cGRuIiwKICAweDIxOTUsCiAgImFycm93dXBkbmJzZSIsCiAgMHgyMWE4LAogICJhcnJvd3VwZG93bmJhc2UiLAogIDB4MjFhOCwKICAiYXJyb3d1cGxlZnQiLAogIDB4MjE5NiwKICAiYXJyb3d1cGxlZnRvZmRvd24iLAogIDB4MjFjNSwKICAiYXJyb3d1cHJpZ2h0IiwKICAweDIxOTcsCiAgImFycm93dXB3aGl0ZSIsCiAgMHgyMWU3LAogICJhcnJvd3ZlcnRleCIsCiAgMHhmOGU2LAogICJhc2NpaWNpcmN1bSIsCiAgMHgwMDVlLAogICJhc2NpaWNpcmN1bW1vbm9zcGFjZSIsCiAgMHhmZjNlLAogICJhc2NpaXRpbGRlIiwKICAweDAwN2UsCiAgImFzY2lpdGlsZGVtb25vc3BhY2UiLAogIDB4ZmY1ZSwKICAiYXNjcmlwdCIsCiAgMHgwMjUxLAogICJhc2NyaXB0dHVybmVkIiwKICAweDAyNTIsCiAgImFzbWFsbGhpcmFnYW5hIiwKICAweDMwNDEsCiAgImFzbWFsbGthdGFrYW5hIiwKICAweDMwYTEsCiAgImFzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNjcsCiAgImFzdGVyaXNrIiwKICAweDAwMmEsCiAgImFzdGVyaXNrYWx0b25lYXJhYmljIiwKICAweDA2NmQsCiAgImFzdGVyaXNrYXJhYmljIiwKICAweDA2NmQsCiAgImFzdGVyaXNrbWF0aCIsCiAgMHgyMjE3LAogICJhc3Rlcmlza21vbm9zcGFjZSIsCiAgMHhmZjBhLAogICJhc3Rlcmlza3NtYWxsIiwKICAweGZlNjEsCiAgImFzdGVyaXNtIiwKICAweDIwNDIsCiAgImFzdXBlcmlvciIsCiAgMHhmNmU5LAogICJhc3ltcHRvdGljYWxseWVxdWFsIiwKICAweDIyNDMsCiAgImF0IiwKICAweDAwNDAsCiAgImF0aWxkZSIsCiAgMHgwMGUzLAogICJhdG1vbm9zcGFjZSIsCiAgMHhmZjIwLAogICJhdHNtYWxsIiwKICAweGZlNmIsCiAgImF0dXJuZWQiLAogIDB4MDI1MCwKICAiYXViZW5nYWxpIiwKICAweDA5OTQsCiAgImF1Ym9wb21vZm8iLAogIDB4MzEyMCwKICAiYXVkZXZhIiwKICAweDA5MTQsCiAgImF1Z3VqYXJhdGkiLAogIDB4MGE5NCwKICAiYXVndXJtdWtoaSIsCiAgMHgwYTE0LAogICJhdWxlbmd0aG1hcmtiZW5nYWxpIiwKICAweDA5ZDcsCiAgImF1bWF0cmFndXJtdWtoaSIsCiAgMHgwYTRjLAogICJhdXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljYywKICAiYXV2b3dlbHNpZ25kZXZhIiwKICAweDA5NGMsCiAgImF1dm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjYywKICAiYXZhZ3JhaGFkZXZhIiwKICAweDA5M2QsCiAgImF5YmFybWVuaWFuIiwKICAweDA1NjEsCiAgImF5aW4iLAogIDB4MDVlMiwKICAiYXlpbmFsdG9uZWhlYnJldyIsCiAgMHhmYjIwLAogICJheWluaGVicmV3IiwKICAweDA1ZTIsCiAgImIiLAogIDB4MDA2MiwKICAiYmFiZW5nYWxpIiwKICAweDA5YWMsCiAgImJhY2tzbGFzaCIsCiAgMHgwMDVjLAogICJiYWNrc2xhc2htb25vc3BhY2UiLAogIDB4ZmYzYywKICAiYmFkZXZhIiwKICAweDA5MmMsCiAgImJhZ3VqYXJhdGkiLAogIDB4MGFhYywKICAiYmFndXJtdWtoaSIsCiAgMHgwYTJjLAogICJiYWhpcmFnYW5hIiwKICAweDMwNzAsCiAgImJhaHR0aGFpIiwKICAweDBlM2YsCiAgImJha2F0YWthbmEiLAogIDB4MzBkMCwKICAiYmFyIiwKICAweDAwN2MsCiAgImJhcm1vbm9zcGFjZSIsCiAgMHhmZjVjLAogICJiYm9wb21vZm8iLAogIDB4MzEwNSwKICAiYmNpcmNsZSIsCiAgMHgyNGQxLAogICJiZG90YWNjZW50IiwKICAweDFlMDMsCiAgImJkb3RiZWxvdyIsCiAgMHgxZTA1LAogICJiZWFtZWRzaXh0ZWVudGhub3RlcyIsCiAgMHgyNjZjLAogICJiZWNhdXNlIiwKICAweDIyMzUsCiAgImJlY3lyaWxsaWMiLAogIDB4MDQzMSwKICAiYmVoYXJhYmljIiwKICAweDA2MjgsCiAgImJlaGZpbmFsYXJhYmljIiwKICAweGZlOTAsCiAgImJlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5MSwKICAiYmVoaXJhZ2FuYSIsCiAgMHgzMDc5LAogICJiZWhtZWRpYWxhcmFiaWMiLAogIDB4ZmU5MiwKICAiYmVobWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmM5ZiwKICAiYmVobWVlbWlzb2xhdGVkYXJhYmljIiwKICAweGZjMDgsCiAgImJlaG5vb25maW5hbGFyYWJpYyIsCiAgMHhmYzZkLAogICJiZWthdGFrYW5hIiwKICAweDMwZDksCiAgImJlbmFybWVuaWFuIiwKICAweDA1NjIsCiAgImJldCIsCiAgMHgwNWQxLAogICJiZXRhIiwKICAweDAzYjIsCiAgImJldGFzeW1ib2xncmVlayIsCiAgMHgwM2QwLAogICJiZXRkYWdlc2giLAogIDB4ZmIzMSwKICAiYmV0ZGFnZXNoaGVicmV3IiwKICAweGZiMzEsCiAgImJldGhlYnJldyIsCiAgMHgwNWQxLAogICJiZXRyYWZlaGVicmV3IiwKICAweGZiNGMsCiAgImJoYWJlbmdhbGkiLAogIDB4MDlhZCwKICAiYmhhZGV2YSIsCiAgMHgwOTJkLAogICJiaGFndWphcmF0aSIsCiAgMHgwYWFkLAogICJiaGFndXJtdWtoaSIsCiAgMHgwYTJkLAogICJiaG9vayIsCiAgMHgwMjUzLAogICJiaWhpcmFnYW5hIiwKICAweDMwNzMsCiAgImJpa2F0YWthbmEiLAogIDB4MzBkMywKICAiYmlsYWJpYWxjbGljayIsCiAgMHgwMjk4LAogICJiaW5kaWd1cm11a2hpIiwKICAweDBhMDIsCiAgImJpcnVzcXVhcmUiLAogIDB4MzMzMSwKICAiYmxhY2tjaXJjbGUiLAogIDB4MjVjZiwKICAiYmxhY2tkaWFtb25kIiwKICAweDI1YzYsCiAgImJsYWNrZG93bnBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjViYywKICAiYmxhY2tsZWZ0cG9pbnRpbmdwb2ludGVyIiwKICAweDI1YzQsCiAgImJsYWNrbGVmdHBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjVjMCwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldGxlZnQiLAogIDB4MzAxMCwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldGxlZnR2ZXJ0aWNhbCIsCiAgMHhmZTNiLAogICJibGFja2xlbnRpY3VsYXJicmFja2V0cmlnaHQiLAogIDB4MzAxMSwKICAiYmxhY2tsZW50aWN1bGFyYnJhY2tldHJpZ2h0dmVydGljYWwiLAogIDB4ZmUzYywKICAiYmxhY2tsb3dlcmxlZnR0cmlhbmdsZSIsCiAgMHgyNWUzLAogICJibGFja2xvd2VycmlnaHR0cmlhbmdsZSIsCiAgMHgyNWUyLAogICJibGFja3JlY3RhbmdsZSIsCiAgMHgyNWFjLAogICJibGFja3JpZ2h0cG9pbnRpbmdwb2ludGVyIiwKICAweDI1YmEsCiAgImJsYWNrcmlnaHRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjYsCiAgImJsYWNrc21hbGxzcXVhcmUiLAogIDB4MjVhYSwKICAiYmxhY2tzbWlsaW5nZmFjZSIsCiAgMHgyNjNiLAogICJibGFja3NxdWFyZSIsCiAgMHgyNWEwLAogICJibGFja3N0YXIiLAogIDB4MjYwNSwKICAiYmxhY2t1cHBlcmxlZnR0cmlhbmdsZSIsCiAgMHgyNWU0LAogICJibGFja3VwcGVycmlnaHR0cmlhbmdsZSIsCiAgMHgyNWU1LAogICJibGFja3VwcG9pbnRpbmdzbWFsbHRyaWFuZ2xlIiwKICAweDI1YjQsCiAgImJsYWNrdXBwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjIsCiAgImJsYW5rIiwKICAweDI0MjMsCiAgImJsaW5lYmVsb3ciLAogIDB4MWUwNywKICAiYmxvY2siLAogIDB4MjU4OCwKICAiYm1vbm9zcGFjZSIsCiAgMHhmZjQyLAogICJib2JhaW1haXRoYWkiLAogIDB4MGUxYSwKICAiYm9oaXJhZ2FuYSIsCiAgMHgzMDdjLAogICJib2thdGFrYW5hIiwKICAweDMwZGMsCiAgImJwYXJlbiIsCiAgMHgyNDlkLAogICJicXNxdWFyZSIsCiAgMHgzM2MzLAogICJicmFjZWV4IiwKICAweGY4ZjQsCiAgImJyYWNlbGVmdCIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRidCIsCiAgMHhmOGYzLAogICJicmFjZWxlZnRtaWQiLAogIDB4ZjhmMiwKICAiYnJhY2VsZWZ0bW9ub3NwYWNlIiwKICAweGZmNWIsCiAgImJyYWNlbGVmdHNtYWxsIiwKICAweGZlNWIsCiAgImJyYWNlbGVmdHRwIiwKICAweGY4ZjEsCiAgImJyYWNlbGVmdHZlcnRpY2FsIiwKICAweGZlMzcsCiAgImJyYWNlcmlnaHQiLAogIDB4MDA3ZCwKICAiYnJhY2VyaWdodGJ0IiwKICAweGY4ZmUsCiAgImJyYWNlcmlnaHRtaWQiLAogIDB4ZjhmZCwKICAiYnJhY2VyaWdodG1vbm9zcGFjZSIsCiAgMHhmZjVkLAogICJicmFjZXJpZ2h0c21hbGwiLAogIDB4ZmU1YywKICAiYnJhY2VyaWdodHRwIiwKICAweGY4ZmMsCiAgImJyYWNlcmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTM4LAogICJicmFja2V0bGVmdCIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdGJ0IiwKICAweGY4ZjAsCiAgImJyYWNrZXRsZWZ0ZXgiLAogIDB4ZjhlZiwKICAiYnJhY2tldGxlZnRtb25vc3BhY2UiLAogIDB4ZmYzYiwKICAiYnJhY2tldGxlZnR0cCIsCiAgMHhmOGVlLAogICJicmFja2V0cmlnaHQiLAogIDB4MDA1ZCwKICAiYnJhY2tldHJpZ2h0YnQiLAogIDB4ZjhmYiwKICAiYnJhY2tldHJpZ2h0ZXgiLAogIDB4ZjhmYSwKICAiYnJhY2tldHJpZ2h0bW9ub3NwYWNlIiwKICAweGZmM2QsCiAgImJyYWNrZXRyaWdodHRwIiwKICAweGY4ZjksCiAgImJyZXZlIiwKICAweDAyZDgsCiAgImJyZXZlYmVsb3djbWIiLAogIDB4MDMyZSwKICAiYnJldmVjbWIiLAogIDB4MDMwNiwKICAiYnJldmVpbnZlcnRlZGJlbG93Y21iIiwKICAweDAzMmYsCiAgImJyZXZlaW52ZXJ0ZWRjbWIiLAogIDB4MDMxMSwKICAiYnJldmVpbnZlcnRlZGRvdWJsZWNtYiIsCiAgMHgwMzYxLAogICJicmlkZ2ViZWxvd2NtYiIsCiAgMHgwMzJhLAogICJicmlkZ2VpbnZlcnRlZGJlbG93Y21iIiwKICAweDAzM2EsCiAgImJyb2tlbmJhciIsCiAgMHgwMGE2LAogICJic3Ryb2tlIiwKICAweDAxODAsCiAgImJzdXBlcmlvciIsCiAgMHhmNmVhLAogICJidG9wYmFyIiwKICAweDAxODMsCiAgImJ1aGlyYWdhbmEiLAogIDB4MzA3NiwKICAiYnVrYXRha2FuYSIsCiAgMHgzMGQ2LAogICJidWxsZXQiLAogIDB4MjAyMiwKICAiYnVsbGV0aW52ZXJzZSIsCiAgMHgyNWQ4LAogICJidWxsZXRvcGVyYXRvciIsCiAgMHgyMjE5LAogICJidWxsc2V5ZSIsCiAgMHgyNWNlLAogICJjIiwKICAweDAwNjMsCiAgImNhYXJtZW5pYW4iLAogIDB4MDU2ZSwKICAiY2FiZW5nYWxpIiwKICAweDA5OWEsCiAgImNhY3V0ZSIsCiAgMHgwMTA3LAogICJjYWRldmEiLAogIDB4MDkxYSwKICAiY2FndWphcmF0aSIsCiAgMHgwYTlhLAogICJjYWd1cm11a2hpIiwKICAweDBhMWEsCiAgImNhbHNxdWFyZSIsCiAgMHgzMzg4LAogICJjYW5kcmFiaW5kdWJlbmdhbGkiLAogIDB4MDk4MSwKICAiY2FuZHJhYmluZHVjbWIiLAogIDB4MDMxMCwKICAiY2FuZHJhYmluZHVkZXZhIiwKICAweDA5MDEsCiAgImNhbmRyYWJpbmR1Z3VqYXJhdGkiLAogIDB4MGE4MSwKICAiY2Fwc2xvY2siLAogIDB4MjFlYSwKICAiY2FyZW9mIiwKICAweDIxMDUsCiAgImNhcm9uIiwKICAweDAyYzcsCiAgImNhcm9uYmVsb3djbWIiLAogIDB4MDMyYywKICAiY2Fyb25jbWIiLAogIDB4MDMwYywKICAiY2FycmlhZ2VyZXR1cm4iLAogIDB4MjFiNSwKICAiY2JvcG9tb2ZvIiwKICAweDMxMTgsCiAgImNjYXJvbiIsCiAgMHgwMTBkLAogICJjY2VkaWxsYSIsCiAgMHgwMGU3LAogICJjY2VkaWxsYWFjdXRlIiwKICAweDFlMDksCiAgImNjaXJjbGUiLAogIDB4MjRkMiwKICAiY2NpcmN1bWZsZXgiLAogIDB4MDEwOSwKICAiY2N1cmwiLAogIDB4MDI1NSwKICAiY2RvdCIsCiAgMHgwMTBiLAogICJjZG90YWNjZW50IiwKICAweDAxMGIsCiAgImNkc3F1YXJlIiwKICAweDMzYzUsCiAgImNlZGlsbGEiLAogIDB4MDBiOCwKICAiY2VkaWxsYWNtYiIsCiAgMHgwMzI3LAogICJjZW50IiwKICAweDAwYTIsCiAgImNlbnRpZ3JhZGUiLAogIDB4MjEwMywKICAiY2VudGluZmVyaW9yIiwKICAweGY2ZGYsCiAgImNlbnRtb25vc3BhY2UiLAogIDB4ZmZlMCwKICAiY2VudG9sZHN0eWxlIiwKICAweGY3YTIsCiAgImNlbnRzdXBlcmlvciIsCiAgMHhmNmUwLAogICJjaGFhcm1lbmlhbiIsCiAgMHgwNTc5LAogICJjaGFiZW5nYWxpIiwKICAweDA5OWIsCiAgImNoYWRldmEiLAogIDB4MDkxYiwKICAiY2hhZ3VqYXJhdGkiLAogIDB4MGE5YiwKICAiY2hhZ3VybXVraGkiLAogIDB4MGExYiwKICAiY2hib3BvbW9mbyIsCiAgMHgzMTE0LAogICJjaGVhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGJkLAogICJjaGVja21hcmsiLAogIDB4MjcxMywKICAiY2hlY3lyaWxsaWMiLAogIDB4MDQ0NywKICAiY2hlZGVzY2VuZGVyYWJraGFzaWFuY3lyaWxsaWMiLAogIDB4MDRiZiwKICAiY2hlZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDRiNywKICAiY2hlZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGY1LAogICJjaGVoYXJtZW5pYW4iLAogIDB4MDU3MywKICAiY2hla2hha2Fzc2lhbmN5cmlsbGljIiwKICAweDA0Y2MsCiAgImNoZXZlcnRpY2Fsc3Ryb2tlY3lyaWxsaWMiLAogIDB4MDRiOSwKICAiY2hpIiwKICAweDAzYzcsCiAgImNoaWV1Y2hhY2lyY2xla29yZWFuIiwKICAweDMyNzcsCiAgImNoaWV1Y2hhcGFyZW5rb3JlYW4iLAogIDB4MzIxNywKICAiY2hpZXVjaGNpcmNsZWtvcmVhbiIsCiAgMHgzMjY5LAogICJjaGlldWNoa29yZWFuIiwKICAweDMxNGEsCiAgImNoaWV1Y2hwYXJlbmtvcmVhbiIsCiAgMHgzMjA5LAogICJjaG9jaGFuZ3RoYWkiLAogIDB4MGUwYSwKICAiY2hvY2hhbnRoYWkiLAogIDB4MGUwOCwKICAiY2hvY2hpbmd0aGFpIiwKICAweDBlMDksCiAgImNob2Nob2V0aGFpIiwKICAweDBlMGMsCiAgImNob29rIiwKICAweDAxODgsCiAgImNpZXVjYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjc2LAogICJjaWV1Y2FwYXJlbmtvcmVhbiIsCiAgMHgzMjE2LAogICJjaWV1Y2NpcmNsZWtvcmVhbiIsCiAgMHgzMjY4LAogICJjaWV1Y2tvcmVhbiIsCiAgMHgzMTQ4LAogICJjaWV1Y3BhcmVua29yZWFuIiwKICAweDMyMDgsCiAgImNpZXVjdXBhcmVua29yZWFuIiwKICAweDMyMWMsCiAgImNpcmNsZSIsCiAgMHgyNWNiLAogICJjaXJjbGVjb3B5cnQiLAogIDB4MDBhOSwKICAiY2lyY2xlbXVsdGlwbHkiLAogIDB4MjI5NywKICAiY2lyY2xlb3QiLAogIDB4MjI5OSwKICAiY2lyY2xlcGx1cyIsCiAgMHgyMjk1LAogICJjaXJjbGVwb3N0YWxtYXJrIiwKICAweDMwMzYsCiAgImNpcmNsZXdpdGhsZWZ0aGFsZmJsYWNrIiwKICAweDI1ZDAsCiAgImNpcmNsZXdpdGhyaWdodGhhbGZibGFjayIsCiAgMHgyNWQxLAogICJjaXJjdW1mbGV4IiwKICAweDAyYzYsCiAgImNpcmN1bWZsZXhiZWxvd2NtYiIsCiAgMHgwMzJkLAogICJjaXJjdW1mbGV4Y21iIiwKICAweDAzMDIsCiAgImNsZWFyIiwKICAweDIzMjcsCiAgImNsaWNrYWx2ZW9sYXIiLAogIDB4MDFjMiwKICAiY2xpY2tkZW50YWwiLAogIDB4MDFjMCwKICAiY2xpY2tsYXRlcmFsIiwKICAweDAxYzEsCiAgImNsaWNrcmV0cm9mbGV4IiwKICAweDAxYzMsCiAgImNsdWIiLAogIDB4MjY2MywKICAiY2x1YnN1aXRibGFjayIsCiAgMHgyNjYzLAogICJjbHVic3VpdHdoaXRlIiwKICAweDI2NjcsCiAgImNtY3ViZWRzcXVhcmUiLAogIDB4MzNhNCwKICAiY21vbm9zcGFjZSIsCiAgMHhmZjQzLAogICJjbXNxdWFyZWRzcXVhcmUiLAogIDB4MzNhMCwKICAiY29hcm1lbmlhbiIsCiAgMHgwNTgxLAogICJjb2xvbiIsCiAgMHgwMDNhLAogICJjb2xvbm1vbmV0YXJ5IiwKICAweDIwYTEsCiAgImNvbG9ubW9ub3NwYWNlIiwKICAweGZmMWEsCiAgImNvbG9uc2lnbiIsCiAgMHgyMGExLAogICJjb2xvbnNtYWxsIiwKICAweGZlNTUsCiAgImNvbG9udHJpYW5ndWxhcmhhbGZtb2QiLAogIDB4MDJkMSwKICAiY29sb250cmlhbmd1bGFybW9kIiwKICAweDAyZDAsCiAgImNvbW1hIiwKICAweDAwMmMsCiAgImNvbW1hYWJvdmVjbWIiLAogIDB4MDMxMywKICAiY29tbWFhYm92ZXJpZ2h0Y21iIiwKICAweDAzMTUsCiAgImNvbW1hYWNjZW50IiwKICAweGY2YzMsCiAgImNvbW1hYXJhYmljIiwKICAweDA2MGMsCiAgImNvbW1hYXJtZW5pYW4iLAogIDB4MDU1ZCwKICAiY29tbWFpbmZlcmlvciIsCiAgMHhmNmUxLAogICJjb21tYW1vbm9zcGFjZSIsCiAgMHhmZjBjLAogICJjb21tYXJldmVyc2VkYWJvdmVjbWIiLAogIDB4MDMxNCwKICAiY29tbWFyZXZlcnNlZG1vZCIsCiAgMHgwMmJkLAogICJjb21tYXNtYWxsIiwKICAweGZlNTAsCiAgImNvbW1hc3VwZXJpb3IiLAogIDB4ZjZlMiwKICAiY29tbWF0dXJuZWRhYm92ZWNtYiIsCiAgMHgwMzEyLAogICJjb21tYXR1cm5lZG1vZCIsCiAgMHgwMmJiLAogICJjb21wYXNzIiwKICAweDI2M2MsCiAgImNvbmdydWVudCIsCiAgMHgyMjQ1LAogICJjb250b3VyaW50ZWdyYWwiLAogIDB4MjIyZSwKICAiY29udHJvbCIsCiAgMHgyMzAzLAogICJjb250cm9sQUNLIiwKICAweDAwMDYsCiAgImNvbnRyb2xCRUwiLAogIDB4MDAwNywKICAiY29udHJvbEJTIiwKICAweDAwMDgsCiAgImNvbnRyb2xDQU4iLAogIDB4MDAxOCwKICAiY29udHJvbENSIiwKICAweDAwMGQsCiAgImNvbnRyb2xEQzEiLAogIDB4MDAxMSwKICAiY29udHJvbERDMiIsCiAgMHgwMDEyLAogICJjb250cm9sREMzIiwKICAweDAwMTMsCiAgImNvbnRyb2xEQzQiLAogIDB4MDAxNCwKICAiY29udHJvbERFTCIsCiAgMHgwMDdmLAogICJjb250cm9sRExFIiwKICAweDAwMTAsCiAgImNvbnRyb2xFTSIsCiAgMHgwMDE5LAogICJjb250cm9sRU5RIiwKICAweDAwMDUsCiAgImNvbnRyb2xFT1QiLAogIDB4MDAwNCwKICAiY29udHJvbEVTQyIsCiAgMHgwMDFiLAogICJjb250cm9sRVRCIiwKICAweDAwMTcsCiAgImNvbnRyb2xFVFgiLAogIDB4MDAwMywKICAiY29udHJvbEZGIiwKICAweDAwMGMsCiAgImNvbnRyb2xGUyIsCiAgMHgwMDFjLAogICJjb250cm9sR1MiLAogIDB4MDAxZCwKICAiY29udHJvbEhUIiwKICAweDAwMDksCiAgImNvbnRyb2xMRiIsCiAgMHgwMDBhLAogICJjb250cm9sTkFLIiwKICAweDAwMTUsCiAgImNvbnRyb2xOVUxMIiwKICAweDAwMDAsCiAgImNvbnRyb2xSUyIsCiAgMHgwMDFlLAogICJjb250cm9sU0kiLAogIDB4MDAwZiwKICAiY29udHJvbFNPIiwKICAweDAwMGUsCiAgImNvbnRyb2xTT1QiLAogIDB4MDAwMiwKICAiY29udHJvbFNUWCIsCiAgMHgwMDAxLAogICJjb250cm9sU1VCIiwKICAweDAwMWEsCiAgImNvbnRyb2xTWU4iLAogIDB4MDAxNiwKICAiY29udHJvbFVTIiwKICAweDAwMWYsCiAgImNvbnRyb2xWVCIsCiAgMHgwMDBiLAogICJjb3B5cmlnaHQiLAogIDB4MDBhOSwKICAiY29weXJpZ2h0c2FucyIsCiAgMHhmOGU5LAogICJjb3B5cmlnaHRzZXJpZiIsCiAgMHhmNmQ5LAogICJjb3JuZXJicmFja2V0bGVmdCIsCiAgMHgzMDBjLAogICJjb3JuZXJicmFja2V0bGVmdGhhbGZ3aWR0aCIsCiAgMHhmZjYyLAogICJjb3JuZXJicmFja2V0bGVmdHZlcnRpY2FsIiwKICAweGZlNDEsCiAgImNvcm5lcmJyYWNrZXRyaWdodCIsCiAgMHgzMDBkLAogICJjb3JuZXJicmFja2V0cmlnaHRoYWxmd2lkdGgiLAogIDB4ZmY2MywKICAiY29ybmVyYnJhY2tldHJpZ2h0dmVydGljYWwiLAogIDB4ZmU0MiwKICAiY29ycG9yYXRpb25zcXVhcmUiLAogIDB4MzM3ZiwKICAiY29zcXVhcmUiLAogIDB4MzNjNywKICAiY292ZXJrZ3NxdWFyZSIsCiAgMHgzM2M2LAogICJjcGFyZW4iLAogIDB4MjQ5ZSwKICAiY3J1emVpcm8iLAogIDB4MjBhMiwKICAiY3N0cmV0Y2hlZCIsCiAgMHgwMjk3LAogICJjdXJseWFuZCIsCiAgMHgyMmNmLAogICJjdXJseW9yIiwKICAweDIyY2UsCiAgImN1cnJlbmN5IiwKICAweDAwYTQsCiAgImN5ckJyZXZlIiwKICAweGY2ZDEsCiAgImN5ckZsZXgiLAogIDB4ZjZkMiwKICAiY3lyYnJldmUiLAogIDB4ZjZkNCwKICAiY3lyZmxleCIsCiAgMHhmNmQ1LAogICJkIiwKICAweDAwNjQsCiAgImRhYXJtZW5pYW4iLAogIDB4MDU2NCwKICAiZGFiZW5nYWxpIiwKICAweDA5YTYsCiAgImRhZGFyYWJpYyIsCiAgMHgwNjM2LAogICJkYWRldmEiLAogIDB4MDkyNiwKICAiZGFkZmluYWxhcmFiaWMiLAogIDB4ZmViZSwKICAiZGFkaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWJmLAogICJkYWRtZWRpYWxhcmFiaWMiLAogIDB4ZmVjMCwKICAiZGFnZXNoIiwKICAweDA1YmMsCiAgImRhZ2VzaGhlYnJldyIsCiAgMHgwNWJjLAogICJkYWdnZXIiLAogIDB4MjAyMCwKICAiZGFnZ2VyZGJsIiwKICAweDIwMjEsCiAgImRhZ3VqYXJhdGkiLAogIDB4MGFhNiwKICAiZGFndXJtdWtoaSIsCiAgMHgwYTI2LAogICJkYWhpcmFnYW5hIiwKICAweDMwNjAsCiAgImRha2F0YWthbmEiLAogIDB4MzBjMCwKICAiZGFsYXJhYmljIiwKICAweDA2MmYsCiAgImRhbGV0IiwKICAweDA1ZDMsCiAgImRhbGV0ZGFnZXNoIiwKICAweGZiMzMsCiAgImRhbGV0ZGFnZXNoaGVicmV3IiwKICAweGZiMzMsCiAgImRhbGV0aGVicmV3IiwKICAweDA1ZDMsCiAgImRhbGZpbmFsYXJhYmljIiwKICAweGZlYWEsCiAgImRhbW1hYXJhYmljIiwKICAweDA2NGYsCiAgImRhbW1hbG93YXJhYmljIiwKICAweDA2NGYsCiAgImRhbW1hdGFuYWx0b25lYXJhYmljIiwKICAweDA2NGMsCiAgImRhbW1hdGFuYXJhYmljIiwKICAweDA2NGMsCiAgImRhbmRhIiwKICAweDA5NjQsCiAgImRhcmdhaGVicmV3IiwKICAweDA1YTcsCiAgImRhcmdhbGVmdGhlYnJldyIsCiAgMHgwNWE3LAogICJkYXNpYXBuZXVtYXRhY3lyaWxsaWNjbWIiLAogIDB4MDQ4NSwKICAiZGJsR3JhdmUiLAogIDB4ZjZkMywKICAiZGJsYW5nbGVicmFja2V0bGVmdCIsCiAgMHgzMDBhLAogICJkYmxhbmdsZWJyYWNrZXRsZWZ0dmVydGljYWwiLAogIDB4ZmUzZCwKICAiZGJsYW5nbGVicmFja2V0cmlnaHQiLAogIDB4MzAwYiwKICAiZGJsYW5nbGVicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTNlLAogICJkYmxhcmNoaW52ZXJ0ZWRiZWxvd2NtYiIsCiAgMHgwMzJiLAogICJkYmxhcnJvd2xlZnQiLAogIDB4MjFkNCwKICAiZGJsYXJyb3dyaWdodCIsCiAgMHgyMWQyLAogICJkYmxkYW5kYSIsCiAgMHgwOTY1LAogICJkYmxncmF2ZSIsCiAgMHhmNmQ2LAogICJkYmxncmF2ZWNtYiIsCiAgMHgwMzBmLAogICJkYmxpbnRlZ3JhbCIsCiAgMHgyMjJjLAogICJkYmxsb3dsaW5lIiwKICAweDIwMTcsCiAgImRibGxvd2xpbmVjbWIiLAogIDB4MDMzMywKICAiZGJsb3ZlcmxpbmVjbWIiLAogIDB4MDMzZiwKICAiZGJscHJpbWVtb2QiLAogIDB4MDJiYSwKICAiZGJsdmVydGljYWxiYXIiLAogIDB4MjAxNiwKICAiZGJsdmVydGljYWxsaW5lYWJvdmVjbWIiLAogIDB4MDMwZSwKICAiZGJvcG9tb2ZvIiwKICAweDMxMDksCiAgImRic3F1YXJlIiwKICAweDMzYzgsCiAgImRjYXJvbiIsCiAgMHgwMTBmLAogICJkY2VkaWxsYSIsCiAgMHgxZTExLAogICJkY2lyY2xlIiwKICAweDI0ZDMsCiAgImRjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUxMywKICAiZGNyb2F0IiwKICAweDAxMTEsCiAgImRkYWJlbmdhbGkiLAogIDB4MDlhMSwKICAiZGRhZGV2YSIsCiAgMHgwOTIxLAogICJkZGFndWphcmF0aSIsCiAgMHgwYWExLAogICJkZGFndXJtdWtoaSIsCiAgMHgwYTIxLAogICJkZGFsYXJhYmljIiwKICAweDA2ODgsCiAgImRkYWxmaW5hbGFyYWJpYyIsCiAgMHhmYjg5LAogICJkZGRoYWRldmEiLAogIDB4MDk1YywKICAiZGRoYWJlbmdhbGkiLAogIDB4MDlhMiwKICAiZGRoYWRldmEiLAogIDB4MDkyMiwKICAiZGRoYWd1amFyYXRpIiwKICAweDBhYTIsCiAgImRkaGFndXJtdWtoaSIsCiAgMHgwYTIyLAogICJkZG90YWNjZW50IiwKICAweDFlMGIsCiAgImRkb3RiZWxvdyIsCiAgMHgxZTBkLAogICJkZWNpbWFsc2VwYXJhdG9yYXJhYmljIiwKICAweDA2NmIsCiAgImRlY2ltYWxzZXBhcmF0b3JwZXJzaWFuIiwKICAweDA2NmIsCiAgImRlY3lyaWxsaWMiLAogIDB4MDQzNCwKICAiZGVncmVlIiwKICAweDAwYjAsCiAgImRlaGloZWJyZXciLAogIDB4MDVhZCwKICAiZGVoaXJhZ2FuYSIsCiAgMHgzMDY3LAogICJkZWljb3B0aWMiLAogIDB4MDNlZiwKICAiZGVrYXRha2FuYSIsCiAgMHgzMGM3LAogICJkZWxldGVsZWZ0IiwKICAweDIzMmIsCiAgImRlbGV0ZXJpZ2h0IiwKICAweDIzMjYsCiAgImRlbHRhIiwKICAweDAzYjQsCiAgImRlbHRhdHVybmVkIiwKICAweDAxOGQsCiAgImRlbm9taW5hdG9ybWludXNvbmVudW1lcmF0b3JiZW5nYWxpIiwKICAweDA5ZjgsCiAgImRlemgiLAogIDB4MDJhNCwKICAiZGhhYmVuZ2FsaSIsCiAgMHgwOWE3LAogICJkaGFkZXZhIiwKICAweDA5MjcsCiAgImRoYWd1amFyYXRpIiwKICAweDBhYTcsCiAgImRoYWd1cm11a2hpIiwKICAweDBhMjcsCiAgImRob29rIiwKICAweDAyNTcsCiAgImRpYWx5dGlrYXRvbm9zIiwKICAweDAzODUsCiAgImRpYWx5dGlrYXRvbm9zY21iIiwKICAweDAzNDQsCiAgImRpYW1vbmQiLAogIDB4MjY2NiwKICAiZGlhbW9uZHN1aXR3aGl0ZSIsCiAgMHgyNjYyLAogICJkaWVyZXNpcyIsCiAgMHgwMGE4LAogICJkaWVyZXNpc2FjdXRlIiwKICAweGY2ZDcsCiAgImRpZXJlc2lzYmVsb3djbWIiLAogIDB4MDMyNCwKICAiZGllcmVzaXNjbWIiLAogIDB4MDMwOCwKICAiZGllcmVzaXNncmF2ZSIsCiAgMHhmNmQ4LAogICJkaWVyZXNpc3Rvbm9zIiwKICAweDAzODUsCiAgImRpaGlyYWdhbmEiLAogIDB4MzA2MiwKICAiZGlrYXRha2FuYSIsCiAgMHgzMGMyLAogICJkaXR0b21hcmsiLAogIDB4MzAwMywKICAiZGl2aWRlIiwKICAweDAwZjcsCiAgImRpdmlkZXMiLAogIDB4MjIyMywKICAiZGl2aXNpb25zbGFzaCIsCiAgMHgyMjE1LAogICJkamVjeXJpbGxpYyIsCiAgMHgwNDUyLAogICJka3NoYWRlIiwKICAweDI1OTMsCiAgImRsaW5lYmVsb3ciLAogIDB4MWUwZiwKICAiZGxzcXVhcmUiLAogIDB4MzM5NywKICAiZG1hY3JvbiIsCiAgMHgwMTExLAogICJkbW9ub3NwYWNlIiwKICAweGZmNDQsCiAgImRuYmxvY2siLAogIDB4MjU4NCwKICAiZG9jaGFkYXRoYWkiLAogIDB4MGUwZSwKICAiZG9kZWt0aGFpIiwKICAweDBlMTQsCiAgImRvaGlyYWdhbmEiLAogIDB4MzA2OSwKICAiZG9rYXRha2FuYSIsCiAgMHgzMGM5LAogICJkb2xsYXIiLAogIDB4MDAyNCwKICAiZG9sbGFyaW5mZXJpb3IiLAogIDB4ZjZlMywKICAiZG9sbGFybW9ub3NwYWNlIiwKICAweGZmMDQsCiAgImRvbGxhcm9sZHN0eWxlIiwKICAweGY3MjQsCiAgImRvbGxhcnNtYWxsIiwKICAweGZlNjksCiAgImRvbGxhcnN1cGVyaW9yIiwKICAweGY2ZTQsCiAgImRvbmciLAogIDB4MjBhYiwKICAiZG9ydXNxdWFyZSIsCiAgMHgzMzI2LAogICJkb3RhY2NlbnQiLAogIDB4MDJkOSwKICAiZG90YWNjZW50Y21iIiwKICAweDAzMDcsCiAgImRvdGJlbG93Y21iIiwKICAweDAzMjMsCiAgImRvdGJlbG93Y29tYiIsCiAgMHgwMzIzLAogICJkb3RrYXRha2FuYSIsCiAgMHgzMGZiLAogICJkb3RsZXNzaSIsCiAgMHgwMTMxLAogICJkb3RsZXNzaiIsCiAgMHhmNmJlLAogICJkb3RsZXNzanN0cm9rZWhvb2siLAogIDB4MDI4NCwKICAiZG90bWF0aCIsCiAgMHgyMmM1LAogICJkb3R0ZWRjaXJjbGUiLAogIDB4MjVjYywKICAiZG91YmxleW9kcGF0YWgiLAogIDB4ZmIxZiwKICAiZG91YmxleW9kcGF0YWhoZWJyZXciLAogIDB4ZmIxZiwKICAiZG93bnRhY2tiZWxvd2NtYiIsCiAgMHgwMzFlLAogICJkb3dudGFja21vZCIsCiAgMHgwMmQ1LAogICJkcGFyZW4iLAogIDB4MjQ5ZiwKICAiZHN1cGVyaW9yIiwKICAweGY2ZWIsCiAgImR0YWlsIiwKICAweDAyNTYsCiAgImR0b3BiYXIiLAogIDB4MDE4YywKICAiZHVoaXJhZ2FuYSIsCiAgMHgzMDY1LAogICJkdWthdGFrYW5hIiwKICAweDMwYzUsCiAgImR6IiwKICAweDAxZjMsCiAgImR6YWx0b25lIiwKICAweDAyYTMsCiAgImR6Y2Fyb24iLAogIDB4MDFjNiwKICAiZHpjdXJsIiwKICAweDAyYTUsCiAgImR6ZWFia2hhc2lhbmN5cmlsbGljIiwKICAweDA0ZTEsCiAgImR6ZWN5cmlsbGljIiwKICAweDA0NTUsCiAgImR6aGVjeXJpbGxpYyIsCiAgMHgwNDVmLAogICJlIiwKICAweDAwNjUsCiAgImVhY3V0ZSIsCiAgMHgwMGU5LAogICJlYXJ0aCIsCiAgMHgyNjQxLAogICJlYmVuZ2FsaSIsCiAgMHgwOThmLAogICJlYm9wb21vZm8iLAogIDB4MzExYywKICAiZWJyZXZlIiwKICAweDAxMTUsCiAgImVjYW5kcmFkZXZhIiwKICAweDA5MGQsCiAgImVjYW5kcmFndWphcmF0aSIsCiAgMHgwYThkLAogICJlY2FuZHJhdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ1LAogICJlY2FuZHJhdm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjNSwKICAiZWNhcm9uIiwKICAweDAxMWIsCiAgImVjZWRpbGxhYnJldmUiLAogIDB4MWUxZCwKICAiZWNoYXJtZW5pYW4iLAogIDB4MDU2NSwKICAiZWNoeWl3bmFybWVuaWFuIiwKICAweDA1ODcsCiAgImVjaXJjbGUiLAogIDB4MjRkNCwKICAiZWNpcmN1bWZsZXgiLAogIDB4MDBlYSwKICAiZWNpcmN1bWZsZXhhY3V0ZSIsCiAgMHgxZWJmLAogICJlY2lyY3VtZmxleGJlbG93IiwKICAweDFlMTksCiAgImVjaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVjNywKICAiZWNpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWMxLAogICJlY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWMzLAogICJlY2lyY3VtZmxleHRpbGRlIiwKICAweDFlYzUsCiAgImVjeXJpbGxpYyIsCiAgMHgwNDU0LAogICJlZGJsZ3JhdmUiLAogIDB4MDIwNSwKICAiZWRldmEiLAogIDB4MDkwZiwKICAiZWRpZXJlc2lzIiwKICAweDAwZWIsCiAgImVkb3QiLAogIDB4MDExNywKICAiZWRvdGFjY2VudCIsCiAgMHgwMTE3LAogICJlZG90YmVsb3ciLAogIDB4MWViOSwKICAiZWVndXJtdWtoaSIsCiAgMHgwYTBmLAogICJlZW1hdHJhZ3VybXVraGkiLAogIDB4MGE0NywKICAiZWZjeXJpbGxpYyIsCiAgMHgwNDQ0LAogICJlZ3JhdmUiLAogIDB4MDBlOCwKICAiZWd1amFyYXRpIiwKICAweDBhOGYsCiAgImVoYXJtZW5pYW4iLAogIDB4MDU2NywKICAiZWhib3BvbW9mbyIsCiAgMHgzMTFkLAogICJlaGlyYWdhbmEiLAogIDB4MzA0OCwKICAiZWhvb2thYm92ZSIsCiAgMHgxZWJiLAogICJlaWJvcG9tb2ZvIiwKICAweDMxMWYsCiAgImVpZ2h0IiwKICAweDAwMzgsCiAgImVpZ2h0YXJhYmljIiwKICAweDA2NjgsCiAgImVpZ2h0YmVuZ2FsaSIsCiAgMHgwOWVlLAogICJlaWdodGNpcmNsZSIsCiAgMHgyNDY3LAogICJlaWdodGNpcmNsZWludmVyc2VzYW5zc2VyaWYiLAogIDB4Mjc5MSwKICAiZWlnaHRkZXZhIiwKICAweDA5NmUsCiAgImVpZ2h0ZWVuY2lyY2xlIiwKICAweDI0NzEsCiAgImVpZ2h0ZWVucGFyZW4iLAogIDB4MjQ4NSwKICAiZWlnaHRlZW5wZXJpb2QiLAogIDB4MjQ5OSwKICAiZWlnaHRndWphcmF0aSIsCiAgMHgwYWVlLAogICJlaWdodGd1cm11a2hpIiwKICAweDBhNmUsCiAgImVpZ2h0aGFja2FyYWJpYyIsCiAgMHgwNjY4LAogICJlaWdodGhhbmd6aG91IiwKICAweDMwMjgsCiAgImVpZ2h0aG5vdGViZWFtZWQiLAogIDB4MjY2YiwKICAiZWlnaHRpZGVvZ3JhcGhpY3BhcmVuIiwKICAweDMyMjcsCiAgImVpZ2h0aW5mZXJpb3IiLAogIDB4MjA4OCwKICAiZWlnaHRtb25vc3BhY2UiLAogIDB4ZmYxOCwKICAiZWlnaHRvbGRzdHlsZSIsCiAgMHhmNzM4LAogICJlaWdodHBhcmVuIiwKICAweDI0N2IsCiAgImVpZ2h0cGVyaW9kIiwKICAweDI0OGYsCiAgImVpZ2h0cGVyc2lhbiIsCiAgMHgwNmY4LAogICJlaWdodHJvbWFuIiwKICAweDIxNzcsCiAgImVpZ2h0c3VwZXJpb3IiLAogIDB4MjA3OCwKICAiZWlnaHR0aGFpIiwKICAweDBlNTgsCiAgImVpbnZlcnRlZGJyZXZlIiwKICAweDAyMDcsCiAgImVpb3RpZmllZGN5cmlsbGljIiwKICAweDA0NjUsCiAgImVrYXRha2FuYSIsCiAgMHgzMGE4LAogICJla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NCwKICAiZWtvbmthcmd1cm11a2hpIiwKICAweDBhNzQsCiAgImVrb3JlYW4iLAogIDB4MzE1NCwKICAiZWxjeXJpbGxpYyIsCiAgMHgwNDNiLAogICJlbGVtZW50IiwKICAweDIyMDgsCiAgImVsZXZlbmNpcmNsZSIsCiAgMHgyNDZhLAogICJlbGV2ZW5wYXJlbiIsCiAgMHgyNDdlLAogICJlbGV2ZW5wZXJpb2QiLAogIDB4MjQ5MiwKICAiZWxldmVucm9tYW4iLAogIDB4MjE3YSwKICAiZWxsaXBzaXMiLAogIDB4MjAyNiwKICAiZWxsaXBzaXN2ZXJ0aWNhbCIsCiAgMHgyMmVlLAogICJlbWFjcm9uIiwKICAweDAxMTMsCiAgImVtYWNyb25hY3V0ZSIsCiAgMHgxZTE3LAogICJlbWFjcm9uZ3JhdmUiLAogIDB4MWUxNSwKICAiZW1jeXJpbGxpYyIsCiAgMHgwNDNjLAogICJlbWRhc2giLAogIDB4MjAxNCwKICAiZW1kYXNodmVydGljYWwiLAogIDB4ZmUzMSwKICAiZW1vbm9zcGFjZSIsCiAgMHhmZjQ1LAogICJlbXBoYXNpc21hcmthcm1lbmlhbiIsCiAgMHgwNTViLAogICJlbXB0eXNldCIsCiAgMHgyMjA1LAogICJlbmJvcG9tb2ZvIiwKICAweDMxMjMsCiAgImVuY3lyaWxsaWMiLAogIDB4MDQzZCwKICAiZW5kYXNoIiwKICAweDIwMTMsCiAgImVuZGFzaHZlcnRpY2FsIiwKICAweGZlMzIsCiAgImVuZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDRhMywKICAiZW5nIiwKICAweDAxNGIsCiAgImVuZ2JvcG9tb2ZvIiwKICAweDMxMjUsCiAgImVuZ2hlY3lyaWxsaWMiLAogIDB4MDRhNSwKICAiZW5ob29rY3lyaWxsaWMiLAogIDB4MDRjOCwKICAiZW5zcGFjZSIsCiAgMHgyMDAyLAogICJlb2dvbmVrIiwKICAweDAxMTksCiAgImVva29yZWFuIiwKICAweDMxNTMsCiAgImVvcGVuIiwKICAweDAyNWIsCiAgImVvcGVuY2xvc2VkIiwKICAweDAyOWEsCiAgImVvcGVucmV2ZXJzZWQiLAogIDB4MDI1YywKICAiZW9wZW5yZXZlcnNlZGNsb3NlZCIsCiAgMHgwMjVlLAogICJlb3BlbnJldmVyc2VkaG9vayIsCiAgMHgwMjVkLAogICJlcGFyZW4iLAogIDB4MjRhMCwKICAiZXBzaWxvbiIsCiAgMHgwM2I1LAogICJlcHNpbG9udG9ub3MiLAogIDB4MDNhZCwKICAiZXF1YWwiLAogIDB4MDAzZCwKICAiZXF1YWxtb25vc3BhY2UiLAogIDB4ZmYxZCwKICAiZXF1YWxzbWFsbCIsCiAgMHhmZTY2LAogICJlcXVhbHN1cGVyaW9yIiwKICAweDIwN2MsCiAgImVxdWl2YWxlbmNlIiwKICAweDIyNjEsCiAgImVyYm9wb21vZm8iLAogIDB4MzEyNiwKICAiZXJjeXJpbGxpYyIsCiAgMHgwNDQwLAogICJlcmV2ZXJzZWQiLAogIDB4MDI1OCwKICAiZXJldmVyc2VkY3lyaWxsaWMiLAogIDB4MDQ0ZCwKICAiZXNjeXJpbGxpYyIsCiAgMHgwNDQxLAogICJlc2Rlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YWIsCiAgImVzaCIsCiAgMHgwMjgzLAogICJlc2hjdXJsIiwKICAweDAyODYsCiAgImVzaG9ydGRldmEiLAogIDB4MDkwZSwKICAiZXNob3J0dm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ2LAogICJlc2hyZXZlcnNlZGxvb3AiLAogIDB4MDFhYSwKICAiZXNoc3F1YXRyZXZlcnNlZCIsCiAgMHgwMjg1LAogICJlc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDQ3LAogICJlc21hbGxrYXRha2FuYSIsCiAgMHgzMGE3LAogICJlc21hbGxrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjZhLAogICJlc3RpbWF0ZWQiLAogIDB4MjEyZSwKICAiZXN1cGVyaW9yIiwKICAweGY2ZWMsCiAgImV0YSIsCiAgMHgwM2I3LAogICJldGFybWVuaWFuIiwKICAweDA1NjgsCiAgImV0YXRvbm9zIiwKICAweDAzYWUsCiAgImV0aCIsCiAgMHgwMGYwLAogICJldGlsZGUiLAogIDB4MWViZCwKICAiZXRpbGRlYmVsb3ciLAogIDB4MWUxYiwKICAiZXRuYWh0YWZvdWtoaGVicmV3IiwKICAweDA1OTEsCiAgImV0bmFodGFmb3VraGxlZnRoZWJyZXciLAogIDB4MDU5MSwKICAiZXRuYWh0YWhlYnJldyIsCiAgMHgwNTkxLAogICJldG5haHRhbGVmdGhlYnJldyIsCiAgMHgwNTkxLAogICJldHVybmVkIiwKICAweDAxZGQsCiAgImV1a29yZWFuIiwKICAweDMxNjEsCiAgImV1cm8iLAogIDB4MjBhYywKICAiZXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljNywKICAiZXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0NywKICAiZXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzcsCiAgImV4Y2xhbSIsCiAgMHgwMDIxLAogICJleGNsYW1hcm1lbmlhbiIsCiAgMHgwNTVjLAogICJleGNsYW1kYmwiLAogIDB4MjAzYywKICAiZXhjbGFtZG93biIsCiAgMHgwMGExLAogICJleGNsYW1kb3duc21hbGwiLAogIDB4ZjdhMSwKICAiZXhjbGFtbW9ub3NwYWNlIiwKICAweGZmMDEsCiAgImV4Y2xhbXNtYWxsIiwKICAweGY3MjEsCiAgImV4aXN0ZW50aWFsIiwKICAweDIyMDMsCiAgImV6aCIsCiAgMHgwMjkyLAogICJlemhjYXJvbiIsCiAgMHgwMWVmLAogICJlemhjdXJsIiwKICAweDAyOTMsCiAgImV6aHJldmVyc2VkIiwKICAweDAxYjksCiAgImV6aHRhaWwiLAogIDB4MDFiYSwKICAiZiIsCiAgMHgwMDY2LAogICJmYWRldmEiLAogIDB4MDk1ZSwKICAiZmFndXJtdWtoaSIsCiAgMHgwYTVlLAogICJmYWhyZW5oZWl0IiwKICAweDIxMDksCiAgImZhdGhhYXJhYmljIiwKICAweDA2NGUsCiAgImZhdGhhbG93YXJhYmljIiwKICAweDA2NGUsCiAgImZhdGhhdGFuYXJhYmljIiwKICAweDA2NGIsCiAgImZib3BvbW9mbyIsCiAgMHgzMTA4LAogICJmY2lyY2xlIiwKICAweDI0ZDUsCiAgImZkb3RhY2NlbnQiLAogIDB4MWUxZiwKICAiZmVoYXJhYmljIiwKICAweDA2NDEsCiAgImZlaGFybWVuaWFuIiwKICAweDA1ODYsCiAgImZlaGZpbmFsYXJhYmljIiwKICAweGZlZDIsCiAgImZlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVkMywKICAiZmVobWVkaWFsYXJhYmljIiwKICAweGZlZDQsCiAgImZlaWNvcHRpYyIsCiAgMHgwM2U1LAogICJmZW1hbGUiLAogIDB4MjY0MCwKICAiZmYiLAogIDB4ZmIwMCwKICAiZl9mIiwKICAweGZiMDAsCiAgImZmaSIsCiAgMHhmYjAzLAogICJmZmwiLAogIDB4ZmIwNCwKICAiZmkiLAogIDB4ZmIwMSwKICAiZmlmdGVlbmNpcmNsZSIsCiAgMHgyNDZlLAogICJmaWZ0ZWVucGFyZW4iLAogIDB4MjQ4MiwKICAiZmlmdGVlbnBlcmlvZCIsCiAgMHgyNDk2LAogICJmaWd1cmVkYXNoIiwKICAweDIwMTIsCiAgImZpbGxlZGJveCIsCiAgMHgyNWEwLAogICJmaWxsZWRyZWN0IiwKICAweDI1YWMsCiAgImZpbmFsa2FmIiwKICAweDA1ZGEsCiAgImZpbmFsa2FmZGFnZXNoIiwKICAweGZiM2EsCiAgImZpbmFsa2FmZGFnZXNoaGVicmV3IiwKICAweGZiM2EsCiAgImZpbmFsa2FmaGVicmV3IiwKICAweDA1ZGEsCiAgImZpbmFsbWVtIiwKICAweDA1ZGQsCiAgImZpbmFsbWVtaGVicmV3IiwKICAweDA1ZGQsCiAgImZpbmFsbnVuIiwKICAweDA1ZGYsCiAgImZpbmFsbnVuaGVicmV3IiwKICAweDA1ZGYsCiAgImZpbmFscGUiLAogIDB4MDVlMywKICAiZmluYWxwZWhlYnJldyIsCiAgMHgwNWUzLAogICJmaW5hbHRzYWRpIiwKICAweDA1ZTUsCiAgImZpbmFsdHNhZGloZWJyZXciLAogIDB4MDVlNSwKICAiZmlyc3R0b25lY2hpbmVzZSIsCiAgMHgwMmM5LAogICJmaXNoZXllIiwKICAweDI1YzksCiAgImZpdGFjeXJpbGxpYyIsCiAgMHgwNDczLAogICJmaXZlIiwKICAweDAwMzUsCiAgImZpdmVhcmFiaWMiLAogIDB4MDY2NSwKICAiZml2ZWJlbmdhbGkiLAogIDB4MDllYiwKICAiZml2ZWNpcmNsZSIsCiAgMHgyNDY0LAogICJmaXZlY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhlLAogICJmaXZlZGV2YSIsCiAgMHgwOTZiLAogICJmaXZlZWlnaHRocyIsCiAgMHgyMTVkLAogICJmaXZlZ3VqYXJhdGkiLAogIDB4MGFlYiwKICAiZml2ZWd1cm11a2hpIiwKICAweDBhNmIsCiAgImZpdmVoYWNrYXJhYmljIiwKICAweDA2NjUsCiAgImZpdmVoYW5nemhvdSIsCiAgMHgzMDI1LAogICJmaXZlaWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI0LAogICJmaXZlaW5mZXJpb3IiLAogIDB4MjA4NSwKICAiZml2ZW1vbm9zcGFjZSIsCiAgMHhmZjE1LAogICJmaXZlb2xkc3R5bGUiLAogIDB4ZjczNSwKICAiZml2ZXBhcmVuIiwKICAweDI0NzgsCiAgImZpdmVwZXJpb2QiLAogIDB4MjQ4YywKICAiZml2ZXBlcnNpYW4iLAogIDB4MDZmNSwKICAiZml2ZXJvbWFuIiwKICAweDIxNzQsCiAgImZpdmVzdXBlcmlvciIsCiAgMHgyMDc1LAogICJmaXZldGhhaSIsCiAgMHgwZTU1LAogICJmbCIsCiAgMHhmYjAyLAogICJmbG9yaW4iLAogIDB4MDE5MiwKICAiZm1vbm9zcGFjZSIsCiAgMHhmZjQ2LAogICJmbXNxdWFyZSIsCiAgMHgzMzk5LAogICJmb2ZhbnRoYWkiLAogIDB4MGUxZiwKICAiZm9mYXRoYWkiLAogIDB4MGUxZCwKICAiZm9uZ21hbnRoYWkiLAogIDB4MGU0ZiwKICAiZm9yYWxsIiwKICAweDIyMDAsCiAgImZvdXIiLAogIDB4MDAzNCwKICAiZm91cmFyYWJpYyIsCiAgMHgwNjY0LAogICJmb3VyYmVuZ2FsaSIsCiAgMHgwOWVhLAogICJmb3VyY2lyY2xlIiwKICAweDI0NjMsCiAgImZvdXJjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OGQsCiAgImZvdXJkZXZhIiwKICAweDA5NmEsCiAgImZvdXJndWphcmF0aSIsCiAgMHgwYWVhLAogICJmb3VyZ3VybXVraGkiLAogIDB4MGE2YSwKICAiZm91cmhhY2thcmFiaWMiLAogIDB4MDY2NCwKICAiZm91cmhhbmd6aG91IiwKICAweDMwMjQsCiAgImZvdXJpZGVvZ3JhcGhpY3BhcmVuIiwKICAweDMyMjMsCiAgImZvdXJpbmZlcmlvciIsCiAgMHgyMDg0LAogICJmb3VybW9ub3NwYWNlIiwKICAweGZmMTQsCiAgImZvdXJudW1lcmF0b3JiZW5nYWxpIiwKICAweDA5ZjcsCiAgImZvdXJvbGRzdHlsZSIsCiAgMHhmNzM0LAogICJmb3VycGFyZW4iLAogIDB4MjQ3NywKICAiZm91cnBlcmlvZCIsCiAgMHgyNDhiLAogICJmb3VycGVyc2lhbiIsCiAgMHgwNmY0LAogICJmb3Vycm9tYW4iLAogIDB4MjE3MywKICAiZm91cnN1cGVyaW9yIiwKICAweDIwNzQsCiAgImZvdXJ0ZWVuY2lyY2xlIiwKICAweDI0NmQsCiAgImZvdXJ0ZWVucGFyZW4iLAogIDB4MjQ4MSwKICAiZm91cnRlZW5wZXJpb2QiLAogIDB4MjQ5NSwKICAiZm91cnRoYWkiLAogIDB4MGU1NCwKICAiZm91cnRodG9uZWNoaW5lc2UiLAogIDB4MDJjYiwKICAiZnBhcmVuIiwKICAweDI0YTEsCiAgImZyYWN0aW9uIiwKICAweDIwNDQsCiAgImZyYW5jIiwKICAweDIwYTMsCiAgImciLAogIDB4MDA2NywKICAiZ2FiZW5nYWxpIiwKICAweDA5OTcsCiAgImdhY3V0ZSIsCiAgMHgwMWY1LAogICJnYWRldmEiLAogIDB4MDkxNywKICAiZ2FmYXJhYmljIiwKICAweDA2YWYsCiAgImdhZmZpbmFsYXJhYmljIiwKICAweGZiOTMsCiAgImdhZmluaXRpYWxhcmFiaWMiLAogIDB4ZmI5NCwKICAiZ2FmbWVkaWFsYXJhYmljIiwKICAweGZiOTUsCiAgImdhZ3VqYXJhdGkiLAogIDB4MGE5NywKICAiZ2FndXJtdWtoaSIsCiAgMHgwYTE3LAogICJnYWhpcmFnYW5hIiwKICAweDMwNGMsCiAgImdha2F0YWthbmEiLAogIDB4MzBhYywKICAiZ2FtbWEiLAogIDB4MDNiMywKICAiZ2FtbWFsYXRpbnNtYWxsIiwKICAweDAyNjMsCiAgImdhbW1hc3VwZXJpb3IiLAogIDB4MDJlMCwKICAiZ2FuZ2lhY29wdGljIiwKICAweDAzZWIsCiAgImdib3BvbW9mbyIsCiAgMHgzMTBkLAogICJnYnJldmUiLAogIDB4MDExZiwKICAiZ2Nhcm9uIiwKICAweDAxZTcsCiAgImdjZWRpbGxhIiwKICAweDAxMjMsCiAgImdjaXJjbGUiLAogIDB4MjRkNiwKICAiZ2NpcmN1bWZsZXgiLAogIDB4MDExZCwKICAiZ2NvbW1hYWNjZW50IiwKICAweDAxMjMsCiAgImdkb3QiLAogIDB4MDEyMSwKICAiZ2RvdGFjY2VudCIsCiAgMHgwMTIxLAogICJnZWN5cmlsbGljIiwKICAweDA0MzMsCiAgImdlaGlyYWdhbmEiLAogIDB4MzA1MiwKICAiZ2VrYXRha2FuYSIsCiAgMHgzMGIyLAogICJnZW9tZXRyaWNhbGx5ZXF1YWwiLAogIDB4MjI1MSwKICAiZ2VyZXNoYWNjZW50aGVicmV3IiwKICAweDA1OWMsCiAgImdlcmVzaGhlYnJldyIsCiAgMHgwNWYzLAogICJnZXJlc2htdXFkYW1oZWJyZXciLAogIDB4MDU5ZCwKICAiZ2VybWFuZGJscyIsCiAgMHgwMGRmLAogICJnZXJzaGF5aW1hY2NlbnRoZWJyZXciLAogIDB4MDU5ZSwKICAiZ2Vyc2hheWltaGVicmV3IiwKICAweDA1ZjQsCiAgImdldGFtYXJrIiwKICAweDMwMTMsCiAgImdoYWJlbmdhbGkiLAogIDB4MDk5OCwKICAiZ2hhZGFybWVuaWFuIiwKICAweDA1NzIsCiAgImdoYWRldmEiLAogIDB4MDkxOCwKICAiZ2hhZ3VqYXJhdGkiLAogIDB4MGE5OCwKICAiZ2hhZ3VybXVraGkiLAogIDB4MGExOCwKICAiZ2hhaW5hcmFiaWMiLAogIDB4MDYzYSwKICAiZ2hhaW5maW5hbGFyYWJpYyIsCiAgMHhmZWNlLAogICJnaGFpbmluaXRpYWxhcmFiaWMiLAogIDB4ZmVjZiwKICAiZ2hhaW5tZWRpYWxhcmFiaWMiLAogIDB4ZmVkMCwKICAiZ2hlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0OTUsCiAgImdoZXN0cm9rZWN5cmlsbGljIiwKICAweDA0OTMsCiAgImdoZXVwdHVybmN5cmlsbGljIiwKICAweDA0OTEsCiAgImdoaGFkZXZhIiwKICAweDA5NWEsCiAgImdoaGFndXJtdWtoaSIsCiAgMHgwYTVhLAogICJnaG9vayIsCiAgMHgwMjYwLAogICJnaHpzcXVhcmUiLAogIDB4MzM5MywKICAiZ2loaXJhZ2FuYSIsCiAgMHgzMDRlLAogICJnaWthdGFrYW5hIiwKICAweDMwYWUsCiAgImdpbWFybWVuaWFuIiwKICAweDA1NjMsCiAgImdpbWVsIiwKICAweDA1ZDIsCiAgImdpbWVsZGFnZXNoIiwKICAweGZiMzIsCiAgImdpbWVsZGFnZXNoaGVicmV3IiwKICAweGZiMzIsCiAgImdpbWVsaGVicmV3IiwKICAweDA1ZDIsCiAgImdqZWN5cmlsbGljIiwKICAweDA0NTMsCiAgImdsb3R0YWxpbnZlcnRlZHN0cm9rZSIsCiAgMHgwMWJlLAogICJnbG90dGFsc3RvcCIsCiAgMHgwMjk0LAogICJnbG90dGFsc3RvcGludmVydGVkIiwKICAweDAyOTYsCiAgImdsb3R0YWxzdG9wbW9kIiwKICAweDAyYzAsCiAgImdsb3R0YWxzdG9wcmV2ZXJzZWQiLAogIDB4MDI5NSwKICAiZ2xvdHRhbHN0b3ByZXZlcnNlZG1vZCIsCiAgMHgwMmMxLAogICJnbG90dGFsc3RvcHJldmVyc2Vkc3VwZXJpb3IiLAogIDB4MDJlNCwKICAiZ2xvdHRhbHN0b3BzdHJva2UiLAogIDB4MDJhMSwKICAiZ2xvdHRhbHN0b3BzdHJva2VyZXZlcnNlZCIsCiAgMHgwMmEyLAogICJnbWFjcm9uIiwKICAweDFlMjEsCiAgImdtb25vc3BhY2UiLAogIDB4ZmY0NywKICAiZ29oaXJhZ2FuYSIsCiAgMHgzMDU0LAogICJnb2thdGFrYW5hIiwKICAweDMwYjQsCiAgImdwYXJlbiIsCiAgMHgyNGEyLAogICJncGFzcXVhcmUiLAogIDB4MzNhYywKICAiZ3JhZGllbnQiLAogIDB4MjIwNywKICAiZ3JhdmUiLAogIDB4MDA2MCwKICAiZ3JhdmViZWxvd2NtYiIsCiAgMHgwMzE2LAogICJncmF2ZWNtYiIsCiAgMHgwMzAwLAogICJncmF2ZWNvbWIiLAogIDB4MDMwMCwKICAiZ3JhdmVkZXZhIiwKICAweDA5NTMsCiAgImdyYXZlbG93bW9kIiwKICAweDAyY2UsCiAgImdyYXZlbW9ub3NwYWNlIiwKICAweGZmNDAsCiAgImdyYXZldG9uZWNtYiIsCiAgMHgwMzQwLAogICJncmVhdGVyIiwKICAweDAwM2UsCiAgImdyZWF0ZXJlcXVhbCIsCiAgMHgyMjY1LAogICJncmVhdGVyZXF1YWxvcmxlc3MiLAogIDB4MjJkYiwKICAiZ3JlYXRlcm1vbm9zcGFjZSIsCiAgMHhmZjFlLAogICJncmVhdGVyb3JlcXVpdmFsZW50IiwKICAweDIyNzMsCiAgImdyZWF0ZXJvcmxlc3MiLAogIDB4MjI3NywKICAiZ3JlYXRlcm92ZXJlcXVhbCIsCiAgMHgyMjY3LAogICJncmVhdGVyc21hbGwiLAogIDB4ZmU2NSwKICAiZ3NjcmlwdCIsCiAgMHgwMjYxLAogICJnc3Ryb2tlIiwKICAweDAxZTUsCiAgImd1aGlyYWdhbmEiLAogIDB4MzA1MCwKICAiZ3VpbGxlbW90bGVmdCIsCiAgMHgwMGFiLAogICJndWlsbGVtb3RyaWdodCIsCiAgMHgwMGJiLAogICJndWlsc2luZ2xsZWZ0IiwKICAweDIwMzksCiAgImd1aWxzaW5nbHJpZ2h0IiwKICAweDIwM2EsCiAgImd1a2F0YWthbmEiLAogIDB4MzBiMCwKICAiZ3VyYW11c3F1YXJlIiwKICAweDMzMTgsCiAgImd5c3F1YXJlIiwKICAweDMzYzksCiAgImgiLAogIDB4MDA2OCwKICAiaGFhYmtoYXNpYW5jeXJpbGxpYyIsCiAgMHgwNGE5LAogICJoYWFsdG9uZWFyYWJpYyIsCiAgMHgwNmMxLAogICJoYWJlbmdhbGkiLAogIDB4MDliOSwKICAiaGFkZXNjZW5kZXJjeXJpbGxpYyIsCiAgMHgwNGIzLAogICJoYWRldmEiLAogIDB4MDkzOSwKICAiaGFndWphcmF0aSIsCiAgMHgwYWI5LAogICJoYWd1cm11a2hpIiwKICAweDBhMzksCiAgImhhaGFyYWJpYyIsCiAgMHgwNjJkLAogICJoYWhmaW5hbGFyYWJpYyIsCiAgMHhmZWEyLAogICJoYWhpbml0aWFsYXJhYmljIiwKICAweGZlYTMsCiAgImhhaGlyYWdhbmEiLAogIDB4MzA2ZiwKICAiaGFobWVkaWFsYXJhYmljIiwKICAweGZlYTQsCiAgImhhaXR1c3F1YXJlIiwKICAweDMzMmEsCiAgImhha2F0YWthbmEiLAogIDB4MzBjZiwKICAiaGFrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjhhLAogICJoYWxhbnRndXJtdWtoaSIsCiAgMHgwYTRkLAogICJoYW16YWFyYWJpYyIsCiAgMHgwNjIxLAogICJoYW16YWxvd2FyYWJpYyIsCiAgMHgwNjIxLAogICJoYW5ndWxmaWxsZXIiLAogIDB4MzE2NCwKICAiaGFyZHNpZ25jeXJpbGxpYyIsCiAgMHgwNDRhLAogICJoYXJwb29ubGVmdGJhcmJ1cCIsCiAgMHgyMWJjLAogICJoYXJwb29ucmlnaHRiYXJidXAiLAogIDB4MjFjMCwKICAiaGFzcXVhcmUiLAogIDB4MzNjYSwKICAiaGF0YWZwYXRhaCIsCiAgMHgwNWIyLAogICJoYXRhZnBhdGFoMTYiLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaDIzIiwKICAweDA1YjIsCiAgImhhdGFmcGF0YWgyZiIsCiAgMHgwNWIyLAogICJoYXRhZnBhdGFoaGVicmV3IiwKICAweDA1YjIsCiAgImhhdGFmcGF0YWhuYXJyb3doZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaHF1YXJ0ZXJoZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZwYXRhaHdpZGVoZWJyZXciLAogIDB4MDViMiwKICAiaGF0YWZxYW1hdHMiLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHMxYiIsCiAgMHgwNWIzLAogICJoYXRhZnFhbWF0czI4IiwKICAweDA1YjMsCiAgImhhdGFmcWFtYXRzMzQiLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNoZWJyZXciLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNuYXJyb3doZWJyZXciLAogIDB4MDViMywKICAiaGF0YWZxYW1hdHNxdWFydGVyaGVicmV3IiwKICAweDA1YjMsCiAgImhhdGFmcWFtYXRzd2lkZWhlYnJldyIsCiAgMHgwNWIzLAogICJoYXRhZnNlZ29sIiwKICAweDA1YjEsCiAgImhhdGFmc2Vnb2wxNyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29sMjQiLAogIDB4MDViMSwKICAiaGF0YWZzZWdvbDMwIiwKICAweDA1YjEsCiAgImhhdGFmc2Vnb2xoZWJyZXciLAogIDB4MDViMSwKICAiaGF0YWZzZWdvbG5hcnJvd2hlYnJldyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29scXVhcnRlcmhlYnJldyIsCiAgMHgwNWIxLAogICJoYXRhZnNlZ29sd2lkZWhlYnJldyIsCiAgMHgwNWIxLAogICJoYmFyIiwKICAweDAxMjcsCiAgImhib3BvbW9mbyIsCiAgMHgzMTBmLAogICJoYnJldmViZWxvdyIsCiAgMHgxZTJiLAogICJoY2VkaWxsYSIsCiAgMHgxZTI5LAogICJoY2lyY2xlIiwKICAweDI0ZDcsCiAgImhjaXJjdW1mbGV4IiwKICAweDAxMjUsCiAgImhkaWVyZXNpcyIsCiAgMHgxZTI3LAogICJoZG90YWNjZW50IiwKICAweDFlMjMsCiAgImhkb3RiZWxvdyIsCiAgMHgxZTI1LAogICJoZSIsCiAgMHgwNWQ0LAogICJoZWFydCIsCiAgMHgyNjY1LAogICJoZWFydHN1aXRibGFjayIsCiAgMHgyNjY1LAogICJoZWFydHN1aXR3aGl0ZSIsCiAgMHgyNjYxLAogICJoZWRhZ2VzaCIsCiAgMHhmYjM0LAogICJoZWRhZ2VzaGhlYnJldyIsCiAgMHhmYjM0LAogICJoZWhhbHRvbmVhcmFiaWMiLAogIDB4MDZjMSwKICAiaGVoYXJhYmljIiwKICAweDA2NDcsCiAgImhlaGVicmV3IiwKICAweDA1ZDQsCiAgImhlaGZpbmFsYWx0b25lYXJhYmljIiwKICAweGZiYTcsCiAgImhlaGZpbmFsYWx0dHdvYXJhYmljIiwKICAweGZlZWEsCiAgImhlaGZpbmFsYXJhYmljIiwKICAweGZlZWEsCiAgImhlaGhhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmYmE1LAogICJoZWhoYW16YWFib3ZlaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmJhNCwKICAiaGVoaW5pdGlhbGFsdG9uZWFyYWJpYyIsCiAgMHhmYmE4LAogICJoZWhpbml0aWFsYXJhYmljIiwKICAweGZlZWIsCiAgImhlaGlyYWdhbmEiLAogIDB4MzA3OCwKICAiaGVobWVkaWFsYWx0b25lYXJhYmljIiwKICAweGZiYTksCiAgImhlaG1lZGlhbGFyYWJpYyIsCiAgMHhmZWVjLAogICJoZWlzZWllcmFzcXVhcmUiLAogIDB4MzM3YiwKICAiaGVrYXRha2FuYSIsCiAgMHgzMGQ4LAogICJoZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGQsCiAgImhla3V0YWFydXNxdWFyZSIsCiAgMHgzMzM2LAogICJoZW5naG9vayIsCiAgMHgwMjY3LAogICJoZXJ1dHVzcXVhcmUiLAogIDB4MzMzOSwKICAiaGV0IiwKICAweDA1ZDcsCiAgImhldGhlYnJldyIsCiAgMHgwNWQ3LAogICJoaG9vayIsCiAgMHgwMjY2LAogICJoaG9va3N1cGVyaW9yIiwKICAweDAyYjEsCiAgImhpZXVoYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjdiLAogICJoaWV1aGFwYXJlbmtvcmVhbiIsCiAgMHgzMjFiLAogICJoaWV1aGNpcmNsZWtvcmVhbiIsCiAgMHgzMjZkLAogICJoaWV1aGtvcmVhbiIsCiAgMHgzMTRlLAogICJoaWV1aHBhcmVua29yZWFuIiwKICAweDMyMGQsCiAgImhpaGlyYWdhbmEiLAogIDB4MzA3MiwKICAiaGlrYXRha2FuYSIsCiAgMHgzMGQyLAogICJoaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGIsCiAgImhpcmlxIiwKICAweDA1YjQsCiAgImhpcmlxMTQiLAogIDB4MDViNCwKICAiaGlyaXEyMSIsCiAgMHgwNWI0LAogICJoaXJpcTJkIiwKICAweDA1YjQsCiAgImhpcmlxaGVicmV3IiwKICAweDA1YjQsCiAgImhpcmlxbmFycm93aGVicmV3IiwKICAweDA1YjQsCiAgImhpcmlxcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI0LAogICJoaXJpcXdpZGVoZWJyZXciLAogIDB4MDViNCwKICAiaGxpbmViZWxvdyIsCiAgMHgxZTk2LAogICJobW9ub3NwYWNlIiwKICAweGZmNDgsCiAgImhvYXJtZW5pYW4iLAogIDB4MDU3MCwKICAiaG9oaXB0aGFpIiwKICAweDBlMmIsCiAgImhvaGlyYWdhbmEiLAogIDB4MzA3YiwKICAiaG9rYXRha2FuYSIsCiAgMHgzMGRiLAogICJob2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGUsCiAgImhvbGFtIiwKICAweDA1YjksCiAgImhvbGFtMTkiLAogIDB4MDViOSwKICAiaG9sYW0yNiIsCiAgMHgwNWI5LAogICJob2xhbTMyIiwKICAweDA1YjksCiAgImhvbGFtaGVicmV3IiwKICAweDA1YjksCiAgImhvbGFtbmFycm93aGVicmV3IiwKICAweDA1YjksCiAgImhvbGFtcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI5LAogICJob2xhbXdpZGVoZWJyZXciLAogIDB4MDViOSwKICAiaG9ub2todWt0aGFpIiwKICAweDBlMmUsCiAgImhvb2thYm92ZWNvbWIiLAogIDB4MDMwOSwKICAiaG9va2NtYiIsCiAgMHgwMzA5LAogICJob29rcGFsYXRhbGl6ZWRiZWxvd2NtYiIsCiAgMHgwMzIxLAogICJob29rcmV0cm9mbGV4YmVsb3djbWIiLAogIDB4MDMyMiwKICAiaG9vbnNxdWFyZSIsCiAgMHgzMzQyLAogICJob3JpY29wdGljIiwKICAweDAzZTksCiAgImhvcml6b250YWxiYXIiLAogIDB4MjAxNSwKICAiaG9ybmNtYiIsCiAgMHgwMzFiLAogICJob3RzcHJpbmdzIiwKICAweDI2NjgsCiAgImhvdXNlIiwKICAweDIzMDIsCiAgImhwYXJlbiIsCiAgMHgyNGEzLAogICJoc3VwZXJpb3IiLAogIDB4MDJiMCwKICAiaHR1cm5lZCIsCiAgMHgwMjY1LAogICJodWhpcmFnYW5hIiwKICAweDMwNzUsCiAgImh1aWl0b3NxdWFyZSIsCiAgMHgzMzMzLAogICJodWthdGFrYW5hIiwKICAweDMwZDUsCiAgImh1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4YywKICAiaHVuZ2FydW1sYXV0IiwKICAweDAyZGQsCiAgImh1bmdhcnVtbGF1dGNtYiIsCiAgMHgwMzBiLAogICJodiIsCiAgMHgwMTk1LAogICJoeXBoZW4iLAogIDB4MDAyZCwKICAiaHlwaGVuaW5mZXJpb3IiLAogIDB4ZjZlNSwKICAiaHlwaGVubW9ub3NwYWNlIiwKICAweGZmMGQsCiAgImh5cGhlbnNtYWxsIiwKICAweGZlNjMsCiAgImh5cGhlbnN1cGVyaW9yIiwKICAweGY2ZTYsCiAgImh5cGhlbnR3byIsCiAgMHgyMDEwLAogICJpIiwKICAweDAwNjksCiAgImlhY3V0ZSIsCiAgMHgwMGVkLAogICJpYWN5cmlsbGljIiwKICAweDA0NGYsCiAgImliZW5nYWxpIiwKICAweDA5ODcsCiAgImlib3BvbW9mbyIsCiAgMHgzMTI3LAogICJpYnJldmUiLAogIDB4MDEyZCwKICAiaWNhcm9uIiwKICAweDAxZDAsCiAgImljaXJjbGUiLAogIDB4MjRkOCwKICAiaWNpcmN1bWZsZXgiLAogIDB4MDBlZSwKICAiaWN5cmlsbGljIiwKICAweDA0NTYsCiAgImlkYmxncmF2ZSIsCiAgMHgwMjA5LAogICJpZGVvZ3JhcGhlYXJ0aGNpcmNsZSIsCiAgMHgzMjhmLAogICJpZGVvZ3JhcGhmaXJlY2lyY2xlIiwKICAweDMyOGIsCiAgImlkZW9ncmFwaGljYWxsaWFuY2VwYXJlbiIsCiAgMHgzMjNmLAogICJpZGVvZ3JhcGhpY2NhbGxwYXJlbiIsCiAgMHgzMjNhLAogICJpZGVvZ3JhcGhpY2NlbnRyZWNpcmNsZSIsCiAgMHgzMmE1LAogICJpZGVvZ3JhcGhpY2Nsb3NlIiwKICAweDMwMDYsCiAgImlkZW9ncmFwaGljY29tbWEiLAogIDB4MzAwMSwKICAiaWRlb2dyYXBoaWNjb21tYWxlZnQiLAogIDB4ZmY2NCwKICAiaWRlb2dyYXBoaWNjb25ncmF0dWxhdGlvbnBhcmVuIiwKICAweDMyMzcsCiAgImlkZW9ncmFwaGljY29ycmVjdGNpcmNsZSIsCiAgMHgzMmEzLAogICJpZGVvZ3JhcGhpY2VhcnRocGFyZW4iLAogIDB4MzIyZiwKICAiaWRlb2dyYXBoaWNlbnRlcnByaXNlcGFyZW4iLAogIDB4MzIzZCwKICAiaWRlb2dyYXBoaWNleGNlbGxlbnRjaXJjbGUiLAogIDB4MzI5ZCwKICAiaWRlb2dyYXBoaWNmZXN0aXZhbHBhcmVuIiwKICAweDMyNDAsCiAgImlkZW9ncmFwaGljZmluYW5jaWFsY2lyY2xlIiwKICAweDMyOTYsCiAgImlkZW9ncmFwaGljZmluYW5jaWFscGFyZW4iLAogIDB4MzIzNiwKICAiaWRlb2dyYXBoaWNmaXJlcGFyZW4iLAogIDB4MzIyYiwKICAiaWRlb2dyYXBoaWNoYXZlcGFyZW4iLAogIDB4MzIzMiwKICAiaWRlb2dyYXBoaWNoaWdoY2lyY2xlIiwKICAweDMyYTQsCiAgImlkZW9ncmFwaGljaXRlcmF0aW9ubWFyayIsCiAgMHgzMDA1LAogICJpZGVvZ3JhcGhpY2xhYm9yY2lyY2xlIiwKICAweDMyOTgsCiAgImlkZW9ncmFwaGljbGFib3JwYXJlbiIsCiAgMHgzMjM4LAogICJpZGVvZ3JhcGhpY2xlZnRjaXJjbGUiLAogIDB4MzJhNywKICAiaWRlb2dyYXBoaWNsb3djaXJjbGUiLAogIDB4MzJhNiwKICAiaWRlb2dyYXBoaWNtZWRpY2luZWNpcmNsZSIsCiAgMHgzMmE5LAogICJpZGVvZ3JhcGhpY21ldGFscGFyZW4iLAogIDB4MzIyZSwKICAiaWRlb2dyYXBoaWNtb29ucGFyZW4iLAogIDB4MzIyYSwKICAiaWRlb2dyYXBoaWNuYW1lcGFyZW4iLAogIDB4MzIzNCwKICAiaWRlb2dyYXBoaWNwZXJpb2QiLAogIDB4MzAwMiwKICAiaWRlb2dyYXBoaWNwcmludGNpcmNsZSIsCiAgMHgzMjllLAogICJpZGVvZ3JhcGhpY3JlYWNocGFyZW4iLAogIDB4MzI0MywKICAiaWRlb2dyYXBoaWNyZXByZXNlbnRwYXJlbiIsCiAgMHgzMjM5LAogICJpZGVvZ3JhcGhpY3Jlc291cmNlcGFyZW4iLAogIDB4MzIzZSwKICAiaWRlb2dyYXBoaWNyaWdodGNpcmNsZSIsCiAgMHgzMmE4LAogICJpZGVvZ3JhcGhpY3NlY3JldGNpcmNsZSIsCiAgMHgzMjk5LAogICJpZGVvZ3JhcGhpY3NlbGZwYXJlbiIsCiAgMHgzMjQyLAogICJpZGVvZ3JhcGhpY3NvY2lldHlwYXJlbiIsCiAgMHgzMjMzLAogICJpZGVvZ3JhcGhpY3NwYWNlIiwKICAweDMwMDAsCiAgImlkZW9ncmFwaGljc3BlY2lhbHBhcmVuIiwKICAweDMyMzUsCiAgImlkZW9ncmFwaGljc3RvY2twYXJlbiIsCiAgMHgzMjMxLAogICJpZGVvZ3JhcGhpY3N0dWR5cGFyZW4iLAogIDB4MzIzYiwKICAiaWRlb2dyYXBoaWNzdW5wYXJlbiIsCiAgMHgzMjMwLAogICJpZGVvZ3JhcGhpY3N1cGVydmlzZXBhcmVuIiwKICAweDMyM2MsCiAgImlkZW9ncmFwaGljd2F0ZXJwYXJlbiIsCiAgMHgzMjJjLAogICJpZGVvZ3JhcGhpY3dvb2RwYXJlbiIsCiAgMHgzMjJkLAogICJpZGVvZ3JhcGhpY3plcm8iLAogIDB4MzAwNywKICAiaWRlb2dyYXBobWV0YWxjaXJjbGUiLAogIDB4MzI4ZSwKICAiaWRlb2dyYXBobW9vbmNpcmNsZSIsCiAgMHgzMjhhLAogICJpZGVvZ3JhcGhuYW1lY2lyY2xlIiwKICAweDMyOTQsCiAgImlkZW9ncmFwaHN1bmNpcmNsZSIsCiAgMHgzMjkwLAogICJpZGVvZ3JhcGh3YXRlcmNpcmNsZSIsCiAgMHgzMjhjLAogICJpZGVvZ3JhcGh3b29kY2lyY2xlIiwKICAweDMyOGQsCiAgImlkZXZhIiwKICAweDA5MDcsCiAgImlkaWVyZXNpcyIsCiAgMHgwMGVmLAogICJpZGllcmVzaXNhY3V0ZSIsCiAgMHgxZTJmLAogICJpZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU1LAogICJpZG90YmVsb3ciLAogIDB4MWVjYiwKICAiaWVicmV2ZWN5cmlsbGljIiwKICAweDA0ZDcsCiAgImllY3lyaWxsaWMiLAogIDB4MDQzNSwKICAiaWV1bmdhY2lyY2xla29yZWFuIiwKICAweDMyNzUsCiAgImlldW5nYXBhcmVua29yZWFuIiwKICAweDMyMTUsCiAgImlldW5nY2lyY2xla29yZWFuIiwKICAweDMyNjcsCiAgImlldW5na29yZWFuIiwKICAweDMxNDcsCiAgImlldW5ncGFyZW5rb3JlYW4iLAogIDB4MzIwNywKICAiaWdyYXZlIiwKICAweDAwZWMsCiAgImlndWphcmF0aSIsCiAgMHgwYTg3LAogICJpZ3VybXVraGkiLAogIDB4MGEwNywKICAiaWhpcmFnYW5hIiwKICAweDMwNDQsCiAgImlob29rYWJvdmUiLAogIDB4MWVjOSwKICAiaWliZW5nYWxpIiwKICAweDA5ODgsCiAgImlpY3lyaWxsaWMiLAogIDB4MDQzOCwKICAiaWlkZXZhIiwKICAweDA5MDgsCiAgImlpZ3VqYXJhdGkiLAogIDB4MGE4OCwKICAiaWlndXJtdWtoaSIsCiAgMHgwYTA4LAogICJpaW1hdHJhZ3VybXVraGkiLAogIDB4MGE0MCwKICAiaWludmVydGVkYnJldmUiLAogIDB4MDIwYiwKICAiaWlzaG9ydGN5cmlsbGljIiwKICAweDA0MzksCiAgImlpdm93ZWxzaWduYmVuZ2FsaSIsCiAgMHgwOWMwLAogICJpaXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0MCwKICAiaWl2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWMwLAogICJpaiIsCiAgMHgwMTMzLAogICJpa2F0YWthbmEiLAogIDB4MzBhNCwKICAiaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzIsCiAgImlrb3JlYW4iLAogIDB4MzE2MywKICAiaWxkZSIsCiAgMHgwMmRjLAogICJpbHV5aGVicmV3IiwKICAweDA1YWMsCiAgImltYWNyb24iLAogIDB4MDEyYiwKICAiaW1hY3JvbmN5cmlsbGljIiwKICAweDA0ZTMsCiAgImltYWdlb3JhcHByb3hpbWF0ZWx5ZXF1YWwiLAogIDB4MjI1MywKICAiaW1hdHJhZ3VybXVraGkiLAogIDB4MGEzZiwKICAiaW1vbm9zcGFjZSIsCiAgMHhmZjQ5LAogICJpbmNyZW1lbnQiLAogIDB4MjIwNiwKICAiaW5maW5pdHkiLAogIDB4MjIxZSwKICAiaW5pYXJtZW5pYW4iLAogIDB4MDU2YiwKICAiaW50ZWdyYWwiLAogIDB4MjIyYiwKICAiaW50ZWdyYWxib3R0b20iLAogIDB4MjMyMSwKICAiaW50ZWdyYWxidCIsCiAgMHgyMzIxLAogICJpbnRlZ3JhbGV4IiwKICAweGY4ZjUsCiAgImludGVncmFsdG9wIiwKICAweDIzMjAsCiAgImludGVncmFsdHAiLAogIDB4MjMyMCwKICAiaW50ZXJzZWN0aW9uIiwKICAweDIyMjksCiAgImludGlzcXVhcmUiLAogIDB4MzMwNSwKICAiaW52YnVsbGV0IiwKICAweDI1ZDgsCiAgImludmNpcmNsZSIsCiAgMHgyNWQ5LAogICJpbnZzbWlsZWZhY2UiLAogIDB4MjYzYiwKICAiaW9jeXJpbGxpYyIsCiAgMHgwNDUxLAogICJpb2dvbmVrIiwKICAweDAxMmYsCiAgImlvdGEiLAogIDB4MDNiOSwKICAiaW90YWRpZXJlc2lzIiwKICAweDAzY2EsCiAgImlvdGFkaWVyZXNpc3Rvbm9zIiwKICAweDAzOTAsCiAgImlvdGFsYXRpbiIsCiAgMHgwMjY5LAogICJpb3RhdG9ub3MiLAogIDB4MDNhZiwKICAiaXBhcmVuIiwKICAweDI0YTQsCiAgImlyaWd1cm11a2hpIiwKICAweDBhNzIsCiAgImlzbWFsbGhpcmFnYW5hIiwKICAweDMwNDMsCiAgImlzbWFsbGthdGFrYW5hIiwKICAweDMwYTMsCiAgImlzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNjgsCiAgImlzc2hhcmJlbmdhbGkiLAogIDB4MDlmYSwKICAiaXN0cm9rZSIsCiAgMHgwMjY4LAogICJpc3VwZXJpb3IiLAogIDB4ZjZlZCwKICAiaXRlcmF0aW9uaGlyYWdhbmEiLAogIDB4MzA5ZCwKICAiaXRlcmF0aW9ua2F0YWthbmEiLAogIDB4MzBmZCwKICAiaXRpbGRlIiwKICAweDAxMjksCiAgIml0aWxkZWJlbG93IiwKICAweDFlMmQsCiAgIml1Ym9wb21vZm8iLAogIDB4MzEyOSwKICAiaXVjeXJpbGxpYyIsCiAgMHgwNDRlLAogICJpdm93ZWxzaWduYmVuZ2FsaSIsCiAgMHgwOWJmLAogICJpdm93ZWxzaWduZGV2YSIsCiAgMHgwOTNmLAogICJpdm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFiZiwKICAiaXpoaXRzYWN5cmlsbGljIiwKICAweDA0NzUsCiAgIml6aGl0c2FkYmxncmF2ZWN5cmlsbGljIiwKICAweDA0NzcsCiAgImoiLAogIDB4MDA2YSwKICAiamFhcm1lbmlhbiIsCiAgMHgwNTcxLAogICJqYWJlbmdhbGkiLAogIDB4MDk5YywKICAiamFkZXZhIiwKICAweDA5MWMsCiAgImphZ3VqYXJhdGkiLAogIDB4MGE5YywKICAiamFndXJtdWtoaSIsCiAgMHgwYTFjLAogICJqYm9wb21vZm8iLAogIDB4MzExMCwKICAiamNhcm9uIiwKICAweDAxZjAsCiAgImpjaXJjbGUiLAogIDB4MjRkOSwKICAiamNpcmN1bWZsZXgiLAogIDB4MDEzNSwKICAiamNyb3NzZWR0YWlsIiwKICAweDAyOWQsCiAgImpkb3RsZXNzc3Ryb2tlIiwKICAweDAyNWYsCiAgImplY3lyaWxsaWMiLAogIDB4MDQ1OCwKICAiamVlbWFyYWJpYyIsCiAgMHgwNjJjLAogICJqZWVtZmluYWxhcmFiaWMiLAogIDB4ZmU5ZSwKICAiamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmU5ZiwKICAiamVlbW1lZGlhbGFyYWJpYyIsCiAgMHhmZWEwLAogICJqZWhhcmFiaWMiLAogIDB4MDY5OCwKICAiamVoZmluYWxhcmFiaWMiLAogIDB4ZmI4YiwKICAiamhhYmVuZ2FsaSIsCiAgMHgwOTlkLAogICJqaGFkZXZhIiwKICAweDA5MWQsCiAgImpoYWd1amFyYXRpIiwKICAweDBhOWQsCiAgImpoYWd1cm11a2hpIiwKICAweDBhMWQsCiAgImpoZWhhcm1lbmlhbiIsCiAgMHgwNTdiLAogICJqaXMiLAogIDB4MzAwNCwKICAiam1vbm9zcGFjZSIsCiAgMHhmZjRhLAogICJqcGFyZW4iLAogIDB4MjRhNSwKICAianN1cGVyaW9yIiwKICAweDAyYjIsCiAgImsiLAogIDB4MDA2YiwKICAia2FiYXNoa2lyY3lyaWxsaWMiLAogIDB4MDRhMSwKICAia2FiZW5nYWxpIiwKICAweDA5OTUsCiAgImthY3V0ZSIsCiAgMHgxZTMxLAogICJrYWN5cmlsbGljIiwKICAweDA0M2EsCiAgImthZGVzY2VuZGVyY3lyaWxsaWMiLAogIDB4MDQ5YiwKICAia2FkZXZhIiwKICAweDA5MTUsCiAgImthZiIsCiAgMHgwNWRiLAogICJrYWZhcmFiaWMiLAogIDB4MDY0MywKICAia2FmZGFnZXNoIiwKICAweGZiM2IsCiAgImthZmRhZ2VzaGhlYnJldyIsCiAgMHhmYjNiLAogICJrYWZmaW5hbGFyYWJpYyIsCiAgMHhmZWRhLAogICJrYWZoZWJyZXciLAogIDB4MDVkYiwKICAia2FmaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWRiLAogICJrYWZtZWRpYWxhcmFiaWMiLAogIDB4ZmVkYywKICAia2FmcmFmZWhlYnJldyIsCiAgMHhmYjRkLAogICJrYWd1amFyYXRpIiwKICAweDBhOTUsCiAgImthZ3VybXVraGkiLAogIDB4MGExNSwKICAia2FoaXJhZ2FuYSIsCiAgMHgzMDRiLAogICJrYWhvb2tjeXJpbGxpYyIsCiAgMHgwNGM0LAogICJrYWthdGFrYW5hIiwKICAweDMwYWIsCiAgImtha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NiwKICAia2FwcGEiLAogIDB4MDNiYSwKICAia2FwcGFzeW1ib2xncmVlayIsCiAgMHgwM2YwLAogICJrYXB5ZW91bm1pZXVta29yZWFuIiwKICAweDMxNzEsCiAgImthcHllb3VucGhpZXVwaGtvcmVhbiIsCiAgMHgzMTg0LAogICJrYXB5ZW91bnBpZXVwa29yZWFuIiwKICAweDMxNzgsCiAgImthcHllb3Vuc3NhbmdwaWV1cGtvcmVhbiIsCiAgMHgzMTc5LAogICJrYXJvcmlpc3F1YXJlIiwKICAweDMzMGQsCiAgImthc2hpZGFhdXRvYXJhYmljIiwKICAweDA2NDAsCiAgImthc2hpZGFhdXRvbm9zaWRlYmVhcmluZ2FyYWJpYyIsCiAgMHgwNjQwLAogICJrYXNtYWxsa2F0YWthbmEiLAogIDB4MzBmNSwKICAia2FzcXVhcmUiLAogIDB4MzM4NCwKICAia2FzcmFhcmFiaWMiLAogIDB4MDY1MCwKICAia2FzcmF0YW5hcmFiaWMiLAogIDB4MDY0ZCwKICAia2FzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDlmLAogICJrYXRhaGlyYXByb2xvbmdtYXJraGFsZndpZHRoIiwKICAweGZmNzAsCiAgImthdmVydGljYWxzdHJva2VjeXJpbGxpYyIsCiAgMHgwNDlkLAogICJrYm9wb21vZm8iLAogIDB4MzEwZSwKICAia2NhbHNxdWFyZSIsCiAgMHgzMzg5LAogICJrY2Fyb24iLAogIDB4MDFlOSwKICAia2NlZGlsbGEiLAogIDB4MDEzNywKICAia2NpcmNsZSIsCiAgMHgyNGRhLAogICJrY29tbWFhY2NlbnQiLAogIDB4MDEzNywKICAia2RvdGJlbG93IiwKICAweDFlMzMsCiAgImtlaGFybWVuaWFuIiwKICAweDA1ODQsCiAgImtlaGlyYWdhbmEiLAogIDB4MzA1MSwKICAia2VrYXRha2FuYSIsCiAgMHgzMGIxLAogICJrZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzksCiAgImtlbmFybWVuaWFuIiwKICAweDA1NmYsCiAgImtlc21hbGxrYXRha2FuYSIsCiAgMHgzMGY2LAogICJrZ3JlZW5sYW5kaWMiLAogIDB4MDEzOCwKICAia2hhYmVuZ2FsaSIsCiAgMHgwOTk2LAogICJraGFjeXJpbGxpYyIsCiAgMHgwNDQ1LAogICJraGFkZXZhIiwKICAweDA5MTYsCiAgImtoYWd1amFyYXRpIiwKICAweDBhOTYsCiAgImtoYWd1cm11a2hpIiwKICAweDBhMTYsCiAgImtoYWhhcmFiaWMiLAogIDB4MDYyZSwKICAia2hhaGZpbmFsYXJhYmljIiwKICAweGZlYTYsCiAgImtoYWhpbml0aWFsYXJhYmljIiwKICAweGZlYTcsCiAgImtoYWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVhOCwKICAia2hlaWNvcHRpYyIsCiAgMHgwM2U3LAogICJraGhhZGV2YSIsCiAgMHgwOTU5LAogICJraGhhZ3VybXVraGkiLAogIDB4MGE1OSwKICAia2hpZXVraGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3OCwKICAia2hpZXVraGFwYXJlbmtvcmVhbiIsCiAgMHgzMjE4LAogICJraGlldWtoY2lyY2xla29yZWFuIiwKICAweDMyNmEsCiAgImtoaWV1a2hrb3JlYW4iLAogIDB4MzE0YiwKICAia2hpZXVraHBhcmVua29yZWFuIiwKICAweDMyMGEsCiAgImtob2toYWl0aGFpIiwKICAweDBlMDIsCiAgImtob2tob250aGFpIiwKICAweDBlMDUsCiAgImtob2todWF0dGhhaSIsCiAgMHgwZTAzLAogICJraG9raHdhaXRoYWkiLAogIDB4MGUwNCwKICAia2hvbXV0dGhhaSIsCiAgMHgwZTViLAogICJraG9vayIsCiAgMHgwMTk5LAogICJraG9yYWtoYW5ndGhhaSIsCiAgMHgwZTA2LAogICJraHpzcXVhcmUiLAogIDB4MzM5MSwKICAia2loaXJhZ2FuYSIsCiAgMHgzMDRkLAogICJraWthdGFrYW5hIiwKICAweDMwYWQsCiAgImtpa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NywKICAia2lyb2d1cmFtdXNxdWFyZSIsCiAgMHgzMzE1LAogICJraXJvbWVldG9ydXNxdWFyZSIsCiAgMHgzMzE2LAogICJraXJvc3F1YXJlIiwKICAweDMzMTQsCiAgImtpeWVva2FjaXJjbGVrb3JlYW4iLAogIDB4MzI2ZSwKICAia2l5ZW9rYXBhcmVua29yZWFuIiwKICAweDMyMGUsCiAgImtpeWVva2NpcmNsZWtvcmVhbiIsCiAgMHgzMjYwLAogICJraXllb2trb3JlYW4iLAogIDB4MzEzMSwKICAia2l5ZW9rcGFyZW5rb3JlYW4iLAogIDB4MzIwMCwKICAia2l5ZW9rc2lvc2tvcmVhbiIsCiAgMHgzMTMzLAogICJramVjeXJpbGxpYyIsCiAgMHgwNDVjLAogICJrbGluZWJlbG93IiwKICAweDFlMzUsCiAgImtsc3F1YXJlIiwKICAweDMzOTgsCiAgImttY3ViZWRzcXVhcmUiLAogIDB4MzNhNiwKICAia21vbm9zcGFjZSIsCiAgMHhmZjRiLAogICJrbXNxdWFyZWRzcXVhcmUiLAogIDB4MzNhMiwKICAia29oaXJhZ2FuYSIsCiAgMHgzMDUzLAogICJrb2htc3F1YXJlIiwKICAweDMzYzAsCiAgImtva2FpdGhhaSIsCiAgMHgwZTAxLAogICJrb2thdGFrYW5hIiwKICAweDMwYjMsCiAgImtva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3YSwKICAia29vcG9zcXVhcmUiLAogIDB4MzMxZSwKICAia29wcGFjeXJpbGxpYyIsCiAgMHgwNDgxLAogICJrb3JlYW5zdGFuZGFyZHN5bWJvbCIsCiAgMHgzMjdmLAogICJrb3JvbmlzY21iIiwKICAweDAzNDMsCiAgImtwYXJlbiIsCiAgMHgyNGE2LAogICJrcGFzcXVhcmUiLAogIDB4MzNhYSwKICAia3NpY3lyaWxsaWMiLAogIDB4MDQ2ZiwKICAia3RzcXVhcmUiLAogIDB4MzNjZiwKICAia3R1cm5lZCIsCiAgMHgwMjllLAogICJrdWhpcmFnYW5hIiwKICAweDMwNGYsCiAgImt1a2F0YWthbmEiLAogIDB4MzBhZiwKICAia3VrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjc4LAogICJrdnNxdWFyZSIsCiAgMHgzM2I4LAogICJrd3NxdWFyZSIsCiAgMHgzM2JlLAogICJsIiwKICAweDAwNmMsCiAgImxhYmVuZ2FsaSIsCiAgMHgwOWIyLAogICJsYWN1dGUiLAogIDB4MDEzYSwKICAibGFkZXZhIiwKICAweDA5MzIsCiAgImxhZ3VqYXJhdGkiLAogIDB4MGFiMiwKICAibGFndXJtdWtoaSIsCiAgMHgwYTMyLAogICJsYWtraGFuZ3lhb3RoYWkiLAogIDB4MGU0NSwKICAibGFtYWxlZmZpbmFsYXJhYmljIiwKICAweGZlZmMsCiAgImxhbWFsZWZoYW16YWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmVmOCwKICAibGFtYWxlZmhhbXphYWJvdmVpc29sYXRlZGFyYWJpYyIsCiAgMHhmZWY3LAogICJsYW1hbGVmaGFtemFiZWxvd2ZpbmFsYXJhYmljIiwKICAweGZlZmEsCiAgImxhbWFsZWZoYW16YWJlbG93aXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmVmOSwKICAibGFtYWxlZmlzb2xhdGVkYXJhYmljIiwKICAweGZlZmIsCiAgImxhbWFsZWZtYWRkYWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmVmNiwKICAibGFtYWxlZm1hZGRhYWJvdmVpc29sYXRlZGFyYWJpYyIsCiAgMHhmZWY1LAogICJsYW1hcmFiaWMiLAogIDB4MDY0NCwKICAibGFtYmRhIiwKICAweDAzYmIsCiAgImxhbWJkYXN0cm9rZSIsCiAgMHgwMTliLAogICJsYW1lZCIsCiAgMHgwNWRjLAogICJsYW1lZGRhZ2VzaCIsCiAgMHhmYjNjLAogICJsYW1lZGRhZ2VzaGhlYnJldyIsCiAgMHhmYjNjLAogICJsYW1lZGhlYnJldyIsCiAgMHgwNWRjLAogICJsYW1maW5hbGFyYWJpYyIsCiAgMHhmZWRlLAogICJsYW1oYWhpbml0aWFsYXJhYmljIiwKICAweGZjY2EsCiAgImxhbWluaXRpYWxhcmFiaWMiLAogIDB4ZmVkZiwKICAibGFtamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNjOSwKICAibGFta2hhaGluaXRpYWxhcmFiaWMiLAogIDB4ZmNjYiwKICAibGFtbGFtaGVoaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmRmMiwKICAibGFtbWVkaWFsYXJhYmljIiwKICAweGZlZTAsCiAgImxhbW1lZW1oYWhpbml0aWFsYXJhYmljIiwKICAweGZkODgsCiAgImxhbW1lZW1pbml0aWFsYXJhYmljIiwKICAweGZjY2MsCiAgImxhcmdlY2lyY2xlIiwKICAweDI1ZWYsCiAgImxiYXIiLAogIDB4MDE5YSwKICAibGJlbHQiLAogIDB4MDI2YywKICAibGJvcG9tb2ZvIiwKICAweDMxMGMsCiAgImxjYXJvbiIsCiAgMHgwMTNlLAogICJsY2VkaWxsYSIsCiAgMHgwMTNjLAogICJsY2lyY2xlIiwKICAweDI0ZGIsCiAgImxjaXJjdW1mbGV4YmVsb3ciLAogIDB4MWUzZCwKICAibGNvbW1hYWNjZW50IiwKICAweDAxM2MsCiAgImxkb3QiLAogIDB4MDE0MCwKICAibGRvdGFjY2VudCIsCiAgMHgwMTQwLAogICJsZG90YmVsb3ciLAogIDB4MWUzNywKICAibGRvdGJlbG93bWFjcm9uIiwKICAweDFlMzksCiAgImxlZnRhbmdsZWFib3ZlY21iIiwKICAweDAzMWEsCiAgImxlZnR0YWNrYmVsb3djbWIiLAogIDB4MDMxOCwKICAibGVzcyIsCiAgMHgwMDNjLAogICJsZXNzZXF1YWwiLAogIDB4MjI2NCwKICAibGVzc2VxdWFsb3JncmVhdGVyIiwKICAweDIyZGEsCiAgImxlc3Ntb25vc3BhY2UiLAogIDB4ZmYxYywKICAibGVzc29yZXF1aXZhbGVudCIsCiAgMHgyMjcyLAogICJsZXNzb3JncmVhdGVyIiwKICAweDIyNzYsCiAgImxlc3NvdmVyZXF1YWwiLAogIDB4MjI2NiwKICAibGVzc3NtYWxsIiwKICAweGZlNjQsCiAgImxlemgiLAogIDB4MDI2ZSwKICAibGZibG9jayIsCiAgMHgyNThjLAogICJsaG9va3JldHJvZmxleCIsCiAgMHgwMjZkLAogICJsaXJhIiwKICAweDIwYTQsCiAgImxpd25hcm1lbmlhbiIsCiAgMHgwNTZjLAogICJsaiIsCiAgMHgwMWM5LAogICJsamVjeXJpbGxpYyIsCiAgMHgwNDU5LAogICJsbCIsCiAgMHhmNmMwLAogICJsbGFkZXZhIiwKICAweDA5MzMsCiAgImxsYWd1amFyYXRpIiwKICAweDBhYjMsCiAgImxsaW5lYmVsb3ciLAogIDB4MWUzYiwKICAibGxsYWRldmEiLAogIDB4MDkzNCwKICAibGx2b2NhbGljYmVuZ2FsaSIsCiAgMHgwOWUxLAogICJsbHZvY2FsaWNkZXZhIiwKICAweDA5NjEsCiAgImxsdm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDllMywKICAibGx2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTYzLAogICJsbWlkZGxldGlsZGUiLAogIDB4MDI2YiwKICAibG1vbm9zcGFjZSIsCiAgMHhmZjRjLAogICJsbXNxdWFyZSIsCiAgMHgzM2QwLAogICJsb2NodWxhdGhhaSIsCiAgMHgwZTJjLAogICJsb2dpY2FsYW5kIiwKICAweDIyMjcsCiAgImxvZ2ljYWxub3QiLAogIDB4MDBhYywKICAibG9naWNhbG5vdHJldmVyc2VkIiwKICAweDIzMTAsCiAgImxvZ2ljYWxvciIsCiAgMHgyMjI4LAogICJsb2xpbmd0aGFpIiwKICAweDBlMjUsCiAgImxvbmdzIiwKICAweDAxN2YsCiAgImxvd2xpbmVjZW50ZXJsaW5lIiwKICAweGZlNGUsCiAgImxvd2xpbmVjbWIiLAogIDB4MDMzMiwKICAibG93bGluZWRhc2hlZCIsCiAgMHhmZTRkLAogICJsb3plbmdlIiwKICAweDI1Y2EsCiAgImxwYXJlbiIsCiAgMHgyNGE3LAogICJsc2xhc2giLAogIDB4MDE0MiwKICAibHNxdWFyZSIsCiAgMHgyMTEzLAogICJsc3VwZXJpb3IiLAogIDB4ZjZlZSwKICAibHRzaGFkZSIsCiAgMHgyNTkxLAogICJsdXRoYWkiLAogIDB4MGUyNiwKICAibHZvY2FsaWNiZW5nYWxpIiwKICAweDA5OGMsCiAgImx2b2NhbGljZGV2YSIsCiAgMHgwOTBjLAogICJsdm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDllMiwKICAibHZvY2FsaWN2b3dlbHNpZ25kZXZhIiwKICAweDA5NjIsCiAgImx4c3F1YXJlIiwKICAweDMzZDMsCiAgIm0iLAogIDB4MDA2ZCwKICAibWFiZW5nYWxpIiwKICAweDA5YWUsCiAgIm1hY3JvbiIsCiAgMHgwMGFmLAogICJtYWNyb25iZWxvd2NtYiIsCiAgMHgwMzMxLAogICJtYWNyb25jbWIiLAogIDB4MDMwNCwKICAibWFjcm9ubG93bW9kIiwKICAweDAyY2QsCiAgIm1hY3Jvbm1vbm9zcGFjZSIsCiAgMHhmZmUzLAogICJtYWN1dGUiLAogIDB4MWUzZiwKICAibWFkZXZhIiwKICAweDA5MmUsCiAgIm1hZ3VqYXJhdGkiLAogIDB4MGFhZSwKICAibWFndXJtdWtoaSIsCiAgMHgwYTJlLAogICJtYWhhcGFraGhlYnJldyIsCiAgMHgwNWE0LAogICJtYWhhcGFraGxlZnRoZWJyZXciLAogIDB4MDVhNCwKICAibWFoaXJhZ2FuYSIsCiAgMHgzMDdlLAogICJtYWljaGF0dGF3YWxvd2xlZnR0aGFpIiwKICAweGY4OTUsCiAgIm1haWNoYXR0YXdhbG93cmlnaHR0aGFpIiwKICAweGY4OTQsCiAgIm1haWNoYXR0YXdhdGhhaSIsCiAgMHgwZTRiLAogICJtYWljaGF0dGF3YXVwcGVybGVmdHRoYWkiLAogIDB4Zjg5MywKICAibWFpZWtsb3dsZWZ0dGhhaSIsCiAgMHhmODhjLAogICJtYWlla2xvd3JpZ2h0dGhhaSIsCiAgMHhmODhiLAogICJtYWlla3RoYWkiLAogIDB4MGU0OCwKICAibWFpZWt1cHBlcmxlZnR0aGFpIiwKICAweGY4OGEsCiAgIm1haWhhbmFrYXRsZWZ0dGhhaSIsCiAgMHhmODg0LAogICJtYWloYW5ha2F0dGhhaSIsCiAgMHgwZTMxLAogICJtYWl0YWlraHVsZWZ0dGhhaSIsCiAgMHhmODg5LAogICJtYWl0YWlraHV0aGFpIiwKICAweDBlNDcsCiAgIm1haXRob2xvd2xlZnR0aGFpIiwKICAweGY4OGYsCiAgIm1haXRob2xvd3JpZ2h0dGhhaSIsCiAgMHhmODhlLAogICJtYWl0aG90aGFpIiwKICAweDBlNDksCiAgIm1haXRob3VwcGVybGVmdHRoYWkiLAogIDB4Zjg4ZCwKICAibWFpdHJpbG93bGVmdHRoYWkiLAogIDB4Zjg5MiwKICAibWFpdHJpbG93cmlnaHR0aGFpIiwKICAweGY4OTEsCiAgIm1haXRyaXRoYWkiLAogIDB4MGU0YSwKICAibWFpdHJpdXBwZXJsZWZ0dGhhaSIsCiAgMHhmODkwLAogICJtYWl5YW1va3RoYWkiLAogIDB4MGU0NiwKICAibWFrYXRha2FuYSIsCiAgMHgzMGRlLAogICJtYWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOGYsCiAgIm1hbGUiLAogIDB4MjY0MiwKICAibWFuc3lvbnNxdWFyZSIsCiAgMHgzMzQ3LAogICJtYXFhZmhlYnJldyIsCiAgMHgwNWJlLAogICJtYXJzIiwKICAweDI2NDIsCiAgIm1hc29yYWNpcmNsZWhlYnJldyIsCiAgMHgwNWFmLAogICJtYXNxdWFyZSIsCiAgMHgzMzgzLAogICJtYm9wb21vZm8iLAogIDB4MzEwNywKICAibWJzcXVhcmUiLAogIDB4MzNkNCwKICAibWNpcmNsZSIsCiAgMHgyNGRjLAogICJtY3ViZWRzcXVhcmUiLAogIDB4MzNhNSwKICAibWRvdGFjY2VudCIsCiAgMHgxZTQxLAogICJtZG90YmVsb3ciLAogIDB4MWU0MywKICAibWVlbWFyYWJpYyIsCiAgMHgwNjQ1LAogICJtZWVtZmluYWxhcmFiaWMiLAogIDB4ZmVlMiwKICAibWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmVlMywKICAibWVlbW1lZGlhbGFyYWJpYyIsCiAgMHhmZWU0LAogICJtZWVtbWVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNkMSwKICAibWVlbW1lZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzQ4LAogICJtZWV0b3J1c3F1YXJlIiwKICAweDMzNGQsCiAgIm1laGlyYWdhbmEiLAogIDB4MzA4MSwKICAibWVpemllcmFzcXVhcmUiLAogIDB4MzM3ZSwKICAibWVrYXRha2FuYSIsCiAgMHgzMGUxLAogICJtZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTIsCiAgIm1lbSIsCiAgMHgwNWRlLAogICJtZW1kYWdlc2giLAogIDB4ZmIzZSwKICAibWVtZGFnZXNoaGVicmV3IiwKICAweGZiM2UsCiAgIm1lbWhlYnJldyIsCiAgMHgwNWRlLAogICJtZW5hcm1lbmlhbiIsCiAgMHgwNTc0LAogICJtZXJraGFoZWJyZXciLAogIDB4MDVhNSwKICAibWVya2hha2VmdWxhaGVicmV3IiwKICAweDA1YTYsCiAgIm1lcmtoYWtlZnVsYWxlZnRoZWJyZXciLAogIDB4MDVhNiwKICAibWVya2hhbGVmdGhlYnJldyIsCiAgMHgwNWE1LAogICJtaG9vayIsCiAgMHgwMjcxLAogICJtaHpzcXVhcmUiLAogIDB4MzM5MiwKICAibWlkZGxlZG90a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2NSwKICAibWlkZG90IiwKICAweDAwYjcsCiAgIm1pZXVtYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjcyLAogICJtaWV1bWFwYXJlbmtvcmVhbiIsCiAgMHgzMjEyLAogICJtaWV1bWNpcmNsZWtvcmVhbiIsCiAgMHgzMjY0LAogICJtaWV1bWtvcmVhbiIsCiAgMHgzMTQxLAogICJtaWV1bXBhbnNpb3Nrb3JlYW4iLAogIDB4MzE3MCwKICAibWlldW1wYXJlbmtvcmVhbiIsCiAgMHgzMjA0LAogICJtaWV1bXBpZXVwa29yZWFuIiwKICAweDMxNmUsCiAgIm1pZXVtc2lvc2tvcmVhbiIsCiAgMHgzMTZmLAogICJtaWhpcmFnYW5hIiwKICAweDMwN2YsCiAgIm1pa2F0YWthbmEiLAogIDB4MzBkZiwKICAibWlrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjkwLAogICJtaW51cyIsCiAgMHgyMjEyLAogICJtaW51c2JlbG93Y21iIiwKICAweDAzMjAsCiAgIm1pbnVzY2lyY2xlIiwKICAweDIyOTYsCiAgIm1pbnVzbW9kIiwKICAweDAyZDcsCiAgIm1pbnVzcGx1cyIsCiAgMHgyMjEzLAogICJtaW51dGUiLAogIDB4MjAzMiwKICAibWlyaWJhYXJ1c3F1YXJlIiwKICAweDMzNGEsCiAgIm1pcmlzcXVhcmUiLAogIDB4MzM0OSwKICAibWxvbmdsZWd0dXJuZWQiLAogIDB4MDI3MCwKICAibWxzcXVhcmUiLAogIDB4MzM5NiwKICAibW1jdWJlZHNxdWFyZSIsCiAgMHgzM2EzLAogICJtbW9ub3NwYWNlIiwKICAweGZmNGQsCiAgIm1tc3F1YXJlZHNxdWFyZSIsCiAgMHgzMzlmLAogICJtb2hpcmFnYW5hIiwKICAweDMwODIsCiAgIm1vaG1zcXVhcmUiLAogIDB4MzNjMSwKICAibW9rYXRha2FuYSIsCiAgMHgzMGUyLAogICJtb2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTMsCiAgIm1vbHNxdWFyZSIsCiAgMHgzM2Q2LAogICJtb21hdGhhaSIsCiAgMHgwZTIxLAogICJtb3ZlcnNzcXVhcmUiLAogIDB4MzNhNywKICAibW92ZXJzc3F1YXJlZHNxdWFyZSIsCiAgMHgzM2E4LAogICJtcGFyZW4iLAogIDB4MjRhOCwKICAibXBhc3F1YXJlIiwKICAweDMzYWIsCiAgIm1zc3F1YXJlIiwKICAweDMzYjMsCiAgIm1zdXBlcmlvciIsCiAgMHhmNmVmLAogICJtdHVybmVkIiwKICAweDAyNmYsCiAgIm11IiwKICAweDAwYjUsCiAgIm11MSIsCiAgMHgwMGI1LAogICJtdWFzcXVhcmUiLAogIDB4MzM4MiwKICAibXVjaGdyZWF0ZXIiLAogIDB4MjI2YiwKICAibXVjaGxlc3MiLAogIDB4MjI2YSwKICAibXVmc3F1YXJlIiwKICAweDMzOGMsCiAgIm11Z3JlZWsiLAogIDB4MDNiYywKICAibXVnc3F1YXJlIiwKICAweDMzOGQsCiAgIm11aGlyYWdhbmEiLAogIDB4MzA4MCwKICAibXVrYXRha2FuYSIsCiAgMHgzMGUwLAogICJtdWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTEsCiAgIm11bHNxdWFyZSIsCiAgMHgzMzk1LAogICJtdWx0aXBseSIsCiAgMHgwMGQ3LAogICJtdW1zcXVhcmUiLAogIDB4MzM5YiwKICAibXVuYWhoZWJyZXciLAogIDB4MDVhMywKICAibXVuYWhsZWZ0aGVicmV3IiwKICAweDA1YTMsCiAgIm11c2ljYWxub3RlIiwKICAweDI2NmEsCiAgIm11c2ljYWxub3RlZGJsIiwKICAweDI2NmIsCiAgIm11c2ljZmxhdHNpZ24iLAogIDB4MjY2ZCwKICAibXVzaWNzaGFycHNpZ24iLAogIDB4MjY2ZiwKICAibXVzc3F1YXJlIiwKICAweDMzYjIsCiAgIm11dnNxdWFyZSIsCiAgMHgzM2I2LAogICJtdXdzcXVhcmUiLAogIDB4MzNiYywKICAibXZtZWdhc3F1YXJlIiwKICAweDMzYjksCiAgIm12c3F1YXJlIiwKICAweDMzYjcsCiAgIm13bWVnYXNxdWFyZSIsCiAgMHgzM2JmLAogICJtd3NxdWFyZSIsCiAgMHgzM2JkLAogICJuIiwKICAweDAwNmUsCiAgIm5hYmVuZ2FsaSIsCiAgMHgwOWE4LAogICJuYWJsYSIsCiAgMHgyMjA3LAogICJuYWN1dGUiLAogIDB4MDE0NCwKICAibmFkZXZhIiwKICAweDA5MjgsCiAgIm5hZ3VqYXJhdGkiLAogIDB4MGFhOCwKICAibmFndXJtdWtoaSIsCiAgMHgwYTI4LAogICJuYWhpcmFnYW5hIiwKICAweDMwNmEsCiAgIm5ha2F0YWthbmEiLAogIDB4MzBjYSwKICAibmFrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg1LAogICJuYXBvc3Ryb3BoZSIsCiAgMHgwMTQ5LAogICJuYXNxdWFyZSIsCiAgMHgzMzgxLAogICJuYm9wb21vZm8iLAogIDB4MzEwYiwKICAibmJzcGFjZSIsCiAgMHgwMGEwLAogICJuY2Fyb24iLAogIDB4MDE0OCwKICAibmNlZGlsbGEiLAogIDB4MDE0NiwKICAibmNpcmNsZSIsCiAgMHgyNGRkLAogICJuY2lyY3VtZmxleGJlbG93IiwKICAweDFlNGIsCiAgIm5jb21tYWFjY2VudCIsCiAgMHgwMTQ2LAogICJuZG90YWNjZW50IiwKICAweDFlNDUsCiAgIm5kb3RiZWxvdyIsCiAgMHgxZTQ3LAogICJuZWhpcmFnYW5hIiwKICAweDMwNmQsCiAgIm5la2F0YWthbmEiLAogIDB4MzBjZCwKICAibmVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg4LAogICJuZXdzaGVxZWxzaWduIiwKICAweDIwYWEsCiAgIm5mc3F1YXJlIiwKICAweDMzOGIsCiAgIm5nYWJlbmdhbGkiLAogIDB4MDk5OSwKICAibmdhZGV2YSIsCiAgMHgwOTE5LAogICJuZ2FndWphcmF0aSIsCiAgMHgwYTk5LAogICJuZ2FndXJtdWtoaSIsCiAgMHgwYTE5LAogICJuZ29uZ3V0aGFpIiwKICAweDBlMDcsCiAgIm5oaXJhZ2FuYSIsCiAgMHgzMDkzLAogICJuaG9va2xlZnQiLAogIDB4MDI3MiwKICAibmhvb2tyZXRyb2ZsZXgiLAogIDB4MDI3MywKICAibmlldW5hY2lyY2xla29yZWFuIiwKICAweDMyNmYsCiAgIm5pZXVuYXBhcmVua29yZWFuIiwKICAweDMyMGYsCiAgIm5pZXVuY2lldWNrb3JlYW4iLAogIDB4MzEzNSwKICAibmlldW5jaXJjbGVrb3JlYW4iLAogIDB4MzI2MSwKICAibmlldW5oaWV1aGtvcmVhbiIsCiAgMHgzMTM2LAogICJuaWV1bmtvcmVhbiIsCiAgMHgzMTM0LAogICJuaWV1bnBhbnNpb3Nrb3JlYW4iLAogIDB4MzE2OCwKICAibmlldW5wYXJlbmtvcmVhbiIsCiAgMHgzMjAxLAogICJuaWV1bnNpb3Nrb3JlYW4iLAogIDB4MzE2NywKICAibmlldW50aWtldXRrb3JlYW4iLAogIDB4MzE2NiwKICAibmloaXJhZ2FuYSIsCiAgMHgzMDZiLAogICJuaWthdGFrYW5hIiwKICAweDMwY2IsCiAgIm5pa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4NiwKICAibmlraGFoaXRsZWZ0dGhhaSIsCiAgMHhmODk5LAogICJuaWtoYWhpdHRoYWkiLAogIDB4MGU0ZCwKICAibmluZSIsCiAgMHgwMDM5LAogICJuaW5lYXJhYmljIiwKICAweDA2NjksCiAgIm5pbmViZW5nYWxpIiwKICAweDA5ZWYsCiAgIm5pbmVjaXJjbGUiLAogIDB4MjQ2OCwKICAibmluZWNpcmNsZWludmVyc2VzYW5zc2VyaWYiLAogIDB4Mjc5MiwKICAibmluZWRldmEiLAogIDB4MDk2ZiwKICAibmluZWd1amFyYXRpIiwKICAweDBhZWYsCiAgIm5pbmVndXJtdWtoaSIsCiAgMHgwYTZmLAogICJuaW5laGFja2FyYWJpYyIsCiAgMHgwNjY5LAogICJuaW5laGFuZ3pob3UiLAogIDB4MzAyOSwKICAibmluZWlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyOCwKICAibmluZWluZmVyaW9yIiwKICAweDIwODksCiAgIm5pbmVtb25vc3BhY2UiLAogIDB4ZmYxOSwKICAibmluZW9sZHN0eWxlIiwKICAweGY3MzksCiAgIm5pbmVwYXJlbiIsCiAgMHgyNDdjLAogICJuaW5lcGVyaW9kIiwKICAweDI0OTAsCiAgIm5pbmVwZXJzaWFuIiwKICAweDA2ZjksCiAgIm5pbmVyb21hbiIsCiAgMHgyMTc4LAogICJuaW5lc3VwZXJpb3IiLAogIDB4MjA3OSwKICAibmluZXRlZW5jaXJjbGUiLAogIDB4MjQ3MiwKICAibmluZXRlZW5wYXJlbiIsCiAgMHgyNDg2LAogICJuaW5ldGVlbnBlcmlvZCIsCiAgMHgyNDlhLAogICJuaW5ldGhhaSIsCiAgMHgwZTU5LAogICJuaiIsCiAgMHgwMWNjLAogICJuamVjeXJpbGxpYyIsCiAgMHgwNDVhLAogICJua2F0YWthbmEiLAogIDB4MzBmMywKICAibmthdGFrYW5haGFsZndpZHRoIiwKICAweGZmOWQsCiAgIm5sZWdyaWdodGxvbmciLAogIDB4MDE5ZSwKICAibmxpbmViZWxvdyIsCiAgMHgxZTQ5LAogICJubW9ub3NwYWNlIiwKICAweGZmNGUsCiAgIm5tc3F1YXJlIiwKICAweDMzOWEsCiAgIm5uYWJlbmdhbGkiLAogIDB4MDlhMywKICAibm5hZGV2YSIsCiAgMHgwOTIzLAogICJubmFndWphcmF0aSIsCiAgMHgwYWEzLAogICJubmFndXJtdWtoaSIsCiAgMHgwYTIzLAogICJubm5hZGV2YSIsCiAgMHgwOTI5LAogICJub2hpcmFnYW5hIiwKICAweDMwNmUsCiAgIm5va2F0YWthbmEiLAogIDB4MzBjZSwKICAibm9rYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg5LAogICJub25icmVha2luZ3NwYWNlIiwKICAweDAwYTAsCiAgIm5vbmVudGhhaSIsCiAgMHgwZTEzLAogICJub251dGhhaSIsCiAgMHgwZTE5LAogICJub29uYXJhYmljIiwKICAweDA2NDYsCiAgIm5vb25maW5hbGFyYWJpYyIsCiAgMHhmZWU2LAogICJub29uZ2h1bm5hYXJhYmljIiwKICAweDA2YmEsCiAgIm5vb25naHVubmFmaW5hbGFyYWJpYyIsCiAgMHhmYjlmLAogICJub29uaW5pdGlhbGFyYWJpYyIsCiAgMHhmZWU3LAogICJub29uamVlbWluaXRpYWxhcmFiaWMiLAogIDB4ZmNkMiwKICAibm9vbmplZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzRiLAogICJub29ubWVkaWFsYXJhYmljIiwKICAweGZlZTgsCiAgIm5vb25tZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2Q1LAogICJub29ubWVlbWlzb2xhdGVkYXJhYmljIiwKICAweGZjNGUsCiAgIm5vb25ub29uZmluYWxhcmFiaWMiLAogIDB4ZmM4ZCwKICAibm90Y29udGFpbnMiLAogIDB4MjIwYywKICAibm90ZWxlbWVudCIsCiAgMHgyMjA5LAogICJub3RlbGVtZW50b2YiLAogIDB4MjIwOSwKICAibm90ZXF1YWwiLAogIDB4MjI2MCwKICAibm90Z3JlYXRlciIsCiAgMHgyMjZmLAogICJub3RncmVhdGVybm9yZXF1YWwiLAogIDB4MjI3MSwKICAibm90Z3JlYXRlcm5vcmxlc3MiLAogIDB4MjI3OSwKICAibm90aWRlbnRpY2FsIiwKICAweDIyNjIsCiAgIm5vdGxlc3MiLAogIDB4MjI2ZSwKICAibm90bGVzc25vcmVxdWFsIiwKICAweDIyNzAsCiAgIm5vdHBhcmFsbGVsIiwKICAweDIyMjYsCiAgIm5vdHByZWNlZGVzIiwKICAweDIyODAsCiAgIm5vdHN1YnNldCIsCiAgMHgyMjg0LAogICJub3RzdWNjZWVkcyIsCiAgMHgyMjgxLAogICJub3RzdXBlcnNldCIsCiAgMHgyMjg1LAogICJub3dhcm1lbmlhbiIsCiAgMHgwNTc2LAogICJucGFyZW4iLAogIDB4MjRhOSwKICAibnNzcXVhcmUiLAogIDB4MzNiMSwKICAibnN1cGVyaW9yIiwKICAweDIwN2YsCiAgIm50aWxkZSIsCiAgMHgwMGYxLAogICJudSIsCiAgMHgwM2JkLAogICJudWhpcmFnYW5hIiwKICAweDMwNmMsCiAgIm51a2F0YWthbmEiLAogIDB4MzBjYywKICAibnVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjg3LAogICJudWt0YWJlbmdhbGkiLAogIDB4MDliYywKICAibnVrdGFkZXZhIiwKICAweDA5M2MsCiAgIm51a3RhZ3VqYXJhdGkiLAogIDB4MGFiYywKICAibnVrdGFndXJtdWtoaSIsCiAgMHgwYTNjLAogICJudW1iZXJzaWduIiwKICAweDAwMjMsCiAgIm51bWJlcnNpZ25tb25vc3BhY2UiLAogIDB4ZmYwMywKICAibnVtYmVyc2lnbnNtYWxsIiwKICAweGZlNWYsCiAgIm51bWVyYWxzaWduZ3JlZWsiLAogIDB4MDM3NCwKICAibnVtZXJhbHNpZ25sb3dlcmdyZWVrIiwKICAweDAzNzUsCiAgIm51bWVybyIsCiAgMHgyMTE2LAogICJudW4iLAogIDB4MDVlMCwKICAibnVuZGFnZXNoIiwKICAweGZiNDAsCiAgIm51bmRhZ2VzaGhlYnJldyIsCiAgMHhmYjQwLAogICJudW5oZWJyZXciLAogIDB4MDVlMCwKICAibnZzcXVhcmUiLAogIDB4MzNiNSwKICAibndzcXVhcmUiLAogIDB4MzNiYiwKICAibnlhYmVuZ2FsaSIsCiAgMHgwOTllLAogICJueWFkZXZhIiwKICAweDA5MWUsCiAgIm55YWd1amFyYXRpIiwKICAweDBhOWUsCiAgIm55YWd1cm11a2hpIiwKICAweDBhMWUsCiAgIm8iLAogIDB4MDA2ZiwKICAib2FjdXRlIiwKICAweDAwZjMsCiAgIm9hbmd0aGFpIiwKICAweDBlMmQsCiAgIm9iYXJyZWQiLAogIDB4MDI3NSwKICAib2JhcnJlZGN5cmlsbGljIiwKICAweDA0ZTksCiAgIm9iYXJyZWRkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZWIsCiAgIm9iZW5nYWxpIiwKICAweDA5OTMsCiAgIm9ib3BvbW9mbyIsCiAgMHgzMTFiLAogICJvYnJldmUiLAogIDB4MDE0ZiwKICAib2NhbmRyYWRldmEiLAogIDB4MDkxMSwKICAib2NhbmRyYWd1amFyYXRpIiwKICAweDBhOTEsCiAgIm9jYW5kcmF2b3dlbHNpZ25kZXZhIiwKICAweDA5NDksCiAgIm9jYW5kcmF2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWM5LAogICJvY2Fyb24iLAogIDB4MDFkMiwKICAib2NpcmNsZSIsCiAgMHgyNGRlLAogICJvY2lyY3VtZmxleCIsCiAgMHgwMGY0LAogICJvY2lyY3VtZmxleGFjdXRlIiwKICAweDFlZDEsCiAgIm9jaXJjdW1mbGV4ZG90YmVsb3ciLAogIDB4MWVkOSwKICAib2NpcmN1bWZsZXhncmF2ZSIsCiAgMHgxZWQzLAogICJvY2lyY3VtZmxleGhvb2thYm92ZSIsCiAgMHgxZWQ1LAogICJvY2lyY3VtZmxleHRpbGRlIiwKICAweDFlZDcsCiAgIm9jeXJpbGxpYyIsCiAgMHgwNDNlLAogICJvZGJsYWN1dGUiLAogIDB4MDE1MSwKICAib2RibGdyYXZlIiwKICAweDAyMGQsCiAgIm9kZXZhIiwKICAweDA5MTMsCiAgIm9kaWVyZXNpcyIsCiAgMHgwMGY2LAogICJvZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGU3LAogICJvZG90YmVsb3ciLAogIDB4MWVjZCwKICAib2UiLAogIDB4MDE1MywKICAib2Vrb3JlYW4iLAogIDB4MzE1YSwKICAib2dvbmVrIiwKICAweDAyZGIsCiAgIm9nb25la2NtYiIsCiAgMHgwMzI4LAogICJvZ3JhdmUiLAogIDB4MDBmMiwKICAib2d1amFyYXRpIiwKICAweDBhOTMsCiAgIm9oYXJtZW5pYW4iLAogIDB4MDU4NSwKICAib2hpcmFnYW5hIiwKICAweDMwNGEsCiAgIm9ob29rYWJvdmUiLAogIDB4MWVjZiwKICAib2hvcm4iLAogIDB4MDFhMSwKICAib2hvcm5hY3V0ZSIsCiAgMHgxZWRiLAogICJvaG9ybmRvdGJlbG93IiwKICAweDFlZTMsCiAgIm9ob3JuZ3JhdmUiLAogIDB4MWVkZCwKICAib2hvcm5ob29rYWJvdmUiLAogIDB4MWVkZiwKICAib2hvcm50aWxkZSIsCiAgMHgxZWUxLAogICJvaHVuZ2FydW1sYXV0IiwKICAweDAxNTEsCiAgIm9pIiwKICAweDAxYTMsCiAgIm9pbnZlcnRlZGJyZXZlIiwKICAweDAyMGYsCiAgIm9rYXRha2FuYSIsCiAgMHgzMGFhLAogICJva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3NSwKICAib2tvcmVhbiIsCiAgMHgzMTU3LAogICJvbGVoZWJyZXciLAogIDB4MDVhYiwKICAib21hY3JvbiIsCiAgMHgwMTRkLAogICJvbWFjcm9uYWN1dGUiLAogIDB4MWU1MywKICAib21hY3JvbmdyYXZlIiwKICAweDFlNTEsCiAgIm9tZGV2YSIsCiAgMHgwOTUwLAogICJvbWVnYSIsCiAgMHgwM2M5LAogICJvbWVnYTEiLAogIDB4MDNkNiwKICAib21lZ2FjeXJpbGxpYyIsCiAgMHgwNDYxLAogICJvbWVnYWxhdGluY2xvc2VkIiwKICAweDAyNzcsCiAgIm9tZWdhcm91bmRjeXJpbGxpYyIsCiAgMHgwNDdiLAogICJvbWVnYXRpdGxvY3lyaWxsaWMiLAogIDB4MDQ3ZCwKICAib21lZ2F0b25vcyIsCiAgMHgwM2NlLAogICJvbWd1amFyYXRpIiwKICAweDBhZDAsCiAgIm9taWNyb24iLAogIDB4MDNiZiwKICAib21pY3JvbnRvbm9zIiwKICAweDAzY2MsCiAgIm9tb25vc3BhY2UiLAogIDB4ZmY0ZiwKICAib25lIiwKICAweDAwMzEsCiAgIm9uZWFyYWJpYyIsCiAgMHgwNjYxLAogICJvbmViZW5nYWxpIiwKICAweDA5ZTcsCiAgIm9uZWNpcmNsZSIsCiAgMHgyNDYwLAogICJvbmVjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OGEsCiAgIm9uZWRldmEiLAogIDB4MDk2NywKICAib25lZG90ZW5sZWFkZXIiLAogIDB4MjAyNCwKICAib25lZWlnaHRoIiwKICAweDIxNWIsCiAgIm9uZWZpdHRlZCIsCiAgMHhmNmRjLAogICJvbmVndWphcmF0aSIsCiAgMHgwYWU3LAogICJvbmVndXJtdWtoaSIsCiAgMHgwYTY3LAogICJvbmVoYWNrYXJhYmljIiwKICAweDA2NjEsCiAgIm9uZWhhbGYiLAogIDB4MDBiZCwKICAib25laGFuZ3pob3UiLAogIDB4MzAyMSwKICAib25laWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjIwLAogICJvbmVpbmZlcmlvciIsCiAgMHgyMDgxLAogICJvbmVtb25vc3BhY2UiLAogIDB4ZmYxMSwKICAib25lbnVtZXJhdG9yYmVuZ2FsaSIsCiAgMHgwOWY0LAogICJvbmVvbGRzdHlsZSIsCiAgMHhmNzMxLAogICJvbmVwYXJlbiIsCiAgMHgyNDc0LAogICJvbmVwZXJpb2QiLAogIDB4MjQ4OCwKICAib25lcGVyc2lhbiIsCiAgMHgwNmYxLAogICJvbmVxdWFydGVyIiwKICAweDAwYmMsCiAgIm9uZXJvbWFuIiwKICAweDIxNzAsCiAgIm9uZXN1cGVyaW9yIiwKICAweDAwYjksCiAgIm9uZXRoYWkiLAogIDB4MGU1MSwKICAib25ldGhpcmQiLAogIDB4MjE1MywKICAib29nb25layIsCiAgMHgwMWViLAogICJvb2dvbmVrbWFjcm9uIiwKICAweDAxZWQsCiAgIm9vZ3VybXVraGkiLAogIDB4MGExMywKICAib29tYXRyYWd1cm11a2hpIiwKICAweDBhNGIsCiAgIm9vcGVuIiwKICAweDAyNTQsCiAgIm9wYXJlbiIsCiAgMHgyNGFhLAogICJvcGVuYnVsbGV0IiwKICAweDI1ZTYsCiAgIm9wdGlvbiIsCiAgMHgyMzI1LAogICJvcmRmZW1pbmluZSIsCiAgMHgwMGFhLAogICJvcmRtYXNjdWxpbmUiLAogIDB4MDBiYSwKICAib3J0aG9nb25hbCIsCiAgMHgyMjFmLAogICJvc2hvcnRkZXZhIiwKICAweDA5MTIsCiAgIm9zaG9ydHZvd2Vsc2lnbmRldmEiLAogIDB4MDk0YSwKICAib3NsYXNoIiwKICAweDAwZjgsCiAgIm9zbGFzaGFjdXRlIiwKICAweDAxZmYsCiAgIm9zbWFsbGhpcmFnYW5hIiwKICAweDMwNDksCiAgIm9zbWFsbGthdGFrYW5hIiwKICAweDMwYTksCiAgIm9zbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmIsCiAgIm9zdHJva2VhY3V0ZSIsCiAgMHgwMWZmLAogICJvc3VwZXJpb3IiLAogIDB4ZjZmMCwKICAib3RjeXJpbGxpYyIsCiAgMHgwNDdmLAogICJvdGlsZGUiLAogIDB4MDBmNSwKICAib3RpbGRlYWN1dGUiLAogIDB4MWU0ZCwKICAib3RpbGRlZGllcmVzaXMiLAogIDB4MWU0ZiwKICAib3Vib3BvbW9mbyIsCiAgMHgzMTIxLAogICJvdmVybGluZSIsCiAgMHgyMDNlLAogICJvdmVybGluZWNlbnRlcmxpbmUiLAogIDB4ZmU0YSwKICAib3ZlcmxpbmVjbWIiLAogIDB4MDMwNSwKICAib3ZlcmxpbmVkYXNoZWQiLAogIDB4ZmU0OSwKICAib3ZlcmxpbmVkYmx3YXZ5IiwKICAweGZlNGMsCiAgIm92ZXJsaW5ld2F2eSIsCiAgMHhmZTRiLAogICJvdmVyc2NvcmUiLAogIDB4MDBhZiwKICAib3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljYiwKICAib3Zvd2Vsc2lnbmRldmEiLAogIDB4MDk0YiwKICAib3Zvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhY2IsCiAgInAiLAogIDB4MDA3MCwKICAicGFhbXBzc3F1YXJlIiwKICAweDMzODAsCiAgInBhYXNlbnRvc3F1YXJlIiwKICAweDMzMmIsCiAgInBhYmVuZ2FsaSIsCiAgMHgwOWFhLAogICJwYWN1dGUiLAogIDB4MWU1NSwKICAicGFkZXZhIiwKICAweDA5MmEsCiAgInBhZ2Vkb3duIiwKICAweDIxZGYsCiAgInBhZ2V1cCIsCiAgMHgyMWRlLAogICJwYWd1amFyYXRpIiwKICAweDBhYWEsCiAgInBhZ3VybXVraGkiLAogIDB4MGEyYSwKICAicGFoaXJhZ2FuYSIsCiAgMHgzMDcxLAogICJwYWl5YW5ub2l0aGFpIiwKICAweDBlMmYsCiAgInBha2F0YWthbmEiLAogIDB4MzBkMSwKICAicGFsYXRhbGl6YXRpb25jeXJpbGxpY2NtYiIsCiAgMHgwNDg0LAogICJwYWxvY2hrYWN5cmlsbGljIiwKICAweDA0YzAsCiAgInBhbnNpb3Nrb3JlYW4iLAogIDB4MzE3ZiwKICAicGFyYWdyYXBoIiwKICAweDAwYjYsCiAgInBhcmFsbGVsIiwKICAweDIyMjUsCiAgInBhcmVubGVmdCIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRhbHRvbmVhcmFiaWMiLAogIDB4ZmQzZSwKICAicGFyZW5sZWZ0YnQiLAogIDB4ZjhlZCwKICAicGFyZW5sZWZ0ZXgiLAogIDB4ZjhlYywKICAicGFyZW5sZWZ0aW5mZXJpb3IiLAogIDB4MjA4ZCwKICAicGFyZW5sZWZ0bW9ub3NwYWNlIiwKICAweGZmMDgsCiAgInBhcmVubGVmdHNtYWxsIiwKICAweGZlNTksCiAgInBhcmVubGVmdHN1cGVyaW9yIiwKICAweDIwN2QsCiAgInBhcmVubGVmdHRwIiwKICAweGY4ZWIsCiAgInBhcmVubGVmdHZlcnRpY2FsIiwKICAweGZlMzUsCiAgInBhcmVucmlnaHQiLAogIDB4MDAyOSwKICAicGFyZW5yaWdodGFsdG9uZWFyYWJpYyIsCiAgMHhmZDNmLAogICJwYXJlbnJpZ2h0YnQiLAogIDB4ZjhmOCwKICAicGFyZW5yaWdodGV4IiwKICAweGY4ZjcsCiAgInBhcmVucmlnaHRpbmZlcmlvciIsCiAgMHgyMDhlLAogICJwYXJlbnJpZ2h0bW9ub3NwYWNlIiwKICAweGZmMDksCiAgInBhcmVucmlnaHRzbWFsbCIsCiAgMHhmZTVhLAogICJwYXJlbnJpZ2h0c3VwZXJpb3IiLAogIDB4MjA3ZSwKICAicGFyZW5yaWdodHRwIiwKICAweGY4ZjYsCiAgInBhcmVucmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTM2LAogICJwYXJ0aWFsZGlmZiIsCiAgMHgyMjAyLAogICJwYXNlcWhlYnJldyIsCiAgMHgwNWMwLAogICJwYXNodGFoZWJyZXciLAogIDB4MDU5OSwKICAicGFzcXVhcmUiLAogIDB4MzNhOSwKICAicGF0YWgiLAogIDB4MDViNywKICAicGF0YWgxMSIsCiAgMHgwNWI3LAogICJwYXRhaDFkIiwKICAweDA1YjcsCiAgInBhdGFoMmEiLAogIDB4MDViNywKICAicGF0YWhoZWJyZXciLAogIDB4MDViNywKICAicGF0YWhuYXJyb3doZWJyZXciLAogIDB4MDViNywKICAicGF0YWhxdWFydGVyaGVicmV3IiwKICAweDA1YjcsCiAgInBhdGFod2lkZWhlYnJldyIsCiAgMHgwNWI3LAogICJwYXplcmhlYnJldyIsCiAgMHgwNWExLAogICJwYm9wb21vZm8iLAogIDB4MzEwNiwKICAicGNpcmNsZSIsCiAgMHgyNGRmLAogICJwZG90YWNjZW50IiwKICAweDFlNTcsCiAgInBlIiwKICAweDA1ZTQsCiAgInBlY3lyaWxsaWMiLAogIDB4MDQzZiwKICAicGVkYWdlc2giLAogIDB4ZmI0NCwKICAicGVkYWdlc2hoZWJyZXciLAogIDB4ZmI0NCwKICAicGVlemlzcXVhcmUiLAogIDB4MzMzYiwKICAicGVmaW5hbGRhZ2VzaGhlYnJldyIsCiAgMHhmYjQzLAogICJwZWhhcmFiaWMiLAogIDB4MDY3ZSwKICAicGVoYXJtZW5pYW4iLAogIDB4MDU3YSwKICAicGVoZWJyZXciLAogIDB4MDVlNCwKICAicGVoZmluYWxhcmFiaWMiLAogIDB4ZmI1NywKICAicGVoaW5pdGlhbGFyYWJpYyIsCiAgMHhmYjU4LAogICJwZWhpcmFnYW5hIiwKICAweDMwN2EsCiAgInBlaG1lZGlhbGFyYWJpYyIsCiAgMHhmYjU5LAogICJwZWthdGFrYW5hIiwKICAweDMwZGEsCiAgInBlbWlkZGxlaG9va2N5cmlsbGljIiwKICAweDA0YTcsCiAgInBlcmFmZWhlYnJldyIsCiAgMHhmYjRlLAogICJwZXJjZW50IiwKICAweDAwMjUsCiAgInBlcmNlbnRhcmFiaWMiLAogIDB4MDY2YSwKICAicGVyY2VudG1vbm9zcGFjZSIsCiAgMHhmZjA1LAogICJwZXJjZW50c21hbGwiLAogIDB4ZmU2YSwKICAicGVyaW9kIiwKICAweDAwMmUsCiAgInBlcmlvZGFybWVuaWFuIiwKICAweDA1ODksCiAgInBlcmlvZGNlbnRlcmVkIiwKICAweDAwYjcsCiAgInBlcmlvZGhhbGZ3aWR0aCIsCiAgMHhmZjYxLAogICJwZXJpb2RpbmZlcmlvciIsCiAgMHhmNmU3LAogICJwZXJpb2Rtb25vc3BhY2UiLAogIDB4ZmYwZSwKICAicGVyaW9kc21hbGwiLAogIDB4ZmU1MiwKICAicGVyaW9kc3VwZXJpb3IiLAogIDB4ZjZlOCwKICAicGVyaXNwb21lbmlncmVla2NtYiIsCiAgMHgwMzQyLAogICJwZXJwZW5kaWN1bGFyIiwKICAweDIyYTUsCiAgInBlcnRob3VzYW5kIiwKICAweDIwMzAsCiAgInBlc2V0YSIsCiAgMHgyMGE3LAogICJwZnNxdWFyZSIsCiAgMHgzMzhhLAogICJwaGFiZW5nYWxpIiwKICAweDA5YWIsCiAgInBoYWRldmEiLAogIDB4MDkyYiwKICAicGhhZ3VqYXJhdGkiLAogIDB4MGFhYiwKICAicGhhZ3VybXVraGkiLAogIDB4MGEyYiwKICAicGhpIiwKICAweDAzYzYsCiAgInBoaTEiLAogIDB4MDNkNSwKICAicGhpZXVwaGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3YSwKICAicGhpZXVwaGFwYXJlbmtvcmVhbiIsCiAgMHgzMjFhLAogICJwaGlldXBoY2lyY2xla29yZWFuIiwKICAweDMyNmMsCiAgInBoaWV1cGhrb3JlYW4iLAogIDB4MzE0ZCwKICAicGhpZXVwaHBhcmVua29yZWFuIiwKICAweDMyMGMsCiAgInBoaWxhdGluIiwKICAweDAyNzgsCiAgInBoaW50aHV0aGFpIiwKICAweDBlM2EsCiAgInBoaXN5bWJvbGdyZWVrIiwKICAweDAzZDUsCiAgInBob29rIiwKICAweDAxYTUsCiAgInBob3BoYW50aGFpIiwKICAweDBlMWUsCiAgInBob3BodW5ndGhhaSIsCiAgMHgwZTFjLAogICJwaG9zYW1waGFvdGhhaSIsCiAgMHgwZTIwLAogICJwaSIsCiAgMHgwM2MwLAogICJwaWV1cGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3MywKICAicGlldXBhcGFyZW5rb3JlYW4iLAogIDB4MzIxMywKICAicGlldXBjaWV1Y2tvcmVhbiIsCiAgMHgzMTc2LAogICJwaWV1cGNpcmNsZWtvcmVhbiIsCiAgMHgzMjY1LAogICJwaWV1cGtpeWVva2tvcmVhbiIsCiAgMHgzMTcyLAogICJwaWV1cGtvcmVhbiIsCiAgMHgzMTQyLAogICJwaWV1cHBhcmVua29yZWFuIiwKICAweDMyMDUsCiAgInBpZXVwc2lvc2tpeWVva2tvcmVhbiIsCiAgMHgzMTc0LAogICJwaWV1cHNpb3Nrb3JlYW4iLAogIDB4MzE0NCwKICAicGlldXBzaW9zdGlrZXV0a29yZWFuIiwKICAweDMxNzUsCiAgInBpZXVwdGhpZXV0aGtvcmVhbiIsCiAgMHgzMTc3LAogICJwaWV1cHRpa2V1dGtvcmVhbiIsCiAgMHgzMTczLAogICJwaWhpcmFnYW5hIiwKICAweDMwNzQsCiAgInBpa2F0YWthbmEiLAogIDB4MzBkNCwKICAicGlzeW1ib2xncmVlayIsCiAgMHgwM2Q2LAogICJwaXdyYXJtZW5pYW4iLAogIDB4MDU4MywKICAicGx1cyIsCiAgMHgwMDJiLAogICJwbHVzYmVsb3djbWIiLAogIDB4MDMxZiwKICAicGx1c2NpcmNsZSIsCiAgMHgyMjk1LAogICJwbHVzbWludXMiLAogIDB4MDBiMSwKICAicGx1c21vZCIsCiAgMHgwMmQ2LAogICJwbHVzbW9ub3NwYWNlIiwKICAweGZmMGIsCiAgInBsdXNzbWFsbCIsCiAgMHhmZTYyLAogICJwbHVzc3VwZXJpb3IiLAogIDB4MjA3YSwKICAicG1vbm9zcGFjZSIsCiAgMHhmZjUwLAogICJwbXNxdWFyZSIsCiAgMHgzM2Q4LAogICJwb2hpcmFnYW5hIiwKICAweDMwN2QsCiAgInBvaW50aW5naW5kZXhkb3dud2hpdGUiLAogIDB4MjYxZiwKICAicG9pbnRpbmdpbmRleGxlZnR3aGl0ZSIsCiAgMHgyNjFjLAogICJwb2ludGluZ2luZGV4cmlnaHR3aGl0ZSIsCiAgMHgyNjFlLAogICJwb2ludGluZ2luZGV4dXB3aGl0ZSIsCiAgMHgyNjFkLAogICJwb2thdGFrYW5hIiwKICAweDMwZGQsCiAgInBvcGxhdGhhaSIsCiAgMHgwZTFiLAogICJwb3N0YWxtYXJrIiwKICAweDMwMTIsCiAgInBvc3RhbG1hcmtmYWNlIiwKICAweDMwMjAsCiAgInBwYXJlbiIsCiAgMHgyNGFiLAogICJwcmVjZWRlcyIsCiAgMHgyMjdhLAogICJwcmVzY3JpcHRpb24iLAogIDB4MjExZSwKICAicHJpbWVtb2QiLAogIDB4MDJiOSwKICAicHJpbWVyZXZlcnNlZCIsCiAgMHgyMDM1LAogICJwcm9kdWN0IiwKICAweDIyMGYsCiAgInByb2plY3RpdmUiLAogIDB4MjMwNSwKICAicHJvbG9uZ2Vka2FuYSIsCiAgMHgzMGZjLAogICJwcm9wZWxsb3IiLAogIDB4MjMxOCwKICAicHJvcGVyc3Vic2V0IiwKICAweDIyODIsCiAgInByb3BlcnN1cGVyc2V0IiwKICAweDIyODMsCiAgInByb3BvcnRpb24iLAogIDB4MjIzNywKICAicHJvcG9ydGlvbmFsIiwKICAweDIyMWQsCiAgInBzaSIsCiAgMHgwM2M4LAogICJwc2ljeXJpbGxpYyIsCiAgMHgwNDcxLAogICJwc2lsaXBuZXVtYXRhY3lyaWxsaWNjbWIiLAogIDB4MDQ4NiwKICAicHNzcXVhcmUiLAogIDB4MzNiMCwKICAicHVoaXJhZ2FuYSIsCiAgMHgzMDc3LAogICJwdWthdGFrYW5hIiwKICAweDMwZDcsCiAgInB2c3F1YXJlIiwKICAweDMzYjQsCiAgInB3c3F1YXJlIiwKICAweDMzYmEsCiAgInEiLAogIDB4MDA3MSwKICAicWFkZXZhIiwKICAweDA5NTgsCiAgInFhZG1haGVicmV3IiwKICAweDA1YTgsCiAgInFhZmFyYWJpYyIsCiAgMHgwNjQyLAogICJxYWZmaW5hbGFyYWJpYyIsCiAgMHhmZWQ2LAogICJxYWZpbml0aWFsYXJhYmljIiwKICAweGZlZDcsCiAgInFhZm1lZGlhbGFyYWJpYyIsCiAgMHhmZWQ4LAogICJxYW1hdHMiLAogIDB4MDViOCwKICAicWFtYXRzMTAiLAogIDB4MDViOCwKICAicWFtYXRzMWEiLAogIDB4MDViOCwKICAicWFtYXRzMWMiLAogIDB4MDViOCwKICAicWFtYXRzMjciLAogIDB4MDViOCwKICAicWFtYXRzMjkiLAogIDB4MDViOCwKICAicWFtYXRzMzMiLAogIDB4MDViOCwKICAicWFtYXRzZGUiLAogIDB4MDViOCwKICAicWFtYXRzaGVicmV3IiwKICAweDA1YjgsCiAgInFhbWF0c25hcnJvd2hlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbmhlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbm5hcnJvd2hlYnJldyIsCiAgMHgwNWI4LAogICJxYW1hdHNxYXRhbnF1YXJ0ZXJoZWJyZXciLAogIDB4MDViOCwKICAicWFtYXRzcWF0YW53aWRlaGVicmV3IiwKICAweDA1YjgsCiAgInFhbWF0c3F1YXJ0ZXJoZWJyZXciLAogIDB4MDViOCwKICAicWFtYXRzd2lkZWhlYnJldyIsCiAgMHgwNWI4LAogICJxYXJuZXlwYXJhaGVicmV3IiwKICAweDA1OWYsCiAgInFib3BvbW9mbyIsCiAgMHgzMTExLAogICJxY2lyY2xlIiwKICAweDI0ZTAsCiAgInFob29rIiwKICAweDAyYTAsCiAgInFtb25vc3BhY2UiLAogIDB4ZmY1MSwKICAicW9mIiwKICAweDA1ZTcsCiAgInFvZmRhZ2VzaCIsCiAgMHhmYjQ3LAogICJxb2ZkYWdlc2hoZWJyZXciLAogIDB4ZmI0NywKICAicW9maGVicmV3IiwKICAweDA1ZTcsCiAgInFwYXJlbiIsCiAgMHgyNGFjLAogICJxdWFydGVybm90ZSIsCiAgMHgyNjY5LAogICJxdWJ1dHMiLAogIDB4MDViYiwKICAicXVidXRzMTgiLAogIDB4MDViYiwKICAicXVidXRzMjUiLAogIDB4MDViYiwKICAicXVidXRzMzEiLAogIDB4MDViYiwKICAicXVidXRzaGVicmV3IiwKICAweDA1YmIsCiAgInF1YnV0c25hcnJvd2hlYnJldyIsCiAgMHgwNWJiLAogICJxdWJ1dHNxdWFydGVyaGVicmV3IiwKICAweDA1YmIsCiAgInF1YnV0c3dpZGVoZWJyZXciLAogIDB4MDViYiwKICAicXVlc3Rpb24iLAogIDB4MDAzZiwKICAicXVlc3Rpb25hcmFiaWMiLAogIDB4MDYxZiwKICAicXVlc3Rpb25hcm1lbmlhbiIsCiAgMHgwNTVlLAogICJxdWVzdGlvbmRvd24iLAogIDB4MDBiZiwKICAicXVlc3Rpb25kb3duc21hbGwiLAogIDB4ZjdiZiwKICAicXVlc3Rpb25ncmVlayIsCiAgMHgwMzdlLAogICJxdWVzdGlvbm1vbm9zcGFjZSIsCiAgMHhmZjFmLAogICJxdWVzdGlvbnNtYWxsIiwKICAweGY3M2YsCiAgInF1b3RlZGJsIiwKICAweDAwMjIsCiAgInF1b3RlZGJsYmFzZSIsCiAgMHgyMDFlLAogICJxdW90ZWRibGxlZnQiLAogIDB4MjAxYywKICAicXVvdGVkYmxtb25vc3BhY2UiLAogIDB4ZmYwMiwKICAicXVvdGVkYmxwcmltZSIsCiAgMHgzMDFlLAogICJxdW90ZWRibHByaW1lcmV2ZXJzZWQiLAogIDB4MzAxZCwKICAicXVvdGVkYmxyaWdodCIsCiAgMHgyMDFkLAogICJxdW90ZWxlZnQiLAogIDB4MjAxOCwKICAicXVvdGVsZWZ0cmV2ZXJzZWQiLAogIDB4MjAxYiwKICAicXVvdGVyZXZlcnNlZCIsCiAgMHgyMDFiLAogICJxdW90ZXJpZ2h0IiwKICAweDIwMTksCiAgInF1b3RlcmlnaHRuIiwKICAweDAxNDksCiAgInF1b3Rlc2luZ2xiYXNlIiwKICAweDIwMWEsCiAgInF1b3Rlc2luZ2xlIiwKICAweDAwMjcsCiAgInF1b3Rlc2luZ2xlbW9ub3NwYWNlIiwKICAweGZmMDcsCiAgInIiLAogIDB4MDA3MiwKICAicmFhcm1lbmlhbiIsCiAgMHgwNTdjLAogICJyYWJlbmdhbGkiLAogIDB4MDliMCwKICAicmFjdXRlIiwKICAweDAxNTUsCiAgInJhZGV2YSIsCiAgMHgwOTMwLAogICJyYWRpY2FsIiwKICAweDIyMWEsCiAgInJhZGljYWxleCIsCiAgMHhmOGU1LAogICJyYWRvdmVyc3NxdWFyZSIsCiAgMHgzM2FlLAogICJyYWRvdmVyc3NxdWFyZWRzcXVhcmUiLAogIDB4MzNhZiwKICAicmFkc3F1YXJlIiwKICAweDMzYWQsCiAgInJhZmUiLAogIDB4MDViZiwKICAicmFmZWhlYnJldyIsCiAgMHgwNWJmLAogICJyYWd1amFyYXRpIiwKICAweDBhYjAsCiAgInJhZ3VybXVraGkiLAogIDB4MGEzMCwKICAicmFoaXJhZ2FuYSIsCiAgMHgzMDg5LAogICJyYWthdGFrYW5hIiwKICAweDMwZTksCiAgInJha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NywKICAicmFsb3dlcmRpYWdvbmFsYmVuZ2FsaSIsCiAgMHgwOWYxLAogICJyYW1pZGRsZWRpYWdvbmFsYmVuZ2FsaSIsCiAgMHgwOWYwLAogICJyYW1zaG9ybiIsCiAgMHgwMjY0LAogICJyYXRpbyIsCiAgMHgyMjM2LAogICJyYm9wb21vZm8iLAogIDB4MzExNiwKICAicmNhcm9uIiwKICAweDAxNTksCiAgInJjZWRpbGxhIiwKICAweDAxNTcsCiAgInJjaXJjbGUiLAogIDB4MjRlMSwKICAicmNvbW1hYWNjZW50IiwKICAweDAxNTcsCiAgInJkYmxncmF2ZSIsCiAgMHgwMjExLAogICJyZG90YWNjZW50IiwKICAweDFlNTksCiAgInJkb3RiZWxvdyIsCiAgMHgxZTViLAogICJyZG90YmVsb3dtYWNyb24iLAogIDB4MWU1ZCwKICAicmVmZXJlbmNlbWFyayIsCiAgMHgyMDNiLAogICJyZWZsZXhzdWJzZXQiLAogIDB4MjI4NiwKICAicmVmbGV4c3VwZXJzZXQiLAogIDB4MjI4NywKICAicmVnaXN0ZXJlZCIsCiAgMHgwMGFlLAogICJyZWdpc3RlcnNhbnMiLAogIDB4ZjhlOCwKICAicmVnaXN0ZXJzZXJpZiIsCiAgMHhmNmRhLAogICJyZWhhcmFiaWMiLAogIDB4MDYzMSwKICAicmVoYXJtZW5pYW4iLAogIDB4MDU4MCwKICAicmVoZmluYWxhcmFiaWMiLAogIDB4ZmVhZSwKICAicmVoaXJhZ2FuYSIsCiAgMHgzMDhjLAogICJyZWthdGFrYW5hIiwKICAweDMwZWMsCiAgInJla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YSwKICAicmVzaCIsCiAgMHgwNWU4LAogICJyZXNoZGFnZXNoaGVicmV3IiwKICAweGZiNDgsCiAgInJlc2hoZWJyZXciLAogIDB4MDVlOCwKICAicmV2ZXJzZWR0aWxkZSIsCiAgMHgyMjNkLAogICJyZXZpYWhlYnJldyIsCiAgMHgwNTk3LAogICJyZXZpYW11Z3Jhc2hoZWJyZXciLAogIDB4MDU5NywKICAicmV2bG9naWNhbG5vdCIsCiAgMHgyMzEwLAogICJyZmlzaGhvb2siLAogIDB4MDI3ZSwKICAicmZpc2hob29rcmV2ZXJzZWQiLAogIDB4MDI3ZiwKICAicmhhYmVuZ2FsaSIsCiAgMHgwOWRkLAogICJyaGFkZXZhIiwKICAweDA5NWQsCiAgInJobyIsCiAgMHgwM2MxLAogICJyaG9vayIsCiAgMHgwMjdkLAogICJyaG9va3R1cm5lZCIsCiAgMHgwMjdiLAogICJyaG9va3R1cm5lZHN1cGVyaW9yIiwKICAweDAyYjUsCiAgInJob3N5bWJvbGdyZWVrIiwKICAweDAzZjEsCiAgInJob3RpY2hvb2ttb2QiLAogIDB4MDJkZSwKICAicmlldWxhY2lyY2xla29yZWFuIiwKICAweDMyNzEsCiAgInJpZXVsYXBhcmVua29yZWFuIiwKICAweDMyMTEsCiAgInJpZXVsY2lyY2xla29yZWFuIiwKICAweDMyNjMsCiAgInJpZXVsaGlldWhrb3JlYW4iLAogIDB4MzE0MCwKICAicmlldWxraXllb2trb3JlYW4iLAogIDB4MzEzYSwKICAicmlldWxraXllb2tzaW9za29yZWFuIiwKICAweDMxNjksCiAgInJpZXVsa29yZWFuIiwKICAweDMxMzksCiAgInJpZXVsbWlldW1rb3JlYW4iLAogIDB4MzEzYiwKICAicmlldWxwYW5zaW9za29yZWFuIiwKICAweDMxNmMsCiAgInJpZXVscGFyZW5rb3JlYW4iLAogIDB4MzIwMywKICAicmlldWxwaGlldXBoa29yZWFuIiwKICAweDMxM2YsCiAgInJpZXVscGlldXBrb3JlYW4iLAogIDB4MzEzYywKICAicmlldWxwaWV1cHNpb3Nrb3JlYW4iLAogIDB4MzE2YiwKICAicmlldWxzaW9za29yZWFuIiwKICAweDMxM2QsCiAgInJpZXVsdGhpZXV0aGtvcmVhbiIsCiAgMHgzMTNlLAogICJyaWV1bHRpa2V1dGtvcmVhbiIsCiAgMHgzMTZhLAogICJyaWV1bHllb3JpbmhpZXVoa29yZWFuIiwKICAweDMxNmQsCiAgInJpZ2h0YW5nbGUiLAogIDB4MjIxZiwKICAicmlnaHR0YWNrYmVsb3djbWIiLAogIDB4MDMxOSwKICAicmlnaHR0cmlhbmdsZSIsCiAgMHgyMmJmLAogICJyaWhpcmFnYW5hIiwKICAweDMwOGEsCiAgInJpa2F0YWthbmEiLAogIDB4MzBlYSwKICAicmlrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjk4LAogICJyaW5nIiwKICAweDAyZGEsCiAgInJpbmdiZWxvd2NtYiIsCiAgMHgwMzI1LAogICJyaW5nY21iIiwKICAweDAzMGEsCiAgInJpbmdoYWxmbGVmdCIsCiAgMHgwMmJmLAogICJyaW5naGFsZmxlZnRhcm1lbmlhbiIsCiAgMHgwNTU5LAogICJyaW5naGFsZmxlZnRiZWxvd2NtYiIsCiAgMHgwMzFjLAogICJyaW5naGFsZmxlZnRjZW50ZXJlZCIsCiAgMHgwMmQzLAogICJyaW5naGFsZnJpZ2h0IiwKICAweDAyYmUsCiAgInJpbmdoYWxmcmlnaHRiZWxvd2NtYiIsCiAgMHgwMzM5LAogICJyaW5naGFsZnJpZ2h0Y2VudGVyZWQiLAogIDB4MDJkMiwKICAicmludmVydGVkYnJldmUiLAogIDB4MDIxMywKICAicml0dG9ydXNxdWFyZSIsCiAgMHgzMzUxLAogICJybGluZWJlbG93IiwKICAweDFlNWYsCiAgInJsb25nbGVnIiwKICAweDAyN2MsCiAgInJsb25nbGVndHVybmVkIiwKICAweDAyN2EsCiAgInJtb25vc3BhY2UiLAogIDB4ZmY1MiwKICAicm9oaXJhZ2FuYSIsCiAgMHgzMDhkLAogICJyb2thdGFrYW5hIiwKICAweDMwZWQsCiAgInJva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YiwKICAicm9ydWF0aGFpIiwKICAweDBlMjMsCiAgInJwYXJlbiIsCiAgMHgyNGFkLAogICJycmFiZW5nYWxpIiwKICAweDA5ZGMsCiAgInJyYWRldmEiLAogIDB4MDkzMSwKICAicnJhZ3VybXVraGkiLAogIDB4MGE1YywKICAicnJlaGFyYWJpYyIsCiAgMHgwNjkxLAogICJycmVoZmluYWxhcmFiaWMiLAogIDB4ZmI4ZCwKICAicnJ2b2NhbGljYmVuZ2FsaSIsCiAgMHgwOWUwLAogICJycnZvY2FsaWNkZXZhIiwKICAweDA5NjAsCiAgInJydm9jYWxpY2d1amFyYXRpIiwKICAweDBhZTAsCiAgInJydm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljNCwKICAicnJ2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQ0LAogICJycnZvY2FsaWN2b3dlbHNpZ25ndWphcmF0aSIsCiAgMHgwYWM0LAogICJyc3VwZXJpb3IiLAogIDB4ZjZmMSwKICAicnRibG9jayIsCiAgMHgyNTkwLAogICJydHVybmVkIiwKICAweDAyNzksCiAgInJ0dXJuZWRzdXBlcmlvciIsCiAgMHgwMmI0LAogICJydWhpcmFnYW5hIiwKICAweDMwOGIsCiAgInJ1a2F0YWthbmEiLAogIDB4MzBlYiwKICAicnVrYXRha2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjk5LAogICJydXBlZW1hcmtiZW5nYWxpIiwKICAweDA5ZjIsCiAgInJ1cGVlc2lnbmJlbmdhbGkiLAogIDB4MDlmMywKICAicnVwaWFoIiwKICAweGY2ZGQsCiAgInJ1dGhhaSIsCiAgMHgwZTI0LAogICJydm9jYWxpY2JlbmdhbGkiLAogIDB4MDk4YiwKICAicnZvY2FsaWNkZXZhIiwKICAweDA5MGIsCiAgInJ2b2NhbGljZ3VqYXJhdGkiLAogIDB4MGE4YiwKICAicnZvY2FsaWN2b3dlbHNpZ25iZW5nYWxpIiwKICAweDA5YzMsCiAgInJ2b2NhbGljdm93ZWxzaWduZGV2YSIsCiAgMHgwOTQzLAogICJydm9jYWxpY3Zvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzMsCiAgInMiLAogIDB4MDA3MywKICAic2FiZW5nYWxpIiwKICAweDA5YjgsCiAgInNhY3V0ZSIsCiAgMHgwMTViLAogICJzYWN1dGVkb3RhY2NlbnQiLAogIDB4MWU2NSwKICAic2FkYXJhYmljIiwKICAweDA2MzUsCiAgInNhZGV2YSIsCiAgMHgwOTM4LAogICJzYWRmaW5hbGFyYWJpYyIsCiAgMHhmZWJhLAogICJzYWRpbml0aWFsYXJhYmljIiwKICAweGZlYmIsCiAgInNhZG1lZGlhbGFyYWJpYyIsCiAgMHhmZWJjLAogICJzYWd1amFyYXRpIiwKICAweDBhYjgsCiAgInNhZ3VybXVraGkiLAogIDB4MGEzOCwKICAic2FoaXJhZ2FuYSIsCiAgMHgzMDU1LAogICJzYWthdGFrYW5hIiwKICAweDMwYjUsCiAgInNha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3YiwKICAic2FsbGFsbGFob3VhbGF5aGV3YXNhbGxhbWFyYWJpYyIsCiAgMHhmZGZhLAogICJzYW1la2giLAogIDB4MDVlMSwKICAic2FtZWtoZGFnZXNoIiwKICAweGZiNDEsCiAgInNhbWVraGRhZ2VzaGhlYnJldyIsCiAgMHhmYjQxLAogICJzYW1la2hoZWJyZXciLAogIDB4MDVlMSwKICAic2FyYWFhdGhhaSIsCiAgMHgwZTMyLAogICJzYXJhYWV0aGFpIiwKICAweDBlNDEsCiAgInNhcmFhaW1haW1hbGFpdGhhaSIsCiAgMHgwZTQ0LAogICJzYXJhYWltYWltdWFudGhhaSIsCiAgMHgwZTQzLAogICJzYXJhYW10aGFpIiwKICAweDBlMzMsCiAgInNhcmFhdGhhaSIsCiAgMHgwZTMwLAogICJzYXJhZXRoYWkiLAogIDB4MGU0MCwKICAic2FyYWlpbGVmdHRoYWkiLAogIDB4Zjg4NiwKICAic2FyYWlpdGhhaSIsCiAgMHgwZTM1LAogICJzYXJhaWxlZnR0aGFpIiwKICAweGY4ODUsCiAgInNhcmFpdGhhaSIsCiAgMHgwZTM0LAogICJzYXJhb3RoYWkiLAogIDB4MGU0MiwKICAic2FyYXVlZWxlZnR0aGFpIiwKICAweGY4ODgsCiAgInNhcmF1ZWV0aGFpIiwKICAweDBlMzcsCiAgInNhcmF1ZWxlZnR0aGFpIiwKICAweGY4ODcsCiAgInNhcmF1ZXRoYWkiLAogIDB4MGUzNiwKICAic2FyYXV0aGFpIiwKICAweDBlMzgsCiAgInNhcmF1dXRoYWkiLAogIDB4MGUzOSwKICAic2JvcG9tb2ZvIiwKICAweDMxMTksCiAgInNjYXJvbiIsCiAgMHgwMTYxLAogICJzY2Fyb25kb3RhY2NlbnQiLAogIDB4MWU2NywKICAic2NlZGlsbGEiLAogIDB4MDE1ZiwKICAic2Nod2EiLAogIDB4MDI1OSwKICAic2Nod2FjeXJpbGxpYyIsCiAgMHgwNGQ5LAogICJzY2h3YWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRkYiwKICAic2Nod2Fob29rIiwKICAweDAyNWEsCiAgInNjaXJjbGUiLAogIDB4MjRlMiwKICAic2NpcmN1bWZsZXgiLAogIDB4MDE1ZCwKICAic2NvbW1hYWNjZW50IiwKICAweDAyMTksCiAgInNkb3RhY2NlbnQiLAogIDB4MWU2MSwKICAic2RvdGJlbG93IiwKICAweDFlNjMsCiAgInNkb3RiZWxvd2RvdGFjY2VudCIsCiAgMHgxZTY5LAogICJzZWFndWxsYmVsb3djbWIiLAogIDB4MDMzYywKICAic2Vjb25kIiwKICAweDIwMzMsCiAgInNlY29uZHRvbmVjaGluZXNlIiwKICAweDAyY2EsCiAgInNlY3Rpb24iLAogIDB4MDBhNywKICAic2VlbmFyYWJpYyIsCiAgMHgwNjMzLAogICJzZWVuZmluYWxhcmFiaWMiLAogIDB4ZmViMiwKICAic2VlbmluaXRpYWxhcmFiaWMiLAogIDB4ZmViMywKICAic2Vlbm1lZGlhbGFyYWJpYyIsCiAgMHhmZWI0LAogICJzZWdvbCIsCiAgMHgwNWI2LAogICJzZWdvbDEzIiwKICAweDA1YjYsCiAgInNlZ29sMWYiLAogIDB4MDViNiwKICAic2Vnb2wyYyIsCiAgMHgwNWI2LAogICJzZWdvbGhlYnJldyIsCiAgMHgwNWI2LAogICJzZWdvbG5hcnJvd2hlYnJldyIsCiAgMHgwNWI2LAogICJzZWdvbHF1YXJ0ZXJoZWJyZXciLAogIDB4MDViNiwKICAic2Vnb2x0YWhlYnJldyIsCiAgMHgwNTkyLAogICJzZWdvbHdpZGVoZWJyZXciLAogIDB4MDViNiwKICAic2VoYXJtZW5pYW4iLAogIDB4MDU3ZCwKICAic2VoaXJhZ2FuYSIsCiAgMHgzMDViLAogICJzZWthdGFrYW5hIiwKICAweDMwYmIsCiAgInNla2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3ZSwKICAic2VtaWNvbG9uIiwKICAweDAwM2IsCiAgInNlbWljb2xvbmFyYWJpYyIsCiAgMHgwNjFiLAogICJzZW1pY29sb25tb25vc3BhY2UiLAogIDB4ZmYxYiwKICAic2VtaWNvbG9uc21hbGwiLAogIDB4ZmU1NCwKICAic2VtaXZvaWNlZG1hcmtrYW5hIiwKICAweDMwOWMsCiAgInNlbWl2b2ljZWRtYXJra2FuYWhhbGZ3aWR0aCIsCiAgMHhmZjlmLAogICJzZW50aXNxdWFyZSIsCiAgMHgzMzIyLAogICJzZW50b3NxdWFyZSIsCiAgMHgzMzIzLAogICJzZXZlbiIsCiAgMHgwMDM3LAogICJzZXZlbmFyYWJpYyIsCiAgMHgwNjY3LAogICJzZXZlbmJlbmdhbGkiLAogIDB4MDllZCwKICAic2V2ZW5jaXJjbGUiLAogIDB4MjQ2NiwKICAic2V2ZW5jaXJjbGVpbnZlcnNlc2Fuc3NlcmlmIiwKICAweDI3OTAsCiAgInNldmVuZGV2YSIsCiAgMHgwOTZkLAogICJzZXZlbmVpZ2h0aHMiLAogIDB4MjE1ZSwKICAic2V2ZW5ndWphcmF0aSIsCiAgMHgwYWVkLAogICJzZXZlbmd1cm11a2hpIiwKICAweDBhNmQsCiAgInNldmVuaGFja2FyYWJpYyIsCiAgMHgwNjY3LAogICJzZXZlbmhhbmd6aG91IiwKICAweDMwMjcsCiAgInNldmVuaWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI2LAogICJzZXZlbmluZmVyaW9yIiwKICAweDIwODcsCiAgInNldmVubW9ub3NwYWNlIiwKICAweGZmMTcsCiAgInNldmVub2xkc3R5bGUiLAogIDB4ZjczNywKICAic2V2ZW5wYXJlbiIsCiAgMHgyNDdhLAogICJzZXZlbnBlcmlvZCIsCiAgMHgyNDhlLAogICJzZXZlbnBlcnNpYW4iLAogIDB4MDZmNywKICAic2V2ZW5yb21hbiIsCiAgMHgyMTc2LAogICJzZXZlbnN1cGVyaW9yIiwKICAweDIwNzcsCiAgInNldmVudGVlbmNpcmNsZSIsCiAgMHgyNDcwLAogICJzZXZlbnRlZW5wYXJlbiIsCiAgMHgyNDg0LAogICJzZXZlbnRlZW5wZXJpb2QiLAogIDB4MjQ5OCwKICAic2V2ZW50aGFpIiwKICAweDBlNTcsCiAgInNmdGh5cGhlbiIsCiAgMHgwMGFkLAogICJzaGFhcm1lbmlhbiIsCiAgMHgwNTc3LAogICJzaGFiZW5nYWxpIiwKICAweDA5YjYsCiAgInNoYWN5cmlsbGljIiwKICAweDA0NDgsCiAgInNoYWRkYWFyYWJpYyIsCiAgMHgwNjUxLAogICJzaGFkZGFkYW1tYWFyYWJpYyIsCiAgMHhmYzYxLAogICJzaGFkZGFkYW1tYXRhbmFyYWJpYyIsCiAgMHhmYzVlLAogICJzaGFkZGFmYXRoYWFyYWJpYyIsCiAgMHhmYzYwLAogICJzaGFkZGFrYXNyYWFyYWJpYyIsCiAgMHhmYzYyLAogICJzaGFkZGFrYXNyYXRhbmFyYWJpYyIsCiAgMHhmYzVmLAogICJzaGFkZSIsCiAgMHgyNTkyLAogICJzaGFkZWRhcmsiLAogIDB4MjU5MywKICAic2hhZGVsaWdodCIsCiAgMHgyNTkxLAogICJzaGFkZW1lZGl1bSIsCiAgMHgyNTkyLAogICJzaGFkZXZhIiwKICAweDA5MzYsCiAgInNoYWd1amFyYXRpIiwKICAweDBhYjYsCiAgInNoYWd1cm11a2hpIiwKICAweDBhMzYsCiAgInNoYWxzaGVsZXRoZWJyZXciLAogIDB4MDU5MywKICAic2hib3BvbW9mbyIsCiAgMHgzMTE1LAogICJzaGNoYWN5cmlsbGljIiwKICAweDA0NDksCiAgInNoZWVuYXJhYmljIiwKICAweDA2MzQsCiAgInNoZWVuZmluYWxhcmFiaWMiLAogIDB4ZmViNiwKICAic2hlZW5pbml0aWFsYXJhYmljIiwKICAweGZlYjcsCiAgInNoZWVubWVkaWFsYXJhYmljIiwKICAweGZlYjgsCiAgInNoZWljb3B0aWMiLAogIDB4MDNlMywKICAic2hlcWVsIiwKICAweDIwYWEsCiAgInNoZXFlbGhlYnJldyIsCiAgMHgyMGFhLAogICJzaGV2YSIsCiAgMHgwNWIwLAogICJzaGV2YTExNSIsCiAgMHgwNWIwLAogICJzaGV2YTE1IiwKICAweDA1YjAsCiAgInNoZXZhMjIiLAogIDB4MDViMCwKICAic2hldmEyZSIsCiAgMHgwNWIwLAogICJzaGV2YWhlYnJldyIsCiAgMHgwNWIwLAogICJzaGV2YW5hcnJvd2hlYnJldyIsCiAgMHgwNWIwLAogICJzaGV2YXF1YXJ0ZXJoZWJyZXciLAogIDB4MDViMCwKICAic2hldmF3aWRlaGVicmV3IiwKICAweDA1YjAsCiAgInNoaGFjeXJpbGxpYyIsCiAgMHgwNGJiLAogICJzaGltYWNvcHRpYyIsCiAgMHgwM2VkLAogICJzaGluIiwKICAweDA1ZTksCiAgInNoaW5kYWdlc2giLAogIDB4ZmI0OSwKICAic2hpbmRhZ2VzaGhlYnJldyIsCiAgMHhmYjQ5LAogICJzaGluZGFnZXNoc2hpbmRvdCIsCiAgMHhmYjJjLAogICJzaGluZGFnZXNoc2hpbmRvdGhlYnJldyIsCiAgMHhmYjJjLAogICJzaGluZGFnZXNoc2luZG90IiwKICAweGZiMmQsCiAgInNoaW5kYWdlc2hzaW5kb3RoZWJyZXciLAogIDB4ZmIyZCwKICAic2hpbmRvdGhlYnJldyIsCiAgMHgwNWMxLAogICJzaGluaGVicmV3IiwKICAweDA1ZTksCiAgInNoaW5zaGluZG90IiwKICAweGZiMmEsCiAgInNoaW5zaGluZG90aGVicmV3IiwKICAweGZiMmEsCiAgInNoaW5zaW5kb3QiLAogIDB4ZmIyYiwKICAic2hpbnNpbmRvdGhlYnJldyIsCiAgMHhmYjJiLAogICJzaG9vayIsCiAgMHgwMjgyLAogICJzaWdtYSIsCiAgMHgwM2MzLAogICJzaWdtYTEiLAogIDB4MDNjMiwKICAic2lnbWFmaW5hbCIsCiAgMHgwM2MyLAogICJzaWdtYWx1bmF0ZXN5bWJvbGdyZWVrIiwKICAweDAzZjIsCiAgInNpaGlyYWdhbmEiLAogIDB4MzA1NywKICAic2lrYXRha2FuYSIsCiAgMHgzMGI3LAogICJzaWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmN2MsCiAgInNpbHVxaGVicmV3IiwKICAweDA1YmQsCiAgInNpbHVxbGVmdGhlYnJldyIsCiAgMHgwNWJkLAogICJzaW1pbGFyIiwKICAweDIyM2MsCiAgInNpbmRvdGhlYnJldyIsCiAgMHgwNWMyLAogICJzaW9zYWNpcmNsZWtvcmVhbiIsCiAgMHgzMjc0LAogICJzaW9zYXBhcmVua29yZWFuIiwKICAweDMyMTQsCiAgInNpb3NjaWV1Y2tvcmVhbiIsCiAgMHgzMTdlLAogICJzaW9zY2lyY2xla29yZWFuIiwKICAweDMyNjYsCiAgInNpb3NraXllb2trb3JlYW4iLAogIDB4MzE3YSwKICAic2lvc2tvcmVhbiIsCiAgMHgzMTQ1LAogICJzaW9zbmlldW5rb3JlYW4iLAogIDB4MzE3YiwKICAic2lvc3BhcmVua29yZWFuIiwKICAweDMyMDYsCiAgInNpb3NwaWV1cGtvcmVhbiIsCiAgMHgzMTdkLAogICJzaW9zdGlrZXV0a29yZWFuIiwKICAweDMxN2MsCiAgInNpeCIsCiAgMHgwMDM2LAogICJzaXhhcmFiaWMiLAogIDB4MDY2NiwKICAic2l4YmVuZ2FsaSIsCiAgMHgwOWVjLAogICJzaXhjaXJjbGUiLAogIDB4MjQ2NSwKICAic2l4Y2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhmLAogICJzaXhkZXZhIiwKICAweDA5NmMsCiAgInNpeGd1amFyYXRpIiwKICAweDBhZWMsCiAgInNpeGd1cm11a2hpIiwKICAweDBhNmMsCiAgInNpeGhhY2thcmFiaWMiLAogIDB4MDY2NiwKICAic2l4aGFuZ3pob3UiLAogIDB4MzAyNiwKICAic2l4aWRlb2dyYXBoaWNwYXJlbiIsCiAgMHgzMjI1LAogICJzaXhpbmZlcmlvciIsCiAgMHgyMDg2LAogICJzaXhtb25vc3BhY2UiLAogIDB4ZmYxNiwKICAic2l4b2xkc3R5bGUiLAogIDB4ZjczNiwKICAic2l4cGFyZW4iLAogIDB4MjQ3OSwKICAic2l4cGVyaW9kIiwKICAweDI0OGQsCiAgInNpeHBlcnNpYW4iLAogIDB4MDZmNiwKICAic2l4cm9tYW4iLAogIDB4MjE3NSwKICAic2l4c3VwZXJpb3IiLAogIDB4MjA3NiwKICAic2l4dGVlbmNpcmNsZSIsCiAgMHgyNDZmLAogICJzaXh0ZWVuY3VycmVuY3lkZW5vbWluYXRvcmJlbmdhbGkiLAogIDB4MDlmOSwKICAic2l4dGVlbnBhcmVuIiwKICAweDI0ODMsCiAgInNpeHRlZW5wZXJpb2QiLAogIDB4MjQ5NywKICAic2l4dGhhaSIsCiAgMHgwZTU2LAogICJzbGFzaCIsCiAgMHgwMDJmLAogICJzbGFzaG1vbm9zcGFjZSIsCiAgMHhmZjBmLAogICJzbG9uZyIsCiAgMHgwMTdmLAogICJzbG9uZ2RvdGFjY2VudCIsCiAgMHgxZTliLAogICJzbWlsZWZhY2UiLAogIDB4MjYzYSwKICAic21vbm9zcGFjZSIsCiAgMHhmZjUzLAogICJzb2ZwYXN1cWhlYnJldyIsCiAgMHgwNWMzLAogICJzb2Z0aHlwaGVuIiwKICAweDAwYWQsCiAgInNvZnRzaWduY3lyaWxsaWMiLAogIDB4MDQ0YywKICAic29oaXJhZ2FuYSIsCiAgMHgzMDVkLAogICJzb2thdGFrYW5hIiwKICAweDMwYmQsCiAgInNva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY3ZiwKICAic29saWR1c2xvbmdvdmVybGF5Y21iIiwKICAweDAzMzgsCiAgInNvbGlkdXNzaG9ydG92ZXJsYXljbWIiLAogIDB4MDMzNywKICAic29ydXNpdGhhaSIsCiAgMHgwZTI5LAogICJzb3NhbGF0aGFpIiwKICAweDBlMjgsCiAgInNvc290aGFpIiwKICAweDBlMGIsCiAgInNvc3VhdGhhaSIsCiAgMHgwZTJhLAogICJzcGFjZSIsCiAgMHgwMDIwLAogICJzcGFjZWhhY2thcmFiaWMiLAogIDB4MDAyMCwKICAic3BhZGUiLAogIDB4MjY2MCwKICAic3BhZGVzdWl0YmxhY2siLAogIDB4MjY2MCwKICAic3BhZGVzdWl0d2hpdGUiLAogIDB4MjY2NCwKICAic3BhcmVuIiwKICAweDI0YWUsCiAgInNxdWFyZWJlbG93Y21iIiwKICAweDAzM2IsCiAgInNxdWFyZWNjIiwKICAweDMzYzQsCiAgInNxdWFyZWNtIiwKICAweDMzOWQsCiAgInNxdWFyZWRpYWdvbmFsY3Jvc3NoYXRjaGZpbGwiLAogIDB4MjVhOSwKICAic3F1YXJlaG9yaXpvbnRhbGZpbGwiLAogIDB4MjVhNCwKICAic3F1YXJla2ciLAogIDB4MzM4ZiwKICAic3F1YXJla20iLAogIDB4MzM5ZSwKICAic3F1YXJla21jYXBpdGFsIiwKICAweDMzY2UsCiAgInNxdWFyZWxuIiwKICAweDMzZDEsCiAgInNxdWFyZWxvZyIsCiAgMHgzM2QyLAogICJzcXVhcmVtZyIsCiAgMHgzMzhlLAogICJzcXVhcmVtaWwiLAogIDB4MzNkNSwKICAic3F1YXJlbW0iLAogIDB4MzM5YywKICAic3F1YXJlbXNxdWFyZWQiLAogIDB4MzNhMSwKICAic3F1YXJlb3J0aG9nb25hbGNyb3NzaGF0Y2hmaWxsIiwKICAweDI1YTYsCiAgInNxdWFyZXVwcGVybGVmdHRvbG93ZXJyaWdodGZpbGwiLAogIDB4MjVhNywKICAic3F1YXJldXBwZXJyaWdodHRvbG93ZXJsZWZ0ZmlsbCIsCiAgMHgyNWE4LAogICJzcXVhcmV2ZXJ0aWNhbGZpbGwiLAogIDB4MjVhNSwKICAic3F1YXJld2hpdGV3aXRoc21hbGxibGFjayIsCiAgMHgyNWEzLAogICJzcnNxdWFyZSIsCiAgMHgzM2RiLAogICJzc2FiZW5nYWxpIiwKICAweDA5YjcsCiAgInNzYWRldmEiLAogIDB4MDkzNywKICAic3NhZ3VqYXJhdGkiLAogIDB4MGFiNywKICAic3NhbmdjaWV1Y2tvcmVhbiIsCiAgMHgzMTQ5LAogICJzc2FuZ2hpZXVoa29yZWFuIiwKICAweDMxODUsCiAgInNzYW5naWV1bmdrb3JlYW4iLAogIDB4MzE4MCwKICAic3NhbmdraXllb2trb3JlYW4iLAogIDB4MzEzMiwKICAic3NhbmduaWV1bmtvcmVhbiIsCiAgMHgzMTY1LAogICJzc2FuZ3BpZXVwa29yZWFuIiwKICAweDMxNDMsCiAgInNzYW5nc2lvc2tvcmVhbiIsCiAgMHgzMTQ2LAogICJzc2FuZ3Rpa2V1dGtvcmVhbiIsCiAgMHgzMTM4LAogICJzc3VwZXJpb3IiLAogIDB4ZjZmMiwKICAic3RlcmxpbmciLAogIDB4MDBhMywKICAic3Rlcmxpbmdtb25vc3BhY2UiLAogIDB4ZmZlMSwKICAic3Ryb2tlbG9uZ292ZXJsYXljbWIiLAogIDB4MDMzNiwKICAic3Ryb2tlc2hvcnRvdmVybGF5Y21iIiwKICAweDAzMzUsCiAgInN1YnNldCIsCiAgMHgyMjgyLAogICJzdWJzZXRub3RlcXVhbCIsCiAgMHgyMjhhLAogICJzdWJzZXRvcmVxdWFsIiwKICAweDIyODYsCiAgInN1Y2NlZWRzIiwKICAweDIyN2IsCiAgInN1Y2h0aGF0IiwKICAweDIyMGIsCiAgInN1aGlyYWdhbmEiLAogIDB4MzA1OSwKICAic3VrYXRha2FuYSIsCiAgMHgzMGI5LAogICJzdWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmN2QsCiAgInN1a3VuYXJhYmljIiwKICAweDA2NTIsCiAgInN1bW1hdGlvbiIsCiAgMHgyMjExLAogICJzdW4iLAogIDB4MjYzYywKICAic3VwZXJzZXQiLAogIDB4MjI4MywKICAic3VwZXJzZXRub3RlcXVhbCIsCiAgMHgyMjhiLAogICJzdXBlcnNldG9yZXF1YWwiLAogIDB4MjI4NywKICAic3ZzcXVhcmUiLAogIDB4MzNkYywKICAic3lvdXdhZXJhc3F1YXJlIiwKICAweDMzN2MsCiAgInQiLAogIDB4MDA3NCwKICAidGFiZW5nYWxpIiwKICAweDA5YTQsCiAgInRhY2tkb3duIiwKICAweDIyYTQsCiAgInRhY2tsZWZ0IiwKICAweDIyYTMsCiAgInRhZGV2YSIsCiAgMHgwOTI0LAogICJ0YWd1amFyYXRpIiwKICAweDBhYTQsCiAgInRhZ3VybXVraGkiLAogIDB4MGEyNCwKICAidGFoYXJhYmljIiwKICAweDA2MzcsCiAgInRhaGZpbmFsYXJhYmljIiwKICAweGZlYzIsCiAgInRhaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVjMywKICAidGFoaXJhZ2FuYSIsCiAgMHgzMDVmLAogICJ0YWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVjNCwKICAidGFpc3lvdWVyYXNxdWFyZSIsCiAgMHgzMzdkLAogICJ0YWthdGFrYW5hIiwKICAweDMwYmYsCiAgInRha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MCwKICAidGF0d2VlbGFyYWJpYyIsCiAgMHgwNjQwLAogICJ0YXUiLAogIDB4MDNjNCwKICAidGF2IiwKICAweDA1ZWEsCiAgInRhdmRhZ2VzIiwKICAweGZiNGEsCiAgInRhdmRhZ2VzaCIsCiAgMHhmYjRhLAogICJ0YXZkYWdlc2hoZWJyZXciLAogIDB4ZmI0YSwKICAidGF2aGVicmV3IiwKICAweDA1ZWEsCiAgInRiYXIiLAogIDB4MDE2NywKICAidGJvcG9tb2ZvIiwKICAweDMxMGEsCiAgInRjYXJvbiIsCiAgMHgwMTY1LAogICJ0Y2N1cmwiLAogIDB4MDJhOCwKICAidGNlZGlsbGEiLAogIDB4MDE2MywKICAidGNoZWhhcmFiaWMiLAogIDB4MDY4NiwKICAidGNoZWhmaW5hbGFyYWJpYyIsCiAgMHhmYjdiLAogICJ0Y2hlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI3YywKICAidGNoZWhtZWRpYWxhcmFiaWMiLAogIDB4ZmI3ZCwKICAidGNpcmNsZSIsCiAgMHgyNGUzLAogICJ0Y2lyY3VtZmxleGJlbG93IiwKICAweDFlNzEsCiAgInRjb21tYWFjY2VudCIsCiAgMHgwMTYzLAogICJ0ZGllcmVzaXMiLAogIDB4MWU5NywKICAidGRvdGFjY2VudCIsCiAgMHgxZTZiLAogICJ0ZG90YmVsb3ciLAogIDB4MWU2ZCwKICAidGVjeXJpbGxpYyIsCiAgMHgwNDQyLAogICJ0ZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0YWQsCiAgInRlaGFyYWJpYyIsCiAgMHgwNjJhLAogICJ0ZWhmaW5hbGFyYWJpYyIsCiAgMHhmZTk2LAogICJ0ZWhoYWhpbml0aWFsYXJhYmljIiwKICAweGZjYTIsCiAgInRlaGhhaGlzb2xhdGVkYXJhYmljIiwKICAweGZjMGMsCiAgInRlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5NywKICAidGVoaXJhZ2FuYSIsCiAgMHgzMDY2LAogICJ0ZWhqZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2ExLAogICJ0ZWhqZWVtaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmMwYiwKICAidGVobWFyYnV0YWFyYWJpYyIsCiAgMHgwNjI5LAogICJ0ZWhtYXJidXRhZmluYWxhcmFiaWMiLAogIDB4ZmU5NCwKICAidGVobWVkaWFsYXJhYmljIiwKICAweGZlOTgsCiAgInRlaG1lZW1pbml0aWFsYXJhYmljIiwKICAweGZjYTQsCiAgInRlaG1lZW1pc29sYXRlZGFyYWJpYyIsCiAgMHhmYzBlLAogICJ0ZWhub29uZmluYWxhcmFiaWMiLAogIDB4ZmM3MywKICAidGVrYXRha2FuYSIsCiAgMHgzMGM2LAogICJ0ZWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmODMsCiAgInRlbGVwaG9uZSIsCiAgMHgyMTIxLAogICJ0ZWxlcGhvbmVibGFjayIsCiAgMHgyNjBlLAogICJ0ZWxpc2hhZ2Vkb2xhaGVicmV3IiwKICAweDA1YTAsCiAgInRlbGlzaGFxZXRhbmFoZWJyZXciLAogIDB4MDVhOSwKICAidGVuY2lyY2xlIiwKICAweDI0NjksCiAgInRlbmlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyOSwKICAidGVucGFyZW4iLAogIDB4MjQ3ZCwKICAidGVucGVyaW9kIiwKICAweDI0OTEsCiAgInRlbnJvbWFuIiwKICAweDIxNzksCiAgInRlc2giLAogIDB4MDJhNywKICAidGV0IiwKICAweDA1ZDgsCiAgInRldGRhZ2VzaCIsCiAgMHhmYjM4LAogICJ0ZXRkYWdlc2hoZWJyZXciLAogIDB4ZmIzOCwKICAidGV0aGVicmV3IiwKICAweDA1ZDgsCiAgInRldHNlY3lyaWxsaWMiLAogIDB4MDRiNSwKICAidGV2aXJoZWJyZXciLAogIDB4MDU5YiwKICAidGV2aXJsZWZ0aGVicmV3IiwKICAweDA1OWIsCiAgInRoYWJlbmdhbGkiLAogIDB4MDlhNSwKICAidGhhZGV2YSIsCiAgMHgwOTI1LAogICJ0aGFndWphcmF0aSIsCiAgMHgwYWE1LAogICJ0aGFndXJtdWtoaSIsCiAgMHgwYTI1LAogICJ0aGFsYXJhYmljIiwKICAweDA2MzAsCiAgInRoYWxmaW5hbGFyYWJpYyIsCiAgMHhmZWFjLAogICJ0aGFudGhha2hhdGxvd2xlZnR0aGFpIiwKICAweGY4OTgsCiAgInRoYW50aGFraGF0bG93cmlnaHR0aGFpIiwKICAweGY4OTcsCiAgInRoYW50aGFraGF0dGhhaSIsCiAgMHgwZTRjLAogICJ0aGFudGhha2hhdHVwcGVybGVmdHRoYWkiLAogIDB4Zjg5NiwKICAidGhlaGFyYWJpYyIsCiAgMHgwNjJiLAogICJ0aGVoZmluYWxhcmFiaWMiLAogIDB4ZmU5YSwKICAidGhlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmU5YiwKICAidGhlaG1lZGlhbGFyYWJpYyIsCiAgMHhmZTljLAogICJ0aGVyZWV4aXN0cyIsCiAgMHgyMjAzLAogICJ0aGVyZWZvcmUiLAogIDB4MjIzNCwKICAidGhldGEiLAogIDB4MDNiOCwKICAidGhldGExIiwKICAweDAzZDEsCiAgInRoZXRhc3ltYm9sZ3JlZWsiLAogIDB4MDNkMSwKICAidGhpZXV0aGFjaXJjbGVrb3JlYW4iLAogIDB4MzI3OSwKICAidGhpZXV0aGFwYXJlbmtvcmVhbiIsCiAgMHgzMjE5LAogICJ0aGlldXRoY2lyY2xla29yZWFuIiwKICAweDMyNmIsCiAgInRoaWV1dGhrb3JlYW4iLAogIDB4MzE0YywKICAidGhpZXV0aHBhcmVua29yZWFuIiwKICAweDMyMGIsCiAgInRoaXJ0ZWVuY2lyY2xlIiwKICAweDI0NmMsCiAgInRoaXJ0ZWVucGFyZW4iLAogIDB4MjQ4MCwKICAidGhpcnRlZW5wZXJpb2QiLAogIDB4MjQ5NCwKICAidGhvbmFuZ21vbnRob3RoYWkiLAogIDB4MGUxMSwKICAidGhvb2siLAogIDB4MDFhZCwKICAidGhvcGh1dGhhb3RoYWkiLAogIDB4MGUxMiwKICAidGhvcm4iLAogIDB4MDBmZSwKICAidGhvdGhhaGFudGhhaSIsCiAgMHgwZTE3LAogICJ0aG90aGFudGhhaSIsCiAgMHgwZTEwLAogICJ0aG90aG9uZ3RoYWkiLAogIDB4MGUxOCwKICAidGhvdGh1bmd0aGFpIiwKICAweDBlMTYsCiAgInRob3VzYW5kY3lyaWxsaWMiLAogIDB4MDQ4MiwKICAidGhvdXNhbmRzc2VwYXJhdG9yYXJhYmljIiwKICAweDA2NmMsCiAgInRob3VzYW5kc3NlcGFyYXRvcnBlcnNpYW4iLAogIDB4MDY2YywKICAidGhyZWUiLAogIDB4MDAzMywKICAidGhyZWVhcmFiaWMiLAogIDB4MDY2MywKICAidGhyZWViZW5nYWxpIiwKICAweDA5ZTksCiAgInRocmVlY2lyY2xlIiwKICAweDI0NjIsCiAgInRocmVlY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhjLAogICJ0aHJlZWRldmEiLAogIDB4MDk2OSwKICAidGhyZWVlaWdodGhzIiwKICAweDIxNWMsCiAgInRocmVlZ3VqYXJhdGkiLAogIDB4MGFlOSwKICAidGhyZWVndXJtdWtoaSIsCiAgMHgwYTY5LAogICJ0aHJlZWhhY2thcmFiaWMiLAogIDB4MDY2MywKICAidGhyZWVoYW5nemhvdSIsCiAgMHgzMDIzLAogICJ0aHJlZWlkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyMiwKICAidGhyZWVpbmZlcmlvciIsCiAgMHgyMDgzLAogICJ0aHJlZW1vbm9zcGFjZSIsCiAgMHhmZjEzLAogICJ0aHJlZW51bWVyYXRvcmJlbmdhbGkiLAogIDB4MDlmNiwKICAidGhyZWVvbGRzdHlsZSIsCiAgMHhmNzMzLAogICJ0aHJlZXBhcmVuIiwKICAweDI0NzYsCiAgInRocmVlcGVyaW9kIiwKICAweDI0OGEsCiAgInRocmVlcGVyc2lhbiIsCiAgMHgwNmYzLAogICJ0aHJlZXF1YXJ0ZXJzIiwKICAweDAwYmUsCiAgInRocmVlcXVhcnRlcnNlbWRhc2giLAogIDB4ZjZkZSwKICAidGhyZWVyb21hbiIsCiAgMHgyMTcyLAogICJ0aHJlZXN1cGVyaW9yIiwKICAweDAwYjMsCiAgInRocmVldGhhaSIsCiAgMHgwZTUzLAogICJ0aHpzcXVhcmUiLAogIDB4MzM5NCwKICAidGloaXJhZ2FuYSIsCiAgMHgzMDYxLAogICJ0aWthdGFrYW5hIiwKICAweDMwYzEsCiAgInRpa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MSwKICAidGlrZXV0YWNpcmNsZWtvcmVhbiIsCiAgMHgzMjcwLAogICJ0aWtldXRhcGFyZW5rb3JlYW4iLAogIDB4MzIxMCwKICAidGlrZXV0Y2lyY2xla29yZWFuIiwKICAweDMyNjIsCiAgInRpa2V1dGtvcmVhbiIsCiAgMHgzMTM3LAogICJ0aWtldXRwYXJlbmtvcmVhbiIsCiAgMHgzMjAyLAogICJ0aWxkZSIsCiAgMHgwMmRjLAogICJ0aWxkZWJlbG93Y21iIiwKICAweDAzMzAsCiAgInRpbGRlY21iIiwKICAweDAzMDMsCiAgInRpbGRlY29tYiIsCiAgMHgwMzAzLAogICJ0aWxkZWRvdWJsZWNtYiIsCiAgMHgwMzYwLAogICJ0aWxkZW9wZXJhdG9yIiwKICAweDIyM2MsCiAgInRpbGRlb3ZlcmxheWNtYiIsCiAgMHgwMzM0LAogICJ0aWxkZXZlcnRpY2FsY21iIiwKICAweDAzM2UsCiAgInRpbWVzY2lyY2xlIiwKICAweDIyOTcsCiAgInRpcGVoYWhlYnJldyIsCiAgMHgwNTk2LAogICJ0aXBlaGFsZWZ0aGVicmV3IiwKICAweDA1OTYsCiAgInRpcHBpZ3VybXVraGkiLAogIDB4MGE3MCwKICAidGl0bG9jeXJpbGxpY2NtYiIsCiAgMHgwNDgzLAogICJ0aXduYXJtZW5pYW4iLAogIDB4MDU3ZiwKICAidGxpbmViZWxvdyIsCiAgMHgxZTZmLAogICJ0bW9ub3NwYWNlIiwKICAweGZmNTQsCiAgInRvYXJtZW5pYW4iLAogIDB4MDU2OSwKICAidG9oaXJhZ2FuYSIsCiAgMHgzMDY4LAogICJ0b2thdGFrYW5hIiwKICAweDMwYzgsCiAgInRva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4NCwKICAidG9uZWJhcmV4dHJhaGlnaG1vZCIsCiAgMHgwMmU1LAogICJ0b25lYmFyZXh0cmFsb3dtb2QiLAogIDB4MDJlOSwKICAidG9uZWJhcmhpZ2htb2QiLAogIDB4MDJlNiwKICAidG9uZWJhcmxvd21vZCIsCiAgMHgwMmU4LAogICJ0b25lYmFybWlkbW9kIiwKICAweDAyZTcsCiAgInRvbmVmaXZlIiwKICAweDAxYmQsCiAgInRvbmVzaXgiLAogIDB4MDE4NSwKICAidG9uZXR3byIsCiAgMHgwMWE4LAogICJ0b25vcyIsCiAgMHgwMzg0LAogICJ0b25zcXVhcmUiLAogIDB4MzMyNywKICAidG9wYXRha3RoYWkiLAogIDB4MGUwZiwKICAidG9ydG9pc2VzaGVsbGJyYWNrZXRsZWZ0IiwKICAweDMwMTQsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0bGVmdHNtYWxsIiwKICAweGZlNWQsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0bGVmdHZlcnRpY2FsIiwKICAweGZlMzksCiAgInRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHQiLAogIDB4MzAxNSwKICAidG9ydG9pc2VzaGVsbGJyYWNrZXRyaWdodHNtYWxsIiwKICAweGZlNWUsCiAgInRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTNhLAogICJ0b3Rhb3RoYWkiLAogIDB4MGUxNSwKICAidHBhbGF0YWxob29rIiwKICAweDAxYWIsCiAgInRwYXJlbiIsCiAgMHgyNGFmLAogICJ0cmFkZW1hcmsiLAogIDB4MjEyMiwKICAidHJhZGVtYXJrc2FucyIsCiAgMHhmOGVhLAogICJ0cmFkZW1hcmtzZXJpZiIsCiAgMHhmNmRiLAogICJ0cmV0cm9mbGV4aG9vayIsCiAgMHgwMjg4LAogICJ0cmlhZ2RuIiwKICAweDI1YmMsCiAgInRyaWFnbGYiLAogIDB4MjVjNCwKICAidHJpYWdydCIsCiAgMHgyNWJhLAogICJ0cmlhZ3VwIiwKICAweDI1YjIsCiAgInRzIiwKICAweDAyYTYsCiAgInRzYWRpIiwKICAweDA1ZTYsCiAgInRzYWRpZGFnZXNoIiwKICAweGZiNDYsCiAgInRzYWRpZGFnZXNoaGVicmV3IiwKICAweGZiNDYsCiAgInRzYWRpaGVicmV3IiwKICAweDA1ZTYsCiAgInRzZWN5cmlsbGljIiwKICAweDA0NDYsCiAgInRzZXJlIiwKICAweDA1YjUsCiAgInRzZXJlMTIiLAogIDB4MDViNSwKICAidHNlcmUxZSIsCiAgMHgwNWI1LAogICJ0c2VyZTJiIiwKICAweDA1YjUsCiAgInRzZXJlaGVicmV3IiwKICAweDA1YjUsCiAgInRzZXJlbmFycm93aGVicmV3IiwKICAweDA1YjUsCiAgInRzZXJlcXVhcnRlcmhlYnJldyIsCiAgMHgwNWI1LAogICJ0c2VyZXdpZGVoZWJyZXciLAogIDB4MDViNSwKICAidHNoZWN5cmlsbGljIiwKICAweDA0NWIsCiAgInRzdXBlcmlvciIsCiAgMHhmNmYzLAogICJ0dGFiZW5nYWxpIiwKICAweDA5OWYsCiAgInR0YWRldmEiLAogIDB4MDkxZiwKICAidHRhZ3VqYXJhdGkiLAogIDB4MGE5ZiwKICAidHRhZ3VybXVraGkiLAogIDB4MGExZiwKICAidHRlaGFyYWJpYyIsCiAgMHgwNjc5LAogICJ0dGVoZmluYWxhcmFiaWMiLAogIDB4ZmI2NywKICAidHRlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI2OCwKICAidHRlaG1lZGlhbGFyYWJpYyIsCiAgMHhmYjY5LAogICJ0dGhhYmVuZ2FsaSIsCiAgMHgwOWEwLAogICJ0dGhhZGV2YSIsCiAgMHgwOTIwLAogICJ0dGhhZ3VqYXJhdGkiLAogIDB4MGFhMCwKICAidHRoYWd1cm11a2hpIiwKICAweDBhMjAsCiAgInR0dXJuZWQiLAogIDB4MDI4NywKICAidHVoaXJhZ2FuYSIsCiAgMHgzMDY0LAogICJ0dWthdGFrYW5hIiwKICAweDMwYzQsCiAgInR1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY4MiwKICAidHVzbWFsbGhpcmFnYW5hIiwKICAweDMwNjMsCiAgInR1c21hbGxrYXRha2FuYSIsCiAgMHgzMGMzLAogICJ0dXNtYWxsa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2ZiwKICAidHdlbHZlY2lyY2xlIiwKICAweDI0NmIsCiAgInR3ZWx2ZXBhcmVuIiwKICAweDI0N2YsCiAgInR3ZWx2ZXBlcmlvZCIsCiAgMHgyNDkzLAogICJ0d2VsdmVyb21hbiIsCiAgMHgyMTdiLAogICJ0d2VudHljaXJjbGUiLAogIDB4MjQ3MywKICAidHdlbnR5aGFuZ3pob3UiLAogIDB4NTM0NCwKICAidHdlbnR5cGFyZW4iLAogIDB4MjQ4NywKICAidHdlbnR5cGVyaW9kIiwKICAweDI0OWIsCiAgInR3byIsCiAgMHgwMDMyLAogICJ0d29hcmFiaWMiLAogIDB4MDY2MiwKICAidHdvYmVuZ2FsaSIsCiAgMHgwOWU4LAogICJ0d29jaXJjbGUiLAogIDB4MjQ2MSwKICAidHdvY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiIsCiAgMHgyNzhiLAogICJ0d29kZXZhIiwKICAweDA5NjgsCiAgInR3b2RvdGVubGVhZGVyIiwKICAweDIwMjUsCiAgInR3b2RvdGxlYWRlciIsCiAgMHgyMDI1LAogICJ0d29kb3RsZWFkZXJ2ZXJ0aWNhbCIsCiAgMHhmZTMwLAogICJ0d29ndWphcmF0aSIsCiAgMHgwYWU4LAogICJ0d29ndXJtdWtoaSIsCiAgMHgwYTY4LAogICJ0d29oYWNrYXJhYmljIiwKICAweDA2NjIsCiAgInR3b2hhbmd6aG91IiwKICAweDMwMjIsCiAgInR3b2lkZW9ncmFwaGljcGFyZW4iLAogIDB4MzIyMSwKICAidHdvaW5mZXJpb3IiLAogIDB4MjA4MiwKICAidHdvbW9ub3NwYWNlIiwKICAweGZmMTIsCiAgInR3b251bWVyYXRvcmJlbmdhbGkiLAogIDB4MDlmNSwKICAidHdvb2xkc3R5bGUiLAogIDB4ZjczMiwKICAidHdvcGFyZW4iLAogIDB4MjQ3NSwKICAidHdvcGVyaW9kIiwKICAweDI0ODksCiAgInR3b3BlcnNpYW4iLAogIDB4MDZmMiwKICAidHdvcm9tYW4iLAogIDB4MjE3MSwKICAidHdvc3Ryb2tlIiwKICAweDAxYmIsCiAgInR3b3N1cGVyaW9yIiwKICAweDAwYjIsCiAgInR3b3RoYWkiLAogIDB4MGU1MiwKICAidHdvdGhpcmRzIiwKICAweDIxNTQsCiAgInUiLAogIDB4MDA3NSwKICAidWFjdXRlIiwKICAweDAwZmEsCiAgInViYXIiLAogIDB4MDI4OSwKICAidWJlbmdhbGkiLAogIDB4MDk4OSwKICAidWJvcG9tb2ZvIiwKICAweDMxMjgsCiAgInVicmV2ZSIsCiAgMHgwMTZkLAogICJ1Y2Fyb24iLAogIDB4MDFkNCwKICAidWNpcmNsZSIsCiAgMHgyNGU0LAogICJ1Y2lyY3VtZmxleCIsCiAgMHgwMGZiLAogICJ1Y2lyY3VtZmxleGJlbG93IiwKICAweDFlNzcsCiAgInVjeXJpbGxpYyIsCiAgMHgwNDQzLAogICJ1ZGF0dGFkZXZhIiwKICAweDA5NTEsCiAgInVkYmxhY3V0ZSIsCiAgMHgwMTcxLAogICJ1ZGJsZ3JhdmUiLAogIDB4MDIxNSwKICAidWRldmEiLAogIDB4MDkwOSwKICAidWRpZXJlc2lzIiwKICAweDAwZmMsCiAgInVkaWVyZXNpc2FjdXRlIiwKICAweDAxZDgsCiAgInVkaWVyZXNpc2JlbG93IiwKICAweDFlNzMsCiAgInVkaWVyZXNpc2Nhcm9uIiwKICAweDAxZGEsCiAgInVkaWVyZXNpc2N5cmlsbGljIiwKICAweDA0ZjEsCiAgInVkaWVyZXNpc2dyYXZlIiwKICAweDAxZGMsCiAgInVkaWVyZXNpc21hY3JvbiIsCiAgMHgwMWQ2LAogICJ1ZG90YmVsb3ciLAogIDB4MWVlNSwKICAidWdyYXZlIiwKICAweDAwZjksCiAgInVndWphcmF0aSIsCiAgMHgwYTg5LAogICJ1Z3VybXVraGkiLAogIDB4MGEwOSwKICAidWhpcmFnYW5hIiwKICAweDMwNDYsCiAgInVob29rYWJvdmUiLAogIDB4MWVlNywKICAidWhvcm4iLAogIDB4MDFiMCwKICAidWhvcm5hY3V0ZSIsCiAgMHgxZWU5LAogICJ1aG9ybmRvdGJlbG93IiwKICAweDFlZjEsCiAgInVob3JuZ3JhdmUiLAogIDB4MWVlYiwKICAidWhvcm5ob29rYWJvdmUiLAogIDB4MWVlZCwKICAidWhvcm50aWxkZSIsCiAgMHgxZWVmLAogICJ1aHVuZ2FydW1sYXV0IiwKICAweDAxNzEsCiAgInVodW5nYXJ1bWxhdXRjeXJpbGxpYyIsCiAgMHgwNGYzLAogICJ1aW52ZXJ0ZWRicmV2ZSIsCiAgMHgwMjE3LAogICJ1a2F0YWthbmEiLAogIDB4MzBhNiwKICAidWthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNzMsCiAgInVrY3lyaWxsaWMiLAogIDB4MDQ3OSwKICAidWtvcmVhbiIsCiAgMHgzMTVjLAogICJ1bWFjcm9uIiwKICAweDAxNmIsCiAgInVtYWNyb25jeXJpbGxpYyIsCiAgMHgwNGVmLAogICJ1bWFjcm9uZGllcmVzaXMiLAogIDB4MWU3YiwKICAidW1hdHJhZ3VybXVraGkiLAogIDB4MGE0MSwKICAidW1vbm9zcGFjZSIsCiAgMHhmZjU1LAogICJ1bmRlcnNjb3JlIiwKICAweDAwNWYsCiAgInVuZGVyc2NvcmVkYmwiLAogIDB4MjAxNywKICAidW5kZXJzY29yZW1vbm9zcGFjZSIsCiAgMHhmZjNmLAogICJ1bmRlcnNjb3JldmVydGljYWwiLAogIDB4ZmUzMywKICAidW5kZXJzY29yZXdhdnkiLAogIDB4ZmU0ZiwKICAidW5pb24iLAogIDB4MjIyYSwKICAidW5pdmVyc2FsIiwKICAweDIyMDAsCiAgInVvZ29uZWsiLAogIDB4MDE3MywKICAidXBhcmVuIiwKICAweDI0YjAsCiAgInVwYmxvY2siLAogIDB4MjU4MCwKICAidXBwZXJkb3RoZWJyZXciLAogIDB4MDVjNCwKICAidXBzaWxvbiIsCiAgMHgwM2M1LAogICJ1cHNpbG9uZGllcmVzaXMiLAogIDB4MDNjYiwKICAidXBzaWxvbmRpZXJlc2lzdG9ub3MiLAogIDB4MDNiMCwKICAidXBzaWxvbmxhdGluIiwKICAweDAyOGEsCiAgInVwc2lsb250b25vcyIsCiAgMHgwM2NkLAogICJ1cHRhY2tiZWxvd2NtYiIsCiAgMHgwMzFkLAogICJ1cHRhY2ttb2QiLAogIDB4MDJkNCwKICAidXJhZ3VybXVraGkiLAogIDB4MGE3MywKICAidXJpbmciLAogIDB4MDE2ZiwKICAidXNob3J0Y3lyaWxsaWMiLAogIDB4MDQ1ZSwKICAidXNtYWxsaGlyYWdhbmEiLAogIDB4MzA0NSwKICAidXNtYWxsa2F0YWthbmEiLAogIDB4MzBhNSwKICAidXNtYWxsa2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2OSwKICAidXN0cmFpZ2h0Y3lyaWxsaWMiLAogIDB4MDRhZiwKICAidXN0cmFpZ2h0c3Ryb2tlY3lyaWxsaWMiLAogIDB4MDRiMSwKICAidXRpbGRlIiwKICAweDAxNjksCiAgInV0aWxkZWFjdXRlIiwKICAweDFlNzksCiAgInV0aWxkZWJlbG93IiwKICAweDFlNzUsCiAgInV1YmVuZ2FsaSIsCiAgMHgwOThhLAogICJ1dWRldmEiLAogIDB4MDkwYSwKICAidXVndWphcmF0aSIsCiAgMHgwYThhLAogICJ1dWd1cm11a2hpIiwKICAweDBhMGEsCiAgInV1bWF0cmFndXJtdWtoaSIsCiAgMHgwYTQyLAogICJ1dXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljMiwKICAidXV2b3dlbHNpZ25kZXZhIiwKICAweDA5NDIsCiAgInV1dm93ZWxzaWduZ3VqYXJhdGkiLAogIDB4MGFjMiwKICAidXZvd2Vsc2lnbmJlbmdhbGkiLAogIDB4MDljMSwKICAidXZvd2Vsc2lnbmRldmEiLAogIDB4MDk0MSwKICAidXZvd2Vsc2lnbmd1amFyYXRpIiwKICAweDBhYzEsCiAgInYiLAogIDB4MDA3NiwKICAidmFkZXZhIiwKICAweDA5MzUsCiAgInZhZ3VqYXJhdGkiLAogIDB4MGFiNSwKICAidmFndXJtdWtoaSIsCiAgMHgwYTM1LAogICJ2YWthdGFrYW5hIiwKICAweDMwZjcsCiAgInZhdiIsCiAgMHgwNWQ1LAogICJ2YXZkYWdlc2giLAogIDB4ZmIzNSwKICAidmF2ZGFnZXNoNjUiLAogIDB4ZmIzNSwKICAidmF2ZGFnZXNoaGVicmV3IiwKICAweGZiMzUsCiAgInZhdmhlYnJldyIsCiAgMHgwNWQ1LAogICJ2YXZob2xhbSIsCiAgMHhmYjRiLAogICJ2YXZob2xhbWhlYnJldyIsCiAgMHhmYjRiLAogICJ2YXZ2YXZoZWJyZXciLAogIDB4MDVmMCwKICAidmF2eW9kaGVicmV3IiwKICAweDA1ZjEsCiAgInZjaXJjbGUiLAogIDB4MjRlNSwKICAidmRvdGJlbG93IiwKICAweDFlN2YsCiAgInZlY3lyaWxsaWMiLAogIDB4MDQzMiwKICAidmVoYXJhYmljIiwKICAweDA2YTQsCiAgInZlaGZpbmFsYXJhYmljIiwKICAweGZiNmIsCiAgInZlaGluaXRpYWxhcmFiaWMiLAogIDB4ZmI2YywKICAidmVobWVkaWFsYXJhYmljIiwKICAweGZiNmQsCiAgInZla2F0YWthbmEiLAogIDB4MzBmOSwKICAidmVudXMiLAogIDB4MjY0MCwKICAidmVydGljYWxiYXIiLAogIDB4MDA3YywKICAidmVydGljYWxsaW5lYWJvdmVjbWIiLAogIDB4MDMwZCwKICAidmVydGljYWxsaW5lYmVsb3djbWIiLAogIDB4MDMyOSwKICAidmVydGljYWxsaW5lbG93bW9kIiwKICAweDAyY2MsCiAgInZlcnRpY2FsbGluZW1vZCIsCiAgMHgwMmM4LAogICJ2ZXdhcm1lbmlhbiIsCiAgMHgwNTdlLAogICJ2aG9vayIsCiAgMHgwMjhiLAogICJ2aWthdGFrYW5hIiwKICAweDMwZjgsCiAgInZpcmFtYWJlbmdhbGkiLAogIDB4MDljZCwKICAidmlyYW1hZGV2YSIsCiAgMHgwOTRkLAogICJ2aXJhbWFndWphcmF0aSIsCiAgMHgwYWNkLAogICJ2aXNhcmdhYmVuZ2FsaSIsCiAgMHgwOTgzLAogICJ2aXNhcmdhZGV2YSIsCiAgMHgwOTAzLAogICJ2aXNhcmdhZ3VqYXJhdGkiLAogIDB4MGE4MywKICAidm1vbm9zcGFjZSIsCiAgMHhmZjU2LAogICJ2b2FybWVuaWFuIiwKICAweDA1NzgsCiAgInZvaWNlZGl0ZXJhdGlvbmhpcmFnYW5hIiwKICAweDMwOWUsCiAgInZvaWNlZGl0ZXJhdGlvbmthdGFrYW5hIiwKICAweDMwZmUsCiAgInZvaWNlZG1hcmtrYW5hIiwKICAweDMwOWIsCiAgInZvaWNlZG1hcmtrYW5haGFsZndpZHRoIiwKICAweGZmOWUsCiAgInZva2F0YWthbmEiLAogIDB4MzBmYSwKICAidnBhcmVuIiwKICAweDI0YjEsCiAgInZ0aWxkZSIsCiAgMHgxZTdkLAogICJ2dHVybmVkIiwKICAweDAyOGMsCiAgInZ1aGlyYWdhbmEiLAogIDB4MzA5NCwKICAidnVrYXRha2FuYSIsCiAgMHgzMGY0LAogICJ3IiwKICAweDAwNzcsCiAgIndhY3V0ZSIsCiAgMHgxZTgzLAogICJ3YWVrb3JlYW4iLAogIDB4MzE1OSwKICAid2FoaXJhZ2FuYSIsCiAgMHgzMDhmLAogICJ3YWthdGFrYW5hIiwKICAweDMwZWYsCiAgIndha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5YywKICAid2Frb3JlYW4iLAogIDB4MzE1OCwKICAid2FzbWFsbGhpcmFnYW5hIiwKICAweDMwOGUsCiAgIndhc21hbGxrYXRha2FuYSIsCiAgMHgzMGVlLAogICJ3YXR0b3NxdWFyZSIsCiAgMHgzMzU3LAogICJ3YXZlZGFzaCIsCiAgMHgzMDFjLAogICJ3YXZ5dW5kZXJzY29yZXZlcnRpY2FsIiwKICAweGZlMzQsCiAgIndhd2FyYWJpYyIsCiAgMHgwNjQ4LAogICJ3YXdmaW5hbGFyYWJpYyIsCiAgMHhmZWVlLAogICJ3YXdoYW16YWFib3ZlYXJhYmljIiwKICAweDA2MjQsCiAgIndhd2hhbXphYWJvdmVmaW5hbGFyYWJpYyIsCiAgMHhmZTg2LAogICJ3YnNxdWFyZSIsCiAgMHgzM2RkLAogICJ3Y2lyY2xlIiwKICAweDI0ZTYsCiAgIndjaXJjdW1mbGV4IiwKICAweDAxNzUsCiAgIndkaWVyZXNpcyIsCiAgMHgxZTg1LAogICJ3ZG90YWNjZW50IiwKICAweDFlODcsCiAgIndkb3RiZWxvdyIsCiAgMHgxZTg5LAogICJ3ZWhpcmFnYW5hIiwKICAweDMwOTEsCiAgIndlaWVyc3RyYXNzIiwKICAweDIxMTgsCiAgIndla2F0YWthbmEiLAogIDB4MzBmMSwKICAid2Vrb3JlYW4iLAogIDB4MzE1ZSwKICAid2Vva29yZWFuIiwKICAweDMxNWQsCiAgIndncmF2ZSIsCiAgMHgxZTgxLAogICJ3aGl0ZWJ1bGxldCIsCiAgMHgyNWU2LAogICJ3aGl0ZWNpcmNsZSIsCiAgMHgyNWNiLAogICJ3aGl0ZWNpcmNsZWludmVyc2UiLAogIDB4MjVkOSwKICAid2hpdGVjb3JuZXJicmFja2V0bGVmdCIsCiAgMHgzMDBlLAogICJ3aGl0ZWNvcm5lcmJyYWNrZXRsZWZ0dmVydGljYWwiLAogIDB4ZmU0MywKICAid2hpdGVjb3JuZXJicmFja2V0cmlnaHQiLAogIDB4MzAwZiwKICAid2hpdGVjb3JuZXJicmFja2V0cmlnaHR2ZXJ0aWNhbCIsCiAgMHhmZTQ0LAogICJ3aGl0ZWRpYW1vbmQiLAogIDB4MjVjNywKICAid2hpdGVkaWFtb25kY29udGFpbmluZ2JsYWNrc21hbGxkaWFtb25kIiwKICAweDI1YzgsCiAgIndoaXRlZG93bnBvaW50aW5nc21hbGx0cmlhbmdsZSIsCiAgMHgyNWJmLAogICJ3aGl0ZWRvd25wb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YmQsCiAgIndoaXRlbGVmdHBvaW50aW5nc21hbGx0cmlhbmdsZSIsCiAgMHgyNWMzLAogICJ3aGl0ZWxlZnRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YzEsCiAgIndoaXRlbGVudGljdWxhcmJyYWNrZXRsZWZ0IiwKICAweDMwMTYsCiAgIndoaXRlbGVudGljdWxhcmJyYWNrZXRyaWdodCIsCiAgMHgzMDE3LAogICJ3aGl0ZXJpZ2h0cG9pbnRpbmdzbWFsbHRyaWFuZ2xlIiwKICAweDI1YjksCiAgIndoaXRlcmlnaHRwb2ludGluZ3RyaWFuZ2xlIiwKICAweDI1YjcsCiAgIndoaXRlc21hbGxzcXVhcmUiLAogIDB4MjVhYiwKICAid2hpdGVzbWlsaW5nZmFjZSIsCiAgMHgyNjNhLAogICJ3aGl0ZXNxdWFyZSIsCiAgMHgyNWExLAogICJ3aGl0ZXN0YXIiLAogIDB4MjYwNiwKICAid2hpdGV0ZWxlcGhvbmUiLAogIDB4MjYwZiwKICAid2hpdGV0b3J0b2lzZXNoZWxsYnJhY2tldGxlZnQiLAogIDB4MzAxOCwKICAid2hpdGV0b3J0b2lzZXNoZWxsYnJhY2tldHJpZ2h0IiwKICAweDMwMTksCiAgIndoaXRldXBwb2ludGluZ3NtYWxsdHJpYW5nbGUiLAogIDB4MjViNSwKICAid2hpdGV1cHBvaW50aW5ndHJpYW5nbGUiLAogIDB4MjViMywKICAid2loaXJhZ2FuYSIsCiAgMHgzMDkwLAogICJ3aWthdGFrYW5hIiwKICAweDMwZjAsCiAgIndpa29yZWFuIiwKICAweDMxNWYsCiAgIndtb25vc3BhY2UiLAogIDB4ZmY1NywKICAid29oaXJhZ2FuYSIsCiAgMHgzMDkyLAogICJ3b2thdGFrYW5hIiwKICAweDMwZjIsCiAgIndva2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY2NiwKICAid29uIiwKICAweDIwYTksCiAgIndvbm1vbm9zcGFjZSIsCiAgMHhmZmU2LAogICJ3b3dhZW50aGFpIiwKICAweDBlMjcsCiAgIndwYXJlbiIsCiAgMHgyNGIyLAogICJ3cmluZyIsCiAgMHgxZTk4LAogICJ3c3VwZXJpb3IiLAogIDB4MDJiNywKICAid3R1cm5lZCIsCiAgMHgwMjhkLAogICJ3eW5uIiwKICAweDAxYmYsCiAgIngiLAogIDB4MDA3OCwKICAieGFib3ZlY21iIiwKICAweDAzM2QsCiAgInhib3BvbW9mbyIsCiAgMHgzMTEyLAogICJ4Y2lyY2xlIiwKICAweDI0ZTcsCiAgInhkaWVyZXNpcyIsCiAgMHgxZThkLAogICJ4ZG90YWNjZW50IiwKICAweDFlOGIsCiAgInhlaGFybWVuaWFuIiwKICAweDA1NmQsCiAgInhpIiwKICAweDAzYmUsCiAgInhtb25vc3BhY2UiLAogIDB4ZmY1OCwKICAieHBhcmVuIiwKICAweDI0YjMsCiAgInhzdXBlcmlvciIsCiAgMHgwMmUzLAogICJ5IiwKICAweDAwNzksCiAgInlhYWRvc3F1YXJlIiwKICAweDMzNGUsCiAgInlhYmVuZ2FsaSIsCiAgMHgwOWFmLAogICJ5YWN1dGUiLAogIDB4MDBmZCwKICAieWFkZXZhIiwKICAweDA5MmYsCiAgInlhZWtvcmVhbiIsCiAgMHgzMTUyLAogICJ5YWd1amFyYXRpIiwKICAweDBhYWYsCiAgInlhZ3VybXVraGkiLAogIDB4MGEyZiwKICAieWFoaXJhZ2FuYSIsCiAgMHgzMDg0LAogICJ5YWthdGFrYW5hIiwKICAweDMwZTQsCiAgInlha2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NCwKICAieWFrb3JlYW4iLAogIDB4MzE1MSwKICAieWFtYWtrYW50aGFpIiwKICAweDBlNGUsCiAgInlhc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDgzLAogICJ5YXNtYWxsa2F0YWthbmEiLAogIDB4MzBlMywKICAieWFzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmMsCiAgInlhdGN5cmlsbGljIiwKICAweDA0NjMsCiAgInljaXJjbGUiLAogIDB4MjRlOCwKICAieWNpcmN1bWZsZXgiLAogIDB4MDE3NywKICAieWRpZXJlc2lzIiwKICAweDAwZmYsCiAgInlkb3RhY2NlbnQiLAogIDB4MWU4ZiwKICAieWRvdGJlbG93IiwKICAweDFlZjUsCiAgInllaGFyYWJpYyIsCiAgMHgwNjRhLAogICJ5ZWhiYXJyZWVhcmFiaWMiLAogIDB4MDZkMiwKICAieWVoYmFycmVlZmluYWxhcmFiaWMiLAogIDB4ZmJhZiwKICAieWVoZmluYWxhcmFiaWMiLAogIDB4ZmVmMiwKICAieWVoaGFtemFhYm92ZWFyYWJpYyIsCiAgMHgwNjI2LAogICJ5ZWhoYW16YWFib3ZlZmluYWxhcmFiaWMiLAogIDB4ZmU4YSwKICAieWVoaGFtemFhYm92ZWluaXRpYWxhcmFiaWMiLAogIDB4ZmU4YiwKICAieWVoaGFtemFhYm92ZW1lZGlhbGFyYWJpYyIsCiAgMHhmZThjLAogICJ5ZWhpbml0aWFsYXJhYmljIiwKICAweGZlZjMsCiAgInllaG1lZGlhbGFyYWJpYyIsCiAgMHhmZWY0LAogICJ5ZWhtZWVtaW5pdGlhbGFyYWJpYyIsCiAgMHhmY2RkLAogICJ5ZWhtZWVtaXNvbGF0ZWRhcmFiaWMiLAogIDB4ZmM1OCwKICAieWVobm9vbmZpbmFsYXJhYmljIiwKICAweGZjOTQsCiAgInllaHRocmVlZG90c2JlbG93YXJhYmljIiwKICAweDA2ZDEsCiAgInlla29yZWFuIiwKICAweDMxNTYsCiAgInllbiIsCiAgMHgwMGE1LAogICJ5ZW5tb25vc3BhY2UiLAogIDB4ZmZlNSwKICAieWVva29yZWFuIiwKICAweDMxNTUsCiAgInllb3JpbmhpZXVoa29yZWFuIiwKICAweDMxODYsCiAgInllcmFoYmVueW9tb2hlYnJldyIsCiAgMHgwNWFhLAogICJ5ZXJhaGJlbnlvbW9sZWZ0aGVicmV3IiwKICAweDA1YWEsCiAgInllcmljeXJpbGxpYyIsCiAgMHgwNDRiLAogICJ5ZXJ1ZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGY5LAogICJ5ZXNpZXVuZ2tvcmVhbiIsCiAgMHgzMTgxLAogICJ5ZXNpZXVuZ3BhbnNpb3Nrb3JlYW4iLAogIDB4MzE4MywKICAieWVzaWV1bmdzaW9za29yZWFuIiwKICAweDMxODIsCiAgInlldGl2aGVicmV3IiwKICAweDA1OWEsCiAgInlncmF2ZSIsCiAgMHgxZWYzLAogICJ5aG9vayIsCiAgMHgwMWI0LAogICJ5aG9va2Fib3ZlIiwKICAweDFlZjcsCiAgInlpYXJtZW5pYW4iLAogIDB4MDU3NSwKICAieWljeXJpbGxpYyIsCiAgMHgwNDU3LAogICJ5aWtvcmVhbiIsCiAgMHgzMTYyLAogICJ5aW55YW5nIiwKICAweDI2MmYsCiAgInlpd25hcm1lbmlhbiIsCiAgMHgwNTgyLAogICJ5bW9ub3NwYWNlIiwKICAweGZmNTksCiAgInlvZCIsCiAgMHgwNWQ5LAogICJ5b2RkYWdlc2giLAogIDB4ZmIzOSwKICAieW9kZGFnZXNoaGVicmV3IiwKICAweGZiMzksCiAgInlvZGhlYnJldyIsCiAgMHgwNWQ5LAogICJ5b2R5b2RoZWJyZXciLAogIDB4MDVmMiwKICAieW9keW9kcGF0YWhoZWJyZXciLAogIDB4ZmIxZiwKICAieW9oaXJhZ2FuYSIsCiAgMHgzMDg4LAogICJ5b2lrb3JlYW4iLAogIDB4MzE4OSwKICAieW9rYXRha2FuYSIsCiAgMHgzMGU4LAogICJ5b2thdGFrYW5haGFsZndpZHRoIiwKICAweGZmOTYsCiAgInlva29yZWFuIiwKICAweDMxNWIsCiAgInlvc21hbGxoaXJhZ2FuYSIsCiAgMHgzMDg3LAogICJ5b3NtYWxsa2F0YWthbmEiLAogIDB4MzBlNywKICAieW9zbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmUsCiAgInlvdGdyZWVrIiwKICAweDAzZjMsCiAgInlveWFla29yZWFuIiwKICAweDMxODgsCiAgInlveWFrb3JlYW4iLAogIDB4MzE4NywKICAieW95YWt0aGFpIiwKICAweDBlMjIsCiAgInlveWluZ3RoYWkiLAogIDB4MGUwZCwKICAieXBhcmVuIiwKICAweDI0YjQsCiAgInlwb2dlZ3JhbW1lbmkiLAogIDB4MDM3YSwKICAieXBvZ2VncmFtbWVuaWdyZWVrY21iIiwKICAweDAzNDUsCiAgInlyIiwKICAweDAxYTYsCiAgInlyaW5nIiwKICAweDFlOTksCiAgInlzdXBlcmlvciIsCiAgMHgwMmI4LAogICJ5dGlsZGUiLAogIDB4MWVmOSwKICAieXR1cm5lZCIsCiAgMHgwMjhlLAogICJ5dWhpcmFnYW5hIiwKICAweDMwODYsCiAgInl1aWtvcmVhbiIsCiAgMHgzMThjLAogICJ5dWthdGFrYW5hIiwKICAweDMwZTYsCiAgInl1a2F0YWthbmFoYWxmd2lkdGgiLAogIDB4ZmY5NSwKICAieXVrb3JlYW4iLAogIDB4MzE2MCwKICAieXVzYmlnY3lyaWxsaWMiLAogIDB4MDQ2YiwKICAieXVzYmlnaW90aWZpZWRjeXJpbGxpYyIsCiAgMHgwNDZkLAogICJ5dXNsaXR0bGVjeXJpbGxpYyIsCiAgMHgwNDY3LAogICJ5dXNsaXR0bGVpb3RpZmllZGN5cmlsbGljIiwKICAweDA0NjksCiAgInl1c21hbGxoaXJhZ2FuYSIsCiAgMHgzMDg1LAogICJ5dXNtYWxsa2F0YWthbmEiLAogIDB4MzBlNSwKICAieXVzbWFsbGthdGFrYW5haGFsZndpZHRoIiwKICAweGZmNmQsCiAgInl1eWVrb3JlYW4iLAogIDB4MzE4YiwKICAieXV5ZW9rb3JlYW4iLAogIDB4MzE4YSwKICAieXlhYmVuZ2FsaSIsCiAgMHgwOWRmLAogICJ5eWFkZXZhIiwKICAweDA5NWYsCiAgInoiLAogIDB4MDA3YSwKICAiemFhcm1lbmlhbiIsCiAgMHgwNTY2LAogICJ6YWN1dGUiLAogIDB4MDE3YSwKICAiemFkZXZhIiwKICAweDA5NWIsCiAgInphZ3VybXVraGkiLAogIDB4MGE1YiwKICAiemFoYXJhYmljIiwKICAweDA2MzgsCiAgInphaGZpbmFsYXJhYmljIiwKICAweGZlYzYsCiAgInphaGluaXRpYWxhcmFiaWMiLAogIDB4ZmVjNywKICAiemFoaXJhZ2FuYSIsCiAgMHgzMDU2LAogICJ6YWhtZWRpYWxhcmFiaWMiLAogIDB4ZmVjOCwKICAiemFpbmFyYWJpYyIsCiAgMHgwNjMyLAogICJ6YWluZmluYWxhcmFiaWMiLAogIDB4ZmViMCwKICAiemFrYXRha2FuYSIsCiAgMHgzMGI2LAogICJ6YXFlZmdhZG9saGVicmV3IiwKICAweDA1OTUsCiAgInphcWVmcWF0YW5oZWJyZXciLAogIDB4MDU5NCwKICAiemFycWFoZWJyZXciLAogIDB4MDU5OCwKICAiemF5aW4iLAogIDB4MDVkNiwKICAiemF5aW5kYWdlc2giLAogIDB4ZmIzNiwKICAiemF5aW5kYWdlc2hoZWJyZXciLAogIDB4ZmIzNiwKICAiemF5aW5oZWJyZXciLAogIDB4MDVkNiwKICAiemJvcG9tb2ZvIiwKICAweDMxMTcsCiAgInpjYXJvbiIsCiAgMHgwMTdlLAogICJ6Y2lyY2xlIiwKICAweDI0ZTksCiAgInpjaXJjdW1mbGV4IiwKICAweDFlOTEsCiAgInpjdXJsIiwKICAweDAyOTEsCiAgInpkb3QiLAogIDB4MDE3YywKICAiemRvdGFjY2VudCIsCiAgMHgwMTdjLAogICJ6ZG90YmVsb3ciLAogIDB4MWU5MywKICAiemVjeXJpbGxpYyIsCiAgMHgwNDM3LAogICJ6ZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTksCiAgInplZGllcmVzaXNjeXJpbGxpYyIsCiAgMHgwNGRmLAogICJ6ZWhpcmFnYW5hIiwKICAweDMwNWMsCiAgInpla2F0YWthbmEiLAogIDB4MzBiYywKICAiemVybyIsCiAgMHgwMDMwLAogICJ6ZXJvYXJhYmljIiwKICAweDA2NjAsCiAgInplcm9iZW5nYWxpIiwKICAweDA5ZTYsCiAgInplcm9kZXZhIiwKICAweDA5NjYsCiAgInplcm9ndWphcmF0aSIsCiAgMHgwYWU2LAogICJ6ZXJvZ3VybXVraGkiLAogIDB4MGE2NiwKICAiemVyb2hhY2thcmFiaWMiLAogIDB4MDY2MCwKICAiemVyb2luZmVyaW9yIiwKICAweDIwODAsCiAgInplcm9tb25vc3BhY2UiLAogIDB4ZmYxMCwKICAiemVyb29sZHN0eWxlIiwKICAweGY3MzAsCiAgInplcm9wZXJzaWFuIiwKICAweDA2ZjAsCiAgInplcm9zdXBlcmlvciIsCiAgMHgyMDcwLAogICJ6ZXJvdGhhaSIsCiAgMHgwZTUwLAogICJ6ZXJvd2lkdGhqb2luZXIiLAogIDB4ZmVmZiwKICAiemVyb3dpZHRobm9uam9pbmVyIiwKICAweDIwMGMsCiAgInplcm93aWR0aHNwYWNlIiwKICAweDIwMGIsCiAgInpldGEiLAogIDB4MDNiNiwKICAiemhib3BvbW9mbyIsCiAgMHgzMTEzLAogICJ6aGVhcm1lbmlhbiIsCiAgMHgwNTZhLAogICJ6aGVicmV2ZWN5cmlsbGljIiwKICAweDA0YzIsCiAgInpoZWN5cmlsbGljIiwKICAweDA0MzYsCiAgInpoZWRlc2NlbmRlcmN5cmlsbGljIiwKICAweDA0OTcsCiAgInpoZWRpZXJlc2lzY3lyaWxsaWMiLAogIDB4MDRkZCwKICAiemloaXJhZ2FuYSIsCiAgMHgzMDU4LAogICJ6aWthdGFrYW5hIiwKICAweDMwYjgsCiAgInppbm9yaGVicmV3IiwKICAweDA1YWUsCiAgInpsaW5lYmVsb3ciLAogIDB4MWU5NSwKICAiem1vbm9zcGFjZSIsCiAgMHhmZjVhLAogICJ6b2hpcmFnYW5hIiwKICAweDMwNWUsCiAgInpva2F0YWthbmEiLAogIDB4MzBiZSwKICAienBhcmVuIiwKICAweDI0YjUsCiAgInpyZXRyb2ZsZXhob29rIiwKICAweDAyOTAsCiAgInpzdHJva2UiLAogIDB4MDFiNiwKICAienVoaXJhZ2FuYSIsCiAgMHgzMDVhLAogICJ6dWthdGFrYW5hIiwKICAweDMwYmEsCiAgIi5ub3RkZWYiLAogIDB4MDAwMCwKICAiYW5nYnJhY2tldGxlZnRiaWciLAogIDB4MjMyOSwKICAiYW5nYnJhY2tldGxlZnRCaWciLAogIDB4MjMyOSwKICAiYW5nYnJhY2tldGxlZnRiaWdnIiwKICAweDIzMjksCiAgImFuZ2JyYWNrZXRsZWZ0QmlnZyIsCiAgMHgyMzI5LAogICJhbmdicmFja2V0cmlnaHRCaWciLAogIDB4MjMyYSwKICAiYW5nYnJhY2tldHJpZ2h0YmlnIiwKICAweDIzMmEsCiAgImFuZ2JyYWNrZXRyaWdodEJpZ2ciLAogIDB4MjMyYSwKICAiYW5nYnJhY2tldHJpZ2h0YmlnZyIsCiAgMHgyMzJhLAogICJhcnJvd2hvb2tsZWZ0IiwKICAweDIxYWEsCiAgImFycm93aG9va3JpZ2h0IiwKICAweDIxYTksCiAgImFycm93bGVmdHRvcGhhbGYiLAogIDB4MjFiYywKICAiYXJyb3dsZWZ0Ym90aGFsZiIsCiAgMHgyMWJkLAogICJhcnJvd25vcnRoZWFzdCIsCiAgMHgyMTk3LAogICJhcnJvd25vcnRod2VzdCIsCiAgMHgyMTk2LAogICJhcnJvd3JpZ2h0dG9waGFsZiIsCiAgMHgyMWMwLAogICJhcnJvd3JpZ2h0Ym90aGFsZiIsCiAgMHgyMWMxLAogICJhcnJvd3NvdXRoZWFzdCIsCiAgMHgyMTk4LAogICJhcnJvd3NvdXRod2VzdCIsCiAgMHgyMTk5LAogICJiYWNrc2xhc2hiaWciLAogIDB4MjIxNiwKICAiYmFja3NsYXNoQmlnIiwKICAweDIyMTYsCiAgImJhY2tzbGFzaEJpZ2ciLAogIDB4MjIxNiwKICAiYmFja3NsYXNoYmlnZyIsCiAgMHgyMjE2LAogICJiYXJkYmwiLAogIDB4MjAxNiwKICAiYnJhY2VodGlwZG93bmxlZnQiLAogIDB4ZmUzNywKICAiYnJhY2VodGlwZG93bnJpZ2h0IiwKICAweGZlMzcsCiAgImJyYWNlaHRpcHVwbGVmdCIsCiAgMHhmZTM4LAogICJicmFjZWh0aXB1cHJpZ2h0IiwKICAweGZlMzgsCiAgImJyYWNlbGVmdEJpZyIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRiaWciLAogIDB4MDA3YiwKICAiYnJhY2VsZWZ0YmlnZyIsCiAgMHgwMDdiLAogICJicmFjZWxlZnRCaWdnIiwKICAweDAwN2IsCiAgImJyYWNlcmlnaHRCaWciLAogIDB4MDA3ZCwKICAiYnJhY2VyaWdodGJpZyIsCiAgMHgwMDdkLAogICJicmFjZXJpZ2h0YmlnZyIsCiAgMHgwMDdkLAogICJicmFjZXJpZ2h0QmlnZyIsCiAgMHgwMDdkLAogICJicmFja2V0bGVmdGJpZyIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdEJpZyIsCiAgMHgwMDViLAogICJicmFja2V0bGVmdGJpZ2ciLAogIDB4MDA1YiwKICAiYnJhY2tldGxlZnRCaWdnIiwKICAweDAwNWIsCiAgImJyYWNrZXRyaWdodEJpZyIsCiAgMHgwMDVkLAogICJicmFja2V0cmlnaHRiaWciLAogIDB4MDA1ZCwKICAiYnJhY2tldHJpZ2h0YmlnZyIsCiAgMHgwMDVkLAogICJicmFja2V0cmlnaHRCaWdnIiwKICAweDAwNWQsCiAgImNlaWxpbmdsZWZ0YmlnIiwKICAweDIzMDgsCiAgImNlaWxpbmdsZWZ0QmlnIiwKICAweDIzMDgsCiAgImNlaWxpbmdsZWZ0QmlnZyIsCiAgMHgyMzA4LAogICJjZWlsaW5nbGVmdGJpZ2ciLAogIDB4MjMwOCwKICAiY2VpbGluZ3JpZ2h0YmlnIiwKICAweDIzMDksCiAgImNlaWxpbmdyaWdodEJpZyIsCiAgMHgyMzA5LAogICJjZWlsaW5ncmlnaHRiaWdnIiwKICAweDIzMDksCiAgImNlaWxpbmdyaWdodEJpZ2ciLAogIDB4MjMwOSwKICAiY2lyY2xlZG90ZGlzcGxheSIsCiAgMHgyMjk5LAogICJjaXJjbGVkb3R0ZXh0IiwKICAweDIyOTksCiAgImNpcmNsZW11bHRpcGx5ZGlzcGxheSIsCiAgMHgyMjk3LAogICJjaXJjbGVtdWx0aXBseXRleHQiLAogIDB4MjI5NywKICAiY2lyY2xlcGx1c2Rpc3BsYXkiLAogIDB4MjI5NSwKICAiY2lyY2xlcGx1c3RleHQiLAogIDB4MjI5NSwKICAiY29udGludGVncmFsZGlzcGxheSIsCiAgMHgyMjJlLAogICJjb250aW50ZWdyYWx0ZXh0IiwKICAweDIyMmUsCiAgImNvcHJvZHVjdGRpc3BsYXkiLAogIDB4MjIxMCwKICAiY29wcm9kdWN0dGV4dCIsCiAgMHgyMjEwLAogICJmbG9vcmxlZnRCaWciLAogIDB4MjMwYSwKICAiZmxvb3JsZWZ0YmlnIiwKICAweDIzMGEsCiAgImZsb29ybGVmdGJpZ2ciLAogIDB4MjMwYSwKICAiZmxvb3JsZWZ0QmlnZyIsCiAgMHgyMzBhLAogICJmbG9vcnJpZ2h0YmlnIiwKICAweDIzMGIsCiAgImZsb29ycmlnaHRCaWciLAogIDB4MjMwYiwKICAiZmxvb3JyaWdodEJpZ2ciLAogIDB4MjMwYiwKICAiZmxvb3JyaWdodGJpZ2ciLAogIDB4MjMwYiwKICAiaGF0d2lkZSIsCiAgMHgwMzAyLAogICJoYXR3aWRlciIsCiAgMHgwMzAyLAogICJoYXR3aWRlc3QiLAogIDB4MDMwMiwKICAiaW50ZXJjYWwiLAogIDB4MWQ0MCwKICAiaW50ZWdyYWxkaXNwbGF5IiwKICAweDIyMmIsCiAgImludGVncmFsdGV4dCIsCiAgMHgyMjJiLAogICJpbnRlcnNlY3Rpb25kaXNwbGF5IiwKICAweDIyYzIsCiAgImludGVyc2VjdGlvbnRleHQiLAogIDB4MjJjMiwKICAibG9naWNhbGFuZGRpc3BsYXkiLAogIDB4MjIyNywKICAibG9naWNhbGFuZHRleHQiLAogIDB4MjIyNywKICAibG9naWNhbG9yZGlzcGxheSIsCiAgMHgyMjI4LAogICJsb2dpY2Fsb3J0ZXh0IiwKICAweDIyMjgsCiAgInBhcmVubGVmdEJpZyIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRiaWciLAogIDB4MDAyOCwKICAicGFyZW5sZWZ0QmlnZyIsCiAgMHgwMDI4LAogICJwYXJlbmxlZnRiaWdnIiwKICAweDAwMjgsCiAgInBhcmVucmlnaHRCaWciLAogIDB4MDAyOSwKICAicGFyZW5yaWdodGJpZyIsCiAgMHgwMDI5LAogICJwYXJlbnJpZ2h0QmlnZyIsCiAgMHgwMDI5LAogICJwYXJlbnJpZ2h0YmlnZyIsCiAgMHgwMDI5LAogICJwcmltZSIsCiAgMHgyMDMyLAogICJwcm9kdWN0ZGlzcGxheSIsCiAgMHgyMjBmLAogICJwcm9kdWN0dGV4dCIsCiAgMHgyMjBmLAogICJyYWRpY2FsYmlnIiwKICAweDIyMWEsCiAgInJhZGljYWxCaWciLAogIDB4MjIxYSwKICAicmFkaWNhbEJpZ2ciLAogIDB4MjIxYSwKICAicmFkaWNhbGJpZ2ciLAogIDB4MjIxYSwKICAicmFkaWNhbGJ0IiwKICAweDIyMWEsCiAgInJhZGljYWx0cCIsCiAgMHgyMjFhLAogICJyYWRpY2FsdmVydGV4IiwKICAweDIyMWEsCiAgInNsYXNoYmlnIiwKICAweDAwMmYsCiAgInNsYXNoQmlnIiwKICAweDAwMmYsCiAgInNsYXNoQmlnZyIsCiAgMHgwMDJmLAogICJzbGFzaGJpZ2ciLAogIDB4MDAyZiwKICAic3VtbWF0aW9uZGlzcGxheSIsCiAgMHgyMjExLAogICJzdW1tYXRpb250ZXh0IiwKICAweDIyMTEsCiAgInRpbGRld2lkZSIsCiAgMHgwMmRjLAogICJ0aWxkZXdpZGVyIiwKICAweDAyZGMsCiAgInRpbGRld2lkZXN0IiwKICAweDAyZGMsCiAgInVuaW9uZGlzcGxheSIsCiAgMHgyMmMzLAogICJ1bmlvbm11bHRpZGlzcGxheSIsCiAgMHgyMjhlLAogICJ1bmlvbm11bHRpdGV4dCIsCiAgMHgyMjhlLAogICJ1bmlvbnNxZGlzcGxheSIsCiAgMHgyMjk0LAogICJ1bmlvbnNxdGV4dCIsCiAgMHgyMjk0LAogICJ1bmlvbnRleHQiLAogIDB4MjJjMywKICAidmV4dGVuZGRvdWJsZSIsCiAgMHgyMjI1LAogICJ2ZXh0ZW5kc2luZ2xlIiwKICAweDIyMjMKIF07Cn0pOwpjb25zdCBnZXREaW5nYmF0c0dseXBoc1VuaWNvZGUgPSAoMCxfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fLmdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAoKSB7CiByZXR1cm4gWwogICJzcGFjZSIsCiAgMHgwMDIwLAogICJhMSIsCiAgMHgyNzAxLAogICJhMiIsCiAgMHgyNzAyLAogICJhMjAyIiwKICAweDI3MDMsCiAgImEzIiwKICAweDI3MDQsCiAgImE0IiwKICAweDI2MGUsCiAgImE1IiwKICAweDI3MDYsCiAgImExMTkiLAogIDB4MjcwNywKICAiYTExOCIsCiAgMHgyNzA4LAogICJhMTE3IiwKICAweDI3MDksCiAgImExMSIsCiAgMHgyNjFiLAogICJhMTIiLAogIDB4MjYxZSwKICAiYTEzIiwKICAweDI3MGMsCiAgImExNCIsCiAgMHgyNzBkLAogICJhMTUiLAogIDB4MjcwZSwKICAiYTE2IiwKICAweDI3MGYsCiAgImExMDUiLAogIDB4MjcxMCwKICAiYTE3IiwKICAweDI3MTEsCiAgImExOCIsCiAgMHgyNzEyLAogICJhMTkiLAogIDB4MjcxMywKICAiYTIwIiwKICAweDI3MTQsCiAgImEyMSIsCiAgMHgyNzE1LAogICJhMjIiLAogIDB4MjcxNiwKICAiYTIzIiwKICAweDI3MTcsCiAgImEyNCIsCiAgMHgyNzE4LAogICJhMjUiLAogIDB4MjcxOSwKICAiYTI2IiwKICAweDI3MWEsCiAgImEyNyIsCiAgMHgyNzFiLAogICJhMjgiLAogIDB4MjcxYywKICAiYTYiLAogIDB4MjcxZCwKICAiYTciLAogIDB4MjcxZSwKICAiYTgiLAogIDB4MjcxZiwKICAiYTkiLAogIDB4MjcyMCwKICAiYTEwIiwKICAweDI3MjEsCiAgImEyOSIsCiAgMHgyNzIyLAogICJhMzAiLAogIDB4MjcyMywKICAiYTMxIiwKICAweDI3MjQsCiAgImEzMiIsCiAgMHgyNzI1LAogICJhMzMiLAogIDB4MjcyNiwKICAiYTM0IiwKICAweDI3MjcsCiAgImEzNSIsCiAgMHgyNjA1LAogICJhMzYiLAogIDB4MjcyOSwKICAiYTM3IiwKICAweDI3MmEsCiAgImEzOCIsCiAgMHgyNzJiLAogICJhMzkiLAogIDB4MjcyYywKICAiYTQwIiwKICAweDI3MmQsCiAgImE0MSIsCiAgMHgyNzJlLAogICJhNDIiLAogIDB4MjcyZiwKICAiYTQzIiwKICAweDI3MzAsCiAgImE0NCIsCiAgMHgyNzMxLAogICJhNDUiLAogIDB4MjczMiwKICAiYTQ2IiwKICAweDI3MzMsCiAgImE0NyIsCiAgMHgyNzM0LAogICJhNDgiLAogIDB4MjczNSwKICAiYTQ5IiwKICAweDI3MzYsCiAgImE1MCIsCiAgMHgyNzM3LAogICJhNTEiLAogIDB4MjczOCwKICAiYTUyIiwKICAweDI3MzksCiAgImE1MyIsCiAgMHgyNzNhLAogICJhNTQiLAogIDB4MjczYiwKICAiYTU1IiwKICAweDI3M2MsCiAgImE1NiIsCiAgMHgyNzNkLAogICJhNTciLAogIDB4MjczZSwKICAiYTU4IiwKICAweDI3M2YsCiAgImE1OSIsCiAgMHgyNzQwLAogICJhNjAiLAogIDB4Mjc0MSwKICAiYTYxIiwKICAweDI3NDIsCiAgImE2MiIsCiAgMHgyNzQzLAogICJhNjMiLAogIDB4Mjc0NCwKICAiYTY0IiwKICAweDI3NDUsCiAgImE2NSIsCiAgMHgyNzQ2LAogICJhNjYiLAogIDB4Mjc0NywKICAiYTY3IiwKICAweDI3NDgsCiAgImE2OCIsCiAgMHgyNzQ5LAogICJhNjkiLAogIDB4Mjc0YSwKICAiYTcwIiwKICAweDI3NGIsCiAgImE3MSIsCiAgMHgyNWNmLAogICJhNzIiLAogIDB4Mjc0ZCwKICAiYTczIiwKICAweDI1YTAsCiAgImE3NCIsCiAgMHgyNzRmLAogICJhMjAzIiwKICAweDI3NTAsCiAgImE3NSIsCiAgMHgyNzUxLAogICJhMjA0IiwKICAweDI3NTIsCiAgImE3NiIsCiAgMHgyNWIyLAogICJhNzciLAogIDB4MjViYywKICAiYTc4IiwKICAweDI1YzYsCiAgImE3OSIsCiAgMHgyNzU2LAogICJhODEiLAogIDB4MjVkNywKICAiYTgyIiwKICAweDI3NTgsCiAgImE4MyIsCiAgMHgyNzU5LAogICJhODQiLAogIDB4Mjc1YSwKICAiYTk3IiwKICAweDI3NWIsCiAgImE5OCIsCiAgMHgyNzVjLAogICJhOTkiLAogIDB4Mjc1ZCwKICAiYTEwMCIsCiAgMHgyNzVlLAogICJhMTAxIiwKICAweDI3NjEsCiAgImExMDIiLAogIDB4Mjc2MiwKICAiYTEwMyIsCiAgMHgyNzYzLAogICJhMTA0IiwKICAweDI3NjQsCiAgImExMDYiLAogIDB4Mjc2NSwKICAiYTEwNyIsCiAgMHgyNzY2LAogICJhMTA4IiwKICAweDI3NjcsCiAgImExMTIiLAogIDB4MjY2MywKICAiYTExMSIsCiAgMHgyNjY2LAogICJhMTEwIiwKICAweDI2NjUsCiAgImExMDkiLAogIDB4MjY2MCwKICAiYTEyMCIsCiAgMHgyNDYwLAogICJhMTIxIiwKICAweDI0NjEsCiAgImExMjIiLAogIDB4MjQ2MiwKICAiYTEyMyIsCiAgMHgyNDYzLAogICJhMTI0IiwKICAweDI0NjQsCiAgImExMjUiLAogIDB4MjQ2NSwKICAiYTEyNiIsCiAgMHgyNDY2LAogICJhMTI3IiwKICAweDI0NjcsCiAgImExMjgiLAogIDB4MjQ2OCwKICAiYTEyOSIsCiAgMHgyNDY5LAogICJhMTMwIiwKICAweDI3NzYsCiAgImExMzEiLAogIDB4Mjc3NywKICAiYTEzMiIsCiAgMHgyNzc4LAogICJhMTMzIiwKICAweDI3NzksCiAgImExMzQiLAogIDB4Mjc3YSwKICAiYTEzNSIsCiAgMHgyNzdiLAogICJhMTM2IiwKICAweDI3N2MsCiAgImExMzciLAogIDB4Mjc3ZCwKICAiYTEzOCIsCiAgMHgyNzdlLAogICJhMTM5IiwKICAweDI3N2YsCiAgImExNDAiLAogIDB4Mjc4MCwKICAiYTE0MSIsCiAgMHgyNzgxLAogICJhMTQyIiwKICAweDI3ODIsCiAgImExNDMiLAogIDB4Mjc4MywKICAiYTE0NCIsCiAgMHgyNzg0LAogICJhMTQ1IiwKICAweDI3ODUsCiAgImExNDYiLAogIDB4Mjc4NiwKICAiYTE0NyIsCiAgMHgyNzg3LAogICJhMTQ4IiwKICAweDI3ODgsCiAgImExNDkiLAogIDB4Mjc4OSwKICAiYTE1MCIsCiAgMHgyNzhhLAogICJhMTUxIiwKICAweDI3OGIsCiAgImExNTIiLAogIDB4Mjc4YywKICAiYTE1MyIsCiAgMHgyNzhkLAogICJhMTU0IiwKICAweDI3OGUsCiAgImExNTUiLAogIDB4Mjc4ZiwKICAiYTE1NiIsCiAgMHgyNzkwLAogICJhMTU3IiwKICAweDI3OTEsCiAgImExNTgiLAogIDB4Mjc5MiwKICAiYTE1OSIsCiAgMHgyNzkzLAogICJhMTYwIiwKICAweDI3OTQsCiAgImExNjEiLAogIDB4MjE5MiwKICAiYTE2MyIsCiAgMHgyMTk0LAogICJhMTY0IiwKICAweDIxOTUsCiAgImExOTYiLAogIDB4Mjc5OCwKICAiYTE2NSIsCiAgMHgyNzk5LAogICJhMTkyIiwKICAweDI3OWEsCiAgImExNjYiLAogIDB4Mjc5YiwKICAiYTE2NyIsCiAgMHgyNzljLAogICJhMTY4IiwKICAweDI3OWQsCiAgImExNjkiLAogIDB4Mjc5ZSwKICAiYTE3MCIsCiAgMHgyNzlmLAogICJhMTcxIiwKICAweDI3YTAsCiAgImExNzIiLAogIDB4MjdhMSwKICAiYTE3MyIsCiAgMHgyN2EyLAogICJhMTYyIiwKICAweDI3YTMsCiAgImExNzQiLAogIDB4MjdhNCwKICAiYTE3NSIsCiAgMHgyN2E1LAogICJhMTc2IiwKICAweDI3YTYsCiAgImExNzciLAogIDB4MjdhNywKICAiYTE3OCIsCiAgMHgyN2E4LAogICJhMTc5IiwKICAweDI3YTksCiAgImExOTMiLAogIDB4MjdhYSwKICAiYTE4MCIsCiAgMHgyN2FiLAogICJhMTk5IiwKICAweDI3YWMsCiAgImExODEiLAogIDB4MjdhZCwKICAiYTIwMCIsCiAgMHgyN2FlLAogICJhMTgyIiwKICAweDI3YWYsCiAgImEyMDEiLAogIDB4MjdiMSwKICAiYTE4MyIsCiAgMHgyN2IyLAogICJhMTg0IiwKICAweDI3YjMsCiAgImExOTciLAogIDB4MjdiNCwKICAiYTE4NSIsCiAgMHgyN2I1LAogICJhMTk0IiwKICAweDI3YjYsCiAgImExOTgiLAogIDB4MjdiNywKICAiYTE4NiIsCiAgMHgyN2I4LAogICJhMTk1IiwKICAweDI3YjksCiAgImExODciLAogIDB4MjdiYSwKICAiYTE4OCIsCiAgMHgyN2JiLAogICJhMTg5IiwKICAweDI3YmMsCiAgImExOTAiLAogIDB4MjdiZCwKICAiYTE5MSIsCiAgMHgyN2JlLAogICJhODkiLAogIDB4Mjc2OCwKICAiYTkwIiwKICAweDI3NjksCiAgImE5MyIsCiAgMHgyNzZhLAogICJhOTQiLAogIDB4Mjc2YiwKICAiYTkxIiwKICAweDI3NmMsCiAgImE5MiIsCiAgMHgyNzZkLAogICJhMjA1IiwKICAweDI3NmUsCiAgImE4NSIsCiAgMHgyNzZmLAogICJhMjA2IiwKICAweDI3NzAsCiAgImE4NiIsCiAgMHgyNzcxLAogICJhODciLAogIDB4Mjc3MiwKICAiYTg4IiwKICAweDI3NzMsCiAgImE5NSIsCiAgMHgyNzc0LAogICJhOTYiLAogIDB4Mjc3NSwKICAiLm5vdGRlZiIsCiAgMHgwMDAwCiBdOwp9KTsKCgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKX193X3BkZmpzX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pOwovKiBoYXJtb255IGV4cG9ydCAqLyBfX3dfcGRmanNfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgewovKiBoYXJtb255IGV4cG9ydCAqLyAgICJjbGVhclVuaWNvZGVDYWNoZXMiOiAoKSA9PiAoLyogYmluZGluZyAqLyBjbGVhclVuaWNvZGVDYWNoZXMpLAovKiBoYXJtb255IGV4cG9ydCAqLyAgICJnZXRDaGFyVW5pY29kZUNhdGVnb3J5IjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gZ2V0Q2hhclVuaWNvZGVDYXRlZ29yeSksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldE5vcm1hbGl6ZWRVbmljb2RlcyI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldE5vcm1hbGl6ZWRVbmljb2RlcyksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldFVuaWNvZGVGb3JHbHlwaCI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldFVuaWNvZGVGb3JHbHlwaCksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgImdldFVuaWNvZGVSYW5nZUZvciI6ICgpID0+ICgvKiBiaW5kaW5nICovIGdldFVuaWNvZGVSYW5nZUZvciksCi8qIGhhcm1vbnkgZXhwb3J0ICovICAgIm1hcFNwZWNpYWxVbmljb2RlVmFsdWVzIjogKCkgPT4gKC8qIGJpbmRpbmcgKi8gbWFwU3BlY2lhbFVuaWNvZGVWYWx1ZXMpLAovKiBoYXJtb255IGV4cG9ydCAqLyAgICJyZXZlcnNlSWZSdGwiOiAoKSA9PiAoLyogYmluZGluZyAqLyByZXZlcnNlSWZSdGwpCi8qIGhhcm1vbnkgZXhwb3J0ICovIH0pOwovKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX2NvcmVfdXRpbHNfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgpjb25zdCBnZXRTcGVjaWFsUFVBU3ltYm9scyA9ICgwLF9jb3JlX3V0aWxzX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18uZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogdFs2MzcyMV0gPSAweDAwYTk7CiB0WzYzMTkzXSA9IDB4MDBhOTsKIHRbNjM3MjBdID0gMHgwMGFlOwogdFs2MzE5NF0gPSAweDAwYWU7CiB0WzYzNzIyXSA9IDB4MjEyMjsKIHRbNjMxOTVdID0gMHgyMTIyOwogdFs2MzcyOV0gPSAweDIzYTc7CiB0WzYzNzMwXSA9IDB4MjNhODsKIHRbNjM3MzFdID0gMHgyM2E5OwogdFs2Mzc0MF0gPSAweDIzYWI7CiB0WzYzNzQxXSA9IDB4MjNhYzsKIHRbNjM3NDJdID0gMHgyM2FkOwogdFs2MzcyNl0gPSAweDIzYTE7CiB0WzYzNzI3XSA9IDB4MjNhMjsKIHRbNjM3MjhdID0gMHgyM2EzOwogdFs2MzczN10gPSAweDIzYTQ7CiB0WzYzNzM4XSA9IDB4MjNhNTsKIHRbNjM3MzldID0gMHgyM2E2OwogdFs2MzcyM10gPSAweDIzOWI7CiB0WzYzNzI0XSA9IDB4MjM5YzsKIHRbNjM3MjVdID0gMHgyMzlkOwogdFs2MzczNF0gPSAweDIzOWU7CiB0WzYzNzM1XSA9IDB4MjM5ZjsKIHRbNjM3MzZdID0gMHgyM2EwOwp9KTsKZnVuY3Rpb24gbWFwU3BlY2lhbFVuaWNvZGVWYWx1ZXMoY29kZSkgewogaWYgKGNvZGUgPj0gMHhmZmYwICYmIGNvZGUgPD0gMHhmZmZmKSB7CiAgcmV0dXJuIDA7CiB9IGVsc2UgaWYgKGNvZGUgPj0gMHhmNjAwICYmIGNvZGUgPD0gMHhmOGZmKSB7CiAgcmV0dXJuIGdldFNwZWNpYWxQVUFTeW1ib2xzKClbY29kZV0gfHwgY29kZTsKIH0gZWxzZSBpZiAoY29kZSA9PT0gMHgwMGFkKSB7CiAgcmV0dXJuIDB4MDAyZDsKIH0KIHJldHVybiBjb2RlOwp9CmZ1bmN0aW9uIGdldFVuaWNvZGVGb3JHbHlwaChuYW1lLCBnbHlwaHNVbmljb2RlTWFwKSB7CiBsZXQgdW5pY29kZSA9IGdseXBoc1VuaWNvZGVNYXBbbmFtZV07CiBpZiAodW5pY29kZSAhPT0gdW5kZWZpbmVkKSB7CiAgcmV0dXJuIHVuaWNvZGU7CiB9CiBpZiAoIW5hbWUpIHsKICByZXR1cm4gLTE7CiB9CiBpZiAobmFtZVswXSA9PT0gInUiKSB7CiAgY29uc3QgbmFtZUxlbiA9IG5hbWUubGVuZ3RoOwogIGxldCBoZXhTdHI7CiAgaWYgKG5hbWVMZW4gPT09IDcgJiYgbmFtZVsxXSA9PT0gIm4iICYmIG5hbWVbMl0gPT09ICJpIikgewogICBoZXhTdHIgPSBuYW1lLnN1YnN0cmluZygzKTsKICB9IGVsc2UgaWYgKG5hbWVMZW4gPj0gNSAmJiBuYW1lTGVuIDw9IDcpIHsKICAgaGV4U3RyID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgfSBlbHNlIHsKICAgcmV0dXJuIC0xOwogIH0KICBpZiAoaGV4U3RyID09PSBoZXhTdHIudG9VcHBlckNhc2UoKSkgewogICB1bmljb2RlID0gcGFyc2VJbnQoaGV4U3RyLCAxNik7CiAgIGlmICh1bmljb2RlID49IDApIHsKICAgIHJldHVybiB1bmljb2RlOwogICB9CiAgfQogfQogcmV0dXJuIC0xOwp9CmNvbnN0IFVuaWNvZGVSYW5nZXMgPSBbCiB7CiAgYmVnaW46IDB4MDAwMCwKICBlbmQ6IDB4MDA3ZgogfSwKIHsKICBiZWdpbjogMHgwMDgwLAogIGVuZDogMHgwMGZmCiB9LAogewogIGJlZ2luOiAweDAxMDAsCiAgZW5kOiAweDAxN2YKIH0sCiB7CiAgYmVnaW46IDB4MDE4MCwKICBlbmQ6IDB4MDI0ZgogfSwKIHsKICBiZWdpbjogMHgwMjUwLAogIGVuZDogMHgwMmFmCiB9LAogewogIGJlZ2luOiAweDAyYjAsCiAgZW5kOiAweDAyZmYKIH0sCiB7CiAgYmVnaW46IDB4MDMwMCwKICBlbmQ6IDB4MDM2ZgogfSwKIHsKICBiZWdpbjogMHgwMzcwLAogIGVuZDogMHgwM2ZmCiB9LAogewogIGJlZ2luOiAweDJjODAsCiAgZW5kOiAweDJjZmYKIH0sCiB7CiAgYmVnaW46IDB4MDQwMCwKICBlbmQ6IDB4MDRmZgogfSwKIHsKICBiZWdpbjogMHgwNTMwLAogIGVuZDogMHgwNThmCiB9LAogewogIGJlZ2luOiAweDA1OTAsCiAgZW5kOiAweDA1ZmYKIH0sCiB7CiAgYmVnaW46IDB4YTUwMCwKICBlbmQ6IDB4YTYzZgogfSwKIHsKICBiZWdpbjogMHgwNjAwLAogIGVuZDogMHgwNmZmCiB9LAogewogIGJlZ2luOiAweDA3YzAsCiAgZW5kOiAweDA3ZmYKIH0sCiB7CiAgYmVnaW46IDB4MDkwMCwKICBlbmQ6IDB4MDk3ZgogfSwKIHsKICBiZWdpbjogMHgwOTgwLAogIGVuZDogMHgwOWZmCiB9LAogewogIGJlZ2luOiAweDBhMDAsCiAgZW5kOiAweDBhN2YKIH0sCiB7CiAgYmVnaW46IDB4MGE4MCwKICBlbmQ6IDB4MGFmZgogfSwKIHsKICBiZWdpbjogMHgwYjAwLAogIGVuZDogMHgwYjdmCiB9LAogewogIGJlZ2luOiAweDBiODAsCiAgZW5kOiAweDBiZmYKIH0sCiB7CiAgYmVnaW46IDB4MGMwMCwKICBlbmQ6IDB4MGM3ZgogfSwKIHsKICBiZWdpbjogMHgwYzgwLAogIGVuZDogMHgwY2ZmCiB9LAogewogIGJlZ2luOiAweDBkMDAsCiAgZW5kOiAweDBkN2YKIH0sCiB7CiAgYmVnaW46IDB4MGUwMCwKICBlbmQ6IDB4MGU3ZgogfSwKIHsKICBiZWdpbjogMHgwZTgwLAogIGVuZDogMHgwZWZmCiB9LAogewogIGJlZ2luOiAweDEwYTAsCiAgZW5kOiAweDEwZmYKIH0sCiB7CiAgYmVnaW46IDB4MWIwMCwKICBlbmQ6IDB4MWI3ZgogfSwKIHsKICBiZWdpbjogMHgxMTAwLAogIGVuZDogMHgxMWZmCiB9LAogewogIGJlZ2luOiAweDFlMDAsCiAgZW5kOiAweDFlZmYKIH0sCiB7CiAgYmVnaW46IDB4MWYwMCwKICBlbmQ6IDB4MWZmZgogfSwKIHsKICBiZWdpbjogMHgyMDAwLAogIGVuZDogMHgyMDZmCiB9LAogewogIGJlZ2luOiAweDIwNzAsCiAgZW5kOiAweDIwOWYKIH0sCiB7CiAgYmVnaW46IDB4MjBhMCwKICBlbmQ6IDB4MjBjZgogfSwKIHsKICBiZWdpbjogMHgyMGQwLAogIGVuZDogMHgyMGZmCiB9LAogewogIGJlZ2luOiAweDIxMDAsCiAgZW5kOiAweDIxNGYKIH0sCiB7CiAgYmVnaW46IDB4MjE1MCwKICBlbmQ6IDB4MjE4ZgogfSwKIHsKICBiZWdpbjogMHgyMTkwLAogIGVuZDogMHgyMWZmCiB9LAogewogIGJlZ2luOiAweDIyMDAsCiAgZW5kOiAweDIyZmYKIH0sCiB7CiAgYmVnaW46IDB4MjMwMCwKICBlbmQ6IDB4MjNmZgogfSwKIHsKICBiZWdpbjogMHgyNDAwLAogIGVuZDogMHgyNDNmCiB9LAogewogIGJlZ2luOiAweDI0NDAsCiAgZW5kOiAweDI0NWYKIH0sCiB7CiAgYmVnaW46IDB4MjQ2MCwKICBlbmQ6IDB4MjRmZgogfSwKIHsKICBiZWdpbjogMHgyNTAwLAogIGVuZDogMHgyNTdmCiB9LAogewogIGJlZ2luOiAweDI1ODAsCiAgZW5kOiAweDI1OWYKIH0sCiB7CiAgYmVnaW46IDB4MjVhMCwKICBlbmQ6IDB4MjVmZgogfSwKIHsKICBiZWdpbjogMHgyNjAwLAogIGVuZDogMHgyNmZmCiB9LAogewogIGJlZ2luOiAweDI3MDAsCiAgZW5kOiAweDI3YmYKIH0sCiB7CiAgYmVnaW46IDB4MzAwMCwKICBlbmQ6IDB4MzAzZgogfSwKIHsKICBiZWdpbjogMHgzMDQwLAogIGVuZDogMHgzMDlmCiB9LAogewogIGJlZ2luOiAweDMwYTAsCiAgZW5kOiAweDMwZmYKIH0sCiB7CiAgYmVnaW46IDB4MzEwMCwKICBlbmQ6IDB4MzEyZgogfSwKIHsKICBiZWdpbjogMHgzMTMwLAogIGVuZDogMHgzMThmCiB9LAogewogIGJlZ2luOiAweGE4NDAsCiAgZW5kOiAweGE4N2YKIH0sCiB7CiAgYmVnaW46IDB4MzIwMCwKICBlbmQ6IDB4MzJmZgogfSwKIHsKICBiZWdpbjogMHgzMzAwLAogIGVuZDogMHgzM2ZmCiB9LAogewogIGJlZ2luOiAweGFjMDAsCiAgZW5kOiAweGQ3YWYKIH0sCiB7CiAgYmVnaW46IDB4ZDgwMCwKICBlbmQ6IDB4ZGZmZgogfSwKIHsKICBiZWdpbjogMHgxMDkwMCwKICBlbmQ6IDB4MTA5MWYKIH0sCiB7CiAgYmVnaW46IDB4NGUwMCwKICBlbmQ6IDB4OWZmZgogfSwKIHsKICBiZWdpbjogMHhlMDAwLAogIGVuZDogMHhmOGZmCiB9LAogewogIGJlZ2luOiAweDMxYzAsCiAgZW5kOiAweDMxZWYKIH0sCiB7CiAgYmVnaW46IDB4ZmIwMCwKICBlbmQ6IDB4ZmI0ZgogfSwKIHsKICBiZWdpbjogMHhmYjUwLAogIGVuZDogMHhmZGZmCiB9LAogewogIGJlZ2luOiAweGZlMjAsCiAgZW5kOiAweGZlMmYKIH0sCiB7CiAgYmVnaW46IDB4ZmUxMCwKICBlbmQ6IDB4ZmUxZgogfSwKIHsKICBiZWdpbjogMHhmZTUwLAogIGVuZDogMHhmZTZmCiB9LAogewogIGJlZ2luOiAweGZlNzAsCiAgZW5kOiAweGZlZmYKIH0sCiB7CiAgYmVnaW46IDB4ZmYwMCwKICBlbmQ6IDB4ZmZlZgogfSwKIHsKICBiZWdpbjogMHhmZmYwLAogIGVuZDogMHhmZmZmCiB9LAogewogIGJlZ2luOiAweDBmMDAsCiAgZW5kOiAweDBmZmYKIH0sCiB7CiAgYmVnaW46IDB4MDcwMCwKICBlbmQ6IDB4MDc0ZgogfSwKIHsKICBiZWdpbjogMHgwNzgwLAogIGVuZDogMHgwN2JmCiB9LAogewogIGJlZ2luOiAweDBkODAsCiAgZW5kOiAweDBkZmYKIH0sCiB7CiAgYmVnaW46IDB4MTAwMCwKICBlbmQ6IDB4MTA5ZgogfSwKIHsKICBiZWdpbjogMHgxMjAwLAogIGVuZDogMHgxMzdmCiB9LAogewogIGJlZ2luOiAweDEzYTAsCiAgZW5kOiAweDEzZmYKIH0sCiB7CiAgYmVnaW46IDB4MTQwMCwKICBlbmQ6IDB4MTY3ZgogfSwKIHsKICBiZWdpbjogMHgxNjgwLAogIGVuZDogMHgxNjlmCiB9LAogewogIGJlZ2luOiAweDE2YTAsCiAgZW5kOiAweDE2ZmYKIH0sCiB7CiAgYmVnaW46IDB4MTc4MCwKICBlbmQ6IDB4MTdmZgogfSwKIHsKICBiZWdpbjogMHgxODAwLAogIGVuZDogMHgxOGFmCiB9LAogewogIGJlZ2luOiAweDI4MDAsCiAgZW5kOiAweDI4ZmYKIH0sCiB7CiAgYmVnaW46IDB4YTAwMCwKICBlbmQ6IDB4YTQ4ZgogfSwKIHsKICBiZWdpbjogMHgxNzAwLAogIGVuZDogMHgxNzFmCiB9LAogewogIGJlZ2luOiAweDEwMzAwLAogIGVuZDogMHgxMDMyZgogfSwKIHsKICBiZWdpbjogMHgxMDMzMCwKICBlbmQ6IDB4MTAzNGYKIH0sCiB7CiAgYmVnaW46IDB4MTA0MDAsCiAgZW5kOiAweDEwNDRmCiB9LAogewogIGJlZ2luOiAweDFkMDAwLAogIGVuZDogMHgxZDBmZgogfSwKIHsKICBiZWdpbjogMHgxZDQwMCwKICBlbmQ6IDB4MWQ3ZmYKIH0sCiB7CiAgYmVnaW46IDB4ZmYwMDAsCiAgZW5kOiAweGZmZmZkCiB9LAogewogIGJlZ2luOiAweGZlMDAsCiAgZW5kOiAweGZlMGYKIH0sCiB7CiAgYmVnaW46IDB4ZTAwMDAsCiAgZW5kOiAweGUwMDdmCiB9LAogewogIGJlZ2luOiAweDE5MDAsCiAgZW5kOiAweDE5NGYKIH0sCiB7CiAgYmVnaW46IDB4MTk1MCwKICBlbmQ6IDB4MTk3ZgogfSwKIHsKICBiZWdpbjogMHgxOTgwLAogIGVuZDogMHgxOWRmCiB9LAogewogIGJlZ2luOiAweDFhMDAsCiAgZW5kOiAweDFhMWYKIH0sCiB7CiAgYmVnaW46IDB4MmMwMCwKICBlbmQ6IDB4MmM1ZgogfSwKIHsKICBiZWdpbjogMHgyZDMwLAogIGVuZDogMHgyZDdmCiB9LAogewogIGJlZ2luOiAweDRkYzAsCiAgZW5kOiAweDRkZmYKIH0sCiB7CiAgYmVnaW46IDB4YTgwMCwKICBlbmQ6IDB4YTgyZgogfSwKIHsKICBiZWdpbjogMHgxMDAwMCwKICBlbmQ6IDB4MTAwN2YKIH0sCiB7CiAgYmVnaW46IDB4MTAxNDAsCiAgZW5kOiAweDEwMThmCiB9LAogewogIGJlZ2luOiAweDEwMzgwLAogIGVuZDogMHgxMDM5ZgogfSwKIHsKICBiZWdpbjogMHgxMDNhMCwKICBlbmQ6IDB4MTAzZGYKIH0sCiB7CiAgYmVnaW46IDB4MTA0NTAsCiAgZW5kOiAweDEwNDdmCiB9LAogewogIGJlZ2luOiAweDEwNDgwLAogIGVuZDogMHgxMDRhZgogfSwKIHsKICBiZWdpbjogMHgxMDgwMCwKICBlbmQ6IDB4MTA4M2YKIH0sCiB7CiAgYmVnaW46IDB4MTBhMDAsCiAgZW5kOiAweDEwYTVmCiB9LAogewogIGJlZ2luOiAweDFkMzAwLAogIGVuZDogMHgxZDM1ZgogfSwKIHsKICBiZWdpbjogMHgxMjAwMCwKICBlbmQ6IDB4MTIzZmYKIH0sCiB7CiAgYmVnaW46IDB4MWQzNjAsCiAgZW5kOiAweDFkMzdmCiB9LAogewogIGJlZ2luOiAweDFiODAsCiAgZW5kOiAweDFiYmYKIH0sCiB7CiAgYmVnaW46IDB4MWMwMCwKICBlbmQ6IDB4MWM0ZgogfSwKIHsKICBiZWdpbjogMHgxYzUwLAogIGVuZDogMHgxYzdmCiB9LAogewogIGJlZ2luOiAweGE4ODAsCiAgZW5kOiAweGE4ZGYKIH0sCiB7CiAgYmVnaW46IDB4YTkwMCwKICBlbmQ6IDB4YTkyZgogfSwKIHsKICBiZWdpbjogMHhhOTMwLAogIGVuZDogMHhhOTVmCiB9LAogewogIGJlZ2luOiAweGFhMDAsCiAgZW5kOiAweGFhNWYKIH0sCiB7CiAgYmVnaW46IDB4MTAxOTAsCiAgZW5kOiAweDEwMWNmCiB9LAogewogIGJlZ2luOiAweDEwMWQwLAogIGVuZDogMHgxMDFmZgogfSwKIHsKICBiZWdpbjogMHgxMDJhMCwKICBlbmQ6IDB4MTAyZGYKIH0sCiB7CiAgYmVnaW46IDB4MWYwMzAsCiAgZW5kOiAweDFmMDlmCiB9Cl07CmZ1bmN0aW9uIGdldFVuaWNvZGVSYW5nZUZvcih2YWx1ZSkgewogZm9yIChsZXQgaSA9IDAsIGlpID0gVW5pY29kZVJhbmdlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgY29uc3QgcmFuZ2UgPSBVbmljb2RlUmFuZ2VzW2ldOwogIGlmICh2YWx1ZSA+PSByYW5nZS5iZWdpbiAmJiB2YWx1ZSA8IHJhbmdlLmVuZCkgewogICByZXR1cm4gaTsKICB9CiB9CiByZXR1cm4gLTE7Cn0KZnVuY3Rpb24gaXNSVExSYW5nZUZvcih2YWx1ZSkgewogbGV0IHJhbmdlID0gVW5pY29kZVJhbmdlc1sxM107CiBpZiAodmFsdWUgPj0gcmFuZ2UuYmVnaW4gJiYgdmFsdWUgPCByYW5nZS5lbmQpIHsKICByZXR1cm4gdHJ1ZTsKIH0KIHJhbmdlID0gVW5pY29kZVJhbmdlc1sxMV07CiBpZiAodmFsdWUgPj0gcmFuZ2UuYmVnaW4gJiYgdmFsdWUgPCByYW5nZS5lbmQpIHsKICByZXR1cm4gdHJ1ZTsKIH0KIHJldHVybiBmYWxzZTsKfQpjb25zdCBnZXROb3JtYWxpemVkVW5pY29kZXMgPSAoMCxfY29yZV91dGlsc19qc19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fLmdldEFycmF5TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAoKSB7CiByZXR1cm4gWwogICJcdTAwQTgiLAogICJcdTAwMjBcdTAzMDgiLAogICJcdTAwQUYiLAogICJcdTAwMjBcdTAzMDQiLAogICJcdTAwQjQiLAogICJcdTAwMjBcdTAzMDEiLAogICJcdTAwQjUiLAogICJcdTAzQkMiLAogICJcdTAwQjgiLAogICJcdTAwMjBcdTAzMjciLAogICJcdTAxMzIiLAogICJcdTAwNDlcdTAwNEEiLAogICJcdTAxMzMiLAogICJcdTAwNjlcdTAwNkEiLAogICJcdTAxM0YiLAogICJcdTAwNENcdTAwQjciLAogICJcdTAxNDAiLAogICJcdTAwNkNcdTAwQjciLAogICJcdTAxNDkiLAogICJcdTAyQkNcdTAwNkUiLAogICJcdTAxN0YiLAogICJcdTAwNzMiLAogICJcdTAxQzQiLAogICJcdTAwNDRcdTAxN0QiLAogICJcdTAxQzUiLAogICJcdTAwNDRcdTAxN0UiLAogICJcdTAxQzYiLAogICJcdTAwNjRcdTAxN0UiLAogICJcdTAxQzciLAogICJcdTAwNENcdTAwNEEiLAogICJcdTAxQzgiLAogICJcdTAwNENcdTAwNkEiLAogICJcdTAxQzkiLAogICJcdTAwNkNcdTAwNkEiLAogICJcdTAxQ0EiLAogICJcdTAwNEVcdTAwNEEiLAogICJcdTAxQ0IiLAogICJcdTAwNEVcdTAwNkEiLAogICJcdTAxQ0MiLAogICJcdTAwNkVcdTAwNkEiLAogICJcdTAxRjEiLAogICJcdTAwNDRcdTAwNUEiLAogICJcdTAxRjIiLAogICJcdTAwNDRcdTAwN0EiLAogICJcdTAxRjMiLAogICJcdTAwNjRcdTAwN0EiLAogICJcdTAyRDgiLAogICJcdTAwMjBcdTAzMDYiLAogICJcdTAyRDkiLAogICJcdTAwMjBcdTAzMDciLAogICJcdTAyREEiLAogICJcdTAwMjBcdTAzMEEiLAogICJcdTAyREIiLAogICJcdTAwMjBcdTAzMjgiLAogICJcdTAyREMiLAogICJcdTAwMjBcdTAzMDMiLAogICJcdTAyREQiLAogICJcdTAwMjBcdTAzMEIiLAogICJcdTAzN0EiLAogICJcdTAwMjBcdTAzNDUiLAogICJcdTAzODQiLAogICJcdTAwMjBcdTAzMDEiLAogICJcdTAzRDAiLAogICJcdTAzQjIiLAogICJcdTAzRDEiLAogICJcdTAzQjgiLAogICJcdTAzRDIiLAogICJcdTAzQTUiLAogICJcdTAzRDUiLAogICJcdTAzQzYiLAogICJcdTAzRDYiLAogICJcdTAzQzAiLAogICJcdTAzRjAiLAogICJcdTAzQkEiLAogICJcdTAzRjEiLAogICJcdTAzQzEiLAogICJcdTAzRjIiLAogICJcdTAzQzIiLAogICJcdTAzRjQiLAogICJcdTAzOTgiLAogICJcdTAzRjUiLAogICJcdTAzQjUiLAogICJcdTAzRjkiLAogICJcdTAzQTMiLAogICJcdTA1ODciLAogICJcdTA1NjVcdTA1ODIiLAogICJcdTA2NzUiLAogICJcdTA2MjdcdTA2NzQiLAogICJcdTA2NzYiLAogICJcdTA2NDhcdTA2NzQiLAogICJcdTA2NzciLAogICJcdTA2QzdcdTA2NzQiLAogICJcdTA2NzgiLAogICJcdTA2NEFcdTA2NzQiLAogICJcdTBFMzMiLAogICJcdTBFNERcdTBFMzIiLAogICJcdTBFQjMiLAogICJcdTBFQ0RcdTBFQjIiLAogICJcdTBFREMiLAogICJcdTBFQUJcdTBFOTkiLAogICJcdTBFREQiLAogICJcdTBFQUJcdTBFQTEiLAogICJcdTBGNzciLAogICJcdTBGQjJcdTBGODEiLAogICJcdTBGNzkiLAogICJcdTBGQjNcdTBGODEiLAogICJcdTFFOUEiLAogICJcdTAwNjFcdTAyQkUiLAogICJcdTFGQkQiLAogICJcdTAwMjBcdTAzMTMiLAogICJcdTFGQkYiLAogICJcdTAwMjBcdTAzMTMiLAogICJcdTFGQzAiLAogICJcdTAwMjBcdTAzNDIiLAogICJcdTFGRkUiLAogICJcdTAwMjBcdTAzMTQiLAogICJcdTIwMDIiLAogICJcdTAwMjAiLAogICJcdTIwMDMiLAogICJcdTAwMjAiLAogICJcdTIwMDQiLAogICJcdTAwMjAiLAogICJcdTIwMDUiLAogICJcdTAwMjAiLAogICJcdTIwMDYiLAogICJcdTAwMjAiLAogICJcdTIwMDgiLAogICJcdTAwMjAiLAogICJcdTIwMDkiLAogICJcdTAwMjAiLAogICJcdTIwMEEiLAogICJcdTAwMjAiLAogICJcdTIwMTciLAogICJcdTAwMjBcdTAzMzMiLAogICJcdTIwMjQiLAogICJcdTAwMkUiLAogICJcdTIwMjUiLAogICJcdTAwMkVcdTAwMkUiLAogICJcdTIwMjYiLAogICJcdTAwMkVcdTAwMkVcdTAwMkUiLAogICJcdTIwMzMiLAogICJcdTIwMzJcdTIwMzIiLAogICJcdTIwMzQiLAogICJcdTIwMzJcdTIwMzJcdTIwMzIiLAogICJcdTIwMzYiLAogICJcdTIwMzVcdTIwMzUiLAogICJcdTIwMzciLAogICJcdTIwMzVcdTIwMzVcdTIwMzUiLAogICJcdTIwM0MiLAogICJcdTAwMjFcdTAwMjEiLAogICJcdTIwM0UiLAogICJcdTAwMjBcdTAzMDUiLAogICJcdTIwNDciLAogICJcdTAwM0ZcdTAwM0YiLAogICJcdTIwNDgiLAogICJcdTAwM0ZcdTAwMjEiLAogICJcdTIwNDkiLAogICJcdTAwMjFcdTAwM0YiLAogICJcdTIwNTciLAogICJcdTIwMzJcdTIwMzJcdTIwMzJcdTIwMzIiLAogICJcdTIwNUYiLAogICJcdTAwMjAiLAogICJcdTIwQTgiLAogICJcdTAwNTJcdTAwNzMiLAogICJcdTIxMDAiLAogICJcdTAwNjFcdTAwMkZcdTAwNjMiLAogICJcdTIxMDEiLAogICJcdTAwNjFcdTAwMkZcdTAwNzMiLAogICJcdTIxMDMiLAogICJcdTAwQjBcdTAwNDMiLAogICJcdTIxMDUiLAogICJcdTAwNjNcdTAwMkZcdTAwNkYiLAogICJcdTIxMDYiLAogICJcdTAwNjNcdTAwMkZcdTAwNzUiLAogICJcdTIxMDciLAogICJcdTAxOTAiLAogICJcdTIxMDkiLAogICJcdTAwQjBcdTAwNDYiLAogICJcdTIxMTYiLAogICJcdTAwNEVcdTAwNkYiLAogICJcdTIxMjEiLAogICJcdTAwNTRcdTAwNDVcdTAwNEMiLAogICJcdTIxMzUiLAogICJcdTA1RDAiLAogICJcdTIxMzYiLAogICJcdTA1RDEiLAogICJcdTIxMzciLAogICJcdTA1RDIiLAogICJcdTIxMzgiLAogICJcdTA1RDMiLAogICJcdTIxM0IiLAogICJcdTAwNDZcdTAwNDFcdTAwNTgiLAogICJcdTIxNjAiLAogICJcdTAwNDkiLAogICJcdTIxNjEiLAogICJcdTAwNDlcdTAwNDkiLAogICJcdTIxNjIiLAogICJcdTAwNDlcdTAwNDlcdTAwNDkiLAogICJcdTIxNjMiLAogICJcdTAwNDlcdTAwNTYiLAogICJcdTIxNjQiLAogICJcdTAwNTYiLAogICJcdTIxNjUiLAogICJcdTAwNTZcdTAwNDkiLAogICJcdTIxNjYiLAogICJcdTAwNTZcdTAwNDlcdTAwNDkiLAogICJcdTIxNjciLAogICJcdTAwNTZcdTAwNDlcdTAwNDlcdTAwNDkiLAogICJcdTIxNjgiLAogICJcdTAwNDlcdTAwNTgiLAogICJcdTIxNjkiLAogICJcdTAwNTgiLAogICJcdTIxNkEiLAogICJcdTAwNThcdTAwNDkiLAogICJcdTIxNkIiLAogICJcdTAwNThcdTAwNDlcdTAwNDkiLAogICJcdTIxNkMiLAogICJcdTAwNEMiLAogICJcdTIxNkQiLAogICJcdTAwNDMiLAogICJcdTIxNkUiLAogICJcdTAwNDQiLAogICJcdTIxNkYiLAogICJcdTAwNEQiLAogICJcdTIxNzAiLAogICJcdTAwNjkiLAogICJcdTIxNzEiLAogICJcdTAwNjlcdTAwNjkiLAogICJcdTIxNzIiLAogICJcdTAwNjlcdTAwNjlcdTAwNjkiLAogICJcdTIxNzMiLAogICJcdTAwNjlcdTAwNzYiLAogICJcdTIxNzQiLAogICJcdTAwNzYiLAogICJcdTIxNzUiLAogICJcdTAwNzZcdTAwNjkiLAogICJcdTIxNzYiLAogICJcdTAwNzZcdTAwNjlcdTAwNjkiLAogICJcdTIxNzciLAogICJcdTAwNzZcdTAwNjlcdTAwNjlcdTAwNjkiLAogICJcdTIxNzgiLAogICJcdTAwNjlcdTAwNzgiLAogICJcdTIxNzkiLAogICJcdTAwNzgiLAogICJcdTIxN0EiLAogICJcdTAwNzhcdTAwNjkiLAogICJcdTIxN0IiLAogICJcdTAwNzhcdTAwNjlcdTAwNjkiLAogICJcdTIxN0MiLAogICJcdTAwNkMiLAogICJcdTIxN0QiLAogICJcdTAwNjMiLAogICJcdTIxN0UiLAogICJcdTAwNjQiLAogICJcdTIxN0YiLAogICJcdTAwNkQiLAogICJcdTIyMkMiLAogICJcdTIyMkJcdTIyMkIiLAogICJcdTIyMkQiLAogICJcdTIyMkJcdTIyMkJcdTIyMkIiLAogICJcdTIyMkYiLAogICJcdTIyMkVcdTIyMkUiLAogICJcdTIyMzAiLAogICJcdTIyMkVcdTIyMkVcdTIyMkUiLAogICJcdTI0NzQiLAogICJcdTAwMjhcdTAwMzFcdTAwMjkiLAogICJcdTI0NzUiLAogICJcdTAwMjhcdTAwMzJcdTAwMjkiLAogICJcdTI0NzYiLAogICJcdTAwMjhcdTAwMzNcdTAwMjkiLAogICJcdTI0NzciLAogICJcdTAwMjhcdTAwMzRcdTAwMjkiLAogICJcdTI0NzgiLAogICJcdTAwMjhcdTAwMzVcdTAwMjkiLAogICJcdTI0NzkiLAogICJcdTAwMjhcdTAwMzZcdTAwMjkiLAogICJcdTI0N0EiLAogICJcdTAwMjhcdTAwMzdcdTAwMjkiLAogICJcdTI0N0IiLAogICJcdTAwMjhcdTAwMzhcdTAwMjkiLAogICJcdTI0N0MiLAogICJcdTAwMjhcdTAwMzlcdTAwMjkiLAogICJcdTI0N0QiLAogICJcdTAwMjhcdTAwMzFcdTAwMzBcdTAwMjkiLAogICJcdTI0N0UiLAogICJcdTAwMjhcdTAwMzFcdTAwMzFcdTAwMjkiLAogICJcdTI0N0YiLAogICJcdTAwMjhcdTAwMzFcdTAwMzJcdTAwMjkiLAogICJcdTI0ODAiLAogICJcdTAwMjhcdTAwMzFcdTAwMzNcdTAwMjkiLAogICJcdTI0ODEiLAogICJcdTAwMjhcdTAwMzFcdTAwMzRcdTAwMjkiLAogICJcdTI0ODIiLAogICJcdTAwMjhcdTAwMzFcdTAwMzVcdTAwMjkiLAogICJcdTI0ODMiLAogICJcdTAwMjhcdTAwMzFcdTAwMzZcdTAwMjkiLAogICJcdTI0ODQiLAogICJcdTAwMjhcdTAwMzFcdTAwMzdcdTAwMjkiLAogICJcdTI0ODUiLAogICJcdTAwMjhcdTAwMzFcdTAwMzhcdTAwMjkiLAogICJcdTI0ODYiLAogICJcdTAwMjhcdTAwMzFcdTAwMzlcdTAwMjkiLAogICJcdTI0ODciLAogICJcdTAwMjhcdTAwMzJcdTAwMzBcdTAwMjkiLAogICJcdTI0ODgiLAogICJcdTAwMzFcdTAwMkUiLAogICJcdTI0ODkiLAogICJcdTAwMzJcdTAwMkUiLAogICJcdTI0OEEiLAogICJcdTAwMzNcdTAwMkUiLAogICJcdTI0OEIiLAogICJcdTAwMzRcdTAwMkUiLAogICJcdTI0OEMiLAogICJcdTAwMzVcdTAwMkUiLAogICJcdTI0OEQiLAogICJcdTAwMzZcdTAwMkUiLAogICJcdTI0OEUiLAogICJcdTAwMzdcdTAwMkUiLAogICJcdTI0OEYiLAogICJcdTAwMzhcdTAwMkUiLAogICJcdTI0OTAiLAogICJcdTAwMzlcdTAwMkUiLAogICJcdTI0OTEiLAogICJcdTAwMzFcdTAwMzBcdTAwMkUiLAogICJcdTI0OTIiLAogICJcdTAwMzFcdTAwMzFcdTAwMkUiLAogICJcdTI0OTMiLAogICJcdTAwMzFcdTAwMzJcdTAwMkUiLAogICJcdTI0OTQiLAogICJcdTAwMzFcdTAwMzNcdTAwMkUiLAogICJcdTI0OTUiLAogICJcdTAwMzFcdTAwMzRcdTAwMkUiLAogICJcdTI0OTYiLAogICJcdTAwMzFcdTAwMzVcdTAwMkUiLAogICJcdTI0OTciLAogICJcdTAwMzFcdTAwMzZcdTAwMkUiLAogICJcdTI0OTgiLAogICJcdTAwMzFcdTAwMzdcdTAwMkUiLAogICJcdTI0OTkiLAogICJcdTAwMzFcdTAwMzhcdTAwMkUiLAogICJcdTI0OUEiLAogICJcdTAwMzFcdTAwMzlcdTAwMkUiLAogICJcdTI0OUIiLAogICJcdTAwMzJcdTAwMzBcdTAwMkUiLAogICJcdTI0OUMiLAogICJcdTAwMjhcdTAwNjFcdTAwMjkiLAogICJcdTI0OUQiLAogICJcdTAwMjhcdTAwNjJcdTAwMjkiLAogICJcdTI0OUUiLAogICJcdTAwMjhcdTAwNjNcdTAwMjkiLAogICJcdTI0OUYiLAogICJcdTAwMjhcdTAwNjRcdTAwMjkiLAogICJcdTI0QTAiLAogICJcdTAwMjhcdTAwNjVcdTAwMjkiLAogICJcdTI0QTEiLAogICJcdTAwMjhcdTAwNjZcdTAwMjkiLAogICJcdTI0QTIiLAogICJcdTAwMjhcdTAwNjdcdTAwMjkiLAogICJcdTI0QTMiLAogICJcdTAwMjhcdTAwNjhcdTAwMjkiLAogICJcdTI0QTQiLAogICJcdTAwMjhcdTAwNjlcdTAwMjkiLAogICJcdTI0QTUiLAogICJcdTAwMjhcdTAwNkFcdTAwMjkiLAogICJcdTI0QTYiLAogICJcdTAwMjhcdTAwNkJcdTAwMjkiLAogICJcdTI0QTciLAogICJcdTAwMjhcdTAwNkNcdTAwMjkiLAogICJcdTI0QTgiLAogICJcdTAwMjhcdTAwNkRcdTAwMjkiLAogICJcdTI0QTkiLAogICJcdTAwMjhcdTAwNkVcdTAwMjkiLAogICJcdTI0QUEiLAogICJcdTAwMjhcdTAwNkZcdTAwMjkiLAogICJcdTI0QUIiLAogICJcdTAwMjhcdTAwNzBcdTAwMjkiLAogICJcdTI0QUMiLAogICJcdTAwMjhcdTAwNzFcdTAwMjkiLAogICJcdTI0QUQiLAogICJcdTAwMjhcdTAwNzJcdTAwMjkiLAogICJcdTI0QUUiLAogICJcdTAwMjhcdTAwNzNcdTAwMjkiLAogICJcdTI0QUYiLAogICJcdTAwMjhcdTAwNzRcdTAwMjkiLAogICJcdTI0QjAiLAogICJcdTAwMjhcdTAwNzVcdTAwMjkiLAogICJcdTI0QjEiLAogICJcdTAwMjhcdTAwNzZcdTAwMjkiLAogICJcdTI0QjIiLAogICJcdTAwMjhcdTAwNzdcdTAwMjkiLAogICJcdTI0QjMiLAogICJcdTAwMjhcdTAwNzhcdTAwMjkiLAogICJcdTI0QjQiLAogICJcdTAwMjhcdTAwNzlcdTAwMjkiLAogICJcdTI0QjUiLAogICJcdTAwMjhcdTAwN0FcdTAwMjkiLAogICJcdTJBMEMiLAogICJcdTIyMkJcdTIyMkJcdTIyMkJcdTIyMkIiLAogICJcdTJBNzQiLAogICJcdTAwM0FcdTAwM0FcdTAwM0QiLAogICJcdTJBNzUiLAogICJcdTAwM0RcdTAwM0QiLAogICJcdTJBNzYiLAogICJcdTAwM0RcdTAwM0RcdTAwM0QiLAogICJcdTJFOUYiLAogICJcdTZCQ0QiLAogICJcdTJFRjMiLAogICJcdTlGOUYiLAogICJcdTJGMDAiLAogICJcdTRFMDAiLAogICJcdTJGMDEiLAogICJcdTRFMjgiLAogICJcdTJGMDIiLAogICJcdTRFMzYiLAogICJcdTJGMDMiLAogICJcdTRFM0YiLAogICJcdTJGMDQiLAogICJcdTRFNTkiLAogICJcdTJGMDUiLAogICJcdTRFODUiLAogICJcdTJGMDYiLAogICJcdTRFOEMiLAogICJcdTJGMDciLAogICJcdTRFQTAiLAogICJcdTJGMDgiLAogICJcdTRFQkEiLAogICJcdTJGMDkiLAogICJcdTUxM0YiLAogICJcdTJGMEEiLAogICJcdTUxNjUiLAogICJcdTJGMEIiLAogICJcdTUxNkIiLAogICJcdTJGMEMiLAogICJcdTUxODIiLAogICJcdTJGMEQiLAogICJcdTUxOTYiLAogICJcdTJGMEUiLAogICJcdTUxQUIiLAogICJcdTJGMEYiLAogICJcdTUxRTAiLAogICJcdTJGMTAiLAogICJcdTUxRjUiLAogICJcdTJGMTEiLAogICJcdTUyMDAiLAogICJcdTJGMTIiLAogICJcdTUyOUIiLAogICJcdTJGMTMiLAogICJcdTUyRjkiLAogICJcdTJGMTQiLAogICJcdTUzMTUiLAogICJcdTJGMTUiLAogICJcdTUzMUEiLAogICJcdTJGMTYiLAogICJcdTUzMzgiLAogICJcdTJGMTciLAogICJcdTUzNDEiLAogICJcdTJGMTgiLAogICJcdTUzNUMiLAogICJcdTJGMTkiLAogICJcdTUzNjkiLAogICJcdTJGMUEiLAogICJcdTUzODIiLAogICJcdTJGMUIiLAogICJcdTUzQjYiLAogICJcdTJGMUMiLAogICJcdTUzQzgiLAogICJcdTJGMUQiLAogICJcdTUzRTMiLAogICJcdTJGMUUiLAogICJcdTU2RDciLAogICJcdTJGMUYiLAogICJcdTU3MUYiLAogICJcdTJGMjAiLAogICJcdTU4RUIiLAogICJcdTJGMjEiLAogICJcdTU5MDIiLAogICJcdTJGMjIiLAogICJcdTU5MEEiLAogICJcdTJGMjMiLAogICJcdTU5MTUiLAogICJcdTJGMjQiLAogICJcdTU5MjciLAogICJcdTJGMjUiLAogICJcdTU5NzMiLAogICJcdTJGMjYiLAogICJcdTVCNTAiLAogICJcdTJGMjciLAogICJcdTVCODAiLAogICJcdTJGMjgiLAogICJcdTVCRjgiLAogICJcdTJGMjkiLAogICJcdTVDMEYiLAogICJcdTJGMkEiLAogICJcdTVDMjIiLAogICJcdTJGMkIiLAogICJcdTVDMzgiLAogICJcdTJGMkMiLAogICJcdTVDNkUiLAogICJcdTJGMkQiLAogICJcdTVDNzEiLAogICJcdTJGMkUiLAogICJcdTVEREIiLAogICJcdTJGMkYiLAogICJcdTVERTUiLAogICJcdTJGMzAiLAogICJcdTVERjEiLAogICJcdTJGMzEiLAogICJcdTVERkUiLAogICJcdTJGMzIiLAogICJcdTVFNzIiLAogICJcdTJGMzMiLAogICJcdTVFN0EiLAogICJcdTJGMzQiLAogICJcdTVFN0YiLAogICJcdTJGMzUiLAogICJcdTVFRjQiLAogICJcdTJGMzYiLAogICJcdTVFRkUiLAogICJcdTJGMzciLAogICJcdTVGMEIiLAogICJcdTJGMzgiLAogICJcdTVGMTMiLAogICJcdTJGMzkiLAogICJcdTVGNTAiLAogICJcdTJGM0EiLAogICJcdTVGNjEiLAogICJcdTJGM0IiLAogICJcdTVGNzMiLAogICJcdTJGM0MiLAogICJcdTVGQzMiLAogICJcdTJGM0QiLAogICJcdTYyMDgiLAogICJcdTJGM0UiLAogICJcdTYyMzYiLAogICJcdTJGM0YiLAogICJcdTYyNEIiLAogICJcdTJGNDAiLAogICJcdTY1MkYiLAogICJcdTJGNDEiLAogICJcdTY1MzQiLAogICJcdTJGNDIiLAogICJcdTY1ODciLAogICJcdTJGNDMiLAogICJcdTY1OTciLAogICJcdTJGNDQiLAogICJcdTY1QTQiLAogICJcdTJGNDUiLAogICJcdTY1QjkiLAogICJcdTJGNDYiLAogICJcdTY1RTAiLAogICJcdTJGNDciLAogICJcdTY1RTUiLAogICJcdTJGNDgiLAogICJcdTY2RjAiLAogICJcdTJGNDkiLAogICJcdTY3MDgiLAogICJcdTJGNEEiLAogICJcdTY3MjgiLAogICJcdTJGNEIiLAogICJcdTZCMjAiLAogICJcdTJGNEMiLAogICJcdTZCNjIiLAogICJcdTJGNEQiLAogICJcdTZCNzkiLAogICJcdTJGNEUiLAogICJcdTZCQjMiLAogICJcdTJGNEYiLAogICJcdTZCQ0IiLAogICJcdTJGNTAiLAogICJcdTZCRDQiLAogICJcdTJGNTEiLAogICJcdTZCREIiLAogICJcdTJGNTIiLAogICJcdTZDMEYiLAogICJcdTJGNTMiLAogICJcdTZDMTQiLAogICJcdTJGNTQiLAogICJcdTZDMzQiLAogICJcdTJGNTUiLAogICJcdTcwNkIiLAogICJcdTJGNTYiLAogICJcdTcyMkEiLAogICJcdTJGNTciLAogICJcdTcyMzYiLAogICJcdTJGNTgiLAogICJcdTcyM0IiLAogICJcdTJGNTkiLAogICJcdTcyM0YiLAogICJcdTJGNUEiLAogICJcdTcyNDciLAogICJcdTJGNUIiLAogICJcdTcyNTkiLAogICJcdTJGNUMiLAogICJcdTcyNUIiLAogICJcdTJGNUQiLAogICJcdTcyQUMiLAogICJcdTJGNUUiLAogICJcdTczODQiLAogICJcdTJGNUYiLAogICJcdTczODkiLAogICJcdTJGNjAiLAogICJcdTc0REMiLAogICJcdTJGNjEiLAogICJcdTc0RTYiLAogICJcdTJGNjIiLAogICJcdTc1MTgiLAogICJcdTJGNjMiLAogICJcdTc1MUYiLAogICJcdTJGNjQiLAogICJcdTc1MjgiLAogICJcdTJGNjUiLAogICJcdTc1MzAiLAogICJcdTJGNjYiLAogICJcdTc1OEIiLAogICJcdTJGNjciLAogICJcdTc1OTIiLAogICJcdTJGNjgiLAogICJcdTc2NzYiLAogICJcdTJGNjkiLAogICJcdTc2N0QiLAogICJcdTJGNkEiLAogICJcdTc2QUUiLAogICJcdTJGNkIiLAogICJcdTc2QkYiLAogICJcdTJGNkMiLAogICJcdTc2RUUiLAogICJcdTJGNkQiLAogICJcdTc3REIiLAogICJcdTJGNkUiLAogICJcdTc3RTIiLAogICJcdTJGNkYiLAogICJcdTc3RjMiLAogICJcdTJGNzAiLAogICJcdTc5M0EiLAogICJcdTJGNzEiLAogICJcdTc5QjgiLAogICJcdTJGNzIiLAogICJcdTc5QkUiLAogICJcdTJGNzMiLAogICJcdTdBNzQiLAogICJcdTJGNzQiLAogICJcdTdBQ0IiLAogICJcdTJGNzUiLAogICJcdTdBRjkiLAogICJcdTJGNzYiLAogICJcdTdDNzMiLAogICJcdTJGNzciLAogICJcdTdDRjgiLAogICJcdTJGNzgiLAogICJcdTdGMzYiLAogICJcdTJGNzkiLAogICJcdTdGNTEiLAogICJcdTJGN0EiLAogICJcdTdGOEEiLAogICJcdTJGN0IiLAogICJcdTdGQkQiLAogICJcdTJGN0MiLAogICJcdTgwMDEiLAogICJcdTJGN0QiLAogICJcdTgwMEMiLAogICJcdTJGN0UiLAogICJcdTgwMTIiLAogICJcdTJGN0YiLAogICJcdTgwMzMiLAogICJcdTJGODAiLAogICJcdTgwN0YiLAogICJcdTJGODEiLAogICJcdTgwODkiLAogICJcdTJGODIiLAogICJcdTgxRTMiLAogICJcdTJGODMiLAogICJcdTgxRUEiLAogICJcdTJGODQiLAogICJcdTgxRjMiLAogICJcdTJGODUiLAogICJcdTgxRkMiLAogICJcdTJGODYiLAogICJcdTgyMEMiLAogICJcdTJGODciLAogICJcdTgyMUIiLAogICJcdTJGODgiLAogICJcdTgyMUYiLAogICJcdTJGODkiLAogICJcdTgyNkUiLAogICJcdTJGOEEiLAogICJcdTgyNzIiLAogICJcdTJGOEIiLAogICJcdTgyNzgiLAogICJcdTJGOEMiLAogICJcdTg2NEQiLAogICJcdTJGOEQiLAogICJcdTg2NkIiLAogICJcdTJGOEUiLAogICJcdTg4NDAiLAogICJcdTJGOEYiLAogICJcdTg4NEMiLAogICJcdTJGOTAiLAogICJcdTg4NjMiLAogICJcdTJGOTEiLAogICJcdTg5N0UiLAogICJcdTJGOTIiLAogICJcdTg5OEIiLAogICJcdTJGOTMiLAogICJcdTg5RDIiLAogICJcdTJGOTQiLAogICJcdThBMDAiLAogICJcdTJGOTUiLAogICJcdThDMzciLAogICJcdTJGOTYiLAogICJcdThDNDYiLAogICJcdTJGOTciLAogICJcdThDNTUiLAogICJcdTJGOTgiLAogICJcdThDNzgiLAogICJcdTJGOTkiLAogICJcdThDOUQiLAogICJcdTJGOUEiLAogICJcdThENjQiLAogICJcdTJGOUIiLAogICJcdThENzAiLAogICJcdTJGOUMiLAogICJcdThEQjMiLAogICJcdTJGOUQiLAogICJcdThFQUIiLAogICJcdTJGOUUiLAogICJcdThFQ0EiLAogICJcdTJGOUYiLAogICJcdThGOUIiLAogICJcdTJGQTAiLAogICJcdThGQjAiLAogICJcdTJGQTEiLAogICJcdThGQjUiLAogICJcdTJGQTIiLAogICJcdTkwOTEiLAogICJcdTJGQTMiLAogICJcdTkxNDkiLAogICJcdTJGQTQiLAogICJcdTkxQzYiLAogICJcdTJGQTUiLAogICJcdTkxQ0MiLAogICJcdTJGQTYiLAogICJcdTkxRDEiLAogICJcdTJGQTciLAogICJcdTk1NzciLAogICJcdTJGQTgiLAogICJcdTk1ODAiLAogICJcdTJGQTkiLAogICJcdTk2MUMiLAogICJcdTJGQUEiLAogICJcdTk2QjYiLAogICJcdTJGQUIiLAogICJcdTk2QjkiLAogICJcdTJGQUMiLAogICJcdTk2RTgiLAogICJcdTJGQUQiLAogICJcdTk3NTEiLAogICJcdTJGQUUiLAogICJcdTk3NUUiLAogICJcdTJGQUYiLAogICJcdTk3NjIiLAogICJcdTJGQjAiLAogICJcdTk3NjkiLAogICJcdTJGQjEiLAogICJcdTk3Q0IiLAogICJcdTJGQjIiLAogICJcdTk3RUQiLAogICJcdTJGQjMiLAogICJcdTk3RjMiLAogICJcdTJGQjQiLAogICJcdTk4MDEiLAogICJcdTJGQjUiLAogICJcdTk4QTgiLAogICJcdTJGQjYiLAogICJcdTk4REIiLAogICJcdTJGQjciLAogICJcdTk4REYiLAogICJcdTJGQjgiLAogICJcdTk5OTYiLAogICJcdTJGQjkiLAogICJcdTk5OTkiLAogICJcdTJGQkEiLAogICJcdTk5QUMiLAogICJcdTJGQkIiLAogICJcdTlBQTgiLAogICJcdTJGQkMiLAogICJcdTlBRDgiLAogICJcdTJGQkQiLAogICJcdTlBREYiLAogICJcdTJGQkUiLAogICJcdTlCMjUiLAogICJcdTJGQkYiLAogICJcdTlCMkYiLAogICJcdTJGQzAiLAogICJcdTlCMzIiLAogICJcdTJGQzEiLAogICJcdTlCM0MiLAogICJcdTJGQzIiLAogICJcdTlCNUEiLAogICJcdTJGQzMiLAogICJcdTlDRTUiLAogICJcdTJGQzQiLAogICJcdTlFNzUiLAogICJcdTJGQzUiLAogICJcdTlFN0YiLAogICJcdTJGQzYiLAogICJcdTlFQTUiLAogICJcdTJGQzciLAogICJcdTlFQkIiLAogICJcdTJGQzgiLAogICJcdTlFQzMiLAogICJcdTJGQzkiLAogICJcdTlFQ0QiLAogICJcdTJGQ0EiLAogICJcdTlFRDEiLAogICJcdTJGQ0IiLAogICJcdTlFRjkiLAogICJcdTJGQ0MiLAogICJcdTlFRkQiLAogICJcdTJGQ0QiLAogICJcdTlGMEUiLAogICJcdTJGQ0UiLAogICJcdTlGMTMiLAogICJcdTJGQ0YiLAogICJcdTlGMjAiLAogICJcdTJGRDAiLAogICJcdTlGM0IiLAogICJcdTJGRDEiLAogICJcdTlGNEEiLAogICJcdTJGRDIiLAogICJcdTlGNTIiLAogICJcdTJGRDMiLAogICJcdTlGOEQiLAogICJcdTJGRDQiLAogICJcdTlGOUMiLAogICJcdTJGRDUiLAogICJcdTlGQTAiLAogICJcdTMwMzYiLAogICJcdTMwMTIiLAogICJcdTMwMzgiLAogICJcdTUzNDEiLAogICJcdTMwMzkiLAogICJcdTUzNDQiLAogICJcdTMwM0EiLAogICJcdTUzNDUiLAogICJcdTMwOUIiLAogICJcdTAwMjBcdTMwOTkiLAogICJcdTMwOUMiLAogICJcdTAwMjBcdTMwOUEiLAogICJcdTMxMzEiLAogICJcdTExMDAiLAogICJcdTMxMzIiLAogICJcdTExMDEiLAogICJcdTMxMzMiLAogICJcdTExQUEiLAogICJcdTMxMzQiLAogICJcdTExMDIiLAogICJcdTMxMzUiLAogICJcdTExQUMiLAogICJcdTMxMzYiLAogICJcdTExQUQiLAogICJcdTMxMzciLAogICJcdTExMDMiLAogICJcdTMxMzgiLAogICJcdTExMDQiLAogICJcdTMxMzkiLAogICJcdTExMDUiLAogICJcdTMxM0EiLAogICJcdTExQjAiLAogICJcdTMxM0IiLAogICJcdTExQjEiLAogICJcdTMxM0MiLAogICJcdTExQjIiLAogICJcdTMxM0QiLAogICJcdTExQjMiLAogICJcdTMxM0UiLAogICJcdTExQjQiLAogICJcdTMxM0YiLAogICJcdTExQjUiLAogICJcdTMxNDAiLAogICJcdTExMUEiLAogICJcdTMxNDEiLAogICJcdTExMDYiLAogICJcdTMxNDIiLAogICJcdTExMDciLAogICJcdTMxNDMiLAogICJcdTExMDgiLAogICJcdTMxNDQiLAogICJcdTExMjEiLAogICJcdTMxNDUiLAogICJcdTExMDkiLAogICJcdTMxNDYiLAogICJcdTExMEEiLAogICJcdTMxNDciLAogICJcdTExMEIiLAogICJcdTMxNDgiLAogICJcdTExMEMiLAogICJcdTMxNDkiLAogICJcdTExMEQiLAogICJcdTMxNEEiLAogICJcdTExMEUiLAogICJcdTMxNEIiLAogICJcdTExMEYiLAogICJcdTMxNEMiLAogICJcdTExMTAiLAogICJcdTMxNEQiLAogICJcdTExMTEiLAogICJcdTMxNEUiLAogICJcdTExMTIiLAogICJcdTMxNEYiLAogICJcdTExNjEiLAogICJcdTMxNTAiLAogICJcdTExNjIiLAogICJcdTMxNTEiLAogICJcdTExNjMiLAogICJcdTMxNTIiLAogICJcdTExNjQiLAogICJcdTMxNTMiLAogICJcdTExNjUiLAogICJcdTMxNTQiLAogICJcdTExNjYiLAogICJcdTMxNTUiLAogICJcdTExNjciLAogICJcdTMxNTYiLAogICJcdTExNjgiLAogICJcdTMxNTciLAogICJcdTExNjkiLAogICJcdTMxNTgiLAogICJcdTExNkEiLAogICJcdTMxNTkiLAogICJcdTExNkIiLAogICJcdTMxNUEiLAogICJcdTExNkMiLAogICJcdTMxNUIiLAogICJcdTExNkQiLAogICJcdTMxNUMiLAogICJcdTExNkUiLAogICJcdTMxNUQiLAogICJcdTExNkYiLAogICJcdTMxNUUiLAogICJcdTExNzAiLAogICJcdTMxNUYiLAogICJcdTExNzEiLAogICJcdTMxNjAiLAogICJcdTExNzIiLAogICJcdTMxNjEiLAogICJcdTExNzMiLAogICJcdTMxNjIiLAogICJcdTExNzQiLAogICJcdTMxNjMiLAogICJcdTExNzUiLAogICJcdTMxNjQiLAogICJcdTExNjAiLAogICJcdTMxNjUiLAogICJcdTExMTQiLAogICJcdTMxNjYiLAogICJcdTExMTUiLAogICJcdTMxNjciLAogICJcdTExQzciLAogICJcdTMxNjgiLAogICJcdTExQzgiLAogICJcdTMxNjkiLAogICJcdTExQ0MiLAogICJcdTMxNkEiLAogICJcdTExQ0UiLAogICJcdTMxNkIiLAogICJcdTExRDMiLAogICJcdTMxNkMiLAogICJcdTExRDciLAogICJcdTMxNkQiLAogICJcdTExRDkiLAogICJcdTMxNkUiLAogICJcdTExMUMiLAogICJcdTMxNkYiLAogICJcdTExREQiLAogICJcdTMxNzAiLAogICJcdTExREYiLAogICJcdTMxNzEiLAogICJcdTExMUQiLAogICJcdTMxNzIiLAogICJcdTExMUUiLAogICJcdTMxNzMiLAogICJcdTExMjAiLAogICJcdTMxNzQiLAogICJcdTExMjIiLAogICJcdTMxNzUiLAogICJcdTExMjMiLAogICJcdTMxNzYiLAogICJcdTExMjciLAogICJcdTMxNzciLAogICJcdTExMjkiLAogICJcdTMxNzgiLAogICJcdTExMkIiLAogICJcdTMxNzkiLAogICJcdTExMkMiLAogICJcdTMxN0EiLAogICJcdTExMkQiLAogICJcdTMxN0IiLAogICJcdTExMkUiLAogICJcdTMxN0MiLAogICJcdTExMkYiLAogICJcdTMxN0QiLAogICJcdTExMzIiLAogICJcdTMxN0UiLAogICJcdTExMzYiLAogICJcdTMxN0YiLAogICJcdTExNDAiLAogICJcdTMxODAiLAogICJcdTExNDciLAogICJcdTMxODEiLAogICJcdTExNEMiLAogICJcdTMxODIiLAogICJcdTExRjEiLAogICJcdTMxODMiLAogICJcdTExRjIiLAogICJcdTMxODQiLAogICJcdTExNTciLAogICJcdTMxODUiLAogICJcdTExNTgiLAogICJcdTMxODYiLAogICJcdTExNTkiLAogICJcdTMxODciLAogICJcdTExODQiLAogICJcdTMxODgiLAogICJcdTExODUiLAogICJcdTMxODkiLAogICJcdTExODgiLAogICJcdTMxOEEiLAogICJcdTExOTEiLAogICJcdTMxOEIiLAogICJcdTExOTIiLAogICJcdTMxOEMiLAogICJcdTExOTQiLAogICJcdTMxOEQiLAogICJcdTExOUUiLAogICJcdTMxOEUiLAogICJcdTExQTEiLAogICJcdTMyMDAiLAogICJcdTAwMjhcdTExMDBcdTAwMjkiLAogICJcdTMyMDEiLAogICJcdTAwMjhcdTExMDJcdTAwMjkiLAogICJcdTMyMDIiLAogICJcdTAwMjhcdTExMDNcdTAwMjkiLAogICJcdTMyMDMiLAogICJcdTAwMjhcdTExMDVcdTAwMjkiLAogICJcdTMyMDQiLAogICJcdTAwMjhcdTExMDZcdTAwMjkiLAogICJcdTMyMDUiLAogICJcdTAwMjhcdTExMDdcdTAwMjkiLAogICJcdTMyMDYiLAogICJcdTAwMjhcdTExMDlcdTAwMjkiLAogICJcdTMyMDciLAogICJcdTAwMjhcdTExMEJcdTAwMjkiLAogICJcdTMyMDgiLAogICJcdTAwMjhcdTExMENcdTAwMjkiLAogICJcdTMyMDkiLAogICJcdTAwMjhcdTExMEVcdTAwMjkiLAogICJcdTMyMEEiLAogICJcdTAwMjhcdTExMEZcdTAwMjkiLAogICJcdTMyMEIiLAogICJcdTAwMjhcdTExMTBcdTAwMjkiLAogICJcdTMyMEMiLAogICJcdTAwMjhcdTExMTFcdTAwMjkiLAogICJcdTMyMEQiLAogICJcdTAwMjhcdTExMTJcdTAwMjkiLAogICJcdTMyMEUiLAogICJcdTAwMjhcdTExMDBcdTExNjFcdTAwMjkiLAogICJcdTMyMEYiLAogICJcdTAwMjhcdTExMDJcdTExNjFcdTAwMjkiLAogICJcdTMyMTAiLAogICJcdTAwMjhcdTExMDNcdTExNjFcdTAwMjkiLAogICJcdTMyMTEiLAogICJcdTAwMjhcdTExMDVcdTExNjFcdTAwMjkiLAogICJcdTMyMTIiLAogICJcdTAwMjhcdTExMDZcdTExNjFcdTAwMjkiLAogICJcdTMyMTMiLAogICJcdTAwMjhcdTExMDdcdTExNjFcdTAwMjkiLAogICJcdTMyMTQiLAogICJcdTAwMjhcdTExMDlcdTExNjFcdTAwMjkiLAogICJcdTMyMTUiLAogICJcdTAwMjhcdTExMEJcdTExNjFcdTAwMjkiLAogICJcdTMyMTYiLAogICJcdTAwMjhcdTExMENcdTExNjFcdTAwMjkiLAogICJcdTMyMTciLAogICJcdTAwMjhcdTExMEVcdTExNjFcdTAwMjkiLAogICJcdTMyMTgiLAogICJcdTAwMjhcdTExMEZcdTExNjFcdTAwMjkiLAogICJcdTMyMTkiLAogICJcdTAwMjhcdTExMTBcdTExNjFcdTAwMjkiLAogICJcdTMyMUEiLAogICJcdTAwMjhcdTExMTFcdTExNjFcdTAwMjkiLAogICJcdTMyMUIiLAogICJcdTAwMjhcdTExMTJcdTExNjFcdTAwMjkiLAogICJcdTMyMUMiLAogICJcdTAwMjhcdTExMENcdTExNkVcdTAwMjkiLAogICJcdTMyMUQiLAogICJcdTAwMjhcdTExMEJcdTExNjlcdTExMENcdTExNjVcdTExQUJcdTAwMjkiLAogICJcdTMyMUUiLAogICJcdTAwMjhcdTExMEJcdTExNjlcdTExMTJcdTExNkVcdTAwMjkiLAogICJcdTMyMjAiLAogICJcdTAwMjhcdTRFMDBcdTAwMjkiLAogICJcdTMyMjEiLAogICJcdTAwMjhcdTRFOENcdTAwMjkiLAogICJcdTMyMjIiLAogICJcdTAwMjhcdTRFMDlcdTAwMjkiLAogICJcdTMyMjMiLAogICJcdTAwMjhcdTU2REJcdTAwMjkiLAogICJcdTMyMjQiLAogICJcdTAwMjhcdTRFOTRcdTAwMjkiLAogICJcdTMyMjUiLAogICJcdTAwMjhcdTUxNkRcdTAwMjkiLAogICJcdTMyMjYiLAogICJcdTAwMjhcdTRFMDNcdTAwMjkiLAogICJcdTMyMjciLAogICJcdTAwMjhcdTUxNkJcdTAwMjkiLAogICJcdTMyMjgiLAogICJcdTAwMjhcdTRFNURcdTAwMjkiLAogICJcdTMyMjkiLAogICJcdTAwMjhcdTUzNDFcdTAwMjkiLAogICJcdTMyMkEiLAogICJcdTAwMjhcdTY3MDhcdTAwMjkiLAogICJcdTMyMkIiLAogICJcdTAwMjhcdTcwNkJcdTAwMjkiLAogICJcdTMyMkMiLAogICJcdTAwMjhcdTZDMzRcdTAwMjkiLAogICJcdTMyMkQiLAogICJcdTAwMjhcdTY3MjhcdTAwMjkiLAogICJcdTMyMkUiLAogICJcdTAwMjhcdTkxRDFcdTAwMjkiLAogICJcdTMyMkYiLAogICJcdTAwMjhcdTU3MUZcdTAwMjkiLAogICJcdTMyMzAiLAogICJcdTAwMjhcdTY1RTVcdTAwMjkiLAogICJcdTMyMzEiLAogICJcdTAwMjhcdTY4MkFcdTAwMjkiLAogICJcdTMyMzIiLAogICJcdTAwMjhcdTY3MDlcdTAwMjkiLAogICJcdTMyMzMiLAogICJcdTAwMjhcdTc5M0VcdTAwMjkiLAogICJcdTMyMzQiLAogICJcdTAwMjhcdTU0MERcdTAwMjkiLAogICJcdTMyMzUiLAogICJcdTAwMjhcdTcyNzlcdTAwMjkiLAogICJcdTMyMzYiLAogICJcdTAwMjhcdThDQTFcdTAwMjkiLAogICJcdTMyMzciLAogICJcdTAwMjhcdTc5NURcdTAwMjkiLAogICJcdTMyMzgiLAogICJcdTAwMjhcdTUyQjRcdTAwMjkiLAogICJcdTMyMzkiLAogICJcdTAwMjhcdTRFRTNcdTAwMjkiLAogICJcdTMyM0EiLAogICJcdTAwMjhcdTU0N0NcdTAwMjkiLAogICJcdTMyM0IiLAogICJcdTAwMjhcdTVCNjZcdTAwMjkiLAogICJcdTMyM0MiLAogICJcdTAwMjhcdTc2RTNcdTAwMjkiLAogICJcdTMyM0QiLAogICJcdTAwMjhcdTRGMDFcdTAwMjkiLAogICJcdTMyM0UiLAogICJcdTAwMjhcdThDQzdcdTAwMjkiLAogICJcdTMyM0YiLAogICJcdTAwMjhcdTUzNTRcdTAwMjkiLAogICJcdTMyNDAiLAogICJcdTAwMjhcdTc5NkRcdTAwMjkiLAogICJcdTMyNDEiLAogICJcdTAwMjhcdTRGMTFcdTAwMjkiLAogICJcdTMyNDIiLAogICJcdTAwMjhcdTgxRUFcdTAwMjkiLAogICJcdTMyNDMiLAogICJcdTAwMjhcdTgxRjNcdTAwMjkiLAogICJcdTMyQzAiLAogICJcdTAwMzFcdTY3MDgiLAogICJcdTMyQzEiLAogICJcdTAwMzJcdTY3MDgiLAogICJcdTMyQzIiLAogICJcdTAwMzNcdTY3MDgiLAogICJcdTMyQzMiLAogICJcdTAwMzRcdTY3MDgiLAogICJcdTMyQzQiLAogICJcdTAwMzVcdTY3MDgiLAogICJcdTMyQzUiLAogICJcdTAwMzZcdTY3MDgiLAogICJcdTMyQzYiLAogICJcdTAwMzdcdTY3MDgiLAogICJcdTMyQzciLAogICJcdTAwMzhcdTY3MDgiLAogICJcdTMyQzgiLAogICJcdTAwMzlcdTY3MDgiLAogICJcdTMyQzkiLAogICJcdTAwMzFcdTAwMzBcdTY3MDgiLAogICJcdTMyQ0EiLAogICJcdTAwMzFcdTAwMzFcdTY3MDgiLAogICJcdTMyQ0IiLAogICJcdTAwMzFcdTAwMzJcdTY3MDgiLAogICJcdTMzNTgiLAogICJcdTAwMzBcdTcwQjkiLAogICJcdTMzNTkiLAogICJcdTAwMzFcdTcwQjkiLAogICJcdTMzNUEiLAogICJcdTAwMzJcdTcwQjkiLAogICJcdTMzNUIiLAogICJcdTAwMzNcdTcwQjkiLAogICJcdTMzNUMiLAogICJcdTAwMzRcdTcwQjkiLAogICJcdTMzNUQiLAogICJcdTAwMzVcdTcwQjkiLAogICJcdTMzNUUiLAogICJcdTAwMzZcdTcwQjkiLAogICJcdTMzNUYiLAogICJcdTAwMzdcdTcwQjkiLAogICJcdTMzNjAiLAogICJcdTAwMzhcdTcwQjkiLAogICJcdTMzNjEiLAogICJcdTAwMzlcdTcwQjkiLAogICJcdTMzNjIiLAogICJcdTAwMzFcdTAwMzBcdTcwQjkiLAogICJcdTMzNjMiLAogICJcdTAwMzFcdTAwMzFcdTcwQjkiLAogICJcdTMzNjQiLAogICJcdTAwMzFcdTAwMzJcdTcwQjkiLAogICJcdTMzNjUiLAogICJcdTAwMzFcdTAwMzNcdTcwQjkiLAogICJcdTMzNjYiLAogICJcdTAwMzFcdTAwMzRcdTcwQjkiLAogICJcdTMzNjciLAogICJcdTAwMzFcdTAwMzVcdTcwQjkiLAogICJcdTMzNjgiLAogICJcdTAwMzFcdTAwMzZcdTcwQjkiLAogICJcdTMzNjkiLAogICJcdTAwMzFcdTAwMzdcdTcwQjkiLAogICJcdTMzNkEiLAogICJcdTAwMzFcdTAwMzhcdTcwQjkiLAogICJcdTMzNkIiLAogICJcdTAwMzFcdTAwMzlcdTcwQjkiLAogICJcdTMzNkMiLAogICJcdTAwMzJcdTAwMzBcdTcwQjkiLAogICJcdTMzNkQiLAogICJcdTAwMzJcdTAwMzFcdTcwQjkiLAogICJcdTMzNkUiLAogICJcdTAwMzJcdTAwMzJcdTcwQjkiLAogICJcdTMzNkYiLAogICJcdTAwMzJcdTAwMzNcdTcwQjkiLAogICJcdTMzNzAiLAogICJcdTAwMzJcdTAwMzRcdTcwQjkiLAogICJcdTMzRTAiLAogICJcdTAwMzFcdTY1RTUiLAogICJcdTMzRTEiLAogICJcdTAwMzJcdTY1RTUiLAogICJcdTMzRTIiLAogICJcdTAwMzNcdTY1RTUiLAogICJcdTMzRTMiLAogICJcdTAwMzRcdTY1RTUiLAogICJcdTMzRTQiLAogICJcdTAwMzVcdTY1RTUiLAogICJcdTMzRTUiLAogICJcdTAwMzZcdTY1RTUiLAogICJcdTMzRTYiLAogICJcdTAwMzdcdTY1RTUiLAogICJcdTMzRTciLAogICJcdTAwMzhcdTY1RTUiLAogICJcdTMzRTgiLAogICJcdTAwMzlcdTY1RTUiLAogICJcdTMzRTkiLAogICJcdTAwMzFcdTAwMzBcdTY1RTUiLAogICJcdTMzRUEiLAogICJcdTAwMzFcdTAwMzFcdTY1RTUiLAogICJcdTMzRUIiLAogICJcdTAwMzFcdTAwMzJcdTY1RTUiLAogICJcdTMzRUMiLAogICJcdTAwMzFcdTAwMzNcdTY1RTUiLAogICJcdTMzRUQiLAogICJcdTAwMzFcdTAwMzRcdTY1RTUiLAogICJcdTMzRUUiLAogICJcdTAwMzFcdTAwMzVcdTY1RTUiLAogICJcdTMzRUYiLAogICJcdTAwMzFcdTAwMzZcdTY1RTUiLAogICJcdTMzRjAiLAogICJcdTAwMzFcdTAwMzdcdTY1RTUiLAogICJcdTMzRjEiLAogICJcdTAwMzFcdTAwMzhcdTY1RTUiLAogICJcdTMzRjIiLAogICJcdTAwMzFcdTAwMzlcdTY1RTUiLAogICJcdTMzRjMiLAogICJcdTAwMzJcdTAwMzBcdTY1RTUiLAogICJcdTMzRjQiLAogICJcdTAwMzJcdTAwMzFcdTY1RTUiLAogICJcdTMzRjUiLAogICJcdTAwMzJcdTAwMzJcdTY1RTUiLAogICJcdTMzRjYiLAogICJcdTAwMzJcdTAwMzNcdTY1RTUiLAogICJcdTMzRjciLAogICJcdTAwMzJcdTAwMzRcdTY1RTUiLAogICJcdTMzRjgiLAogICJcdTAwMzJcdTAwMzVcdTY1RTUiLAogICJcdTMzRjkiLAogICJcdTAwMzJcdTAwMzZcdTY1RTUiLAogICJcdTMzRkEiLAogICJcdTAwMzJcdTAwMzdcdTY1RTUiLAogICJcdTMzRkIiLAogICJcdTAwMzJcdTAwMzhcdTY1RTUiLAogICJcdTMzRkMiLAogICJcdTAwMzJcdTAwMzlcdTY1RTUiLAogICJcdTMzRkQiLAogICJcdTAwMzNcdTAwMzBcdTY1RTUiLAogICJcdTMzRkUiLAogICJcdTAwMzNcdTAwMzFcdTY1RTUiLAogICJcdUZCMDAiLAogICJcdTAwNjZcdTAwNjYiLAogICJcdUZCMDEiLAogICJcdTAwNjZcdTAwNjkiLAogICJcdUZCMDIiLAogICJcdTAwNjZcdTAwNkMiLAogICJcdUZCMDMiLAogICJcdTAwNjZcdTAwNjZcdTAwNjkiLAogICJcdUZCMDQiLAogICJcdTAwNjZcdTAwNjZcdTAwNkMiLAogICJcdUZCMDUiLAogICJcdTAxN0ZcdTAwNzQiLAogICJcdUZCMDYiLAogICJcdTAwNzNcdTAwNzQiLAogICJcdUZCMTMiLAogICJcdTA1NzRcdTA1NzYiLAogICJcdUZCMTQiLAogICJcdTA1NzRcdTA1NjUiLAogICJcdUZCMTUiLAogICJcdTA1NzRcdTA1NkIiLAogICJcdUZCMTYiLAogICJcdTA1N0VcdTA1NzYiLAogICJcdUZCMTciLAogICJcdTA1NzRcdTA1NkQiLAogICJcdUZCNEYiLAogICJcdTA1RDBcdTA1REMiLAogICJcdUZCNTAiLAogICJcdTA2NzEiLAogICJcdUZCNTEiLAogICJcdTA2NzEiLAogICJcdUZCNTIiLAogICJcdTA2N0IiLAogICJcdUZCNTMiLAogICJcdTA2N0IiLAogICJcdUZCNTQiLAogICJcdTA2N0IiLAogICJcdUZCNTUiLAogICJcdTA2N0IiLAogICJcdUZCNTYiLAogICJcdTA2N0UiLAogICJcdUZCNTciLAogICJcdTA2N0UiLAogICJcdUZCNTgiLAogICJcdTA2N0UiLAogICJcdUZCNTkiLAogICJcdTA2N0UiLAogICJcdUZCNUEiLAogICJcdTA2ODAiLAogICJcdUZCNUIiLAogICJcdTA2ODAiLAogICJcdUZCNUMiLAogICJcdTA2ODAiLAogICJcdUZCNUQiLAogICJcdTA2ODAiLAogICJcdUZCNUUiLAogICJcdTA2N0EiLAogICJcdUZCNUYiLAogICJcdTA2N0EiLAogICJcdUZCNjAiLAogICJcdTA2N0EiLAogICJcdUZCNjEiLAogICJcdTA2N0EiLAogICJcdUZCNjIiLAogICJcdTA2N0YiLAogICJcdUZCNjMiLAogICJcdTA2N0YiLAogICJcdUZCNjQiLAogICJcdTA2N0YiLAogICJcdUZCNjUiLAogICJcdTA2N0YiLAogICJcdUZCNjYiLAogICJcdTA2NzkiLAogICJcdUZCNjciLAogICJcdTA2NzkiLAogICJcdUZCNjgiLAogICJcdTA2NzkiLAogICJcdUZCNjkiLAogICJcdTA2NzkiLAogICJcdUZCNkEiLAogICJcdTA2QTQiLAogICJcdUZCNkIiLAogICJcdTA2QTQiLAogICJcdUZCNkMiLAogICJcdTA2QTQiLAogICJcdUZCNkQiLAogICJcdTA2QTQiLAogICJcdUZCNkUiLAogICJcdTA2QTYiLAogICJcdUZCNkYiLAogICJcdTA2QTYiLAogICJcdUZCNzAiLAogICJcdTA2QTYiLAogICJcdUZCNzEiLAogICJcdTA2QTYiLAogICJcdUZCNzIiLAogICJcdTA2ODQiLAogICJcdUZCNzMiLAogICJcdTA2ODQiLAogICJcdUZCNzQiLAogICJcdTA2ODQiLAogICJcdUZCNzUiLAogICJcdTA2ODQiLAogICJcdUZCNzYiLAogICJcdTA2ODMiLAogICJcdUZCNzciLAogICJcdTA2ODMiLAogICJcdUZCNzgiLAogICJcdTA2ODMiLAogICJcdUZCNzkiLAogICJcdTA2ODMiLAogICJcdUZCN0EiLAogICJcdTA2ODYiLAogICJcdUZCN0IiLAogICJcdTA2ODYiLAogICJcdUZCN0MiLAogICJcdTA2ODYiLAogICJcdUZCN0QiLAogICJcdTA2ODYiLAogICJcdUZCN0UiLAogICJcdTA2ODciLAogICJcdUZCN0YiLAogICJcdTA2ODciLAogICJcdUZCODAiLAogICJcdTA2ODciLAogICJcdUZCODEiLAogICJcdTA2ODciLAogICJcdUZCODIiLAogICJcdTA2OEQiLAogICJcdUZCODMiLAogICJcdTA2OEQiLAogICJcdUZCODQiLAogICJcdTA2OEMiLAogICJcdUZCODUiLAogICJcdTA2OEMiLAogICJcdUZCODYiLAogICJcdTA2OEUiLAogICJcdUZCODciLAogICJcdTA2OEUiLAogICJcdUZCODgiLAogICJcdTA2ODgiLAogICJcdUZCODkiLAogICJcdTA2ODgiLAogICJcdUZCOEEiLAogICJcdTA2OTgiLAogICJcdUZCOEIiLAogICJcdTA2OTgiLAogICJcdUZCOEMiLAogICJcdTA2OTEiLAogICJcdUZCOEQiLAogICJcdTA2OTEiLAogICJcdUZCOEUiLAogICJcdTA2QTkiLAogICJcdUZCOEYiLAogICJcdTA2QTkiLAogICJcdUZCOTAiLAogICJcdTA2QTkiLAogICJcdUZCOTEiLAogICJcdTA2QTkiLAogICJcdUZCOTIiLAogICJcdTA2QUYiLAogICJcdUZCOTMiLAogICJcdTA2QUYiLAogICJcdUZCOTQiLAogICJcdTA2QUYiLAogICJcdUZCOTUiLAogICJcdTA2QUYiLAogICJcdUZCOTYiLAogICJcdTA2QjMiLAogICJcdUZCOTciLAogICJcdTA2QjMiLAogICJcdUZCOTgiLAogICJcdTA2QjMiLAogICJcdUZCOTkiLAogICJcdTA2QjMiLAogICJcdUZCOUEiLAogICJcdTA2QjEiLAogICJcdUZCOUIiLAogICJcdTA2QjEiLAogICJcdUZCOUMiLAogICJcdTA2QjEiLAogICJcdUZCOUQiLAogICJcdTA2QjEiLAogICJcdUZCOUUiLAogICJcdTA2QkEiLAogICJcdUZCOUYiLAogICJcdTA2QkEiLAogICJcdUZCQTAiLAogICJcdTA2QkIiLAogICJcdUZCQTEiLAogICJcdTA2QkIiLAogICJcdUZCQTIiLAogICJcdTA2QkIiLAogICJcdUZCQTMiLAogICJcdTA2QkIiLAogICJcdUZCQTQiLAogICJcdTA2QzAiLAogICJcdUZCQTUiLAogICJcdTA2QzAiLAogICJcdUZCQTYiLAogICJcdTA2QzEiLAogICJcdUZCQTciLAogICJcdTA2QzEiLAogICJcdUZCQTgiLAogICJcdTA2QzEiLAogICJcdUZCQTkiLAogICJcdTA2QzEiLAogICJcdUZCQUEiLAogICJcdTA2QkUiLAogICJcdUZCQUIiLAogICJcdTA2QkUiLAogICJcdUZCQUMiLAogICJcdTA2QkUiLAogICJcdUZCQUQiLAogICJcdTA2QkUiLAogICJcdUZCQUUiLAogICJcdTA2RDIiLAogICJcdUZCQUYiLAogICJcdTA2RDIiLAogICJcdUZCQjAiLAogICJcdTA2RDMiLAogICJcdUZCQjEiLAogICJcdTA2RDMiLAogICJcdUZCRDMiLAogICJcdTA2QUQiLAogICJcdUZCRDQiLAogICJcdTA2QUQiLAogICJcdUZCRDUiLAogICJcdTA2QUQiLAogICJcdUZCRDYiLAogICJcdTA2QUQiLAogICJcdUZCRDciLAogICJcdTA2QzciLAogICJcdUZCRDgiLAogICJcdTA2QzciLAogICJcdUZCRDkiLAogICJcdTA2QzYiLAogICJcdUZCREEiLAogICJcdTA2QzYiLAogICJcdUZCREIiLAogICJcdTA2QzgiLAogICJcdUZCREMiLAogICJcdTA2QzgiLAogICJcdUZCREQiLAogICJcdTA2NzciLAogICJcdUZCREUiLAogICJcdTA2Q0IiLAogICJcdUZCREYiLAogICJcdTA2Q0IiLAogICJcdUZCRTAiLAogICJcdTA2QzUiLAogICJcdUZCRTEiLAogICJcdTA2QzUiLAogICJcdUZCRTIiLAogICJcdTA2QzkiLAogICJcdUZCRTMiLAogICJcdTA2QzkiLAogICJcdUZCRTQiLAogICJcdTA2RDAiLAogICJcdUZCRTUiLAogICJcdTA2RDAiLAogICJcdUZCRTYiLAogICJcdTA2RDAiLAogICJcdUZCRTciLAogICJcdTA2RDAiLAogICJcdUZCRTgiLAogICJcdTA2NDkiLAogICJcdUZCRTkiLAogICJcdTA2NDkiLAogICJcdUZCRUEiLAogICJcdTA2MjZcdTA2MjciLAogICJcdUZCRUIiLAogICJcdTA2MjZcdTA2MjciLAogICJcdUZCRUMiLAogICJcdTA2MjZcdTA2RDUiLAogICJcdUZCRUQiLAogICJcdTA2MjZcdTA2RDUiLAogICJcdUZCRUUiLAogICJcdTA2MjZcdTA2NDgiLAogICJcdUZCRUYiLAogICJcdTA2MjZcdTA2NDgiLAogICJcdUZCRjAiLAogICJcdTA2MjZcdTA2QzciLAogICJcdUZCRjEiLAogICJcdTA2MjZcdTA2QzciLAogICJcdUZCRjIiLAogICJcdTA2MjZcdTA2QzYiLAogICJcdUZCRjMiLAogICJcdTA2MjZcdTA2QzYiLAogICJcdUZCRjQiLAogICJcdTA2MjZcdTA2QzgiLAogICJcdUZCRjUiLAogICJcdTA2MjZcdTA2QzgiLAogICJcdUZCRjYiLAogICJcdTA2MjZcdTA2RDAiLAogICJcdUZCRjciLAogICJcdTA2MjZcdTA2RDAiLAogICJcdUZCRjgiLAogICJcdTA2MjZcdTA2RDAiLAogICJcdUZCRjkiLAogICJcdTA2MjZcdTA2NDkiLAogICJcdUZCRkEiLAogICJcdTA2MjZcdTA2NDkiLAogICJcdUZCRkIiLAogICJcdTA2MjZcdTA2NDkiLAogICJcdUZCRkMiLAogICJcdTA2Q0MiLAogICJcdUZCRkQiLAogICJcdTA2Q0MiLAogICJcdUZCRkUiLAogICJcdTA2Q0MiLAogICJcdUZCRkYiLAogICJcdTA2Q0MiLAogICJcdUZDMDAiLAogICJcdTA2MjZcdTA2MkMiLAogICJcdUZDMDEiLAogICJcdTA2MjZcdTA2MkQiLAogICJcdUZDMDIiLAogICJcdTA2MjZcdTA2NDUiLAogICJcdUZDMDMiLAogICJcdTA2MjZcdTA2NDkiLAogICJcdUZDMDQiLAogICJcdTA2MjZcdTA2NEEiLAogICJcdUZDMDUiLAogICJcdTA2MjhcdTA2MkMiLAogICJcdUZDMDYiLAogICJcdTA2MjhcdTA2MkQiLAogICJcdUZDMDciLAogICJcdTA2MjhcdTA2MkUiLAogICJcdUZDMDgiLAogICJcdTA2MjhcdTA2NDUiLAogICJcdUZDMDkiLAogICJcdTA2MjhcdTA2NDkiLAogICJcdUZDMEEiLAogICJcdTA2MjhcdTA2NEEiLAogICJcdUZDMEIiLAogICJcdTA2MkFcdTA2MkMiLAogICJcdUZDMEMiLAogICJcdTA2MkFcdTA2MkQiLAogICJcdUZDMEQiLAogICJcdTA2MkFcdTA2MkUiLAogICJcdUZDMEUiLAogICJcdTA2MkFcdTA2NDUiLAogICJcdUZDMEYiLAogICJcdTA2MkFcdTA2NDkiLAogICJcdUZDMTAiLAogICJcdTA2MkFcdTA2NEEiLAogICJcdUZDMTEiLAogICJcdTA2MkJcdTA2MkMiLAogICJcdUZDMTIiLAogICJcdTA2MkJcdTA2NDUiLAogICJcdUZDMTMiLAogICJcdTA2MkJcdTA2NDkiLAogICJcdUZDMTQiLAogICJcdTA2MkJcdTA2NEEiLAogICJcdUZDMTUiLAogICJcdTA2MkNcdTA2MkQiLAogICJcdUZDMTYiLAogICJcdTA2MkNcdTA2NDUiLAogICJcdUZDMTciLAogICJcdTA2MkRcdTA2MkMiLAogICJcdUZDMTgiLAogICJcdTA2MkRcdTA2NDUiLAogICJcdUZDMTkiLAogICJcdTA2MkVcdTA2MkMiLAogICJcdUZDMUEiLAogICJcdTA2MkVcdTA2MkQiLAogICJcdUZDMUIiLAogICJcdTA2MkVcdTA2NDUiLAogICJcdUZDMUMiLAogICJcdTA2MzNcdTA2MkMiLAogICJcdUZDMUQiLAogICJcdTA2MzNcdTA2MkQiLAogICJcdUZDMUUiLAogICJcdTA2MzNcdTA2MkUiLAogICJcdUZDMUYiLAogICJcdTA2MzNcdTA2NDUiLAogICJcdUZDMjAiLAogICJcdTA2MzVcdTA2MkQiLAogICJcdUZDMjEiLAogICJcdTA2MzVcdTA2NDUiLAogICJcdUZDMjIiLAogICJcdTA2MzZcdTA2MkMiLAogICJcdUZDMjMiLAogICJcdTA2MzZcdTA2MkQiLAogICJcdUZDMjQiLAogICJcdTA2MzZcdTA2MkUiLAogICJcdUZDMjUiLAogICJcdTA2MzZcdTA2NDUiLAogICJcdUZDMjYiLAogICJcdTA2MzdcdTA2MkQiLAogICJcdUZDMjciLAogICJcdTA2MzdcdTA2NDUiLAogICJcdUZDMjgiLAogICJcdTA2MzhcdTA2NDUiLAogICJcdUZDMjkiLAogICJcdTA2MzlcdTA2MkMiLAogICJcdUZDMkEiLAogICJcdTA2MzlcdTA2NDUiLAogICJcdUZDMkIiLAogICJcdTA2M0FcdTA2MkMiLAogICJcdUZDMkMiLAogICJcdTA2M0FcdTA2NDUiLAogICJcdUZDMkQiLAogICJcdTA2NDFcdTA2MkMiLAogICJcdUZDMkUiLAogICJcdTA2NDFcdTA2MkQiLAogICJcdUZDMkYiLAogICJcdTA2NDFcdTA2MkUiLAogICJcdUZDMzAiLAogICJcdTA2NDFcdTA2NDUiLAogICJcdUZDMzEiLAogICJcdTA2NDFcdTA2NDkiLAogICJcdUZDMzIiLAogICJcdTA2NDFcdTA2NEEiLAogICJcdUZDMzMiLAogICJcdTA2NDJcdTA2MkQiLAogICJcdUZDMzQiLAogICJcdTA2NDJcdTA2NDUiLAogICJcdUZDMzUiLAogICJcdTA2NDJcdTA2NDkiLAogICJcdUZDMzYiLAogICJcdTA2NDJcdTA2NEEiLAogICJcdUZDMzciLAogICJcdTA2NDNcdTA2MjciLAogICJcdUZDMzgiLAogICJcdTA2NDNcdTA2MkMiLAogICJcdUZDMzkiLAogICJcdTA2NDNcdTA2MkQiLAogICJcdUZDM0EiLAogICJcdTA2NDNcdTA2MkUiLAogICJcdUZDM0IiLAogICJcdTA2NDNcdTA2NDQiLAogICJcdUZDM0MiLAogICJcdTA2NDNcdTA2NDUiLAogICJcdUZDM0QiLAogICJcdTA2NDNcdTA2NDkiLAogICJcdUZDM0UiLAogICJcdTA2NDNcdTA2NEEiLAogICJcdUZDM0YiLAogICJcdTA2NDRcdTA2MkMiLAogICJcdUZDNDAiLAogICJcdTA2NDRcdTA2MkQiLAogICJcdUZDNDEiLAogICJcdTA2NDRcdTA2MkUiLAogICJcdUZDNDIiLAogICJcdTA2NDRcdTA2NDUiLAogICJcdUZDNDMiLAogICJcdTA2NDRcdTA2NDkiLAogICJcdUZDNDQiLAogICJcdTA2NDRcdTA2NEEiLAogICJcdUZDNDUiLAogICJcdTA2NDVcdTA2MkMiLAogICJcdUZDNDYiLAogICJcdTA2NDVcdTA2MkQiLAogICJcdUZDNDciLAogICJcdTA2NDVcdTA2MkUiLAogICJcdUZDNDgiLAogICJcdTA2NDVcdTA2NDUiLAogICJcdUZDNDkiLAogICJcdTA2NDVcdTA2NDkiLAogICJcdUZDNEEiLAogICJcdTA2NDVcdTA2NEEiLAogICJcdUZDNEIiLAogICJcdTA2NDZcdTA2MkMiLAogICJcdUZDNEMiLAogICJcdTA2NDZcdTA2MkQiLAogICJcdUZDNEQiLAogICJcdTA2NDZcdTA2MkUiLAogICJcdUZDNEUiLAogICJcdTA2NDZcdTA2NDUiLAogICJcdUZDNEYiLAogICJcdTA2NDZcdTA2NDkiLAogICJcdUZDNTAiLAogICJcdTA2NDZcdTA2NEEiLAogICJcdUZDNTEiLAogICJcdTA2NDdcdTA2MkMiLAogICJcdUZDNTIiLAogICJcdTA2NDdcdTA2NDUiLAogICJcdUZDNTMiLAogICJcdTA2NDdcdTA2NDkiLAogICJcdUZDNTQiLAogICJcdTA2NDdcdTA2NEEiLAogICJcdUZDNTUiLAogICJcdTA2NEFcdTA2MkMiLAogICJcdUZDNTYiLAogICJcdTA2NEFcdTA2MkQiLAogICJcdUZDNTciLAogICJcdTA2NEFcdTA2MkUiLAogICJcdUZDNTgiLAogICJcdTA2NEFcdTA2NDUiLAogICJcdUZDNTkiLAogICJcdTA2NEFcdTA2NDkiLAogICJcdUZDNUEiLAogICJcdTA2NEFcdTA2NEEiLAogICJcdUZDNUIiLAogICJcdTA2MzBcdTA2NzAiLAogICJcdUZDNUMiLAogICJcdTA2MzFcdTA2NzAiLAogICJcdUZDNUQiLAogICJcdTA2NDlcdTA2NzAiLAogICJcdUZDNUUiLAogICJcdTAwMjBcdTA2NENcdTA2NTEiLAogICJcdUZDNUYiLAogICJcdTAwMjBcdTA2NERcdTA2NTEiLAogICJcdUZDNjAiLAogICJcdTAwMjBcdTA2NEVcdTA2NTEiLAogICJcdUZDNjEiLAogICJcdTAwMjBcdTA2NEZcdTA2NTEiLAogICJcdUZDNjIiLAogICJcdTAwMjBcdTA2NTBcdTA2NTEiLAogICJcdUZDNjMiLAogICJcdTAwMjBcdTA2NTFcdTA2NzAiLAogICJcdUZDNjQiLAogICJcdTA2MjZcdTA2MzEiLAogICJcdUZDNjUiLAogICJcdTA2MjZcdTA2MzIiLAogICJcdUZDNjYiLAogICJcdTA2MjZcdTA2NDUiLAogICJcdUZDNjciLAogICJcdTA2MjZcdTA2NDYiLAogICJcdUZDNjgiLAogICJcdTA2MjZcdTA2NDkiLAogICJcdUZDNjkiLAogICJcdTA2MjZcdTA2NEEiLAogICJcdUZDNkEiLAogICJcdTA2MjhcdTA2MzEiLAogICJcdUZDNkIiLAogICJcdTA2MjhcdTA2MzIiLAogICJcdUZDNkMiLAogICJcdTA2MjhcdTA2NDUiLAogICJcdUZDNkQiLAogICJcdTA2MjhcdTA2NDYiLAogICJcdUZDNkUiLAogICJcdTA2MjhcdTA2NDkiLAogICJcdUZDNkYiLAogICJcdTA2MjhcdTA2NEEiLAogICJcdUZDNzAiLAogICJcdTA2MkFcdTA2MzEiLAogICJcdUZDNzEiLAogICJcdTA2MkFcdTA2MzIiLAogICJcdUZDNzIiLAogICJcdTA2MkFcdTA2NDUiLAogICJcdUZDNzMiLAogICJcdTA2MkFcdTA2NDYiLAogICJcdUZDNzQiLAogICJcdTA2MkFcdTA2NDkiLAogICJcdUZDNzUiLAogICJcdTA2MkFcdTA2NEEiLAogICJcdUZDNzYiLAogICJcdTA2MkJcdTA2MzEiLAogICJcdUZDNzciLAogICJcdTA2MkJcdTA2MzIiLAogICJcdUZDNzgiLAogICJcdTA2MkJcdTA2NDUiLAogICJcdUZDNzkiLAogICJcdTA2MkJcdTA2NDYiLAogICJcdUZDN0EiLAogICJcdTA2MkJcdTA2NDkiLAogICJcdUZDN0IiLAogICJcdTA2MkJcdTA2NEEiLAogICJcdUZDN0MiLAogICJcdTA2NDFcdTA2NDkiLAogICJcdUZDN0QiLAogICJcdTA2NDFcdTA2NEEiLAogICJcdUZDN0UiLAogICJcdTA2NDJcdTA2NDkiLAogICJcdUZDN0YiLAogICJcdTA2NDJcdTA2NEEiLAogICJcdUZDODAiLAogICJcdTA2NDNcdTA2MjciLAogICJcdUZDODEiLAogICJcdTA2NDNcdTA2NDQiLAogICJcdUZDODIiLAogICJcdTA2NDNcdTA2NDUiLAogICJcdUZDODMiLAogICJcdTA2NDNcdTA2NDkiLAogICJcdUZDODQiLAogICJcdTA2NDNcdTA2NEEiLAogICJcdUZDODUiLAogICJcdTA2NDRcdTA2NDUiLAogICJcdUZDODYiLAogICJcdTA2NDRcdTA2NDkiLAogICJcdUZDODciLAogICJcdTA2NDRcdTA2NEEiLAogICJcdUZDODgiLAogICJcdTA2NDVcdTA2MjciLAogICJcdUZDODkiLAogICJcdTA2NDVcdTA2NDUiLAogICJcdUZDOEEiLAogICJcdTA2NDZcdTA2MzEiLAogICJcdUZDOEIiLAogICJcdTA2NDZcdTA2MzIiLAogICJcdUZDOEMiLAogICJcdTA2NDZcdTA2NDUiLAogICJcdUZDOEQiLAogICJcdTA2NDZcdTA2NDYiLAogICJcdUZDOEUiLAogICJcdTA2NDZcdTA2NDkiLAogICJcdUZDOEYiLAogICJcdTA2NDZcdTA2NEEiLAogICJcdUZDOTAiLAogICJcdTA2NDlcdTA2NzAiLAogICJcdUZDOTEiLAogICJcdTA2NEFcdTA2MzEiLAogICJcdUZDOTIiLAogICJcdTA2NEFcdTA2MzIiLAogICJcdUZDOTMiLAogICJcdTA2NEFcdTA2NDUiLAogICJcdUZDOTQiLAogICJcdTA2NEFcdTA2NDYiLAogICJcdUZDOTUiLAogICJcdTA2NEFcdTA2NDkiLAogICJcdUZDOTYiLAogICJcdTA2NEFcdTA2NEEiLAogICJcdUZDOTciLAogICJcdTA2MjZcdTA2MkMiLAogICJcdUZDOTgiLAogICJcdTA2MjZcdTA2MkQiLAogICJcdUZDOTkiLAogICJcdTA2MjZcdTA2MkUiLAogICJcdUZDOUEiLAogICJcdTA2MjZcdTA2NDUiLAogICJcdUZDOUIiLAogICJcdTA2MjZcdTA2NDciLAogICJcdUZDOUMiLAogICJcdTA2MjhcdTA2MkMiLAogICJcdUZDOUQiLAogICJcdTA2MjhcdTA2MkQiLAogICJcdUZDOUUiLAogICJcdTA2MjhcdTA2MkUiLAogICJcdUZDOUYiLAogICJcdTA2MjhcdTA2NDUiLAogICJcdUZDQTAiLAogICJcdTA2MjhcdTA2NDciLAogICJcdUZDQTEiLAogICJcdTA2MkFcdTA2MkMiLAogICJcdUZDQTIiLAogICJcdTA2MkFcdTA2MkQiLAogICJcdUZDQTMiLAogICJcdTA2MkFcdTA2MkUiLAogICJcdUZDQTQiLAogICJcdTA2MkFcdTA2NDUiLAogICJcdUZDQTUiLAogICJcdTA2MkFcdTA2NDciLAogICJcdUZDQTYiLAogICJcdTA2MkJcdTA2NDUiLAogICJcdUZDQTciLAogICJcdTA2MkNcdTA2MkQiLAogICJcdUZDQTgiLAogICJcdTA2MkNcdTA2NDUiLAogICJcdUZDQTkiLAogICJcdTA2MkRcdTA2MkMiLAogICJcdUZDQUEiLAogICJcdTA2MkRcdTA2NDUiLAogICJcdUZDQUIiLAogICJcdTA2MkVcdTA2MkMiLAogICJcdUZDQUMiLAogICJcdTA2MkVcdTA2NDUiLAogICJcdUZDQUQiLAogICJcdTA2MzNcdTA2MkMiLAogICJcdUZDQUUiLAogICJcdTA2MzNcdTA2MkQiLAogICJcdUZDQUYiLAogICJcdTA2MzNcdTA2MkUiLAogICJcdUZDQjAiLAogICJcdTA2MzNcdTA2NDUiLAogICJcdUZDQjEiLAogICJcdTA2MzVcdTA2MkQiLAogICJcdUZDQjIiLAogICJcdTA2MzVcdTA2MkUiLAogICJcdUZDQjMiLAogICJcdTA2MzVcdTA2NDUiLAogICJcdUZDQjQiLAogICJcdTA2MzZcdTA2MkMiLAogICJcdUZDQjUiLAogICJcdTA2MzZcdTA2MkQiLAogICJcdUZDQjYiLAogICJcdTA2MzZcdTA2MkUiLAogICJcdUZDQjciLAogICJcdTA2MzZcdTA2NDUiLAogICJcdUZDQjgiLAogICJcdTA2MzdcdTA2MkQiLAogICJcdUZDQjkiLAogICJcdTA2MzhcdTA2NDUiLAogICJcdUZDQkEiLAogICJcdTA2MzlcdTA2MkMiLAogICJcdUZDQkIiLAogICJcdTA2MzlcdTA2NDUiLAogICJcdUZDQkMiLAogICJcdTA2M0FcdTA2MkMiLAogICJcdUZDQkQiLAogICJcdTA2M0FcdTA2NDUiLAogICJcdUZDQkUiLAogICJcdTA2NDFcdTA2MkMiLAogICJcdUZDQkYiLAogICJcdTA2NDFcdTA2MkQiLAogICJcdUZDQzAiLAogICJcdTA2NDFcdTA2MkUiLAogICJcdUZDQzEiLAogICJcdTA2NDFcdTA2NDUiLAogICJcdUZDQzIiLAogICJcdTA2NDJcdTA2MkQiLAogICJcdUZDQzMiLAogICJcdTA2NDJcdTA2NDUiLAogICJcdUZDQzQiLAogICJcdTA2NDNcdTA2MkMiLAogICJcdUZDQzUiLAogICJcdTA2NDNcdTA2MkQiLAogICJcdUZDQzYiLAogICJcdTA2NDNcdTA2MkUiLAogICJcdUZDQzciLAogICJcdTA2NDNcdTA2NDQiLAogICJcdUZDQzgiLAogICJcdTA2NDNcdTA2NDUiLAogICJcdUZDQzkiLAogICJcdTA2NDRcdTA2MkMiLAogICJcdUZDQ0EiLAogICJcdTA2NDRcdTA2MkQiLAogICJcdUZDQ0IiLAogICJcdTA2NDRcdTA2MkUiLAogICJcdUZDQ0MiLAogICJcdTA2NDRcdTA2NDUiLAogICJcdUZDQ0QiLAogICJcdTA2NDRcdTA2NDciLAogICJcdUZDQ0UiLAogICJcdTA2NDVcdTA2MkMiLAogICJcdUZDQ0YiLAogICJcdTA2NDVcdTA2MkQiLAogICJcdUZDRDAiLAogICJcdTA2NDVcdTA2MkUiLAogICJcdUZDRDEiLAogICJcdTA2NDVcdTA2NDUiLAogICJcdUZDRDIiLAogICJcdTA2NDZcdTA2MkMiLAogICJcdUZDRDMiLAogICJcdTA2NDZcdTA2MkQiLAogICJcdUZDRDQiLAogICJcdTA2NDZcdTA2MkUiLAogICJcdUZDRDUiLAogICJcdTA2NDZcdTA2NDUiLAogICJcdUZDRDYiLAogICJcdTA2NDZcdTA2NDciLAogICJcdUZDRDciLAogICJcdTA2NDdcdTA2MkMiLAogICJcdUZDRDgiLAogICJcdTA2NDdcdTA2NDUiLAogICJcdUZDRDkiLAogICJcdTA2NDdcdTA2NzAiLAogICJcdUZDREEiLAogICJcdTA2NEFcdTA2MkMiLAogICJcdUZDREIiLAogICJcdTA2NEFcdTA2MkQiLAogICJcdUZDREMiLAogICJcdTA2NEFcdTA2MkUiLAogICJcdUZDREQiLAogICJcdTA2NEFcdTA2NDUiLAogICJcdUZDREUiLAogICJcdTA2NEFcdTA2NDciLAogICJcdUZDREYiLAogICJcdTA2MjZcdTA2NDUiLAogICJcdUZDRTAiLAogICJcdTA2MjZcdTA2NDciLAogICJcdUZDRTEiLAogICJcdTA2MjhcdTA2NDUiLAogICJcdUZDRTIiLAogICJcdTA2MjhcdTA2NDciLAogICJcdUZDRTMiLAogICJcdTA2MkFcdTA2NDUiLAogICJcdUZDRTQiLAogICJcdTA2MkFcdTA2NDciLAogICJcdUZDRTUiLAogICJcdTA2MkJcdTA2NDUiLAogICJcdUZDRTYiLAogICJcdTA2MkJcdTA2NDciLAogICJcdUZDRTciLAogICJcdTA2MzNcdTA2NDUiLAogICJcdUZDRTgiLAogICJcdTA2MzNcdTA2NDciLAogICJcdUZDRTkiLAogICJcdTA2MzRcdTA2NDUiLAogICJcdUZDRUEiLAogICJcdTA2MzRcdTA2NDciLAogICJcdUZDRUIiLAogICJcdTA2NDNcdTA2NDQiLAogICJcdUZDRUMiLAogICJcdTA2NDNcdTA2NDUiLAogICJcdUZDRUQiLAogICJcdTA2NDRcdTA2NDUiLAogICJcdUZDRUUiLAogICJcdTA2NDZcdTA2NDUiLAogICJcdUZDRUYiLAogICJcdTA2NDZcdTA2NDciLAogICJcdUZDRjAiLAogICJcdTA2NEFcdTA2NDUiLAogICJcdUZDRjEiLAogICJcdTA2NEFcdTA2NDciLAogICJcdUZDRjIiLAogICJcdTA2NDBcdTA2NEVcdTA2NTEiLAogICJcdUZDRjMiLAogICJcdTA2NDBcdTA2NEZcdTA2NTEiLAogICJcdUZDRjQiLAogICJcdTA2NDBcdTA2NTBcdTA2NTEiLAogICJcdUZDRjUiLAogICJcdTA2MzdcdTA2NDkiLAogICJcdUZDRjYiLAogICJcdTA2MzdcdTA2NEEiLAogICJcdUZDRjciLAogICJcdTA2MzlcdTA2NDkiLAogICJcdUZDRjgiLAogICJcdTA2MzlcdTA2NEEiLAogICJcdUZDRjkiLAogICJcdTA2M0FcdTA2NDkiLAogICJcdUZDRkEiLAogICJcdTA2M0FcdTA2NEEiLAogICJcdUZDRkIiLAogICJcdTA2MzNcdTA2NDkiLAogICJcdUZDRkMiLAogICJcdTA2MzNcdTA2NEEiLAogICJcdUZDRkQiLAogICJcdTA2MzRcdTA2NDkiLAogICJcdUZDRkUiLAogICJcdTA2MzRcdTA2NEEiLAogICJcdUZDRkYiLAogICJcdTA2MkRcdTA2NDkiLAogICJcdUZEMDAiLAogICJcdTA2MkRcdTA2NEEiLAogICJcdUZEMDEiLAogICJcdTA2MkNcdTA2NDkiLAogICJcdUZEMDIiLAogICJcdTA2MkNcdTA2NEEiLAogICJcdUZEMDMiLAogICJcdTA2MkVcdTA2NDkiLAogICJcdUZEMDQiLAogICJcdTA2MkVcdTA2NEEiLAogICJcdUZEMDUiLAogICJcdTA2MzVcdTA2NDkiLAogICJcdUZEMDYiLAogICJcdTA2MzVcdTA2NEEiLAogICJcdUZEMDciLAogICJcdTA2MzZcdTA2NDkiLAogICJcdUZEMDgiLAogICJcdTA2MzZcdTA2NEEiLAogICJcdUZEMDkiLAogICJcdTA2MzRcdTA2MkMiLAogICJcdUZEMEEiLAogICJcdTA2MzRcdTA2MkQiLAogICJcdUZEMEIiLAogICJcdTA2MzRcdTA2MkUiLAogICJcdUZEMEMiLAogICJcdTA2MzRcdTA2NDUiLAogICJcdUZEMEQiLAogICJcdTA2MzRcdTA2MzEiLAogICJcdUZEMEUiLAogICJcdTA2MzNcdTA2MzEiLAogICJcdUZEMEYiLAogICJcdTA2MzVcdTA2MzEiLAogICJcdUZEMTAiLAogICJcdTA2MzZcdTA2MzEiLAogICJcdUZEMTEiLAogICJcdTA2MzdcdTA2NDkiLAogICJcdUZEMTIiLAogICJcdTA2MzdcdTA2NEEiLAogICJcdUZEMTMiLAogICJcdTA2MzlcdTA2NDkiLAogICJcdUZEMTQiLAogICJcdTA2MzlcdTA2NEEiLAogICJcdUZEMTUiLAogICJcdTA2M0FcdTA2NDkiLAogICJcdUZEMTYiLAogICJcdTA2M0FcdTA2NEEiLAogICJcdUZEMTciLAogICJcdTA2MzNcdTA2NDkiLAogICJcdUZEMTgiLAogICJcdTA2MzNcdTA2NEEiLAogICJcdUZEMTkiLAogICJcdTA2MzRcdTA2NDkiLAogICJcdUZEMUEiLAogICJcdTA2MzRcdTA2NEEiLAogICJcdUZEMUIiLAogICJcdTA2MkRcdTA2NDkiLAogICJcdUZEMUMiLAogICJcdTA2MkRcdTA2NEEiLAogICJcdUZEMUQiLAogICJcdTA2MkNcdTA2NDkiLAogICJcdUZEMUUiLAogICJcdTA2MkNcdTA2NEEiLAogICJcdUZEMUYiLAogICJcdTA2MkVcdTA2NDkiLAogICJcdUZEMjAiLAogICJcdTA2MkVcdTA2NEEiLAogICJcdUZEMjEiLAogICJcdTA2MzVcdTA2NDkiLAogICJcdUZEMjIiLAogICJcdTA2MzVcdTA2NEEiLAogICJcdUZEMjMiLAogICJcdTA2MzZcdTA2NDkiLAogICJcdUZEMjQiLAogICJcdTA2MzZcdTA2NEEiLAogICJcdUZEMjUiLAogICJcdTA2MzRcdTA2MkMiLAogICJcdUZEMjYiLAogICJcdTA2MzRcdTA2MkQiLAogICJcdUZEMjciLAogICJcdTA2MzRcdTA2MkUiLAogICJcdUZEMjgiLAogICJcdTA2MzRcdTA2NDUiLAogICJcdUZEMjkiLAogICJcdTA2MzRcdTA2MzEiLAogICJcdUZEMkEiLAogICJcdTA2MzNcdTA2MzEiLAogICJcdUZEMkIiLAogICJcdTA2MzVcdTA2MzEiLAogICJcdUZEMkMiLAogICJcdTA2MzZcdTA2MzEiLAogICJcdUZEMkQiLAogICJcdTA2MzRcdTA2MkMiLAogICJcdUZEMkUiLAogICJcdTA2MzRcdTA2MkQiLAogICJcdUZEMkYiLAogICJcdTA2MzRcdTA2MkUiLAogICJcdUZEMzAiLAogICJcdTA2MzRcdTA2NDUiLAogICJcdUZEMzEiLAogICJcdTA2MzNcdTA2NDciLAogICJcdUZEMzIiLAogICJcdTA2MzRcdTA2NDciLAogICJcdUZEMzMiLAogICJcdTA2MzdcdTA2NDUiLAogICJcdUZEMzQiLAogICJcdTA2MzNcdTA2MkMiLAogICJcdUZEMzUiLAogICJcdTA2MzNcdTA2MkQiLAogICJcdUZEMzYiLAogICJcdTA2MzNcdTA2MkUiLAogICJcdUZEMzciLAogICJcdTA2MzRcdTA2MkMiLAogICJcdUZEMzgiLAogICJcdTA2MzRcdTA2MkQiLAogICJcdUZEMzkiLAogICJcdTA2MzRcdTA2MkUiLAogICJcdUZEM0EiLAogICJcdTA2MzdcdTA2NDUiLAogICJcdUZEM0IiLAogICJcdTA2MzhcdTA2NDUiLAogICJcdUZEM0MiLAogICJcdTA2MjdcdTA2NEIiLAogICJcdUZEM0QiLAogICJcdTA2MjdcdTA2NEIiLAogICJcdUZENTAiLAogICJcdTA2MkFcdTA2MkNcdTA2NDUiLAogICJcdUZENTEiLAogICJcdTA2MkFcdTA2MkRcdTA2MkMiLAogICJcdUZENTIiLAogICJcdTA2MkFcdTA2MkRcdTA2MkMiLAogICJcdUZENTMiLAogICJcdTA2MkFcdTA2MkRcdTA2NDUiLAogICJcdUZENTQiLAogICJcdTA2MkFcdTA2MkVcdTA2NDUiLAogICJcdUZENTUiLAogICJcdTA2MkFcdTA2NDVcdTA2MkMiLAogICJcdUZENTYiLAogICJcdTA2MkFcdTA2NDVcdTA2MkQiLAogICJcdUZENTciLAogICJcdTA2MkFcdTA2NDVcdTA2MkUiLAogICJcdUZENTgiLAogICJcdTA2MkNcdTA2NDVcdTA2MkQiLAogICJcdUZENTkiLAogICJcdTA2MkNcdTA2NDVcdTA2MkQiLAogICJcdUZENUEiLAogICJcdTA2MkRcdTA2NDVcdTA2NEEiLAogICJcdUZENUIiLAogICJcdTA2MkRcdTA2NDVcdTA2NDkiLAogICJcdUZENUMiLAogICJcdTA2MzNcdTA2MkRcdTA2MkMiLAogICJcdUZENUQiLAogICJcdTA2MzNcdTA2MkNcdTA2MkQiLAogICJcdUZENUUiLAogICJcdTA2MzNcdTA2MkNcdTA2NDkiLAogICJcdUZENUYiLAogICJcdTA2MzNcdTA2NDVcdTA2MkQiLAogICJcdUZENjAiLAogICJcdTA2MzNcdTA2NDVcdTA2MkQiLAogICJcdUZENjEiLAogICJcdTA2MzNcdTA2NDVcdTA2MkMiLAogICJcdUZENjIiLAogICJcdTA2MzNcdTA2NDVcdTA2NDUiLAogICJcdUZENjMiLAogICJcdTA2MzNcdTA2NDVcdTA2NDUiLAogICJcdUZENjQiLAogICJcdTA2MzVcdTA2MkRcdTA2MkQiLAogICJcdUZENjUiLAogICJcdTA2MzVcdTA2MkRcdTA2MkQiLAogICJcdUZENjYiLAogICJcdTA2MzVcdTA2NDVcdTA2NDUiLAogICJcdUZENjciLAogICJcdTA2MzRcdTA2MkRcdTA2NDUiLAogICJcdUZENjgiLAogICJcdTA2MzRcdTA2MkRcdTA2NDUiLAogICJcdUZENjkiLAogICJcdTA2MzRcdTA2MkNcdTA2NEEiLAogICJcdUZENkEiLAogICJcdTA2MzRcdTA2NDVcdTA2MkUiLAogICJcdUZENkIiLAogICJcdTA2MzRcdTA2NDVcdTA2MkUiLAogICJcdUZENkMiLAogICJcdTA2MzRcdTA2NDVcdTA2NDUiLAogICJcdUZENkQiLAogICJcdTA2MzRcdTA2NDVcdTA2NDUiLAogICJcdUZENkUiLAogICJcdTA2MzZcdTA2MkRcdTA2NDkiLAogICJcdUZENkYiLAogICJcdTA2MzZcdTA2MkVcdTA2NDUiLAogICJcdUZENzAiLAogICJcdTA2MzZcdTA2MkVcdTA2NDUiLAogICJcdUZENzEiLAogICJcdTA2MzdcdTA2NDVcdTA2MkQiLAogICJcdUZENzIiLAogICJcdTA2MzdcdTA2NDVcdTA2MkQiLAogICJcdUZENzMiLAogICJcdTA2MzdcdTA2NDVcdTA2NDUiLAogICJcdUZENzQiLAogICJcdTA2MzdcdTA2NDVcdTA2NEEiLAogICJcdUZENzUiLAogICJcdTA2MzlcdTA2MkNcdTA2NDUiLAogICJcdUZENzYiLAogICJcdTA2MzlcdTA2NDVcdTA2NDUiLAogICJcdUZENzciLAogICJcdTA2MzlcdTA2NDVcdTA2NDUiLAogICJcdUZENzgiLAogICJcdTA2MzlcdTA2NDVcdTA2NDkiLAogICJcdUZENzkiLAogICJcdTA2M0FcdTA2NDVcdTA2NDUiLAogICJcdUZEN0EiLAogICJcdTA2M0FcdTA2NDVcdTA2NEEiLAogICJcdUZEN0IiLAogICJcdTA2M0FcdTA2NDVcdTA2NDkiLAogICJcdUZEN0MiLAogICJcdTA2NDFcdTA2MkVcdTA2NDUiLAogICJcdUZEN0QiLAogICJcdTA2NDFcdTA2MkVcdTA2NDUiLAogICJcdUZEN0UiLAogICJcdTA2NDJcdTA2NDVcdTA2MkQiLAogICJcdUZEN0YiLAogICJcdTA2NDJcdTA2NDVcdTA2NDUiLAogICJcdUZEODAiLAogICJcdTA2NDRcdTA2MkRcdTA2NDUiLAogICJcdUZEODEiLAogICJcdTA2NDRcdTA2MkRcdTA2NEEiLAogICJcdUZEODIiLAogICJcdTA2NDRcdTA2MkRcdTA2NDkiLAogICJcdUZEODMiLAogICJcdTA2NDRcdTA2MkNcdTA2MkMiLAogICJcdUZEODQiLAogICJcdTA2NDRcdTA2MkNcdTA2MkMiLAogICJcdUZEODUiLAogICJcdTA2NDRcdTA2MkVcdTA2NDUiLAogICJcdUZEODYiLAogICJcdTA2NDRcdTA2MkVcdTA2NDUiLAogICJcdUZEODciLAogICJcdTA2NDRcdTA2NDVcdTA2MkQiLAogICJcdUZEODgiLAogICJcdTA2NDRcdTA2NDVcdTA2MkQiLAogICJcdUZEODkiLAogICJcdTA2NDVcdTA2MkRcdTA2MkMiLAogICJcdUZEOEEiLAogICJcdTA2NDVcdTA2MkRcdTA2NDUiLAogICJcdUZEOEIiLAogICJcdTA2NDVcdTA2MkRcdTA2NEEiLAogICJcdUZEOEMiLAogICJcdTA2NDVcdTA2MkNcdTA2MkQiLAogICJcdUZEOEQiLAogICJcdTA2NDVcdTA2MkNcdTA2NDUiLAogICJcdUZEOEUiLAogICJcdTA2NDVcdTA2MkVcdTA2MkMiLAogICJcdUZEOEYiLAogICJcdTA2NDVcdTA2MkVcdTA2NDUiLAogICJcdUZEOTIiLAogICJcdTA2NDVcdTA2MkNcdTA2MkUiLAogICJcdUZEOTMiLAogICJcdTA2NDdcdTA2NDVcdTA2MkMiLAogICJcdUZEOTQiLAogICJcdTA2NDdcdTA2NDVcdTA2NDUiLAogICJcdUZEOTUiLAogICJcdTA2NDZcdTA2MkRcdTA2NDUiLAogICJcdUZEOTYiLAogICJcdTA2NDZcdTA2MkRcdTA2NDkiLAogICJcdUZEOTciLAogICJcdTA2NDZcdTA2MkNcdTA2NDUiLAogICJcdUZEOTgiLAogICJcdTA2NDZcdTA2MkNcdTA2NDUiLAogICJcdUZEOTkiLAogICJcdTA2NDZcdTA2MkNcdTA2NDkiLAogICJcdUZEOUEiLAogICJcdTA2NDZcdTA2NDVcdTA2NEEiLAogICJcdUZEOUIiLAogICJcdTA2NDZcdTA2NDVcdTA2NDkiLAogICJcdUZEOUMiLAogICJcdTA2NEFcdTA2NDVcdTA2NDUiLAogICJcdUZEOUQiLAogICJcdTA2NEFcdTA2NDVcdTA2NDUiLAogICJcdUZEOUUiLAogICJcdTA2MjhcdTA2MkVcdTA2NEEiLAogICJcdUZEOUYiLAogICJcdTA2MkFcdTA2MkNcdTA2NEEiLAogICJcdUZEQTAiLAogICJcdTA2MkFcdTA2MkNcdTA2NDkiLAogICJcdUZEQTEiLAogICJcdTA2MkFcdTA2MkVcdTA2NEEiLAogICJcdUZEQTIiLAogICJcdTA2MkFcdTA2MkVcdTA2NDkiLAogICJcdUZEQTMiLAogICJcdTA2MkFcdTA2NDVcdTA2NEEiLAogICJcdUZEQTQiLAogICJcdTA2MkFcdTA2NDVcdTA2NDkiLAogICJcdUZEQTUiLAogICJcdTA2MkNcdTA2NDVcdTA2NEEiLAogICJcdUZEQTYiLAogICJcdTA2MkNcdTA2MkRcdTA2NDkiLAogICJcdUZEQTciLAogICJcdTA2MkNcdTA2NDVcdTA2NDkiLAogICJcdUZEQTgiLAogICJcdTA2MzNcdTA2MkVcdTA2NDkiLAogICJcdUZEQTkiLAogICJcdTA2MzVcdTA2MkRcdTA2NEEiLAogICJcdUZEQUEiLAogICJcdTA2MzRcdTA2MkRcdTA2NEEiLAogICJcdUZEQUIiLAogICJcdTA2MzZcdTA2MkRcdTA2NEEiLAogICJcdUZEQUMiLAogICJcdTA2NDRcdTA2MkNcdTA2NEEiLAogICJcdUZEQUQiLAogICJcdTA2NDRcdTA2NDVcdTA2NEEiLAogICJcdUZEQUUiLAogICJcdTA2NEFcdTA2MkRcdTA2NEEiLAogICJcdUZEQUYiLAogICJcdTA2NEFcdTA2MkNcdTA2NEEiLAogICJcdUZEQjAiLAogICJcdTA2NEFcdTA2NDVcdTA2NEEiLAogICJcdUZEQjEiLAogICJcdTA2NDVcdTA2NDVcdTA2NEEiLAogICJcdUZEQjIiLAogICJcdTA2NDJcdTA2NDVcdTA2NEEiLAogICJcdUZEQjMiLAogICJcdTA2NDZcdTA2MkRcdTA2NEEiLAogICJcdUZEQjQiLAogICJcdTA2NDJcdTA2NDVcdTA2MkQiLAogICJcdUZEQjUiLAogICJcdTA2NDRcdTA2MkRcdTA2NDUiLAogICJcdUZEQjYiLAogICJcdTA2MzlcdTA2NDVcdTA2NEEiLAogICJcdUZEQjciLAogICJcdTA2NDNcdTA2NDVcdTA2NEEiLAogICJcdUZEQjgiLAogICJcdTA2NDZcdTA2MkNcdTA2MkQiLAogICJcdUZEQjkiLAogICJcdTA2NDVcdTA2MkVcdTA2NEEiLAogICJcdUZEQkEiLAogICJcdTA2NDRcdTA2MkNcdTA2NDUiLAogICJcdUZEQkIiLAogICJcdTA2NDNcdTA2NDVcdTA2NDUiLAogICJcdUZEQkMiLAogICJcdTA2NDRcdTA2MkNcdTA2NDUiLAogICJcdUZEQkQiLAogICJcdTA2NDZcdTA2MkNcdTA2MkQiLAogICJcdUZEQkUiLAogICJcdTA2MkNcdTA2MkRcdTA2NEEiLAogICJcdUZEQkYiLAogICJcdTA2MkRcdTA2MkNcdTA2NEEiLAogICJcdUZEQzAiLAogICJcdTA2NDVcdTA2MkNcdTA2NEEiLAogICJcdUZEQzEiLAogICJcdTA2NDFcdTA2NDVcdTA2NEEiLAogICJcdUZEQzIiLAogICJcdTA2MjhcdTA2MkRcdTA2NEEiLAogICJcdUZEQzMiLAogICJcdTA2NDNcdTA2NDVcdTA2NDUiLAogICJcdUZEQzQiLAogICJcdTA2MzlcdTA2MkNcdTA2NDUiLAogICJcdUZEQzUiLAogICJcdTA2MzVcdTA2NDVcdTA2NDUiLAogICJcdUZEQzYiLAogICJcdTA2MzNcdTA2MkVcdTA2NEEiLAogICJcdUZEQzciLAogICJcdTA2NDZcdTA2MkNcdTA2NEEiLAogICJcdUZFNDkiLAogICJcdTIwM0UiLAogICJcdUZFNEEiLAogICJcdTIwM0UiLAogICJcdUZFNEIiLAogICJcdTIwM0UiLAogICJcdUZFNEMiLAogICJcdTIwM0UiLAogICJcdUZFNEQiLAogICJcdTAwNUYiLAogICJcdUZFNEUiLAogICJcdTAwNUYiLAogICJcdUZFNEYiLAogICJcdTAwNUYiLAogICJcdUZFODAiLAogICJcdTA2MjEiLAogICJcdUZFODEiLAogICJcdTA2MjIiLAogICJcdUZFODIiLAogICJcdTA2MjIiLAogICJcdUZFODMiLAogICJcdTA2MjMiLAogICJcdUZFODQiLAogICJcdTA2MjMiLAogICJcdUZFODUiLAogICJcdTA2MjQiLAogICJcdUZFODYiLAogICJcdTA2MjQiLAogICJcdUZFODciLAogICJcdTA2MjUiLAogICJcdUZFODgiLAogICJcdTA2MjUiLAogICJcdUZFODkiLAogICJcdTA2MjYiLAogICJcdUZFOEEiLAogICJcdTA2MjYiLAogICJcdUZFOEIiLAogICJcdTA2MjYiLAogICJcdUZFOEMiLAogICJcdTA2MjYiLAogICJcdUZFOEQiLAogICJcdTA2MjciLAogICJcdUZFOEUiLAogICJcdTA2MjciLAogICJcdUZFOEYiLAogICJcdTA2MjgiLAogICJcdUZFOTAiLAogICJcdTA2MjgiLAogICJcdUZFOTEiLAogICJcdTA2MjgiLAogICJcdUZFOTIiLAogICJcdTA2MjgiLAogICJcdUZFOTMiLAogICJcdTA2MjkiLAogICJcdUZFOTQiLAogICJcdTA2MjkiLAogICJcdUZFOTUiLAogICJcdTA2MkEiLAogICJcdUZFOTYiLAogICJcdTA2MkEiLAogICJcdUZFOTciLAogICJcdTA2MkEiLAogICJcdUZFOTgiLAogICJcdTA2MkEiLAogICJcdUZFOTkiLAogICJcdTA2MkIiLAogICJcdUZFOUEiLAogICJcdTA2MkIiLAogICJcdUZFOUIiLAogICJcdTA2MkIiLAogICJcdUZFOUMiLAogICJcdTA2MkIiLAogICJcdUZFOUQiLAogICJcdTA2MkMiLAogICJcdUZFOUUiLAogICJcdTA2MkMiLAogICJcdUZFOUYiLAogICJcdTA2MkMiLAogICJcdUZFQTAiLAogICJcdTA2MkMiLAogICJcdUZFQTEiLAogICJcdTA2MkQiLAogICJcdUZFQTIiLAogICJcdTA2MkQiLAogICJcdUZFQTMiLAogICJcdTA2MkQiLAogICJcdUZFQTQiLAogICJcdTA2MkQiLAogICJcdUZFQTUiLAogICJcdTA2MkUiLAogICJcdUZFQTYiLAogICJcdTA2MkUiLAogICJcdUZFQTciLAogICJcdTA2MkUiLAogICJcdUZFQTgiLAogICJcdTA2MkUiLAogICJcdUZFQTkiLAogICJcdTA2MkYiLAogICJcdUZFQUEiLAogICJcdTA2MkYiLAogICJcdUZFQUIiLAogICJcdTA2MzAiLAogICJcdUZFQUMiLAogICJcdTA2MzAiLAogICJcdUZFQUQiLAogICJcdTA2MzEiLAogICJcdUZFQUUiLAogICJcdTA2MzEiLAogICJcdUZFQUYiLAogICJcdTA2MzIiLAogICJcdUZFQjAiLAogICJcdTA2MzIiLAogICJcdUZFQjEiLAogICJcdTA2MzMiLAogICJcdUZFQjIiLAogICJcdTA2MzMiLAogICJcdUZFQjMiLAogICJcdTA2MzMiLAogICJcdUZFQjQiLAogICJcdTA2MzMiLAogICJcdUZFQjUiLAogICJcdTA2MzQiLAogICJcdUZFQjYiLAogICJcdTA2MzQiLAogICJcdUZFQjciLAogICJcdTA2MzQiLAogICJcdUZFQjgiLAogICJcdTA2MzQiLAogICJcdUZFQjkiLAogICJcdTA2MzUiLAogICJcdUZFQkEiLAogICJcdTA2MzUiLAogICJcdUZFQkIiLAogICJcdTA2MzUiLAogICJcdUZFQkMiLAogICJcdTA2MzUiLAogICJcdUZFQkQiLAogICJcdTA2MzYiLAogICJcdUZFQkUiLAogICJcdTA2MzYiLAogICJcdUZFQkYiLAogICJcdTA2MzYiLAogICJcdUZFQzAiLAogICJcdTA2MzYiLAogICJcdUZFQzEiLAogICJcdTA2MzciLAogICJcdUZFQzIiLAogICJcdTA2MzciLAogICJcdUZFQzMiLAogICJcdTA2MzciLAogICJcdUZFQzQiLAogICJcdTA2MzciLAogICJcdUZFQzUiLAogICJcdTA2MzgiLAogICJcdUZFQzYiLAogICJcdTA2MzgiLAogICJcdUZFQzciLAogICJcdTA2MzgiLAogICJcdUZFQzgiLAogICJcdTA2MzgiLAogICJcdUZFQzkiLAogICJcdTA2MzkiLAogICJcdUZFQ0EiLAogICJcdTA2MzkiLAogICJcdUZFQ0IiLAogICJcdTA2MzkiLAogICJcdUZFQ0MiLAogICJcdTA2MzkiLAogICJcdUZFQ0QiLAogICJcdTA2M0EiLAogICJcdUZFQ0UiLAogICJcdTA2M0EiLAogICJcdUZFQ0YiLAogICJcdTA2M0EiLAogICJcdUZFRDAiLAogICJcdTA2M0EiLAogICJcdUZFRDEiLAogICJcdTA2NDEiLAogICJcdUZFRDIiLAogICJcdTA2NDEiLAogICJcdUZFRDMiLAogICJcdTA2NDEiLAogICJcdUZFRDQiLAogICJcdTA2NDEiLAogICJcdUZFRDUiLAogICJcdTA2NDIiLAogICJcdUZFRDYiLAogICJcdTA2NDIiLAogICJcdUZFRDciLAogICJcdTA2NDIiLAogICJcdUZFRDgiLAogICJcdTA2NDIiLAogICJcdUZFRDkiLAogICJcdTA2NDMiLAogICJcdUZFREEiLAogICJcdTA2NDMiLAogICJcdUZFREIiLAogICJcdTA2NDMiLAogICJcdUZFREMiLAogICJcdTA2NDMiLAogICJcdUZFREQiLAogICJcdTA2NDQiLAogICJcdUZFREUiLAogICJcdTA2NDQiLAogICJcdUZFREYiLAogICJcdTA2NDQiLAogICJcdUZFRTAiLAogICJcdTA2NDQiLAogICJcdUZFRTEiLAogICJcdTA2NDUiLAogICJcdUZFRTIiLAogICJcdTA2NDUiLAogICJcdUZFRTMiLAogICJcdTA2NDUiLAogICJcdUZFRTQiLAogICJcdTA2NDUiLAogICJcdUZFRTUiLAogICJcdTA2NDYiLAogICJcdUZFRTYiLAogICJcdTA2NDYiLAogICJcdUZFRTciLAogICJcdTA2NDYiLAogICJcdUZFRTgiLAogICJcdTA2NDYiLAogICJcdUZFRTkiLAogICJcdTA2NDciLAogICJcdUZFRUEiLAogICJcdTA2NDciLAogICJcdUZFRUIiLAogICJcdTA2NDciLAogICJcdUZFRUMiLAogICJcdTA2NDciLAogICJcdUZFRUQiLAogICJcdTA2NDgiLAogICJcdUZFRUUiLAogICJcdTA2NDgiLAogICJcdUZFRUYiLAogICJcdTA2NDkiLAogICJcdUZFRjAiLAogICJcdTA2NDkiLAogICJcdUZFRjEiLAogICJcdTA2NEEiLAogICJcdUZFRjIiLAogICJcdTA2NEEiLAogICJcdUZFRjMiLAogICJcdTA2NEEiLAogICJcdUZFRjQiLAogICJcdTA2NEEiLAogICJcdUZFRjUiLAogICJcdTA2NDRcdTA2MjIiLAogICJcdUZFRjYiLAogICJcdTA2NDRcdTA2MjIiLAogICJcdUZFRjciLAogICJcdTA2NDRcdTA2MjMiLAogICJcdUZFRjgiLAogICJcdTA2NDRcdTA2MjMiLAogICJcdUZFRjkiLAogICJcdTA2NDRcdTA2MjUiLAogICJcdUZFRkEiLAogICJcdTA2NDRcdTA2MjUiLAogICJcdUZFRkIiLAogICJcdTA2NDRcdTA2MjciLAogICJcdUZFRkMiLAogICJcdTA2NDRcdTA2MjciCiBdOwp9KTsKZnVuY3Rpb24gcmV2ZXJzZUlmUnRsKGNoYXJzKSB7CiBjb25zdCBjaGFyc0xlbmd0aCA9IGNoYXJzLmxlbmd0aDsKIGlmIChjaGFyc0xlbmd0aCA8PSAxIHx8ICFpc1JUTFJhbmdlRm9yKGNoYXJzLmNoYXJDb2RlQXQoMCkpKSB7CiAgcmV0dXJuIGNoYXJzOwogfQogY29uc3QgYnVmID0gW107CiBmb3IgKGxldCBpaSA9IGNoYXJzTGVuZ3RoIC0gMTsgaWkgPj0gMDsgaWktLSkgewogIGJ1Zi5wdXNoKGNoYXJzW2lpXSk7CiB9CiByZXR1cm4gYnVmLmpvaW4oIiIpOwp9CmNvbnN0IFNwZWNpYWxDaGFyUmVnRXhwID0gbmV3IFJlZ0V4cCgiXihcXHMpfChcXHB7TW59KXwoXFxwe0NmfSkkIiwgInUiKTsKY29uc3QgQ2F0ZWdvcnlDYWNoZSA9IG5ldyBNYXAoKTsKZnVuY3Rpb24gZ2V0Q2hhclVuaWNvZGVDYXRlZ29yeShjaGFyKSB7CiBjb25zdCBjYWNoZWRDYXRlZ29yeSA9IENhdGVnb3J5Q2FjaGUuZ2V0KGNoYXIpOwogaWYgKGNhY2hlZENhdGVnb3J5KSB7CiAgcmV0dXJuIGNhY2hlZENhdGVnb3J5OwogfQogY29uc3QgZ3JvdXBzID0gY2hhci5tYXRjaChTcGVjaWFsQ2hhclJlZ0V4cCk7CiBjb25zdCBjYXRlZ29yeSA9IHsKICBpc1doaXRlc3BhY2U6ICEhKGdyb3VwcyAmJiBncm91cHNbMV0pLAogIGlzWmVyb1dpZHRoRGlhY3JpdGljOiAhIShncm91cHMgJiYgZ3JvdXBzWzJdKSwKICBpc0ludmlzaWJsZUZvcm1hdE1hcms6ICEhKGdyb3VwcyAmJiBncm91cHNbM10pCiB9OwogQ2F0ZWdvcnlDYWNoZS5zZXQoY2hhciwgY2F0ZWdvcnkpOwogcmV0dXJuIGNhdGVnb3J5Owp9CmZ1bmN0aW9uIGNsZWFyVW5pY29kZUNhY2hlcygpIHsKIENhdGVnb3J5Q2FjaGUuY2xlYXIoKTsKfQoKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmdldFNlcmlmRm9udHMgPSBleHBvcnRzLmdldE5vblN0ZEZvbnRNYXAgPSBleHBvcnRzLmdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cyA9IGV4cG9ydHMuZ2V0Rm9udE5hbWVUb0ZpbGVNYXAgPSB2b2lkIDA7CmV4cG9ydHMuZ2V0U3RhbmRhcmRGb250TmFtZSA9IGdldFN0YW5kYXJkRm9udE5hbWU7CmV4cG9ydHMuZ2V0U3ltYm9sc0ZvbnRzID0gZXhwb3J0cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmkgPSBleHBvcnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFjayA9IGV4cG9ydHMuZ2V0U3RkRm9udE1hcCA9IHZvaWQgMDsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX2ZvbnRzX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygzOCk7Cgpjb25zdCBnZXRTdGRGb250TWFwID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WyJUaW1lcy1Sb21hbiJdID0gIlRpbWVzLVJvbWFuIjsKICB0LkhlbHZldGljYSA9ICJIZWx2ZXRpY2EiOwogIHQuQ291cmllciA9ICJDb3VyaWVyIjsKICB0LlN5bWJvbCA9ICJTeW1ib2wiOwogIHRbIlRpbWVzLUJvbGQiXSA9ICJUaW1lcy1Cb2xkIjsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJDb3VyaWVyLUJvbGQiXSA9ICJDb3VyaWVyLUJvbGQiOwogIHQuWmFwZkRpbmdiYXRzID0gIlphcGZEaW5nYmF0cyI7CiAgdFsiVGltZXMtSXRhbGljIl0gPSAiVGltZXMtSXRhbGljIjsKICB0WyJIZWx2ZXRpY2EtT2JsaXF1ZSJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJDb3VyaWVyLU9ibGlxdWUiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHRbIlRpbWVzLUJvbGRJdGFsaWMiXSA9ICJUaW1lcy1Cb2xkSXRhbGljIjsKICB0WyJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkNvdXJpZXItQm9sZE9ibGlxdWUiXSA9ICJDb3VyaWVyLUJvbGRPYmxpcXVlIjsKICB0LkFyaWFsTmFycm93ID0gIkhlbHZldGljYSI7CiAgdFsiQXJpYWxOYXJyb3ctQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJBcmlhbE5hcnJvdy1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbE5hcnJvdy1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdC5BcmlhbEJsYWNrID0gIkhlbHZldGljYSI7CiAgdFsiQXJpYWxCbGFjay1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsQmxhY2stQm9sZEl0YWxpYyJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWxCbGFjay1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdFsiQXJpYWwtQmxhY2siXSA9ICJIZWx2ZXRpY2EiOwogIHRbIkFyaWFsLUJsYWNrLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQXJpYWwtQmxhY2stQm9sZEl0YWxpYyJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWwtQmxhY2stSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQXJpYWwgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbC1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkFyaWFsLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkFyaWFsTVQgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbC1Cb2xkSXRhbGljTVQiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkFyaWFsLUJvbGRNVCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJBcmlhbC1JdGFsaWNNVCJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkFyaWFsVW5pY29kZU1TID0gIkhlbHZldGljYSI7CiAgdFsiQXJpYWxVbmljb2RlTVMtQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJBcmlhbFVuaWNvZGVNUy1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbFVuaWNvZGVNUy1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdFsiQ291cmllci1Cb2xkSXRhbGljIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllci1JdGFsaWMiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHQuQ291cmllck5ldyA9ICJDb3VyaWVyIjsKICB0WyJDb3VyaWVyTmV3LUJvbGQiXSA9ICJDb3VyaWVyLUJvbGQiOwogIHRbIkNvdXJpZXJOZXctQm9sZEl0YWxpYyJdID0gIkNvdXJpZXItQm9sZE9ibGlxdWUiOwogIHRbIkNvdXJpZXJOZXctSXRhbGljIl0gPSAiQ291cmllci1PYmxpcXVlIjsKICB0WyJDb3VyaWVyTmV3UFMtQm9sZEl0YWxpY01UIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllck5ld1BTLUJvbGRNVCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdFsiQ291cmllck5ld1BTLUl0YWxpY01UIl0gPSAiQ291cmllci1PYmxpcXVlIjsKICB0LkNvdXJpZXJOZXdQU01UID0gIkNvdXJpZXIiOwogIHRbIkhlbHZldGljYS1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJIZWx2ZXRpY2EtSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHRbIlN5bWJvbC1Cb2xkIl0gPSAiU3ltYm9sIjsKICB0WyJTeW1ib2wtQm9sZEl0YWxpYyJdID0gIlN5bWJvbCI7CiAgdFsiU3ltYm9sLUl0YWxpYyJdID0gIlN5bWJvbCI7CiAgdC5UaW1lc05ld1JvbWFuID0gIlRpbWVzLVJvbWFuIjsKICB0WyJUaW1lc05ld1JvbWFuLUJvbGQiXSA9ICJUaW1lcy1Cb2xkIjsKICB0WyJUaW1lc05ld1JvbWFuLUJvbGRJdGFsaWMiXSA9ICJUaW1lcy1Cb2xkSXRhbGljIjsKICB0WyJUaW1lc05ld1JvbWFuLUl0YWxpYyJdID0gIlRpbWVzLUl0YWxpYyI7CiAgdC5UaW1lc05ld1JvbWFuUFMgPSAiVGltZXMtUm9tYW4iOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1Cb2xkIl0gPSAiVGltZXMtQm9sZCI7CiAgdFsiVGltZXNOZXdSb21hblBTLUJvbGRJdGFsaWMiXSA9ICJUaW1lcy1Cb2xkSXRhbGljIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtQm9sZEl0YWxpY01UIl0gPSAiVGltZXMtQm9sZEl0YWxpYyI7CiAgdFsiVGltZXNOZXdSb21hblBTLUJvbGRNVCJdID0gIlRpbWVzLUJvbGQiOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1JdGFsaWMiXSA9ICJUaW1lcy1JdGFsaWMiOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1JdGFsaWNNVCJdID0gIlRpbWVzLUl0YWxpYyI7CiAgdC5UaW1lc05ld1JvbWFuUFNNVCA9ICJUaW1lcy1Sb21hbiI7CiAgdFsiVGltZXNOZXdSb21hblBTTVQtQm9sZCJdID0gIlRpbWVzLUJvbGQiOwogIHRbIlRpbWVzTmV3Um9tYW5QU01ULUJvbGRJdGFsaWMiXSA9ICJUaW1lcy1Cb2xkSXRhbGljIjsKICB0WyJUaW1lc05ld1JvbWFuUFNNVC1JdGFsaWMiXSA9ICJUaW1lcy1JdGFsaWMiOwp9KTsKZXhwb3J0cy5nZXRTdGRGb250TWFwID0gZ2V0U3RkRm9udE1hcDsKY29uc3QgZ2V0Rm9udE5hbWVUb0ZpbGVNYXAgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuQ291cmllciA9ICJGb3hpdEZpeGVkLnBmYiI7CiAgdFsiQ291cmllci1Cb2xkIl0gPSAiRm94aXRGaXhlZEJvbGQucGZiIjsKICB0WyJDb3VyaWVyLUJvbGRPYmxpcXVlIl0gPSAiRm94aXRGaXhlZEJvbGRJdGFsaWMucGZiIjsKICB0WyJDb3VyaWVyLU9ibGlxdWUiXSA9ICJGb3hpdEZpeGVkSXRhbGljLnBmYiI7CiAgdC5IZWx2ZXRpY2EgPSAiRm94aXRTYW5zLnBmYiI7CiAgdFsiSGVsdmV0aWNhLUJvbGQiXSA9ICJGb3hpdFNhbnNCb2xkLnBmYiI7CiAgdFsiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIl0gPSAiRm94aXRTYW5zQm9sZEl0YWxpYy5wZmIiOwogIHRbIkhlbHZldGljYS1PYmxpcXVlIl0gPSAiRm94aXRTYW5zSXRhbGljLnBmYiI7CiAgdFsiVGltZXMtUm9tYW4iXSA9ICJGb3hpdFNlcmlmLnBmYiI7CiAgdFsiVGltZXMtQm9sZCJdID0gIkZveGl0U2VyaWZCb2xkLnBmYiI7CiAgdFsiVGltZXMtQm9sZEl0YWxpYyJdID0gIkZveGl0U2VyaWZCb2xkSXRhbGljLnBmYiI7CiAgdFsiVGltZXMtSXRhbGljIl0gPSAiRm94aXRTZXJpZkl0YWxpYy5wZmIiOwogIHQuU3ltYm9sID0gIkZveGl0U3ltYm9sLnBmYiI7CiAgdC5aYXBmRGluZ2JhdHMgPSAiRm94aXREaW5nYmF0cy5wZmIiOwogIHRbIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIiXSA9ICJMaWJlcmF0aW9uU2Fucy1SZWd1bGFyLnR0ZiI7CiAgdFsiTGliZXJhdGlvblNhbnMtQm9sZCJdID0gIkxpYmVyYXRpb25TYW5zLUJvbGQudHRmIjsKICB0WyJMaWJlcmF0aW9uU2Fucy1JdGFsaWMiXSA9ICJMaWJlcmF0aW9uU2Fucy1JdGFsaWMudHRmIjsKICB0WyJMaWJlcmF0aW9uU2Fucy1Cb2xkSXRhbGljIl0gPSAiTGliZXJhdGlvblNhbnMtQm9sZEl0YWxpYy50dGYiOwp9KTsKZXhwb3J0cy5nZXRGb250TmFtZVRvRmlsZU1hcCA9IGdldEZvbnROYW1lVG9GaWxlTWFwOwpjb25zdCBnZXROb25TdGRGb250TWFwID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkNhbGlicmkgPSAiSGVsdmV0aWNhIjsKICB0WyJDYWxpYnJpLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQ2FsaWJyaS1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJDYWxpYnJpLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkNlbnR1cnlHb3RoaWMgPSAiSGVsdmV0aWNhIjsKICB0WyJDZW50dXJ5R290aGljLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQ2VudHVyeUdvdGhpYy1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJDZW50dXJ5R290aGljLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkNvbWljU2Fuc01TID0gIkNvbWljIFNhbnMgTVMiOwogIHRbIkNvbWljU2Fuc01TLUJvbGQiXSA9ICJDb21pYyBTYW5zIE1TLUJvbGQiOwogIHRbIkNvbWljU2Fuc01TLUJvbGRJdGFsaWMiXSA9ICJDb21pYyBTYW5zIE1TLUJvbGRJdGFsaWMiOwogIHRbIkNvbWljU2Fuc01TLUl0YWxpYyJdID0gIkNvbWljIFNhbnMgTVMtSXRhbGljIjsKICB0WyJJdGNTeW1ib2wtQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJJdGNTeW1ib2wtQm9sZEl0YWxpYyJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiSXRjU3ltYm9sLUJvb2siXSA9ICJIZWx2ZXRpY2EiOwogIHRbIkl0Y1N5bWJvbC1Cb29rSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHRbIkl0Y1N5bWJvbC1NZWRpdW0iXSA9ICJIZWx2ZXRpY2EiOwogIHRbIkl0Y1N5bWJvbC1NZWRpdW1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdC5MdWNpZGFDb25zb2xlID0gIkNvdXJpZXIiOwogIHRbIkx1Y2lkYUNvbnNvbGUtQm9sZCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdFsiTHVjaWRhQ29uc29sZS1Cb2xkSXRhbGljIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiTHVjaWRhQ29uc29sZS1JdGFsaWMiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHRbIkx1Y2lkYVNhbnMtRGVtaSJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJNUy1Hb3RoaWMiXSA9ICJNUyBHb3RoaWMiOwogIHRbIk1TLUdvdGhpYy1Cb2xkIl0gPSAiTVMgR290aGljLUJvbGQiOwogIHRbIk1TLUdvdGhpYy1Cb2xkSXRhbGljIl0gPSAiTVMgR290aGljLUJvbGRJdGFsaWMiOwogIHRbIk1TLUdvdGhpYy1JdGFsaWMiXSA9ICJNUyBHb3RoaWMtSXRhbGljIjsKICB0WyJNUy1NaW5jaG8iXSA9ICJNUyBNaW5jaG8iOwogIHRbIk1TLU1pbmNoby1Cb2xkIl0gPSAiTVMgTWluY2hvLUJvbGQiOwogIHRbIk1TLU1pbmNoby1Cb2xkSXRhbGljIl0gPSAiTVMgTWluY2hvLUJvbGRJdGFsaWMiOwogIHRbIk1TLU1pbmNoby1JdGFsaWMiXSA9ICJNUyBNaW5jaG8tSXRhbGljIjsKICB0WyJNUy1QR290aGljIl0gPSAiTVMgUEdvdGhpYyI7CiAgdFsiTVMtUEdvdGhpYy1Cb2xkIl0gPSAiTVMgUEdvdGhpYy1Cb2xkIjsKICB0WyJNUy1QR290aGljLUJvbGRJdGFsaWMiXSA9ICJNUyBQR290aGljLUJvbGRJdGFsaWMiOwogIHRbIk1TLVBHb3RoaWMtSXRhbGljIl0gPSAiTVMgUEdvdGhpYy1JdGFsaWMiOwogIHRbIk1TLVBNaW5jaG8iXSA9ICJNUyBQTWluY2hvIjsKICB0WyJNUy1QTWluY2hvLUJvbGQiXSA9ICJNUyBQTWluY2hvLUJvbGQiOwogIHRbIk1TLVBNaW5jaG8tQm9sZEl0YWxpYyJdID0gIk1TIFBNaW5jaG8tQm9sZEl0YWxpYyI7CiAgdFsiTVMtUE1pbmNoby1JdGFsaWMiXSA9ICJNUyBQTWluY2hvLUl0YWxpYyI7CiAgdC5OdXB0aWFsU2NyaXB0ID0gIlRpbWVzLUl0YWxpYyI7CiAgdC5TZWdvZVVJU3ltYm9sID0gIkhlbHZldGljYSI7CiAgdC5XaW5nZGluZ3MgPSAiWmFwZkRpbmdiYXRzIjsKICB0WyJXaW5nZGluZ3MtUmVndWxhciJdID0gIlphcGZEaW5nYmF0cyI7Cn0pOwpleHBvcnRzLmdldE5vblN0ZEZvbnRNYXAgPSBnZXROb25TdGRGb250TWFwOwpjb25zdCBnZXRTZXJpZkZvbnRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WyJBZG9iZSBKZW5zb24iXSA9IHRydWU7CiAgdFsiQWRvYmUgVGV4dCJdID0gdHJ1ZTsKICB0LkFsYmVydHVzID0gdHJ1ZTsKICB0LkFsZHVzID0gdHJ1ZTsKICB0LkFsZXhhbmRyaWEgPSB0cnVlOwogIHQuQWxnZXJpYW4gPSB0cnVlOwogIHRbIkFtZXJpY2FuIFR5cGV3cml0ZXIiXSA9IHRydWU7CiAgdC5BbnRpcXVhID0gdHJ1ZTsKICB0LkFwZXggPSB0cnVlOwogIHQuQXJubyA9IHRydWU7CiAgdC5Bc3RlciA9IHRydWU7CiAgdC5BdXJvcmEgPSB0cnVlOwogIHQuQmFza2VydmlsbGUgPSB0cnVlOwogIHQuQmVsbCA9IHRydWU7CiAgdC5CZW1ibyA9IHRydWU7CiAgdFsiQmVtYm8gU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0LkJlbmd1aWF0ID0gdHJ1ZTsKICB0WyJCZXJrZWxleSBPbGQgU3R5bGUiXSA9IHRydWU7CiAgdFsiQmVybmhhcmQgTW9kZXJuIl0gPSB0cnVlOwogIHRbIkJlcnRob2xkIENpdHkiXSA9IHRydWU7CiAgdC5Cb2RvbmkgPSB0cnVlOwogIHRbIkJhdWVyIEJvZG9uaSJdID0gdHJ1ZTsKICB0WyJCb29rIEFudGlxdWEiXSA9IHRydWU7CiAgdC5Cb29rbWFuID0gdHJ1ZTsKICB0WyJCb3JkZWF1eCBSb21hbiJdID0gdHJ1ZTsKICB0WyJDYWxpZm9ybmlhbiBGQiJdID0gdHJ1ZTsKICB0LkNhbGlzdG8gPSB0cnVlOwogIHQuQ2FsdmVydCA9IHRydWU7CiAgdC5DYXBpdGFscyA9IHRydWU7CiAgdC5DYW1icmlhID0gdHJ1ZTsKICB0LkNhcnRpZXIgPSB0cnVlOwogIHQuQ2FzbG9uID0gdHJ1ZTsKICB0LkNhdHVsbCA9IHRydWU7CiAgdC5DZW50YXVyID0gdHJ1ZTsKICB0WyJDZW50dXJ5IE9sZCBTdHlsZSJdID0gdHJ1ZTsKICB0WyJDZW50dXJ5IFNjaG9vbGJvb2siXSA9IHRydWU7CiAgdC5DaGFwYXJyYWwgPSB0cnVlOwogIHRbIkNoYXJpcyBTSUwiXSA9IHRydWU7CiAgdC5DaGVsdGVuaGFtID0gdHJ1ZTsKICB0WyJDaG9sbGEgU2xhYiJdID0gdHJ1ZTsKICB0LkNsYXJlbmRvbiA9IHRydWU7CiAgdC5DbGVhcmZhY2UgPSB0cnVlOwogIHQuQ29jaGluID0gdHJ1ZTsKICB0LkNvbG9ubmEgPSB0cnVlOwogIHRbIkNvbXB1dGVyIE1vZGVybiJdID0gdHJ1ZTsKICB0WyJDb25jcmV0ZSBSb21hbiJdID0gdHJ1ZTsKICB0LkNvbnN0YW50aWEgPSB0cnVlOwogIHRbIkNvb3BlciBCbGFjayJdID0gdHJ1ZTsKICB0LkNvcm9uYSA9IHRydWU7CiAgdC5FY290eXBlID0gdHJ1ZTsKICB0LkVneXB0aWVubmUgPSB0cnVlOwogIHQuRWxlcGhhbnQgPSB0cnVlOwogIHQuRXhjZWxzaW9yID0gdHJ1ZTsKICB0LkZhaXJmaWVsZCA9IHRydWU7CiAgdFsiRkYgU2NhbGEiXSA9IHRydWU7CiAgdC5Gb2xrYXJkID0gdHJ1ZTsKICB0LkZvb3RsaWdodCA9IHRydWU7CiAgdC5GcmVlU2VyaWYgPSB0cnVlOwogIHRbIkZyaXogUXVhZHJhdGEiXSA9IHRydWU7CiAgdC5HYXJhbW9uZCA9IHRydWU7CiAgdC5HZW50aXVtID0gdHJ1ZTsKICB0Lkdlb3JnaWEgPSB0cnVlOwogIHQuR2xvdWNlc3RlciA9IHRydWU7CiAgdFsiR291ZHkgT2xkIFN0eWxlIl0gPSB0cnVlOwogIHRbIkdvdWR5IFNjaG9vbGJvb2siXSA9IHRydWU7CiAgdFsiR291ZHkgUHJvIEZvbnQiXSA9IHRydWU7CiAgdC5HcmFuam9uID0gdHJ1ZTsKICB0WyJHdWFyZGlhbiBFZ3lwdGlhbiJdID0gdHJ1ZTsKICB0LkhlYXRoZXIgPSB0cnVlOwogIHQuSGVyY3VsZXMgPSB0cnVlOwogIHRbIkhpZ2ggVG93ZXIgVGV4dCJdID0gdHJ1ZTsKICB0Lkhpcm9zaGlnZSA9IHRydWU7CiAgdFsiSG9lZmxlciBUZXh0Il0gPSB0cnVlOwogIHRbIkh1bWFuYSBTZXJpZiJdID0gdHJ1ZTsKICB0LkltcHJpbnQgPSB0cnVlOwogIHRbIklvbmljIE5vLiA1Il0gPSB0cnVlOwogIHQuSmFuc29uID0gdHJ1ZTsKICB0LkpvYW5uYSA9IHRydWU7CiAgdC5Lb3Jpbm5hID0gdHJ1ZTsKICB0LkxleGljb24gPSB0cnVlOwogIHQuTGliZXJhdGlvblNlcmlmID0gdHJ1ZTsKICB0WyJMaWJlcmF0aW9uIFNlcmlmIl0gPSB0cnVlOwogIHRbIkxpbnV4IExpYmVydGluZSJdID0gdHJ1ZTsKICB0LkxpdGVyYXR1cm5heWEgPSB0cnVlOwogIHQuTHVjaWRhID0gdHJ1ZTsKICB0WyJMdWNpZGEgQnJpZ2h0Il0gPSB0cnVlOwogIHQuTWVsaW9yID0gdHJ1ZTsKICB0Lk1lbXBoaXMgPSB0cnVlOwogIHQuTWlsbGVyID0gdHJ1ZTsKICB0Lk1pbmlvbiA9IHRydWU7CiAgdC5Nb2Rlcm4gPSB0cnVlOwogIHRbIk1vbmEgTGlzYSJdID0gdHJ1ZTsKICB0WyJNcnMgRWF2ZXMiXSA9IHRydWU7CiAgdFsiTVMgU2VyaWYiXSA9IHRydWU7CiAgdFsiTXVzZW8gU2xhYiJdID0gdHJ1ZTsKICB0WyJOZXcgWW9yayJdID0gdHJ1ZTsKICB0WyJOaW1idXMgUm9tYW4iXSA9IHRydWU7CiAgdFsiTlBTIFJhd2xpbnNvbiBSb2Fkd2F5Il0gPSB0cnVlOwogIHQuTnVwdGlhbFNjcmlwdCA9IHRydWU7CiAgdC5QYWxhdGlubyA9IHRydWU7CiAgdC5QZXJwZXR1YSA9IHRydWU7CiAgdC5QbGFudGluID0gdHJ1ZTsKICB0WyJQbGFudGluIFNjaG9vbGJvb2siXSA9IHRydWU7CiAgdC5QbGF5YmlsbCA9IHRydWU7CiAgdFsiUG9vciBSaWNoYXJkIl0gPSB0cnVlOwogIHRbIlJhd2xpbnNvbiBSb2Fkd2F5Il0gPSB0cnVlOwogIHQuUmVuYXVsdCA9IHRydWU7CiAgdC5SZXF1aWVtID0gdHJ1ZTsKICB0LlJvY2t3ZWxsID0gdHJ1ZTsKICB0LlJvbWFuID0gdHJ1ZTsKICB0WyJSb3RpcyBTZXJpZiJdID0gdHJ1ZTsKICB0LlNhYm9uID0gdHJ1ZTsKICB0LlNjYWxhID0gdHJ1ZTsKICB0LlNlYWd1bGwgPSB0cnVlOwogIHQuU2lzdGluYSA9IHRydWU7CiAgdC5Tb3V2ZW5pciA9IHRydWU7CiAgdC5TVElYID0gdHJ1ZTsKICB0WyJTdG9uZSBJbmZvcm1hbCJdID0gdHJ1ZTsKICB0WyJTdG9uZSBTZXJpZiJdID0gdHJ1ZTsKICB0LlN5bGZhZW4gPSB0cnVlOwogIHQuVGltZXMgPSB0cnVlOwogIHQuVHJhamFuID0gdHJ1ZTsKICB0WyJUcmluaXTDqSJdID0gdHJ1ZTsKICB0WyJUcnVtcCBNZWRpYWV2YWwiXSA9IHRydWU7CiAgdC5VdG9waWEgPSB0cnVlOwogIHRbIlZhbGUgVHlwZSJdID0gdHJ1ZTsKICB0WyJCaXRzdHJlYW0gVmVyYSJdID0gdHJ1ZTsKICB0WyJWZXJhIFNlcmlmIl0gPSB0cnVlOwogIHQuVmVyc2FpbGxlcyA9IHRydWU7CiAgdC5XYW50ZWQgPSB0cnVlOwogIHQuV2Vpc3MgPSB0cnVlOwogIHRbIldpZGUgTGF0aW4iXSA9IHRydWU7CiAgdC5XaW5kc29yID0gdHJ1ZTsKICB0LlhJVFMgPSB0cnVlOwp9KTsKZXhwb3J0cy5nZXRTZXJpZkZvbnRzID0gZ2V0U2VyaWZGb250czsKY29uc3QgZ2V0U3ltYm9sc0ZvbnRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkRpbmdiYXRzID0gdHJ1ZTsKICB0LlN5bWJvbCA9IHRydWU7CiAgdC5aYXBmRGluZ2JhdHMgPSB0cnVlOwp9KTsKZXhwb3J0cy5nZXRTeW1ib2xzRm9udHMgPSBnZXRTeW1ib2xzRm9udHM7CmNvbnN0IGdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cyA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdFsyXSA9IDEwOwogIHRbM10gPSAzMjsKICB0WzRdID0gMzM7CiAgdFs1XSA9IDM0OwogIHRbNl0gPSAzNTsKICB0WzddID0gMzY7CiAgdFs4XSA9IDM3OwogIHRbOV0gPSAzODsKICB0WzEwXSA9IDM5OwogIHRbMTFdID0gNDA7CiAgdFsxMl0gPSA0MTsKICB0WzEzXSA9IDQyOwogIHRbMTRdID0gNDM7CiAgdFsxNV0gPSA0NDsKICB0WzE2XSA9IDQ1OwogIHRbMTddID0gNDY7CiAgdFsxOF0gPSA0NzsKICB0WzE5XSA9IDQ4OwogIHRbMjBdID0gNDk7CiAgdFsyMV0gPSA1MDsKICB0WzIyXSA9IDUxOwogIHRbMjNdID0gNTI7CiAgdFsyNF0gPSA1MzsKICB0WzI1XSA9IDU0OwogIHRbMjZdID0gNTU7CiAgdFsyN10gPSA1NjsKICB0WzI4XSA9IDU3OwogIHRbMjldID0gNTg7CiAgdFszMF0gPSA4OTQ7CiAgdFszMV0gPSA2MDsKICB0WzMyXSA9IDYxOwogIHRbMzNdID0gNjI7CiAgdFszNF0gPSA2MzsKICB0WzM1XSA9IDY0OwogIHRbMzZdID0gNjU7CiAgdFszN10gPSA2NjsKICB0WzM4XSA9IDY3OwogIHRbMzldID0gNjg7CiAgdFs0MF0gPSA2OTsKICB0WzQxXSA9IDcwOwogIHRbNDJdID0gNzE7CiAgdFs0M10gPSA3MjsKICB0WzQ0XSA9IDczOwogIHRbNDVdID0gNzQ7CiAgdFs0Nl0gPSA3NTsKICB0WzQ3XSA9IDc2OwogIHRbNDhdID0gNzc7CiAgdFs0OV0gPSA3ODsKICB0WzUwXSA9IDc5OwogIHRbNTFdID0gODA7CiAgdFs1Ml0gPSA4MTsKICB0WzUzXSA9IDgyOwogIHRbNTRdID0gODM7CiAgdFs1NV0gPSA4NDsKICB0WzU2XSA9IDg1OwogIHRbNTddID0gODY7CiAgdFs1OF0gPSA4NzsKICB0WzU5XSA9IDg4OwogIHRbNjBdID0gODk7CiAgdFs2MV0gPSA5MDsKICB0WzYyXSA9IDkxOwogIHRbNjNdID0gOTI7CiAgdFs2NF0gPSA5MzsKICB0WzY1XSA9IDk0OwogIHRbNjZdID0gOTU7CiAgdFs2N10gPSA5NjsKICB0WzY4XSA9IDk3OwogIHRbNjldID0gOTg7CiAgdFs3MF0gPSA5OTsKICB0WzcxXSA9IDEwMDsKICB0WzcyXSA9IDEwMTsKICB0WzczXSA9IDEwMjsKICB0Wzc0XSA9IDEwMzsKICB0Wzc1XSA9IDEwNDsKICB0Wzc2XSA9IDEwNTsKICB0Wzc3XSA9IDEwNjsKICB0Wzc4XSA9IDEwNzsKICB0Wzc5XSA9IDEwODsKICB0WzgwXSA9IDEwOTsKICB0WzgxXSA9IDExMDsKICB0WzgyXSA9IDExMTsKICB0WzgzXSA9IDExMjsKICB0Wzg0XSA9IDExMzsKICB0Wzg1XSA9IDExNDsKICB0Wzg2XSA9IDExNTsKICB0Wzg3XSA9IDExNjsKICB0Wzg4XSA9IDExNzsKICB0Wzg5XSA9IDExODsKICB0WzkwXSA9IDExOTsKICB0WzkxXSA9IDEyMDsKICB0WzkyXSA9IDEyMTsKICB0WzkzXSA9IDEyMjsKICB0Wzk0XSA9IDEyMzsKICB0Wzk1XSA9IDEyNDsKICB0Wzk2XSA9IDEyNTsKICB0Wzk3XSA9IDEyNjsKICB0Wzk4XSA9IDE5NjsKICB0Wzk5XSA9IDE5NzsKICB0WzEwMF0gPSAxOTk7CiAgdFsxMDFdID0gMjAxOwogIHRbMTAyXSA9IDIwOTsKICB0WzEwM10gPSAyMTQ7CiAgdFsxMDRdID0gMjIwOwogIHRbMTA1XSA9IDIyNTsKICB0WzEwNl0gPSAyMjQ7CiAgdFsxMDddID0gMjI2OwogIHRbMTA4XSA9IDIyODsKICB0WzEwOV0gPSAyMjc7CiAgdFsxMTBdID0gMjI5OwogIHRbMTExXSA9IDIzMTsKICB0WzExMl0gPSAyMzM7CiAgdFsxMTNdID0gMjMyOwogIHRbMTE0XSA9IDIzNDsKICB0WzExNV0gPSAyMzU7CiAgdFsxMTZdID0gMjM3OwogIHRbMTE3XSA9IDIzNjsKICB0WzExOF0gPSAyMzg7CiAgdFsxMTldID0gMjM5OwogIHRbMTIwXSA9IDI0MTsKICB0WzEyMV0gPSAyNDM7CiAgdFsxMjJdID0gMjQyOwogIHRbMTIzXSA9IDI0NDsKICB0WzEyNF0gPSAyNDY7CiAgdFsxMjVdID0gMjQ1OwogIHRbMTI2XSA9IDI1MDsKICB0WzEyN10gPSAyNDk7CiAgdFsxMjhdID0gMjUxOwogIHRbMTI5XSA9IDI1MjsKICB0WzEzMF0gPSA4MjI0OwogIHRbMTMxXSA9IDE3NjsKICB0WzEzMl0gPSAxNjI7CiAgdFsxMzNdID0gMTYzOwogIHRbMTM0XSA9IDE2NzsKICB0WzEzNV0gPSA4MjI2OwogIHRbMTM2XSA9IDE4MjsKICB0WzEzN10gPSAyMjM7CiAgdFsxMzhdID0gMTc0OwogIHRbMTM5XSA9IDE2OTsKICB0WzE0MF0gPSA4NDgyOwogIHRbMTQxXSA9IDE4MDsKICB0WzE0Ml0gPSAxNjg7CiAgdFsxNDNdID0gODgwMDsKICB0WzE0NF0gPSAxOTg7CiAgdFsxNDVdID0gMjE2OwogIHRbMTQ2XSA9IDg3MzQ7CiAgdFsxNDddID0gMTc3OwogIHRbMTQ4XSA9IDg4MDQ7CiAgdFsxNDldID0gODgwNTsKICB0WzE1MF0gPSAxNjU7CiAgdFsxNTFdID0gMTgxOwogIHRbMTUyXSA9IDg3MDY7CiAgdFsxNTNdID0gODcyMTsKICB0WzE1NF0gPSA4NzE5OwogIHRbMTU2XSA9IDg3NDc7CiAgdFsxNTddID0gMTcwOwogIHRbMTU4XSA9IDE4NjsKICB0WzE1OV0gPSA4NDg2OwogIHRbMTYwXSA9IDIzMDsKICB0WzE2MV0gPSAyNDg7CiAgdFsxNjJdID0gMTkxOwogIHRbMTYzXSA9IDE2MTsKICB0WzE2NF0gPSAxNzI7CiAgdFsxNjVdID0gODczMDsKICB0WzE2Nl0gPSA0MDI7CiAgdFsxNjddID0gODc3NjsKICB0WzE2OF0gPSA4NzEwOwogIHRbMTY5XSA9IDE3MTsKICB0WzE3MF0gPSAxODc7CiAgdFsxNzFdID0gODIzMDsKICB0WzIwMF0gPSAxOTM7CiAgdFsyMDNdID0gMjA1OwogIHRbMjEwXSA9IDIxODsKICB0WzIyM10gPSA3MTE7CiAgdFsyMjRdID0gMzIxOwogIHRbMjI1XSA9IDMyMjsKICB0WzIyNl0gPSAzNTI7CiAgdFsyMjddID0gMzUzOwogIHRbMjI4XSA9IDM4MTsKICB0WzIyOV0gPSAzODI7CiAgdFsyMzNdID0gMjIxOwogIHRbMjM0XSA9IDI1MzsKICB0WzI1Ml0gPSAyNjM7CiAgdFsyNTNdID0gMjY4OwogIHRbMjU0XSA9IDI2OTsKICB0WzI1OF0gPSAyNTg7CiAgdFsyNjBdID0gMjYwOwogIHRbMjYxXSA9IDI2MTsKICB0WzI2NV0gPSAyODA7CiAgdFsyNjZdID0gMjgxOwogIHRbMjY3XSA9IDI4MjsKICB0WzI2OF0gPSAyODM7CiAgdFsyNjldID0gMzEzOwogIHRbMjc1XSA9IDMyMzsKICB0WzI3Nl0gPSAzMjQ7CiAgdFsyNzhdID0gMzI4OwogIHRbMjgzXSA9IDM0NDsKICB0WzI4NF0gPSAzNDU7CiAgdFsyODVdID0gMzQ2OwogIHRbMjg2XSA9IDM0NzsKICB0WzI5Ml0gPSAzNjc7CiAgdFsyOTVdID0gMzc3OwogIHRbMjk2XSA9IDM3ODsKICB0WzI5OF0gPSAzODA7CiAgdFszMDVdID0gOTYzOwogIHRbMzA2XSA9IDk2NDsKICB0WzMwN10gPSA5NjY7CiAgdFszMDhdID0gODIxNTsKICB0WzMwOV0gPSA4MjUyOwogIHRbMzEwXSA9IDgzMTk7CiAgdFszMTFdID0gODM1OTsKICB0WzMxMl0gPSA4NTkyOwogIHRbMzEzXSA9IDg1OTM7CiAgdFszMzddID0gOTU1MjsKICB0WzQ5M10gPSAxMDM5OwogIHRbNDk0XSA9IDEwNDA7CiAgdFs2NzJdID0gMTQ4ODsKICB0WzY3M10gPSAxNDg5OwogIHRbNjc0XSA9IDE0OTA7CiAgdFs2NzVdID0gMTQ5MTsKICB0WzY3Nl0gPSAxNDkyOwogIHRbNjc3XSA9IDE0OTM7CiAgdFs2NzhdID0gMTQ5NDsKICB0WzY3OV0gPSAxNDk1OwogIHRbNjgwXSA9IDE0OTY7CiAgdFs2ODFdID0gMTQ5NzsKICB0WzY4Ml0gPSAxNDk4OwogIHRbNjgzXSA9IDE0OTk7CiAgdFs2ODRdID0gMTUwMDsKICB0WzY4NV0gPSAxNTAxOwogIHRbNjg2XSA9IDE1MDI7CiAgdFs2ODddID0gMTUwMzsKICB0WzY4OF0gPSAxNTA0OwogIHRbNjg5XSA9IDE1MDU7CiAgdFs2OTBdID0gMTUwNjsKICB0WzY5MV0gPSAxNTA3OwogIHRbNjkyXSA9IDE1MDg7CiAgdFs2OTNdID0gMTUwOTsKICB0WzY5NF0gPSAxNTEwOwogIHRbNjk1XSA9IDE1MTE7CiAgdFs2OTZdID0gMTUxMjsKICB0WzY5N10gPSAxNTEzOwogIHRbNjk4XSA9IDE1MTQ7CiAgdFs3MDVdID0gMTUyNDsKICB0WzcwNl0gPSA4MzYyOwogIHRbNzEwXSA9IDY0Mjg4OwogIHRbNzExXSA9IDY0Mjk4OwogIHRbNzU5XSA9IDE2MTc7CiAgdFs3NjFdID0gMTc3NjsKICB0Wzc2M10gPSAxNzc4OwogIHRbNzc1XSA9IDE2NTI7CiAgdFs3NzddID0gMTc2NDsKICB0Wzc3OF0gPSAxNzgwOwogIHRbNzc5XSA9IDE3ODE7CiAgdFs3ODBdID0gMTc4MjsKICB0Wzc4Ml0gPSA3NzE7CiAgdFs3ODNdID0gNjQ3MjY7CiAgdFs3ODZdID0gODM2MzsKICB0Wzc4OF0gPSA4NTMyOwogIHRbNzkwXSA9IDc2ODsKICB0Wzc5MV0gPSA3Njk7CiAgdFs3OTJdID0gNzY4OwogIHRbNzk1XSA9IDgwMzsKICB0Wzc5N10gPSA2NDMzNjsKICB0Wzc5OF0gPSA2NDMzNzsKICB0Wzc5OV0gPSA2NDM0MjsKICB0WzgwMF0gPSA2NDM0MzsKICB0WzgwMV0gPSA2NDM0NDsKICB0WzgwMl0gPSA2NDM0NTsKICB0WzgwM10gPSA2NDM2MjsKICB0WzgwNF0gPSA2NDM2MzsKICB0WzgwNV0gPSA2NDM2NDsKICB0WzI0MjRdID0gNzgyMTsKICB0WzI0MjVdID0gNzgyMjsKICB0WzI0MjZdID0gNzgyMzsKICB0WzI0MjddID0gNzgyNDsKICB0WzI0MjhdID0gNzgyNTsKICB0WzI0MjldID0gNzgyNjsKICB0WzI0MzBdID0gNzgyNzsKICB0WzI0MzNdID0gNzY4MjsKICB0WzI2NzhdID0gODA0NTsKICB0WzI2NzldID0gODA0NjsKICB0WzI4MzBdID0gMTU1MjsKICB0WzI4MzhdID0gNjg2OwogIHRbMjg0MF0gPSA3NTE7CiAgdFsyODQyXSA9IDc1MzsKICB0WzI4NDNdID0gNzU0OwogIHRbMjg0NF0gPSA3NTU7CiAgdFsyODQ2XSA9IDc1NzsKICB0WzI4NTZdID0gNzY3OwogIHRbMjg1N10gPSA4NDg7CiAgdFsyODU4XSA9IDg0OTsKICB0WzI4NjJdID0gODUzOwogIHRbMjg2M10gPSA4NTQ7CiAgdFsyODY0XSA9IDg1NTsKICB0WzI4NjVdID0gODYxOwogIHRbMjg2Nl0gPSA4NjI7CiAgdFsyOTA2XSA9IDc0NjA7CiAgdFsyOTA4XSA9IDc0NjI7CiAgdFsyOTA5XSA9IDc0NjM7CiAgdFsyOTEwXSA9IDc0NjQ7CiAgdFsyOTEyXSA9IDc0NjY7CiAgdFsyOTEzXSA9IDc0Njc7CiAgdFsyOTE0XSA9IDc0Njg7CiAgdFsyOTE2XSA9IDc0NzA7CiAgdFsyOTE3XSA9IDc0NzE7CiAgdFsyOTE4XSA9IDc0NzI7CiAgdFsyOTIwXSA9IDc0NzQ7CiAgdFsyOTIxXSA9IDc0NzU7CiAgdFsyOTIyXSA9IDc0NzY7CiAgdFsyOTI0XSA9IDc0Nzg7CiAgdFsyOTI1XSA9IDc0Nzk7CiAgdFsyOTI2XSA9IDc0ODA7CiAgdFsyOTI4XSA9IDc0ODI7CiAgdFsyOTI5XSA9IDc0ODM7CiAgdFsyOTMwXSA9IDc0ODQ7CiAgdFsyOTMyXSA9IDc0ODY7CiAgdFsyOTMzXSA9IDc0ODc7CiAgdFsyOTM0XSA9IDc0ODg7CiAgdFsyOTM2XSA9IDc0OTA7CiAgdFsyOTM3XSA9IDc0OTE7CiAgdFsyOTM4XSA9IDc0OTI7CiAgdFsyOTQwXSA9IDc0OTQ7CiAgdFsyOTQxXSA9IDc0OTU7CiAgdFsyOTQyXSA9IDc0OTY7CiAgdFsyOTQ0XSA9IDc0OTg7CiAgdFsyOTQ2XSA9IDc1MDA7CiAgdFsyOTQ4XSA9IDc1MDI7CiAgdFsyOTUwXSA9IDc1MDQ7CiAgdFsyOTUxXSA9IDc1MDU7CiAgdFsyOTUyXSA9IDc1MDY7CiAgdFsyOTU0XSA9IDc1MDg7CiAgdFsyOTU1XSA9IDc1MDk7CiAgdFsyOTU2XSA9IDc1MTA7CiAgdFsyOTU4XSA9IDc1MTI7CiAgdFsyOTU5XSA9IDc1MTM7CiAgdFsyOTYwXSA9IDc1MTQ7CiAgdFsyOTYyXSA9IDc1MTY7CiAgdFsyOTYzXSA9IDc1MTc7CiAgdFsyOTY0XSA9IDc1MTg7CiAgdFsyOTY2XSA9IDc1MjA7CiAgdFsyOTY3XSA9IDc1MjE7CiAgdFsyOTY4XSA9IDc1MjI7CiAgdFsyOTcwXSA9IDc1MjQ7CiAgdFsyOTcxXSA9IDc1MjU7CiAgdFsyOTcyXSA9IDc1MjY7CiAgdFsyOTc0XSA9IDc1Mjg7CiAgdFsyOTc1XSA9IDc1Mjk7CiAgdFsyOTc2XSA9IDc1MzA7CiAgdFsyOTc4XSA9IDE1Mzc7CiAgdFsyOTc5XSA9IDE1Mzg7CiAgdFsyOTgwXSA9IDE1Mzk7CiAgdFsyOTgyXSA9IDE1NDk7CiAgdFsyOTgzXSA9IDE1NTE7CiAgdFsyOTg0XSA9IDE1NTI7CiAgdFsyOTg2XSA9IDE1NTQ7CiAgdFsyOTg3XSA9IDE1NTU7CiAgdFsyOTg4XSA9IDE1NTY7CiAgdFsyOTkwXSA9IDE2MjM7CiAgdFsyOTkxXSA9IDE2MjQ7CiAgdFsyOTk1XSA9IDE3NzU7CiAgdFsyOTk5XSA9IDE3OTE7CiAgdFszMDAyXSA9IDY0MjkwOwogIHRbMzAwM10gPSA2NDI5MTsKICB0WzMwMDRdID0gNjQyOTI7CiAgdFszMDA2XSA9IDY0Mjk0OwogIHRbMzAwN10gPSA2NDI5NTsKICB0WzMwMDhdID0gNjQyOTY7CiAgdFszMDExXSA9IDE5MDA7CiAgdFszMDE0XSA9IDgyMjM7CiAgdFszMDE1XSA9IDgyNDQ7CiAgdFszMDE3XSA9IDc1MzI7CiAgdFszMDE4XSA9IDc1MzM7CiAgdFszMDE5XSA9IDc1MzQ7CiAgdFszMDc1XSA9IDc1OTA7CiAgdFszMDc2XSA9IDc1OTE7CiAgdFszMDc5XSA9IDc1OTQ7CiAgdFszMDgwXSA9IDc1OTU7CiAgdFszMDgzXSA9IDc1OTg7CiAgdFszMDg0XSA9IDc1OTk7CiAgdFszMDg3XSA9IDc2MDI7CiAgdFszMDg4XSA9IDc2MDM7CiAgdFszMDkxXSA9IDc2MDY7CiAgdFszMDkyXSA9IDc2MDc7CiAgdFszMDk1XSA9IDc2MTA7CiAgdFszMDk2XSA9IDc2MTE7CiAgdFszMDk5XSA9IDc2MTQ7CiAgdFszMTAwXSA9IDc2MTU7CiAgdFszMTAzXSA9IDc2MTg7CiAgdFszMTA0XSA9IDc2MTk7CiAgdFszMTA3XSA9IDgzMzc7CiAgdFszMTA4XSA9IDgzMzg7CiAgdFszMTE2XSA9IDE4ODQ7CiAgdFszMTE5XSA9IDE4ODU7CiAgdFszMTIwXSA9IDE4ODU7CiAgdFszMTIzXSA9IDE4ODY7CiAgdFszMTI0XSA9IDE4ODY7CiAgdFszMTI3XSA9IDE4ODc7CiAgdFszMTI4XSA9IDE4ODc7CiAgdFszMTMxXSA9IDE4ODg7CiAgdFszMTMyXSA9IDE4ODg7CiAgdFszMTM1XSA9IDE4ODk7CiAgdFszMTM2XSA9IDE4ODk7CiAgdFszMTM5XSA9IDE4OTA7CiAgdFszMTQwXSA9IDE4OTA7CiAgdFszMTQzXSA9IDE4OTE7CiAgdFszMTQ0XSA9IDE4OTE7CiAgdFszMTQ3XSA9IDE4OTI7CiAgdFszMTQ4XSA9IDE4OTI7CiAgdFszMTUzXSA9IDU4MDsKICB0WzMxNTRdID0gNTgxOwogIHRbMzE1N10gPSA1ODQ7CiAgdFszMTU4XSA9IDU4NTsKICB0WzMxNjFdID0gNTg4OwogIHRbMzE2Ml0gPSA1ODk7CiAgdFszMTY1XSA9IDg5MTsKICB0WzMxNjZdID0gODkyOwogIHRbMzE2OV0gPSAxMjc0OwogIHRbMzE3MF0gPSAxMjc1OwogIHRbMzE3M10gPSAxMjc4OwogIHRbMzE3NF0gPSAxMjc5OwogIHRbMzE4MV0gPSA3NjIyOwogIHRbMzE4Ml0gPSA3NjIzOwogIHRbMzI4Ml0gPSAxMTc5OTsKICB0WzMzMTZdID0gNTc4OwogIHRbMzM3OV0gPSA0Mjc4NTsKICB0WzMzOTNdID0gMTE1OTsKICB0WzM0MTZdID0gODM3NzsKfSk7CmV4cG9ydHMuZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzID0gZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzOwpjb25zdCBnZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2sgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHRbMjI3XSA9IDMyMjsKICB0WzI2NF0gPSAyNjE7CiAgdFsyOTFdID0gMzQ2Owp9KTsKZXhwb3J0cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2sgPSBnZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2s7CmNvbnN0IGdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdFsxXSA9IDMyOwogIHRbNF0gPSA2NTsKICB0WzZdID0gMTkzOwogIHRbMTddID0gNjY7CiAgdFsxOF0gPSA2NzsKICB0WzIxXSA9IDI2ODsKICB0WzI0XSA9IDY4OwogIHRbMjhdID0gNjk7CiAgdFszMF0gPSAyMDE7CiAgdFszMl0gPSAyODI7CiAgdFszOF0gPSA3MDsKICB0WzM5XSA9IDcxOwogIHRbNDRdID0gNzI7CiAgdFs0N10gPSA3MzsKICB0WzQ5XSA9IDIwNTsKICB0WzU4XSA9IDc0OwogIHRbNjBdID0gNzU7CiAgdFs2Ml0gPSA3NjsKICB0WzY4XSA9IDc3OwogIHRbNjldID0gNzg7CiAgdFs3NV0gPSA3OTsKICB0Wzg3XSA9IDgwOwogIHRbODldID0gODE7CiAgdFs5MF0gPSA4MjsKICB0WzkyXSA9IDM0NDsKICB0Wzk0XSA9IDgzOwogIHRbOTddID0gMzUyOwogIHRbMTAwXSA9IDg0OwogIHRbMTA0XSA9IDg1OwogIHRbMTE1XSA9IDg2OwogIHRbMTE2XSA9IDg3OwogIHRbMTIxXSA9IDg4OwogIHRbMTIyXSA9IDg5OwogIHRbMTI0XSA9IDIyMTsKICB0WzEyN10gPSA5MDsKICB0WzEyOV0gPSAzODE7CiAgdFsyNThdID0gOTc7CiAgdFsyNjBdID0gMjI1OwogIHRbMjY4XSA9IDI2MTsKICB0WzI3MV0gPSA5ODsKICB0WzI3Ml0gPSA5OTsKICB0WzI3M10gPSAyNjM7CiAgdFsyNzVdID0gMjY5OwogIHRbMjgyXSA9IDEwMDsKICB0WzI4Nl0gPSAxMDE7CiAgdFsyODhdID0gMjMzOwogIHRbMjkwXSA9IDI4MzsKICB0WzI5NV0gPSAyODE7CiAgdFsyOTZdID0gMTAyOwogIHRbMzM2XSA9IDEwMzsKICB0WzM0Nl0gPSAxMDQ7CiAgdFszNDldID0gMTA1OwogIHRbMzUxXSA9IDIzNzsKICB0WzM2MV0gPSAxMDY7CiAgdFszNjRdID0gMTA3OwogIHRbMzY3XSA9IDEwODsKICB0WzM3MV0gPSAzMjI7CiAgdFszNzNdID0gMTA5OwogIHRbMzc0XSA9IDExMDsKICB0WzM4MV0gPSAxMTE7CiAgdFszODNdID0gMjQzOwogIHRbMzkzXSA9IDExMjsKICB0WzM5NV0gPSAxMTM7CiAgdFszOTZdID0gMTE0OwogIHRbMzk4XSA9IDM0NTsKICB0WzQwMF0gPSAxMTU7CiAgdFs0MDFdID0gMzQ3OwogIHRbNDAzXSA9IDM1MzsKICB0WzQxMF0gPSAxMTY7CiAgdFs0MzddID0gMTE3OwogIHRbNDQ4XSA9IDExODsKICB0WzQ0OV0gPSAxMTk7CiAgdFs0NTRdID0gMTIwOwogIHRbNDU1XSA9IDEyMTsKICB0WzQ1N10gPSAyNTM7CiAgdFs0NjBdID0gMTIyOwogIHRbNDYyXSA9IDM4MjsKICB0WzQ2M10gPSAzODA7CiAgdFs4NTNdID0gNDQ7CiAgdFs4NTVdID0gNTg7CiAgdFs4NTZdID0gNDY7CiAgdFs4NzZdID0gNDc7CiAgdFs4NzhdID0gNDU7CiAgdFs4ODJdID0gNDU7CiAgdFs4OTRdID0gNDA7CiAgdFs4OTVdID0gNDE7CiAgdFs4OTZdID0gOTE7CiAgdFs4OTddID0gOTM7CiAgdFs5MjNdID0gNjQ7CiAgdFsxMDA0XSA9IDQ4OwogIHRbMTAwNV0gPSA0OTsKICB0WzEwMDZdID0gNTA7CiAgdFsxMDA3XSA9IDUxOwogIHRbMTAwOF0gPSA1MjsKICB0WzEwMDldID0gNTM7CiAgdFsxMDEwXSA9IDU0OwogIHRbMTAxMV0gPSA1NTsKICB0WzEwMTJdID0gNTY7CiAgdFsxMDEzXSA9IDU3OwogIHRbMTA4MV0gPSAzNzsKICB0WzEwODVdID0gNDM7CiAgdFsxMDg2XSA9IDQ1Owp9KTsKZXhwb3J0cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmkgPSBnZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmk7CgpmdW5jdGlvbiBnZXRTdGFuZGFyZEZvbnROYW1lKG5hbWUpIHsKICBjb25zdCBmb250TmFtZSA9ICgwLCBfZm9udHNfdXRpbHMubm9ybWFsaXplRm9udE5hbWUpKG5hbWUpOwogIGNvbnN0IHN0ZEZvbnRNYXAgPSBnZXRTdGRGb250TWFwKCk7CiAgcmV0dXJuIHN0ZEZvbnRNYXBbZm9udE5hbWVdOwp9CgovKioqLyB9KSwKLyogNDIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Ub1VuaWNvZGVNYXAgPSBleHBvcnRzLklkZW50aXR5VG9Vbmljb2RlTWFwID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIFRvVW5pY29kZU1hcCB7CiAgY29uc3RydWN0b3IoY21hcCA9IFtdKSB7CiAgICB0aGlzLl9tYXAgPSBjbWFwOwogIH0KCiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLl9tYXAubGVuZ3RoOwogIH0KCiAgZm9yRWFjaChjYWxsYmFjaykgewogICAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiB0aGlzLl9tYXApIHsKICAgICAgY2FsbGJhY2soY2hhckNvZGUsIHRoaXMuX21hcFtjaGFyQ29kZV0uY2hhckNvZGVBdCgwKSk7CiAgICB9CiAgfQoKICBoYXMoaSkgewogICAgcmV0dXJuIHRoaXMuX21hcFtpXSAhPT0gdW5kZWZpbmVkOwogIH0KCiAgZ2V0KGkpIHsKICAgIHJldHVybiB0aGlzLl9tYXBbaV07CiAgfQoKICBjaGFyQ29kZU9mKHZhbHVlKSB7CiAgICBjb25zdCBtYXAgPSB0aGlzLl9tYXA7CgogICAgaWYgKG1hcC5sZW5ndGggPD0gMHgxMDAwMCkgewogICAgICByZXR1cm4gbWFwLmluZGV4T2YodmFsdWUpOwogICAgfQoKICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gbWFwKSB7CiAgICAgIGlmIChtYXBbY2hhckNvZGVdID09PSB2YWx1ZSkgewogICAgICAgIHJldHVybiBjaGFyQ29kZSB8IDA7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gLTE7CiAgfQoKICBhbWVuZChtYXApIHsKICAgIGZvciAoY29uc3QgY2hhckNvZGUgaW4gbWFwKSB7CiAgICAgIHRoaXMuX21hcFtjaGFyQ29kZV0gPSBtYXBbY2hhckNvZGVdOwogICAgfQogIH0KCn0KCmV4cG9ydHMuVG9Vbmljb2RlTWFwID0gVG9Vbmljb2RlTWFwOwoKY2xhc3MgSWRlbnRpdHlUb1VuaWNvZGVNYXAgewogIGNvbnN0cnVjdG9yKGZpcnN0Q2hhciwgbGFzdENoYXIpIHsKICAgIHRoaXMuZmlyc3RDaGFyID0gZmlyc3RDaGFyOwogICAgdGhpcy5sYXN0Q2hhciA9IGxhc3RDaGFyOwogIH0KCiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLmxhc3RDaGFyICsgMSAtIHRoaXMuZmlyc3RDaGFyOwogIH0KCiAgZm9yRWFjaChjYWxsYmFjaykgewogICAgZm9yIChsZXQgaSA9IHRoaXMuZmlyc3RDaGFyLCBpaSA9IHRoaXMubGFzdENoYXI7IGkgPD0gaWk7IGkrKykgewogICAgICBjYWxsYmFjayhpLCBpKTsKICAgIH0KICB9CgogIGhhcyhpKSB7CiAgICByZXR1cm4gdGhpcy5maXJzdENoYXIgPD0gaSAmJiBpIDw9IHRoaXMubGFzdENoYXI7CiAgfQoKICBnZXQoaSkgewogICAgaWYgKHRoaXMuZmlyc3RDaGFyIDw9IGkgJiYgaSA8PSB0aGlzLmxhc3RDaGFyKSB7CiAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGkpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBjaGFyQ29kZU9mKHYpIHsKICAgIHJldHVybiBOdW1iZXIuaXNJbnRlZ2VyKHYpICYmIHYgPj0gdGhpcy5maXJzdENoYXIgJiYgdiA8PSB0aGlzLmxhc3RDaGFyID8gdiA6IC0xOwogIH0KCiAgYW1lbmQobWFwKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJTaG91bGQgbm90IGNhbGwgYW1lbmQoKSIpOwogIH0KCn0KCmV4cG9ydHMuSWRlbnRpdHlUb1VuaWNvZGVNYXAgPSBJZGVudGl0eVRvVW5pY29kZU1hcDsKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNGRkZvbnQgPSB2b2lkIDA7Cgp2YXIgX2NmZl9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM1KTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBDRkZGb250IHsKICBjb25zdHJ1Y3RvcihmaWxlLCBwcm9wZXJ0aWVzKSB7CiAgICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzOwogICAgY29uc3QgcGFyc2VyID0gbmV3IF9jZmZfcGFyc2VyLkNGRlBhcnNlcihmaWxlLCBwcm9wZXJ0aWVzLCBfZm9udHNfdXRpbHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgIHRoaXMuY2ZmID0gcGFyc2VyLnBhcnNlKCk7CiAgICB0aGlzLmNmZi5kdXBsaWNhdGVGaXJzdEdseXBoKCk7CiAgICBjb25zdCBjb21waWxlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZDb21waWxlcih0aGlzLmNmZik7CiAgICB0aGlzLnNlYWNzID0gdGhpcy5jZmYuc2VhY3M7CgogICAgdHJ5IHsKICAgICAgdGhpcy5kYXRhID0gY29tcGlsZXIuY29tcGlsZSgpOwogICAgfSBjYXRjaCAoZSkgewogICAgICAoMCwgX3V0aWwud2FybikoIkZhaWxlZCB0byBjb21waWxlIGZvbnQgIiArIHByb3BlcnRpZXMubG9hZGVkTmFtZSk7CiAgICAgIHRoaXMuZGF0YSA9IGZpbGU7CiAgICB9CgogICAgdGhpcy5fY3JlYXRlQnVpbHRJbkVuY29kaW5nKCk7CiAgfQoKICBnZXQgbnVtR2x5cGhzKCkgewogICAgcmV0dXJuIHRoaXMuY2ZmLmNoYXJTdHJpbmdzLmNvdW50OwogIH0KCiAgZ2V0Q2hhcnNldCgpIHsKICAgIHJldHVybiB0aGlzLmNmZi5jaGFyc2V0LmNoYXJzZXQ7CiAgfQoKICBnZXRHbHlwaE1hcHBpbmcoKSB7CiAgICBjb25zdCBjZmYgPSB0aGlzLmNmZjsKICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXM7CiAgICBjb25zdCBjaGFyc2V0cyA9IGNmZi5jaGFyc2V0LmNoYXJzZXQ7CiAgICBsZXQgY2hhckNvZGVUb0dseXBoSWQ7CiAgICBsZXQgZ2x5cGhJZDsKCiAgICBpZiAocHJvcGVydGllcy5jb21wb3NpdGUpIHsKICAgICAgY2hhckNvZGVUb0dseXBoSWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBsZXQgY2hhckNvZGU7CgogICAgICBpZiAoY2ZmLmlzQ0lERm9udCkgewogICAgICAgIGZvciAoZ2x5cGhJZCA9IDA7IGdseXBoSWQgPCBjaGFyc2V0cy5sZW5ndGg7IGdseXBoSWQrKykgewogICAgICAgICAgY29uc3QgY2lkID0gY2hhcnNldHNbZ2x5cGhJZF07CiAgICAgICAgICBjaGFyQ29kZSA9IHByb3BlcnRpZXMuY01hcC5jaGFyQ29kZU9mKGNpZCk7CiAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGdseXBoSWQgPSAwOyBnbHlwaElkIDwgY2ZmLmNoYXJTdHJpbmdzLmNvdW50OyBnbHlwaElkKyspIHsKICAgICAgICAgIGNoYXJDb2RlID0gcHJvcGVydGllcy5jTWFwLmNoYXJDb2RlT2YoZ2x5cGhJZCk7CiAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNoYXJDb2RlVG9HbHlwaElkOwogICAgfQoKICAgIGxldCBlbmNvZGluZyA9IGNmZi5lbmNvZGluZyA/IGNmZi5lbmNvZGluZy5lbmNvZGluZyA6IG51bGw7CgogICAgaWYgKHByb3BlcnRpZXMuaXNJbnRlcm5hbEZvbnQpIHsKICAgICAgZW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZzsKICAgIH0KCiAgICBjaGFyQ29kZVRvR2x5cGhJZCA9ICgwLCBfZm9udHNfdXRpbHMudHlwZTFGb250R2x5cGhNYXBwaW5nKShwcm9wZXJ0aWVzLCBlbmNvZGluZywgY2hhcnNldHMpOwogICAgcmV0dXJuIGNoYXJDb2RlVG9HbHlwaElkOwogIH0KCiAgaGFzR2x5cGhJZChpZCkgewogICAgcmV0dXJuIHRoaXMuY2ZmLmhhc0dseXBoSWQoaWQpOwogIH0KCiAgX2NyZWF0ZUJ1aWx0SW5FbmNvZGluZygpIHsKICAgIGNvbnN0IHsKICAgICAgY2hhcnNldCwKICAgICAgZW5jb2RpbmcKICAgIH0gPSB0aGlzLmNmZjsKCiAgICBpZiAoIWNoYXJzZXQgfHwgIWVuY29kaW5nKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjaGFyc2V0cyA9IGNoYXJzZXQuY2hhcnNldCwKICAgICAgICAgIGVuY29kaW5ncyA9IGVuY29kaW5nLmVuY29kaW5nOwogICAgY29uc3QgbWFwID0gW107CgogICAgZm9yIChjb25zdCBjaGFyQ29kZSBpbiBlbmNvZGluZ3MpIHsKICAgICAgY29uc3QgZ2x5cGhJZCA9IGVuY29kaW5nc1tjaGFyQ29kZV07CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY29uc3QgZ2x5cGhOYW1lID0gY2hhcnNldHNbZ2x5cGhJZF07CgogICAgICAgIGlmIChnbHlwaE5hbWUpIHsKICAgICAgICAgIG1hcFtjaGFyQ29kZV0gPSBnbHlwaE5hbWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKG1hcC5sZW5ndGggPiAwKSB7CiAgICAgIHRoaXMucHJvcGVydGllcy5idWlsdEluRW5jb2RpbmcgPSBtYXA7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5DRkZGb250ID0gQ0ZGRm9udDsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkZvbnRSZW5kZXJlckZhY3RvcnkgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jZmZfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygzNSk7Cgp2YXIgX2dseXBobGlzdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzkpOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CgpmdW5jdGlvbiBnZXRVaW50MzIoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIChkYXRhW29mZnNldF0gPDwgMjQgfCBkYXRhW29mZnNldCArIDFdIDw8IDE2IHwgZGF0YVtvZmZzZXQgKyAyXSA8PCA4IHwgZGF0YVtvZmZzZXQgKyAzXSkgPj4+IDA7Cn0KCmZ1bmN0aW9uIGdldFVpbnQxNihkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDggfCBkYXRhW29mZnNldCArIDFdOwp9CgpmdW5jdGlvbiBnZXRJbnQxNihkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gKGRhdGFbb2Zmc2V0XSA8PCAyNCB8IGRhdGFbb2Zmc2V0ICsgMV0gPDwgMTYpID4+IDE2Owp9CgpmdW5jdGlvbiBnZXRJbnQ4KGRhdGEsIG9mZnNldCkgewogIHJldHVybiBkYXRhW29mZnNldF0gPDwgMjQgPj4gMjQ7Cn0KCmZ1bmN0aW9uIGdldEZsb2F0MjE0KGRhdGEsIG9mZnNldCkgewogIHJldHVybiBnZXRJbnQxNihkYXRhLCBvZmZzZXQpIC8gMTYzODQ7Cn0KCmZ1bmN0aW9uIGdldFN1YnJvdXRpbmVCaWFzKHN1YnJzKSB7CiAgY29uc3QgbnVtU3VicnMgPSBzdWJycy5sZW5ndGg7CiAgbGV0IGJpYXMgPSAzMjc2ODsKCiAgaWYgKG51bVN1YnJzIDwgMTI0MCkgewogICAgYmlhcyA9IDEwNzsKICB9IGVsc2UgaWYgKG51bVN1YnJzIDwgMzM5MDApIHsKICAgIGJpYXMgPSAxMTMxOwogIH0KCiAgcmV0dXJuIGJpYXM7Cn0KCmZ1bmN0aW9uIHBhcnNlQ21hcChkYXRhLCBzdGFydCwgZW5kKSB7CiAgY29uc3Qgb2Zmc2V0ID0gZ2V0VWludDE2KGRhdGEsIHN0YXJ0ICsgMikgPT09IDEgPyBnZXRVaW50MzIoZGF0YSwgc3RhcnQgKyA4KSA6IGdldFVpbnQzMihkYXRhLCBzdGFydCArIDE2KTsKICBjb25zdCBmb3JtYXQgPSBnZXRVaW50MTYoZGF0YSwgc3RhcnQgKyBvZmZzZXQpOwogIGxldCByYW5nZXMsIHAsIGk7CgogIGlmIChmb3JtYXQgPT09IDQpIHsKICAgIGdldFVpbnQxNihkYXRhLCBzdGFydCArIG9mZnNldCArIDIpOwogICAgY29uc3Qgc2VnQ291bnQgPSBnZXRVaW50MTYoZGF0YSwgc3RhcnQgKyBvZmZzZXQgKyA2KSA+PiAxOwogICAgcCA9IHN0YXJ0ICsgb2Zmc2V0ICsgMTQ7CiAgICByYW5nZXMgPSBbXTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgc2VnQ291bnQ7IGkrKywgcCArPSAyKSB7CiAgICAgIHJhbmdlc1tpXSA9IHsKICAgICAgICBlbmQ6IGdldFVpbnQxNihkYXRhLCBwKQogICAgICB9OwogICAgfQoKICAgIHAgKz0gMjsKCiAgICBmb3IgKGkgPSAwOyBpIDwgc2VnQ291bnQ7IGkrKywgcCArPSAyKSB7CiAgICAgIHJhbmdlc1tpXS5zdGFydCA9IGdldFVpbnQxNihkYXRhLCBwKTsKICAgIH0KCiAgICBmb3IgKGkgPSAwOyBpIDwgc2VnQ291bnQ7IGkrKywgcCArPSAyKSB7CiAgICAgIHJhbmdlc1tpXS5pZERlbHRhID0gZ2V0VWludDE2KGRhdGEsIHApOwogICAgfQoKICAgIGZvciAoaSA9IDA7IGkgPCBzZWdDb3VudDsgaSsrLCBwICs9IDIpIHsKICAgICAgbGV0IGlkT2Zmc2V0ID0gZ2V0VWludDE2KGRhdGEsIHApOwoKICAgICAgaWYgKGlkT2Zmc2V0ID09PSAwKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHJhbmdlc1tpXS5pZHMgPSBbXTsKCiAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IHJhbmdlc1tpXS5lbmQgLSByYW5nZXNbaV0uc3RhcnQgKyAxOyBqIDwgamo7IGorKykgewogICAgICAgIHJhbmdlc1tpXS5pZHNbal0gPSBnZXRVaW50MTYoZGF0YSwgcCArIGlkT2Zmc2V0KTsKICAgICAgICBpZE9mZnNldCArPSAyOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJhbmdlczsKICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gMTIpIHsKICAgIGNvbnN0IGdyb3VwcyA9IGdldFVpbnQzMihkYXRhLCBzdGFydCArIG9mZnNldCArIDEyKTsKICAgIHAgPSBzdGFydCArIG9mZnNldCArIDE2OwogICAgcmFuZ2VzID0gW107CgogICAgZm9yIChpID0gMDsgaSA8IGdyb3VwczsgaSsrKSB7CiAgICAgIHN0YXJ0ID0gZ2V0VWludDMyKGRhdGEsIHApOwogICAgICByYW5nZXMucHVzaCh7CiAgICAgICAgc3RhcnQsCiAgICAgICAgZW5kOiBnZXRVaW50MzIoZGF0YSwgcCArIDQpLAogICAgICAgIGlkRGVsdGE6IGdldFVpbnQzMihkYXRhLCBwICsgOCkgLSBzdGFydAogICAgICB9KTsKICAgICAgcCArPSAxMjsKICAgIH0KCiAgICByZXR1cm4gcmFuZ2VzOwogIH0KCiAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGB1bnN1cHBvcnRlZCBjbWFwOiAke2Zvcm1hdH1gKTsKfQoKZnVuY3Rpb24gcGFyc2VDZmYoZGF0YSwgc3RhcnQsIGVuZCwgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKICBjb25zdCBwYXJzZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGUGFyc2VyKG5ldyBfc3RyZWFtLlN0cmVhbShkYXRhLCBzdGFydCwgZW5kIC0gc3RhcnQpLCBwcm9wZXJ0aWVzLCBzZWFjQW5hbHlzaXNFbmFibGVkKTsKICBjb25zdCBjZmYgPSBwYXJzZXIucGFyc2UoKTsKICByZXR1cm4gewogICAgZ2x5cGhzOiBjZmYuY2hhclN0cmluZ3Mub2JqZWN0cywKICAgIHN1YnJzOiBjZmYudG9wRGljdC5wcml2YXRlRGljdCAmJiBjZmYudG9wRGljdC5wcml2YXRlRGljdC5zdWJyc0luZGV4ICYmIGNmZi50b3BEaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXgub2JqZWN0cywKICAgIGdzdWJyczogY2ZmLmdsb2JhbFN1YnJJbmRleCAmJiBjZmYuZ2xvYmFsU3VickluZGV4Lm9iamVjdHMsCiAgICBpc0NGRkNJREZvbnQ6IGNmZi5pc0NJREZvbnQsCiAgICBmZFNlbGVjdDogY2ZmLmZkU2VsZWN0LAogICAgZmRBcnJheTogY2ZmLmZkQXJyYXkKICB9Owp9CgpmdW5jdGlvbiBwYXJzZUdseWZUYWJsZShnbHlmLCBsb2NhLCBpc0dseXBoTG9jYXRpb25zTG9uZykgewogIGxldCBpdGVtU2l6ZSwgaXRlbURlY29kZTsKCiAgaWYgKGlzR2x5cGhMb2NhdGlvbnNMb25nKSB7CiAgICBpdGVtU2l6ZSA9IDQ7CiAgICBpdGVtRGVjb2RlID0gZ2V0VWludDMyOwogIH0gZWxzZSB7CiAgICBpdGVtU2l6ZSA9IDI7CgogICAgaXRlbURlY29kZSA9IChkYXRhLCBvZmZzZXQpID0+IDIgKiBnZXRVaW50MTYoZGF0YSwgb2Zmc2V0KTsKICB9CgogIGNvbnN0IGdseXBocyA9IFtdOwogIGxldCBzdGFydE9mZnNldCA9IGl0ZW1EZWNvZGUobG9jYSwgMCk7CgogIGZvciAobGV0IGogPSBpdGVtU2l6ZTsgaiA8IGxvY2EubGVuZ3RoOyBqICs9IGl0ZW1TaXplKSB7CiAgICBjb25zdCBlbmRPZmZzZXQgPSBpdGVtRGVjb2RlKGxvY2EsIGopOwogICAgZ2x5cGhzLnB1c2goZ2x5Zi5zdWJhcnJheShzdGFydE9mZnNldCwgZW5kT2Zmc2V0KSk7CiAgICBzdGFydE9mZnNldCA9IGVuZE9mZnNldDsKICB9CgogIHJldHVybiBnbHlwaHM7Cn0KCmZ1bmN0aW9uIGxvb2t1cENtYXAocmFuZ2VzLCB1bmljb2RlKSB7CiAgY29uc3QgY29kZSA9IHVuaWNvZGUuY29kZVBvaW50QXQoMCk7CiAgbGV0IGdpZCA9IDAsCiAgICAgIGwgPSAwLAogICAgICByID0gcmFuZ2VzLmxlbmd0aCAtIDE7CgogIHdoaWxlIChsIDwgcikgewogICAgY29uc3QgYyA9IGwgKyByICsgMSA+PiAxOwoKICAgIGlmIChjb2RlIDwgcmFuZ2VzW2NdLnN0YXJ0KSB7CiAgICAgIHIgPSBjIC0gMTsKICAgIH0gZWxzZSB7CiAgICAgIGwgPSBjOwogICAgfQogIH0KCiAgaWYgKHJhbmdlc1tsXS5zdGFydCA8PSBjb2RlICYmIGNvZGUgPD0gcmFuZ2VzW2xdLmVuZCkgewogICAgZ2lkID0gcmFuZ2VzW2xdLmlkRGVsdGEgKyAocmFuZ2VzW2xdLmlkcyA/IHJhbmdlc1tsXS5pZHNbY29kZSAtIHJhbmdlc1tsXS5zdGFydF0gOiBjb2RlKSAmIDB4ZmZmZjsKICB9CgogIHJldHVybiB7CiAgICBjaGFyQ29kZTogY29kZSwKICAgIGdseXBoSWQ6IGdpZAogIH07Cn0KCmZ1bmN0aW9uIGNvbXBpbGVHbHlmKGNvZGUsIGNtZHMsIGZvbnQpIHsKICBmdW5jdGlvbiBtb3ZlVG8oeCwgeSkgewogICAgY21kcy5wdXNoKHsKICAgICAgY21kOiAibW92ZVRvIiwKICAgICAgYXJnczogW3gsIHldCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGxpbmVUbyh4LCB5KSB7CiAgICBjbWRzLnB1c2goewogICAgICBjbWQ6ICJsaW5lVG8iLAogICAgICBhcmdzOiBbeCwgeV0KICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gcXVhZHJhdGljQ3VydmVUbyh4YSwgeWEsIHgsIHkpIHsKICAgIGNtZHMucHVzaCh7CiAgICAgIGNtZDogInF1YWRyYXRpY0N1cnZlVG8iLAogICAgICBhcmdzOiBbeGEsIHlhLCB4LCB5XQogICAgfSk7CiAgfQoKICBsZXQgaSA9IDA7CiAgY29uc3QgbnVtYmVyT2ZDb250b3VycyA9IGdldEludDE2KGNvZGUsIGkpOwogIGxldCBmbGFnczsKICBsZXQgeCA9IDAsCiAgICAgIHkgPSAwOwogIGkgKz0gMTA7CgogIGlmIChudW1iZXJPZkNvbnRvdXJzIDwgMCkgewogICAgZG8gewogICAgICBmbGFncyA9IGdldFVpbnQxNihjb2RlLCBpKTsKICAgICAgY29uc3QgZ2x5cGhJbmRleCA9IGdldFVpbnQxNihjb2RlLCBpICsgMik7CiAgICAgIGkgKz0gNDsKICAgICAgbGV0IGFyZzEsIGFyZzI7CgogICAgICBpZiAoZmxhZ3MgJiAweDAxKSB7CiAgICAgICAgaWYgKGZsYWdzICYgMHgwMikgewogICAgICAgICAgYXJnMSA9IGdldEludDE2KGNvZGUsIGkpOwogICAgICAgICAgYXJnMiA9IGdldEludDE2KGNvZGUsIGkgKyAyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXJnMSA9IGdldFVpbnQxNihjb2RlLCBpKTsKICAgICAgICAgIGFyZzIgPSBnZXRVaW50MTYoY29kZSwgaSArIDIpOwogICAgICAgIH0KCiAgICAgICAgaSArPSA0OwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChmbGFncyAmIDB4MDIpIHsKICAgICAgICAgIGFyZzEgPSBnZXRJbnQ4KGNvZGUsIGkrKyk7CiAgICAgICAgICBhcmcyID0gZ2V0SW50OChjb2RlLCBpKyspOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhcmcxID0gY29kZVtpKytdOwogICAgICAgICAgYXJnMiA9IGNvZGVbaSsrXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChmbGFncyAmIDB4MDIpIHsKICAgICAgICB4ID0gYXJnMTsKICAgICAgICB5ID0gYXJnMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB4ID0gMDsKICAgICAgICB5ID0gMDsKICAgICAgfQoKICAgICAgbGV0IHNjYWxlWCA9IDEsCiAgICAgICAgICBzY2FsZVkgPSAxLAogICAgICAgICAgc2NhbGUwMSA9IDAsCiAgICAgICAgICBzY2FsZTEwID0gMDsKCiAgICAgIGlmIChmbGFncyAmIDB4MDgpIHsKICAgICAgICBzY2FsZVggPSBzY2FsZVkgPSBnZXRGbG9hdDIxNChjb2RlLCBpKTsKICAgICAgICBpICs9IDI7CiAgICAgIH0gZWxzZSBpZiAoZmxhZ3MgJiAweDQwKSB7CiAgICAgICAgc2NhbGVYID0gZ2V0RmxvYXQyMTQoY29kZSwgaSk7CiAgICAgICAgc2NhbGVZID0gZ2V0RmxvYXQyMTQoY29kZSwgaSArIDIpOwogICAgICAgIGkgKz0gNDsKICAgICAgfSBlbHNlIGlmIChmbGFncyAmIDB4ODApIHsKICAgICAgICBzY2FsZVggPSBnZXRGbG9hdDIxNChjb2RlLCBpKTsKICAgICAgICBzY2FsZTAxID0gZ2V0RmxvYXQyMTQoY29kZSwgaSArIDIpOwogICAgICAgIHNjYWxlMTAgPSBnZXRGbG9hdDIxNChjb2RlLCBpICsgNCk7CiAgICAgICAgc2NhbGVZID0gZ2V0RmxvYXQyMTQoY29kZSwgaSArIDYpOwogICAgICAgIGkgKz0gODsKICAgICAgfQoKICAgICAgY29uc3Qgc3ViZ2x5cGggPSBmb250LmdseXBoc1tnbHlwaEluZGV4XTsKCiAgICAgIGlmIChzdWJnbHlwaCkgewogICAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgICBjbWQ6ICJzYXZlIgogICAgICAgIH0sIHsKICAgICAgICAgIGNtZDogInRyYW5zZm9ybSIsCiAgICAgICAgICBhcmdzOiBbc2NhbGVYLCBzY2FsZTAxLCBzY2FsZTEwLCBzY2FsZVksIHgsIHldCiAgICAgICAgfSk7CgogICAgICAgIGlmICghKGZsYWdzICYgMHgwMikpIHt9CgogICAgICAgIGNvbXBpbGVHbHlmKHN1YmdseXBoLCBjbWRzLCBmb250KTsKICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgY21kOiAicmVzdG9yZSIKICAgICAgICB9KTsKICAgICAgfQogICAgfSB3aGlsZSAoZmxhZ3MgJiAweDIwKTsKICB9IGVsc2UgewogICAgY29uc3QgZW5kUHRzT2ZDb250b3VycyA9IFtdOwogICAgbGV0IGosIGpqOwoKICAgIGZvciAoaiA9IDA7IGogPCBudW1iZXJPZkNvbnRvdXJzOyBqKyspIHsKICAgICAgZW5kUHRzT2ZDb250b3Vycy5wdXNoKGdldFVpbnQxNihjb2RlLCBpKSk7CiAgICAgIGkgKz0gMjsKICAgIH0KCiAgICBjb25zdCBpbnN0cnVjdGlvbkxlbmd0aCA9IGdldFVpbnQxNihjb2RlLCBpKTsKICAgIGkgKz0gMiArIGluc3RydWN0aW9uTGVuZ3RoOwogICAgY29uc3QgbnVtYmVyT2ZQb2ludHMgPSBlbmRQdHNPZkNvbnRvdXJzLmF0KC0xKSArIDE7CiAgICBjb25zdCBwb2ludHMgPSBbXTsKCiAgICB3aGlsZSAocG9pbnRzLmxlbmd0aCA8IG51bWJlck9mUG9pbnRzKSB7CiAgICAgIGZsYWdzID0gY29kZVtpKytdOwogICAgICBsZXQgcmVwZWF0ID0gMTsKCiAgICAgIGlmIChmbGFncyAmIDB4MDgpIHsKICAgICAgICByZXBlYXQgKz0gY29kZVtpKytdOwogICAgICB9CgogICAgICB3aGlsZSAocmVwZWF0LS0gPiAwKSB7CiAgICAgICAgcG9pbnRzLnB1c2goewogICAgICAgICAgZmxhZ3MKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGZvciAoaiA9IDA7IGogPCBudW1iZXJPZlBvaW50czsgaisrKSB7CiAgICAgIHN3aXRjaCAocG9pbnRzW2pdLmZsYWdzICYgMHgxMikgewogICAgICAgIGNhc2UgMHgwMDoKICAgICAgICAgIHggKz0gZ2V0SW50MTYoY29kZSwgaSk7CiAgICAgICAgICBpICs9IDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDAyOgogICAgICAgICAgeCAtPSBjb2RlW2krK107CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDEyOgogICAgICAgICAgeCArPSBjb2RlW2krK107CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcG9pbnRzW2pdLnggPSB4OwogICAgfQoKICAgIGZvciAoaiA9IDA7IGogPCBudW1iZXJPZlBvaW50czsgaisrKSB7CiAgICAgIHN3aXRjaCAocG9pbnRzW2pdLmZsYWdzICYgMHgyNCkgewogICAgICAgIGNhc2UgMHgwMDoKICAgICAgICAgIHkgKz0gZ2V0SW50MTYoY29kZSwgaSk7CiAgICAgICAgICBpICs9IDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDA0OgogICAgICAgICAgeSAtPSBjb2RlW2krK107CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAweDI0OgogICAgICAgICAgeSArPSBjb2RlW2krK107CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcG9pbnRzW2pdLnkgPSB5OwogICAgfQoKICAgIGxldCBzdGFydFBvaW50ID0gMDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtYmVyT2ZDb250b3VyczsgaSsrKSB7CiAgICAgIGNvbnN0IGVuZFBvaW50ID0gZW5kUHRzT2ZDb250b3Vyc1tpXTsKICAgICAgY29uc3QgY29udG91ciA9IHBvaW50cy5zbGljZShzdGFydFBvaW50LCBlbmRQb2ludCArIDEpOwoKICAgICAgaWYgKGNvbnRvdXJbMF0uZmxhZ3MgJiAxKSB7CiAgICAgICAgY29udG91ci5wdXNoKGNvbnRvdXJbMF0pOwogICAgICB9IGVsc2UgaWYgKGNvbnRvdXIuYXQoLTEpLmZsYWdzICYgMSkgewogICAgICAgIGNvbnRvdXIudW5zaGlmdChjb250b3VyLmF0KC0xKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgcCA9IHsKICAgICAgICAgIGZsYWdzOiAxLAogICAgICAgICAgeDogKGNvbnRvdXJbMF0ueCArIGNvbnRvdXIuYXQoLTEpLngpIC8gMiwKICAgICAgICAgIHk6IChjb250b3VyWzBdLnkgKyBjb250b3VyLmF0KC0xKS55KSAvIDIKICAgICAgICB9OwogICAgICAgIGNvbnRvdXIudW5zaGlmdChwKTsKICAgICAgICBjb250b3VyLnB1c2gocCk7CiAgICAgIH0KCiAgICAgIG1vdmVUbyhjb250b3VyWzBdLngsIGNvbnRvdXJbMF0ueSk7CgogICAgICBmb3IgKGogPSAxLCBqaiA9IGNvbnRvdXIubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgIGlmIChjb250b3VyW2pdLmZsYWdzICYgMSkgewogICAgICAgICAgbGluZVRvKGNvbnRvdXJbal0ueCwgY29udG91cltqXS55KTsKICAgICAgICB9IGVsc2UgaWYgKGNvbnRvdXJbaiArIDFdLmZsYWdzICYgMSkgewogICAgICAgICAgcXVhZHJhdGljQ3VydmVUbyhjb250b3VyW2pdLngsIGNvbnRvdXJbal0ueSwgY29udG91cltqICsgMV0ueCwgY29udG91cltqICsgMV0ueSk7CiAgICAgICAgICBqKys7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHF1YWRyYXRpY0N1cnZlVG8oY29udG91cltqXS54LCBjb250b3VyW2pdLnksIChjb250b3VyW2pdLnggKyBjb250b3VyW2ogKyAxXS54KSAvIDIsIChjb250b3VyW2pdLnkgKyBjb250b3VyW2ogKyAxXS55KSAvIDIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RhcnRQb2ludCA9IGVuZFBvaW50ICsgMTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGNvbXBpbGVDaGFyU3RyaW5nKGNoYXJTdHJpbmdDb2RlLCBjbWRzLCBmb250LCBnbHlwaElkKSB7CiAgZnVuY3Rpb24gbW92ZVRvKHgsIHkpIHsKICAgIGNtZHMucHVzaCh7CiAgICAgIGNtZDogIm1vdmVUbyIsCiAgICAgIGFyZ3M6IFt4LCB5XQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBsaW5lVG8oeCwgeSkgewogICAgY21kcy5wdXNoKHsKICAgICAgY21kOiAibGluZVRvIiwKICAgICAgYXJnczogW3gsIHldCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGJlemllckN1cnZlVG8oeDEsIHkxLCB4MiwgeTIsIHgsIHkpIHsKICAgIGNtZHMucHVzaCh7CiAgICAgIGNtZDogImJlemllckN1cnZlVG8iLAogICAgICBhcmdzOiBbeDEsIHkxLCB4MiwgeTIsIHgsIHldCiAgICB9KTsKICB9CgogIGNvbnN0IHN0YWNrID0gW107CiAgbGV0IHggPSAwLAogICAgICB5ID0gMDsKICBsZXQgc3RlbXMgPSAwOwoKICBmdW5jdGlvbiBwYXJzZShjb2RlKSB7CiAgICBsZXQgaSA9IDA7CgogICAgd2hpbGUgKGkgPCBjb2RlLmxlbmd0aCkgewogICAgICBsZXQgc3RhY2tDbGVhbiA9IGZhbHNlOwogICAgICBsZXQgdiA9IGNvZGVbaSsrXTsKICAgICAgbGV0IHhhLCB4YiwgeWEsIHliLCB5MSwgeTIsIHkzLCBuLCBzdWJyQ29kZTsKCiAgICAgIHN3aXRjaCAodikgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIHN0ZW1zICs9IHN0YWNrLmxlbmd0aCA+PiAxOwogICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICB5ICs9IHN0YWNrLnBvcCgpOwogICAgICAgICAgbW92ZVRvKHgsIHkpOwogICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA1OgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA2OgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBsaW5lVG8oeCwgeSk7CgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgbGluZVRvKHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDc6CiAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKCiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgODoKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTA6CiAgICAgICAgICBuID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdWJyQ29kZSA9IG51bGw7CgogICAgICAgICAgaWYgKGZvbnQuaXNDRkZDSURGb250KSB7CiAgICAgICAgICAgIGNvbnN0IGZkSW5kZXggPSBmb250LmZkU2VsZWN0LmdldEZESW5kZXgoZ2x5cGhJZCk7CgogICAgICAgICAgICBpZiAoZmRJbmRleCA+PSAwICYmIGZkSW5kZXggPCBmb250LmZkQXJyYXkubGVuZ3RoKSB7CiAgICAgICAgICAgICAgY29uc3QgZm9udERpY3QgPSBmb250LmZkQXJyYXlbZmRJbmRleF07CiAgICAgICAgICAgICAgbGV0IHN1YnJzOwoKICAgICAgICAgICAgICBpZiAoZm9udERpY3QucHJpdmF0ZURpY3QgJiYgZm9udERpY3QucHJpdmF0ZURpY3Quc3VicnNJbmRleCkgewogICAgICAgICAgICAgICAgc3VicnMgPSBmb250RGljdC5wcml2YXRlRGljdC5zdWJyc0luZGV4Lm9iamVjdHM7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoc3VicnMpIHsKICAgICAgICAgICAgICAgIG4gKz0gZ2V0U3Vicm91dGluZUJpYXMoc3VicnMpOwogICAgICAgICAgICAgICAgc3VickNvZGUgPSBzdWJyc1tuXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIGZkIGluZGV4IGZvciBnbHlwaCBpbmRleC4iKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3VickNvZGUgPSBmb250LnN1YnJzW24gKyBmb250LnN1YnJzQmlhc107CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN1YnJDb2RlKSB7CiAgICAgICAgICAgIHBhcnNlKHN1YnJDb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxMToKICAgICAgICAgIHJldHVybjsKCiAgICAgICAgY2FzZSAxMjoKICAgICAgICAgIHYgPSBjb2RlW2krK107CgogICAgICAgICAgc3dpdGNoICh2KSB7CiAgICAgICAgICAgIGNhc2UgMzQ6CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5MSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeSwgeGIsIHkxLCB4LCB5MSk7CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHkxLCB4YiwgeSwgeCwgeSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDM1OgogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzY6CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5MSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkyID0geTEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeTEsIHhiLCB5MiwgeCwgeTIpOwogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeTMgPSB5MiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5MiwgeGIsIHkzLCB4LCB5KTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzc6CiAgICAgICAgICAgICAgY29uc3QgeDAgPSB4LAogICAgICAgICAgICAgICAgICAgIHkwID0geTsKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGI7CiAgICAgICAgICAgICAgeSA9IHliOwoKICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoeCAtIHgwKSA+IE1hdGguYWJzKHkgLSB5MCkpIHsKICAgICAgICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgdW5rbm93biBvcGVyYXRvcjogMTIgJHt2fWApOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE0OgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA+PSA0KSB7CiAgICAgICAgICAgIGNvbnN0IGFjaGFyID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvbnN0IGJjaGFyID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHkgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgeCA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgICAgIGNtZDogInNhdmUiCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBjbWQ6ICJ0cmFuc2xhdGUiLAogICAgICAgICAgICAgIGFyZ3M6IFt4LCB5XQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbGV0IGNtYXAgPSBsb29rdXBDbWFwKGZvbnQuY21hcCwgU3RyaW5nLmZyb21DaGFyQ29kZShmb250LmdseXBoTmFtZU1hcFtfZW5jb2RpbmdzLlN0YW5kYXJkRW5jb2RpbmdbYWNoYXJdXSkpOwogICAgICAgICAgICBjb21waWxlQ2hhclN0cmluZyhmb250LmdseXBoc1tjbWFwLmdseXBoSWRdLCBjbWRzLCBmb250LCBjbWFwLmdseXBoSWQpOwogICAgICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgICAgIGNtZDogInJlc3RvcmUiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjbWFwID0gbG9va3VwQ21hcChmb250LmNtYXAsIFN0cmluZy5mcm9tQ2hhckNvZGUoZm9udC5nbHlwaE5hbWVNYXBbX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW2JjaGFyXV0pKTsKICAgICAgICAgICAgY29tcGlsZUNoYXJTdHJpbmcoZm9udC5nbHlwaHNbY21hcC5nbHlwaElkXSwgY21kcywgZm9udCwgY21hcC5nbHlwaElkKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CgogICAgICAgIGNhc2UgMTg6CiAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTk6CiAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgIGkgKz0gc3RlbXMgKyA3ID4+IDM7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDIwOgogICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICBpICs9IHN0ZW1zICsgNyA+PiAzOwogICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyMToKICAgICAgICAgIHkgKz0gc3RhY2sucG9wKCk7CiAgICAgICAgICB4ICs9IHN0YWNrLnBvcCgpOwogICAgICAgICAgbW92ZVRvKHgsIHkpOwogICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyMjoKICAgICAgICAgIHggKz0gc3RhY2sucG9wKCk7CiAgICAgICAgICBtb3ZlVG8oeCwgeSk7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDIzOgogICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI0OgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDIpIHsKICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgIH0KCiAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICB5ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyNToKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiA2KSB7CiAgICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI2OgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCAlIDIpIHsKICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGI7CiAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI3OgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCAlIDIpIHsKICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHlhID0geTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ID0geWI7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI4OgogICAgICAgICAgc3RhY2sucHVzaCgoY29kZVtpXSA8PCAyNCB8IGNvZGVbaSArIDFdIDw8IDE2KSA+PiAxNik7CiAgICAgICAgICBpICs9IDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOToKICAgICAgICAgIG4gPSBzdGFjay5wb3AoKSArIGZvbnQuZ3N1YnJzQmlhczsKICAgICAgICAgIHN1YnJDb2RlID0gZm9udC5nc3VicnNbbl07CgogICAgICAgICAgaWYgKHN1YnJDb2RlKSB7CiAgICAgICAgICAgIHBhcnNlKHN1YnJDb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzMDoKICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5ID0geWIgKyAoc3RhY2subGVuZ3RoID09PSAxID8gc3RhY2suc2hpZnQoKSA6IDApOwogICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKCiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWEgPSB5OwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YiArIChzdGFjay5sZW5ndGggPT09IDEgPyBzdGFjay5zaGlmdCgpIDogMCk7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDMxOgogICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWEgPSB5OwogICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHggPSB4YiArIChzdGFjay5sZW5ndGggPT09IDEgPyBzdGFjay5zaGlmdCgpIDogMCk7CiAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwoKICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB4YSA9IHg7CiAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSA9IHliICsgKHN0YWNrLmxlbmd0aCA9PT0gMSA/IHN0YWNrLnNoaWZ0KCkgOiAwKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAodiA8IDMyKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgdW5rbm93biBvcGVyYXRvcjogJHt2fWApOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh2IDwgMjQ3KSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2godiAtIDEzOSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHYgPCAyNTEpIHsKICAgICAgICAgICAgc3RhY2sucHVzaCgodiAtIDI0NykgKiAyNTYgKyBjb2RlW2krK10gKyAxMDgpOwogICAgICAgICAgfSBlbHNlIGlmICh2IDwgMjU1KSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goLSh2IC0gMjUxKSAqIDI1NiAtIGNvZGVbaSsrXSAtIDEwOCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFjay5wdXNoKChjb2RlW2ldIDw8IDI0IHwgY29kZVtpICsgMV0gPDwgMTYgfCBjb2RlW2kgKyAyXSA8PCA4IHwgY29kZVtpICsgM10pIC8gNjU1MzYpOwogICAgICAgICAgICBpICs9IDQ7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChzdGFja0NsZWFuKSB7CiAgICAgICAgc3RhY2subGVuZ3RoID0gMDsKICAgICAgfQogICAgfQogIH0KCiAgcGFyc2UoY2hhclN0cmluZ0NvZGUpOwp9Cgpjb25zdCBOT09QID0gW107CgpjbGFzcyBDb21waWxlZEZvbnQgewogIGNvbnN0cnVjdG9yKGZvbnRNYXRyaXgpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBDb21waWxlZEZvbnQpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQ2Fubm90IGluaXRpYWxpemUgQ29tcGlsZWRGb250LiIpOwogICAgfQoKICAgIHRoaXMuZm9udE1hdHJpeCA9IGZvbnRNYXRyaXg7CiAgICB0aGlzLmNvbXBpbGVkR2x5cGhzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuY29tcGlsZWRDaGFyQ29kZVRvR2x5cGhJZCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgfQoKICBnZXRQYXRoSnModW5pY29kZSkgewogICAgY29uc3QgewogICAgICBjaGFyQ29kZSwKICAgICAgZ2x5cGhJZAogICAgfSA9IGxvb2t1cENtYXAodGhpcy5jbWFwLCB1bmljb2RlKTsKICAgIGxldCBmbiA9IHRoaXMuY29tcGlsZWRHbHlwaHNbZ2x5cGhJZF07CgogICAgaWYgKCFmbikgewogICAgICB0cnkgewogICAgICAgIGZuID0gdGhpcy5jb21waWxlR2x5cGgodGhpcy5nbHlwaHNbZ2x5cGhJZF0sIGdseXBoSWQpOwogICAgICAgIHRoaXMuY29tcGlsZWRHbHlwaHNbZ2x5cGhJZF0gPSBmbjsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICB0aGlzLmNvbXBpbGVkR2x5cGhzW2dseXBoSWRdID0gTk9PUDsKCiAgICAgICAgaWYgKHRoaXMuY29tcGlsZWRDaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy5jb21waWxlZENoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBleDsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID09PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy5jb21waWxlZENoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICB9CgogICAgcmV0dXJuIGZuOwogIH0KCiAgY29tcGlsZUdseXBoKGNvZGUsIGdseXBoSWQpIHsKICAgIGlmICghY29kZSB8fCBjb2RlLmxlbmd0aCA9PT0gMCB8fCBjb2RlWzBdID09PSAxNCkgewogICAgICByZXR1cm4gTk9PUDsKICAgIH0KCiAgICBsZXQgZm9udE1hdHJpeCA9IHRoaXMuZm9udE1hdHJpeDsKCiAgICBpZiAodGhpcy5pc0NGRkNJREZvbnQpIHsKICAgICAgY29uc3QgZmRJbmRleCA9IHRoaXMuZmRTZWxlY3QuZ2V0RkRJbmRleChnbHlwaElkKTsKCiAgICAgIGlmIChmZEluZGV4ID49IDAgJiYgZmRJbmRleCA8IHRoaXMuZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICBjb25zdCBmb250RGljdCA9IHRoaXMuZmRBcnJheVtmZEluZGV4XTsKICAgICAgICBmb250TWF0cml4ID0gZm9udERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4IikgfHwgX3V0aWwuRk9OVF9JREVOVElUWV9NQVRSSVg7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIGZkIGluZGV4IGZvciBnbHlwaCBpbmRleC4iKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGNtZHMgPSBbewogICAgICBjbWQ6ICJzYXZlIgogICAgfSwgewogICAgICBjbWQ6ICJ0cmFuc2Zvcm0iLAogICAgICBhcmdzOiBmb250TWF0cml4LnNsaWNlKCkKICAgIH0sIHsKICAgICAgY21kOiAic2NhbGUiLAogICAgICBhcmdzOiBbInNpemUiLCAiLXNpemUiXQogICAgfV07CiAgICB0aGlzLmNvbXBpbGVHbHlwaEltcGwoY29kZSwgY21kcywgZ2x5cGhJZCk7CiAgICBjbWRzLnB1c2goewogICAgICBjbWQ6ICJyZXN0b3JlIgogICAgfSk7CiAgICByZXR1cm4gY21kczsKICB9CgogIGNvbXBpbGVHbHlwaEltcGwoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDaGlsZHJlbiBjbGFzc2VzIHNob3VsZCBpbXBsZW1lbnQgdGhpcy4iKTsKICB9CgogIGhhc0J1aWx0UGF0aCh1bmljb2RlKSB7CiAgICBjb25zdCB7CiAgICAgIGNoYXJDb2RlLAogICAgICBnbHlwaElkCiAgICB9ID0gbG9va3VwQ21hcCh0aGlzLmNtYXAsIHVuaWNvZGUpOwogICAgcmV0dXJuIHRoaXMuY29tcGlsZWRHbHlwaHNbZ2x5cGhJZF0gIT09IHVuZGVmaW5lZCAmJiB0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdICE9PSB1bmRlZmluZWQ7CiAgfQoKfQoKY2xhc3MgVHJ1ZVR5cGVDb21waWxlZCBleHRlbmRzIENvbXBpbGVkRm9udCB7CiAgY29uc3RydWN0b3IoZ2x5cGhzLCBjbWFwLCBmb250TWF0cml4KSB7CiAgICBzdXBlcihmb250TWF0cml4IHx8IFswLjAwMDQ4OCwgMCwgMCwgMC4wMDA0ODgsIDAsIDBdKTsKICAgIHRoaXMuZ2x5cGhzID0gZ2x5cGhzOwogICAgdGhpcy5jbWFwID0gY21hcDsKICB9CgogIGNvbXBpbGVHbHlwaEltcGwoY29kZSwgY21kcykgewogICAgY29tcGlsZUdseWYoY29kZSwgY21kcywgdGhpcyk7CiAgfQoKfQoKY2xhc3MgVHlwZTJDb21waWxlZCBleHRlbmRzIENvbXBpbGVkRm9udCB7CiAgY29uc3RydWN0b3IoY2ZmSW5mbywgY21hcCwgZm9udE1hdHJpeCwgZ2x5cGhOYW1lTWFwKSB7CiAgICBzdXBlcihmb250TWF0cml4IHx8IFswLjAwMSwgMCwgMCwgMC4wMDEsIDAsIDBdKTsKICAgIHRoaXMuZ2x5cGhzID0gY2ZmSW5mby5nbHlwaHM7CiAgICB0aGlzLmdzdWJycyA9IGNmZkluZm8uZ3N1YnJzIHx8IFtdOwogICAgdGhpcy5zdWJycyA9IGNmZkluZm8uc3VicnMgfHwgW107CiAgICB0aGlzLmNtYXAgPSBjbWFwOwogICAgdGhpcy5nbHlwaE5hbWVNYXAgPSBnbHlwaE5hbWVNYXAgfHwgKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKICAgIHRoaXMuZ3N1YnJzQmlhcyA9IGdldFN1YnJvdXRpbmVCaWFzKHRoaXMuZ3N1YnJzKTsKICAgIHRoaXMuc3VicnNCaWFzID0gZ2V0U3Vicm91dGluZUJpYXModGhpcy5zdWJycyk7CiAgICB0aGlzLmlzQ0ZGQ0lERm9udCA9IGNmZkluZm8uaXNDRkZDSURGb250OwogICAgdGhpcy5mZFNlbGVjdCA9IGNmZkluZm8uZmRTZWxlY3Q7CiAgICB0aGlzLmZkQXJyYXkgPSBjZmZJbmZvLmZkQXJyYXk7CiAgfQoKICBjb21waWxlR2x5cGhJbXBsKGNvZGUsIGNtZHMsIGdseXBoSWQpIHsKICAgIGNvbXBpbGVDaGFyU3RyaW5nKGNvZGUsIGNtZHMsIHRoaXMsIGdseXBoSWQpOwogIH0KCn0KCmNsYXNzIEZvbnRSZW5kZXJlckZhY3RvcnkgewogIHN0YXRpYyBjcmVhdGUoZm9udCwgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KGZvbnQuZGF0YSk7CiAgICBsZXQgY21hcCwgZ2x5ZiwgbG9jYSwgY2ZmLCBpbmRleFRvTG9jRm9ybWF0LCB1bml0c1BlckVtOwogICAgY29uc3QgbnVtVGFibGVzID0gZ2V0VWludDE2KGRhdGEsIDQpOwoKICAgIGZvciAobGV0IGkgPSAwLCBwID0gMTI7IGkgPCBudW1UYWJsZXM7IGkrKywgcCArPSAxNikgewogICAgICBjb25zdCB0YWcgPSAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZGF0YS5zdWJhcnJheShwLCBwICsgNCkpOwogICAgICBjb25zdCBvZmZzZXQgPSBnZXRVaW50MzIoZGF0YSwgcCArIDgpOwogICAgICBjb25zdCBsZW5ndGggPSBnZXRVaW50MzIoZGF0YSwgcCArIDEyKTsKCiAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgY2FzZSAiY21hcCI6CiAgICAgICAgICBjbWFwID0gcGFyc2VDbWFwKGRhdGEsIG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJnbHlmIjoKICAgICAgICAgIGdseWYgPSBkYXRhLnN1YmFycmF5KG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJsb2NhIjoKICAgICAgICAgIGxvY2EgPSBkYXRhLnN1YmFycmF5KG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJoZWFkIjoKICAgICAgICAgIHVuaXRzUGVyRW0gPSBnZXRVaW50MTYoZGF0YSwgb2Zmc2V0ICsgMTgpOwogICAgICAgICAgaW5kZXhUb0xvY0Zvcm1hdCA9IGdldFVpbnQxNihkYXRhLCBvZmZzZXQgKyA1MCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQ0ZGICI6CiAgICAgICAgICBjZmYgPSBwYXJzZUNmZihkYXRhLCBvZmZzZXQsIG9mZnNldCArIGxlbmd0aCwgc2VhY0FuYWx5c2lzRW5hYmxlZCk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChnbHlmKSB7CiAgICAgIGNvbnN0IGZvbnRNYXRyaXggPSAhdW5pdHNQZXJFbSA/IGZvbnQuZm9udE1hdHJpeCA6IFsxIC8gdW5pdHNQZXJFbSwgMCwgMCwgMSAvIHVuaXRzUGVyRW0sIDAsIDBdOwogICAgICByZXR1cm4gbmV3IFRydWVUeXBlQ29tcGlsZWQocGFyc2VHbHlmVGFibGUoZ2x5ZiwgbG9jYSwgaW5kZXhUb0xvY0Zvcm1hdCksIGNtYXAsIGZvbnRNYXRyaXgpOwogICAgfQoKICAgIHJldHVybiBuZXcgVHlwZTJDb21waWxlZChjZmYsIGNtYXAsIGZvbnQuZm9udE1hdHJpeCwgZm9udC5nbHlwaE5hbWVNYXApOwogIH0KCn0KCmV4cG9ydHMuRm9udFJlbmRlcmVyRmFjdG9yeSA9IEZvbnRSZW5kZXJlckZhY3Rvcnk7CgovKioqLyB9KSwKLyogNDUgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5nZXRNZXRyaWNzID0gZXhwb3J0cy5nZXRGb250QmFzaWNNZXRyaWNzID0gdm9pZCAwOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCmNvbnN0IGdldE1ldHJpY3MgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuQ291cmllciA9IDYwMDsKICB0WyJDb3VyaWVyLUJvbGQiXSA9IDYwMDsKICB0WyJDb3VyaWVyLUJvbGRPYmxpcXVlIl0gPSA2MDA7CiAgdFsiQ291cmllci1PYmxpcXVlIl0gPSA2MDA7CiAgdC5IZWx2ZXRpY2EgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI3ODsKICAgIHQuZXhjbGFtID0gMjc4OwogICAgdC5xdW90ZWRibCA9IDM1NTsKICAgIHQubnVtYmVyc2lnbiA9IDU1NjsKICAgIHQuZG9sbGFyID0gNTU2OwogICAgdC5wZXJjZW50ID0gODg5OwogICAgdC5hbXBlcnNhbmQgPSA2Njc7CiAgICB0LnF1b3RlcmlnaHQgPSAyMjI7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSAzODk7CiAgICB0LnBsdXMgPSA1ODQ7CiAgICB0LmNvbW1hID0gMjc4OwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI3ODsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1NTY7CiAgICB0Lm9uZSA9IDU1NjsKICAgIHQudHdvID0gNTU2OwogICAgdC50aHJlZSA9IDU1NjsKICAgIHQuZm91ciA9IDU1NjsKICAgIHQuZml2ZSA9IDU1NjsKICAgIHQuc2l4ID0gNTU2OwogICAgdC5zZXZlbiA9IDU1NjsKICAgIHQuZWlnaHQgPSA1NTY7CiAgICB0Lm5pbmUgPSA1NTY7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1ODQ7CiAgICB0LmVxdWFsID0gNTg0OwogICAgdC5ncmVhdGVyID0gNTg0OwogICAgdC5xdWVzdGlvbiA9IDU1NjsKICAgIHQuYXQgPSAxMDE1OwogICAgdC5BID0gNjY3OwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMjc4OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNjY3OwogICAgdC5MID0gNTU2OwogICAgdC5NID0gODMzOwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjY3OwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNjY3OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjY3OwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDI3ODsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAyNzg7CiAgICB0LmFzY2lpY2lyY3VtID0gNDY5OwogICAgdC51bmRlcnNjb3JlID0gNTU2OwogICAgdC5xdW90ZWxlZnQgPSAyMjI7CiAgICB0LmEgPSA1NTY7CiAgICB0LmIgPSA1NTY7CiAgICB0LmMgPSA1MDA7CiAgICB0LmQgPSA1NTY7CiAgICB0LmUgPSA1NTY7CiAgICB0LmYgPSAyNzg7CiAgICB0LmcgPSA1NTY7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyMjI7CiAgICB0LmogPSAyMjI7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyMjI7CiAgICB0Lm0gPSA4MzM7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1NTY7CiAgICB0LnAgPSA1NTY7CiAgICB0LnEgPSA1NTY7CiAgICB0LnIgPSAzMzM7CiAgICB0LnMgPSA1MDA7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA1MDA7CiAgICB0LmJyYWNlbGVmdCA9IDMzNDsKICAgIHQuYmFyID0gMjYwOwogICAgdC5icmFjZXJpZ2h0ID0gMzM0OwogICAgdC5hc2NpaXRpbGRlID0gNTg0OwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTU2OwogICAgdC5zdGVybGluZyA9IDU1NjsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDU1NjsKICAgIHQuZmxvcmluID0gNTU2OwogICAgdC5zZWN0aW9uID0gNTU2OwogICAgdC5jdXJyZW5jeSA9IDU1NjsKICAgIHQucXVvdGVzaW5nbGUgPSAxOTE7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDU1NjsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTAwOwogICAgdC5mbCA9IDUwMDsKICAgIHQuZW5kYXNoID0gNTU2OwogICAgdC5kYWdnZXIgPSA1NTY7CiAgICB0LmRhZ2dlcmRibCA9IDU1NjsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNzg7CiAgICB0LnBhcmFncmFwaCA9IDUzNzsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDIyMjsKICAgIHQucXVvdGVkYmxiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gMzMzOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDU1NjsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDYxMTsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDEwMDA7CiAgICB0Lm9yZGZlbWluaW5lID0gMzcwOwogICAgdC5Mc2xhc2ggPSA1NTY7CiAgICB0Lk9zbGFzaCA9IDc3ODsKICAgIHQuT0UgPSAxMDAwOwogICAgdC5vcmRtYXNjdWxpbmUgPSAzNjU7CiAgICB0LmFlID0gODg5OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjIyOwogICAgdC5vc2xhc2ggPSA2MTE7CiAgICB0Lm9lID0gOTQ0OwogICAgdC5nZXJtYW5kYmxzID0gNjExOwogICAgdC5JZGllcmVzaXMgPSAyNzg7CiAgICB0LmVhY3V0ZSA9IDU1NjsKICAgIHQuYWJyZXZlID0gNTU2OwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5lY2Fyb24gPSA1NTY7CiAgICB0LllkaWVyZXNpcyA9IDY2NzsKICAgIHQuZGl2aWRlID0gNTg0OwogICAgdC5ZYWN1dGUgPSA2Njc7CiAgICB0LkFjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hYWN1dGUgPSA1NTY7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1MDA7CiAgICB0LnNjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1NTY7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDU1NjsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3Mzc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDUwMDsKICAgIHQuYXJpbmcgPSA1NTY7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjIyOwogICAgdC5hZ3JhdmUgPSA1NTY7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNzIyOwogICAgdC5hdGlsZGUgPSA1NTY7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDUwMDsKICAgIHQuc2NlZGlsbGEgPSA1MDA7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ3MTsKICAgIHQuUmNhcm9uID0gNzIyOwogICAgdC5HY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5hY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuQW1hY3JvbiA9IDY2NzsKICAgIHQucmNhcm9uID0gMzMzOwogICAgdC5jY2VkaWxsYSA9IDUwMDsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA2Njc7CiAgICB0Lk9tYWNyb24gPSA3Nzg7CiAgICB0LlJhY3V0ZSA9IDcyMjsKICAgIHQuU2FjdXRlID0gNjY3OwogICAgdC5kY2Fyb24gPSA2NDM7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTU2OwogICAgdC50aHJlZXN1cGVyaW9yID0gMzMzOwogICAgdC5PZ3JhdmUgPSA3Nzg7CiAgICB0LkFncmF2ZSA9IDY2NzsKICAgIHQuQWJyZXZlID0gNjY3OwogICAgdC5tdWx0aXBseSA9IDU4NDsKICAgIHQudWFjdXRlID0gNTU2OwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDc2OwogICAgdC55ZGllcmVzaXMgPSA1MDA7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1NTY7CiAgICB0LmVkaWVyZXNpcyA9IDU1NjsKICAgIHQuY2FjdXRlID0gNTAwOwogICAgdC5uYWN1dGUgPSA1NTY7CiAgICB0LnVtYWNyb24gPSA1NTY7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMjc4OwogICAgdC5wbHVzbWludXMgPSA1ODQ7CiAgICB0LmJyb2tlbmJhciA9IDI2MDsKICAgIHQucmVnaXN0ZXJlZCA9IDczNzsKICAgIHQuR2JyZXZlID0gNzc4OwogICAgdC5JZG90YWNjZW50ID0gMjc4OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gMzMzOwogICAgdC5vbWFjcm9uID0gNTU2OwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNzIyOwogICAgdC5sY29tbWFhY2NlbnQgPSAyMjI7CiAgICB0LnRjYXJvbiA9IDMxNzsKICAgIHQuZW9nb25layA9IDU1NjsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNjY3OwogICAgdC5BZGllcmVzaXMgPSA2Njc7CiAgICB0LmVncmF2ZSA9IDU1NjsKICAgIHQuemFjdXRlID0gNTAwOwogICAgdC5pb2dvbmVrID0gMjIyOwogICAgdC5PYWN1dGUgPSA3Nzg7CiAgICB0Lm9hY3V0ZSA9IDU1NjsKICAgIHQuYW1hY3JvbiA9IDU1NjsKICAgIHQuc2FjdXRlID0gNTAwOwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzc4OwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDU1NjsKICAgIHQudHdvc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9kaWVyZXNpcyA9IDc3ODsKICAgIHQubXUgPSA1NTY7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNTU2OwogICAgdC50aHJlZXF1YXJ0ZXJzID0gODM0OwogICAgdC5TY2VkaWxsYSA9IDY2NzsKICAgIHQubGNhcm9uID0gMjk5OwogICAgdC5LY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkxhY3V0ZSA9IDU1NjsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDU1NjsKICAgIHQuSWdyYXZlID0gMjc4OwogICAgdC5JbWFjcm9uID0gMjc4OwogICAgdC5MY2Fyb24gPSA1NTY7CiAgICB0Lm9uZWhhbGYgPSA4MzQ7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1NTY7CiAgICB0Lm50aWxkZSA9IDU1NjsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNTU2OwogICAgdC5nYnJldmUgPSA1NTY7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA4MzQ7CiAgICB0LlNjYXJvbiA9IDY2NzsKICAgIHQuU2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzc4OwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDU1NjsKICAgIHQuQ2Nhcm9uID0gNzIyOwogICAgdC51Z3JhdmUgPSA1NTY7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDU1NjsKICAgIHQuUmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkF0aWxkZSA9IDY2NzsKICAgIHQuQW9nb25layA9IDY2NzsKICAgIHQuQXJpbmcgPSA2Njc7CiAgICB0Lk90aWxkZSA9IDc3ODsKICAgIHQuemRvdGFjY2VudCA9IDUwMDsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMjc4OwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNTg0OwogICAgdC5JY2lyY3VtZmxleCA9IDI3ODsKICAgIHQubmNhcm9uID0gNTU2OwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA1ODQ7CiAgICB0Lm9kaWVyZXNpcyA9IDU1NjsKICAgIHQudWRpZXJlc2lzID0gNTU2OwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5ldGggPSA1NTY7CiAgICB0LnpjYXJvbiA9IDUwMDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5vbmVzdXBlcmlvciA9IDMzMzsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDU1NjsKICB9KTsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNzg7CiAgICB0LmV4Y2xhbSA9IDMzMzsKICAgIHQucXVvdGVkYmwgPSA0NzQ7CiAgICB0Lm51bWJlcnNpZ24gPSA1NTY7CiAgICB0LmRvbGxhciA9IDU1NjsKICAgIHQucGVyY2VudCA9IDg4OTsKICAgIHQuYW1wZXJzYW5kID0gNzIyOwogICAgdC5xdW90ZXJpZ2h0ID0gMjc4OwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gMzg5OwogICAgdC5wbHVzID0gNTg0OwogICAgdC5jb21tYSA9IDI3ODsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNzg7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTU2OwogICAgdC5vbmUgPSA1NTY7CiAgICB0LnR3byA9IDU1NjsKICAgIHQudGhyZWUgPSA1NTY7CiAgICB0LmZvdXIgPSA1NTY7CiAgICB0LmZpdmUgPSA1NTY7CiAgICB0LnNpeCA9IDU1NjsKICAgIHQuc2V2ZW4gPSA1NTY7CiAgICB0LmVpZ2h0ID0gNTU2OwogICAgdC5uaW5lID0gNTU2OwogICAgdC5jb2xvbiA9IDMzMzsKICAgIHQuc2VtaWNvbG9uID0gMzMzOwogICAgdC5sZXNzID0gNTg0OwogICAgdC5lcXVhbCA9IDU4NDsKICAgIHQuZ3JlYXRlciA9IDU4NDsKICAgIHQucXVlc3Rpb24gPSA2MTE7CiAgICB0LmF0ID0gOTc1OwogICAgdC5BID0gNzIyOwogICAgdC5CID0gNzIyOwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMjc4OwogICAgdC5KID0gNTU2OwogICAgdC5LID0gNzIyOwogICAgdC5MID0gNjExOwogICAgdC5NID0gODMzOwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjY3OwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNjY3OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjY3OwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNTg0OwogICAgdC51bmRlcnNjb3JlID0gNTU2OwogICAgdC5xdW90ZWxlZnQgPSAyNzg7CiAgICB0LmEgPSA1NTY7CiAgICB0LmIgPSA2MTE7CiAgICB0LmMgPSA1NTY7CiAgICB0LmQgPSA2MTE7CiAgICB0LmUgPSA1NTY7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA2MTE7CiAgICB0LmggPSA2MTE7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAyNzg7CiAgICB0LmsgPSA1NTY7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA4ODk7CiAgICB0Lm4gPSA2MTE7CiAgICB0Lm8gPSA2MTE7CiAgICB0LnAgPSA2MTE7CiAgICB0LnEgPSA2MTE7CiAgICB0LnIgPSAzODk7CiAgICB0LnMgPSA1NTY7CiAgICB0LnQgPSAzMzM7CiAgICB0LnUgPSA2MTE7CiAgICB0LnYgPSA1NTY7CiAgICB0LncgPSA3Nzg7CiAgICB0LnggPSA1NTY7CiAgICB0LnkgPSA1NTY7CiAgICB0LnogPSA1MDA7CiAgICB0LmJyYWNlbGVmdCA9IDM4OTsKICAgIHQuYmFyID0gMjgwOwogICAgdC5icmFjZXJpZ2h0ID0gMzg5OwogICAgdC5hc2NpaXRpbGRlID0gNTg0OwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTU2OwogICAgdC5zdGVybGluZyA9IDU1NjsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDU1NjsKICAgIHQuZmxvcmluID0gNTU2OwogICAgdC5zZWN0aW9uID0gNTU2OwogICAgdC5jdXJyZW5jeSA9IDU1NjsKICAgIHQucXVvdGVzaW5nbGUgPSAyMzg7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDU1NjsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNjExOwogICAgdC5mbCA9IDYxMTsKICAgIHQuZW5kYXNoID0gNTU2OwogICAgdC5kYWdnZXIgPSA1NTY7CiAgICB0LmRhZ2dlcmRibCA9IDU1NjsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNzg7CiAgICB0LnBhcmFncmFwaCA9IDU1NjsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDI3ODsKICAgIHQucXVvdGVkYmxiYXNlID0gNTAwOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDU1NjsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDYxMTsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDEwMDA7CiAgICB0Lm9yZGZlbWluaW5lID0gMzcwOwogICAgdC5Mc2xhc2ggPSA2MTE7CiAgICB0Lk9zbGFzaCA9IDc3ODsKICAgIHQuT0UgPSAxMDAwOwogICAgdC5vcmRtYXNjdWxpbmUgPSAzNjU7CiAgICB0LmFlID0gODg5OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjc4OwogICAgdC5vc2xhc2ggPSA2MTE7CiAgICB0Lm9lID0gOTQ0OwogICAgdC5nZXJtYW5kYmxzID0gNjExOwogICAgdC5JZGllcmVzaXMgPSAyNzg7CiAgICB0LmVhY3V0ZSA9IDU1NjsKICAgIHQuYWJyZXZlID0gNTU2OwogICAgdC51aHVuZ2FydW1sYXV0ID0gNjExOwogICAgdC5lY2Fyb24gPSA1NTY7CiAgICB0LllkaWVyZXNpcyA9IDY2NzsKICAgIHQuZGl2aWRlID0gNTg0OwogICAgdC5ZYWN1dGUgPSA2Njc7CiAgICB0LkFjaXJjdW1mbGV4ID0gNzIyOwogICAgdC5hYWN1dGUgPSA1NTY7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1NTY7CiAgICB0LnNjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuZWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1NTY7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDYxMTsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3Mzc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDU1NjsKICAgIHQuYXJpbmcgPSA1NTY7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjc4OwogICAgdC5hZ3JhdmUgPSA1NTY7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNzIyOwogICAgdC5hdGlsZGUgPSA1NTY7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDU1NjsKICAgIHQuc2NlZGlsbGEgPSA1NTY7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ5NDsKICAgIHQuUmNhcm9uID0gNzIyOwogICAgdC5HY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LnVjaXJjdW1mbGV4ID0gNjExOwogICAgdC5hY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuQW1hY3JvbiA9IDcyMjsKICAgIHQucmNhcm9uID0gMzg5OwogICAgdC5jY2VkaWxsYSA9IDU1NjsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA2Njc7CiAgICB0Lk9tYWNyb24gPSA3Nzg7CiAgICB0LlJhY3V0ZSA9IDcyMjsKICAgIHQuU2FjdXRlID0gNjY3OwogICAgdC5kY2Fyb24gPSA3NDM7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNjExOwogICAgdC50aHJlZXN1cGVyaW9yID0gMzMzOwogICAgdC5PZ3JhdmUgPSA3Nzg7CiAgICB0LkFncmF2ZSA9IDcyMjsKICAgIHQuQWJyZXZlID0gNzIyOwogICAgdC5tdWx0aXBseSA9IDU4NDsKICAgIHQudWFjdXRlID0gNjExOwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDk0OwogICAgdC55ZGllcmVzaXMgPSA1NTY7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1NTY7CiAgICB0LmVkaWVyZXNpcyA9IDU1NjsKICAgIHQuY2FjdXRlID0gNTU2OwogICAgdC5uYWN1dGUgPSA2MTE7CiAgICB0LnVtYWNyb24gPSA2MTE7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMjc4OwogICAgdC5wbHVzbWludXMgPSA1ODQ7CiAgICB0LmJyb2tlbmJhciA9IDI4MDsKICAgIHQucmVnaXN0ZXJlZCA9IDczNzsKICAgIHQuR2JyZXZlID0gNzc4OwogICAgdC5JZG90YWNjZW50ID0gMjc4OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gMzg5OwogICAgdC5vbWFjcm9uID0gNjExOwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNzIyOwogICAgdC5sY29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LnRjYXJvbiA9IDM4OTsKICAgIHQuZW9nb25layA9IDU1NjsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNzIyOwogICAgdC5BZGllcmVzaXMgPSA3MjI7CiAgICB0LmVncmF2ZSA9IDU1NjsKICAgIHQuemFjdXRlID0gNTAwOwogICAgdC5pb2dvbmVrID0gMjc4OwogICAgdC5PYWN1dGUgPSA3Nzg7CiAgICB0Lm9hY3V0ZSA9IDYxMTsKICAgIHQuYW1hY3JvbiA9IDU1NjsKICAgIHQuc2FjdXRlID0gNTU2OwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzc4OwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDYxMTsKICAgIHQudHdvc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9kaWVyZXNpcyA9IDc3ODsKICAgIHQubXUgPSA2MTE7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDYxMTsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNjExOwogICAgdC50aHJlZXF1YXJ0ZXJzID0gODM0OwogICAgdC5TY2VkaWxsYSA9IDY2NzsKICAgIHQubGNhcm9uID0gNDAwOwogICAgdC5LY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LkxhY3V0ZSA9IDYxMTsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDU1NjsKICAgIHQuSWdyYXZlID0gMjc4OwogICAgdC5JbWFjcm9uID0gMjc4OwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA4MzQ7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA2MTE7CiAgICB0Lm50aWxkZSA9IDYxMTsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNTU2OwogICAgdC5nYnJldmUgPSA2MTE7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA4MzQ7CiAgICB0LlNjYXJvbiA9IDY2NzsKICAgIHQuU2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzc4OwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDYxMTsKICAgIHQuQ2Nhcm9uID0gNzIyOwogICAgdC51Z3JhdmUgPSA2MTE7CiAgICB0LnJhZGljYWwgPSA1NDk7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzg5OwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDYxMTsKICAgIHQuUmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkF0aWxkZSA9IDcyMjsKICAgIHQuQW9nb25layA9IDcyMjsKICAgIHQuQXJpbmcgPSA3MjI7CiAgICB0Lk90aWxkZSA9IDc3ODsKICAgIHQuemRvdGFjY2VudCA9IDUwMDsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMjc4OwogICAgdC5rY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0Lm1pbnVzID0gNTg0OwogICAgdC5JY2lyY3VtZmxleCA9IDI3ODsKICAgIHQubmNhcm9uID0gNjExOwogICAgdC50Y29tbWFhY2NlbnQgPSAzMzM7CiAgICB0LmxvZ2ljYWxub3QgPSA1ODQ7CiAgICB0Lm9kaWVyZXNpcyA9IDYxMTsKICAgIHQudWRpZXJlc2lzID0gNjExOwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNjExOwogICAgdC5ldGggPSA2MTE7CiAgICB0LnpjYXJvbiA9IDUwMDsKICAgIHQubmNvbW1hYWNjZW50ID0gNjExOwogICAgdC5vbmVzdXBlcmlvciA9IDMzMzsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDU1NjsKICB9KTsKICB0WyJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnF1b3RlZGJsID0gNDc0OwogICAgdC5udW1iZXJzaWduID0gNTU2OwogICAgdC5kb2xsYXIgPSA1NTY7CiAgICB0LnBlcmNlbnQgPSA4ODk7CiAgICB0LmFtcGVyc2FuZCA9IDcyMjsKICAgIHQucXVvdGVyaWdodCA9IDI3ODsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3RlcmlzayA9IDM4OTsKICAgIHQucGx1cyA9IDU4NDsKICAgIHQuY29tbWEgPSAyNzg7CiAgICB0Lmh5cGhlbiA9IDMzMzsKICAgIHQucGVyaW9kID0gMjc4OwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDU1NjsKICAgIHQub25lID0gNTU2OwogICAgdC50d28gPSA1NTY7CiAgICB0LnRocmVlID0gNTU2OwogICAgdC5mb3VyID0gNTU2OwogICAgdC5maXZlID0gNTU2OwogICAgdC5zaXggPSA1NTY7CiAgICB0LnNldmVuID0gNTU2OwogICAgdC5laWdodCA9IDU1NjsKICAgIHQubmluZSA9IDU1NjsKICAgIHQuY29sb24gPSAzMzM7CiAgICB0LnNlbWljb2xvbiA9IDMzMzsKICAgIHQubGVzcyA9IDU4NDsKICAgIHQuZXF1YWwgPSA1ODQ7CiAgICB0LmdyZWF0ZXIgPSA1ODQ7CiAgICB0LnF1ZXN0aW9uID0gNjExOwogICAgdC5hdCA9IDk3NTsKICAgIHQuQSA9IDcyMjsKICAgIHQuQiA9IDcyMjsKICAgIHQuQyA9IDcyMjsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDY2NzsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDc3ODsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDI3ODsKICAgIHQuSiA9IDU1NjsKICAgIHQuSyA9IDcyMjsKICAgIHQuTCA9IDYxMTsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDcyMjsKICAgIHQuTyA9IDc3ODsKICAgIHQuUCA9IDY2NzsKICAgIHQuUSA9IDc3ODsKICAgIHQuUiA9IDcyMjsKICAgIHQuUyA9IDY2NzsKICAgIHQuVCA9IDYxMTsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDY2NzsKICAgIHQuVyA9IDk0NDsKICAgIHQuWCA9IDY2NzsKICAgIHQuWSA9IDY2NzsKICAgIHQuWiA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5hc2NpaWNpcmN1bSA9IDU4NDsKICAgIHQudW5kZXJzY29yZSA9IDU1NjsKICAgIHQucXVvdGVsZWZ0ID0gMjc4OwogICAgdC5hID0gNTU2OwogICAgdC5iID0gNjExOwogICAgdC5jID0gNTU2OwogICAgdC5kID0gNjExOwogICAgdC5lID0gNTU2OwogICAgdC5mID0gMzMzOwogICAgdC5nID0gNjExOwogICAgdC5oID0gNjExOwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMjc4OwogICAgdC5rID0gNTU2OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gODg5OwogICAgdC5uID0gNjExOwogICAgdC5vID0gNjExOwogICAgdC5wID0gNjExOwogICAgdC5xID0gNjExOwogICAgdC5yID0gMzg5OwogICAgdC5zID0gNTU2OwogICAgdC50ID0gMzMzOwogICAgdC51ID0gNjExOwogICAgdC52ID0gNTU2OwogICAgdC53ID0gNzc4OwogICAgdC54ID0gNTU2OwogICAgdC55ID0gNTU2OwogICAgdC56ID0gNTAwOwogICAgdC5icmFjZWxlZnQgPSAzODk7CiAgICB0LmJhciA9IDI4MDsKICAgIHQuYnJhY2VyaWdodCA9IDM4OTsKICAgIHQuYXNjaWl0aWxkZSA9IDU4NDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDU1NjsKICAgIHQuc3RlcmxpbmcgPSA1NTY7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1NTY7CiAgICB0LmZsb3JpbiA9IDU1NjsKICAgIHQuc2VjdGlvbiA9IDU1NjsKICAgIHQuY3VycmVuY3kgPSA1NTY7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjM4OwogICAgdC5xdW90ZWRibGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDYxMTsKICAgIHQuZmwgPSA2MTE7CiAgICB0LmVuZGFzaCA9IDU1NjsKICAgIHQuZGFnZ2VyID0gNTU2OwogICAgdC5kYWdnZXJkYmwgPSA1NTY7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjc4OwogICAgdC5wYXJhZ3JhcGggPSA1NTY7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAyNzg7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDUwMDsKICAgIHQucXVvdGVkYmxyaWdodCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1NTY7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA2MTE7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDM3MDsKICAgIHQuTHNsYXNoID0gNjExOwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzY1OwogICAgdC5hZSA9IDg4OTsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNjExOwogICAgdC5vZSA9IDk0NDsKICAgIHQuZ2VybWFuZGJscyA9IDYxMTsKICAgIHQuSWRpZXJlc2lzID0gMjc4OwogICAgdC5lYWN1dGUgPSA1NTY7CiAgICB0LmFicmV2ZSA9IDU1NjsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDYxMTsKICAgIHQuZWNhcm9uID0gNTU2OwogICAgdC5ZZGllcmVzaXMgPSA2Njc7CiAgICB0LmRpdmlkZSA9IDU4NDsKICAgIHQuWWFjdXRlID0gNjY3OwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNTU2OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTU2OwogICAgdC5zY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LmVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTU2OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA2MTE7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzM3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA1NTY7CiAgICB0LmFyaW5nID0gNTU2OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTU2OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTU2OwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSA1NTY7CiAgICB0LnNjZWRpbGxhID0gNTU2OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA1NTY7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjY3OwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDY2NzsKICAgIHQuZGNhcm9uID0gNzQzOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDYxMTsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMzMzsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1ODQ7CiAgICB0LnVhY3V0ZSA9IDYxMTsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNTU2OwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTU2OwogICAgdC5lZGllcmVzaXMgPSA1NTY7CiAgICB0LmNhY3V0ZSA9IDU1NjsKICAgIHQubmFjdXRlID0gNjExOwogICAgdC51bWFjcm9uID0gNjExOwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDI3ODsKICAgIHQucGx1c21pbnVzID0gNTg0OwogICAgdC5icm9rZW5iYXIgPSAyODA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3Mzc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDI3ODsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDYxMTsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzODk7CiAgICB0LmVvZ29uZWsgPSA1NTY7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA1NTY7CiAgICB0LnphY3V0ZSA9IDUwMDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA2MTE7CiAgICB0LmFtYWNyb24gPSA1NTY7CiAgICB0LnNhY3V0ZSA9IDU1NjsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA2MTE7CiAgICB0LnR3b3N1cGVyaW9yID0gMzMzOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNjExOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA2MTE7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDYxMTsKICAgIHQudGhyZWVxdWFydGVycyA9IDgzNDsKICAgIHQuU2NlZGlsbGEgPSA2Njc7CiAgICB0LmxjYXJvbiA9IDQwMDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA1NTY7CiAgICB0LklncmF2ZSA9IDI3ODsKICAgIHQuSW1hY3JvbiA9IDI3ODsKICAgIHQuTGNhcm9uID0gNjExOwogICAgdC5vbmVoYWxmID0gODM0OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNjExOwogICAgdC5udGlsZGUgPSA2MTE7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDU1NjsKICAgIHQuZ2JyZXZlID0gNjExOwogICAgdC5vbmVxdWFydGVyID0gODM0OwogICAgdC5TY2Fyb24gPSA2Njc7CiAgICB0LlNjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA2MTE7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNjExOwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA2MTE7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5BdGlsZGUgPSA3MjI7CiAgICB0LkFvZ29uZWsgPSA3MjI7CiAgICB0LkFyaW5nID0gNzIyOwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA1MDA7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDI3ODsKICAgIHQua2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5taW51cyA9IDU4NDsKICAgIHQuSWNpcmN1bWZsZXggPSAyNzg7CiAgICB0Lm5jYXJvbiA9IDYxMTsKICAgIHQudGNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5sb2dpY2Fsbm90ID0gNTg0OwogICAgdC5vZGllcmVzaXMgPSA2MTE7CiAgICB0LnVkaWVyZXNpcyA9IDYxMTsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuZXRoID0gNjExOwogICAgdC56Y2Fyb24gPSA1MDA7CiAgICB0Lm5jb21tYWFjY2VudCA9IDYxMTsKICAgIHQub25lc3VwZXJpb3IgPSAzMzM7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1NTY7CiAgfSk7CiAgdFsiSGVsdmV0aWNhLU9ibGlxdWUiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5leGNsYW0gPSAyNzg7CiAgICB0LnF1b3RlZGJsID0gMzU1OwogICAgdC5udW1iZXJzaWduID0gNTU2OwogICAgdC5kb2xsYXIgPSA1NTY7CiAgICB0LnBlcmNlbnQgPSA4ODk7CiAgICB0LmFtcGVyc2FuZCA9IDY2NzsKICAgIHQucXVvdGVyaWdodCA9IDIyMjsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3RlcmlzayA9IDM4OTsKICAgIHQucGx1cyA9IDU4NDsKICAgIHQuY29tbWEgPSAyNzg7CiAgICB0Lmh5cGhlbiA9IDMzMzsKICAgIHQucGVyaW9kID0gMjc4OwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDU1NjsKICAgIHQub25lID0gNTU2OwogICAgdC50d28gPSA1NTY7CiAgICB0LnRocmVlID0gNTU2OwogICAgdC5mb3VyID0gNTU2OwogICAgdC5maXZlID0gNTU2OwogICAgdC5zaXggPSA1NTY7CiAgICB0LnNldmVuID0gNTU2OwogICAgdC5laWdodCA9IDU1NjsKICAgIHQubmluZSA9IDU1NjsKICAgIHQuY29sb24gPSAyNzg7CiAgICB0LnNlbWljb2xvbiA9IDI3ODsKICAgIHQubGVzcyA9IDU4NDsKICAgIHQuZXF1YWwgPSA1ODQ7CiAgICB0LmdyZWF0ZXIgPSA1ODQ7CiAgICB0LnF1ZXN0aW9uID0gNTU2OwogICAgdC5hdCA9IDEwMTU7CiAgICB0LkEgPSA2Njc7CiAgICB0LkIgPSA2Njc7CiAgICB0LkMgPSA3MjI7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2Njc7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3Nzg7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAyNzg7CiAgICB0LkogPSA1MDA7CiAgICB0LksgPSA2Njc7CiAgICB0LkwgPSA1NTY7CiAgICB0Lk0gPSA4MzM7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3Nzg7CiAgICB0LlAgPSA2Njc7CiAgICB0LlEgPSA3Nzg7CiAgICB0LlIgPSA3MjI7CiAgICB0LlMgPSA2Njc7CiAgICB0LlQgPSA2MTE7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2Njc7CiAgICB0LlcgPSA5NDQ7CiAgICB0LlggPSA2Njc7CiAgICB0LlkgPSA2Njc7CiAgICB0LlogPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMjc4OwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDI3ODsKICAgIHQuYXNjaWljaXJjdW0gPSA0Njk7CiAgICB0LnVuZGVyc2NvcmUgPSA1NTY7CiAgICB0LnF1b3RlbGVmdCA9IDIyMjsKICAgIHQuYSA9IDU1NjsKICAgIHQuYiA9IDU1NjsKICAgIHQuYyA9IDUwMDsKICAgIHQuZCA9IDU1NjsKICAgIHQuZSA9IDU1NjsKICAgIHQuZiA9IDI3ODsKICAgIHQuZyA9IDU1NjsKICAgIHQuaCA9IDU1NjsKICAgIHQuaSA9IDIyMjsKICAgIHQuaiA9IDIyMjsKICAgIHQuayA9IDUwMDsKICAgIHQubCA9IDIyMjsKICAgIHQubSA9IDgzMzsKICAgIHQubiA9IDU1NjsKICAgIHQubyA9IDU1NjsKICAgIHQucCA9IDU1NjsKICAgIHQucSA9IDU1NjsKICAgIHQuciA9IDMzMzsKICAgIHQucyA9IDUwMDsKICAgIHQudCA9IDI3ODsKICAgIHQudSA9IDU1NjsKICAgIHQudiA9IDUwMDsKICAgIHQudyA9IDcyMjsKICAgIHQueCA9IDUwMDsKICAgIHQueSA9IDUwMDsKICAgIHQueiA9IDUwMDsKICAgIHQuYnJhY2VsZWZ0ID0gMzM0OwogICAgdC5iYXIgPSAyNjA7CiAgICB0LmJyYWNlcmlnaHQgPSAzMzQ7CiAgICB0LmFzY2lpdGlsZGUgPSA1ODQ7CiAgICB0LmV4Y2xhbWRvd24gPSAzMzM7CiAgICB0LmNlbnQgPSA1NTY7CiAgICB0LnN0ZXJsaW5nID0gNTU2OwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTU2OwogICAgdC5mbG9yaW4gPSA1NTY7CiAgICB0LnNlY3Rpb24gPSA1NTY7CiAgICB0LmN1cnJlbmN5ID0gNTU2OwogICAgdC5xdW90ZXNpbmdsZSA9IDE5MTsKICAgIHQucXVvdGVkYmxsZWZ0ID0gMzMzOwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTU2OwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA1MDA7CiAgICB0LmZsID0gNTAwOwogICAgdC5lbmRhc2ggPSA1NTY7CiAgICB0LmRhZ2dlciA9IDU1NjsKICAgIHQuZGFnZ2VyZGJsID0gNTU2OwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI3ODsKICAgIHQucGFyYWdyYXBoID0gNTM3OwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMjIyOwogICAgdC5xdW90ZWRibGJhc2UgPSAzMzM7CiAgICB0LnF1b3RlZGJscmlnaHQgPSAzMzM7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTU2OwogICAgdC5lbGxpcHNpcyA9IDEwMDA7CiAgICB0LnBlcnRob3VzYW5kID0gMTAwMDsKICAgIHQucXVlc3Rpb25kb3duID0gNjExOwogICAgdC5ncmF2ZSA9IDMzMzsKICAgIHQuYWN1dGUgPSAzMzM7CiAgICB0LmNpcmN1bWZsZXggPSAzMzM7CiAgICB0LnRpbGRlID0gMzMzOwogICAgdC5tYWNyb24gPSAzMzM7CiAgICB0LmJyZXZlID0gMzMzOwogICAgdC5kb3RhY2NlbnQgPSAzMzM7CiAgICB0LmRpZXJlc2lzID0gMzMzOwogICAgdC5yaW5nID0gMzMzOwogICAgdC5jZWRpbGxhID0gMzMzOwogICAgdC5odW5nYXJ1bWxhdXQgPSAzMzM7CiAgICB0Lm9nb25layA9IDMzMzsKICAgIHQuY2Fyb24gPSAzMzM7CiAgICB0LmVtZGFzaCA9IDEwMDA7CiAgICB0LkFFID0gMTAwMDsKICAgIHQub3JkZmVtaW5pbmUgPSAzNzA7CiAgICB0LkxzbGFzaCA9IDU1NjsKICAgIHQuT3NsYXNoID0gNzc4OwogICAgdC5PRSA9IDEwMDA7CiAgICB0Lm9yZG1hc2N1bGluZSA9IDM2NTsKICAgIHQuYWUgPSA4ODk7CiAgICB0LmRvdGxlc3NpID0gMjc4OwogICAgdC5sc2xhc2ggPSAyMjI7CiAgICB0Lm9zbGFzaCA9IDYxMTsKICAgIHQub2UgPSA5NDQ7CiAgICB0Lmdlcm1hbmRibHMgPSA2MTE7CiAgICB0LklkaWVyZXNpcyA9IDI3ODsKICAgIHQuZWFjdXRlID0gNTU2OwogICAgdC5hYnJldmUgPSA1NTY7CiAgICB0LnVodW5nYXJ1bWxhdXQgPSA1NTY7CiAgICB0LmVjYXJvbiA9IDU1NjsKICAgIHQuWWRpZXJlc2lzID0gNjY3OwogICAgdC5kaXZpZGUgPSA1ODQ7CiAgICB0LllhY3V0ZSA9IDY2NzsKICAgIHQuQWNpcmN1bWZsZXggPSA2Njc7CiAgICB0LmFhY3V0ZSA9IDU1NjsKICAgIHQuVWNpcmN1bWZsZXggPSA3MjI7CiAgICB0LnlhY3V0ZSA9IDUwMDsKICAgIHQuc2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5lY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuVXJpbmcgPSA3MjI7CiAgICB0LlVkaWVyZXNpcyA9IDcyMjsKICAgIHQuYW9nb25layA9IDU1NjsKICAgIHQuVWFjdXRlID0gNzIyOwogICAgdC51b2dvbmVrID0gNTU2OwogICAgdC5FZGllcmVzaXMgPSA2Njc7CiAgICB0LkRjcm9hdCA9IDcyMjsKICAgIHQuY29tbWFhY2NlbnQgPSAyNTA7CiAgICB0LmNvcHlyaWdodCA9IDczNzsKICAgIHQuRW1hY3JvbiA9IDY2NzsKICAgIHQuY2Nhcm9uID0gNTAwOwogICAgdC5hcmluZyA9IDU1NjsKICAgIHQuTmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5sYWN1dGUgPSAyMjI7CiAgICB0LmFncmF2ZSA9IDU1NjsKICAgIHQuVGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5DYWN1dGUgPSA3MjI7CiAgICB0LmF0aWxkZSA9IDU1NjsKICAgIHQuRWRvdGFjY2VudCA9IDY2NzsKICAgIHQuc2Nhcm9uID0gNTAwOwogICAgdC5zY2VkaWxsYSA9IDUwMDsKICAgIHQuaWFjdXRlID0gMjc4OwogICAgdC5sb3plbmdlID0gNDcxOwogICAgdC5SY2Fyb24gPSA3MjI7CiAgICB0Lkdjb21tYWFjY2VudCA9IDc3ODsKICAgIHQudWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LmFjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5BbWFjcm9uID0gNjY3OwogICAgdC5yY2Fyb24gPSAzMzM7CiAgICB0LmNjZWRpbGxhID0gNTAwOwogICAgdC5aZG90YWNjZW50ID0gNjExOwogICAgdC5UaG9ybiA9IDY2NzsKICAgIHQuT21hY3JvbiA9IDc3ODsKICAgIHQuUmFjdXRlID0gNzIyOwogICAgdC5TYWN1dGUgPSA2Njc7CiAgICB0LmRjYXJvbiA9IDY0MzsKICAgIHQuVW1hY3JvbiA9IDcyMjsKICAgIHQudXJpbmcgPSA1NTY7CiAgICB0LnRocmVlc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9ncmF2ZSA9IDc3ODsKICAgIHQuQWdyYXZlID0gNjY3OwogICAgdC5BYnJldmUgPSA2Njc7CiAgICB0Lm11bHRpcGx5ID0gNTg0OwogICAgdC51YWN1dGUgPSA1NTY7CiAgICB0LlRjYXJvbiA9IDYxMTsKICAgIHQucGFydGlhbGRpZmYgPSA0NzY7CiAgICB0LnlkaWVyZXNpcyA9IDUwMDsKICAgIHQuTmFjdXRlID0gNzIyOwogICAgdC5pY2lyY3VtZmxleCA9IDI3ODsKICAgIHQuRWNpcmN1bWZsZXggPSA2Njc7CiAgICB0LmFkaWVyZXNpcyA9IDU1NjsKICAgIHQuZWRpZXJlc2lzID0gNTU2OwogICAgdC5jYWN1dGUgPSA1MDA7CiAgICB0Lm5hY3V0ZSA9IDU1NjsKICAgIHQudW1hY3JvbiA9IDU1NjsKICAgIHQuTmNhcm9uID0gNzIyOwogICAgdC5JYWN1dGUgPSAyNzg7CiAgICB0LnBsdXNtaW51cyA9IDU4NDsKICAgIHQuYnJva2VuYmFyID0gMjYwOwogICAgdC5yZWdpc3RlcmVkID0gNzM3OwogICAgdC5HYnJldmUgPSA3Nzg7CiAgICB0Lklkb3RhY2NlbnQgPSAyNzg7CiAgICB0LnN1bW1hdGlvbiA9IDYwMDsKICAgIHQuRWdyYXZlID0gNjY3OwogICAgdC5yYWN1dGUgPSAzMzM7CiAgICB0Lm9tYWNyb24gPSA1NTY7CiAgICB0LlphY3V0ZSA9IDYxMTsKICAgIHQuWmNhcm9uID0gNjExOwogICAgdC5ncmVhdGVyZXF1YWwgPSA1NDk7CiAgICB0LkV0aCA9IDcyMjsKICAgIHQuQ2NlZGlsbGEgPSA3MjI7CiAgICB0Lmxjb21tYWFjY2VudCA9IDIyMjsKICAgIHQudGNhcm9uID0gMzE3OwogICAgdC5lb2dvbmVrID0gNTU2OwogICAgdC5Vb2dvbmVrID0gNzIyOwogICAgdC5BYWN1dGUgPSA2Njc7CiAgICB0LkFkaWVyZXNpcyA9IDY2NzsKICAgIHQuZWdyYXZlID0gNTU2OwogICAgdC56YWN1dGUgPSA1MDA7CiAgICB0LmlvZ29uZWsgPSAyMjI7CiAgICB0Lk9hY3V0ZSA9IDc3ODsKICAgIHQub2FjdXRlID0gNTU2OwogICAgdC5hbWFjcm9uID0gNTU2OwogICAgdC5zYWN1dGUgPSA1MDA7CiAgICB0LmlkaWVyZXNpcyA9IDI3ODsKICAgIHQuT2NpcmN1bWZsZXggPSA3Nzg7CiAgICB0LlVncmF2ZSA9IDcyMjsKICAgIHQuRGVsdGEgPSA2MTI7CiAgICB0LnRob3JuID0gNTU2OwogICAgdC50d29zdXBlcmlvciA9IDMzMzsKICAgIHQuT2RpZXJlc2lzID0gNzc4OwogICAgdC5tdSA9IDU1NjsKICAgIHQuaWdyYXZlID0gMjc4OwogICAgdC5vaHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5Fb2dvbmVrID0gNjY3OwogICAgdC5kY3JvYXQgPSA1NTY7CiAgICB0LnRocmVlcXVhcnRlcnMgPSA4MzQ7CiAgICB0LlNjZWRpbGxhID0gNjY3OwogICAgdC5sY2Fyb24gPSAyOTk7CiAgICB0Lktjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuTGFjdXRlID0gNTU2OwogICAgdC50cmFkZW1hcmsgPSAxMDAwOwogICAgdC5lZG90YWNjZW50ID0gNTU2OwogICAgdC5JZ3JhdmUgPSAyNzg7CiAgICB0LkltYWNyb24gPSAyNzg7CiAgICB0LkxjYXJvbiA9IDU1NjsKICAgIHQub25laGFsZiA9IDgzNDsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5vY2lyY3VtZmxleCA9IDU1NjsKICAgIHQubnRpbGRlID0gNTU2OwogICAgdC5VaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5FYWN1dGUgPSA2Njc7CiAgICB0LmVtYWNyb24gPSA1NTY7CiAgICB0LmdicmV2ZSA9IDU1NjsKICAgIHQub25lcXVhcnRlciA9IDgzNDsKICAgIHQuU2Nhcm9uID0gNjY3OwogICAgdC5TY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0Lk9odW5nYXJ1bWxhdXQgPSA3Nzg7CiAgICB0LmRlZ3JlZSA9IDQwMDsKICAgIHQub2dyYXZlID0gNTU2OwogICAgdC5DY2Fyb24gPSA3MjI7CiAgICB0LnVncmF2ZSA9IDU1NjsKICAgIHQucmFkaWNhbCA9IDQ1MzsKICAgIHQuRGNhcm9uID0gNzIyOwogICAgdC5yY29tbWFhY2NlbnQgPSAzMzM7CiAgICB0Lk50aWxkZSA9IDcyMjsKICAgIHQub3RpbGRlID0gNTU2OwogICAgdC5SY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0Lkxjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuQXRpbGRlID0gNjY3OwogICAgdC5Bb2dvbmVrID0gNjY3OwogICAgdC5BcmluZyA9IDY2NzsKICAgIHQuT3RpbGRlID0gNzc4OwogICAgdC56ZG90YWNjZW50ID0gNTAwOwogICAgdC5FY2Fyb24gPSA2Njc7CiAgICB0LklvZ29uZWsgPSAyNzg7CiAgICB0Lmtjb21tYWFjY2VudCA9IDUwMDsKICAgIHQubWludXMgPSA1ODQ7CiAgICB0LkljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5uY2Fyb24gPSA1NTY7CiAgICB0LnRjb21tYWFjY2VudCA9IDI3ODsKICAgIHQubG9naWNhbG5vdCA9IDU4NDsKICAgIHQub2RpZXJlc2lzID0gNTU2OwogICAgdC51ZGllcmVzaXMgPSA1NTY7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5nY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LmV0aCA9IDU1NjsKICAgIHQuemNhcm9uID0gNTAwOwogICAgdC5uY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0Lm9uZXN1cGVyaW9yID0gMzMzOwogICAgdC5pbWFjcm9uID0gMjc4OwogICAgdC5FdXJvID0gNTU2OwogIH0pOwogIHQuU3ltYm9sID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNTA7CiAgICB0LmV4Y2xhbSA9IDMzMzsKICAgIHQudW5pdmVyc2FsID0gNzEzOwogICAgdC5udW1iZXJzaWduID0gNTAwOwogICAgdC5leGlzdGVudGlhbCA9IDU0OTsKICAgIHQucGVyY2VudCA9IDgzMzsKICAgIHQuYW1wZXJzYW5kID0gNzc4OwogICAgdC5zdWNodGhhdCA9IDQzOTsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3Rlcmlza21hdGggPSA1MDA7CiAgICB0LnBsdXMgPSA1NDk7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5taW51cyA9IDU0OTsKICAgIHQucGVyaW9kID0gMjUwOwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDUwMDsKICAgIHQub25lID0gNTAwOwogICAgdC50d28gPSA1MDA7CiAgICB0LnRocmVlID0gNTAwOwogICAgdC5mb3VyID0gNTAwOwogICAgdC5maXZlID0gNTAwOwogICAgdC5zaXggPSA1MDA7CiAgICB0LnNldmVuID0gNTAwOwogICAgdC5laWdodCA9IDUwMDsKICAgIHQubmluZSA9IDUwMDsKICAgIHQuY29sb24gPSAyNzg7CiAgICB0LnNlbWljb2xvbiA9IDI3ODsKICAgIHQubGVzcyA9IDU0OTsKICAgIHQuZXF1YWwgPSA1NDk7CiAgICB0LmdyZWF0ZXIgPSA1NDk7CiAgICB0LnF1ZXN0aW9uID0gNDQ0OwogICAgdC5jb25ncnVlbnQgPSA1NDk7CiAgICB0LkFscGhhID0gNzIyOwogICAgdC5CZXRhID0gNjY3OwogICAgdC5DaGkgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC5FcHNpbG9uID0gNjExOwogICAgdC5QaGkgPSA3NjM7CiAgICB0LkdhbW1hID0gNjAzOwogICAgdC5FdGEgPSA3MjI7CiAgICB0LklvdGEgPSAzMzM7CiAgICB0LnRoZXRhMSA9IDYzMTsKICAgIHQuS2FwcGEgPSA3MjI7CiAgICB0LkxhbWJkYSA9IDY4NjsKICAgIHQuTXUgPSA4ODk7CiAgICB0Lk51ID0gNzIyOwogICAgdC5PbWljcm9uID0gNzIyOwogICAgdC5QaSA9IDc2ODsKICAgIHQuVGhldGEgPSA3NDE7CiAgICB0LlJobyA9IDU1NjsKICAgIHQuU2lnbWEgPSA1OTI7CiAgICB0LlRhdSA9IDYxMTsKICAgIHQuVXBzaWxvbiA9IDY5MDsKICAgIHQuc2lnbWExID0gNDM5OwogICAgdC5PbWVnYSA9IDc2ODsKICAgIHQuWGkgPSA2NDU7CiAgICB0LlBzaSA9IDc5NTsKICAgIHQuWmV0YSA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LnRoZXJlZm9yZSA9IDg2MzsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5wZXJwZW5kaWN1bGFyID0gNjU4OwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5yYWRpY2FsZXggPSA1MDA7CiAgICB0LmFscGhhID0gNjMxOwogICAgdC5iZXRhID0gNTQ5OwogICAgdC5jaGkgPSA1NDk7CiAgICB0LmRlbHRhID0gNDk0OwogICAgdC5lcHNpbG9uID0gNDM5OwogICAgdC5waGkgPSA1MjE7CiAgICB0LmdhbW1hID0gNDExOwogICAgdC5ldGEgPSA2MDM7CiAgICB0LmlvdGEgPSAzMjk7CiAgICB0LnBoaTEgPSA2MDM7CiAgICB0LmthcHBhID0gNTQ5OwogICAgdC5sYW1iZGEgPSA1NDk7CiAgICB0Lm11ID0gNTc2OwogICAgdC5udSA9IDUyMTsKICAgIHQub21pY3JvbiA9IDU0OTsKICAgIHQucGkgPSA1NDk7CiAgICB0LnRoZXRhID0gNTIxOwogICAgdC5yaG8gPSA1NDk7CiAgICB0LnNpZ21hID0gNjAzOwogICAgdC50YXUgPSA0Mzk7CiAgICB0LnVwc2lsb24gPSA1NzY7CiAgICB0Lm9tZWdhMSA9IDcxMzsKICAgIHQub21lZ2EgPSA2ODY7CiAgICB0LnhpID0gNDkzOwogICAgdC5wc2kgPSA2ODY7CiAgICB0LnpldGEgPSA0OTQ7CiAgICB0LmJyYWNlbGVmdCA9IDQ4MDsKICAgIHQuYmFyID0gMjAwOwogICAgdC5icmFjZXJpZ2h0ID0gNDgwOwogICAgdC5zaW1pbGFyID0gNTQ5OwogICAgdC5FdXJvID0gNzUwOwogICAgdC5VcHNpbG9uMSA9IDYyMDsKICAgIHQubWludXRlID0gMjQ3OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC5pbmZpbml0eSA9IDcxMzsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5jbHViID0gNzUzOwogICAgdC5kaWFtb25kID0gNzUzOwogICAgdC5oZWFydCA9IDc1MzsKICAgIHQuc3BhZGUgPSA3NTM7CiAgICB0LmFycm93Ym90aCA9IDEwNDI7CiAgICB0LmFycm93bGVmdCA9IDk4NzsKICAgIHQuYXJyb3d1cCA9IDYwMzsKICAgIHQuYXJyb3dyaWdodCA9IDk4NzsKICAgIHQuYXJyb3dkb3duID0gNjAzOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0LnBsdXNtaW51cyA9IDU0OTsKICAgIHQuc2Vjb25kID0gNDExOwogICAgdC5ncmVhdGVyZXF1YWwgPSA1NDk7CiAgICB0Lm11bHRpcGx5ID0gNTQ5OwogICAgdC5wcm9wb3J0aW9uYWwgPSA3MTM7CiAgICB0LnBhcnRpYWxkaWZmID0gNDk0OwogICAgdC5idWxsZXQgPSA0NjA7CiAgICB0LmRpdmlkZSA9IDU0OTsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0LmVxdWl2YWxlbmNlID0gNTQ5OwogICAgdC5hcHByb3hlcXVhbCA9IDU0OTsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5hcnJvd3ZlcnRleCA9IDYwMzsKICAgIHQuYXJyb3dob3JpemV4ID0gMTAwMDsKICAgIHQuY2FycmlhZ2VyZXR1cm4gPSA2NTg7CiAgICB0LmFsZXBoID0gODIzOwogICAgdC5JZnJha3R1ciA9IDY4NjsKICAgIHQuUmZyYWt0dXIgPSA3OTU7CiAgICB0LndlaWVyc3RyYXNzID0gOTg3OwogICAgdC5jaXJjbGVtdWx0aXBseSA9IDc2ODsKICAgIHQuY2lyY2xlcGx1cyA9IDc2ODsKICAgIHQuZW1wdHlzZXQgPSA4MjM7CiAgICB0LmludGVyc2VjdGlvbiA9IDc2ODsKICAgIHQudW5pb24gPSA3Njg7CiAgICB0LnByb3BlcnN1cGVyc2V0ID0gNzEzOwogICAgdC5yZWZsZXhzdXBlcnNldCA9IDcxMzsKICAgIHQubm90c3Vic2V0ID0gNzEzOwogICAgdC5wcm9wZXJzdWJzZXQgPSA3MTM7CiAgICB0LnJlZmxleHN1YnNldCA9IDcxMzsKICAgIHQuZWxlbWVudCA9IDcxMzsKICAgIHQubm90ZWxlbWVudCA9IDcxMzsKICAgIHQuYW5nbGUgPSA3Njg7CiAgICB0LmdyYWRpZW50ID0gNzEzOwogICAgdC5yZWdpc3RlcnNlcmlmID0gNzkwOwogICAgdC5jb3B5cmlnaHRzZXJpZiA9IDc5MDsKICAgIHQudHJhZGVtYXJrc2VyaWYgPSA4OTA7CiAgICB0LnByb2R1Y3QgPSA4MjM7CiAgICB0LnJhZGljYWwgPSA1NDk7CiAgICB0LmRvdG1hdGggPSAyNTA7CiAgICB0LmxvZ2ljYWxub3QgPSA3MTM7CiAgICB0LmxvZ2ljYWxhbmQgPSA2MDM7CiAgICB0LmxvZ2ljYWxvciA9IDYwMzsKICAgIHQuYXJyb3dkYmxib3RoID0gMTA0MjsKICAgIHQuYXJyb3dkYmxsZWZ0ID0gOTg3OwogICAgdC5hcnJvd2RibHVwID0gNjAzOwogICAgdC5hcnJvd2RibHJpZ2h0ID0gOTg3OwogICAgdC5hcnJvd2RibGRvd24gPSA2MDM7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LmFuZ2xlbGVmdCA9IDMyOTsKICAgIHQucmVnaXN0ZXJzYW5zID0gNzkwOwogICAgdC5jb3B5cmlnaHRzYW5zID0gNzkwOwogICAgdC50cmFkZW1hcmtzYW5zID0gNzg2OwogICAgdC5zdW1tYXRpb24gPSA3MTM7CiAgICB0LnBhcmVubGVmdHRwID0gMzg0OwogICAgdC5wYXJlbmxlZnRleCA9IDM4NDsKICAgIHQucGFyZW5sZWZ0YnQgPSAzODQ7CiAgICB0LmJyYWNrZXRsZWZ0dHAgPSAzODQ7CiAgICB0LmJyYWNrZXRsZWZ0ZXggPSAzODQ7CiAgICB0LmJyYWNrZXRsZWZ0YnQgPSAzODQ7CiAgICB0LmJyYWNlbGVmdHRwID0gNDk0OwogICAgdC5icmFjZWxlZnRtaWQgPSA0OTQ7CiAgICB0LmJyYWNlbGVmdGJ0ID0gNDk0OwogICAgdC5icmFjZWV4ID0gNDk0OwogICAgdC5hbmdsZXJpZ2h0ID0gMzI5OwogICAgdC5pbnRlZ3JhbCA9IDI3NDsKICAgIHQuaW50ZWdyYWx0cCA9IDY4NjsKICAgIHQuaW50ZWdyYWxleCA9IDY4NjsKICAgIHQuaW50ZWdyYWxidCA9IDY4NjsKICAgIHQucGFyZW5yaWdodHRwID0gMzg0OwogICAgdC5wYXJlbnJpZ2h0ZXggPSAzODQ7CiAgICB0LnBhcmVucmlnaHRidCA9IDM4NDsKICAgIHQuYnJhY2tldHJpZ2h0dHAgPSAzODQ7CiAgICB0LmJyYWNrZXRyaWdodGV4ID0gMzg0OwogICAgdC5icmFja2V0cmlnaHRidCA9IDM4NDsKICAgIHQuYnJhY2VyaWdodHRwID0gNDk0OwogICAgdC5icmFjZXJpZ2h0bWlkID0gNDk0OwogICAgdC5icmFjZXJpZ2h0YnQgPSA0OTQ7CiAgICB0LmFwcGxlID0gNzkwOwogIH0pOwogIHRbIlRpbWVzLVJvbWFuIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDQwODsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gODMzOwogICAgdC5hbXBlcnNhbmQgPSA3Nzg7CiAgICB0LnF1b3RlcmlnaHQgPSAzMzM7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSA1MDA7CiAgICB0LnBsdXMgPSA1NjQ7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1NjQ7CiAgICB0LmVxdWFsID0gNTY0OwogICAgdC5ncmVhdGVyID0gNTY0OwogICAgdC5xdWVzdGlvbiA9IDQ0NDsKICAgIHQuYXQgPSA5MjE7CiAgICB0LkEgPSA3MjI7CiAgICB0LkIgPSA2Njc7CiAgICB0LkMgPSA2Njc7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2MTE7CiAgICB0LkYgPSA1NTY7CiAgICB0LkcgPSA3MjI7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAzMzM7CiAgICB0LkogPSAzODk7CiAgICB0LksgPSA3MjI7CiAgICB0LkwgPSA2MTE7CiAgICB0Lk0gPSA4ODk7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3MjI7CiAgICB0LlAgPSA1NTY7CiAgICB0LlEgPSA3MjI7CiAgICB0LlIgPSA2Njc7CiAgICB0LlMgPSA1NTY7CiAgICB0LlQgPSA2MTE7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA3MjI7CiAgICB0LlcgPSA5NDQ7CiAgICB0LlggPSA3MjI7CiAgICB0LlkgPSA3MjI7CiAgICB0LlogPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQuYXNjaWljaXJjdW0gPSA0Njk7CiAgICB0LnVuZGVyc2NvcmUgPSA1MDA7CiAgICB0LnF1b3RlbGVmdCA9IDMzMzsKICAgIHQuYSA9IDQ0NDsKICAgIHQuYiA9IDUwMDsKICAgIHQuYyA9IDQ0NDsKICAgIHQuZCA9IDUwMDsKICAgIHQuZSA9IDQ0NDsKICAgIHQuZiA9IDMzMzsKICAgIHQuZyA9IDUwMDsKICAgIHQuaCA9IDUwMDsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDUwMDsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDc3ODsKICAgIHQubiA9IDUwMDsKICAgIHQubyA9IDUwMDsKICAgIHQucCA9IDUwMDsKICAgIHQucSA9IDUwMDsKICAgIHQuciA9IDMzMzsKICAgIHQucyA9IDM4OTsKICAgIHQudCA9IDI3ODsKICAgIHQudSA9IDUwMDsKICAgIHQudiA9IDUwMDsKICAgIHQudyA9IDcyMjsKICAgIHQueCA9IDUwMDsKICAgIHQueSA9IDUwMDsKICAgIHQueiA9IDQ0NDsKICAgIHQuYnJhY2VsZWZ0ID0gNDgwOwogICAgdC5iYXIgPSAyMDA7CiAgICB0LmJyYWNlcmlnaHQgPSA0ODA7CiAgICB0LmFzY2lpdGlsZGUgPSA1NDE7CiAgICB0LmV4Y2xhbWRvd24gPSAzMzM7CiAgICB0LmNlbnQgPSA1MDA7CiAgICB0LnN0ZXJsaW5nID0gNTAwOwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTAwOwogICAgdC5mbG9yaW4gPSA1MDA7CiAgICB0LnNlY3Rpb24gPSA1MDA7CiAgICB0LmN1cnJlbmN5ID0gNTAwOwogICAgdC5xdW90ZXNpbmdsZSA9IDE4MDsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNDQ0OwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTAwOwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA1NTY7CiAgICB0LmZsID0gNTU2OwogICAgdC5lbmRhc2ggPSA1MDA7CiAgICB0LmRhZ2dlciA9IDUwMDsKICAgIHQuZGFnZ2VyZGJsID0gNTAwOwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI1MDsKICAgIHQucGFyYWdyYXBoID0gNDUzOwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibGJhc2UgPSA0NDQ7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA0NDQ7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTAwOwogICAgdC5lbGxpcHNpcyA9IDEwMDA7CiAgICB0LnBlcnRob3VzYW5kID0gMTAwMDsKICAgIHQucXVlc3Rpb25kb3duID0gNDQ0OwogICAgdC5ncmF2ZSA9IDMzMzsKICAgIHQuYWN1dGUgPSAzMzM7CiAgICB0LmNpcmN1bWZsZXggPSAzMzM7CiAgICB0LnRpbGRlID0gMzMzOwogICAgdC5tYWNyb24gPSAzMzM7CiAgICB0LmJyZXZlID0gMzMzOwogICAgdC5kb3RhY2NlbnQgPSAzMzM7CiAgICB0LmRpZXJlc2lzID0gMzMzOwogICAgdC5yaW5nID0gMzMzOwogICAgdC5jZWRpbGxhID0gMzMzOwogICAgdC5odW5nYXJ1bWxhdXQgPSAzMzM7CiAgICB0Lm9nb25layA9IDMzMzsKICAgIHQuY2Fyb24gPSAzMzM7CiAgICB0LmVtZGFzaCA9IDEwMDA7CiAgICB0LkFFID0gODg5OwogICAgdC5vcmRmZW1pbmluZSA9IDI3NjsKICAgIHQuTHNsYXNoID0gNjExOwogICAgdC5Pc2xhc2ggPSA3MjI7CiAgICB0Lk9FID0gODg5OwogICAgdC5vcmRtYXNjdWxpbmUgPSAzMTA7CiAgICB0LmFlID0gNjY3OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjc4OwogICAgdC5vc2xhc2ggPSA1MDA7CiAgICB0Lm9lID0gNzIyOwogICAgdC5nZXJtYW5kYmxzID0gNTAwOwogICAgdC5JZGllcmVzaXMgPSAzMzM7CiAgICB0LmVhY3V0ZSA9IDQ0NDsKICAgIHQuYWJyZXZlID0gNDQ0OwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTAwOwogICAgdC5lY2Fyb24gPSA0NDQ7CiAgICB0LllkaWVyZXNpcyA9IDcyMjsKICAgIHQuZGl2aWRlID0gNTY0OwogICAgdC5ZYWN1dGUgPSA3MjI7CiAgICB0LkFjaXJjdW1mbGV4ID0gNzIyOwogICAgdC5hYWN1dGUgPSA0NDQ7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1MDA7CiAgICB0LnNjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuZWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA0NDQ7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDUwMDsKICAgIHQuRWRpZXJlc2lzID0gNjExOwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3NjA7CiAgICB0LkVtYWNyb24gPSA2MTE7CiAgICB0LmNjYXJvbiA9IDQ0NDsKICAgIHQuYXJpbmcgPSA0NDQ7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjc4OwogICAgdC5hZ3JhdmUgPSA0NDQ7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNjY3OwogICAgdC5hdGlsZGUgPSA0NDQ7CiAgICB0LkVkb3RhY2NlbnQgPSA2MTE7CiAgICB0LnNjYXJvbiA9IDM4OTsKICAgIHQuc2NlZGlsbGEgPSAzODk7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ3MTsKICAgIHQuUmNhcm9uID0gNjY3OwogICAgdC5HY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTAwOwogICAgdC5hY2lyY3VtZmxleCA9IDQ0NDsKICAgIHQuQW1hY3JvbiA9IDcyMjsKICAgIHQucmNhcm9uID0gMzMzOwogICAgdC5jY2VkaWxsYSA9IDQ0NDsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA1NTY7CiAgICB0Lk9tYWNyb24gPSA3MjI7CiAgICB0LlJhY3V0ZSA9IDY2NzsKICAgIHQuU2FjdXRlID0gNTU2OwogICAgdC5kY2Fyb24gPSA1ODg7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTAwOwogICAgdC50aHJlZXN1cGVyaW9yID0gMzAwOwogICAgdC5PZ3JhdmUgPSA3MjI7CiAgICB0LkFncmF2ZSA9IDcyMjsKICAgIHQuQWJyZXZlID0gNzIyOwogICAgdC5tdWx0aXBseSA9IDU2NDsKICAgIHQudWFjdXRlID0gNTAwOwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDc2OwogICAgdC55ZGllcmVzaXMgPSA1MDA7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjExOwogICAgdC5hZGllcmVzaXMgPSA0NDQ7CiAgICB0LmVkaWVyZXNpcyA9IDQ0NDsKICAgIHQuY2FjdXRlID0gNDQ0OwogICAgdC5uYWN1dGUgPSA1MDA7CiAgICB0LnVtYWNyb24gPSA1MDA7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMzMzOwogICAgdC5wbHVzbWludXMgPSA1NjQ7CiAgICB0LmJyb2tlbmJhciA9IDIwMDsKICAgIHQucmVnaXN0ZXJlZCA9IDc2MDsKICAgIHQuR2JyZXZlID0gNzIyOwogICAgdC5JZG90YWNjZW50ID0gMzMzOwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDYxMTsKICAgIHQucmFjdXRlID0gMzMzOwogICAgdC5vbWFjcm9uID0gNTAwOwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNjY3OwogICAgdC5sY29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LnRjYXJvbiA9IDMyNjsKICAgIHQuZW9nb25layA9IDQ0NDsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNzIyOwogICAgdC5BZGllcmVzaXMgPSA3MjI7CiAgICB0LmVncmF2ZSA9IDQ0NDsKICAgIHQuemFjdXRlID0gNDQ0OwogICAgdC5pb2dvbmVrID0gMjc4OwogICAgdC5PYWN1dGUgPSA3MjI7CiAgICB0Lm9hY3V0ZSA9IDUwMDsKICAgIHQuYW1hY3JvbiA9IDQ0NDsKICAgIHQuc2FjdXRlID0gMzg5OwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzIyOwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDUwMDsKICAgIHQudHdvc3VwZXJpb3IgPSAzMDA7CiAgICB0Lk9kaWVyZXNpcyA9IDcyMjsKICAgIHQubXUgPSA1MDA7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuRW9nb25layA9IDYxMTsKICAgIHQuZGNyb2F0ID0gNTAwOwogICAgdC50aHJlZXF1YXJ0ZXJzID0gNzUwOwogICAgdC5TY2VkaWxsYSA9IDU1NjsKICAgIHQubGNhcm9uID0gMzQ0OwogICAgdC5LY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LkxhY3V0ZSA9IDYxMTsKICAgIHQudHJhZGVtYXJrID0gOTgwOwogICAgdC5lZG90YWNjZW50ID0gNDQ0OwogICAgdC5JZ3JhdmUgPSAzMzM7CiAgICB0LkltYWNyb24gPSAzMzM7CiAgICB0LkxjYXJvbiA9IDYxMTsKICAgIHQub25laGFsZiA9IDc1MDsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5vY2lyY3VtZmxleCA9IDUwMDsKICAgIHQubnRpbGRlID0gNTAwOwogICAgdC5VaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5FYWN1dGUgPSA2MTE7CiAgICB0LmVtYWNyb24gPSA0NDQ7CiAgICB0LmdicmV2ZSA9IDUwMDsKICAgIHQub25lcXVhcnRlciA9IDc1MDsKICAgIHQuU2Nhcm9uID0gNTU2OwogICAgdC5TY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0Lk9odW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LmRlZ3JlZSA9IDQwMDsKICAgIHQub2dyYXZlID0gNTAwOwogICAgdC5DY2Fyb24gPSA2Njc7CiAgICB0LnVncmF2ZSA9IDUwMDsKICAgIHQucmFkaWNhbCA9IDQ1MzsKICAgIHQuRGNhcm9uID0gNzIyOwogICAgdC5yY29tbWFhY2NlbnQgPSAzMzM7CiAgICB0Lk50aWxkZSA9IDcyMjsKICAgIHQub3RpbGRlID0gNTAwOwogICAgdC5SY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0Lkxjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQXRpbGRlID0gNzIyOwogICAgdC5Bb2dvbmVrID0gNzIyOwogICAgdC5BcmluZyA9IDcyMjsKICAgIHQuT3RpbGRlID0gNzIyOwogICAgdC56ZG90YWNjZW50ID0gNDQ0OwogICAgdC5FY2Fyb24gPSA2MTE7CiAgICB0LklvZ29uZWsgPSAzMzM7CiAgICB0Lmtjb21tYWFjY2VudCA9IDUwMDsKICAgIHQubWludXMgPSA1NjQ7CiAgICB0LkljaXJjdW1mbGV4ID0gMzMzOwogICAgdC5uY2Fyb24gPSA1MDA7CiAgICB0LnRjb21tYWFjY2VudCA9IDI3ODsKICAgIHQubG9naWNhbG5vdCA9IDU2NDsKICAgIHQub2RpZXJlc2lzID0gNTAwOwogICAgdC51ZGllcmVzaXMgPSA1MDA7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5nY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0LmV0aCA9IDUwMDsKICAgIHQuemNhcm9uID0gNDQ0OwogICAgdC5uY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm9uZXN1cGVyaW9yID0gMzAwOwogICAgdC5pbWFjcm9uID0gMjc4OwogICAgdC5FdXJvID0gNTAwOwogIH0pOwogIHRbIlRpbWVzLUJvbGQiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjUwOwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnF1b3RlZGJsID0gNTU1OwogICAgdC5udW1iZXJzaWduID0gNTAwOwogICAgdC5kb2xsYXIgPSA1MDA7CiAgICB0LnBlcmNlbnQgPSAxMDAwOwogICAgdC5hbXBlcnNhbmQgPSA4MzM7CiAgICB0LnF1b3RlcmlnaHQgPSAzMzM7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSA1MDA7CiAgICB0LnBsdXMgPSA1NzA7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA1NzA7CiAgICB0LmVxdWFsID0gNTcwOwogICAgdC5ncmVhdGVyID0gNTcwOwogICAgdC5xdWVzdGlvbiA9IDUwMDsKICAgIHQuYXQgPSA5MzA7CiAgICB0LkEgPSA3MjI7CiAgICB0LkIgPSA2Njc7CiAgICB0LkMgPSA3MjI7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2Njc7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3Nzg7CiAgICB0LkggPSA3Nzg7CiAgICB0LkkgPSAzODk7CiAgICB0LkogPSA1MDA7CiAgICB0LksgPSA3Nzg7CiAgICB0LkwgPSA2Njc7CiAgICB0Lk0gPSA5NDQ7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3Nzg7CiAgICB0LlAgPSA2MTE7CiAgICB0LlEgPSA3Nzg7CiAgICB0LlIgPSA3MjI7CiAgICB0LlMgPSA1NTY7CiAgICB0LlQgPSA2Njc7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA3MjI7CiAgICB0LlcgPSAxMDAwOwogICAgdC5YID0gNzIyOwogICAgdC5ZID0gNzIyOwogICAgdC5aID0gNjY3OwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNTgxOwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5xdW90ZWxlZnQgPSAzMzM7CiAgICB0LmEgPSA1MDA7CiAgICB0LmIgPSA1NTY7CiAgICB0LmMgPSA0NDQ7CiAgICB0LmQgPSA1NTY7CiAgICB0LmUgPSA0NDQ7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA1MDA7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAzMzM7CiAgICB0LmsgPSA1NTY7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA4MzM7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1MDA7CiAgICB0LnAgPSA1NTY7CiAgICB0LnEgPSA1NTY7CiAgICB0LnIgPSA0NDQ7CiAgICB0LnMgPSAzODk7CiAgICB0LnQgPSAzMzM7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA0NDQ7CiAgICB0LmJyYWNlbGVmdCA9IDM5NDsKICAgIHQuYmFyID0gMjIwOwogICAgdC5icmFjZXJpZ2h0ID0gMzk0OwogICAgdC5hc2NpaXRpbGRlID0gNTIwOwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTAwOwogICAgdC5zdGVybGluZyA9IDUwMDsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDUwMDsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5zZWN0aW9uID0gNTAwOwogICAgdC5jdXJyZW5jeSA9IDUwMDsKICAgIHQucXVvdGVzaW5nbGUgPSAyNzg7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDUwMDsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTU2OwogICAgdC5mbCA9IDU1NjsKICAgIHQuZW5kYXNoID0gNTAwOwogICAgdC5kYWdnZXIgPSA1MDA7CiAgICB0LmRhZ2dlcmRibCA9IDUwMDsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNTA7CiAgICB0LnBhcmFncmFwaCA9IDU0MDsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxiYXNlID0gNTAwOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDUwMDsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDUwMDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDEwMDA7CiAgICB0Lm9yZGZlbWluaW5lID0gMzAwOwogICAgdC5Mc2xhc2ggPSA2Njc7CiAgICB0Lk9zbGFzaCA9IDc3ODsKICAgIHQuT0UgPSAxMDAwOwogICAgdC5vcmRtYXNjdWxpbmUgPSAzMzA7CiAgICB0LmFlID0gNzIyOwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjc4OwogICAgdC5vc2xhc2ggPSA1MDA7CiAgICB0Lm9lID0gNzIyOwogICAgdC5nZXJtYW5kYmxzID0gNTU2OwogICAgdC5JZGllcmVzaXMgPSAzODk7CiAgICB0LmVhY3V0ZSA9IDQ0NDsKICAgIHQuYWJyZXZlID0gNTAwOwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5lY2Fyb24gPSA0NDQ7CiAgICB0LllkaWVyZXNpcyA9IDcyMjsKICAgIHQuZGl2aWRlID0gNTcwOwogICAgdC5ZYWN1dGUgPSA3MjI7CiAgICB0LkFjaXJjdW1mbGV4ID0gNzIyOwogICAgdC5hYWN1dGUgPSA1MDA7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1MDA7CiAgICB0LnNjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuZWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1MDA7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDU1NjsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3NDc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDQ0NDsKICAgIHQuYXJpbmcgPSA1MDA7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjc4OwogICAgdC5hZ3JhdmUgPSA1MDA7CiAgICB0LlRjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuQ2FjdXRlID0gNzIyOwogICAgdC5hdGlsZGUgPSA1MDA7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDM4OTsKICAgIHQuc2NlZGlsbGEgPSAzODk7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ5NDsKICAgIHQuUmNhcm9uID0gNzIyOwogICAgdC5HY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5hY2lyY3VtZmxleCA9IDUwMDsKICAgIHQuQW1hY3JvbiA9IDcyMjsKICAgIHQucmNhcm9uID0gNDQ0OwogICAgdC5jY2VkaWxsYSA9IDQ0NDsKICAgIHQuWmRvdGFjY2VudCA9IDY2NzsKICAgIHQuVGhvcm4gPSA2MTE7CiAgICB0Lk9tYWNyb24gPSA3Nzg7CiAgICB0LlJhY3V0ZSA9IDcyMjsKICAgIHQuU2FjdXRlID0gNTU2OwogICAgdC5kY2Fyb24gPSA2NzI7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTU2OwogICAgdC50aHJlZXN1cGVyaW9yID0gMzAwOwogICAgdC5PZ3JhdmUgPSA3Nzg7CiAgICB0LkFncmF2ZSA9IDcyMjsKICAgIHQuQWJyZXZlID0gNzIyOwogICAgdC5tdWx0aXBseSA9IDU3MDsKICAgIHQudWFjdXRlID0gNTU2OwogICAgdC5UY2Fyb24gPSA2Njc7CiAgICB0LnBhcnRpYWxkaWZmID0gNDk0OwogICAgdC55ZGllcmVzaXMgPSA1MDA7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1MDA7CiAgICB0LmVkaWVyZXNpcyA9IDQ0NDsKICAgIHQuY2FjdXRlID0gNDQ0OwogICAgdC5uYWN1dGUgPSA1NTY7CiAgICB0LnVtYWNyb24gPSA1NTY7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMzg5OwogICAgdC5wbHVzbWludXMgPSA1NzA7CiAgICB0LmJyb2tlbmJhciA9IDIyMDsKICAgIHQucmVnaXN0ZXJlZCA9IDc0NzsKICAgIHQuR2JyZXZlID0gNzc4OwogICAgdC5JZG90YWNjZW50ID0gMzg5OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gNDQ0OwogICAgdC5vbWFjcm9uID0gNTAwOwogICAgdC5aYWN1dGUgPSA2Njc7CiAgICB0LlpjYXJvbiA9IDY2NzsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNzIyOwogICAgdC5sY29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LnRjYXJvbiA9IDQxNjsKICAgIHQuZW9nb25layA9IDQ0NDsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNzIyOwogICAgdC5BZGllcmVzaXMgPSA3MjI7CiAgICB0LmVncmF2ZSA9IDQ0NDsKICAgIHQuemFjdXRlID0gNDQ0OwogICAgdC5pb2dvbmVrID0gMjc4OwogICAgdC5PYWN1dGUgPSA3Nzg7CiAgICB0Lm9hY3V0ZSA9IDUwMDsKICAgIHQuYW1hY3JvbiA9IDUwMDsKICAgIHQuc2FjdXRlID0gMzg5OwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzc4OwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDU1NjsKICAgIHQudHdvc3VwZXJpb3IgPSAzMDA7CiAgICB0Lk9kaWVyZXNpcyA9IDc3ODsKICAgIHQubXUgPSA1NTY7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNTU2OwogICAgdC50aHJlZXF1YXJ0ZXJzID0gNzUwOwogICAgdC5TY2VkaWxsYSA9IDU1NjsKICAgIHQubGNhcm9uID0gMzk0OwogICAgdC5LY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LkxhY3V0ZSA9IDY2NzsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzg5OwogICAgdC5JbWFjcm9uID0gMzg5OwogICAgdC5MY2Fyb24gPSA2Njc7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDU1NjsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDU1NjsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzc4OwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNzIyOwogICAgdC51Z3JhdmUgPSA1NTY7CiAgICB0LnJhZGljYWwgPSA1NDk7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gNDQ0OwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkF0aWxkZSA9IDcyMjsKICAgIHQuQW9nb25layA9IDcyMjsKICAgIHQuQXJpbmcgPSA3MjI7CiAgICB0Lk90aWxkZSA9IDc3ODsKICAgIHQuemRvdGFjY2VudCA9IDQ0NDsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMzg5OwogICAgdC5rY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0Lm1pbnVzID0gNTcwOwogICAgdC5JY2lyY3VtZmxleCA9IDM4OTsKICAgIHQubmNhcm9uID0gNTU2OwogICAgdC50Y29tbWFhY2NlbnQgPSAzMzM7CiAgICB0LmxvZ2ljYWxub3QgPSA1NzA7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTU2OwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDQ0NDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0WyJUaW1lcy1Cb2xkSXRhbGljIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzg5OwogICAgdC5xdW90ZWRibCA9IDU1NTsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gODMzOwogICAgdC5hbXBlcnNhbmQgPSA3Nzg7CiAgICB0LnF1b3RlcmlnaHQgPSAzMzM7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSA1MDA7CiAgICB0LnBsdXMgPSA1NzA7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA1NzA7CiAgICB0LmVxdWFsID0gNTcwOwogICAgdC5ncmVhdGVyID0gNTcwOwogICAgdC5xdWVzdGlvbiA9IDUwMDsKICAgIHQuYXQgPSA4MzI7CiAgICB0LkEgPSA2Njc7CiAgICB0LkIgPSA2Njc7CiAgICB0LkMgPSA2Njc7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2Njc7CiAgICB0LkYgPSA2Njc7CiAgICB0LkcgPSA3MjI7CiAgICB0LkggPSA3Nzg7CiAgICB0LkkgPSAzODk7CiAgICB0LkogPSA1MDA7CiAgICB0LksgPSA2Njc7CiAgICB0LkwgPSA2MTE7CiAgICB0Lk0gPSA4ODk7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3MjI7CiAgICB0LlAgPSA2MTE7CiAgICB0LlEgPSA3MjI7CiAgICB0LlIgPSA2Njc7CiAgICB0LlMgPSA1NTY7CiAgICB0LlQgPSA2MTE7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2Njc7CiAgICB0LlcgPSA4ODk7CiAgICB0LlggPSA2Njc7CiAgICB0LlkgPSA2MTE7CiAgICB0LlogPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQuYXNjaWljaXJjdW0gPSA1NzA7CiAgICB0LnVuZGVyc2NvcmUgPSA1MDA7CiAgICB0LnF1b3RlbGVmdCA9IDMzMzsKICAgIHQuYSA9IDUwMDsKICAgIHQuYiA9IDUwMDsKICAgIHQuYyA9IDQ0NDsKICAgIHQuZCA9IDUwMDsKICAgIHQuZSA9IDQ0NDsKICAgIHQuZiA9IDMzMzsKICAgIHQuZyA9IDUwMDsKICAgIHQuaCA9IDU1NjsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDUwMDsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDc3ODsKICAgIHQubiA9IDU1NjsKICAgIHQubyA9IDUwMDsKICAgIHQucCA9IDUwMDsKICAgIHQucSA9IDUwMDsKICAgIHQuciA9IDM4OTsKICAgIHQucyA9IDM4OTsKICAgIHQudCA9IDI3ODsKICAgIHQudSA9IDU1NjsKICAgIHQudiA9IDQ0NDsKICAgIHQudyA9IDY2NzsKICAgIHQueCA9IDUwMDsKICAgIHQueSA9IDQ0NDsKICAgIHQueiA9IDM4OTsKICAgIHQuYnJhY2VsZWZ0ID0gMzQ4OwogICAgdC5iYXIgPSAyMjA7CiAgICB0LmJyYWNlcmlnaHQgPSAzNDg7CiAgICB0LmFzY2lpdGlsZGUgPSA1NzA7CiAgICB0LmV4Y2xhbWRvd24gPSAzODk7CiAgICB0LmNlbnQgPSA1MDA7CiAgICB0LnN0ZXJsaW5nID0gNTAwOwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTAwOwogICAgdC5mbG9yaW4gPSA1MDA7CiAgICB0LnNlY3Rpb24gPSA1MDA7CiAgICB0LmN1cnJlbmN5ID0gNTAwOwogICAgdC5xdW90ZXNpbmdsZSA9IDI3ODsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTAwOwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA1NTY7CiAgICB0LmZsID0gNTU2OwogICAgdC5lbmRhc2ggPSA1MDA7CiAgICB0LmRhZ2dlciA9IDUwMDsKICAgIHQuZGFnZ2VyZGJsID0gNTAwOwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI1MDsKICAgIHQucGFyYWdyYXBoID0gNTAwOwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibGJhc2UgPSA1MDA7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTAwOwogICAgdC5lbGxpcHNpcyA9IDEwMDA7CiAgICB0LnBlcnRob3VzYW5kID0gMTAwMDsKICAgIHQucXVlc3Rpb25kb3duID0gNTAwOwogICAgdC5ncmF2ZSA9IDMzMzsKICAgIHQuYWN1dGUgPSAzMzM7CiAgICB0LmNpcmN1bWZsZXggPSAzMzM7CiAgICB0LnRpbGRlID0gMzMzOwogICAgdC5tYWNyb24gPSAzMzM7CiAgICB0LmJyZXZlID0gMzMzOwogICAgdC5kb3RhY2NlbnQgPSAzMzM7CiAgICB0LmRpZXJlc2lzID0gMzMzOwogICAgdC5yaW5nID0gMzMzOwogICAgdC5jZWRpbGxhID0gMzMzOwogICAgdC5odW5nYXJ1bWxhdXQgPSAzMzM7CiAgICB0Lm9nb25layA9IDMzMzsKICAgIHQuY2Fyb24gPSAzMzM7CiAgICB0LmVtZGFzaCA9IDEwMDA7CiAgICB0LkFFID0gOTQ0OwogICAgdC5vcmRmZW1pbmluZSA9IDI2NjsKICAgIHQuTHNsYXNoID0gNjExOwogICAgdC5Pc2xhc2ggPSA3MjI7CiAgICB0Lk9FID0gOTQ0OwogICAgdC5vcmRtYXNjdWxpbmUgPSAzMDA7CiAgICB0LmFlID0gNzIyOwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjc4OwogICAgdC5vc2xhc2ggPSA1MDA7CiAgICB0Lm9lID0gNzIyOwogICAgdC5nZXJtYW5kYmxzID0gNTAwOwogICAgdC5JZGllcmVzaXMgPSAzODk7CiAgICB0LmVhY3V0ZSA9IDQ0NDsKICAgIHQuYWJyZXZlID0gNTAwOwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5lY2Fyb24gPSA0NDQ7CiAgICB0LllkaWVyZXNpcyA9IDYxMTsKICAgIHQuZGl2aWRlID0gNTcwOwogICAgdC5ZYWN1dGUgPSA2MTE7CiAgICB0LkFjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hYWN1dGUgPSA1MDA7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA0NDQ7CiAgICB0LnNjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuZWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1MDA7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDU1NjsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3NDc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDQ0NDsKICAgIHQuYXJpbmcgPSA1MDA7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjc4OwogICAgdC5hZ3JhdmUgPSA1MDA7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNjY3OwogICAgdC5hdGlsZGUgPSA1MDA7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDM4OTsKICAgIHQuc2NlZGlsbGEgPSAzODk7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ5NDsKICAgIHQuUmNhcm9uID0gNjY3OwogICAgdC5HY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5hY2lyY3VtZmxleCA9IDUwMDsKICAgIHQuQW1hY3JvbiA9IDY2NzsKICAgIHQucmNhcm9uID0gMzg5OwogICAgdC5jY2VkaWxsYSA9IDQ0NDsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA2MTE7CiAgICB0Lk9tYWNyb24gPSA3MjI7CiAgICB0LlJhY3V0ZSA9IDY2NzsKICAgIHQuU2FjdXRlID0gNTU2OwogICAgdC5kY2Fyb24gPSA2MDg7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTU2OwogICAgdC50aHJlZXN1cGVyaW9yID0gMzAwOwogICAgdC5PZ3JhdmUgPSA3MjI7CiAgICB0LkFncmF2ZSA9IDY2NzsKICAgIHQuQWJyZXZlID0gNjY3OwogICAgdC5tdWx0aXBseSA9IDU3MDsKICAgIHQudWFjdXRlID0gNTU2OwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDk0OwogICAgdC55ZGllcmVzaXMgPSA0NDQ7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1MDA7CiAgICB0LmVkaWVyZXNpcyA9IDQ0NDsKICAgIHQuY2FjdXRlID0gNDQ0OwogICAgdC5uYWN1dGUgPSA1NTY7CiAgICB0LnVtYWNyb24gPSA1NTY7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMzg5OwogICAgdC5wbHVzbWludXMgPSA1NzA7CiAgICB0LmJyb2tlbmJhciA9IDIyMDsKICAgIHQucmVnaXN0ZXJlZCA9IDc0NzsKICAgIHQuR2JyZXZlID0gNzIyOwogICAgdC5JZG90YWNjZW50ID0gMzg5OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gMzg5OwogICAgdC5vbWFjcm9uID0gNTAwOwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNjY3OwogICAgdC5sY29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LnRjYXJvbiA9IDM2NjsKICAgIHQuZW9nb25layA9IDQ0NDsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNjY3OwogICAgdC5BZGllcmVzaXMgPSA2Njc7CiAgICB0LmVncmF2ZSA9IDQ0NDsKICAgIHQuemFjdXRlID0gMzg5OwogICAgdC5pb2dvbmVrID0gMjc4OwogICAgdC5PYWN1dGUgPSA3MjI7CiAgICB0Lm9hY3V0ZSA9IDUwMDsKICAgIHQuYW1hY3JvbiA9IDUwMDsKICAgIHQuc2FjdXRlID0gMzg5OwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzIyOwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDUwMDsKICAgIHQudHdvc3VwZXJpb3IgPSAzMDA7CiAgICB0Lk9kaWVyZXNpcyA9IDcyMjsKICAgIHQubXUgPSA1NzY7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNTAwOwogICAgdC50aHJlZXF1YXJ0ZXJzID0gNzUwOwogICAgdC5TY2VkaWxsYSA9IDU1NjsKICAgIHQubGNhcm9uID0gMzgyOwogICAgdC5LY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkxhY3V0ZSA9IDYxMTsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzg5OwogICAgdC5JbWFjcm9uID0gMzg5OwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDU1NjsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDU1NjsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNjY3OwogICAgdC51Z3JhdmUgPSA1NTY7CiAgICB0LnJhZGljYWwgPSA1NDk7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzg5OwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkF0aWxkZSA9IDY2NzsKICAgIHQuQW9nb25layA9IDY2NzsKICAgIHQuQXJpbmcgPSA2Njc7CiAgICB0Lk90aWxkZSA9IDcyMjsKICAgIHQuemRvdGFjY2VudCA9IDM4OTsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMzg5OwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNjA2OwogICAgdC5JY2lyY3VtZmxleCA9IDM4OTsKICAgIHQubmNhcm9uID0gNTU2OwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA2MDY7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTU2OwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDM4OTsKICAgIHQubmNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0WyJUaW1lcy1JdGFsaWMiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjUwOwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnF1b3RlZGJsID0gNDIwOwogICAgdC5udW1iZXJzaWduID0gNTAwOwogICAgdC5kb2xsYXIgPSA1MDA7CiAgICB0LnBlcmNlbnQgPSA4MzM7CiAgICB0LmFtcGVyc2FuZCA9IDc3ODsKICAgIHQucXVvdGVyaWdodCA9IDMzMzsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3RlcmlzayA9IDUwMDsKICAgIHQucGx1cyA9IDY3NTsKICAgIHQuY29tbWEgPSAyNTA7CiAgICB0Lmh5cGhlbiA9IDMzMzsKICAgIHQucGVyaW9kID0gMjUwOwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDUwMDsKICAgIHQub25lID0gNTAwOwogICAgdC50d28gPSA1MDA7CiAgICB0LnRocmVlID0gNTAwOwogICAgdC5mb3VyID0gNTAwOwogICAgdC5maXZlID0gNTAwOwogICAgdC5zaXggPSA1MDA7CiAgICB0LnNldmVuID0gNTAwOwogICAgdC5laWdodCA9IDUwMDsKICAgIHQubmluZSA9IDUwMDsKICAgIHQuY29sb24gPSAzMzM7CiAgICB0LnNlbWljb2xvbiA9IDMzMzsKICAgIHQubGVzcyA9IDY3NTsKICAgIHQuZXF1YWwgPSA2NzU7CiAgICB0LmdyZWF0ZXIgPSA2NzU7CiAgICB0LnF1ZXN0aW9uID0gNTAwOwogICAgdC5hdCA9IDkyMDsKICAgIHQuQSA9IDYxMTsKICAgIHQuQiA9IDYxMTsKICAgIHQuQyA9IDY2NzsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDYxMTsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDcyMjsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDMzMzsKICAgIHQuSiA9IDQ0NDsKICAgIHQuSyA9IDY2NzsKICAgIHQuTCA9IDU1NjsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDY2NzsKICAgIHQuTyA9IDcyMjsKICAgIHQuUCA9IDYxMTsKICAgIHQuUSA9IDcyMjsKICAgIHQuUiA9IDYxMTsKICAgIHQuUyA9IDUwMDsKICAgIHQuVCA9IDU1NjsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDYxMTsKICAgIHQuVyA9IDgzMzsKICAgIHQuWCA9IDYxMTsKICAgIHQuWSA9IDU1NjsKICAgIHQuWiA9IDU1NjsKICAgIHQuYnJhY2tldGxlZnQgPSAzODk7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzg5OwogICAgdC5hc2NpaWNpcmN1bSA9IDQyMjsKICAgIHQudW5kZXJzY29yZSA9IDUwMDsKICAgIHQucXVvdGVsZWZ0ID0gMzMzOwogICAgdC5hID0gNTAwOwogICAgdC5iID0gNTAwOwogICAgdC5jID0gNDQ0OwogICAgdC5kID0gNTAwOwogICAgdC5lID0gNDQ0OwogICAgdC5mID0gMjc4OwogICAgdC5nID0gNTAwOwogICAgdC5oID0gNTAwOwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMjc4OwogICAgdC5rID0gNDQ0OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gNzIyOwogICAgdC5uID0gNTAwOwogICAgdC5vID0gNTAwOwogICAgdC5wID0gNTAwOwogICAgdC5xID0gNTAwOwogICAgdC5yID0gMzg5OwogICAgdC5zID0gMzg5OwogICAgdC50ID0gMjc4OwogICAgdC51ID0gNTAwOwogICAgdC52ID0gNDQ0OwogICAgdC53ID0gNjY3OwogICAgdC54ID0gNDQ0OwogICAgdC55ID0gNDQ0OwogICAgdC56ID0gMzg5OwogICAgdC5icmFjZWxlZnQgPSA0MDA7CiAgICB0LmJhciA9IDI3NTsKICAgIHQuYnJhY2VyaWdodCA9IDQwMDsKICAgIHQuYXNjaWl0aWxkZSA9IDU0MTsKICAgIHQuZXhjbGFtZG93biA9IDM4OTsKICAgIHQuY2VudCA9IDUwMDsKICAgIHQuc3RlcmxpbmcgPSA1MDA7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1MDA7CiAgICB0LmZsb3JpbiA9IDUwMDsKICAgIHQuc2VjdGlvbiA9IDUwMDsKICAgIHQuY3VycmVuY3kgPSA1MDA7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjE0OwogICAgdC5xdW90ZWRibGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDUwMDsKICAgIHQuZmwgPSA1MDA7CiAgICB0LmVuZGFzaCA9IDUwMDsKICAgIHQuZGFnZ2VyID0gNTAwOwogICAgdC5kYWdnZXJkYmwgPSA1MDA7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjUwOwogICAgdC5wYXJhZ3JhcGggPSA1MjM7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAzMzM7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDU1NjsKICAgIHQucXVvdGVkYmxyaWdodCA9IDU1NjsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1MDA7CiAgICB0LmVsbGlwc2lzID0gODg5OwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDUwMDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSA4ODk7CiAgICB0LkFFID0gODg5OwogICAgdC5vcmRmZW1pbmluZSA9IDI3NjsKICAgIHQuTHNsYXNoID0gNTU2OwogICAgdC5Pc2xhc2ggPSA3MjI7CiAgICB0Lk9FID0gOTQ0OwogICAgdC5vcmRtYXNjdWxpbmUgPSAzMTA7CiAgICB0LmFlID0gNjY3OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjc4OwogICAgdC5vc2xhc2ggPSA1MDA7CiAgICB0Lm9lID0gNjY3OwogICAgdC5nZXJtYW5kYmxzID0gNTAwOwogICAgdC5JZGllcmVzaXMgPSAzMzM7CiAgICB0LmVhY3V0ZSA9IDQ0NDsKICAgIHQuYWJyZXZlID0gNTAwOwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTAwOwogICAgdC5lY2Fyb24gPSA0NDQ7CiAgICB0LllkaWVyZXNpcyA9IDU1NjsKICAgIHQuZGl2aWRlID0gNjc1OwogICAgdC5ZYWN1dGUgPSA1NTY7CiAgICB0LkFjaXJjdW1mbGV4ID0gNjExOwogICAgdC5hYWN1dGUgPSA1MDA7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA0NDQ7CiAgICB0LnNjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuZWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1MDA7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDUwMDsKICAgIHQuRWRpZXJlc2lzID0gNjExOwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3NjA7CiAgICB0LkVtYWNyb24gPSA2MTE7CiAgICB0LmNjYXJvbiA9IDQ0NDsKICAgIHQuYXJpbmcgPSA1MDA7CiAgICB0Lk5jb21tYWFjY2VudCA9IDY2NzsKICAgIHQubGFjdXRlID0gMjc4OwogICAgdC5hZ3JhdmUgPSA1MDA7CiAgICB0LlRjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuQ2FjdXRlID0gNjY3OwogICAgdC5hdGlsZGUgPSA1MDA7CiAgICB0LkVkb3RhY2NlbnQgPSA2MTE7CiAgICB0LnNjYXJvbiA9IDM4OTsKICAgIHQuc2NlZGlsbGEgPSAzODk7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ3MTsKICAgIHQuUmNhcm9uID0gNjExOwogICAgdC5HY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTAwOwogICAgdC5hY2lyY3VtZmxleCA9IDUwMDsKICAgIHQuQW1hY3JvbiA9IDYxMTsKICAgIHQucmNhcm9uID0gMzg5OwogICAgdC5jY2VkaWxsYSA9IDQ0NDsKICAgIHQuWmRvdGFjY2VudCA9IDU1NjsKICAgIHQuVGhvcm4gPSA2MTE7CiAgICB0Lk9tYWNyb24gPSA3MjI7CiAgICB0LlJhY3V0ZSA9IDYxMTsKICAgIHQuU2FjdXRlID0gNTAwOwogICAgdC5kY2Fyb24gPSA1NDQ7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTAwOwogICAgdC50aHJlZXN1cGVyaW9yID0gMzAwOwogICAgdC5PZ3JhdmUgPSA3MjI7CiAgICB0LkFncmF2ZSA9IDYxMTsKICAgIHQuQWJyZXZlID0gNjExOwogICAgdC5tdWx0aXBseSA9IDY3NTsKICAgIHQudWFjdXRlID0gNTAwOwogICAgdC5UY2Fyb24gPSA1NTY7CiAgICB0LnBhcnRpYWxkaWZmID0gNDc2OwogICAgdC55ZGllcmVzaXMgPSA0NDQ7CiAgICB0Lk5hY3V0ZSA9IDY2NzsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjExOwogICAgdC5hZGllcmVzaXMgPSA1MDA7CiAgICB0LmVkaWVyZXNpcyA9IDQ0NDsKICAgIHQuY2FjdXRlID0gNDQ0OwogICAgdC5uYWN1dGUgPSA1MDA7CiAgICB0LnVtYWNyb24gPSA1MDA7CiAgICB0Lk5jYXJvbiA9IDY2NzsKICAgIHQuSWFjdXRlID0gMzMzOwogICAgdC5wbHVzbWludXMgPSA2NzU7CiAgICB0LmJyb2tlbmJhciA9IDI3NTsKICAgIHQucmVnaXN0ZXJlZCA9IDc2MDsKICAgIHQuR2JyZXZlID0gNzIyOwogICAgdC5JZG90YWNjZW50ID0gMzMzOwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDYxMTsKICAgIHQucmFjdXRlID0gMzg5OwogICAgdC5vbWFjcm9uID0gNTAwOwogICAgdC5aYWN1dGUgPSA1NTY7CiAgICB0LlpjYXJvbiA9IDU1NjsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNjY3OwogICAgdC5sY29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LnRjYXJvbiA9IDMwMDsKICAgIHQuZW9nb25layA9IDQ0NDsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNjExOwogICAgdC5BZGllcmVzaXMgPSA2MTE7CiAgICB0LmVncmF2ZSA9IDQ0NDsKICAgIHQuemFjdXRlID0gMzg5OwogICAgdC5pb2dvbmVrID0gMjc4OwogICAgdC5PYWN1dGUgPSA3MjI7CiAgICB0Lm9hY3V0ZSA9IDUwMDsKICAgIHQuYW1hY3JvbiA9IDUwMDsKICAgIHQuc2FjdXRlID0gMzg5OwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzIyOwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDUwMDsKICAgIHQudHdvc3VwZXJpb3IgPSAzMDA7CiAgICB0Lk9kaWVyZXNpcyA9IDcyMjsKICAgIHQubXUgPSA1MDA7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuRW9nb25layA9IDYxMTsKICAgIHQuZGNyb2F0ID0gNTAwOwogICAgdC50aHJlZXF1YXJ0ZXJzID0gNzUwOwogICAgdC5TY2VkaWxsYSA9IDUwMDsKICAgIHQubGNhcm9uID0gMzAwOwogICAgdC5LY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkxhY3V0ZSA9IDU1NjsKICAgIHQudHJhZGVtYXJrID0gOTgwOwogICAgdC5lZG90YWNjZW50ID0gNDQ0OwogICAgdC5JZ3JhdmUgPSAzMzM7CiAgICB0LkltYWNyb24gPSAzMzM7CiAgICB0LkxjYXJvbiA9IDYxMTsKICAgIHQub25laGFsZiA9IDc1MDsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5vY2lyY3VtZmxleCA9IDUwMDsKICAgIHQubnRpbGRlID0gNTAwOwogICAgdC5VaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5FYWN1dGUgPSA2MTE7CiAgICB0LmVtYWNyb24gPSA0NDQ7CiAgICB0LmdicmV2ZSA9IDUwMDsKICAgIHQub25lcXVhcnRlciA9IDc1MDsKICAgIHQuU2Nhcm9uID0gNTAwOwogICAgdC5TY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lk9odW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LmRlZ3JlZSA9IDQwMDsKICAgIHQub2dyYXZlID0gNTAwOwogICAgdC5DY2Fyb24gPSA2Njc7CiAgICB0LnVncmF2ZSA9IDUwMDsKICAgIHQucmFkaWNhbCA9IDQ1MzsKICAgIHQuRGNhcm9uID0gNzIyOwogICAgdC5yY29tbWFhY2NlbnQgPSAzODk7CiAgICB0Lk50aWxkZSA9IDY2NzsKICAgIHQub3RpbGRlID0gNTAwOwogICAgdC5SY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0Lkxjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuQXRpbGRlID0gNjExOwogICAgdC5Bb2dvbmVrID0gNjExOwogICAgdC5BcmluZyA9IDYxMTsKICAgIHQuT3RpbGRlID0gNzIyOwogICAgdC56ZG90YWNjZW50ID0gMzg5OwogICAgdC5FY2Fyb24gPSA2MTE7CiAgICB0LklvZ29uZWsgPSAzMzM7CiAgICB0Lmtjb21tYWFjY2VudCA9IDQ0NDsKICAgIHQubWludXMgPSA2NzU7CiAgICB0LkljaXJjdW1mbGV4ID0gMzMzOwogICAgdC5uY2Fyb24gPSA1MDA7CiAgICB0LnRjb21tYWFjY2VudCA9IDI3ODsKICAgIHQubG9naWNhbG5vdCA9IDY3NTsKICAgIHQub2RpZXJlc2lzID0gNTAwOwogICAgdC51ZGllcmVzaXMgPSA1MDA7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5nY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0LmV0aCA9IDUwMDsKICAgIHQuemNhcm9uID0gMzg5OwogICAgdC5uY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm9uZXN1cGVyaW9yID0gMzAwOwogICAgdC5pbWFjcm9uID0gMjc4OwogICAgdC5FdXJvID0gNTAwOwogIH0pOwogIHQuWmFwZkRpbmdiYXRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNzg7CiAgICB0LmExID0gOTc0OwogICAgdC5hMiA9IDk2MTsKICAgIHQuYTIwMiA9IDk3NDsKICAgIHQuYTMgPSA5ODA7CiAgICB0LmE0ID0gNzE5OwogICAgdC5hNSA9IDc4OTsKICAgIHQuYTExOSA9IDc5MDsKICAgIHQuYTExOCA9IDc5MTsKICAgIHQuYTExNyA9IDY5MDsKICAgIHQuYTExID0gOTYwOwogICAgdC5hMTIgPSA5Mzk7CiAgICB0LmExMyA9IDU0OTsKICAgIHQuYTE0ID0gODU1OwogICAgdC5hMTUgPSA5MTE7CiAgICB0LmExNiA9IDkzMzsKICAgIHQuYTEwNSA9IDkxMTsKICAgIHQuYTE3ID0gOTQ1OwogICAgdC5hMTggPSA5NzQ7CiAgICB0LmExOSA9IDc1NTsKICAgIHQuYTIwID0gODQ2OwogICAgdC5hMjEgPSA3NjI7CiAgICB0LmEyMiA9IDc2MTsKICAgIHQuYTIzID0gNTcxOwogICAgdC5hMjQgPSA2Nzc7CiAgICB0LmEyNSA9IDc2MzsKICAgIHQuYTI2ID0gNzYwOwogICAgdC5hMjcgPSA3NTk7CiAgICB0LmEyOCA9IDc1NDsKICAgIHQuYTYgPSA0OTQ7CiAgICB0LmE3ID0gNTUyOwogICAgdC5hOCA9IDUzNzsKICAgIHQuYTkgPSA1Nzc7CiAgICB0LmExMCA9IDY5MjsKICAgIHQuYTI5ID0gNzg2OwogICAgdC5hMzAgPSA3ODg7CiAgICB0LmEzMSA9IDc4ODsKICAgIHQuYTMyID0gNzkwOwogICAgdC5hMzMgPSA3OTM7CiAgICB0LmEzNCA9IDc5NDsKICAgIHQuYTM1ID0gODE2OwogICAgdC5hMzYgPSA4MjM7CiAgICB0LmEzNyA9IDc4OTsKICAgIHQuYTM4ID0gODQxOwogICAgdC5hMzkgPSA4MjM7CiAgICB0LmE0MCA9IDgzMzsKICAgIHQuYTQxID0gODE2OwogICAgdC5hNDIgPSA4MzE7CiAgICB0LmE0MyA9IDkyMzsKICAgIHQuYTQ0ID0gNzQ0OwogICAgdC5hNDUgPSA3MjM7CiAgICB0LmE0NiA9IDc0OTsKICAgIHQuYTQ3ID0gNzkwOwogICAgdC5hNDggPSA3OTI7CiAgICB0LmE0OSA9IDY5NTsKICAgIHQuYTUwID0gNzc2OwogICAgdC5hNTEgPSA3Njg7CiAgICB0LmE1MiA9IDc5MjsKICAgIHQuYTUzID0gNzU5OwogICAgdC5hNTQgPSA3MDc7CiAgICB0LmE1NSA9IDcwODsKICAgIHQuYTU2ID0gNjgyOwogICAgdC5hNTcgPSA3MDE7CiAgICB0LmE1OCA9IDgyNjsKICAgIHQuYTU5ID0gODE1OwogICAgdC5hNjAgPSA3ODk7CiAgICB0LmE2MSA9IDc4OTsKICAgIHQuYTYyID0gNzA3OwogICAgdC5hNjMgPSA2ODc7CiAgICB0LmE2NCA9IDY5NjsKICAgIHQuYTY1ID0gNjg5OwogICAgdC5hNjYgPSA3ODY7CiAgICB0LmE2NyA9IDc4NzsKICAgIHQuYTY4ID0gNzEzOwogICAgdC5hNjkgPSA3OTE7CiAgICB0LmE3MCA9IDc4NTsKICAgIHQuYTcxID0gNzkxOwogICAgdC5hNzIgPSA4NzM7CiAgICB0LmE3MyA9IDc2MTsKICAgIHQuYTc0ID0gNzYyOwogICAgdC5hMjAzID0gNzYyOwogICAgdC5hNzUgPSA3NTk7CiAgICB0LmEyMDQgPSA3NTk7CiAgICB0LmE3NiA9IDg5MjsKICAgIHQuYTc3ID0gODkyOwogICAgdC5hNzggPSA3ODg7CiAgICB0LmE3OSA9IDc4NDsKICAgIHQuYTgxID0gNDM4OwogICAgdC5hODIgPSAxMzg7CiAgICB0LmE4MyA9IDI3NzsKICAgIHQuYTg0ID0gNDE1OwogICAgdC5hOTcgPSAzOTI7CiAgICB0LmE5OCA9IDM5MjsKICAgIHQuYTk5ID0gNjY4OwogICAgdC5hMTAwID0gNjY4OwogICAgdC5hODkgPSAzOTA7CiAgICB0LmE5MCA9IDM5MDsKICAgIHQuYTkzID0gMzE3OwogICAgdC5hOTQgPSAzMTc7CiAgICB0LmE5MSA9IDI3NjsKICAgIHQuYTkyID0gMjc2OwogICAgdC5hMjA1ID0gNTA5OwogICAgdC5hODUgPSA1MDk7CiAgICB0LmEyMDYgPSA0MTA7CiAgICB0LmE4NiA9IDQxMDsKICAgIHQuYTg3ID0gMjM0OwogICAgdC5hODggPSAyMzQ7CiAgICB0LmE5NSA9IDMzNDsKICAgIHQuYTk2ID0gMzM0OwogICAgdC5hMTAxID0gNzMyOwogICAgdC5hMTAyID0gNTQ0OwogICAgdC5hMTAzID0gNTQ0OwogICAgdC5hMTA0ID0gOTEwOwogICAgdC5hMTA2ID0gNjY3OwogICAgdC5hMTA3ID0gNzYwOwogICAgdC5hMTA4ID0gNzYwOwogICAgdC5hMTEyID0gNzc2OwogICAgdC5hMTExID0gNTk1OwogICAgdC5hMTEwID0gNjk0OwogICAgdC5hMTA5ID0gNjI2OwogICAgdC5hMTIwID0gNzg4OwogICAgdC5hMTIxID0gNzg4OwogICAgdC5hMTIyID0gNzg4OwogICAgdC5hMTIzID0gNzg4OwogICAgdC5hMTI0ID0gNzg4OwogICAgdC5hMTI1ID0gNzg4OwogICAgdC5hMTI2ID0gNzg4OwogICAgdC5hMTI3ID0gNzg4OwogICAgdC5hMTI4ID0gNzg4OwogICAgdC5hMTI5ID0gNzg4OwogICAgdC5hMTMwID0gNzg4OwogICAgdC5hMTMxID0gNzg4OwogICAgdC5hMTMyID0gNzg4OwogICAgdC5hMTMzID0gNzg4OwogICAgdC5hMTM0ID0gNzg4OwogICAgdC5hMTM1ID0gNzg4OwogICAgdC5hMTM2ID0gNzg4OwogICAgdC5hMTM3ID0gNzg4OwogICAgdC5hMTM4ID0gNzg4OwogICAgdC5hMTM5ID0gNzg4OwogICAgdC5hMTQwID0gNzg4OwogICAgdC5hMTQxID0gNzg4OwogICAgdC5hMTQyID0gNzg4OwogICAgdC5hMTQzID0gNzg4OwogICAgdC5hMTQ0ID0gNzg4OwogICAgdC5hMTQ1ID0gNzg4OwogICAgdC5hMTQ2ID0gNzg4OwogICAgdC5hMTQ3ID0gNzg4OwogICAgdC5hMTQ4ID0gNzg4OwogICAgdC5hMTQ5ID0gNzg4OwogICAgdC5hMTUwID0gNzg4OwogICAgdC5hMTUxID0gNzg4OwogICAgdC5hMTUyID0gNzg4OwogICAgdC5hMTUzID0gNzg4OwogICAgdC5hMTU0ID0gNzg4OwogICAgdC5hMTU1ID0gNzg4OwogICAgdC5hMTU2ID0gNzg4OwogICAgdC5hMTU3ID0gNzg4OwogICAgdC5hMTU4ID0gNzg4OwogICAgdC5hMTU5ID0gNzg4OwogICAgdC5hMTYwID0gODk0OwogICAgdC5hMTYxID0gODM4OwogICAgdC5hMTYzID0gMTAxNjsKICAgIHQuYTE2NCA9IDQ1ODsKICAgIHQuYTE5NiA9IDc0ODsKICAgIHQuYTE2NSA9IDkyNDsKICAgIHQuYTE5MiA9IDc0ODsKICAgIHQuYTE2NiA9IDkxODsKICAgIHQuYTE2NyA9IDkyNzsKICAgIHQuYTE2OCA9IDkyODsKICAgIHQuYTE2OSA9IDkyODsKICAgIHQuYTE3MCA9IDgzNDsKICAgIHQuYTE3MSA9IDg3MzsKICAgIHQuYTE3MiA9IDgyODsKICAgIHQuYTE3MyA9IDkyNDsKICAgIHQuYTE2MiA9IDkyNDsKICAgIHQuYTE3NCA9IDkxNzsKICAgIHQuYTE3NSA9IDkzMDsKICAgIHQuYTE3NiA9IDkzMTsKICAgIHQuYTE3NyA9IDQ2MzsKICAgIHQuYTE3OCA9IDg4MzsKICAgIHQuYTE3OSA9IDgzNjsKICAgIHQuYTE5MyA9IDgzNjsKICAgIHQuYTE4MCA9IDg2NzsKICAgIHQuYTE5OSA9IDg2NzsKICAgIHQuYTE4MSA9IDY5NjsKICAgIHQuYTIwMCA9IDY5NjsKICAgIHQuYTE4MiA9IDg3NDsKICAgIHQuYTIwMSA9IDg3NDsKICAgIHQuYTE4MyA9IDc2MDsKICAgIHQuYTE4NCA9IDk0NjsKICAgIHQuYTE5NyA9IDc3MTsKICAgIHQuYTE4NSA9IDg2NTsKICAgIHQuYTE5NCA9IDc3MTsKICAgIHQuYTE5OCA9IDg4ODsKICAgIHQuYTE4NiA9IDk2NzsKICAgIHQuYTE5NSA9IDg4ODsKICAgIHQuYTE4NyA9IDgzMTsKICAgIHQuYTE4OCA9IDg3MzsKICAgIHQuYTE4OSA9IDkyNzsKICAgIHQuYTE5MCA9IDk3MDsKICAgIHQuYTE5MSA9IDkxODsKICB9KTsKfSk7CmV4cG9ydHMuZ2V0TWV0cmljcyA9IGdldE1ldHJpY3M7CmNvbnN0IGdldEZvbnRCYXNpY01ldHJpY3MgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuQ291cmllciA9IHsKICAgIGFzY2VudDogNjI5LAogICAgZGVzY2VudDogLTE1NywKICAgIGNhcEhlaWdodDogNTYyLAogICAgeEhlaWdodDogLTQyNgogIH07CiAgdFsiQ291cmllci1Cb2xkIl0gPSB7CiAgICBhc2NlbnQ6IDYyOSwKICAgIGRlc2NlbnQ6IC0xNTcsCiAgICBjYXBIZWlnaHQ6IDU2MiwKICAgIHhIZWlnaHQ6IDQzOQogIH07CiAgdFsiQ291cmllci1PYmxpcXVlIl0gPSB7CiAgICBhc2NlbnQ6IDYyOSwKICAgIGRlc2NlbnQ6IC0xNTcsCiAgICBjYXBIZWlnaHQ6IDU2MiwKICAgIHhIZWlnaHQ6IDQyNgogIH07CiAgdFsiQ291cmllci1Cb2xkT2JsaXF1ZSJdID0gewogICAgYXNjZW50OiA2MjksCiAgICBkZXNjZW50OiAtMTU3LAogICAgY2FwSGVpZ2h0OiA1NjIsCiAgICB4SGVpZ2h0OiA0MjYKICB9OwogIHQuSGVsdmV0aWNhID0gewogICAgYXNjZW50OiA3MTgsCiAgICBkZXNjZW50OiAtMjA3LAogICAgY2FwSGVpZ2h0OiA3MTgsCiAgICB4SGVpZ2h0OiA1MjMKICB9OwogIHRbIkhlbHZldGljYS1Cb2xkIl0gPSB7CiAgICBhc2NlbnQ6IDcxOCwKICAgIGRlc2NlbnQ6IC0yMDcsCiAgICBjYXBIZWlnaHQ6IDcxOCwKICAgIHhIZWlnaHQ6IDUzMgogIH07CiAgdFsiSGVsdmV0aWNhLU9ibGlxdWUiXSA9IHsKICAgIGFzY2VudDogNzE4LAogICAgZGVzY2VudDogLTIwNywKICAgIGNhcEhlaWdodDogNzE4LAogICAgeEhlaWdodDogNTIzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiXSA9IHsKICAgIGFzY2VudDogNzE4LAogICAgZGVzY2VudDogLTIwNywKICAgIGNhcEhlaWdodDogNzE4LAogICAgeEhlaWdodDogNTMyCiAgfTsKICB0WyJUaW1lcy1Sb21hbiJdID0gewogICAgYXNjZW50OiA2ODMsCiAgICBkZXNjZW50OiAtMjE3LAogICAgY2FwSGVpZ2h0OiA2NjIsCiAgICB4SGVpZ2h0OiA0NTAKICB9OwogIHRbIlRpbWVzLUJvbGQiXSA9IHsKICAgIGFzY2VudDogNjgzLAogICAgZGVzY2VudDogLTIxNywKICAgIGNhcEhlaWdodDogNjc2LAogICAgeEhlaWdodDogNDYxCiAgfTsKICB0WyJUaW1lcy1JdGFsaWMiXSA9IHsKICAgIGFzY2VudDogNjgzLAogICAgZGVzY2VudDogLTIxNywKICAgIGNhcEhlaWdodDogNjUzLAogICAgeEhlaWdodDogNDQxCiAgfTsKICB0WyJUaW1lcy1Cb2xkSXRhbGljIl0gPSB7CiAgICBhc2NlbnQ6IDY4MywKICAgIGRlc2NlbnQ6IC0yMTcsCiAgICBjYXBIZWlnaHQ6IDY2OSwKICAgIHhIZWlnaHQ6IDQ2MgogIH07CiAgdC5TeW1ib2wgPSB7CiAgICBhc2NlbnQ6IE1hdGguTmFOLAogICAgZGVzY2VudDogTWF0aC5OYU4sCiAgICBjYXBIZWlnaHQ6IE1hdGguTmFOLAogICAgeEhlaWdodDogTWF0aC5OYU4KICB9OwogIHQuWmFwZkRpbmdiYXRzID0gewogICAgYXNjZW50OiBNYXRoLk5hTiwKICAgIGRlc2NlbnQ6IE1hdGguTmFOLAogICAgY2FwSGVpZ2h0OiBNYXRoLk5hTiwKICAgIHhIZWlnaHQ6IE1hdGguTmFOCiAgfTsKfSk7CmV4cG9ydHMuZ2V0Rm9udEJhc2ljTWV0cmljcyA9IGdldEZvbnRCYXNpY01ldHJpY3M7CgovKioqLyB9KSwKLyogNDYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5HbHlmVGFibGUgPSB2b2lkIDA7CmNvbnN0IE9OX0NVUlZFX1BPSU5UID0gMSA8PCAwOwpjb25zdCBYX1NIT1JUX1ZFQ1RPUiA9IDEgPDwgMTsKY29uc3QgWV9TSE9SVF9WRUNUT1IgPSAxIDw8IDI7CmNvbnN0IFJFUEVBVF9GTEFHID0gMSA8PCAzOwpjb25zdCBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1IgPSAxIDw8IDQ7CmNvbnN0IFlfSVNfU0FNRV9PUl9QT1NJVElWRV9ZX1NIT1JUX1ZFQ1RPUiA9IDEgPDwgNTsKY29uc3QgT1ZFUkxBUF9TSU1QTEUgPSAxIDw8IDY7CmNvbnN0IEFSR18xX0FORF8yX0FSRV9XT1JEUyA9IDEgPDwgMDsKY29uc3QgQVJHU19BUkVfWFlfVkFMVUVTID0gMSA8PCAxOwpjb25zdCBXRV9IQVZFX0FfU0NBTEUgPSAxIDw8IDM7CmNvbnN0IE1PUkVfQ09NUE9ORU5UUyA9IDEgPDwgNTsKY29uc3QgV0VfSEFWRV9BTl9YX0FORF9ZX1NDQUxFID0gMSA8PCA2Owpjb25zdCBXRV9IQVZFX0FfVFdPX0JZX1RXTyA9IDEgPDwgNzsKY29uc3QgV0VfSEFWRV9JTlNUUlVDVElPTlMgPSAxIDw8IDg7CgpjbGFzcyBHbHlmVGFibGUgewogIGNvbnN0cnVjdG9yKHsKICAgIGdseWZUYWJsZSwKICAgIGlzR2x5cGhMb2NhdGlvbnNMb25nLAogICAgbG9jYVRhYmxlLAogICAgbnVtR2x5cGhzCiAgfSkgewogICAgdGhpcy5nbHlwaHMgPSBbXTsKICAgIGNvbnN0IGxvY2EgPSBuZXcgRGF0YVZpZXcobG9jYVRhYmxlLmJ1ZmZlciwgbG9jYVRhYmxlLmJ5dGVPZmZzZXQsIGxvY2FUYWJsZS5ieXRlTGVuZ3RoKTsKICAgIGNvbnN0IGdseWYgPSBuZXcgRGF0YVZpZXcoZ2x5ZlRhYmxlLmJ1ZmZlciwgZ2x5ZlRhYmxlLmJ5dGVPZmZzZXQsIGdseWZUYWJsZS5ieXRlTGVuZ3RoKTsKICAgIGNvbnN0IG9mZnNldFNpemUgPSBpc0dseXBoTG9jYXRpb25zTG9uZyA/IDQgOiAyOwogICAgbGV0IHByZXYgPSBpc0dseXBoTG9jYXRpb25zTG9uZyA/IGxvY2EuZ2V0VWludDMyKDApIDogMiAqIGxvY2EuZ2V0VWludDE2KDApOwogICAgbGV0IHBvcyA9IDA7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1HbHlwaHM7IGkrKykgewogICAgICBwb3MgKz0gb2Zmc2V0U2l6ZTsKICAgICAgY29uc3QgbmV4dCA9IGlzR2x5cGhMb2NhdGlvbnNMb25nID8gbG9jYS5nZXRVaW50MzIocG9zKSA6IDIgKiBsb2NhLmdldFVpbnQxNihwb3MpOwoKICAgICAgaWYgKG5leHQgPT09IHByZXYpIHsKICAgICAgICB0aGlzLmdseXBocy5wdXNoKG5ldyBHbHlwaCh7fSkpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBnbHlwaCA9IEdseXBoLnBhcnNlKHByZXYsIGdseWYpOwogICAgICB0aGlzLmdseXBocy5wdXNoKGdseXBoKTsKICAgICAgcHJldiA9IG5leHQ7CiAgICB9CiAgfQoKICBnZXRTaXplKCkgewogICAgcmV0dXJuIHRoaXMuZ2x5cGhzLnJlZHVjZSgoYSwgZykgPT4gewogICAgICBjb25zdCBzaXplID0gZy5nZXRTaXplKCk7CiAgICAgIHJldHVybiBhICsgKHNpemUgKyAzICYgfjMpOwogICAgfSwgMCk7CiAgfQoKICB3cml0ZSgpIHsKICAgIGNvbnN0IHRvdGFsU2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpOwogICAgY29uc3QgZ2x5ZlRhYmxlID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcih0b3RhbFNpemUpKTsKICAgIGNvbnN0IGlzTG9jYXRpb25Mb25nID0gdG90YWxTaXplID4gMHgxZmZmZTsKICAgIGNvbnN0IG9mZnNldFNpemUgPSBpc0xvY2F0aW9uTG9uZyA/IDQgOiAyOwogICAgY29uc3QgbG9jYVRhYmxlID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigodGhpcy5nbHlwaHMubGVuZ3RoICsgMSkgKiBvZmZzZXRTaXplKSk7CgogICAgaWYgKGlzTG9jYXRpb25Mb25nKSB7CiAgICAgIGxvY2FUYWJsZS5zZXRVaW50MzIoMCwgMCk7CiAgICB9IGVsc2UgewogICAgICBsb2NhVGFibGUuc2V0VWludDE2KDAsIDApOwogICAgfQoKICAgIGxldCBwb3MgPSAwOwogICAgbGV0IGxvY2FJbmRleCA9IDA7CgogICAgZm9yIChjb25zdCBnbHlwaCBvZiB0aGlzLmdseXBocykgewogICAgICBwb3MgKz0gZ2x5cGgud3JpdGUocG9zLCBnbHlmVGFibGUpOwogICAgICBwb3MgPSBwb3MgKyAzICYgfjM7CiAgICAgIGxvY2FJbmRleCArPSBvZmZzZXRTaXplOwoKICAgICAgaWYgKGlzTG9jYXRpb25Mb25nKSB7CiAgICAgICAgbG9jYVRhYmxlLnNldFVpbnQzMihsb2NhSW5kZXgsIHBvcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9jYVRhYmxlLnNldFVpbnQxNihsb2NhSW5kZXgsIHBvcyA+PiAxKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGlzTG9jYXRpb25Mb25nLAogICAgICBsb2NhOiBuZXcgVWludDhBcnJheShsb2NhVGFibGUuYnVmZmVyKSwKICAgICAgZ2x5ZjogbmV3IFVpbnQ4QXJyYXkoZ2x5ZlRhYmxlLmJ1ZmZlcikKICAgIH07CiAgfQoKICBzY2FsZShmYWN0b3JzKSB7CiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0aGlzLmdseXBocy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHRoaXMuZ2x5cGhzW2ldLnNjYWxlKGZhY3RvcnNbaV0pOwogICAgfQogIH0KCn0KCmV4cG9ydHMuR2x5ZlRhYmxlID0gR2x5ZlRhYmxlOwoKY2xhc3MgR2x5cGggewogIGNvbnN0cnVjdG9yKHsKICAgIGhlYWRlciA9IG51bGwsCiAgICBzaW1wbGUgPSBudWxsLAogICAgY29tcG9zaXRlcyA9IG51bGwKICB9KSB7CiAgICB0aGlzLmhlYWRlciA9IGhlYWRlcjsKICAgIHRoaXMuc2ltcGxlID0gc2ltcGxlOwogICAgdGhpcy5jb21wb3NpdGVzID0gY29tcG9zaXRlczsKICB9CgogIHN0YXRpYyBwYXJzZShwb3MsIGdseWYpIHsKICAgIGNvbnN0IFtyZWFkLCBoZWFkZXJdID0gR2x5cGhIZWFkZXIucGFyc2UocG9zLCBnbHlmKTsKICAgIHBvcyArPSByZWFkOwoKICAgIGlmIChoZWFkZXIubnVtYmVyT2ZDb250b3VycyA8IDApIHsKICAgICAgY29uc3QgY29tcG9zaXRlcyA9IFtdOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBjb25zdCBbbiwgY29tcG9zaXRlXSA9IENvbXBvc2l0ZUdseXBoLnBhcnNlKHBvcywgZ2x5Zik7CiAgICAgICAgcG9zICs9IG47CiAgICAgICAgY29tcG9zaXRlcy5wdXNoKGNvbXBvc2l0ZSk7CgogICAgICAgIGlmICghKGNvbXBvc2l0ZS5mbGFncyAmIE1PUkVfQ09NUE9ORU5UUykpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBHbHlwaCh7CiAgICAgICAgaGVhZGVyLAogICAgICAgIGNvbXBvc2l0ZXMKICAgICAgfSk7CiAgICB9CgogICAgY29uc3Qgc2ltcGxlID0gU2ltcGxlR2x5cGgucGFyc2UocG9zLCBnbHlmLCBoZWFkZXIubnVtYmVyT2ZDb250b3Vycyk7CiAgICByZXR1cm4gbmV3IEdseXBoKHsKICAgICAgaGVhZGVyLAogICAgICBzaW1wbGUKICAgIH0pOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIGlmICghdGhpcy5oZWFkZXIpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgY29uc3Qgc2l6ZSA9IHRoaXMuc2ltcGxlID8gdGhpcy5zaW1wbGUuZ2V0U2l6ZSgpIDogdGhpcy5jb21wb3NpdGVzLnJlZHVjZSgoYSwgYykgPT4gYSArIGMuZ2V0U2l6ZSgpLCAwKTsKICAgIHJldHVybiB0aGlzLmhlYWRlci5nZXRTaXplKCkgKyBzaXplOwogIH0KCiAgd3JpdGUocG9zLCBidWYpIHsKICAgIGlmICghdGhpcy5oZWFkZXIpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIHBvcyArPSB0aGlzLmhlYWRlci53cml0ZShwb3MsIGJ1Zik7CgogICAgaWYgKHRoaXMuc2ltcGxlKSB7CiAgICAgIHBvcyArPSB0aGlzLnNpbXBsZS53cml0ZShwb3MsIGJ1Zik7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGNvbnN0IGNvbXBvc2l0ZSBvZiB0aGlzLmNvbXBvc2l0ZXMpIHsKICAgICAgICBwb3MgKz0gY29tcG9zaXRlLndyaXRlKHBvcywgYnVmKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwb3MgLSBzcG9zOwogIH0KCiAgc2NhbGUoZmFjdG9yKSB7CiAgICBpZiAoIXRoaXMuaGVhZGVyKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB4TWlkZGxlID0gKHRoaXMuaGVhZGVyLnhNaW4gKyB0aGlzLmhlYWRlci54TWF4KSAvIDI7CiAgICB0aGlzLmhlYWRlci5zY2FsZSh4TWlkZGxlLCBmYWN0b3IpOwoKICAgIGlmICh0aGlzLnNpbXBsZSkgewogICAgICB0aGlzLnNpbXBsZS5zY2FsZSh4TWlkZGxlLCBmYWN0b3IpOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChjb25zdCBjb21wb3NpdGUgb2YgdGhpcy5jb21wb3NpdGVzKSB7CiAgICAgICAgY29tcG9zaXRlLnNjYWxlKHhNaWRkbGUsIGZhY3Rvcik7CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBHbHlwaEhlYWRlciB7CiAgY29uc3RydWN0b3IoewogICAgbnVtYmVyT2ZDb250b3VycywKICAgIHhNaW4sCiAgICB5TWluLAogICAgeE1heCwKICAgIHlNYXgKICB9KSB7CiAgICB0aGlzLm51bWJlck9mQ29udG91cnMgPSBudW1iZXJPZkNvbnRvdXJzOwogICAgdGhpcy54TWluID0geE1pbjsKICAgIHRoaXMueU1pbiA9IHlNaW47CiAgICB0aGlzLnhNYXggPSB4TWF4OwogICAgdGhpcy55TWF4ID0geU1heDsKICB9CgogIHN0YXRpYyBwYXJzZShwb3MsIGdseWYpIHsKICAgIHJldHVybiBbMTAsIG5ldyBHbHlwaEhlYWRlcih7CiAgICAgIG51bWJlck9mQ29udG91cnM6IGdseWYuZ2V0SW50MTYocG9zKSwKICAgICAgeE1pbjogZ2x5Zi5nZXRJbnQxNihwb3MgKyAyKSwKICAgICAgeU1pbjogZ2x5Zi5nZXRJbnQxNihwb3MgKyA0KSwKICAgICAgeE1heDogZ2x5Zi5nZXRJbnQxNihwb3MgKyA2KSwKICAgICAgeU1heDogZ2x5Zi5nZXRJbnQxNihwb3MgKyA4KQogICAgfSldOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIHJldHVybiAxMDsKICB9CgogIHdyaXRlKHBvcywgYnVmKSB7CiAgICBidWYuc2V0SW50MTYocG9zLCB0aGlzLm51bWJlck9mQ29udG91cnMpOwogICAgYnVmLnNldEludDE2KHBvcyArIDIsIHRoaXMueE1pbik7CiAgICBidWYuc2V0SW50MTYocG9zICsgNCwgdGhpcy55TWluKTsKICAgIGJ1Zi5zZXRJbnQxNihwb3MgKyA2LCB0aGlzLnhNYXgpOwogICAgYnVmLnNldEludDE2KHBvcyArIDgsIHRoaXMueU1heCk7CiAgICByZXR1cm4gMTA7CiAgfQoKICBzY2FsZSh4LCBmYWN0b3IpIHsKICAgIHRoaXMueE1pbiA9IE1hdGgucm91bmQoeCArICh0aGlzLnhNaW4gLSB4KSAqIGZhY3Rvcik7CiAgICB0aGlzLnhNYXggPSBNYXRoLnJvdW5kKHggKyAodGhpcy54TWF4IC0geCkgKiBmYWN0b3IpOwogIH0KCn0KCmNsYXNzIENvbnRvdXIgewogIGNvbnN0cnVjdG9yKHsKICAgIGZsYWdzLAogICAgeENvb3JkaW5hdGVzLAogICAgeUNvb3JkaW5hdGVzCiAgfSkgewogICAgdGhpcy54Q29vcmRpbmF0ZXMgPSB4Q29vcmRpbmF0ZXM7CiAgICB0aGlzLnlDb29yZGluYXRlcyA9IHlDb29yZGluYXRlczsKICAgIHRoaXMuZmxhZ3MgPSBmbGFnczsKICB9Cgp9CgpjbGFzcyBTaW1wbGVHbHlwaCB7CiAgY29uc3RydWN0b3IoewogICAgY29udG91cnMsCiAgICBpbnN0cnVjdGlvbnMKICB9KSB7CiAgICB0aGlzLmNvbnRvdXJzID0gY29udG91cnM7CiAgICB0aGlzLmluc3RydWN0aW9ucyA9IGluc3RydWN0aW9uczsKICB9CgogIHN0YXRpYyBwYXJzZShwb3MsIGdseWYsIG51bWJlck9mQ29udG91cnMpIHsKICAgIGNvbnN0IGVuZFB0c09mQ29udG91cnMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlck9mQ29udG91cnM7IGkrKykgewogICAgICBjb25zdCBlbmRQdCA9IGdseWYuZ2V0VWludDE2KHBvcyk7CiAgICAgIHBvcyArPSAyOwogICAgICBlbmRQdHNPZkNvbnRvdXJzLnB1c2goZW5kUHQpOwogICAgfQoKICAgIGNvbnN0IG51bWJlck9mUHQgPSBlbmRQdHNPZkNvbnRvdXJzW251bWJlck9mQ29udG91cnMgLSAxXSArIDE7CiAgICBjb25zdCBpbnN0cnVjdGlvbkxlbmd0aCA9IGdseWYuZ2V0VWludDE2KHBvcyk7CiAgICBwb3MgKz0gMjsKICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IG5ldyBVaW50OEFycmF5KGdseWYpLnNsaWNlKHBvcywgcG9zICsgaW5zdHJ1Y3Rpb25MZW5ndGgpOwogICAgcG9zICs9IGluc3RydWN0aW9uTGVuZ3RoOwogICAgY29uc3QgZmxhZ3MgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlck9mUHQ7IHBvcysrLCBpKyspIHsKICAgICAgbGV0IGZsYWcgPSBnbHlmLmdldFVpbnQ4KHBvcyk7CiAgICAgIGZsYWdzLnB1c2goZmxhZyk7CgogICAgICBpZiAoZmxhZyAmIFJFUEVBVF9GTEFHKSB7CiAgICAgICAgY29uc3QgY291bnQgPSBnbHlmLmdldFVpbnQ4KCsrcG9zKTsKICAgICAgICBmbGFnIF49IFJFUEVBVF9GTEFHOwoKICAgICAgICBmb3IgKGxldCBtID0gMDsgbSA8IGNvdW50OyBtKyspIHsKICAgICAgICAgIGZsYWdzLnB1c2goZmxhZyk7CiAgICAgICAgfQoKICAgICAgICBpICs9IGNvdW50OwogICAgICB9CiAgICB9CgogICAgY29uc3QgYWxsWENvb3JkaW5hdGVzID0gW107CiAgICBsZXQgeENvb3JkaW5hdGVzID0gW107CiAgICBsZXQgeUNvb3JkaW5hdGVzID0gW107CiAgICBsZXQgcG9pbnRGbGFncyA9IFtdOwogICAgY29uc3QgY29udG91cnMgPSBbXTsKICAgIGxldCBlbmRQdHNPZkNvbnRvdXJzSW5kZXggPSAwOwogICAgbGV0IGxhc3RDb29yZGluYXRlID0gMDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlck9mUHQ7IGkrKykgewogICAgICBjb25zdCBmbGFnID0gZmxhZ3NbaV07CgogICAgICBpZiAoZmxhZyAmIFhfU0hPUlRfVkVDVE9SKSB7CiAgICAgICAgY29uc3QgeCA9IGdseWYuZ2V0VWludDgocG9zKyspOwogICAgICAgIGxhc3RDb29yZGluYXRlICs9IGZsYWcgJiBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1IgPyB4IDogLXg7CiAgICAgICAgeENvb3JkaW5hdGVzLnB1c2gobGFzdENvb3JkaW5hdGUpOwogICAgICB9IGVsc2UgaWYgKGZsYWcgJiBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1IpIHsKICAgICAgICB4Q29vcmRpbmF0ZXMucHVzaChsYXN0Q29vcmRpbmF0ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGFzdENvb3JkaW5hdGUgKz0gZ2x5Zi5nZXRJbnQxNihwb3MpOwogICAgICAgIHBvcyArPSAyOwogICAgICAgIHhDb29yZGluYXRlcy5wdXNoKGxhc3RDb29yZGluYXRlKTsKICAgICAgfQoKICAgICAgaWYgKGVuZFB0c09mQ29udG91cnNbZW5kUHRzT2ZDb250b3Vyc0luZGV4XSA9PT0gaSkgewogICAgICAgIGVuZFB0c09mQ29udG91cnNJbmRleCsrOwogICAgICAgIGFsbFhDb29yZGluYXRlcy5wdXNoKHhDb29yZGluYXRlcyk7CiAgICAgICAgeENvb3JkaW5hdGVzID0gW107CiAgICAgIH0KICAgIH0KCiAgICBsYXN0Q29vcmRpbmF0ZSA9IDA7CiAgICBlbmRQdHNPZkNvbnRvdXJzSW5kZXggPSAwOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZQdDsgaSsrKSB7CiAgICAgIGNvbnN0IGZsYWcgPSBmbGFnc1tpXTsKCiAgICAgIGlmIChmbGFnICYgWV9TSE9SVF9WRUNUT1IpIHsKICAgICAgICBjb25zdCB5ID0gZ2x5Zi5nZXRVaW50OChwb3MrKyk7CiAgICAgICAgbGFzdENvb3JkaW5hdGUgKz0gZmxhZyAmIFlfSVNfU0FNRV9PUl9QT1NJVElWRV9ZX1NIT1JUX1ZFQ1RPUiA/IHkgOiAteTsKICAgICAgICB5Q29vcmRpbmF0ZXMucHVzaChsYXN0Q29vcmRpbmF0ZSk7CiAgICAgIH0gZWxzZSBpZiAoZmxhZyAmIFlfSVNfU0FNRV9PUl9QT1NJVElWRV9ZX1NIT1JUX1ZFQ1RPUikgewogICAgICAgIHlDb29yZGluYXRlcy5wdXNoKGxhc3RDb29yZGluYXRlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsYXN0Q29vcmRpbmF0ZSArPSBnbHlmLmdldEludDE2KHBvcyk7CiAgICAgICAgcG9zICs9IDI7CiAgICAgICAgeUNvb3JkaW5hdGVzLnB1c2gobGFzdENvb3JkaW5hdGUpOwogICAgICB9CgogICAgICBwb2ludEZsYWdzLnB1c2goZmxhZyAmIE9OX0NVUlZFX1BPSU5UIHwgZmxhZyAmIE9WRVJMQVBfU0lNUExFKTsKCiAgICAgIGlmIChlbmRQdHNPZkNvbnRvdXJzW2VuZFB0c09mQ29udG91cnNJbmRleF0gPT09IGkpIHsKICAgICAgICB4Q29vcmRpbmF0ZXMgPSBhbGxYQ29vcmRpbmF0ZXNbZW5kUHRzT2ZDb250b3Vyc0luZGV4XTsKICAgICAgICBlbmRQdHNPZkNvbnRvdXJzSW5kZXgrKzsKICAgICAgICBjb250b3Vycy5wdXNoKG5ldyBDb250b3VyKHsKICAgICAgICAgIGZsYWdzOiBwb2ludEZsYWdzLAogICAgICAgICAgeENvb3JkaW5hdGVzLAogICAgICAgICAgeUNvb3JkaW5hdGVzCiAgICAgICAgfSkpOwogICAgICAgIHlDb29yZGluYXRlcyA9IFtdOwogICAgICAgIHBvaW50RmxhZ3MgPSBbXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXcgU2ltcGxlR2x5cGgoewogICAgICBjb250b3VycywKICAgICAgaW5zdHJ1Y3Rpb25zCiAgICB9KTsKICB9CgogIGdldFNpemUoKSB7CiAgICBsZXQgc2l6ZSA9IHRoaXMuY29udG91cnMubGVuZ3RoICogMiArIDIgKyB0aGlzLmluc3RydWN0aW9ucy5sZW5ndGg7CiAgICBsZXQgbGFzdFggPSAwOwogICAgbGV0IGxhc3RZID0gMDsKCiAgICBmb3IgKGNvbnN0IGNvbnRvdXIgb2YgdGhpcy5jb250b3VycykgewogICAgICBzaXplICs9IGNvbnRvdXIuZmxhZ3MubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gY29udG91ci54Q29vcmRpbmF0ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IHggPSBjb250b3VyLnhDb29yZGluYXRlc1tpXTsKICAgICAgICBjb25zdCB5ID0gY29udG91ci55Q29vcmRpbmF0ZXNbaV07CiAgICAgICAgbGV0IGFicyA9IE1hdGguYWJzKHggLSBsYXN0WCk7CgogICAgICAgIGlmIChhYnMgPiAyNTUpIHsKICAgICAgICAgIHNpemUgKz0gMjsKICAgICAgICB9IGVsc2UgaWYgKGFicyA+IDApIHsKICAgICAgICAgIHNpemUgKz0gMTsKICAgICAgICB9CgogICAgICAgIGxhc3RYID0geDsKICAgICAgICBhYnMgPSBNYXRoLmFicyh5IC0gbGFzdFkpOwoKICAgICAgICBpZiAoYWJzID4gMjU1KSB7CiAgICAgICAgICBzaXplICs9IDI7CiAgICAgICAgfSBlbHNlIGlmIChhYnMgPiAwKSB7CiAgICAgICAgICBzaXplICs9IDE7CiAgICAgICAgfQoKICAgICAgICBsYXN0WSA9IHk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc2l6ZTsKICB9CgogIHdyaXRlKHBvcywgYnVmKSB7CiAgICBjb25zdCBzcG9zID0gcG9zOwogICAgY29uc3QgeENvb3JkaW5hdGVzID0gW107CiAgICBjb25zdCB5Q29vcmRpbmF0ZXMgPSBbXTsKICAgIGNvbnN0IGZsYWdzID0gW107CiAgICBsZXQgbGFzdFggPSAwOwogICAgbGV0IGxhc3RZID0gMDsKCiAgICBmb3IgKGNvbnN0IGNvbnRvdXIgb2YgdGhpcy5jb250b3VycykgewogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb250b3VyLnhDb29yZGluYXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgbGV0IGZsYWcgPSBjb250b3VyLmZsYWdzW2ldOwogICAgICAgIGNvbnN0IHggPSBjb250b3VyLnhDb29yZGluYXRlc1tpXTsKICAgICAgICBsZXQgZGVsdGEgPSB4IC0gbGFzdFg7CgogICAgICAgIGlmIChkZWx0YSA9PT0gMCkgewogICAgICAgICAgZmxhZyB8PSBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1I7CiAgICAgICAgICB4Q29vcmRpbmF0ZXMucHVzaCgwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgYWJzID0gTWF0aC5hYnMoZGVsdGEpOwoKICAgICAgICAgIGlmIChhYnMgPD0gMjU1KSB7CiAgICAgICAgICAgIGZsYWcgfD0gZGVsdGEgPj0gMCA/IFhfU0hPUlRfVkVDVE9SIHwgWF9JU19TQU1FX09SX1BPU0lUSVZFX1hfU0hPUlRfVkVDVE9SIDogWF9TSE9SVF9WRUNUT1I7CiAgICAgICAgICAgIHhDb29yZGluYXRlcy5wdXNoKGFicyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB4Q29vcmRpbmF0ZXMucHVzaChkZWx0YSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBsYXN0WCA9IHg7CiAgICAgICAgY29uc3QgeSA9IGNvbnRvdXIueUNvb3JkaW5hdGVzW2ldOwogICAgICAgIGRlbHRhID0geSAtIGxhc3RZOwoKICAgICAgICBpZiAoZGVsdGEgPT09IDApIHsKICAgICAgICAgIGZsYWcgfD0gWV9JU19TQU1FX09SX1BPU0lUSVZFX1lfU0hPUlRfVkVDVE9SOwogICAgICAgICAgeUNvb3JkaW5hdGVzLnB1c2goMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGFicyA9IE1hdGguYWJzKGRlbHRhKTsKCiAgICAgICAgICBpZiAoYWJzIDw9IDI1NSkgewogICAgICAgICAgICBmbGFnIHw9IGRlbHRhID49IDAgPyBZX1NIT1JUX1ZFQ1RPUiB8IFlfSVNfU0FNRV9PUl9QT1NJVElWRV9ZX1NIT1JUX1ZFQ1RPUiA6IFlfU0hPUlRfVkVDVE9SOwogICAgICAgICAgICB5Q29vcmRpbmF0ZXMucHVzaChhYnMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgeUNvb3JkaW5hdGVzLnB1c2goZGVsdGEpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGFzdFkgPSB5OwogICAgICAgIGZsYWdzLnB1c2goZmxhZyk7CiAgICAgIH0KCiAgICAgIGJ1Zi5zZXRVaW50MTYocG9zLCB4Q29vcmRpbmF0ZXMubGVuZ3RoIC0gMSk7CiAgICAgIHBvcyArPSAyOwogICAgfQoKICAgIGJ1Zi5zZXRVaW50MTYocG9zLCB0aGlzLmluc3RydWN0aW9ucy5sZW5ndGgpOwogICAgcG9zICs9IDI7CgogICAgaWYgKHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCkgewogICAgICBuZXcgVWludDhBcnJheShidWYuYnVmZmVyLCAwLCBidWYuYnVmZmVyLmJ5dGVMZW5ndGgpLnNldCh0aGlzLmluc3RydWN0aW9ucywgcG9zKTsKICAgICAgcG9zICs9IHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aDsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGZsYWcgb2YgZmxhZ3MpIHsKICAgICAgYnVmLnNldFVpbnQ4KHBvcysrLCBmbGFnKTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB4Q29vcmRpbmF0ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCB4ID0geENvb3JkaW5hdGVzW2ldOwogICAgICBjb25zdCBmbGFnID0gZmxhZ3NbaV07CgogICAgICBpZiAoZmxhZyAmIFhfU0hPUlRfVkVDVE9SKSB7CiAgICAgICAgYnVmLnNldFVpbnQ4KHBvcysrLCB4KTsKICAgICAgfSBlbHNlIGlmICghKGZsYWcgJiBYX0lTX1NBTUVfT1JfUE9TSVRJVkVfWF9TSE9SVF9WRUNUT1IpKSB7CiAgICAgICAgYnVmLnNldEludDE2KHBvcywgeCk7CiAgICAgICAgcG9zICs9IDI7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB5Q29vcmRpbmF0ZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCB5ID0geUNvb3JkaW5hdGVzW2ldOwogICAgICBjb25zdCBmbGFnID0gZmxhZ3NbaV07CgogICAgICBpZiAoZmxhZyAmIFlfU0hPUlRfVkVDVE9SKSB7CiAgICAgICAgYnVmLnNldFVpbnQ4KHBvcysrLCB5KTsKICAgICAgfSBlbHNlIGlmICghKGZsYWcgJiBZX0lTX1NBTUVfT1JfUE9TSVRJVkVfWV9TSE9SVF9WRUNUT1IpKSB7CiAgICAgICAgYnVmLnNldEludDE2KHBvcywgeSk7CiAgICAgICAgcG9zICs9IDI7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcG9zIC0gc3BvczsKICB9CgogIHNjYWxlKHgsIGZhY3RvcikgewogICAgZm9yIChjb25zdCBjb250b3VyIG9mIHRoaXMuY29udG91cnMpIHsKICAgICAgaWYgKGNvbnRvdXIueENvb3JkaW5hdGVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb250b3VyLnhDb29yZGluYXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29udG91ci54Q29vcmRpbmF0ZXNbaV0gPSBNYXRoLnJvdW5kKHggKyAoY29udG91ci54Q29vcmRpbmF0ZXNbaV0gLSB4KSAqIGZhY3Rvcik7CiAgICAgIH0KICAgIH0KICB9Cgp9CgpjbGFzcyBDb21wb3NpdGVHbHlwaCB7CiAgY29uc3RydWN0b3IoewogICAgZmxhZ3MsCiAgICBnbHlwaEluZGV4LAogICAgYXJndW1lbnQxLAogICAgYXJndW1lbnQyLAogICAgdHJhbnNmLAogICAgaW5zdHJ1Y3Rpb25zCiAgfSkgewogICAgdGhpcy5mbGFncyA9IGZsYWdzOwogICAgdGhpcy5nbHlwaEluZGV4ID0gZ2x5cGhJbmRleDsKICAgIHRoaXMuYXJndW1lbnQxID0gYXJndW1lbnQxOwogICAgdGhpcy5hcmd1bWVudDIgPSBhcmd1bWVudDI7CiAgICB0aGlzLnRyYW5zZiA9IHRyYW5zZjsKICAgIHRoaXMuaW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb25zOwogIH0KCiAgc3RhdGljIHBhcnNlKHBvcywgZ2x5ZikgewogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIGNvbnN0IHRyYW5zZiA9IFtdOwogICAgbGV0IGZsYWdzID0gZ2x5Zi5nZXRVaW50MTYocG9zKTsKICAgIGNvbnN0IGdseXBoSW5kZXggPSBnbHlmLmdldFVpbnQxNihwb3MgKyAyKTsKICAgIHBvcyArPSA0OwogICAgbGV0IGFyZ3VtZW50MSwgYXJndW1lbnQyOwoKICAgIGlmIChmbGFncyAmIEFSR18xX0FORF8yX0FSRV9XT1JEUykgewogICAgICBpZiAoZmxhZ3MgJiBBUkdTX0FSRV9YWV9WQUxVRVMpIHsKICAgICAgICBhcmd1bWVudDEgPSBnbHlmLmdldEludDE2KHBvcyk7CiAgICAgICAgYXJndW1lbnQyID0gZ2x5Zi5nZXRJbnQxNihwb3MgKyAyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhcmd1bWVudDEgPSBnbHlmLmdldFVpbnQxNihwb3MpOwogICAgICAgIGFyZ3VtZW50MiA9IGdseWYuZ2V0VWludDE2KHBvcyArIDIpOwogICAgICB9CgogICAgICBwb3MgKz0gNDsKICAgICAgZmxhZ3MgXj0gQVJHXzFfQU5EXzJfQVJFX1dPUkRTOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgICAgYXJndW1lbnQxID0gZ2x5Zi5nZXRJbnQ4KHBvcyk7CiAgICAgICAgYXJndW1lbnQyID0gZ2x5Zi5nZXRJbnQ4KHBvcyArIDEpOwogICAgICB9IGVsc2UgewogICAgICAgIGFyZ3VtZW50MSA9IGdseWYuZ2V0VWludDgocG9zKTsKICAgICAgICBhcmd1bWVudDIgPSBnbHlmLmdldFVpbnQ4KHBvcyArIDEpOwogICAgICB9CgogICAgICBwb3MgKz0gMjsKICAgIH0KCiAgICBpZiAoZmxhZ3MgJiBXRV9IQVZFX0FfU0NBTEUpIHsKICAgICAgdHJhbnNmLnB1c2goZ2x5Zi5nZXRVaW50MTYocG9zKSk7CiAgICAgIHBvcyArPSAyOwogICAgfSBlbHNlIGlmIChmbGFncyAmIFdFX0hBVkVfQU5fWF9BTkRfWV9TQ0FMRSkgewogICAgICB0cmFuc2YucHVzaChnbHlmLmdldFVpbnQxNihwb3MpLCBnbHlmLmdldFVpbnQxNihwb3MgKyAyKSk7CiAgICAgIHBvcyArPSA0OwogICAgfSBlbHNlIGlmIChmbGFncyAmIFdFX0hBVkVfQV9UV09fQllfVFdPKSB7CiAgICAgIHRyYW5zZi5wdXNoKGdseWYuZ2V0VWludDE2KHBvcyksIGdseWYuZ2V0VWludDE2KHBvcyArIDIpLCBnbHlmLmdldFVpbnQxNihwb3MgKyA0KSwgZ2x5Zi5nZXRVaW50MTYocG9zICsgNikpOwogICAgICBwb3MgKz0gODsKICAgIH0KCiAgICBsZXQgaW5zdHJ1Y3Rpb25zID0gbnVsbDsKCiAgICBpZiAoZmxhZ3MgJiBXRV9IQVZFX0lOU1RSVUNUSU9OUykgewogICAgICBjb25zdCBpbnN0cnVjdGlvbkxlbmd0aCA9IGdseWYuZ2V0VWludDE2KHBvcyk7CiAgICAgIHBvcyArPSAyOwogICAgICBpbnN0cnVjdGlvbnMgPSBuZXcgVWludDhBcnJheShnbHlmKS5zbGljZShwb3MsIHBvcyArIGluc3RydWN0aW9uTGVuZ3RoKTsKICAgICAgcG9zICs9IGluc3RydWN0aW9uTGVuZ3RoOwogICAgfQoKICAgIHJldHVybiBbcG9zIC0gc3BvcywgbmV3IENvbXBvc2l0ZUdseXBoKHsKICAgICAgZmxhZ3MsCiAgICAgIGdseXBoSW5kZXgsCiAgICAgIGFyZ3VtZW50MSwKICAgICAgYXJndW1lbnQyLAogICAgICB0cmFuc2YsCiAgICAgIGluc3RydWN0aW9ucwogICAgfSldOwogIH0KCiAgZ2V0U2l6ZSgpIHsKICAgIGxldCBzaXplID0gMiArIDIgKyB0aGlzLnRyYW5zZi5sZW5ndGggKiAyOwoKICAgIGlmICh0aGlzLmZsYWdzICYgV0VfSEFWRV9JTlNUUlVDVElPTlMpIHsKICAgICAgc2l6ZSArPSAyICsgdGhpcy5pbnN0cnVjdGlvbnMubGVuZ3RoOwogICAgfQoKICAgIHNpemUgKz0gMjsKCiAgICBpZiAodGhpcy5mbGFncyAmIDIpIHsKICAgICAgaWYgKCEodGhpcy5hcmd1bWVudDEgPj0gLTEyOCAmJiB0aGlzLmFyZ3VtZW50MSA8PSAxMjcgJiYgdGhpcy5hcmd1bWVudDIgPj0gLTEyOCAmJiB0aGlzLmFyZ3VtZW50MiA8PSAxMjcpKSB7CiAgICAgICAgc2l6ZSArPSAyOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoISh0aGlzLmFyZ3VtZW50MSA+PSAwICYmIHRoaXMuYXJndW1lbnQxIDw9IDI1NSAmJiB0aGlzLmFyZ3VtZW50MiA+PSAwICYmIHRoaXMuYXJndW1lbnQyIDw9IDI1NSkpIHsKICAgICAgICBzaXplICs9IDI7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc2l6ZTsKICB9CgogIHdyaXRlKHBvcywgYnVmKSB7CiAgICBjb25zdCBzcG9zID0gcG9zOwoKICAgIGlmICh0aGlzLmZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgIGlmICghKHRoaXMuYXJndW1lbnQxID49IC0xMjggJiYgdGhpcy5hcmd1bWVudDEgPD0gMTI3ICYmIHRoaXMuYXJndW1lbnQyID49IC0xMjggJiYgdGhpcy5hcmd1bWVudDIgPD0gMTI3KSkgewogICAgICAgIHRoaXMuZmxhZ3MgfD0gQVJHXzFfQU5EXzJfQVJFX1dPUkRTOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoISh0aGlzLmFyZ3VtZW50MSA+PSAwICYmIHRoaXMuYXJndW1lbnQxIDw9IDI1NSAmJiB0aGlzLmFyZ3VtZW50MiA+PSAwICYmIHRoaXMuYXJndW1lbnQyIDw9IDI1NSkpIHsKICAgICAgICB0aGlzLmZsYWdzIHw9IEFSR18xX0FORF8yX0FSRV9XT1JEUzsKICAgICAgfQogICAgfQoKICAgIGJ1Zi5zZXRVaW50MTYocG9zLCB0aGlzLmZsYWdzKTsKICAgIGJ1Zi5zZXRVaW50MTYocG9zICsgMiwgdGhpcy5nbHlwaEluZGV4KTsKICAgIHBvcyArPSA0OwoKICAgIGlmICh0aGlzLmZsYWdzICYgQVJHXzFfQU5EXzJfQVJFX1dPUkRTKSB7CiAgICAgIGlmICh0aGlzLmZsYWdzICYgQVJHU19BUkVfWFlfVkFMVUVTKSB7CiAgICAgICAgYnVmLnNldEludDE2KHBvcywgdGhpcy5hcmd1bWVudDEpOwogICAgICAgIGJ1Zi5zZXRJbnQxNihwb3MgKyAyLCB0aGlzLmFyZ3VtZW50Mik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnVmLnNldFVpbnQxNihwb3MsIHRoaXMuYXJndW1lbnQxKTsKICAgICAgICBidWYuc2V0VWludDE2KHBvcyArIDIsIHRoaXMuYXJndW1lbnQyKTsKICAgICAgfQoKICAgICAgcG9zICs9IDQ7CiAgICB9IGVsc2UgewogICAgICBidWYuc2V0VWludDgocG9zLCB0aGlzLmFyZ3VtZW50MSk7CiAgICAgIGJ1Zi5zZXRVaW50OChwb3MgKyAxLCB0aGlzLmFyZ3VtZW50Mik7CiAgICAgIHBvcyArPSAyOwogICAgfQoKICAgIGlmICh0aGlzLmZsYWdzICYgV0VfSEFWRV9JTlNUUlVDVElPTlMpIHsKICAgICAgYnVmLnNldFVpbnQxNihwb3MsIHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCk7CiAgICAgIHBvcyArPSAyOwoKICAgICAgaWYgKHRoaXMuaW5zdHJ1Y3Rpb25zLmxlbmd0aCkgewogICAgICAgIG5ldyBVaW50OEFycmF5KGJ1Zi5idWZmZXIsIDAsIGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkuc2V0KHRoaXMuaW5zdHJ1Y3Rpb25zLCBwb3MpOwogICAgICAgIHBvcyArPSB0aGlzLmluc3RydWN0aW9ucy5sZW5ndGg7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcG9zIC0gc3BvczsKICB9CgogIHNjYWxlKHgsIGZhY3Rvcikge30KCn0KCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9wZW5UeXBlRmlsZUJ1aWxkZXIgPSB2b2lkIDA7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmZ1bmN0aW9uIHdyaXRlSW50MTYoZGVzdCwgb2Zmc2V0LCBudW0pIHsKICBkZXN0W29mZnNldF0gPSBudW0gPj4gOCAmIDB4ZmY7CiAgZGVzdFtvZmZzZXQgKyAxXSA9IG51bSAmIDB4ZmY7Cn0KCmZ1bmN0aW9uIHdyaXRlSW50MzIoZGVzdCwgb2Zmc2V0LCBudW0pIHsKICBkZXN0W29mZnNldF0gPSBudW0gPj4gMjQgJiAweGZmOwogIGRlc3Rbb2Zmc2V0ICsgMV0gPSBudW0gPj4gMTYgJiAweGZmOwogIGRlc3Rbb2Zmc2V0ICsgMl0gPSBudW0gPj4gOCAmIDB4ZmY7CiAgZGVzdFtvZmZzZXQgKyAzXSA9IG51bSAmIDB4ZmY7Cn0KCmZ1bmN0aW9uIHdyaXRlRGF0YShkZXN0LCBvZmZzZXQsIGRhdGEpIHsKICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgIGRlc3Quc2V0KGRhdGEsIG9mZnNldCk7CiAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIpIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGRhdGEubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBkZXN0W29mZnNldCsrXSA9IGRhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmY7CiAgICB9CiAgfSBlbHNlIHsKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGRhdGEubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBkZXN0W29mZnNldCsrXSA9IGRhdGFbaV0gJiAweGZmOwogICAgfQogIH0KfQoKY29uc3QgT1RGX0hFQURFUl9TSVpFID0gMTI7CmNvbnN0IE9URl9UQUJMRV9FTlRSWV9TSVpFID0gMTY7CgpjbGFzcyBPcGVuVHlwZUZpbGVCdWlsZGVyIHsKICBjb25zdHJ1Y3RvcihzZm50KSB7CiAgICB0aGlzLnNmbnQgPSBzZm50OwogICAgdGhpcy50YWJsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgc3RhdGljIGdldFNlYXJjaFBhcmFtcyhlbnRyaWVzQ291bnQsIGVudHJ5U2l6ZSkgewogICAgbGV0IG1heFBvd2VyMiA9IDEsCiAgICAgICAgbG9nMiA9IDA7CgogICAgd2hpbGUgKChtYXhQb3dlcjIgXiBlbnRyaWVzQ291bnQpID4gbWF4UG93ZXIyKSB7CiAgICAgIG1heFBvd2VyMiA8PD0gMTsKICAgICAgbG9nMisrOwogICAgfQoKICAgIGNvbnN0IHNlYXJjaFJhbmdlID0gbWF4UG93ZXIyICogZW50cnlTaXplOwogICAgcmV0dXJuIHsKICAgICAgcmFuZ2U6IHNlYXJjaFJhbmdlLAogICAgICBlbnRyeTogbG9nMiwKICAgICAgcmFuZ2VTaGlmdDogZW50cnlTaXplICogZW50cmllc0NvdW50IC0gc2VhcmNoUmFuZ2UKICAgIH07CiAgfQoKICB0b0FycmF5KCkgewogICAgbGV0IHNmbnQgPSB0aGlzLnNmbnQ7CiAgICBjb25zdCB0YWJsZXMgPSB0aGlzLnRhYmxlczsKICAgIGNvbnN0IHRhYmxlc05hbWVzID0gT2JqZWN0LmtleXModGFibGVzKTsKICAgIHRhYmxlc05hbWVzLnNvcnQoKTsKICAgIGNvbnN0IG51bVRhYmxlcyA9IHRhYmxlc05hbWVzLmxlbmd0aDsKICAgIGxldCBpLCBqLCBqaiwgdGFibGUsIHRhYmxlTmFtZTsKICAgIGxldCBvZmZzZXQgPSBPVEZfSEVBREVSX1NJWkUgKyBudW1UYWJsZXMgKiBPVEZfVEFCTEVfRU5UUllfU0laRTsKICAgIGNvbnN0IHRhYmxlT2Zmc2V0cyA9IFtvZmZzZXRdOwoKICAgIGZvciAoaSA9IDA7IGkgPCBudW1UYWJsZXM7IGkrKykgewogICAgICB0YWJsZSA9IHRhYmxlc1t0YWJsZXNOYW1lc1tpXV07CiAgICAgIGNvbnN0IHBhZGRlZExlbmd0aCA9ICh0YWJsZS5sZW5ndGggKyAzICYgfjMpID4+PiAwOwogICAgICBvZmZzZXQgKz0gcGFkZGVkTGVuZ3RoOwogICAgICB0YWJsZU9mZnNldHMucHVzaChvZmZzZXQpOwogICAgfQoKICAgIGNvbnN0IGZpbGUgPSBuZXcgVWludDhBcnJheShvZmZzZXQpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBudW1UYWJsZXM7IGkrKykgewogICAgICB0YWJsZSA9IHRhYmxlc1t0YWJsZXNOYW1lc1tpXV07CiAgICAgIHdyaXRlRGF0YShmaWxlLCB0YWJsZU9mZnNldHNbaV0sIHRhYmxlKTsKICAgIH0KCiAgICBpZiAoc2ZudCA9PT0gInRydWUiKSB7CiAgICAgIHNmbnQgPSAoMCwgX3V0aWwuc3RyaW5nMzIpKDB4MDAwMTAwMDApOwogICAgfQoKICAgIGZpbGVbMF0gPSBzZm50LmNoYXJDb2RlQXQoMCkgJiAweGZmOwogICAgZmlsZVsxXSA9IHNmbnQuY2hhckNvZGVBdCgxKSAmIDB4ZmY7CiAgICBmaWxlWzJdID0gc2ZudC5jaGFyQ29kZUF0KDIpICYgMHhmZjsKICAgIGZpbGVbM10gPSBzZm50LmNoYXJDb2RlQXQoMykgJiAweGZmOwogICAgd3JpdGVJbnQxNihmaWxlLCA0LCBudW1UYWJsZXMpOwogICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gT3BlblR5cGVGaWxlQnVpbGRlci5nZXRTZWFyY2hQYXJhbXMobnVtVGFibGVzLCAxNik7CiAgICB3cml0ZUludDE2KGZpbGUsIDYsIHNlYXJjaFBhcmFtcy5yYW5nZSk7CiAgICB3cml0ZUludDE2KGZpbGUsIDgsIHNlYXJjaFBhcmFtcy5lbnRyeSk7CiAgICB3cml0ZUludDE2KGZpbGUsIDEwLCBzZWFyY2hQYXJhbXMucmFuZ2VTaGlmdCk7CiAgICBvZmZzZXQgPSBPVEZfSEVBREVSX1NJWkU7CgogICAgZm9yIChpID0gMDsgaSA8IG51bVRhYmxlczsgaSsrKSB7CiAgICAgIHRhYmxlTmFtZSA9IHRhYmxlc05hbWVzW2ldOwogICAgICBmaWxlW29mZnNldF0gPSB0YWJsZU5hbWUuY2hhckNvZGVBdCgwKSAmIDB4ZmY7CiAgICAgIGZpbGVbb2Zmc2V0ICsgMV0gPSB0YWJsZU5hbWUuY2hhckNvZGVBdCgxKSAmIDB4ZmY7CiAgICAgIGZpbGVbb2Zmc2V0ICsgMl0gPSB0YWJsZU5hbWUuY2hhckNvZGVBdCgyKSAmIDB4ZmY7CiAgICAgIGZpbGVbb2Zmc2V0ICsgM10gPSB0YWJsZU5hbWUuY2hhckNvZGVBdCgzKSAmIDB4ZmY7CiAgICAgIGxldCBjaGVja3N1bSA9IDA7CgogICAgICBmb3IgKGogPSB0YWJsZU9mZnNldHNbaV0sIGpqID0gdGFibGVPZmZzZXRzW2kgKyAxXTsgaiA8IGpqOyBqICs9IDQpIHsKICAgICAgICBjb25zdCBxdWFkID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGZpbGUsIGopOwogICAgICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gKyBxdWFkID4+PiAwOwogICAgICB9CgogICAgICB3cml0ZUludDMyKGZpbGUsIG9mZnNldCArIDQsIGNoZWNrc3VtKTsKICAgICAgd3JpdGVJbnQzMihmaWxlLCBvZmZzZXQgKyA4LCB0YWJsZU9mZnNldHNbaV0pOwogICAgICB3cml0ZUludDMyKGZpbGUsIG9mZnNldCArIDEyLCB0YWJsZXNbdGFibGVOYW1lXS5sZW5ndGgpOwogICAgICBvZmZzZXQgKz0gT1RGX1RBQkxFX0VOVFJZX1NJWkU7CiAgICB9CgogICAgcmV0dXJuIGZpbGU7CiAgfQoKICBhZGRUYWJsZSh0YWcsIGRhdGEpIHsKICAgIGlmICh0YWcgaW4gdGhpcy50YWJsZXMpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJUYWJsZSAiICsgdGFnICsgIiBhbHJlYWR5IGV4aXN0cyIpOwogICAgfQoKICAgIHRoaXMudGFibGVzW3RhZ10gPSBkYXRhOwogIH0KCn0KCmV4cG9ydHMuT3BlblR5cGVGaWxlQnVpbGRlciA9IE9wZW5UeXBlRmlsZUJ1aWxkZXI7CgovKioqLyB9KSwKLyogNDggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5UeXBlMUZvbnQgPSB2b2lkIDA7Cgp2YXIgX2NmZl9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM1KTsKCnZhciBfZm9udHNfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM4KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwoKdmFyIF90eXBlMV9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ5KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpmdW5jdGlvbiBmaW5kQmxvY2soc3RyZWFtQnl0ZXMsIHNpZ25hdHVyZSwgc3RhcnRJbmRleCkgewogIGNvbnN0IHN0cmVhbUJ5dGVzTGVuZ3RoID0gc3RyZWFtQnl0ZXMubGVuZ3RoOwogIGNvbnN0IHNpZ25hdHVyZUxlbmd0aCA9IHNpZ25hdHVyZS5sZW5ndGg7CiAgY29uc3Qgc2Nhbkxlbmd0aCA9IHN0cmVhbUJ5dGVzTGVuZ3RoIC0gc2lnbmF0dXJlTGVuZ3RoOwogIGxldCBpID0gc3RhcnRJbmRleCwKICAgICAgZm91bmQgPSBmYWxzZTsKCiAgd2hpbGUgKGkgPCBzY2FuTGVuZ3RoKSB7CiAgICBsZXQgaiA9IDA7CgogICAgd2hpbGUgKGogPCBzaWduYXR1cmVMZW5ndGggJiYgc3RyZWFtQnl0ZXNbaSArIGpdID09PSBzaWduYXR1cmVbal0pIHsKICAgICAgaisrOwogICAgfQoKICAgIGlmIChqID49IHNpZ25hdHVyZUxlbmd0aCkgewogICAgICBpICs9IGo7CgogICAgICB3aGlsZSAoaSA8IHN0cmVhbUJ5dGVzTGVuZ3RoICYmICgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKHN0cmVhbUJ5dGVzW2ldKSkgewogICAgICAgIGkrKzsKICAgICAgfQoKICAgICAgZm91bmQgPSB0cnVlOwogICAgICBicmVhazsKICAgIH0KCiAgICBpKys7CiAgfQoKICByZXR1cm4gewogICAgZm91bmQsCiAgICBsZW5ndGg6IGkKICB9Owp9CgpmdW5jdGlvbiBnZXRIZWFkZXJCbG9jayhzdHJlYW0sIHN1Z2dlc3RlZExlbmd0aCkgewogIGNvbnN0IEVFWEVDX1NJR05BVFVSRSA9IFsweDY1LCAweDY1LCAweDc4LCAweDY1LCAweDYzXTsKICBjb25zdCBzdHJlYW1TdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgbGV0IGhlYWRlckJ5dGVzLCBoZWFkZXJCeXRlc0xlbmd0aCwgYmxvY2s7CgogIHRyeSB7CiAgICBoZWFkZXJCeXRlcyA9IHN0cmVhbS5nZXRCeXRlcyhzdWdnZXN0ZWRMZW5ndGgpOwogICAgaGVhZGVyQnl0ZXNMZW5ndGggPSBoZWFkZXJCeXRlcy5sZW5ndGg7CiAgfSBjYXRjaCAoZXgpIHt9CgogIGlmIChoZWFkZXJCeXRlc0xlbmd0aCA9PT0gc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgICBibG9jayA9IGZpbmRCbG9jayhoZWFkZXJCeXRlcywgRUVYRUNfU0lHTkFUVVJFLCBzdWdnZXN0ZWRMZW5ndGggLSAyICogRUVYRUNfU0lHTkFUVVJFLmxlbmd0aCk7CgogICAgaWYgKGJsb2NrLmZvdW5kICYmIGJsb2NrLmxlbmd0aCA9PT0gc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc3RyZWFtOiBuZXcgX3N0cmVhbS5TdHJlYW0oaGVhZGVyQnl0ZXMpLAogICAgICAgIGxlbmd0aDogc3VnZ2VzdGVkTGVuZ3RoCiAgICAgIH07CiAgICB9CiAgfQoKICAoMCwgX3V0aWwud2FybikoJ0ludmFsaWQgIkxlbmd0aDEiIHByb3BlcnR5IGluIFR5cGUxIGZvbnQgLS0gdHJ5aW5nIHRvIHJlY292ZXIuJyk7CiAgc3RyZWFtLnBvcyA9IHN0cmVhbVN0YXJ0UG9zOwogIGNvbnN0IFNDQU5fQkxPQ0tfTEVOR1RIID0gMjA0ODsKICBsZXQgYWN0dWFsTGVuZ3RoOwoKICB3aGlsZSAodHJ1ZSkgewogICAgY29uc3Qgc2NhbkJ5dGVzID0gc3RyZWFtLnBlZWtCeXRlcyhTQ0FOX0JMT0NLX0xFTkdUSCk7CiAgICBibG9jayA9IGZpbmRCbG9jayhzY2FuQnl0ZXMsIEVFWEVDX1NJR05BVFVSRSwgMCk7CgogICAgaWYgKGJsb2NrLmxlbmd0aCA9PT0gMCkgewogICAgICBicmVhazsKICAgIH0KCiAgICBzdHJlYW0ucG9zICs9IGJsb2NrLmxlbmd0aDsKCiAgICBpZiAoYmxvY2suZm91bmQpIHsKICAgICAgYWN0dWFsTGVuZ3RoID0gc3RyZWFtLnBvcyAtIHN0cmVhbVN0YXJ0UG9zOwogICAgICBicmVhazsKICAgIH0KICB9CgogIHN0cmVhbS5wb3MgPSBzdHJlYW1TdGFydFBvczsKCiAgaWYgKGFjdHVhbExlbmd0aCkgewogICAgcmV0dXJuIHsKICAgICAgc3RyZWFtOiBuZXcgX3N0cmVhbS5TdHJlYW0oc3RyZWFtLmdldEJ5dGVzKGFjdHVhbExlbmd0aCkpLAogICAgICBsZW5ndGg6IGFjdHVhbExlbmd0aAogICAgfTsKICB9CgogICgwLCBfdXRpbC53YXJuKSgnVW5hYmxlIHRvIHJlY292ZXIgIkxlbmd0aDEiIHByb3BlcnR5IGluIFR5cGUxIGZvbnQgLS0gdXNpbmcgYXMgaXMuJyk7CiAgcmV0dXJuIHsKICAgIHN0cmVhbTogbmV3IF9zdHJlYW0uU3RyZWFtKHN0cmVhbS5nZXRCeXRlcyhzdWdnZXN0ZWRMZW5ndGgpKSwKICAgIGxlbmd0aDogc3VnZ2VzdGVkTGVuZ3RoCiAgfTsKfQoKZnVuY3Rpb24gZ2V0RWV4ZWNCbG9jayhzdHJlYW0sIHN1Z2dlc3RlZExlbmd0aCkgewogIGNvbnN0IGVleGVjQnl0ZXMgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICByZXR1cm4gewogICAgc3RyZWFtOiBuZXcgX3N0cmVhbS5TdHJlYW0oZWV4ZWNCeXRlcyksCiAgICBsZW5ndGg6IGVleGVjQnl0ZXMubGVuZ3RoCiAgfTsKfQoKY2xhc3MgVHlwZTFGb250IHsKICBjb25zdHJ1Y3RvcihuYW1lLCBmaWxlLCBwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCBQRkJfSEVBREVSX1NJWkUgPSA2OwogICAgbGV0IGhlYWRlckJsb2NrTGVuZ3RoID0gcHJvcGVydGllcy5sZW5ndGgxOwogICAgbGV0IGVleGVjQmxvY2tMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDI7CiAgICBsZXQgcGZiSGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoUEZCX0hFQURFUl9TSVpFKTsKICAgIGNvbnN0IHBmYkhlYWRlclByZXNlbnQgPSBwZmJIZWFkZXJbMF0gPT09IDB4ODAgJiYgcGZiSGVhZGVyWzFdID09PSAweDAxOwoKICAgIGlmIChwZmJIZWFkZXJQcmVzZW50KSB7CiAgICAgIGZpbGUuc2tpcChQRkJfSEVBREVSX1NJWkUpOwogICAgICBoZWFkZXJCbG9ja0xlbmd0aCA9IHBmYkhlYWRlcls1XSA8PCAyNCB8IHBmYkhlYWRlcls0XSA8PCAxNiB8IHBmYkhlYWRlclszXSA8PCA4IHwgcGZiSGVhZGVyWzJdOwogICAgfQoKICAgIGNvbnN0IGhlYWRlckJsb2NrID0gZ2V0SGVhZGVyQmxvY2soZmlsZSwgaGVhZGVyQmxvY2tMZW5ndGgpOwogICAgY29uc3QgaGVhZGVyQmxvY2tQYXJzZXIgPSBuZXcgX3R5cGUxX3BhcnNlci5UeXBlMVBhcnNlcihoZWFkZXJCbG9jay5zdHJlYW0sIGZhbHNlLCBfZm9udHNfdXRpbHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgIGhlYWRlckJsb2NrUGFyc2VyLmV4dHJhY3RGb250SGVhZGVyKHByb3BlcnRpZXMpOwoKICAgIGlmIChwZmJIZWFkZXJQcmVzZW50KSB7CiAgICAgIHBmYkhlYWRlciA9IGZpbGUuZ2V0Qnl0ZXMoUEZCX0hFQURFUl9TSVpFKTsKICAgICAgZWV4ZWNCbG9ja0xlbmd0aCA9IHBmYkhlYWRlcls1XSA8PCAyNCB8IHBmYkhlYWRlcls0XSA8PCAxNiB8IHBmYkhlYWRlclszXSA8PCA4IHwgcGZiSGVhZGVyWzJdOwogICAgfQoKICAgIGNvbnN0IGVleGVjQmxvY2sgPSBnZXRFZXhlY0Jsb2NrKGZpbGUsIGVleGVjQmxvY2tMZW5ndGgpOwogICAgY29uc3QgZWV4ZWNCbG9ja1BhcnNlciA9IG5ldyBfdHlwZTFfcGFyc2VyLlR5cGUxUGFyc2VyKGVleGVjQmxvY2suc3RyZWFtLCB0cnVlLCBfZm9udHNfdXRpbHMuU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgIGNvbnN0IGRhdGEgPSBlZXhlY0Jsb2NrUGFyc2VyLmV4dHJhY3RGb250UHJvZ3JhbShwcm9wZXJ0aWVzKTsKCiAgICBmb3IgKGNvbnN0IGtleSBpbiBkYXRhLnByb3BlcnRpZXMpIHsKICAgICAgcHJvcGVydGllc1trZXldID0gZGF0YS5wcm9wZXJ0aWVzW2tleV07CiAgICB9CgogICAgY29uc3QgY2hhcnN0cmluZ3MgPSBkYXRhLmNoYXJzdHJpbmdzOwogICAgY29uc3QgdHlwZTJDaGFyc3RyaW5ncyA9IHRoaXMuZ2V0VHlwZTJDaGFyc3RyaW5ncyhjaGFyc3RyaW5ncyk7CiAgICBjb25zdCBzdWJycyA9IHRoaXMuZ2V0VHlwZTJTdWJycyhkYXRhLnN1YnJzKTsKICAgIHRoaXMuY2hhcnN0cmluZ3MgPSBjaGFyc3RyaW5nczsKICAgIHRoaXMuZGF0YSA9IHRoaXMud3JhcChuYW1lLCB0eXBlMkNoYXJzdHJpbmdzLCB0aGlzLmNoYXJzdHJpbmdzLCBzdWJycywgcHJvcGVydGllcyk7CiAgICB0aGlzLnNlYWNzID0gdGhpcy5nZXRTZWFjcyhkYXRhLmNoYXJzdHJpbmdzKTsKICB9CgogIGdldCBudW1HbHlwaHMoKSB7CiAgICByZXR1cm4gdGhpcy5jaGFyc3RyaW5ncy5sZW5ndGggKyAxOwogIH0KCiAgZ2V0Q2hhcnNldCgpIHsKICAgIGNvbnN0IGNoYXJzZXQgPSBbIi5ub3RkZWYiXTsKCiAgICBmb3IgKGNvbnN0IHsKICAgICAgZ2x5cGhOYW1lCiAgICB9IG9mIHRoaXMuY2hhcnN0cmluZ3MpIHsKICAgICAgY2hhcnNldC5wdXNoKGdseXBoTmFtZSk7CiAgICB9CgogICAgcmV0dXJuIGNoYXJzZXQ7CiAgfQoKICBnZXRHbHlwaE1hcHBpbmcocHJvcGVydGllcykgewogICAgY29uc3QgY2hhcnN0cmluZ3MgPSB0aGlzLmNoYXJzdHJpbmdzOwoKICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICBjb25zdCBjaGFyQ29kZVRvR2x5cGhJZCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBmb3IgKGxldCBnbHlwaElkID0gMCwgY2hhcnN0cmluZ3NMZW4gPSBjaGFyc3RyaW5ncy5sZW5ndGg7IGdseXBoSWQgPCBjaGFyc3RyaW5nc0xlbjsgZ2x5cGhJZCsrKSB7CiAgICAgICAgY29uc3QgY2hhckNvZGUgPSBwcm9wZXJ0aWVzLmNNYXAuY2hhckNvZGVPZihnbHlwaElkKTsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkICsgMTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNoYXJDb2RlVG9HbHlwaElkOwogICAgfQoKICAgIGNvbnN0IGdseXBoTmFtZXMgPSBbIi5ub3RkZWYiXTsKICAgIGxldCBidWlsdEluRW5jb2RpbmcsIGdseXBoSWQ7CgogICAgZm9yIChnbHlwaElkID0gMDsgZ2x5cGhJZCA8IGNoYXJzdHJpbmdzLmxlbmd0aDsgZ2x5cGhJZCsrKSB7CiAgICAgIGdseXBoTmFtZXMucHVzaChjaGFyc3RyaW5nc1tnbHlwaElkXS5nbHlwaE5hbWUpOwogICAgfQoKICAgIGNvbnN0IGVuY29kaW5nID0gcHJvcGVydGllcy5idWlsdEluRW5jb2Rpbmc7CgogICAgaWYgKGVuY29kaW5nKSB7CiAgICAgIGJ1aWx0SW5FbmNvZGluZyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBmb3IgKGNvbnN0IGNoYXJDb2RlIGluIGVuY29kaW5nKSB7CiAgICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihlbmNvZGluZ1tjaGFyQ29kZV0pOwoKICAgICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgICBidWlsdEluRW5jb2RpbmdbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF9mb250c191dGlscy50eXBlMUZvbnRHbHlwaE1hcHBpbmcpKHByb3BlcnRpZXMsIGJ1aWx0SW5FbmNvZGluZywgZ2x5cGhOYW1lcyk7CiAgfQoKICBoYXNHbHlwaElkKGlkKSB7CiAgICBpZiAoaWQgPCAwIHx8IGlkID49IHRoaXMubnVtR2x5cGhzKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAoaWQgPT09IDApIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgY29uc3QgZ2x5cGggPSB0aGlzLmNoYXJzdHJpbmdzW2lkIC0gMV07CiAgICByZXR1cm4gZ2x5cGguY2hhcnN0cmluZy5sZW5ndGggPiAwOwogIH0KCiAgZ2V0U2VhY3MoY2hhcnN0cmluZ3MpIHsKICAgIGNvbnN0IHNlYWNNYXAgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGFyc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGNoYXJzdHJpbmcgPSBjaGFyc3RyaW5nc1tpXTsKCiAgICAgIGlmIChjaGFyc3RyaW5nLnNlYWMpIHsKICAgICAgICBzZWFjTWFwW2kgKyAxXSA9IGNoYXJzdHJpbmcuc2VhYzsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzZWFjTWFwOwogIH0KCiAgZ2V0VHlwZTJDaGFyc3RyaW5ncyh0eXBlMUNoYXJzdHJpbmdzKSB7CiAgICBjb25zdCB0eXBlMkNoYXJzdHJpbmdzID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdHlwZTFDaGFyc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHR5cGUyQ2hhcnN0cmluZ3MucHVzaCh0eXBlMUNoYXJzdHJpbmdzW2ldLmNoYXJzdHJpbmcpOwogICAgfQoKICAgIHJldHVybiB0eXBlMkNoYXJzdHJpbmdzOwogIH0KCiAgZ2V0VHlwZTJTdWJycyh0eXBlMVN1YnJzKSB7CiAgICBsZXQgYmlhcyA9IDA7CiAgICBjb25zdCBjb3VudCA9IHR5cGUxU3VicnMubGVuZ3RoOwoKICAgIGlmIChjb3VudCA8IDExMzMpIHsKICAgICAgYmlhcyA9IDEwNzsKICAgIH0gZWxzZSBpZiAoY291bnQgPCAzMzc2OSkgewogICAgICBiaWFzID0gMTEzMTsKICAgIH0gZWxzZSB7CiAgICAgIGJpYXMgPSAzMjc2ODsKICAgIH0KCiAgICBjb25zdCB0eXBlMlN1YnJzID0gW107CiAgICBsZXQgaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgYmlhczsgaSsrKSB7CiAgICAgIHR5cGUyU3VicnMucHVzaChbMHgwYl0pOwogICAgfQoKICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIHR5cGUyU3VicnMucHVzaCh0eXBlMVN1YnJzW2ldKTsKICAgIH0KCiAgICByZXR1cm4gdHlwZTJTdWJyczsKICB9CgogIHdyYXAobmFtZSwgZ2x5cGhzLCBjaGFyc3RyaW5ncywgc3VicnMsIHByb3BlcnRpZXMpIHsKICAgIGNvbnN0IGNmZiA9IG5ldyBfY2ZmX3BhcnNlci5DRkYoKTsKICAgIGNmZi5oZWFkZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGSGVhZGVyKDEsIDAsIDQsIDQpOwogICAgY2ZmLm5hbWVzID0gW25hbWVdOwogICAgY29uc3QgdG9wRGljdCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZUb3BEaWN0KCk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgidmVyc2lvbiIsIDM5MSk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiTm90aWNlIiwgMzkyKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJGdWxsTmFtZSIsIDM5Myk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiRmFtaWx5TmFtZSIsIDM5NCk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiV2VpZ2h0IiwgMzk1KTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJFbmNvZGluZyIsIG51bGwpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoIkZvbnRNYXRyaXgiLCBwcm9wZXJ0aWVzLmZvbnRNYXRyaXgpOwogICAgdG9wRGljdC5zZXRCeU5hbWUoIkZvbnRCQm94IiwgcHJvcGVydGllcy5iYm94KTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJjaGFyc2V0IiwgbnVsbCk7CiAgICB0b3BEaWN0LnNldEJ5TmFtZSgiQ2hhclN0cmluZ3MiLCBudWxsKTsKICAgIHRvcERpY3Quc2V0QnlOYW1lKCJQcml2YXRlIiwgbnVsbCk7CiAgICBjZmYudG9wRGljdCA9IHRvcERpY3Q7CiAgICBjb25zdCBzdHJpbmdzID0gbmV3IF9jZmZfcGFyc2VyLkNGRlN0cmluZ3MoKTsKICAgIHN0cmluZ3MuYWRkKCJWZXJzaW9uIDAuMTEiKTsKICAgIHN0cmluZ3MuYWRkKCJTZWUgb3JpZ2luYWwgbm90aWNlIik7CiAgICBzdHJpbmdzLmFkZChuYW1lKTsKICAgIHN0cmluZ3MuYWRkKG5hbWUpOwogICAgc3RyaW5ncy5hZGQoIk1lZGl1bSIpOwogICAgY2ZmLnN0cmluZ3MgPSBzdHJpbmdzOwogICAgY2ZmLmdsb2JhbFN1YnJJbmRleCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZJbmRleCgpOwogICAgY29uc3QgY291bnQgPSBnbHlwaHMubGVuZ3RoOwogICAgY29uc3QgY2hhcnNldEFycmF5ID0gWyIubm90ZGVmIl07CiAgICBsZXQgaSwgaWk7CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZ2x5cGhOYW1lID0gY2hhcnN0cmluZ3NbaV0uZ2x5cGhOYW1lOwoKICAgICAgY29uc3QgaW5kZXggPSBfY2ZmX3BhcnNlci5DRkZTdGFuZGFyZFN0cmluZ3MuaW5kZXhPZihnbHlwaE5hbWUpOwoKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIHN0cmluZ3MuYWRkKGdseXBoTmFtZSk7CiAgICAgIH0KCiAgICAgIGNoYXJzZXRBcnJheS5wdXNoKGdseXBoTmFtZSk7CiAgICB9CgogICAgY2ZmLmNoYXJzZXQgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ2hhcnNldChmYWxzZSwgMCwgY2hhcnNldEFycmF5KTsKICAgIGNvbnN0IGNoYXJTdHJpbmdzSW5kZXggPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGSW5kZXgoKTsKICAgIGNoYXJTdHJpbmdzSW5kZXguYWRkKFsweDhiLCAweDBlXSk7CgogICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQoZ2x5cGhzW2ldKTsKICAgIH0KCiAgICBjZmYuY2hhclN0cmluZ3MgPSBjaGFyU3RyaW5nc0luZGV4OwogICAgY29uc3QgcHJpdmF0ZURpY3QgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGUHJpdmF0ZURpY3QoKTsKICAgIHByaXZhdGVEaWN0LnNldEJ5TmFtZSgiU3VicnMiLCBudWxsKTsKICAgIGNvbnN0IGZpZWxkcyA9IFsiQmx1ZVZhbHVlcyIsICJPdGhlckJsdWVzIiwgIkZhbWlseUJsdWVzIiwgIkZhbWlseU90aGVyQmx1ZXMiLCAiU3RlbVNuYXBIIiwgIlN0ZW1TbmFwViIsICJCbHVlU2hpZnQiLCAiQmx1ZUZ1enoiLCAiQmx1ZVNjYWxlIiwgIkxhbmd1YWdlR3JvdXAiLCAiRXhwYW5zaW9uRmFjdG9yIiwgIkZvcmNlQm9sZCIsICJTdGRIVyIsICJTdGRWVyJdOwoKICAgIGZvciAoaSA9IDAsIGlpID0gZmllbGRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgZmllbGQgPSBmaWVsZHNbaV07CgogICAgICBpZiAoIShmaWVsZCBpbiBwcm9wZXJ0aWVzLnByaXZhdGVEYXRhKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCB2YWx1ZSA9IHByb3BlcnRpZXMucHJpdmF0ZURhdGFbZmllbGRdOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IHZhbHVlLmxlbmd0aCAtIDE7IGogPiAwOyBqLS0pIHsKICAgICAgICAgIHZhbHVlW2pdIC09IHZhbHVlW2ogLSAxXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHByaXZhdGVEaWN0LnNldEJ5TmFtZShmaWVsZCwgdmFsdWUpOwogICAgfQoKICAgIGNmZi50b3BEaWN0LnByaXZhdGVEaWN0ID0gcHJpdmF0ZURpY3Q7CiAgICBjb25zdCBzdWJySW5kZXggPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGSW5kZXgoKTsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IHN1YnJzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgc3VickluZGV4LmFkZChzdWJyc1tpXSk7CiAgICB9CgogICAgcHJpdmF0ZURpY3Quc3VicnNJbmRleCA9IHN1YnJJbmRleDsKICAgIGNvbnN0IGNvbXBpbGVyID0gbmV3IF9jZmZfcGFyc2VyLkNGRkNvbXBpbGVyKGNmZik7CiAgICByZXR1cm4gY29tcGlsZXIuY29tcGlsZSgpOwogIH0KCn0KCmV4cG9ydHMuVHlwZTFGb250ID0gVHlwZTFGb250OwoKLyoqKi8gfSksCi8qIDQ5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuVHlwZTFQYXJzZXIgPSB2b2lkIDA7Cgp2YXIgX2VuY29kaW5ncyA9IF9fd19wZGZqc19yZXF1aXJlX18oMzcpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgSElOVElOR19FTkFCTEVEID0gZmFsc2U7CmNvbnN0IENPTU1BTkRfTUFQID0gewogIGhzdGVtOiBbMV0sCiAgdnN0ZW06IFszXSwKICB2bW92ZXRvOiBbNF0sCiAgcmxpbmV0bzogWzVdLAogIGhsaW5ldG86IFs2XSwKICB2bGluZXRvOiBbN10sCiAgcnJjdXJ2ZXRvOiBbOF0sCiAgY2FsbHN1YnI6IFsxMF0sCiAgZmxleDogWzEyLCAzNV0sCiAgZHJvcDogWzEyLCAxOF0sCiAgZW5kY2hhcjogWzE0XSwKICBybW92ZXRvOiBbMjFdLAogIGhtb3ZldG86IFsyMl0sCiAgdmhjdXJ2ZXRvOiBbMzBdLAogIGh2Y3VydmV0bzogWzMxXQp9OwoKY2xhc3MgVHlwZTFDaGFyU3RyaW5nIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMud2lkdGggPSAwOwogICAgdGhpcy5sc2IgPSAwOwogICAgdGhpcy5mbGV4aW5nID0gZmFsc2U7CiAgICB0aGlzLm91dHB1dCA9IFtdOwogICAgdGhpcy5zdGFjayA9IFtdOwogIH0KCiAgY29udmVydChlbmNvZGVkLCBzdWJycywgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgY29uc3QgY291bnQgPSBlbmNvZGVkLmxlbmd0aDsKICAgIGxldCBlcnJvciA9IGZhbHNlOwogICAgbGV0IHd4LCBzYngsIHN1YnJOdW1iZXI7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIGxldCB2YWx1ZSA9IGVuY29kZWRbaV07CgogICAgICBpZiAodmFsdWUgPCAzMikgewogICAgICAgIGlmICh2YWx1ZSA9PT0gMTIpIHsKICAgICAgICAgIHZhbHVlID0gKHZhbHVlIDw8IDgpICsgZW5jb2RlZFsrK2ldOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoICh2YWx1ZSkgewogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLmhzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBpZiAodGhpcy5mbGV4aW5nKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb25zdCBkeSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKDAsIGR5KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEsIENPTU1BTkRfTUFQLnZtb3ZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5ybGluZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMSwgQ09NTUFORF9NQVAuaGxpbmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEsIENPTU1BTkRfTUFQLnZsaW5ldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg2LCBDT01NQU5EX01BUC5ycmN1cnZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vick51bWJlciA9IHRoaXMuc3RhY2sucG9wKCk7CgogICAgICAgICAgICBpZiAoIXN1YnJzW3N1YnJOdW1iZXJdKSB7CiAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlcnJvciA9IHRoaXMuY29udmVydChzdWJyc1tzdWJyTnVtYmVyXSwgc3VicnMsIHNlYWNBbmFseXNpc0VuYWJsZWQpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICByZXR1cm4gZXJyb3I7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd3ggPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICBzYnggPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICB0aGlzLmxzYiA9IHNieDsKICAgICAgICAgICAgdGhpcy53aWR0aCA9IHd4OwogICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2god3gsIHNieCk7CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5obW92ZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgdGhpcy5vdXRwdXQucHVzaChDT01NQU5EX01BUC5lbmRjaGFyWzBdKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgaWYgKHRoaXMuZmxleGluZykgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMiwgQ09NTUFORF9NQVAucm1vdmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGlmICh0aGlzLmZsZXhpbmcpIHsKICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2goMCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgxLCBDT01NQU5EX01BUC5obW92ZXRvKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDQsIENPTU1BTkRfTUFQLnZoY3VydmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC5odmN1cnZldG8pOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICgxMiA8PCA4KSArIDA6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAxOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAyOgogICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLmhzdGVtKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA2OgogICAgICAgICAgICBpZiAoc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgICAgICAgICAgIGNvbnN0IGFzYiA9IHRoaXMuc3RhY2suYXQoLTUpOwogICAgICAgICAgICAgIHRoaXMuc2VhYyA9IHRoaXMuc3RhY2suc3BsaWNlKC00LCA0KTsKICAgICAgICAgICAgICB0aGlzLnNlYWNbMF0gKz0gdGhpcy5sc2IgLSBhc2I7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDAsIENPTU1BTkRfTUFQLmVuZGNoYXIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC5lbmRjaGFyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA3OgogICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPCA0KSB7CiAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICB3eCA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvbnN0IHNieSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHNieCA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHRoaXMubHNiID0gc2J4OwogICAgICAgICAgICB0aGlzLndpZHRoID0gd3g7CiAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaCh3eCwgc2J4LCBzYnkpOwogICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMywgQ09NTUFORF9NQVAucm1vdmV0byk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMTI6CiAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICBlcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IG51bTIgPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICBjb25zdCBudW0xID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKG51bTEgLyBudW0yKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAxNjoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vick51bWJlciA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvbnN0IG51bUFyZ3MgPSB0aGlzLnN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKHN1YnJOdW1iZXIgPT09IDAgJiYgbnVtQXJncyA9PT0gMykgewogICAgICAgICAgICAgIGNvbnN0IGZsZXhBcmdzID0gdGhpcy5zdGFjay5zcGxpY2UodGhpcy5zdGFjay5sZW5ndGggLSAxNywgMTcpOwogICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaChmbGV4QXJnc1syXSArIGZsZXhBcmdzWzBdLCBmbGV4QXJnc1szXSArIGZsZXhBcmdzWzFdLCBmbGV4QXJnc1s0XSwgZmxleEFyZ3NbNV0sIGZsZXhBcmdzWzZdLCBmbGV4QXJnc1s3XSwgZmxleEFyZ3NbOF0sIGZsZXhBcmdzWzldLCBmbGV4QXJnc1sxMF0sIGZsZXhBcmdzWzExXSwgZmxleEFyZ3NbMTJdLCBmbGV4QXJnc1sxM10sIGZsZXhBcmdzWzE0XSk7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEzLCBDT01NQU5EX01BUC5mbGV4LCB0cnVlKTsKICAgICAgICAgICAgICB0aGlzLmZsZXhpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2goZmxleEFyZ3NbMTVdLCBmbGV4QXJnc1sxNl0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHN1YnJOdW1iZXIgPT09IDEgJiYgbnVtQXJncyA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuZmxleGluZyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMTc6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMzM6CiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCdVbmtub3duIHR5cGUgMSBjaGFyc3RyaW5nIGNvbW1hbmQgb2YgIicgKyB2YWx1ZSArICciJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9IGVsc2UgaWYgKHZhbHVlIDw9IDI0NikgewogICAgICAgIHZhbHVlIC09IDEzOTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8PSAyNTApIHsKICAgICAgICB2YWx1ZSA9ICh2YWx1ZSAtIDI0NykgKiAyNTYgKyBlbmNvZGVkWysraV0gKyAxMDg7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPD0gMjU0KSB7CiAgICAgICAgdmFsdWUgPSAtKCh2YWx1ZSAtIDI1MSkgKiAyNTYpIC0gZW5jb2RlZFsrK2ldIC0gMTA4OwogICAgICB9IGVsc2UgewogICAgICAgIHZhbHVlID0gKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDI0IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDE2IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDggfCAoZW5jb2RlZFsrK2ldICYgMHhmZikgPDwgMDsKICAgICAgfQoKICAgICAgdGhpcy5zdGFjay5wdXNoKHZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gZXJyb3I7CiAgfQoKICBleGVjdXRlQ29tbWFuZChob3dNYW55QXJncywgY29tbWFuZCwga2VlcFN0YWNrKSB7CiAgICBjb25zdCBzdGFja0xlbmd0aCA9IHRoaXMuc3RhY2subGVuZ3RoOwoKICAgIGlmIChob3dNYW55QXJncyA+IHN0YWNrTGVuZ3RoKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGNvbnN0IHN0YXJ0ID0gc3RhY2tMZW5ndGggLSBob3dNYW55QXJnczsKCiAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBzdGFja0xlbmd0aDsgaSsrKSB7CiAgICAgIGxldCB2YWx1ZSA9IHRoaXMuc3RhY2tbaV07CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkpIHsKICAgICAgICB0aGlzLm91dHB1dC5wdXNoKDI4LCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWx1ZSA9IDY1NTM2ICogdmFsdWUgfCAwOwogICAgICAgIHRoaXMub3V0cHV0LnB1c2goMjU1LCB2YWx1ZSA+PiAyNCAmIDB4ZmYsIHZhbHVlID4+IDE2ICYgMHhmZiwgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLm91dHB1dC5wdXNoKC4uLmNvbW1hbmQpOwoKICAgIGlmIChrZWVwU3RhY2spIHsKICAgICAgdGhpcy5zdGFjay5zcGxpY2Uoc3RhcnQsIGhvd01hbnlBcmdzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc3RhY2subGVuZ3RoID0gMDsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKfQoKY29uc3QgRUVYRUNfRU5DUllQVF9LRVkgPSA1NTY2NTsKY29uc3QgQ0hBUl9TVFJTX0VOQ1JZUFRfS0VZID0gNDMzMDsKCmZ1bmN0aW9uIGlzSGV4RGlnaXQoY29kZSkgewogIHJldHVybiBjb2RlID49IDQ4ICYmIGNvZGUgPD0gNTcgfHwgY29kZSA+PSA2NSAmJiBjb2RlIDw9IDcwIHx8IGNvZGUgPj0gOTcgJiYgY29kZSA8PSAxMDI7Cn0KCmZ1bmN0aW9uIGRlY3J5cHQoZGF0YSwga2V5LCBkaXNjYXJkTnVtYmVyKSB7CiAgaWYgKGRpc2NhcmROdW1iZXIgPj0gZGF0YS5sZW5ndGgpIHsKICAgIHJldHVybiBuZXcgVWludDhBcnJheSgwKTsKICB9CgogIGNvbnN0IGMxID0gNTI4NDUsCiAgICAgICAgYzIgPSAyMjcxOTsKICBsZXQgciA9IGtleSB8IDAsCiAgICAgIGksCiAgICAgIGo7CgogIGZvciAoaSA9IDA7IGkgPCBkaXNjYXJkTnVtYmVyOyBpKyspIHsKICAgIHIgPSAoZGF0YVtpXSArIHIpICogYzEgKyBjMiAmICgxIDw8IDE2KSAtIDE7CiAgfQoKICBjb25zdCBjb3VudCA9IGRhdGEubGVuZ3RoIC0gZGlzY2FyZE51bWJlcjsKICBjb25zdCBkZWNyeXB0ZWQgPSBuZXcgVWludDhBcnJheShjb3VudCk7CgogIGZvciAoaSA9IGRpc2NhcmROdW1iZXIsIGogPSAwOyBqIDwgY291bnQ7IGkrKywgaisrKSB7CiAgICBjb25zdCB2YWx1ZSA9IGRhdGFbaV07CiAgICBkZWNyeXB0ZWRbal0gPSB2YWx1ZSBeIHIgPj4gODsKICAgIHIgPSAodmFsdWUgKyByKSAqIGMxICsgYzIgJiAoMSA8PCAxNikgLSAxOwogIH0KCiAgcmV0dXJuIGRlY3J5cHRlZDsKfQoKZnVuY3Rpb24gZGVjcnlwdEFzY2lpKGRhdGEsIGtleSwgZGlzY2FyZE51bWJlcikgewogIGNvbnN0IGMxID0gNTI4NDUsCiAgICAgICAgYzIgPSAyMjcxOTsKICBsZXQgciA9IGtleSB8IDA7CiAgY29uc3QgY291bnQgPSBkYXRhLmxlbmd0aCwKICAgICAgICBtYXliZUxlbmd0aCA9IGNvdW50ID4+PiAxOwogIGNvbnN0IGRlY3J5cHRlZCA9IG5ldyBVaW50OEFycmF5KG1heWJlTGVuZ3RoKTsKICBsZXQgaSwgajsKCiAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICBjb25zdCBkaWdpdDEgPSBkYXRhW2ldOwoKICAgIGlmICghaXNIZXhEaWdpdChkaWdpdDEpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGkrKzsKICAgIGxldCBkaWdpdDI7CgogICAgd2hpbGUgKGkgPCBjb3VudCAmJiAhaXNIZXhEaWdpdChkaWdpdDIgPSBkYXRhW2ldKSkgewogICAgICBpKys7CiAgICB9CgogICAgaWYgKGkgPCBjb3VudCkgewogICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KFN0cmluZy5mcm9tQ2hhckNvZGUoZGlnaXQxLCBkaWdpdDIpLCAxNik7CiAgICAgIGRlY3J5cHRlZFtqKytdID0gdmFsdWUgXiByID4+IDg7CiAgICAgIHIgPSAodmFsdWUgKyByKSAqIGMxICsgYzIgJiAoMSA8PCAxNikgLSAxOwogICAgfQogIH0KCiAgcmV0dXJuIGRlY3J5cHRlZC5zbGljZShkaXNjYXJkTnVtYmVyLCBqKTsKfQoKZnVuY3Rpb24gaXNTcGVjaWFsKGMpIHsKICByZXR1cm4gYyA9PT0gMHgyZiB8fCBjID09PSAweDViIHx8IGMgPT09IDB4NWQgfHwgYyA9PT0gMHg3YiB8fCBjID09PSAweDdkIHx8IGMgPT09IDB4MjggfHwgYyA9PT0gMHgyOTsKfQoKY2xhc3MgVHlwZTFQYXJzZXIgewogIGNvbnN0cnVjdG9yKHN0cmVhbSwgZW5jcnlwdGVkLCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICBpZiAoZW5jcnlwdGVkKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgICAgY29uc3QgaXNCaW5hcnkgPSAhKChpc0hleERpZ2l0KGRhdGFbMF0pIHx8ICgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGRhdGFbMF0pKSAmJiBpc0hleERpZ2l0KGRhdGFbMV0pICYmIGlzSGV4RGlnaXQoZGF0YVsyXSkgJiYgaXNIZXhEaWdpdChkYXRhWzNdKSAmJiBpc0hleERpZ2l0KGRhdGFbNF0pICYmIGlzSGV4RGlnaXQoZGF0YVs1XSkgJiYgaXNIZXhEaWdpdChkYXRhWzZdKSAmJiBpc0hleERpZ2l0KGRhdGFbN10pKTsKICAgICAgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyZWFtKGlzQmluYXJ5ID8gZGVjcnlwdChkYXRhLCBFRVhFQ19FTkNSWVBUX0tFWSwgNCkgOiBkZWNyeXB0QXNjaWkoZGF0YSwgRUVYRUNfRU5DUllQVF9LRVksIDQpKTsKICAgIH0KCiAgICB0aGlzLnNlYWNBbmFseXNpc0VuYWJsZWQgPSAhIXNlYWNBbmFseXNpc0VuYWJsZWQ7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICB9CgogIHJlYWROdW1iZXJBcnJheSgpIHsKICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgIGNvbnN0IGFycmF5ID0gW107CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICBpZiAodG9rZW4gPT09IG51bGwgfHwgdG9rZW4gPT09ICJdIiB8fCB0b2tlbiA9PT0gIn0iKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGFycmF5LnB1c2gocGFyc2VGbG9hdCh0b2tlbiB8fCAwKSk7CiAgICB9CgogICAgcmV0dXJuIGFycmF5OwogIH0KCiAgcmVhZE51bWJlcigpIHsKICAgIGNvbnN0IHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwogICAgcmV0dXJuIHBhcnNlRmxvYXQodG9rZW4gfHwgMCk7CiAgfQoKICByZWFkSW50KCkgewogICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CiAgICByZXR1cm4gcGFyc2VJbnQodG9rZW4gfHwgMCwgMTApIHwgMDsKICB9CgogIHJlYWRCb29sZWFuKCkgewogICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CiAgICByZXR1cm4gdG9rZW4gPT09ICJ0cnVlIiA/IDEgOiAwOwogIH0KCiAgbmV4dENoYXIoKSB7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50Q2hhciA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICB9CgogIHByZXZDaGFyKCkgewogICAgdGhpcy5zdHJlYW0uc2tpcCgtMik7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50Q2hhciA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICB9CgogIGdldFRva2VuKCkgewogICAgbGV0IGNvbW1lbnQgPSBmYWxzZTsKICAgIGxldCBjaCA9IHRoaXMuY3VycmVudENoYXI7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAoY29tbWVudCkgewogICAgICAgIGlmIChjaCA9PT0gMHgwYSB8fCBjaCA9PT0gMHgwZCkgewogICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyNSkgewogICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgaWYgKGlzU3BlY2lhbChjaCkpIHsKICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CiAgICB9CgogICAgbGV0IHRva2VuID0gIiI7CgogICAgZG8gewogICAgICB0b2tlbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9IHdoaWxlIChjaCA+PSAwICYmICEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkgJiYgIWlzU3BlY2lhbChjaCkpOwoKICAgIHJldHVybiB0b2tlbjsKICB9CgogIHJlYWRDaGFyU3RyaW5ncyhieXRlcywgbGVuSVYpIHsKICAgIGlmIChsZW5JViA9PT0gLTEpIHsKICAgICAgcmV0dXJuIGJ5dGVzOwogICAgfQoKICAgIHJldHVybiBkZWNyeXB0KGJ5dGVzLCBDSEFSX1NUUlNfRU5DUllQVF9LRVksIGxlbklWKTsKICB9CgogIGV4dHJhY3RGb250UHJvZ3JhbShwcm9wZXJ0aWVzKSB7CiAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnN0cmVhbTsKICAgIGNvbnN0IHN1YnJzID0gW10sCiAgICAgICAgICBjaGFyc3RyaW5ncyA9IFtdOwogICAgY29uc3QgcHJpdmF0ZURhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgcHJpdmF0ZURhdGEubGVuSVYgPSA0OwogICAgY29uc3QgcHJvZ3JhbSA9IHsKICAgICAgc3VicnM6IFtdLAogICAgICBjaGFyc3RyaW5nczogW10sCiAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICBwcml2YXRlRGF0YQogICAgICB9CiAgICB9OwogICAgbGV0IHRva2VuLCBsZW5ndGgsIGRhdGEsIGxlbklWOwoKICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmdldFRva2VuKCkpICE9PSBudWxsKSB7CiAgICAgIGlmICh0b2tlbiAhPT0gIi8iKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwoKICAgICAgc3dpdGNoICh0b2tlbikgewogICAgICAgIGNhc2UgIkNoYXJTdHJpbmdzIjoKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCB8fCB0b2tlbiA9PT0gImVuZCIpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRva2VuICE9PSAiLyIpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZ2x5cGggPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMucmVhZEludCgpOwogICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIGRhdGEgPSBsZW5ndGggPiAwID8gc3RyZWFtLmdldEJ5dGVzKGxlbmd0aCkgOiBuZXcgVWludDhBcnJheSgwKTsKICAgICAgICAgICAgbGVuSVYgPSBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGEubGVuSVY7CiAgICAgICAgICAgIGNvbnN0IGVuY29kZWQgPSB0aGlzLnJlYWRDaGFyU3RyaW5ncyhkYXRhLCBsZW5JVik7CiAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgICBpZiAodG9rZW4gPT09ICJub2FjY2VzcyIpIHsKICAgICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4gPT09ICIvIikgewogICAgICAgICAgICAgIHRoaXMucHJldkNoYXIoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2hhcnN0cmluZ3MucHVzaCh7CiAgICAgICAgICAgICAgZ2x5cGgsCiAgICAgICAgICAgICAgZW5jb2RlZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiU3VicnMiOgogICAgICAgICAgdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgd2hpbGUgKHRoaXMuZ2V0VG9rZW4oKSA9PT0gImR1cCIpIHsKICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnJlYWRJbnQoKTsKICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgZGF0YSA9IGxlbmd0aCA+IDAgPyBzdHJlYW0uZ2V0Qnl0ZXMobGVuZ3RoKSA6IG5ldyBVaW50OEFycmF5KDApOwogICAgICAgICAgICBsZW5JViA9IHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YS5sZW5JVjsKICAgICAgICAgICAgY29uc3QgZW5jb2RlZCA9IHRoaXMucmVhZENoYXJTdHJpbmdzKGRhdGEsIGxlbklWKTsKICAgICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gIm5vYWNjZXNzIikgewogICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3VicnNbaW5kZXhdID0gZW5jb2RlZDsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiQmx1ZVZhbHVlcyI6CiAgICAgICAgY2FzZSAiT3RoZXJCbHVlcyI6CiAgICAgICAgY2FzZSAiRmFtaWx5Qmx1ZXMiOgogICAgICAgIGNhc2UgIkZhbWlseU90aGVyQmx1ZXMiOgogICAgICAgICAgY29uc3QgYmx1ZUFycmF5ID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKTsKCiAgICAgICAgICBpZiAoYmx1ZUFycmF5Lmxlbmd0aCA+IDAgJiYgYmx1ZUFycmF5Lmxlbmd0aCAlIDIgPT09IDAgJiYgSElOVElOR19FTkFCTEVEKSB7CiAgICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSBibHVlQXJyYXk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlN0ZW1TbmFwSCI6CiAgICAgICAgY2FzZSAiU3RlbVNuYXBWIjoKICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSB0aGlzLnJlYWROdW1iZXJBcnJheSgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlN0ZEhXIjoKICAgICAgICBjYXNlICJTdGRWVyI6CiAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKVswXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJCbHVlU2hpZnQiOgogICAgICAgIGNhc2UgImxlbklWIjoKICAgICAgICBjYXNlICJCbHVlRnV6eiI6CiAgICAgICAgY2FzZSAiQmx1ZVNjYWxlIjoKICAgICAgICBjYXNlICJMYW5ndWFnZUdyb3VwIjoKICAgICAgICBjYXNlICJFeHBhbnNpb25GYWN0b3IiOgogICAgICAgICAgcHJvZ3JhbS5wcm9wZXJ0aWVzLnByaXZhdGVEYXRhW3Rva2VuXSA9IHRoaXMucmVhZE51bWJlcigpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkZvcmNlQm9sZCI6CiAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkQm9vbGVhbigpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IHsKICAgICAgZW5jb2RlZCwKICAgICAgZ2x5cGgKICAgIH0gb2YgY2hhcnN0cmluZ3MpIHsKICAgICAgY29uc3QgY2hhclN0cmluZyA9IG5ldyBUeXBlMUNoYXJTdHJpbmcoKTsKICAgICAgY29uc3QgZXJyb3IgPSBjaGFyU3RyaW5nLmNvbnZlcnQoZW5jb2RlZCwgc3VicnMsIHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCk7CiAgICAgIGxldCBvdXRwdXQgPSBjaGFyU3RyaW5nLm91dHB1dDsKCiAgICAgIGlmIChlcnJvcikgewogICAgICAgIG91dHB1dCA9IFsxNF07CiAgICAgIH0KCiAgICAgIGNvbnN0IGNoYXJTdHJpbmdPYmplY3QgPSB7CiAgICAgICAgZ2x5cGhOYW1lOiBnbHlwaCwKICAgICAgICBjaGFyc3RyaW5nOiBvdXRwdXQsCiAgICAgICAgd2lkdGg6IGNoYXJTdHJpbmcud2lkdGgsCiAgICAgICAgbHNiOiBjaGFyU3RyaW5nLmxzYiwKICAgICAgICBzZWFjOiBjaGFyU3RyaW5nLnNlYWMKICAgICAgfTsKCiAgICAgIGlmIChnbHlwaCA9PT0gIi5ub3RkZWYiKSB7CiAgICAgICAgcHJvZ3JhbS5jaGFyc3RyaW5ncy51bnNoaWZ0KGNoYXJTdHJpbmdPYmplY3QpOwogICAgICB9IGVsc2UgewogICAgICAgIHByb2dyYW0uY2hhcnN0cmluZ3MucHVzaChjaGFyU3RyaW5nT2JqZWN0KTsKICAgICAgfQoKICAgICAgaWYgKHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nKSB7CiAgICAgICAgY29uc3QgaW5kZXggPSBwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZy5pbmRleE9mKGdseXBoKTsKCiAgICAgICAgaWYgKGluZGV4ID4gLTEgJiYgcHJvcGVydGllcy53aWR0aHNbaW5kZXhdID09PSB1bmRlZmluZWQgJiYgaW5kZXggPj0gcHJvcGVydGllcy5maXJzdENoYXIgJiYgaW5kZXggPD0gcHJvcGVydGllcy5sYXN0Q2hhcikgewogICAgICAgICAgcHJvcGVydGllcy53aWR0aHNbaW5kZXhdID0gY2hhclN0cmluZy53aWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcHJvZ3JhbTsKICB9CgogIGV4dHJhY3RGb250SGVhZGVyKHByb3BlcnRpZXMpIHsKICAgIGxldCB0b2tlbjsKCiAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5nZXRUb2tlbigpKSAhPT0gbnVsbCkgewogICAgICBpZiAodG9rZW4gIT09ICIvIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgIHN3aXRjaCAodG9rZW4pIHsKICAgICAgICBjYXNlICJGb250TWF0cml4IjoKICAgICAgICAgIGNvbnN0IG1hdHJpeCA9IHRoaXMucmVhZE51bWJlckFycmF5KCk7CiAgICAgICAgICBwcm9wZXJ0aWVzLmZvbnRNYXRyaXggPSBtYXRyaXg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRW5jb2RpbmciOgogICAgICAgICAgY29uc3QgZW5jb2RpbmdBcmcgPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICBsZXQgZW5jb2Rpbmc7CgogICAgICAgICAgaWYgKCEvXlxkKyQvLnRlc3QoZW5jb2RpbmdBcmcpKSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKGVuY29kaW5nQXJnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuY29kaW5nID0gW107CiAgICAgICAgICAgIGNvbnN0IHNpemUgPSBwYXJzZUludChlbmNvZGluZ0FyZywgMTApIHwgMDsKICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaXplOyBqKyspIHsKICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgICAgd2hpbGUgKHRva2VuICE9PSAiZHVwIiAmJiB0b2tlbiAhPT0gImRlZiIpIHsKICAgICAgICAgICAgICAgIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwoKICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodG9rZW4gPT09ICJkZWYiKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGNvbnN0IGdseXBoID0gdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGVuY29kaW5nW2luZGV4XSA9IGdseXBoOwogICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRm9udEJCb3giOgogICAgICAgICAgY29uc3QgZm9udEJCb3ggPSB0aGlzLnJlYWROdW1iZXJBcnJheSgpOwogICAgICAgICAgcHJvcGVydGllcy5hc2NlbnQgPSBNYXRoLm1heChmb250QkJveFszXSwgZm9udEJCb3hbMV0pOwogICAgICAgICAgcHJvcGVydGllcy5kZXNjZW50ID0gTWF0aC5taW4oZm9udEJCb3hbMV0sIGZvbnRCQm94WzNdKTsKICAgICAgICAgIHByb3BlcnRpZXMuYXNjZW50U2NhbGVkID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5UeXBlMVBhcnNlciA9IFR5cGUxUGFyc2VyOwoKLyoqKi8gfSksCi8qIDUwICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUGF0dGVybiA9IHZvaWQgMDsKZXhwb3J0cy5nZXRUaWxpbmdQYXR0ZXJuSVIgPSBnZXRUaWxpbmdQYXR0ZXJuSVI7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9iYXNlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oNyk7Cgp2YXIgX2NvbG9yc3BhY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgpjb25zdCBTaGFkaW5nVHlwZSA9IHsKICBGVU5DVElPTl9CQVNFRDogMSwKICBBWElBTDogMiwKICBSQURJQUw6IDMsCiAgRlJFRV9GT1JNX01FU0g6IDQsCiAgTEFUVElDRV9GT1JNX01FU0g6IDUsCiAgQ09PTlNfUEFUQ0hfTUVTSDogNiwKICBURU5TT1JfUEFUQ0hfTUVTSDogNwp9OwoKY2xhc3MgUGF0dGVybiB7CiAgY29uc3RydWN0b3IoKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBQYXR0ZXJuLiIpOwogIH0KCiAgc3RhdGljIHBhcnNlU2hhZGluZyhzaGFkaW5nLCB4cmVmLCByZXMsIGhhbmRsZXIsIHBkZkZ1bmN0aW9uRmFjdG9yeSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpIHsKICAgIGNvbnN0IGRpY3QgPSBzaGFkaW5nIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0gPyBzaGFkaW5nLmRpY3QgOiBzaGFkaW5nOwogICAgY29uc3QgdHlwZSA9IGRpY3QuZ2V0KCJTaGFkaW5nVHlwZSIpOwoKICAgIHRyeSB7CiAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuQVhJQUw6CiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5SQURJQUw6CiAgICAgICAgICByZXR1cm4gbmV3IFJhZGlhbEF4aWFsU2hhZGluZyhkaWN0LCB4cmVmLCByZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpOwoKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLkZSRUVfRk9STV9NRVNIOgogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuTEFUVElDRV9GT1JNX01FU0g6CiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5DT09OU19QQVRDSF9NRVNIOgogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuVEVOU09SX1BBVENIX01FU0g6CiAgICAgICAgICByZXR1cm4gbmV3IE1lc2hTaGFkaW5nKHNoYWRpbmcsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5LCBsb2NhbENvbG9yU3BhY2VDYWNoZSk7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVuc3VwcG9ydGVkIFNoYWRpbmdUeXBlOiAiICsgdHlwZSk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgIGhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuc2hhZGluZ1BhdHRlcm4KICAgICAgfSk7CiAgICAgICgwLCBfdXRpbC53YXJuKShleCk7CiAgICAgIHJldHVybiBuZXcgRHVtbXlTaGFkaW5nKCk7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5QYXR0ZXJuID0gUGF0dGVybjsKCmNsYXNzIEJhc2VTaGFkaW5nIHsKICBzdGF0aWMgZ2V0IFNNQUxMX05VTUJFUigpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiU01BTExfTlVNQkVSIiwgMWUtNik7CiAgfQoKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlU2hhZGluZykgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBCYXNlU2hhZGluZy4iKTsKICAgIH0KICB9CgogIGdldElSKCkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGBnZXRJUmAgY2FsbGVkLiIpOwogIH0KCn0KCmNsYXNzIFJhZGlhbEF4aWFsU2hhZGluZyBleHRlbmRzIEJhc2VTaGFkaW5nIHsKICBjb25zdHJ1Y3RvcihkaWN0LCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLmNvb3Jkc0FyciA9IGRpY3QuZ2V0QXJyYXkoIkNvb3JkcyIpOwogICAgdGhpcy5zaGFkaW5nVHlwZSA9IGRpY3QuZ2V0KCJTaGFkaW5nVHlwZSIpOwoKICAgIGNvbnN0IGNzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5wYXJzZSh7CiAgICAgIGNzOiBkaWN0LmdldFJhdygiQ1MiKSB8fCBkaWN0LmdldFJhdygiQ29sb3JTcGFjZSIpLAogICAgICB4cmVmLAogICAgICByZXNvdXJjZXMsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0pOwoKICAgIGNvbnN0IGJib3ggPSBkaWN0LmdldEFycmF5KCJCQm94Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYmJveCkgJiYgYmJveC5sZW5ndGggPT09IDQpIHsKICAgICAgdGhpcy5iYm94ID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KGJib3gpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5iYm94ID0gbnVsbDsKICAgIH0KCiAgICBsZXQgdDAgPSAwLjAsCiAgICAgICAgdDEgPSAxLjA7CgogICAgaWYgKGRpY3QuaGFzKCJEb21haW4iKSkgewogICAgICBjb25zdCBkb21haW5BcnIgPSBkaWN0LmdldEFycmF5KCJEb21haW4iKTsKICAgICAgdDAgPSBkb21haW5BcnJbMF07CiAgICAgIHQxID0gZG9tYWluQXJyWzFdOwogICAgfQoKICAgIGxldCBleHRlbmRTdGFydCA9IGZhbHNlLAogICAgICAgIGV4dGVuZEVuZCA9IGZhbHNlOwoKICAgIGlmIChkaWN0LmhhcygiRXh0ZW5kIikpIHsKICAgICAgY29uc3QgZXh0ZW5kQXJyID0gZGljdC5nZXRBcnJheSgiRXh0ZW5kIik7CiAgICAgIGV4dGVuZFN0YXJ0ID0gZXh0ZW5kQXJyWzBdOwogICAgICBleHRlbmRFbmQgPSBleHRlbmRBcnJbMV07CiAgICB9CgogICAgaWYgKHRoaXMuc2hhZGluZ1R5cGUgPT09IFNoYWRpbmdUeXBlLlJBRElBTCAmJiAoIWV4dGVuZFN0YXJ0IHx8ICFleHRlbmRFbmQpKSB7CiAgICAgIGNvbnN0IFt4MSwgeTEsIHIxLCB4MiwgeTIsIHIyXSA9IHRoaXMuY29vcmRzQXJyOwogICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguaHlwb3QoeDEgLSB4MiwgeTEgLSB5Mik7CgogICAgICBpZiAocjEgPD0gcjIgKyBkaXN0YW5jZSAmJiByMiA8PSByMSArIGRpc3RhbmNlKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCByYWRpYWwgZ3JhZGllbnQuIik7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmV4dGVuZFN0YXJ0ID0gZXh0ZW5kU3RhcnQ7CiAgICB0aGlzLmV4dGVuZEVuZCA9IGV4dGVuZEVuZDsKICAgIGNvbnN0IGZuT2JqID0gZGljdC5nZXRSYXcoIkZ1bmN0aW9uIik7CiAgICBjb25zdCBmbiA9IHBkZkZ1bmN0aW9uRmFjdG9yeS5jcmVhdGVGcm9tQXJyYXkoZm5PYmopOwogICAgY29uc3QgTlVNQkVSX09GX1NBTVBMRVMgPSAxMDsKICAgIGNvbnN0IHN0ZXAgPSAodDEgLSB0MCkgLyBOVU1CRVJfT0ZfU0FNUExFUzsKICAgIGNvbnN0IGNvbG9yU3RvcHMgPSB0aGlzLmNvbG9yU3RvcHMgPSBbXTsKCiAgICBpZiAodDAgPj0gdDEgfHwgc3RlcCA8PSAwKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKSgiQmFkIHNoYWRpbmcgZG9tYWluLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgY29sb3IgPSBuZXcgRmxvYXQzMkFycmF5KGNzLm51bUNvbXBzKSwKICAgICAgICAgIHJhdGlvID0gbmV3IEZsb2F0MzJBcnJheSgxKTsKICAgIGxldCByZ2JDb2xvcjsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBOVU1CRVJfT0ZfU0FNUExFUzsgaSsrKSB7CiAgICAgIHJhdGlvWzBdID0gdDAgKyBpICogc3RlcDsKICAgICAgZm4ocmF0aW8sIDAsIGNvbG9yLCAwKTsKICAgICAgcmdiQ29sb3IgPSBjcy5nZXRSZ2IoY29sb3IsIDApOwoKICAgICAgY29uc3QgY3NzQ29sb3IgPSBfdXRpbC5VdGlsLm1ha2VIZXhDb2xvcihyZ2JDb2xvclswXSwgcmdiQ29sb3JbMV0sIHJnYkNvbG9yWzJdKTsKCiAgICAgIGNvbG9yU3RvcHMucHVzaChbaSAvIE5VTUJFUl9PRl9TQU1QTEVTLCBjc3NDb2xvcl0pOwogICAgfQoKICAgIGxldCBiYWNrZ3JvdW5kID0gInRyYW5zcGFyZW50IjsKCiAgICBpZiAoZGljdC5oYXMoIkJhY2tncm91bmQiKSkgewogICAgICByZ2JDb2xvciA9IGNzLmdldFJnYihkaWN0LmdldCgiQmFja2dyb3VuZCIpLCAwKTsKICAgICAgYmFja2dyb3VuZCA9IF91dGlsLlV0aWwubWFrZUhleENvbG9yKHJnYkNvbG9yWzBdLCByZ2JDb2xvclsxXSwgcmdiQ29sb3JbMl0pOwogICAgfQoKICAgIGlmICghZXh0ZW5kU3RhcnQpIHsKICAgICAgY29sb3JTdG9wcy51bnNoaWZ0KFswLCBiYWNrZ3JvdW5kXSk7CiAgICAgIGNvbG9yU3RvcHNbMV1bMF0gKz0gQmFzZVNoYWRpbmcuU01BTExfTlVNQkVSOwogICAgfQoKICAgIGlmICghZXh0ZW5kRW5kKSB7CiAgICAgIGNvbG9yU3RvcHMuYXQoLTEpWzBdIC09IEJhc2VTaGFkaW5nLlNNQUxMX05VTUJFUjsKICAgICAgY29sb3JTdG9wcy5wdXNoKFsxLCBiYWNrZ3JvdW5kXSk7CiAgICB9CgogICAgdGhpcy5jb2xvclN0b3BzID0gY29sb3JTdG9wczsKICB9CgogIGdldElSKCkgewogICAgY29uc3QgY29vcmRzQXJyID0gdGhpcy5jb29yZHNBcnI7CiAgICBjb25zdCBzaGFkaW5nVHlwZSA9IHRoaXMuc2hhZGluZ1R5cGU7CiAgICBsZXQgdHlwZSwgcDAsIHAxLCByMCwgcjE7CgogICAgaWYgKHNoYWRpbmdUeXBlID09PSBTaGFkaW5nVHlwZS5BWElBTCkgewogICAgICBwMCA9IFtjb29yZHNBcnJbMF0sIGNvb3Jkc0FyclsxXV07CiAgICAgIHAxID0gW2Nvb3Jkc0FyclsyXSwgY29vcmRzQXJyWzNdXTsKICAgICAgcjAgPSBudWxsOwogICAgICByMSA9IG51bGw7CiAgICAgIHR5cGUgPSAiYXhpYWwiOwogICAgfSBlbHNlIGlmIChzaGFkaW5nVHlwZSA9PT0gU2hhZGluZ1R5cGUuUkFESUFMKSB7CiAgICAgIHAwID0gW2Nvb3Jkc0FyclswXSwgY29vcmRzQXJyWzFdXTsKICAgICAgcDEgPSBbY29vcmRzQXJyWzNdLCBjb29yZHNBcnJbNF1dOwogICAgICByMCA9IGNvb3Jkc0FyclsyXTsKICAgICAgcjEgPSBjb29yZHNBcnJbNV07CiAgICAgIHR5cGUgPSAicmFkaWFsIjsKICAgIH0gZWxzZSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoYGdldFBhdHRlcm4gdHlwZSB1bmtub3duOiAke3NoYWRpbmdUeXBlfWApOwogICAgfQoKICAgIHJldHVybiBbIlJhZGlhbEF4aWFsIiwgdHlwZSwgdGhpcy5iYm94LCB0aGlzLmNvbG9yU3RvcHMsIHAwLCBwMSwgcjAsIHIxXTsKICB9Cgp9CgpjbGFzcyBNZXNoU3RyZWFtUmVhZGVyIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIGNvbnRleHQpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICAgIHRoaXMuYnVmZmVyID0gMDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gMDsKICAgIGNvbnN0IG51bUNvbXBzID0gY29udGV4dC5udW1Db21wczsKICAgIHRoaXMudG1wQ29tcHNCdWYgPSBuZXcgRmxvYXQzMkFycmF5KG51bUNvbXBzKTsKICAgIGNvbnN0IGNzTnVtQ29tcHMgPSBjb250ZXh0LmNvbG9yU3BhY2UubnVtQ29tcHM7CiAgICB0aGlzLnRtcENzQ29tcHNCdWYgPSBjb250ZXh0LmNvbG9yRm4gPyBuZXcgRmxvYXQzMkFycmF5KGNzTnVtQ29tcHMpIDogdGhpcy50bXBDb21wc0J1ZjsKICB9CgogIGdldCBoYXNEYXRhKCkgewogICAgaWYgKHRoaXMuc3RyZWFtLmVuZCkgewogICAgICByZXR1cm4gdGhpcy5zdHJlYW0ucG9zIDwgdGhpcy5zdHJlYW0uZW5kOwogICAgfQoKICAgIGlmICh0aGlzLmJ1ZmZlckxlbmd0aCA+IDApIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgY29uc3QgbmV4dEJ5dGUgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CgogICAgaWYgKG5leHRCeXRlIDwgMCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBuZXh0Qnl0ZTsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gODsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgcmVhZEJpdHMobikgewogICAgbGV0IGJ1ZmZlciA9IHRoaXMuYnVmZmVyOwogICAgbGV0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwoKICAgIGlmIChuID09PSAzMikgewogICAgICBpZiAoYnVmZmVyTGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuICh0aGlzLnN0cmVhbS5nZXRCeXRlKCkgPDwgMjQgfCB0aGlzLnN0cmVhbS5nZXRCeXRlKCkgPDwgMTYgfCB0aGlzLnN0cmVhbS5nZXRCeXRlKCkgPDwgOCB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKSkgPj4+IDA7CiAgICAgIH0KCiAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCAyNCB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKSA8PCAxNiB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKSA8PCA4IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICBjb25zdCBuZXh0Qnl0ZSA9IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgdGhpcy5idWZmZXIgPSBuZXh0Qnl0ZSAmICgxIDw8IGJ1ZmZlckxlbmd0aCkgLSAxOwogICAgICByZXR1cm4gKGJ1ZmZlciA8PCA4IC0gYnVmZmVyTGVuZ3RoIHwgKG5leHRCeXRlICYgMHhmZikgPj4gYnVmZmVyTGVuZ3RoKSA+Pj4gMDsKICAgIH0KCiAgICBpZiAobiA9PT0gOCAmJiBidWZmZXJMZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICAgIH0KCiAgICB3aGlsZSAoYnVmZmVyTGVuZ3RoIDwgbikgewogICAgICBidWZmZXIgPSBidWZmZXIgPDwgOCB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgYnVmZmVyTGVuZ3RoICs9IDg7CiAgICB9CgogICAgYnVmZmVyTGVuZ3RoIC09IG47CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyICYgKDEgPDwgYnVmZmVyTGVuZ3RoKSAtIDE7CiAgICByZXR1cm4gYnVmZmVyID4+IGJ1ZmZlckxlbmd0aDsKICB9CgogIGFsaWduKCkgewogICAgdGhpcy5idWZmZXIgPSAwOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSAwOwogIH0KCiAgcmVhZEZsYWcoKSB7CiAgICByZXR1cm4gdGhpcy5yZWFkQml0cyh0aGlzLmNvbnRleHQuYml0c1BlckZsYWcpOwogIH0KCiAgcmVhZENvb3JkaW5hdGUoKSB7CiAgICBjb25zdCBiaXRzUGVyQ29vcmRpbmF0ZSA9IHRoaXMuY29udGV4dC5iaXRzUGVyQ29vcmRpbmF0ZTsKICAgIGNvbnN0IHhpID0gdGhpcy5yZWFkQml0cyhiaXRzUGVyQ29vcmRpbmF0ZSk7CiAgICBjb25zdCB5aSA9IHRoaXMucmVhZEJpdHMoYml0c1BlckNvb3JkaW5hdGUpOwogICAgY29uc3QgZGVjb2RlID0gdGhpcy5jb250ZXh0LmRlY29kZTsKICAgIGNvbnN0IHNjYWxlID0gYml0c1BlckNvb3JkaW5hdGUgPCAzMiA/IDEgLyAoKDEgPDwgYml0c1BlckNvb3JkaW5hdGUpIC0gMSkgOiAyLjMyODMwNjQzNjUzODY5NjNlLTEwOwogICAgcmV0dXJuIFt4aSAqIHNjYWxlICogKGRlY29kZVsxXSAtIGRlY29kZVswXSkgKyBkZWNvZGVbMF0sIHlpICogc2NhbGUgKiAoZGVjb2RlWzNdIC0gZGVjb2RlWzJdKSArIGRlY29kZVsyXV07CiAgfQoKICByZWFkQ29tcG9uZW50cygpIHsKICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5jb250ZXh0Lm51bUNvbXBzOwogICAgY29uc3QgYml0c1BlckNvbXBvbmVudCA9IHRoaXMuY29udGV4dC5iaXRzUGVyQ29tcG9uZW50OwogICAgY29uc3Qgc2NhbGUgPSBiaXRzUGVyQ29tcG9uZW50IDwgMzIgPyAxIC8gKCgxIDw8IGJpdHNQZXJDb21wb25lbnQpIC0gMSkgOiAyLjMyODMwNjQzNjUzODY5NjNlLTEwOwogICAgY29uc3QgZGVjb2RlID0gdGhpcy5jb250ZXh0LmRlY29kZTsKICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLnRtcENvbXBzQnVmOwoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gNDsgaSA8IG51bUNvbXBzOyBpKyssIGogKz0gMikgewogICAgICBjb25zdCBjaSA9IHRoaXMucmVhZEJpdHMoYml0c1BlckNvbXBvbmVudCk7CiAgICAgIGNvbXBvbmVudHNbaV0gPSBjaSAqIHNjYWxlICogKGRlY29kZVtqICsgMV0gLSBkZWNvZGVbal0pICsgZGVjb2RlW2pdOwogICAgfQoKICAgIGNvbnN0IGNvbG9yID0gdGhpcy50bXBDc0NvbXBzQnVmOwoKICAgIGlmICh0aGlzLmNvbnRleHQuY29sb3JGbikgewogICAgICB0aGlzLmNvbnRleHQuY29sb3JGbihjb21wb25lbnRzLCAwLCBjb2xvciwgMCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuY29udGV4dC5jb2xvclNwYWNlLmdldFJnYihjb2xvciwgMCk7CiAgfQoKfQoKY29uc3QgZ2V0QiA9IGZ1bmN0aW9uIGdldEJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGJ1aWxkQihjb3VudCkgewogICAgY29uc3QgbHV0ID0gW107CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gY291bnQ7IGkrKykgewogICAgICBjb25zdCB0ID0gaSAvIGNvdW50LAogICAgICAgICAgICB0XyA9IDEgLSB0OwogICAgICBsdXQucHVzaChuZXcgRmxvYXQzMkFycmF5KFt0XyAqIHRfICogdF8sIDMgKiB0ICogdF8gKiB0XywgMyAqIHQgKiB0ICogdF8sIHQgKiB0ICogdF0pKTsKICAgIH0KCiAgICByZXR1cm4gbHV0OwogIH0KCiAgY29uc3QgY2FjaGUgPSBbXTsKICByZXR1cm4gZnVuY3Rpb24gKGNvdW50KSB7CiAgICBpZiAoIWNhY2hlW2NvdW50XSkgewogICAgICBjYWNoZVtjb3VudF0gPSBidWlsZEIoY291bnQpOwogICAgfQoKICAgIHJldHVybiBjYWNoZVtjb3VudF07CiAgfTsKfSgpOwoKY2xhc3MgTWVzaFNoYWRpbmcgZXh0ZW5kcyBCYXNlU2hhZGluZyB7CiAgc3RhdGljIGdldCBNSU5fU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTUlOX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQiLCAzKTsKICB9CgogIHN0YXRpYyBnZXQgTUFYX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIk1BWF9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5UIiwgMjApOwogIH0KCiAgc3RhdGljIGdldCBUUklBTkdMRV9ERU5TSVRZKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJUUklBTkdMRV9ERU5TSVRZIiwgMjApOwogIH0KCiAgY29uc3RydWN0b3Ioc3RyZWFtLCB4cmVmLCByZXNvdXJjZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSwgbG9jYWxDb2xvclNwYWNlQ2FjaGUpIHsKICAgIHN1cGVyKCk7CgogICAgaWYgKCEoc3RyZWFtIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWVzaCBkYXRhIGlzIG5vdCBhIHN0cmVhbSIpOwogICAgfQoKICAgIGNvbnN0IGRpY3QgPSBzdHJlYW0uZGljdDsKICAgIHRoaXMuc2hhZGluZ1R5cGUgPSBkaWN0LmdldCgiU2hhZGluZ1R5cGUiKTsKICAgIGNvbnN0IGJib3ggPSBkaWN0LmdldEFycmF5KCJCQm94Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYmJveCkgJiYgYmJveC5sZW5ndGggPT09IDQpIHsKICAgICAgdGhpcy5iYm94ID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KGJib3gpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5iYm94ID0gbnVsbDsKICAgIH0KCiAgICBjb25zdCBjcyA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2UucGFyc2UoewogICAgICBjczogZGljdC5nZXRSYXcoIkNTIikgfHwgZGljdC5nZXRSYXcoIkNvbG9yU3BhY2UiKSwKICAgICAgeHJlZiwKICAgICAgcmVzb3VyY2VzLAogICAgICBwZGZGdW5jdGlvbkZhY3RvcnksCiAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICB9KTsKCiAgICB0aGlzLmJhY2tncm91bmQgPSBkaWN0LmhhcygiQmFja2dyb3VuZCIpID8gY3MuZ2V0UmdiKGRpY3QuZ2V0KCJCYWNrZ3JvdW5kIiksIDApIDogbnVsbDsKICAgIGNvbnN0IGZuT2JqID0gZGljdC5nZXRSYXcoIkZ1bmN0aW9uIik7CiAgICBjb25zdCBmbiA9IGZuT2JqID8gcGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZUZyb21BcnJheShmbk9iaikgOiBudWxsOwogICAgdGhpcy5jb29yZHMgPSBbXTsKICAgIHRoaXMuY29sb3JzID0gW107CiAgICB0aGlzLmZpZ3VyZXMgPSBbXTsKICAgIGNvbnN0IGRlY29kZUNvbnRleHQgPSB7CiAgICAgIGJpdHNQZXJDb29yZGluYXRlOiBkaWN0LmdldCgiQml0c1BlckNvb3JkaW5hdGUiKSwKICAgICAgYml0c1BlckNvbXBvbmVudDogZGljdC5nZXQoIkJpdHNQZXJDb21wb25lbnQiKSwKICAgICAgYml0c1BlckZsYWc6IGRpY3QuZ2V0KCJCaXRzUGVyRmxhZyIpLAogICAgICBkZWNvZGU6IGRpY3QuZ2V0QXJyYXkoIkRlY29kZSIpLAogICAgICBjb2xvckZuOiBmbiwKICAgICAgY29sb3JTcGFjZTogY3MsCiAgICAgIG51bUNvbXBzOiBmbiA/IDEgOiBjcy5udW1Db21wcwogICAgfTsKICAgIGNvbnN0IHJlYWRlciA9IG5ldyBNZXNoU3RyZWFtUmVhZGVyKHN0cmVhbSwgZGVjb2RlQ29udGV4dCk7CiAgICBsZXQgcGF0Y2hNZXNoID0gZmFsc2U7CgogICAgc3dpdGNoICh0aGlzLnNoYWRpbmdUeXBlKSB7CiAgICAgIGNhc2UgU2hhZGluZ1R5cGUuRlJFRV9GT1JNX01FU0g6CiAgICAgICAgdGhpcy5fZGVjb2RlVHlwZTRTaGFkaW5nKHJlYWRlcik7CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTaGFkaW5nVHlwZS5MQVRUSUNFX0ZPUk1fTUVTSDoKICAgICAgICBjb25zdCB2ZXJ0aWNlc1BlclJvdyA9IGRpY3QuZ2V0KCJWZXJ0aWNlc1BlclJvdyIpIHwgMDsKCiAgICAgICAgaWYgKHZlcnRpY2VzUGVyUm93IDwgMikgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFZlcnRpY2VzUGVyUm93Iik7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9kZWNvZGVUeXBlNVNoYWRpbmcocmVhZGVyLCB2ZXJ0aWNlc1BlclJvdyk7CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTaGFkaW5nVHlwZS5DT09OU19QQVRDSF9NRVNIOgogICAgICAgIHRoaXMuX2RlY29kZVR5cGU2U2hhZGluZyhyZWFkZXIpOwoKICAgICAgICBwYXRjaE1lc2ggPSB0cnVlOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTaGFkaW5nVHlwZS5URU5TT1JfUEFUQ0hfTUVTSDoKICAgICAgICB0aGlzLl9kZWNvZGVUeXBlN1NoYWRpbmcocmVhZGVyKTsKCiAgICAgICAgcGF0Y2hNZXNoID0gdHJ1ZTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiVW5zdXBwb3J0ZWQgbWVzaCB0eXBlLiIpOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGlmIChwYXRjaE1lc2gpIHsKICAgICAgdGhpcy5fdXBkYXRlQm91bmRzKCk7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0aGlzLmZpZ3VyZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHRoaXMuX2J1aWxkRmlndXJlRnJvbVBhdGNoKGkpOwogICAgICB9CiAgICB9CgogICAgdGhpcy5fdXBkYXRlQm91bmRzKCk7CgogICAgdGhpcy5fcGFja0RhdGEoKTsKICB9CgogIF9kZWNvZGVUeXBlNFNoYWRpbmcocmVhZGVyKSB7CiAgICBjb25zdCBjb29yZHMgPSB0aGlzLmNvb3JkczsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3Qgb3BlcmF0b3JzID0gW107CiAgICBjb25zdCBwcyA9IFtdOwogICAgbGV0IHZlcnRpY2VzTGVmdCA9IDA7CgogICAgd2hpbGUgKHJlYWRlci5oYXNEYXRhKSB7CiAgICAgIGNvbnN0IGYgPSByZWFkZXIucmVhZEZsYWcoKTsKICAgICAgY29uc3QgY29vcmQgPSByZWFkZXIucmVhZENvb3JkaW5hdGUoKTsKICAgICAgY29uc3QgY29sb3IgPSByZWFkZXIucmVhZENvbXBvbmVudHMoKTsKCiAgICAgIGlmICh2ZXJ0aWNlc0xlZnQgPT09IDApIHsKICAgICAgICBpZiAoISgwIDw9IGYgJiYgZiA8PSAyKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIHR5cGU0IGZsYWciKTsKICAgICAgICB9CgogICAgICAgIHN3aXRjaCAoZikgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB2ZXJ0aWNlc0xlZnQgPSAzOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHBzLnB1c2gocHMuYXQoLTIpLCBwcy5hdCgtMSkpOwogICAgICAgICAgICB2ZXJ0aWNlc0xlZnQgPSAxOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHBzLnB1c2gocHMuYXQoLTMpLCBwcy5hdCgtMSkpOwogICAgICAgICAgICB2ZXJ0aWNlc0xlZnQgPSAxOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIG9wZXJhdG9ycy5wdXNoKGYpOwogICAgICB9CgogICAgICBwcy5wdXNoKGNvb3Jkcy5sZW5ndGgpOwogICAgICBjb29yZHMucHVzaChjb29yZCk7CiAgICAgIGNvbG9ycy5wdXNoKGNvbG9yKTsKICAgICAgdmVydGljZXNMZWZ0LS07CiAgICAgIHJlYWRlci5hbGlnbigpOwogICAgfQoKICAgIHRoaXMuZmlndXJlcy5wdXNoKHsKICAgICAgdHlwZTogInRyaWFuZ2xlcyIsCiAgICAgIGNvb3JkczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KHBzKQogICAgfSk7CiAgfQoKICBfZGVjb2RlVHlwZTVTaGFkaW5nKHJlYWRlciwgdmVydGljZXNQZXJSb3cpIHsKICAgIGNvbnN0IGNvb3JkcyA9IHRoaXMuY29vcmRzOwogICAgY29uc3QgY29sb3JzID0gdGhpcy5jb2xvcnM7CiAgICBjb25zdCBwcyA9IFtdOwoKICAgIHdoaWxlIChyZWFkZXIuaGFzRGF0YSkgewogICAgICBjb25zdCBjb29yZCA9IHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpOwogICAgICBjb25zdCBjb2xvciA9IHJlYWRlci5yZWFkQ29tcG9uZW50cygpOwogICAgICBwcy5wdXNoKGNvb3Jkcy5sZW5ndGgpOwogICAgICBjb29yZHMucHVzaChjb29yZCk7CiAgICAgIGNvbG9ycy5wdXNoKGNvbG9yKTsKICAgIH0KCiAgICB0aGlzLmZpZ3VyZXMucHVzaCh7CiAgICAgIHR5cGU6ICJsYXR0aWNlIiwKICAgICAgY29vcmRzOiBuZXcgSW50MzJBcnJheShwcyksCiAgICAgIGNvbG9yczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICB2ZXJ0aWNlc1BlclJvdwogICAgfSk7CiAgfQoKICBfZGVjb2RlVHlwZTZTaGFkaW5nKHJlYWRlcikgewogICAgY29uc3QgY29vcmRzID0gdGhpcy5jb29yZHM7CiAgICBjb25zdCBjb2xvcnMgPSB0aGlzLmNvbG9yczsKICAgIGNvbnN0IHBzID0gbmV3IEludDMyQXJyYXkoMTYpOwogICAgY29uc3QgY3MgPSBuZXcgSW50MzJBcnJheSg0KTsKCiAgICB3aGlsZSAocmVhZGVyLmhhc0RhdGEpIHsKICAgICAgY29uc3QgZiA9IHJlYWRlci5yZWFkRmxhZygpOwoKICAgICAgaWYgKCEoMCA8PSBmICYmIGYgPD0gMykpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gdHlwZTYgZmxhZyIpOwogICAgICB9CgogICAgICBjb25zdCBwaSA9IGNvb3Jkcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmICE9PSAwID8gOCA6IDEyOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvb3Jkcy5wdXNoKHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpKTsKICAgICAgfQoKICAgICAgY29uc3QgY2kgPSBjb2xvcnMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZiAhPT0gMCA/IDIgOiA0OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbG9ycy5wdXNoKHJlYWRlci5yZWFkQ29tcG9uZW50cygpKTsKICAgICAgfQoKICAgICAgbGV0IHRtcDEsIHRtcDIsIHRtcDMsIHRtcDQ7CgogICAgICBzd2l0Y2ggKGYpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBwc1sxMl0gPSBwaSArIDM7CiAgICAgICAgICBwc1sxM10gPSBwaSArIDQ7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDU7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDY7CiAgICAgICAgICBwc1s4XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzExXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzRdID0gcGkgKyAxOwogICAgICAgICAgcHNbN10gPSBwaSArIDg7CiAgICAgICAgICBwc1swXSA9IHBpOwogICAgICAgICAgcHNbMV0gPSBwaSArIDExOwogICAgICAgICAgcHNbMl0gPSBwaSArIDEwOwogICAgICAgICAgcHNbM10gPSBwaSArIDk7CiAgICAgICAgICBjc1syXSA9IGNpICsgMTsKICAgICAgICAgIGNzWzNdID0gY2kgKyAyOwogICAgICAgICAgY3NbMF0gPSBjaTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAzOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRtcDEgPSBwc1sxMl07CiAgICAgICAgICB0bXAyID0gcHNbMTNdOwogICAgICAgICAgdG1wMyA9IHBzWzE0XTsKICAgICAgICAgIHRtcDQgPSBwc1sxNV07CiAgICAgICAgICBwc1sxMl0gPSB0bXA0OwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSB0bXAzOwogICAgICAgICAgcHNbMTFdID0gcGkgKyAzOwogICAgICAgICAgcHNbNF0gPSB0bXAyOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHRtcDE7CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICB0bXAxID0gY3NbMl07CiAgICAgICAgICB0bXAyID0gY3NbM107CiAgICAgICAgICBjc1syXSA9IHRtcDI7CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdG1wMSA9IHBzWzE1XTsKICAgICAgICAgIHRtcDIgPSBwc1sxMV07CiAgICAgICAgICBwc1sxMl0gPSBwc1szXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbN107CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHRtcDI7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gdG1wMTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIHRtcDEgPSBjc1szXTsKICAgICAgICAgIGNzWzJdID0gY3NbMV07CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcHNbMTJdID0gcHNbMF07CiAgICAgICAgICBwc1sxM10gPSBwaSArIDA7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDE7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDI7CiAgICAgICAgICBwc1s4XSA9IHBzWzFdOwogICAgICAgICAgcHNbMTFdID0gcGkgKyAzOwogICAgICAgICAgcHNbNF0gPSBwc1syXTsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSBwc1szXTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIGNzWzJdID0gY3NbMF07CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSBjc1sxXTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAxOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHBzWzVdID0gY29vcmRzLmxlbmd0aDsKICAgICAgY29vcmRzLnB1c2goWygtNCAqIGNvb3Jkc1twc1swXV1bMF0gLSBjb29yZHNbcHNbMTVdXVswXSArIDYgKiAoY29vcmRzW3BzWzRdXVswXSArIGNvb3Jkc1twc1sxXV1bMF0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVswXSArIGNvb3Jkc1twc1szXV1bMF0pICsgMyAqIChjb29yZHNbcHNbMTNdXVswXSArIGNvb3Jkc1twc1s3XV1bMF0pKSAvIDksICgtNCAqIGNvb3Jkc1twc1swXV1bMV0gLSBjb29yZHNbcHNbMTVdXVsxXSArIDYgKiAoY29vcmRzW3BzWzRdXVsxXSArIGNvb3Jkc1twc1sxXV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVsxXSArIGNvb3Jkc1twc1szXV1bMV0pICsgMyAqIChjb29yZHNbcHNbMTNdXVsxXSArIGNvb3Jkc1twc1s3XV1bMV0pKSAvIDldKTsKICAgICAgcHNbNl0gPSBjb29yZHMubGVuZ3RoOwogICAgICBjb29yZHMucHVzaChbKC00ICogY29vcmRzW3BzWzNdXVswXSAtIGNvb3Jkc1twc1sxMl1dWzBdICsgNiAqIChjb29yZHNbcHNbMl1dWzBdICsgY29vcmRzW3BzWzddXVswXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMF0gKyBjb29yZHNbcHNbMTVdXVswXSkgKyAzICogKGNvb3Jkc1twc1s0XV1bMF0gKyBjb29yZHNbcHNbMTRdXVswXSkpIC8gOSwgKC00ICogY29vcmRzW3BzWzNdXVsxXSAtIGNvb3Jkc1twc1sxMl1dWzFdICsgNiAqIChjb29yZHNbcHNbMl1dWzFdICsgY29vcmRzW3BzWzddXVsxXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMV0gKyBjb29yZHNbcHNbMTVdXVsxXSkgKyAzICogKGNvb3Jkc1twc1s0XV1bMV0gKyBjb29yZHNbcHNbMTRdXVsxXSkpIC8gOV0pOwogICAgICBwc1s5XSA9IGNvb3Jkcy5sZW5ndGg7CiAgICAgIGNvb3Jkcy5wdXNoKFsoLTQgKiBjb29yZHNbcHNbMTJdXVswXSAtIGNvb3Jkc1twc1szXV1bMF0gKyA2ICogKGNvb3Jkc1twc1s4XV1bMF0gKyBjb29yZHNbcHNbMTNdXVswXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMF0gKyBjb29yZHNbcHNbMTVdXVswXSkgKyAzICogKGNvb3Jkc1twc1sxMV1dWzBdICsgY29vcmRzW3BzWzFdXVswXSkpIC8gOSwgKC00ICogY29vcmRzW3BzWzEyXV1bMV0gLSBjb29yZHNbcHNbM11dWzFdICsgNiAqIChjb29yZHNbcHNbOF1dWzFdICsgY29vcmRzW3BzWzEzXV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMF1dWzFdICsgY29vcmRzW3BzWzE1XV1bMV0pICsgMyAqIChjb29yZHNbcHNbMTFdXVsxXSArIGNvb3Jkc1twc1sxXV1bMV0pKSAvIDldKTsKICAgICAgcHNbMTBdID0gY29vcmRzLmxlbmd0aDsKICAgICAgY29vcmRzLnB1c2goWygtNCAqIGNvb3Jkc1twc1sxNV1dWzBdIC0gY29vcmRzW3BzWzBdXVswXSArIDYgKiAoY29vcmRzW3BzWzExXV1bMF0gKyBjb29yZHNbcHNbMTRdXVswXSkgLSAyICogKGNvb3Jkc1twc1sxMl1dWzBdICsgY29vcmRzW3BzWzNdXVswXSkgKyAzICogKGNvb3Jkc1twc1syXV1bMF0gKyBjb29yZHNbcHNbOF1dWzBdKSkgLyA5LCAoLTQgKiBjb29yZHNbcHNbMTVdXVsxXSAtIGNvb3Jkc1twc1swXV1bMV0gKyA2ICogKGNvb3Jkc1twc1sxMV1dWzFdICsgY29vcmRzW3BzWzE0XV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVsxXSArIGNvb3Jkc1twc1szXV1bMV0pICsgMyAqIChjb29yZHNbcHNbMl1dWzFdICsgY29vcmRzW3BzWzhdXVsxXSkpIC8gOV0pOwogICAgICB0aGlzLmZpZ3VyZXMucHVzaCh7CiAgICAgICAgdHlwZTogInBhdGNoIiwKICAgICAgICBjb29yZHM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KGNzKQogICAgICB9KTsKICAgIH0KICB9CgogIF9kZWNvZGVUeXBlN1NoYWRpbmcocmVhZGVyKSB7CiAgICBjb25zdCBjb29yZHMgPSB0aGlzLmNvb3JkczsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3QgcHMgPSBuZXcgSW50MzJBcnJheSgxNik7CiAgICBjb25zdCBjcyA9IG5ldyBJbnQzMkFycmF5KDQpOwoKICAgIHdoaWxlIChyZWFkZXIuaGFzRGF0YSkgewogICAgICBjb25zdCBmID0gcmVhZGVyLnJlYWRGbGFnKCk7CgogICAgICBpZiAoISgwIDw9IGYgJiYgZiA8PSAzKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biB0eXBlNyBmbGFnIik7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBpID0gY29vcmRzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGYgIT09IDAgPyAxMiA6IDE2OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvb3Jkcy5wdXNoKHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpKTsKICAgICAgfQoKICAgICAgY29uc3QgY2kgPSBjb2xvcnMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZiAhPT0gMCA/IDIgOiA0OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbG9ycy5wdXNoKHJlYWRlci5yZWFkQ29tcG9uZW50cygpKTsKICAgICAgfQoKICAgICAgbGV0IHRtcDEsIHRtcDIsIHRtcDMsIHRtcDQ7CgogICAgICBzd2l0Y2ggKGYpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBwc1sxMl0gPSBwaSArIDM7CiAgICAgICAgICBwc1sxM10gPSBwaSArIDQ7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDU7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDY7CiAgICAgICAgICBwc1s4XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzldID0gcGkgKyAxMzsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTQ7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1s0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzVdID0gcGkgKyAxMjsKICAgICAgICAgIHBzWzZdID0gcGkgKyAxNTsKICAgICAgICAgIHBzWzddID0gcGkgKyA4OwogICAgICAgICAgcHNbMF0gPSBwaTsKICAgICAgICAgIHBzWzFdID0gcGkgKyAxMTsKICAgICAgICAgIHBzWzJdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzNdID0gcGkgKyA5OwogICAgICAgICAgY3NbMl0gPSBjaSArIDE7CiAgICAgICAgICBjc1szXSA9IGNpICsgMjsKICAgICAgICAgIGNzWzBdID0gY2k7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0bXAxID0gcHNbMTJdOwogICAgICAgICAgdG1wMiA9IHBzWzEzXTsKICAgICAgICAgIHRtcDMgPSBwc1sxNF07CiAgICAgICAgICB0bXA0ID0gcHNbMTVdOwogICAgICAgICAgcHNbMTJdID0gdG1wNDsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gdG1wMzsKICAgICAgICAgIHBzWzldID0gcGkgKyA5OwogICAgICAgICAgcHNbMTBdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzExXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzRdID0gdG1wMjsKICAgICAgICAgIHBzWzVdID0gcGkgKyA4OwogICAgICAgICAgcHNbNl0gPSBwaSArIDExOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHRtcDE7CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICB0bXAxID0gY3NbMl07CiAgICAgICAgICB0bXAyID0gY3NbM107CiAgICAgICAgICBjc1syXSA9IHRtcDI7CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdG1wMSA9IHBzWzE1XTsKICAgICAgICAgIHRtcDIgPSBwc1sxMV07CiAgICAgICAgICBwc1sxMl0gPSBwc1szXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbN107CiAgICAgICAgICBwc1s5XSA9IHBpICsgOTsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTA7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHRtcDI7CiAgICAgICAgICBwc1s1XSA9IHBpICsgODsKICAgICAgICAgIHBzWzZdID0gcGkgKyAxMTsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSB0bXAxOwogICAgICAgICAgcHNbMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1syXSA9IHBpICsgNjsKICAgICAgICAgIHBzWzNdID0gcGkgKyA1OwogICAgICAgICAgdG1wMSA9IGNzWzNdOwogICAgICAgICAgY3NbMl0gPSBjc1sxXTsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IHRtcDE7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBwc1sxMl0gPSBwc1swXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbMV07CiAgICAgICAgICBwc1s5XSA9IHBpICsgOTsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTA7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHBzWzJdOwogICAgICAgICAgcHNbNV0gPSBwaSArIDg7CiAgICAgICAgICBwc1s2XSA9IHBpICsgMTE7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gcHNbM107CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICBjc1syXSA9IGNzWzBdOwogICAgICAgICAgY3NbM10gPSBjaTsKICAgICAgICAgIGNzWzBdID0gY3NbMV07CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICB0aGlzLmZpZ3VyZXMucHVzaCh7CiAgICAgICAgdHlwZTogInBhdGNoIiwKICAgICAgICBjb29yZHM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KGNzKQogICAgICB9KTsKICAgIH0KICB9CgogIF9idWlsZEZpZ3VyZUZyb21QYXRjaChpbmRleCkgewogICAgY29uc3QgZmlndXJlID0gdGhpcy5maWd1cmVzW2luZGV4XTsKICAgICgwLCBfdXRpbC5hc3NlcnQpKGZpZ3VyZS50eXBlID09PSAicGF0Y2giLCAiVW5leHBlY3RlZCBwYXRjaCBtZXNoIGZpZ3VyZSIpOwogICAgY29uc3QgY29vcmRzID0gdGhpcy5jb29yZHMsCiAgICAgICAgICBjb2xvcnMgPSB0aGlzLmNvbG9yczsKICAgIGNvbnN0IHBpID0gZmlndXJlLmNvb3JkczsKICAgIGNvbnN0IGNpID0gZmlndXJlLmNvbG9yczsKICAgIGNvbnN0IGZpZ3VyZU1pblggPSBNYXRoLm1pbihjb29yZHNbcGlbMF1dWzBdLCBjb29yZHNbcGlbM11dWzBdLCBjb29yZHNbcGlbMTJdXVswXSwgY29vcmRzW3BpWzE1XV1bMF0pOwogICAgY29uc3QgZmlndXJlTWluWSA9IE1hdGgubWluKGNvb3Jkc1twaVswXV1bMV0sIGNvb3Jkc1twaVszXV1bMV0sIGNvb3Jkc1twaVsxMl1dWzFdLCBjb29yZHNbcGlbMTVdXVsxXSk7CiAgICBjb25zdCBmaWd1cmVNYXhYID0gTWF0aC5tYXgoY29vcmRzW3BpWzBdXVswXSwgY29vcmRzW3BpWzNdXVswXSwgY29vcmRzW3BpWzEyXV1bMF0sIGNvb3Jkc1twaVsxNV1dWzBdKTsKICAgIGNvbnN0IGZpZ3VyZU1heFkgPSBNYXRoLm1heChjb29yZHNbcGlbMF1dWzFdLCBjb29yZHNbcGlbM11dWzFdLCBjb29yZHNbcGlbMTJdXVsxXSwgY29vcmRzW3BpWzE1XV1bMV0pOwogICAgbGV0IHNwbGl0WEJ5ID0gTWF0aC5jZWlsKChmaWd1cmVNYXhYIC0gZmlndXJlTWluWCkgKiBNZXNoU2hhZGluZy5UUklBTkdMRV9ERU5TSVRZIC8gKHRoaXMuYm91bmRzWzJdIC0gdGhpcy5ib3VuZHNbMF0pKTsKICAgIHNwbGl0WEJ5ID0gTWF0aC5tYXgoTWVzaFNoYWRpbmcuTUlOX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQsIE1hdGgubWluKE1lc2hTaGFkaW5nLk1BWF9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5ULCBzcGxpdFhCeSkpOwogICAgbGV0IHNwbGl0WUJ5ID0gTWF0aC5jZWlsKChmaWd1cmVNYXhZIC0gZmlndXJlTWluWSkgKiBNZXNoU2hhZGluZy5UUklBTkdMRV9ERU5TSVRZIC8gKHRoaXMuYm91bmRzWzNdIC0gdGhpcy5ib3VuZHNbMV0pKTsKICAgIHNwbGl0WUJ5ID0gTWF0aC5tYXgoTWVzaFNoYWRpbmcuTUlOX1NQTElUX1BBVENIX0NIVU5LU19BTU9VTlQsIE1hdGgubWluKE1lc2hTaGFkaW5nLk1BWF9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5ULCBzcGxpdFlCeSkpOwogICAgY29uc3QgdmVydGljZXNQZXJSb3cgPSBzcGxpdFhCeSArIDE7CiAgICBjb25zdCBmaWd1cmVDb29yZHMgPSBuZXcgSW50MzJBcnJheSgoc3BsaXRZQnkgKyAxKSAqIHZlcnRpY2VzUGVyUm93KTsKICAgIGNvbnN0IGZpZ3VyZUNvbG9ycyA9IG5ldyBJbnQzMkFycmF5KChzcGxpdFlCeSArIDEpICogdmVydGljZXNQZXJSb3cpOwogICAgbGV0IGsgPSAwOwogICAgY29uc3QgY2wgPSBuZXcgVWludDhBcnJheSgzKSwKICAgICAgICAgIGNyID0gbmV3IFVpbnQ4QXJyYXkoMyk7CiAgICBjb25zdCBjMCA9IGNvbG9yc1tjaVswXV0sCiAgICAgICAgICBjMSA9IGNvbG9yc1tjaVsxXV0sCiAgICAgICAgICBjMiA9IGNvbG9yc1tjaVsyXV0sCiAgICAgICAgICBjMyA9IGNvbG9yc1tjaVszXV07CiAgICBjb25zdCBiUm93ID0gZ2V0QihzcGxpdFlCeSksCiAgICAgICAgICBiQ29sID0gZ2V0QihzcGxpdFhCeSk7CgogICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDw9IHNwbGl0WUJ5OyByb3crKykgewogICAgICBjbFswXSA9IChjMFswXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjMlswXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CiAgICAgIGNsWzFdID0gKGMwWzFdICogKHNwbGl0WUJ5IC0gcm93KSArIGMyWzFdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY2xbMl0gPSAoYzBbMl0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzJbMl0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwogICAgICBjclswXSA9IChjMVswXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjM1swXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CiAgICAgIGNyWzFdID0gKGMxWzFdICogKHNwbGl0WUJ5IC0gcm93KSArIGMzWzFdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY3JbMl0gPSAoYzFbMl0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzNbMl0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwoKICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDw9IHNwbGl0WEJ5OyBjb2wrKywgaysrKSB7CiAgICAgICAgaWYgKChyb3cgPT09IDAgfHwgcm93ID09PSBzcGxpdFlCeSkgJiYgKGNvbCA9PT0gMCB8fCBjb2wgPT09IHNwbGl0WEJ5KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBsZXQgeCA9IDAsCiAgICAgICAgICAgIHkgPSAwOwogICAgICAgIGxldCBxID0gMDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMzsgaSsrKSB7CiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8PSAzOyBqKyssIHErKykgewogICAgICAgICAgICBjb25zdCBtID0gYlJvd1tyb3ddW2ldICogYkNvbFtjb2xdW2pdOwogICAgICAgICAgICB4ICs9IGNvb3Jkc1twaVtxXV1bMF0gKiBtOwogICAgICAgICAgICB5ICs9IGNvb3Jkc1twaVtxXV1bMV0gKiBtOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZmlndXJlQ29vcmRzW2tdID0gY29vcmRzLmxlbmd0aDsKICAgICAgICBjb29yZHMucHVzaChbeCwgeV0pOwogICAgICAgIGZpZ3VyZUNvbG9yc1trXSA9IGNvbG9ycy5sZW5ndGg7CiAgICAgICAgY29uc3QgbmV3Q29sb3IgPSBuZXcgVWludDhBcnJheSgzKTsKICAgICAgICBuZXdDb2xvclswXSA9IChjbFswXSAqIChzcGxpdFhCeSAtIGNvbCkgKyBjclswXSAqIGNvbCkgLyBzcGxpdFhCeSB8IDA7CiAgICAgICAgbmV3Q29sb3JbMV0gPSAoY2xbMV0gKiAoc3BsaXRYQnkgLSBjb2wpICsgY3JbMV0gKiBjb2wpIC8gc3BsaXRYQnkgfCAwOwogICAgICAgIG5ld0NvbG9yWzJdID0gKGNsWzJdICogKHNwbGl0WEJ5IC0gY29sKSArIGNyWzJdICogY29sKSAvIHNwbGl0WEJ5IHwgMDsKICAgICAgICBjb2xvcnMucHVzaChuZXdDb2xvcik7CiAgICAgIH0KICAgIH0KCiAgICBmaWd1cmVDb29yZHNbMF0gPSBwaVswXTsKICAgIGZpZ3VyZUNvbG9yc1swXSA9IGNpWzBdOwogICAgZmlndXJlQ29vcmRzW3NwbGl0WEJ5XSA9IHBpWzNdOwogICAgZmlndXJlQ29sb3JzW3NwbGl0WEJ5XSA9IGNpWzFdOwogICAgZmlndXJlQ29vcmRzW3ZlcnRpY2VzUGVyUm93ICogc3BsaXRZQnldID0gcGlbMTJdOwogICAgZmlndXJlQ29sb3JzW3ZlcnRpY2VzUGVyUm93ICogc3BsaXRZQnldID0gY2lbMl07CiAgICBmaWd1cmVDb29yZHNbdmVydGljZXNQZXJSb3cgKiBzcGxpdFlCeSArIHNwbGl0WEJ5XSA9IHBpWzE1XTsKICAgIGZpZ3VyZUNvbG9yc1t2ZXJ0aWNlc1BlclJvdyAqIHNwbGl0WUJ5ICsgc3BsaXRYQnldID0gY2lbM107CiAgICB0aGlzLmZpZ3VyZXNbaW5kZXhdID0gewogICAgICB0eXBlOiAibGF0dGljZSIsCiAgICAgIGNvb3JkczogZmlndXJlQ29vcmRzLAogICAgICBjb2xvcnM6IGZpZ3VyZUNvbG9ycywKICAgICAgdmVydGljZXNQZXJSb3cKICAgIH07CiAgfQoKICBfdXBkYXRlQm91bmRzKCkgewogICAgbGV0IG1pblggPSB0aGlzLmNvb3Jkc1swXVswXSwKICAgICAgICBtaW5ZID0gdGhpcy5jb29yZHNbMF1bMV0sCiAgICAgICAgbWF4WCA9IG1pblgsCiAgICAgICAgbWF4WSA9IG1pblk7CgogICAgZm9yIChsZXQgaSA9IDEsIGlpID0gdGhpcy5jb29yZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCB4ID0gdGhpcy5jb29yZHNbaV1bMF0sCiAgICAgICAgICAgIHkgPSB0aGlzLmNvb3Jkc1tpXVsxXTsKICAgICAgbWluWCA9IG1pblggPiB4ID8geCA6IG1pblg7CiAgICAgIG1pblkgPSBtaW5ZID4geSA/IHkgOiBtaW5ZOwogICAgICBtYXhYID0gbWF4WCA8IHggPyB4IDogbWF4WDsKICAgICAgbWF4WSA9IG1heFkgPCB5ID8geSA6IG1heFk7CiAgICB9CgogICAgdGhpcy5ib3VuZHMgPSBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV07CiAgfQoKICBfcGFja0RhdGEoKSB7CiAgICBsZXQgaSwgaWksIGosIGpqOwogICAgY29uc3QgY29vcmRzID0gdGhpcy5jb29yZHM7CiAgICBjb25zdCBjb29yZHNQYWNrZWQgPSBuZXcgRmxvYXQzMkFycmF5KGNvb3Jkcy5sZW5ndGggKiAyKTsKCiAgICBmb3IgKGkgPSAwLCBqID0gMCwgaWkgPSBjb29yZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCB4eSA9IGNvb3Jkc1tpXTsKICAgICAgY29vcmRzUGFja2VkW2orK10gPSB4eVswXTsKICAgICAgY29vcmRzUGFja2VkW2orK10gPSB4eVsxXTsKICAgIH0KCiAgICB0aGlzLmNvb3JkcyA9IGNvb3Jkc1BhY2tlZDsKICAgIGNvbnN0IGNvbG9ycyA9IHRoaXMuY29sb3JzOwogICAgY29uc3QgY29sb3JzUGFja2VkID0gbmV3IFVpbnQ4QXJyYXkoY29sb3JzLmxlbmd0aCAqIDMpOwoKICAgIGZvciAoaSA9IDAsIGogPSAwLCBpaSA9IGNvbG9ycy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGMgPSBjb2xvcnNbaV07CiAgICAgIGNvbG9yc1BhY2tlZFtqKytdID0gY1swXTsKICAgICAgY29sb3JzUGFja2VkW2orK10gPSBjWzFdOwogICAgICBjb2xvcnNQYWNrZWRbaisrXSA9IGNbMl07CiAgICB9CgogICAgdGhpcy5jb2xvcnMgPSBjb2xvcnNQYWNrZWQ7CiAgICBjb25zdCBmaWd1cmVzID0gdGhpcy5maWd1cmVzOwoKICAgIGZvciAoaSA9IDAsIGlpID0gZmlndXJlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGZpZ3VyZSA9IGZpZ3VyZXNbaV0sCiAgICAgICAgICAgIHBzID0gZmlndXJlLmNvb3JkcywKICAgICAgICAgICAgY3MgPSBmaWd1cmUuY29sb3JzOwoKICAgICAgZm9yIChqID0gMCwgamogPSBwcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgcHNbal0gKj0gMjsKICAgICAgICBjc1tqXSAqPSAzOwogICAgICB9CiAgICB9CiAgfQoKICBnZXRJUigpIHsKICAgIHJldHVybiBbIk1lc2giLCB0aGlzLnNoYWRpbmdUeXBlLCB0aGlzLmNvb3JkcywgdGhpcy5jb2xvcnMsIHRoaXMuZmlndXJlcywgdGhpcy5ib3VuZHMsIHRoaXMuYmJveCwgdGhpcy5iYWNrZ3JvdW5kXTsKICB9Cgp9CgpjbGFzcyBEdW1teVNoYWRpbmcgZXh0ZW5kcyBCYXNlU2hhZGluZyB7CiAgZ2V0SVIoKSB7CiAgICByZXR1cm4gWyJEdW1teSJdOwogIH0KCn0KCmZ1bmN0aW9uIGdldFRpbGluZ1BhdHRlcm5JUihvcGVyYXRvckxpc3QsIGRpY3QsIGNvbG9yKSB7CiAgY29uc3QgbWF0cml4ID0gZGljdC5nZXRBcnJheSgiTWF0cml4Iik7CgogIGNvbnN0IGJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoZGljdC5nZXRBcnJheSgiQkJveCIpKTsKCiAgY29uc3QgeHN0ZXAgPSBkaWN0LmdldCgiWFN0ZXAiKTsKICBjb25zdCB5c3RlcCA9IGRpY3QuZ2V0KCJZU3RlcCIpOwogIGNvbnN0IHBhaW50VHlwZSA9IGRpY3QuZ2V0KCJQYWludFR5cGUiKTsKICBjb25zdCB0aWxpbmdUeXBlID0gZGljdC5nZXQoIlRpbGluZ1R5cGUiKTsKCiAgaWYgKGJib3hbMl0gLSBiYm94WzBdID09PSAwIHx8IGJib3hbM10gLSBiYm94WzFdID09PSAwKSB7CiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZ2V0VGlsaW5nUGF0dGVybklSIC9CQm94IGFycmF5OiBbJHtiYm94fV0uYCk7CiAgfQoKICByZXR1cm4gWyJUaWxpbmdQYXR0ZXJuIiwgY29sb3IsIG9wZXJhdG9yTGlzdCwgbWF0cml4LCBiYm94LCB4c3RlcCwgeXN0ZXAsIHBhaW50VHlwZSwgdGlsaW5nVHlwZV07Cn0KCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmdldFhmYUZvbnREaWN0ID0gZ2V0WGZhRm9udERpY3Q7CmV4cG9ydHMuZ2V0WGZhRm9udE5hbWUgPSBnZXRYZmFGb250TmFtZTsKCnZhciBfY2FsaWJyaV9mYWN0b3JzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Mik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9oZWx2ZXRpY2FfZmFjdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oNTMpOwoKdmFyIF9saWJlcmF0aW9uc2Fuc193aWR0aHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU0KTsKCnZhciBfbXlyaWFkcHJvX2ZhY3RvcnMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU1KTsKCnZhciBfc2Vnb2V1aV9mYWN0b3JzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9mb250c191dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMzgpOwoKY29uc3QgZ2V0WEZBRm9udE1hcCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgdFsiTXlyaWFkUHJvLVJlZ3VsYXIiXSA9IHRbIlBkZkpTLUZhbGxiYWNrLVJlZ3VsYXIiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1SZWd1bGFyIiwKICAgIGZhY3RvcnM6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9SZWd1bGFyRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNSZWd1bGFyV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNSZWd1bGFyTWFwcGluZywKICAgIG1ldHJpY3M6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9SZWd1bGFyTWV0cmljcwogIH07CiAgdFsiTXlyaWFkUHJvLUJvbGQiXSA9IHRbIlBkZkpTLUZhbGxiYWNrLUJvbGQiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1Cb2xkIiwKICAgIGZhY3RvcnM6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9Cb2xkRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZywKICAgIG1ldHJpY3M6IF9teXJpYWRwcm9fZmFjdG9ycy5NeXJpYWRQcm9Cb2xkTWV0cmljcwogIH07CiAgdFsiTXlyaWFkUHJvLUl0Il0gPSB0WyJNeXJpYWRQcm8tSXRhbGljIl0gPSB0WyJQZGZKUy1GYWxsYmFjay1JdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1JdGFsaWMiLAogICAgZmFjdG9yczogX215cmlhZHByb19mYWN0b3JzLk15cmlhZFByb0l0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX215cmlhZHByb19mYWN0b3JzLk15cmlhZFByb0l0YWxpY01ldHJpY3MKICB9OwogIHRbIk15cmlhZFByby1Cb2xkSXQiXSA9IHRbIk15cmlhZFByby1Cb2xkSXRhbGljIl0gPSB0WyJQZGZKUy1GYWxsYmFjay1Cb2xkSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtQm9sZEl0YWxpYyIsCiAgICBmYWN0b3JzOiBfbXlyaWFkcHJvX2ZhY3RvcnMuTXlyaWFkUHJvQm9sZEl0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfbXlyaWFkcHJvX2ZhY3RvcnMuTXlyaWFkUHJvQm9sZEl0YWxpY01ldHJpY3MKICB9OwogIHQuQXJpYWxNVCA9IHQuQXJpYWwgPSB0WyJBcmlhbC1SZWd1bGFyIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtUmVndWxhciIsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcKICB9OwogIHRbIkFyaWFsLUJvbGRNVCJdID0gdFsiQXJpYWwtQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nCiAgfTsKICB0WyJBcmlhbC1JdGFsaWNNVCJdID0gdFsiQXJpYWwtSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtSXRhbGljIiwKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcKICB9OwogIHRbIkFyaWFsLUJvbGRJdGFsaWNNVCJdID0gdFsiQXJpYWwtQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nCiAgfTsKICB0WyJDYWxpYnJpLVJlZ3VsYXIiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1SZWd1bGFyIiwKICAgIGZhY3RvcnM6IF9jYWxpYnJpX2ZhY3RvcnMuQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nLAogICAgbWV0cmljczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpUmVndWxhck1ldHJpY3MKICB9OwogIHRbIkNhbGlicmktQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgZmFjdG9yczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpQm9sZEZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZFdpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZE1hcHBpbmcsCiAgICBtZXRyaWNzOiBfY2FsaWJyaV9mYWN0b3JzLkNhbGlicmlCb2xkTWV0cmljcwogIH07CiAgdFsiQ2FsaWJyaS1JdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1JdGFsaWMiLAogICAgZmFjdG9yczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpSXRhbGljRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfY2FsaWJyaV9mYWN0b3JzLkNhbGlicmlJdGFsaWNNZXRyaWNzCiAgfTsKICB0WyJDYWxpYnJpLUJvbGRJdGFsaWMiXSA9IHsKICAgIG5hbWU6ICJMaWJlcmF0aW9uU2Fucy1Cb2xkSXRhbGljIiwKICAgIGZhY3RvcnM6IF9jYWxpYnJpX2ZhY3RvcnMuQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX2NhbGlicmlfZmFjdG9ycy5DYWxpYnJpQm9sZEl0YWxpY01ldHJpY3MKICB9OwogIHRbIlNlZ29ldWktUmVndWxhciJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIiLAogICAgZmFjdG9yczogX3NlZ29ldWlfZmFjdG9ycy5TZWdvZXVpUmVndWxhckZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcsCiAgICBtZXRyaWNzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlSZWd1bGFyTWV0cmljcwogIH07CiAgdFsiU2Vnb2V1aS1Cb2xkIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtQm9sZCIsCiAgICBmYWN0b3JzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlCb2xkRmFjdG9ycywKICAgIGJhc2VXaWR0aHM6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkV2lkdGhzLAogICAgYmFzZU1hcHBpbmc6IF9saWJlcmF0aW9uc2Fuc193aWR0aHMuTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZywKICAgIG1ldHJpY3M6IF9zZWdvZXVpX2ZhY3RvcnMuU2Vnb2V1aUJvbGRNZXRyaWNzCiAgfTsKICB0WyJTZWdvZXVpLUl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUl0YWxpYyIsCiAgICBmYWN0b3JzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZywKICAgIG1ldHJpY3M6IF9zZWdvZXVpX2ZhY3RvcnMuU2Vnb2V1aUl0YWxpY01ldHJpY3MKICB9OwogIHRbIlNlZ29ldWktQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgZmFjdG9yczogX3NlZ29ldWlfZmFjdG9ycy5TZWdvZXVpQm9sZEl0YWxpY0ZhY3RvcnMsCiAgICBiYXNlV2lkdGhzOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmcsCiAgICBtZXRyaWNzOiBfc2Vnb2V1aV9mYWN0b3JzLlNlZ29ldWlCb2xkSXRhbGljTWV0cmljcwogIH07CiAgdFsiSGVsdmV0aWNhLVJlZ3VsYXIiXSA9IHQuSGVsdmV0aWNhID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLVJlZ3VsYXIiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYVJlZ3VsYXJGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYVJlZ3VsYXJNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZCJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGQiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtSXRhbGljIl0gPSB7CiAgICBuYW1lOiAiTGliZXJhdGlvblNhbnMtSXRhbGljIiwKICAgIGZhY3RvcnM6IF9oZWx2ZXRpY2FfZmFjdG9ycy5IZWx2ZXRpY2FJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocywKICAgIGJhc2VNYXBwaW5nOiBfbGliZXJhdGlvbnNhbnNfd2lkdGhzLkxpYmVyYXRpb25TYW5zSXRhbGljTWFwcGluZywKICAgIG1ldHJpY3M6IF9oZWx2ZXRpY2FfZmFjdG9ycy5IZWx2ZXRpY2FJdGFsaWNNZXRyaWNzCiAgfTsKICB0WyJIZWx2ZXRpY2EtQm9sZEl0YWxpYyJdID0gewogICAgbmFtZTogIkxpYmVyYXRpb25TYW5zLUJvbGRJdGFsaWMiLAogICAgZmFjdG9yczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzLAogICAgYmFzZVdpZHRoczogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNXaWR0aHMsCiAgICBiYXNlTWFwcGluZzogX2xpYmVyYXRpb25zYW5zX3dpZHRocy5MaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nLAogICAgbWV0cmljczogX2hlbHZldGljYV9mYWN0b3JzLkhlbHZldGljYUJvbGRJdGFsaWNNZXRyaWNzCiAgfTsKfSk7CgpmdW5jdGlvbiBnZXRYZmFGb250TmFtZShuYW1lKSB7CiAgY29uc3QgZm9udE5hbWUgPSAoMCwgX2ZvbnRzX3V0aWxzLm5vcm1hbGl6ZUZvbnROYW1lKShuYW1lKTsKICBjb25zdCBmb250TWFwID0gZ2V0WEZBRm9udE1hcCgpOwogIHJldHVybiBmb250TWFwW2ZvbnROYW1lXTsKfQoKZnVuY3Rpb24gZ2V0WGZhRm9udFdpZHRocyhuYW1lKSB7CiAgY29uc3QgaW5mbyA9IGdldFhmYUZvbnROYW1lKG5hbWUpOwoKICBpZiAoIWluZm8pIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgY29uc3QgewogICAgYmFzZVdpZHRocywKICAgIGJhc2VNYXBwaW5nLAogICAgZmFjdG9ycwogIH0gPSBpbmZvOwogIGxldCByZXNjYWxlZEJhc2VXaWR0aHM7CgogIGlmICghZmFjdG9ycykgewogICAgcmVzY2FsZWRCYXNlV2lkdGhzID0gYmFzZVdpZHRoczsKICB9IGVsc2UgewogICAgcmVzY2FsZWRCYXNlV2lkdGhzID0gYmFzZVdpZHRocy5tYXAoKHcsIGkpID0+IHcgKiBmYWN0b3JzW2ldKTsKICB9CgogIGxldCBjdXJyZW50Q29kZSA9IC0yOwogIGxldCBjdXJyZW50QXJyYXk7CiAgY29uc3QgbmV3V2lkdGhzID0gW107CgogIGZvciAoY29uc3QgW3VuaWNvZGUsIGdseXBoSW5kZXhdIG9mIGJhc2VNYXBwaW5nLm1hcCgoY2hhclVuaWNvZGUsIGluZGV4KSA9PiBbY2hhclVuaWNvZGUsIGluZGV4XSkuc29ydCgoW3VuaWNvZGUxXSwgW3VuaWNvZGUyXSkgPT4gdW5pY29kZTEgLSB1bmljb2RlMikpIHsKICAgIGlmICh1bmljb2RlID09PSAtMSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAodW5pY29kZSA9PT0gY3VycmVudENvZGUgKyAxKSB7CiAgICAgIGN1cnJlbnRBcnJheS5wdXNoKHJlc2NhbGVkQmFzZVdpZHRoc1tnbHlwaEluZGV4XSk7CiAgICAgIGN1cnJlbnRDb2RlICs9IDE7CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50Q29kZSA9IHVuaWNvZGU7CiAgICAgIGN1cnJlbnRBcnJheSA9IFtyZXNjYWxlZEJhc2VXaWR0aHNbZ2x5cGhJbmRleF1dOwogICAgICBuZXdXaWR0aHMucHVzaCh1bmljb2RlLCBjdXJyZW50QXJyYXkpOwogICAgfQogIH0KCiAgcmV0dXJuIG5ld1dpZHRoczsKfQoKZnVuY3Rpb24gZ2V0WGZhRm9udERpY3QobmFtZSkgewogIGNvbnN0IHdpZHRocyA9IGdldFhmYUZvbnRXaWR0aHMobmFtZSk7CiAgY29uc3QgZGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogIGRpY3Quc2V0KCJCYXNlRm9udCIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KG5hbWUpKTsKICBkaWN0LnNldCgiVHlwZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJGb250IikpOwogIGRpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkNJREZvbnRUeXBlMiIpKTsKICBkaWN0LnNldCgiRW5jb2RpbmciLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSWRlbnRpdHktSCIpKTsKICBkaWN0LnNldCgiQ0lEVG9HSURNYXAiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiSWRlbnRpdHkiKSk7CiAgZGljdC5zZXQoIlciLCB3aWR0aHMpOwogIGRpY3Quc2V0KCJGaXJzdENoYXIiLCB3aWR0aHNbMF0pOwogIGRpY3Quc2V0KCJMYXN0Q2hhciIsIHdpZHRocy5hdCgtMikgKyB3aWR0aHMuYXQoLTEpLmxlbmd0aCAtIDEpOwogIGNvbnN0IGRlc2NyaXB0b3IgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdChudWxsKTsKICBkaWN0LnNldCgiRm9udERlc2NyaXB0b3IiLCBkZXNjcmlwdG9yKTsKICBjb25zdCBzeXN0ZW1JbmZvID0gbmV3IF9wcmltaXRpdmVzLkRpY3QobnVsbCk7CiAgc3lzdGVtSW5mby5zZXQoIk9yZGVyaW5nIiwgIklkZW50aXR5Iik7CiAgc3lzdGVtSW5mby5zZXQoIlJlZ2lzdHJ5IiwgIkFkb2JlIik7CiAgc3lzdGVtSW5mby5zZXQoIlN1cHBsZW1lbnQiLCAwKTsKICBkaWN0LnNldCgiQ0lEU3lzdGVtSW5mbyIsIHN5c3RlbUluZm8pOwogIHJldHVybiBkaWN0Owp9CgovKioqLyB9KSwKLyogNTIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5DYWxpYnJpUmVndWxhck1ldHJpY3MgPSBleHBvcnRzLkNhbGlicmlSZWd1bGFyRmFjdG9ycyA9IGV4cG9ydHMuQ2FsaWJyaUl0YWxpY01ldHJpY3MgPSBleHBvcnRzLkNhbGlicmlJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5DYWxpYnJpQm9sZE1ldHJpY3MgPSBleHBvcnRzLkNhbGlicmlCb2xkSXRhbGljTWV0cmljcyA9IGV4cG9ydHMuQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzID0gZXhwb3J0cy5DYWxpYnJpQm9sZEZhY3RvcnMgPSB2b2lkIDA7CmNvbnN0IENhbGlicmlCb2xkRmFjdG9ycyA9IFsxLjM4NzcsIDEsIDEsIDEsIDAuOTc4MDEsIDAuOTI0ODIsIDAuODk1NTIsIDAuOTExMzMsIDAuODE5ODgsIDAuOTc1NjYsIDAuOTgxNTIsIDAuOTM1NDgsIDAuOTM1NDgsIDEuMjc5OCwgMC44NTI4NCwgMC45Mjc5NCwgMSwgMC45NjEzNCwgMS41NDY1NywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC44Mjg0NSwgMC44Mjg0NSwgMC44NTI4NCwgMC44NTI4NCwgMC44NTI4NCwgMC43NTg1OSwgMC45MjEzOCwgMC44MzkwOCwgMC43NzYyLCAwLjczMjkzLCAwLjg3Mjg5LCAwLjczMTMzLCAwLjc1MTQsIDAuODE5MjEsIDAuODczNTYsIDAuOTU5NTgsIDAuNTk1MjYsIDAuNzU3MjcsIDAuNjkyMjUsIDEuMDQ5MjQsIDAuOTEyMSwgMC44Njk0MywgMC43OTc5NSwgMC44ODE5OCwgMC43Nzk1OCwgMC43MDg2NCwgMC44MTA1NSwgMC45MDM5OSwgMC44ODY1MywgMC45NjAxNywgMC44MjU3NywgMC43Nzg5MiwgMC43ODI1NywgMC45NzUwNywgMS41NDY1NywgMC45NzUwNywgMC44NTI4NCwgMC44OTU1MiwgMC45MDE3NiwgMC44ODc2MiwgMC44Nzg1LCAwLjc1MjQxLCAwLjg3ODUsIDAuOTA1MTgsIDAuOTUwMTUsIDAuNzc2MTgsIDAuODc4NSwgMC44ODQwMSwgMC45MTkxNiwgMC44NjMwNCwgMC44ODQwMSwgMC45MTQ4OCwgMC44Nzg1LCAwLjg4MDEsIDAuODc4NSwgMC44Nzg1LCAwLjkxMzQzLCAwLjcxNzMsIDEuMDQxMDYsIDAuODc4NSwgMC44NTA3NSwgMC45NTc5NCwgMC44MjYxNiwgMC44NTE2MiwgMC43OTQ5MiwgMC44ODMzMSwgMS42OTgwOCwgMC44ODMzMSwgMC44NTI4NCwgMC45NzgwMSwgMC44OTU1MiwgMC45MTEzMywgMC44OTU1MiwgMC45MTEzMywgMS43ODAxLCAwLjg5NTUyLCAxLjI0NDg3LCAxLjEzMjU0LCAxLjEyNDAxLCAwLjk2ODM5LCAwLjg1Mjg0LCAwLjY4Nzg3LCAwLjcwNjQ1LCAwLjg1NTkyLCAwLjkwNzQ3LCAxLjAxNDY2LCAxLjAwODgsIDAuOTAzMjMsIDEsIDEuMDc0NjMsIDEsIDAuOTEwNTYsIDAuNzU4MDYsIDEuMTkxMTgsIDAuOTY4MzksIDAuNzg4NjQsIDAuODI4NDUsIDAuODQxMzMsIDAuNzU4NTksIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuNzc1MzksIDAuNzMyOTMsIDAuNzMxMzMsIDAuNzMxMzMsIDAuNzMxMzMsIDAuNzMxMzMsIDAuOTU5NTgsIDAuOTU5NTgsIDAuOTU5NTgsIDAuOTU5NTgsIDAuODg1MDYsIDAuOTEyMSwgMC44Njk0MywgMC44Njk0MywgMC44Njk0MywgMC44Njk0MywgMC44Njk0MywgMC44NTI4NCwgMC44NzUwOCwgMC45MDM5OSwgMC45MDM5OSwgMC45MDM5OSwgMC45MDM5OSwgMC43Nzg5MiwgMC43OTc5NSwgMC45MDgwNywgMC44ODc2MiwgMC44ODc2MiwgMC44ODc2MiwgMC44ODc2MiwgMC44ODc2MiwgMC44ODc2MiwgMC44NzE1LCAwLjc1MjQxLCAwLjkwNTE4LCAwLjkwNTE4LCAwLjkwNTE4LCAwLjkwNTE4LCAwLjg4NDAxLCAwLjg4NDAxLCAwLjg4NDAxLCAwLjg4NDAxLCAwLjg3ODUsIDAuODc4NSwgMC44ODAxLCAwLjg4MDEsIDAuODgwMSwgMC44ODAxLCAwLjg4MDEsIDAuOTA3NDcsIDAuODkwNDksIDAuODc4NSwgMC44Nzg1LCAwLjg3ODUsIDAuODc4NSwgMC44NTE2MiwgMC44Nzg1LCAwLjg1MTYyLCAwLjgzOTA4LCAwLjg4NzYyLCAwLjgzOTA4LCAwLjg4NzYyLCAwLjgzOTA4LCAwLjg4NzYyLCAwLjczMjkzLCAwLjc1MjQxLCAwLjczMjkzLCAwLjc1MjQxLCAwLjczMjkzLCAwLjc1MjQxLCAwLjczMjkzLCAwLjc1MjQxLCAwLjg3Mjg5LCAwLjgzMDE2LCAwLjg4NTA2LCAwLjkzMTI1LCAwLjczMTMzLCAwLjkwNTE4LCAwLjczMTMzLCAwLjkwNTE4LCAwLjczMTMzLCAwLjkwNTE4LCAwLjczMTMzLCAwLjkwNTE4LCAwLjczMTMzLCAwLjkwNTE4LCAwLjgxOTIxLCAwLjc3NjE4LCAwLjgxOTIxLCAwLjc3NjE4LCAwLjgxOTIxLCAwLjc3NjE4LCAxLCAxLCAwLjg3MzU2LCAwLjg3ODUsIDAuOTEwNzUsIDAuODk2MDgsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuOTU5NTgsIDAuODg0MDEsIDAuNzYyMjksIDAuOTAxNjcsIDAuNTk1MjYsIDAuOTE5MTYsIDEsIDEsIDAuODYzMDQsIDAuNjkyMjUsIDAuODg0MDEsIDEsIDEsIDAuNzA0MjQsIDAuNzk0NjgsIDAuOTE5MjYsIDAuODgxNzUsIDAuNzA4MjMsIDAuOTQ5MDMsIDAuOTEyMSwgMC44Nzg1LCAxLCAxLCAwLjkxMjEsIDAuODc4NSwgMC44NzgwMiwgMC44ODY1NiwgMC44Nzg1LCAwLjg2OTQzLCAwLjg4MDEsIDAuODY5NDMsIDAuODgwMSwgMC44Njk0MywgMC44ODAxLCAwLjg3NDAyLCAwLjg5MjkxLCAwLjc3OTU4LCAwLjkxMzQzLCAxLCAxLCAwLjc3OTU4LCAwLjkxMzQzLCAwLjcwODY0LCAwLjcxNzMsIDAuNzA4NjQsIDAuNzE3MywgMC43MDg2NCwgMC43MTczLCAwLjcwODY0LCAwLjcxNzMsIDEsIDEsIDAuODEwNTUsIDAuNzU4NDEsIDAuODEwNTUsIDEuMDY0NTIsIDAuOTAzOTksIDAuODc4NSwgMC45MDM5OSwgMC44Nzg1LCAwLjkwMzk5LCAwLjg3ODUsIDAuOTAzOTksIDAuODc4NSwgMC45MDM5OSwgMC44Nzg1LCAwLjkwMzk5LCAwLjg3ODUsIDAuOTYwMTcsIDAuOTU3OTQsIDAuNzc4OTIsIDAuODUxNjIsIDAuNzc4OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuNzgyNTcsIDAuNzk0OTIsIDAuOTI5NywgMC41Njg5MiwgMC44MzkwOCwgMC44ODc2MiwgMC43NzUzOSwgMC44NzE1LCAwLjg3NTA4LCAwLjg5MDQ5LCAxLCAxLCAwLjgxMDU1LCAxLjA0MTA2LCAxLjIwNTI4LCAxLjIwNTI4LCAxLCAxLjE1NTQzLCAwLjcwNjc0LCAwLjk4Mzg3LCAwLjk0NzIxLCAxLjMzNDMxLCAxLjQ1ODk0LCAwLjk1MTYxLCAxLjA2MzAzLCAwLjgzOTA4LCAwLjgwMzUyLCAwLjU3MTg0LCAwLjY5NjUsIDAuNTYyODksIDAuODIwMDEsIDAuNTYwMjksIDAuODEyMzUsIDEuMDI5ODgsIDAuODM5MDgsIDAuNzc2MiwgMC42ODE1NiwgMC44MDM2NywgMC43MzEzMywgMC43ODI1NywgMC44NzM1NiwgMC44Njk0MywgMC45NTk1OCwgMC43NTcyNywgMC44OTAxOSwgMS4wNDkyNCwgMC45MTIxLCAwLjc2NDgsIDAuODY5NDMsIDAuODczNTYsIDAuNzk3OTUsIDAuNzgyNzUsIDAuODEwNTUsIDAuNzc4OTIsIDAuOTc2MiwgMC44MjU3NywgMC45OTgxOSwgMC44NDg5NiwgMC45NTk1OCwgMC43Nzg5MiwgMC45NjEwOCwgMS4wMTQwNywgMC44OTA0OSwgMS4wMjk4OCwgMC45NDIxMSwgMC45NjEwOCwgMC44OTM2LCAwLjg0MDIxLCAwLjg3ODQyLCAwLjk2Mzk5LCAwLjc5MTA5LCAwLjg5MDQ5LCAxLjAwODEzLCAxLjAyOTg4LCAwLjg2MDc3LCAwLjg3NDQ1LCAwLjkyMDk5LCAwLjg0NzIzLCAwLjg2NTEzLCAwLjg4MDEsIDAuNzU2MzgsIDAuODU3MTQsIDAuNzgyMTYsIDAuNzk1ODYsIDAuODc5NjUsIDAuOTQyMTEsIDAuOTc3NDcsIDAuNzgyODcsIDAuOTc5MjYsIDAuODQ5NzEsIDEuMDI5ODgsIDAuOTQyMTEsIDAuODgwMSwgMC45NDIxMSwgMC44NDk3MSwgMC43MzEzMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDI2NCwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDUxOCwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDU0OCwgMSwgMSwgMSwgMSwgMSwgMSwgMC45NjAxNywgMC45NTc5NCwgMC45NjAxNywgMC45NTc5NCwgMC45NjAxNywgMC45NTc5NCwgMC43Nzg5MiwgMC44NTE2MiwgMSwgMSwgMC44OTU1MiwgMC45MDUyNywgMSwgMC45MDM2MywgMC45Mjc5NCwgMC45Mjc5NCwgMC45Mjc5NCwgMC45Mjc5NCwgMC44NzAxMiwgMC44NzAxMiwgMC44NzAxMiwgMC44OTU1MiwgMC44OTU1MiwgMS40MjI1OSwgMC43MTE0MywgMS4wNjE1MiwgMSwgMSwgMS4wMzM3MiwgMS4wMzM3MiwgMC45NzE3MSwgMS40OTU2LCAyLjI4MDcsIDAuOTM4MzUsIDAuODM0MDYsIDAuOTExMzMsIDAuODQxMDcsIDAuOTExMzMsIDEsIDEsIDEsIDAuNzIwMjEsIDEsIDEuMjMxMDgsIDAuODM0ODksIDAuODg1MjUsIDAuODg1MjUsIDAuODE0OTksIDAuOTA1MjcsIDEuODEwNTUsIDAuOTA1MjcsIDEuODEwNTUsIDEuMzEwMDYsIDEuNTM3MTEsIDAuOTQ0MzQsIDEuMDg2OTYsIDEsIDAuOTUwMTgsIDAuNzcxOTIsIDAuODUyODQsIDAuOTA3NDcsIDEuMTc1MzQsIDAuNjk4MjUsIDAuOTcxNiwgMS4zNzA3NywgMC45MDc0NywgMC45MDc0NywgMC44NTM1NiwgMC45MDc0NywgMC45MDc0NywgMS40NDk0NywgMC44NTI4NCwgMC44OTQxLCAwLjg5NDEsIDAuNzA1NzIsIDAuOCwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTg2MiwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMS4wODAwNCwgMC45MTAyNywgMSwgMSwgMSwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDcyNywgMC45MDcyNywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuQ2FsaWJyaUJvbGRGYWN0b3JzID0gQ2FsaWJyaUJvbGRGYWN0b3JzOwpjb25zdCBDYWxpYnJpQm9sZE1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yMjA3LAogIGxpbmVHYXA6IDAuMjIwNwp9OwpleHBvcnRzLkNhbGlicmlCb2xkTWV0cmljcyA9IENhbGlicmlCb2xkTWV0cmljczsKY29uc3QgQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzID0gWzEuMzg3NywgMSwgMSwgMSwgMC45NzgwMSwgMC45MjQ4MiwgMC44OTU1MiwgMC45MTEzMywgMC44MTk4OCwgMC45NzU2NiwgMC45ODE1MiwgMC45MzU0OCwgMC45MzU0OCwgMS4yNzk4LCAwLjg1Mjg0LCAwLjkyNzk0LCAxLCAwLjk2MTM0LCAxLjU2MjM5LCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjkxMTMzLCAwLjgyODQ1LCAwLjgyODQ1LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjg1Mjg0LCAwLjc1ODU5LCAwLjkyMTM4LCAwLjgzOTA4LCAwLjc3NjIsIDAuNzE4MDUsIDAuODcyODksIDAuNzMxMzMsIDAuNzUxNCwgMC44MTkyMSwgMC44NzM1NiwgMC45NTk1OCwgMC41OTUyNiwgMC43NTcyNywgMC42OTIyNSwgMS4wNDkyNCwgMC45MDg3MiwgMC44NTkzOCwgMC43OTc5NSwgMC44NzA2OCwgMC43Nzk1OCwgMC42OTc2NiwgMC44MTA1NSwgMC45MDM5OSwgMC44ODY1MywgMC45NjA2OCwgMC44MjU3NywgMC43Nzg5MiwgMC43ODI1NywgMC45NzUwNywgMS41MjksIDAuOTc1MDcsIDAuODUyODQsIDAuODk1NTIsIDAuOTAxNzYsIDAuOTQ5MDgsIDAuODY0MTEsIDAuNzQwMTIsIDAuODY0MTEsIDAuODgzMjMsIDAuOTUwMTUsIDAuODY0MTEsIDAuODYzMzEsIDAuODg0MDEsIDAuOTE5MTYsIDAuODYzMDQsIDAuODg0MDEsIDAuOTAzOSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjQxMSwgMC44NjQxMSwgMC45MDQ2NCwgMC43MDg1MiwgMS4wNDEwNiwgMC44NjMzMSwgMC44NDM3MiwgMC45NTc5NCwgMC44MjYxNiwgMC44NDU0OCwgMC43OTQ5MiwgMC44ODMzMSwgMS42OTgwOCwgMC44ODMzMSwgMC44NTI4NCwgMC45NzgwMSwgMC44OTU1MiwgMC45MTEzMywgMC44OTU1MiwgMC45MTEzMywgMS43ODAxLCAwLjg5NTUyLCAxLjI0NDg3LCAxLjEzMjU0LCAxLjE5MTI5LCAwLjk2ODM5LCAwLjg1Mjg0LCAwLjY4Nzg3LCAwLjcwNjQ1LCAwLjg1NTkyLCAwLjkwNzQ3LCAxLjAxNDY2LCAxLjAwODgsIDAuOTAzMjMsIDEsIDEuMDc0NjMsIDEsIDAuOTEwNTYsIDAuNzU4MDYsIDEuMTkxMTgsIDAuOTY4MzksIDAuNzg4NjQsIDAuODI4NDUsIDAuODQxMzMsIDAuNzU4NTksIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuODM5MDgsIDAuNzc1MzksIDAuNzE4MDUsIDAuNzMxMzMsIDAuNzMxMzMsIDAuNzMxMzMsIDAuNzMxMzMsIDAuOTU5NTgsIDAuOTU5NTgsIDAuOTU5NTgsIDAuOTU5NTgsIDAuODg1MDYsIDAuOTA4NzIsIDAuODU5MzgsIDAuODU5MzgsIDAuODU5MzgsIDAuODU5MzgsIDAuODU5MzgsIDAuODUyODQsIDAuODcwNjgsIDAuOTAzOTksIDAuOTAzOTksIDAuOTAzOTksIDAuOTAzOTksIDAuNzc4OTIsIDAuNzk3OTUsIDAuOTA4MDcsIDAuOTQ5MDgsIDAuOTQ5MDgsIDAuOTQ5MDgsIDAuOTQ5MDgsIDAuOTQ5MDgsIDAuOTQ5MDgsIDAuODU4ODcsIDAuNzQwMTIsIDAuODgzMjMsIDAuODgzMjMsIDAuODgzMjMsIDAuODgzMjMsIDAuODg0MDEsIDAuODg0MDEsIDAuODg0MDEsIDAuODg0MDEsIDAuODc4NSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC45MDc0NywgMC44OTA0OSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC44NjMzMSwgMC44NDU0OCwgMC44NjQxMSwgMC44NDU0OCwgMC44MzkwOCwgMC45NDkwOCwgMC44MzkwOCwgMC45NDkwOCwgMC44MzkwOCwgMC45NDkwOCwgMC43MTgwNSwgMC43NDAxMiwgMC43MTgwNSwgMC43NDAxMiwgMC43MTgwNSwgMC43NDAxMiwgMC43MTgwNSwgMC43NDAxMiwgMC44NzI4OSwgMC43OTUzOCwgMC44ODUwNiwgMC45MjcyNiwgMC43MzEzMywgMC44ODMyMywgMC43MzEzMywgMC44ODMyMywgMC43MzEzMywgMC44ODMyMywgMC43MzEzMywgMC44ODMyMywgMC43MzEzMywgMC44ODMyMywgMC44MTkyMSwgMC44NjQxMSwgMC44MTkyMSwgMC44NjQxMSwgMC44MTkyMSwgMC44NjQxMSwgMSwgMSwgMC44NzM1NiwgMC44NjMzMSwgMC45MTA3NSwgMC44Nzc3LCAwLjk1OTU4LCAwLjg4NDAxLCAwLjk1OTU4LCAwLjg4NDAxLCAwLjk1OTU4LCAwLjg4NDAxLCAwLjk1OTU4LCAwLjg4NDAxLCAwLjk1OTU4LCAwLjg4NDAxLCAwLjc2NDY3LCAwLjkwMTY3LCAwLjU5NTI2LCAwLjkxOTE2LCAxLCAxLCAwLjg2MzA0LCAwLjY5MjI1LCAwLjg4NDAxLCAxLCAxLCAwLjcwNDI0LCAwLjc3MzEyLCAwLjkxOTI2LCAwLjg4MTc1LCAwLjcwODIzLCAwLjk0OTAzLCAwLjkwODcyLCAwLjg2MzMxLCAxLCAxLCAwLjkwODcyLCAwLjg2MzMxLCAwLjg2OTA2LCAwLjg4MTE2LCAwLjg2MzMxLCAwLjg1OTM4LCAwLjg2MzMxLCAwLjg1OTM4LCAwLjg2MzMxLCAwLjg1OTM4LCAwLjg2MzMxLCAwLjg3NDAyLCAwLjg2NTQ5LCAwLjc3OTU4LCAwLjkwNDY0LCAxLCAxLCAwLjc3OTU4LCAwLjkwNDY0LCAwLjY5NzY2LCAwLjcwODUyLCAwLjY5NzY2LCAwLjcwODUyLCAwLjY5NzY2LCAwLjcwODUyLCAwLjY5NzY2LCAwLjcwODUyLCAxLCAxLCAwLjgxMDU1LCAwLjc1ODQxLCAwLjgxMDU1LCAxLjA2NDUyLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjkwMzk5LCAwLjg2MzMxLCAwLjk2MDY4LCAwLjk1Nzk0LCAwLjc3ODkyLCAwLjg0NTQ4LCAwLjc3ODkyLCAwLjc4MjU3LCAwLjc5NDkyLCAwLjc4MjU3LCAwLjc5NDkyLCAwLjc4MjU3LCAwLjc5NDkyLCAwLjkyOTcsIDAuNTY4OTIsIDAuODM5MDgsIDAuOTQ5MDgsIDAuNzc1MzksIDAuODU4ODcsIDAuODcwNjgsIDAuODkwNDksIDEsIDEsIDAuODEwNTUsIDEuMDQxMDYsIDEuMjA1MjgsIDEuMjA1MjgsIDEsIDEuMTU1NDMsIDAuNzAwODgsIDAuOTgzODcsIDAuOTQ3MjEsIDEuMzM0MzEsIDEuNDU4OTQsIDAuOTUxNjEsIDEuNDgzODcsIDAuODM5MDgsIDAuODAzNTIsIDAuNTcxMTgsIDAuNjk2NSwgMC41NjM0NywgMC43OTE3OSwgMC41NTg1MywgMC44MDM0NiwgMS4wMjk4OCwgMC44MzkwOCwgMC43NzYyLCAwLjY3MTc0LCAwLjg2MDM2LCAwLjczMTMzLCAwLjc4MjU3LCAwLjg3MzU2LCAwLjg2NDQxLCAwLjk1OTU4LCAwLjc1NzI3LCAwLjg5MDE5LCAxLjA0OTI0LCAwLjkwODcyLCAwLjc0ODg5LCAwLjg1OTM4LCAwLjg3ODkxLCAwLjc5Nzk1LCAwLjc5NTcsIDAuODEwNTUsIDAuNzc4OTIsIDAuOTc0NDcsIDAuODI1NzcsIDAuOTc0NjYsIDAuODcxNzksIDAuOTU5NTgsIDAuNzc4OTIsIDAuOTQyNTIsIDAuOTU2MTIsIDAuODc1MywgMS4wMjk4OCwgMC45MjczMywgMC45NDI1MiwgMC44NzQxMSwgMC44NDAyMSwgMC44NzI4LCAwLjk1NjEyLCAwLjc0MDgxLCAwLjg3NTMsIDEuMDIxODksIDEuMDI5ODgsIDAuODQ4MTQsIDAuODc0NDUsIDAuOTE4MjIsIDAuODQ3MjMsIDAuODU2NjgsIDAuODYzMzEsIDAuODEzNDQsIDAuODc1ODEsIDAuNzY0MjIsIDAuODIwNDYsIDAuOTYwNTcsIDAuOTI3MzMsIDAuOTkzNzUsIDAuNzgwMjIsIDAuOTU0NTIsIDAuODYwMTUsIDEuMDI5ODgsIDAuOTI3MzMsIDAuODYzMzEsIDAuOTI3MzMsIDAuODYwMTUsIDAuNzMxMzMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTA2MzEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODgzMjMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODUxNzQsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTYwNjgsIDAuOTU3OTQsIDAuOTYwNjgsIDAuOTU3OTQsIDAuOTYwNjgsIDAuOTU3OTQsIDAuNzc4OTIsIDAuODQ1NDgsIDEsIDEsIDAuODk1NTIsIDAuOTA1MjcsIDEsIDAuOTAzNjMsIDAuOTI3OTQsIDAuOTI3OTQsIDAuOTI3OTQsIDAuODk4MDcsIDAuODcwMTIsIDAuODcwMTIsIDAuODcwMTIsIDAuODk1NTIsIDAuODk1NTIsIDEuNDIyNTksIDAuNzEwOTQsIDEuMDYxNTIsIDEsIDEsIDEuMDMzNzIsIDEuMDMzNzIsIDAuOTcxNzEsIDEuNDk1NiwgMi4yODA3LCAwLjkyOTcyLCAwLjgzNDA2LCAwLjkxMTMzLCAwLjgzMzI2LCAwLjkxMTMzLCAxLCAxLCAxLCAwLjcyMDIxLCAxLCAxLjIzMTA4LCAwLjgzNDg5LCAwLjg4NTI1LCAwLjg4NTI1LCAwLjgxNDk5LCAwLjkwNjE2LCAxLjgxMDU1LCAwLjkwNTI3LCAxLjgxMDU1LCAxLjMxMDcsIDEuNTM3MTEsIDAuOTQ0MzQsIDEuMDg2OTYsIDEsIDAuOTUwMTgsIDAuNzcxOTIsIDAuODUyODQsIDAuOTA3NDcsIDEuMTc1MzQsIDAuNjk4MjUsIDAuOTcxNiwgMS4zNzA3NywgMC45MDc0NywgMC45MDc0NywgMC44NTM1NiwgMC45MDc0NywgMC45MDc0NywgMS40NDk0NywgMC44NTI4NCwgMC44OTQxLCAwLjg5NDEsIDAuNzA1NzIsIDAuOCwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTg2MiwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMS4wODAwNCwgMC45MTAyNywgMSwgMSwgMSwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MDcyNywgMC45MDcyNywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzID0gQ2FsaWJyaUJvbGRJdGFsaWNGYWN0b3JzOwpjb25zdCBDYWxpYnJpQm9sZEl0YWxpY01ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yMjA3LAogIGxpbmVHYXA6IDAuMjIwNwp9OwpleHBvcnRzLkNhbGlicmlCb2xkSXRhbGljTWV0cmljcyA9IENhbGlicmlCb2xkSXRhbGljTWV0cmljczsKY29uc3QgQ2FsaWJyaUl0YWxpY0ZhY3RvcnMgPSBbMS4zODc3LCAxLCAxLCAxLCAxLjE3MjIzLCAxLjEyOTMsIDAuODk1NTIsIDAuOTExMzMsIDAuODAzOTUsIDEuMDIyNjksIDEuMTU2MDEsIDAuOTEwNTYsIDAuOTEwNTYsIDEuMjc5OCwgMC44NTI4NCwgMC44OTgwNywgMSwgMC45MDg2MSwgMS4zOTU0MywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45MTEzMywgMC45NjMwOSwgMC45NjMwOSwgMC44NTI4NCwgMC44NTI4NCwgMC44NTI4NCwgMC44MzMxOSwgMC44ODA3MSwgMC44Njc1LCAwLjgxNTUyLCAwLjcyMzQ2LCAwLjg1MTkzLCAwLjczMjA2LCAwLjc1MjIsIDAuODExMDUsIDAuODYyNzUsIDAuOTA2ODUsIDAuNjM3NywgMC43Nzg5MiwgMC43NTU5MywgMS4wMjYzOCwgMC44OTI0OSwgMC44NDExOCwgMC43NzQ1MiwgMC44NTM3NCwgMC43NTE4NiwgMC42Nzc4OSwgMC43OTc3NiwgMC44ODg0NCwgMC44NTA2NiwgMC45NDMwOSwgMC43NzgxOCwgMC43MzA2LCAwLjc2NjU5LCAxLjEwMzY5LCAxLjM4MzEzLCAxLjEwMzY5LCAxLjA2MTM5LCAwLjg5NTUyLCAwLjg3MzksIDAuOTI0NSwgMC45MjQ1LCAwLjgzMjAzLCAwLjkyNDUsIDAuODU4NjUsIDEuMDk4NDIsIDAuOTI0NSwgMC45MjQ1LCAxLjAzMjk3LCAxLjA3NjkyLCAwLjkwOTE4LCAxLjAzMjk3LCAwLjk0OTU5LCAwLjkyNDUsIDAuOTIyNzQsIDAuOTI0NSwgMC45MjQ1LCAxLjAyOTMzLCAwLjc3ODMyLCAxLjIwNTYyLCAwLjkyNDUsIDAuODkxNiwgMC45ODk4NiwgMC44NjYyMSwgMC44OTQ1MywgMC43OTAwNCwgMC45NDE1MiwgMS43NzI1NiwgMC45NDE1MiwgMC44NTI4NCwgMC45NzgwMSwgMC44OTU1MiwgMC45MTEzMywgMC44OTU1MiwgMC45MTEzMywgMS45MTcyOSwgMC44OTU1MiwgMS4xNzg4OSwgMS4xMzI1NCwgMS4xNjM1OSwgMC45MjA5OCwgMC44NTI4NCwgMC42ODc4NywgMC43MTM1MywgMC44NDczNywgMC45MDc0NywgMS4wMDg4LCAxLjAwNDQsIDAuODc2ODMsIDEsIDEuMDkwOTEsIDEsIDAuOTIyMjksIDAuNzM5LCAxLjE1NjQyLCAwLjkyMDk4LCAwLjc2Mjg4LCAwLjgwNTA0LCAwLjgwOTcyLCAwLjc1ODU5LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjc2MzE4LCAwLjcyMzQ2LCAwLjczMjA2LCAwLjczMjA2LCAwLjczMjA2LCAwLjczMjA2LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjg2NDc3LCAwLjg5MjQ5LCAwLjg0MTE4LCAwLjg0MTE4LCAwLjg0MTE4LCAwLjg0MTE4LCAwLjg0MTE4LCAwLjg1Mjg0LCAwLjg0NTU3LCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjczMDYsIDAuNzc0NTIsIDAuODYzMzEsIDAuOTI0NSwgMC45MjQ1LCAwLjkyNDUsIDAuOTI0NSwgMC45MjQ1LCAwLjkyNDUsIDAuODQ4NDMsIDAuODMyMDMsIDAuODU4NjUsIDAuODU4NjUsIDAuODU4NjUsIDAuODU4NjUsIDAuODI2MDEsIDAuODI2MDEsIDAuODI2MDEsIDAuODI2MDEsIDAuOTQ0NjksIDAuOTI0NSwgMC45MjI3NCwgMC45MjI3NCwgMC45MjI3NCwgMC45MjI3NCwgMC45MjI3NCwgMC45MDc0NywgMC44NjY1MSwgMC45MjQ1LCAwLjkyNDUsIDAuOTI0NSwgMC45MjQ1LCAwLjg5NDUzLCAwLjkyNDUsIDAuODk0NTMsIDAuODY3NSwgMC45MjQ1LCAwLjg2NzUsIDAuOTI0NSwgMC44Njc1LCAwLjkyNDUsIDAuNzIzNDYsIDAuODMyMDMsIDAuNzIzNDYsIDAuODMyMDMsIDAuNzIzNDYsIDAuODMyMDMsIDAuNzIzNDYsIDAuODMyMDMsIDAuODUxOTMsIDAuODg3NSwgMC44NjQ3NywgMC45OTAzNCwgMC43MzIwNiwgMC44NTg2NSwgMC43MzIwNiwgMC44NTg2NSwgMC43MzIwNiwgMC44NTg2NSwgMC43MzIwNiwgMC44NTg2NSwgMC43MzIwNiwgMC44NTg2NSwgMC44MTEwNSwgMC45MjQ1LCAwLjgxMTA1LCAwLjkyNDUsIDAuODExMDUsIDAuOTI0NSwgMSwgMSwgMC44NjI3NSwgMC45MjQ1LCAwLjkwODcyLCAwLjkzNTkxLCAwLjkwNjg1LCAwLjgyNjAxLCAwLjkwNjg1LCAwLjgyNjAxLCAwLjkwNjg1LCAwLjgyNjAxLCAwLjkwNjg1LCAxLjAzMjk3LCAwLjkwNjg1LCAwLjgyNjAxLCAwLjc3ODk2LCAxLjA1NjExLCAwLjYzNzcsIDEuMDc2OTIsIDEsIDEsIDAuOTA5MTgsIDAuNzU1OTMsIDEuMDMyOTcsIDEsIDEsIDAuNzYwMzIsIDAuOTM3NSwgMC45ODE1NiwgMC45MzQwNywgMC43NzI2MSwgMS4xMTQyOSwgMC44OTI0OSwgMC45MjQ1LCAxLCAxLCAwLjg5MjQ5LCAwLjkyNDUsIDAuOTI1MzQsIDAuODY2OTgsIDAuOTI0NSwgMC44NDExOCwgMC45MjI3NCwgMC44NDExOCwgMC45MjI3NCwgMC44NDExOCwgMC45MjI3NCwgMC44NjY3LCAwLjg2MjkxLCAwLjc1MTg2LCAxLjAyOTMzLCAxLCAxLCAwLjc1MTg2LCAxLjAyOTMzLCAwLjY3Nzg5LCAwLjc3ODMyLCAwLjY3Nzg5LCAwLjc3ODMyLCAwLjY3Nzg5LCAwLjc3ODMyLCAwLjY3Nzg5LCAwLjc3ODMyLCAxLCAxLCAwLjc5Nzc2LCAwLjk3NjU1LCAwLjc5Nzc2LCAxLjIzMDIzLCAwLjg4ODQ0LCAwLjkyNDUsIDAuODg4NDQsIDAuOTI0NSwgMC44ODg0NCwgMC45MjQ1LCAwLjg4ODQ0LCAwLjkyNDUsIDAuODg4NDQsIDAuOTI0NSwgMC44ODg0NCwgMC45MjQ1LCAwLjk0MzA5LCAwLjk4OTg2LCAwLjczMDYsIDAuODk0NTMsIDAuNzMwNiwgMC43NjY1OSwgMC43OTAwNCwgMC43NjY1OSwgMC43OTAwNCwgMC43NjY1OSwgMC43OTAwNCwgMS4wOTIzMSwgMC41NDg3MywgMC44Njc1LCAwLjkyNDUsIDAuNzYzMTgsIDAuODQ4NDMsIDAuODQ1NTcsIDAuODY2NTEsIDEsIDEsIDAuNzk3NzYsIDEuMjA1NjIsIDEuMTg2MjIsIDEuMTg2MjIsIDEsIDEuMTQzNywgMC42NzAwOSwgMC45NjMzNCwgMC45MzY5NSwgMS4zNTE5MSwgMS40MDkwOSwgMC45NTE2MSwgMS40ODM4NywgMC44Njc1LCAwLjkwODYxLCAwLjYxOTIsIDAuNzM2MywgMC42NDgyNCwgMC44MjQxMSwgMC41NjMyMSwgMC44NTY5NiwgMS4yMzUxNiwgMC44Njc1LCAwLjgxNTUyLCAwLjcyODYsIDAuODQxMzQsIDAuNzMyMDYsIDAuNzY2NTksIDAuODYyNzUsIDAuODQzNjksIDAuOTA2ODUsIDAuNzc4OTIsIDAuODU4NzEsIDEuMDI2MzgsIDAuODkyNDksIDAuNzU4MjgsIDAuODQxMTgsIDAuODU5ODQsIDAuNzc0NTIsIDAuNzY0NjYsIDAuNzk3NzYsIDAuNzMwNiwgMC45MDc4MiwgMC43NzgxOCwgMC45MDMsIDAuODcyOTEsIDAuOTA2ODUsIDAuNzMwNiwgMC45OTA1OCwgMS4wMzY2NywgMC45NDYzNSwgMS4yMzUxNiwgMC45ODQ5LCAwLjk5MDU4LCAwLjkyMzkzLCAwLjg5MTYsIDAuOTQyLCAxLjAzNjY3LCAwLjc1MDI2LCAwLjk0NjM1LCAxLjAyOTcsIDEuMjM1MTYsIDAuOTA5MTgsIDAuOTQwNDgsIDAuOTgyMTcsIDAuODk3NDYsIDAuODQxNTMsIDAuOTIyNzQsIDAuODI1MDcsIDAuODg4MzIsIDAuODQ0MzgsIDAuODgxNzgsIDEuMDM1MjUsIDAuOTg0OSwgMS4wMDIyNSwgMC43ODA4NiwgMC45NzI0OCwgMC44OTQwNCwgMS4yMzUxNiwgMC45ODQ5LCAwLjkyMjc0LCAwLjk4NDksIDAuODk0MDQsIDAuNzMyMDYsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODk2OTMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuODU4NjUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTA5MzMsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTQzMDksIDAuOTg5ODYsIDAuOTQzMDksIDAuOTg5ODYsIDAuOTQzMDksIDAuOTg5ODYsIDAuNzMwNiwgMC44OTQ1MywgMSwgMSwgMC44OTU1MiwgMC45MDUyNywgMSwgMC45MDE4NiwgMS4xMjMwOCwgMS4xMjMwOCwgMS4xMjMwOCwgMS4xMjMwOCwgMS4yNTY2LCAxLjI1NjYsIDEuMjU2NiwgMC44OTU1MiwgMC44OTU1MiwgMS40MjI1OSwgMC42ODk5NCwgMS4wMzgwOSwgMSwgMSwgMS4wMTc2LCAxLjAxNzYsIDEuMTE1MjMsIDEuNDk1NiwgMi4wMTQ2MiwgMC45Nzg1OCwgMC44MjYxNiwgMC45MTEzMywgMC44MzQzNywgMC45MTEzMywgMSwgMSwgMSwgMC43MDUwOCwgMSwgMS4yMzEwOCwgMC43OTgwMSwgMC44NDQyNiwgMC44NDQyNiwgMC43NzQsIDAuOTA1NzIsIDEuODEwNTUsIDAuOTA3NDksIDEuODEwNTUsIDEuMjg4MDksIDEuNTU0NjksIDAuOTQ0MzQsIDEuMDc4MDYsIDEsIDAuOTcwOTQsIDAuNzU4OSwgMC44NTI4NCwgMC45MDc0NywgMS4xOTY1OCwgMC42OTgyNSwgMC45NzYyMiwgMS4zMzUxMiwgMC45MDc0NywgMC45MDc0NywgMC44NTI4NCwgMC45MDc0NywgMC45MDc0NywgMS40NDk0NywgMC44NTI4NCwgMC44OTQxLCAwLjg5NDEsIDAuNzA1NzIsIDAuOCwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMC43MDU3MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTg2MiwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMS4wMzM2LCAwLjkxMDI3LCAxLCAxLCAxLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA1ODU5LCAxLjA1ODU5LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5DYWxpYnJpSXRhbGljRmFjdG9ycyA9IENhbGlicmlJdGFsaWNGYWN0b3JzOwpjb25zdCBDYWxpYnJpSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIyMDcsCiAgbGluZUdhcDogMC4yMjA3Cn07CmV4cG9ydHMuQ2FsaWJyaUl0YWxpY01ldHJpY3MgPSBDYWxpYnJpSXRhbGljTWV0cmljczsKY29uc3QgQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzID0gWzEuMzg3NywgMSwgMSwgMSwgMS4xNzIyMywgMS4xMjkzLCAwLjg5NTUyLCAwLjkxMTMzLCAwLjgwMzk1LCAxLjAyMjY5LCAxLjE1NjAxLCAwLjkxMDU2LCAwLjkxMDU2LCAxLjI3OTgsIDAuODUyODQsIDAuODk4MDcsIDEsIDAuOTA4NjEsIDEuMzkwMTYsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTExMzMsIDAuOTYzMDksIDAuOTYzMDksIDAuODUyODQsIDAuODUyODQsIDAuODUyODQsIDAuODMzMTksIDAuODgwNzEsIDAuODY3NSwgMC44MTU1MiwgMC43MzgzNCwgMC44NTE5MywgMC43MzIwNiwgMC43NTIyLCAwLjgxMTA1LCAwLjg2Mjc1LCAwLjkwNjg1LCAwLjYzNzcsIDAuNzc4OTIsIDAuNzU1OTMsIDEuMDI2MzgsIDAuODkzODUsIDAuODUxMjIsIDAuNzc0NTIsIDAuODY1MDMsIDAuNzUxODYsIDAuNjg4ODcsIDAuNzk3NzYsIDAuODg4NDQsIDAuODUwNjYsIDAuOTQyNTgsIDAuNzc4MTgsIDAuNzMwNiwgMC43NjY1OSwgMS4xMDM2OSwgMS4zOTAxNiwgMS4xMDM2OSwgMS4wNjEzOSwgMC44OTU1MiwgMC44NzM5LCAwLjg2MTI4LCAwLjk0NDY5LCAwLjg0NTcsIDAuOTQ0NjksIDAuODk0NjQsIDEuMDk4NDIsIDAuODQ2MzYsIDAuOTQ0NjksIDEuMDMyOTcsIDEuMDc2OTIsIDAuOTA5MTgsIDEuMDMyOTcsIDAuOTU4OTcsIDAuOTQ0NjksIDAuOTQ4MiwgMC45NDQ2OSwgMC45NDQ2OSwgMS4wNDY5MiwgMC43ODIyMywgMS4yMDU2MiwgMC45NDQ2OSwgMC45MDMzMiwgMC45ODk4NiwgMC44NjYyMSwgMC45MDUyNywgMC43OTAwNCwgMC45NDE1MiwgMS43NzI1NiwgMC45NDE1MiwgMC44NTI4NCwgMC45NzgwMSwgMC44OTU1MiwgMC45MTEzMywgMC44OTU1MiwgMC45MTEzMywgMS45MTcyOSwgMC44OTU1MiwgMS4xNzg4OSwgMS4xMzI1NCwgMS4wODcwNywgMC45MjA5OCwgMC44NTI4NCwgMC42ODc4NywgMC43MTM1MywgMC44NDczNywgMC45MDc0NywgMS4wMDg4LCAxLjAwNDQsIDAuODc2ODMsIDEsIDEuMDkwOTEsIDEsIDAuOTIyMjksIDAuNzM5LCAxLjE1NjQyLCAwLjkyMDk4LCAwLjc2Mjg4LCAwLjgwNTA0LCAwLjgwOTcyLCAwLjc1ODU5LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjg2NzUsIDAuODY3NSwgMC44Njc1LCAwLjc2MzE4LCAwLjczODM0LCAwLjczMjA2LCAwLjczMjA2LCAwLjczMjA2LCAwLjczMjA2LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjkwNjg1LCAwLjg2NDc3LCAwLjg5Mzg1LCAwLjg1MTIyLCAwLjg1MTIyLCAwLjg1MTIyLCAwLjg1MTIyLCAwLjg1MTIyLCAwLjg1Mjg0LCAwLjg1MzExLCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjg4ODQ0LCAwLjczMDYsIDAuNzc0NTIsIDAuODYzMzEsIDAuODYxMjgsIDAuODYxMjgsIDAuODYxMjgsIDAuODYxMjgsIDAuODYxMjgsIDAuODYxMjgsIDAuODY5MywgMC44NDU3LCAwLjg5NDY0LCAwLjg5NDY0LCAwLjg5NDY0LCAwLjg5NDY0LCAwLjgyNjAxLCAwLjgyNjAxLCAwLjgyNjAxLCAwLjgyNjAxLCAwLjk0NDY5LCAwLjk0NDY5LCAwLjk0ODIsIDAuOTQ4MiwgMC45NDgyLCAwLjk0ODIsIDAuOTQ4MiwgMC45MDc0NywgMC44NjY1MSwgMC45NDQ2OSwgMC45NDQ2OSwgMC45NDQ2OSwgMC45NDQ2OSwgMC45MDUyNywgMC45NDQ2OSwgMC45MDUyNywgMC44Njc1LCAwLjg2MTI4LCAwLjg2NzUsIDAuODYxMjgsIDAuODY3NSwgMC44NjEyOCwgMC43MzgzNCwgMC44NDU3LCAwLjczODM0LCAwLjg0NTcsIDAuNzM4MzQsIDAuODQ1NywgMC43MzgzNCwgMC44NDU3LCAwLjg1MTkzLCAwLjkyNDU0LCAwLjg2NDc3LCAwLjk5MjEsIDAuNzMyMDYsIDAuODk0NjQsIDAuNzMyMDYsIDAuODk0NjQsIDAuNzMyMDYsIDAuODk0NjQsIDAuNzMyMDYsIDAuODk0NjQsIDAuNzMyMDYsIDAuODk0NjQsIDAuODExMDUsIDAuODQ2MzYsIDAuODExMDUsIDAuODQ2MzYsIDAuODExMDUsIDAuODQ2MzYsIDEsIDEsIDAuODYyNzUsIDAuOTQ0NjksIDAuOTA4NzIsIDAuOTU3ODYsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDAuODI2MDEsIDAuOTA2ODUsIDEuMDMyOTcsIDAuOTA2ODUsIDAuODI2MDEsIDAuNzc3NDEsIDEuMDU2MTEsIDAuNjM3NywgMS4wNzY5MiwgMSwgMSwgMC45MDkxOCwgMC43NTU5MywgMS4wMzI5NywgMSwgMSwgMC43NjAzMiwgMC45MDQ1MiwgMC45ODE1NiwgMS4xMTg0MiwgMC43NzI2MSwgMS4xMTQyOSwgMC44OTM4NSwgMC45NDQ2OSwgMSwgMSwgMC44OTM4NSwgMC45NDQ2OSwgMC45NTg3NywgMC44NjkwMSwgMC45NDQ2OSwgMC44NTEyMiwgMC45NDgyLCAwLjg1MTIyLCAwLjk0ODIsIDAuODUxMjIsIDAuOTQ4MiwgMC44NjY3LCAwLjkwMDE2LCAwLjc1MTg2LCAxLjA0NjkyLCAxLCAxLCAwLjc1MTg2LCAxLjA0NjkyLCAwLjY4ODg3LCAwLjc4MjIzLCAwLjY4ODg3LCAwLjc4MjIzLCAwLjY4ODg3LCAwLjc4MjIzLCAwLjY4ODg3LCAwLjc4MjIzLCAxLCAxLCAwLjc5Nzc2LCAwLjkyMTg4LCAwLjc5Nzc2LCAxLjIzMDIzLCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjg4ODQ0LCAwLjk0NDY5LCAwLjk0MjU4LCAwLjk4OTg2LCAwLjczMDYsIDAuOTA1MjcsIDAuNzMwNiwgMC43NjY1OSwgMC43OTAwNCwgMC43NjY1OSwgMC43OTAwNCwgMC43NjY1OSwgMC43OTAwNCwgMS4wOTIzMSwgMC41NDg3MywgMC44Njc1LCAwLjg2MTI4LCAwLjc2MzE4LCAwLjg2OTMsIDAuODUzMTEsIDAuODY2NTEsIDEsIDEsIDAuNzk3NzYsIDEuMjA1NjIsIDEuMTg2MjIsIDEuMTg2MjIsIDEsIDEuMTQzNywgMC42Nzc0MiwgMC45NjMzNCwgMC45MzY5NSwgMS4zNTE5MSwgMS40MDkwOSwgMC45NTE2MSwgMS40ODM4NywgMC44NjY4NiwgMC45MDg2MSwgMC42MjI2NywgMC43NDM1OSwgMC42NTY0OSwgMC44NTQ5OCwgMC41Njk2MywgMC44ODI1NCwgMS4yMzUxNiwgMC44Njc1LCAwLjgxNTUyLCAwLjc1NDQzLCAwLjg0NTAzLCAwLjczMjA2LCAwLjc2NjU5LCAwLjg2Mjc1LCAwLjg1MTIyLCAwLjkwNjg1LCAwLjc3ODkyLCAwLjg1NzQ2LCAxLjAyNjM4LCAwLjg5Mzg1LCAwLjc1NjU3LCAwLjg1MTIyLCAwLjg2Mjc1LCAwLjc3NDUyLCAwLjc0MTcxLCAwLjc5Nzc2LCAwLjczMDYsIDAuOTUxNjUsIDAuNzc4MTgsIDAuODk3NzIsIDAuODg4MzEsIDAuOTA2ODUsIDAuNzMwNiwgMC45ODE0MiwgMS4wMjE5MSwgMC45NjU3NiwgMS4yMzUxNiwgMC45OTAxOCwgMC45ODE0MiwgMC45MjM2LCAwLjg5MjU4LCAwLjk0MDM1LCAxLjAyMTkxLCAwLjc4ODQ4LCAwLjk2NTc2LCAwLjk1NjEsIDEuMjM1MTYsIDAuOTA5MTgsIDAuOTI1NzgsIDAuOTU0MjQsIDAuODk3NDYsIDAuODM5NjksIDAuOTQ4MiwgMC44MDExMywgMC44OTQ0MiwgMC44NTIwOCwgMC44NjE1NSwgMC45ODAyMiwgMC45OTAxOCwgMS4wMDQ1MiwgMC44MTIwOSwgMC45OTI0NywgMC44OTE4MSwgMS4yMzUxNiwgMC45OTAxOCwgMC45NDgyLCAwLjk5MDE4LCAwLjg5MTgxLCAwLjczMjA2LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjg4ODQ0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjg5NDY0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk2NzY2LCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk0MjU4LCAwLjk4OTg2LCAwLjk0MjU4LCAwLjk4OTg2LCAwLjk0MjU4LCAwLjk4OTg2LCAwLjczMDYsIDAuOTA1MjcsIDEsIDEsIDAuODk1NTIsIDAuOTA1MjcsIDEsIDAuOTAxODYsIDEuMTIzMDgsIDEuMTIzMDgsIDEuMTIzMDgsIDEuMTIzMDgsIDEuMjU2NiwgMS4yNTY2LCAxLjI1NjYsIDAuODk1NTIsIDAuODk1NTIsIDEuNDIyNTksIDAuNjkwNDMsIDEuMDM4MDksIDEsIDEsIDEuMDE3NiwgMS4wMTc2LCAxLjExNTIzLCAxLjQ5NTYsIDIuMDE0NjIsIDAuOTkzMzEsIDAuODI2MTYsIDAuOTExMzMsIDAuODQyODYsIDAuOTExMzMsIDEsIDEsIDEsIDAuNzA1MDgsIDEsIDEuMjMxMDgsIDAuNzk4MDEsIDAuODQ0MjYsIDAuODQ0MjYsIDAuNzc0LCAwLjkwNTI3LCAxLjgxMDU1LCAwLjkwNTI3LCAxLjgxMDU1LCAxLjI4ODA5LCAxLjU1NDY5LCAwLjk0NDM0LCAxLjA3ODA2LCAxLCAwLjk3MDk0LCAwLjc1ODksIDAuODUyODQsIDAuOTA3NDcsIDEuMTk2NTgsIDAuNjk4MjUsIDAuOTc2MjIsIDEuMzM1MTIsIDAuOTA3NDcsIDAuOTA3NDcsIDAuODUzNTYsIDAuOTA3NDcsIDAuOTA3NDcsIDEuNDQ5NDcsIDAuODUyODQsIDAuODk0MSwgMC44OTQxLCAwLjcwNTcyLCAwLjgsIDAuNzA1NzIsIDAuNzA1NzIsIDAuNzA1NzIsIDAuNzA1NzIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTk4NjIsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEuMDMzNiwgMC45MTAyNywgMSwgMSwgMSwgMC45OTg2MiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wNTg1OSwgMS4wNTg1OSwgMSwgMSwgMSwgMS4wNzE4NSwgMC45OTQxMywgMC45NjMzNCwgMS4wODA2NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzID0gQ2FsaWJyaVJlZ3VsYXJGYWN0b3JzOwpjb25zdCBDYWxpYnJpUmVndWxhck1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4yMjA3LAogIGxpbmVHYXA6IDAuMjIwNwp9OwpleHBvcnRzLkNhbGlicmlSZWd1bGFyTWV0cmljcyA9IENhbGlicmlSZWd1bGFyTWV0cmljczsKCi8qKiovIH0pLAovKiA1MyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkhlbHZldGljYVJlZ3VsYXJNZXRyaWNzID0gZXhwb3J0cy5IZWx2ZXRpY2FSZWd1bGFyRmFjdG9ycyA9IGV4cG9ydHMuSGVsdmV0aWNhSXRhbGljTWV0cmljcyA9IGV4cG9ydHMuSGVsdmV0aWNhSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuSGVsdmV0aWNhQm9sZE1ldHJpY3MgPSBleHBvcnRzLkhlbHZldGljYUJvbGRJdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5IZWx2ZXRpY2FCb2xkSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuSGVsdmV0aWNhQm9sZEZhY3RvcnMgPSB2b2lkIDA7CmNvbnN0IEhlbHZldGljYUJvbGRGYWN0b3JzID0gWzAuNzYxMTYsIDEsIDEsIDEuMDAwNiwgMC45OTk5OCwgMC45OTk3NCwgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMC45OTk3NywgMS4wMDA4NywgMC45OTk5OCwgMC45OTk5OCwgMC45OTk1OSwgMS4wMDAwMywgMS4wMDA2LCAwLjk5OTk4LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk5OCwgMSwgMS4wMDAwMywgMS4wMDAwMywgMS4wMDAwMywgMS4wMDAyNiwgMC45OTk5LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMDEsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMTYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5OTgsIDEuMDAwNiwgMC45OTk5OCwgMS4wMDAwMywgMC45OTk3MywgMC45OTk5OCwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk4MiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45OTk1OSwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyMiwgMC45OTk3MywgMC45OTk3MywgMSwgMC45OTk1OSwgMS4wMDA3NywgMC45OTk1OSwgMS4wMDAwMywgMC45OTk5OCwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA3NywgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNSwgMC45OTk2OCwgMC45OTk3MywgMS4wMDAwMywgMS4wMDAyNSwgMC42MDI5OSwgMS4wMDAyNCwgMS4wNjQwOSwgMSwgMSwgMC45OTk5OCwgMSwgMC45OTk3MywgMS4wMDA2LCAwLjk5OTk4LCAxLCAwLjk5OTM2LCAwLjk5OTczLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDI2LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMDMsIDEuMDAwMjIsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5ODIsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wNjQwOSwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMC45OTk3NywgMS4wMzM3NCwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDQyLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAxLjAzODI4LCAxLjAwMDI2LCAwLjk5OTk5LCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5MywgMC45OTk4LCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLCAxLjAwMDE2LCAwLjk5OTc3LCAwLjk5OTU5LCAwLjk5OTc3LCAwLjk5OTU5LCAwLjk5OTc3LCAwLjk5OTU5LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTk4LCAxLjAwMDI2LCAwLjgxMjEsIDEuMDAwMjYsIDAuOTk5OTgsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMSwgMC45OTk4MiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMS4wMDAzNCwgMC45OTk3NywgMSwgMC45OTk5NywgMS4wMDAyNiwgMS4wMDA3OCwgMS4wMDAzNiwgMC45OTk3MywgMS4wMDAxMywgMS4wMDA2LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTg4LCAwLjg1MTQ4LCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDYsIDAuOTk5NzcsIDEuMDAwMDEsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwNjksIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDAuOTk5ODQsIDEuMDAwMjYsIDEuMDAwMDEsIDEuMDAwMjQsIDEuMDAwMDEsIDAuOTk5OSwgMSwgMS4wMDA2LCAxLjAwMDAxLCAxLjAwMDQxLCAwLjk5OTYyLCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5OTUsIDEuMDAwNDEsIDAuOTk5NDIsIDAuOTk5NzMsIDAuOTk5MjcsIDEuMDAwODIsIDAuOTk5MDIsIDEuMDAwMjYsIDEuMDAwODcsIDEuMDAwNiwgMS4wMDA2OSwgMC45OTk3MywgMC45OTg2NywgMC45OTk3MywgMC45OTkzLCAxLjAwMDI2LCAxLjAwMDQ5LCAxLjAwMDU2LCAxLCAwLjk5OTg4LCAwLjk5OTM1LCAwLjk5OTk1LCAwLjk5OTU0LCAxLjAwMDU1LCAwLjk5OTQ1LCAxLjAwMDMyLCAxLjAwMDYsIDAuOTk5OTUsIDEuMDAwMjYsIDAuOTk5OTUsIDEuMDAwMzIsIDEuMDAwMDEsIDEuMDAwMDgsIDAuOTk5NzEsIDEuMDAwMTksIDAuOTk5NCwgMS4wMDAwMSwgMS4wMDA2LCAxLjAwMDQ0LCAwLjk5OTczLCAxLjAwMDIzLCAxLjAwMDQ3LCAxLCAwLjk5OTQyLCAwLjk5NTYxLCAwLjk5OTg5LCAxLjAwMDM1LCAwLjk5OTc3LCAxLjAwMDM1LCAwLjk5OTc3LCAxLjAwMDE5LCAwLjk5OTQ0LCAxLjAwMDAxLCAxLjAwMDIxLCAwLjk5OTI2LCAxLjAwMDM1LCAxLjAwMDM1LCAwLjk5OTQyLCAxLjAwMDQ4LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDM1LCAxLjAwMDAxLCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTg5LCAxLjAwMDU3LCAxLjAwMDAxLCAwLjk5OTM2LCAxLjAwMDUyLCAxLjAwMDEyLCAwLjk5OTk2LCAxLjAwMDQzLCAxLCAxLjAwMDM1LCAwLjk5OTQsIDAuOTk5NzYsIDEuMDAwMzUsIDAuOTk5NzMsIDEuMDAwNTIsIDEuMDAwNDEsIDEuMDAxMTksIDEuMDAwMzcsIDAuOTk5NzMsIDEuMDAwMDIsIDAuOTk5ODYsIDEuMDAwNDEsIDEuMDAwNDEsIDAuOTk5MDIsIDAuOTk5NiwgMS4wMDAzNCwgMC45OTk5OSwgMS4wMDAyNiwgMC45OTk5OSwgMS4wMDAyNiwgMC45OTk3MywgMS4wMDA1MiwgMC45OTk3MywgMSwgMC45OTk3MywgMS4wMDA0MSwgMS4wMDA3NSwgMC45OTk0LCAxLjAwMDMsIDAuOTk5OTksIDEsIDEuMDAwNDEsIDAuOTk5NTUsIDEsIDAuOTk5MTUsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjYsIDEuMDAxMTksIDAuOTk5NTUsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTkxMSwgMS4wMDA2LCAxLjAwMDI2LCAwLjk5OTcyLCAxLjAwMDI2LCAwLjk5OTAyLCAxLjAwMDQxLCAwLjk5OTczLCAwLjk5OTk5LCAxLCAxLCAxLjAwMDM4LCAxLjAwMDUsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NTUsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMSwgMSwgMSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MiwgMSwgMSwgMS4wMDEwNiwgMC45OTk5OSwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OSwgMC45OTk5OCwgMS42NjQ3NSwgMSwgMC45OTk3MywgMC45OTk3MywgMS4wMDAyMywgMC45OTk3MywgMC45OTk3MSwgMS4wMDA0NywgMS4wMDAyMywgMSwgMC45OTk5MSwgMC45OTk4NCwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45OTk3MiwgMSwgMS4yMDk4NSwgMS4zOTcxMywgMS4wMDAwMywgMS4wMDAzMSwgMS4wMDAxNSwgMSwgMC45OTU2MSwgMS4wMDAyNywgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTkxNSwgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTk5OSwgMS4wMDAwMywgMC45OTk5OSwgMC45OTk5OSwgMS40MTE0NCwgMS42LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQwNTc5LCAxLjQwNTc5LCAxLjM2NjI1LCAwLjk5OTk5LCAxLCAwLjk5ODYxLCAwLjk5ODYxLCAxLCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk5OTcyLCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQwNDgzLCAxLCAwLjk5OTc3LCAxLjAwMDU0LCAxLCAxLCAwLjk5OTUzLCAwLjk5OTYyLCAxLjAwMDQyLCAwLjk5OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLkhlbHZldGljYUJvbGRGYWN0b3JzID0gSGVsdmV0aWNhQm9sZEZhY3RvcnM7CmNvbnN0IEhlbHZldGljYUJvbGRNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5IZWx2ZXRpY2FCb2xkTWV0cmljcyA9IEhlbHZldGljYUJvbGRNZXRyaWNzOwpjb25zdCBIZWx2ZXRpY2FCb2xkSXRhbGljRmFjdG9ycyA9IFswLjc2MTE2LCAxLCAxLCAxLjAwMDYsIDAuOTk5OTgsIDAuOTk5NzQsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5ODIsIDAuOTk5NzcsIDEuMDAwODcsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5NTksIDEuMDAwMDMsIDEuMDAwNiwgMC45OTk5OCwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5OTgsIDEsIDEuMDAwMDMsIDEuMDAwMDMsIDEuMDAwMDMsIDEuMDAwMjYsIDAuOTk5OSwgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAyNiwgMS4wMDAyMiwgMC45OTk3NywgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDAxLCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDE2LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTk4LCAxLjAwMDYsIDAuOTk5OTgsIDEuMDAwMDMsIDAuOTk5NzMsIDAuOTk5OTgsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5OTgsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAxLjAwMDYsIDAuOTk5ODIsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDAuOTk5NTksIDAuOTk5NzMsIDAuOTk5OTgsIDEuMDAwMjYsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDAuOTk5NzMsIDEsIDAuOTk5NTksIDEuMDAwNzcsIDAuOTk5NTksIDEuMDAwMDMsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNzcsIDAuOTk5NzMsIDAuOTk5OTgsIDEuMDAwMjUsIDAuOTk5NjgsIDAuOTk5NzMsIDEuMDAwMDMsIDEuMDAwMjUsIDAuNjAyOTksIDEuMDAwMjQsIDEuMDY0MDksIDEsIDEsIDAuOTk5OTgsIDEsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk5OCwgMSwgMC45OTkzNiwgMC45OTk3MywgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAwMiwgMS4wMDAyNiwgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMSwgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDIyLCAxLjAwMDAzLCAxLjAwMDIyLCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTgyLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDY0MDksIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDEuMDAwMjYsIDAuOTk5NzMsIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzcsIDEuMDA0NCwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAyMiwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTcxLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDAyNiwgMS4wMDA2LCAxLjAwMDI2LCAxLjAxMDExLCAxLjAwMDI2LCAwLjk5OTk5LCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5MywgMC45OTk4LCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDIyLCAxLjAwMDI2LCAxLCAxLjAwMDE2LCAwLjk5OTc3LCAwLjk5OTU5LCAwLjk5OTc3LCAwLjk5OTU5LCAwLjk5OTc3LCAwLjk5OTU5LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTk4LCAxLjAwMDI2LCAwLjgxMjEsIDEuMDAwMjYsIDAuOTk5OTgsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjYsIDEuMDAwMTYsIDEuMDAwMjIsIDEuMDAwMDEsIDAuOTk5NzMsIDEuMDAwMDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwMjYsIDEsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3NywgMC45OTk3MywgMSwgMC45OTk4MiwgMS4wMDAyMiwgMS4wMDAyNiwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAyNiwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk5OCwgMC45OTk3NywgMSwgMSwgMS4wMDAyNiwgMC45OTk2OSwgMC45OTk3MiwgMC45OTk4MSwgMC45OTk4LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMjIsIDAuOTExNTUsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwNiwgMC45OTk3NywgMS4wMDAwMSwgMC45OTk5OSwgMC45OTk3NywgMC45OTk2NiwgMS4wMDAyMiwgMS4wMDAzMiwgMS4wMDAwMSwgMC45OTk0NCwgMS4wMDAyNiwgMS4wMDAwMSwgMC45OTk2OCwgMS4wMDAwMSwgMS4wMDA0NywgMSwgMS4wMDA2LCAxLjAwMDAxLCAwLjk5OTgxLCAxLjAwMTAxLCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5NDgsIDAuOTk5ODEsIDEuMDAwNjQsIDAuOTk5NzMsIDAuOTk5NDIsIDEuMDAxMDEsIDEuMDAwNjEsIDEuMDAwMjYsIDEuMDAwNjksIDEuMDAwNiwgMS4wMDAxNCwgMC45OTk3MywgMS4wMTMyMiwgMC45OTk3MywgMS4wMDA2NSwgMS4wMDAyNiwgMS4wMDAxMiwgMC45OTkyMywgMSwgMS4wMDA2NCwgMS4wMDA3NiwgMC45OTk0OCwgMS4wMDA1NSwgMS4wMDA2MywgMS4wMDAwNywgMC45OTk0MywgMS4wMDA2LCAwLjk5OTQ4LCAxLjAwMDI2LCAwLjk5OTQ4LCAwLjk5OTQzLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI5LCAxLjAwMDM4LCAxLjAwMDM1LCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3OCwgMS4wMDAwMSwgMS4wMDA1NywgMC45OTk4OSwgMC45OTk2NywgMC45OTk2NCwgMC45OTk2NywgMC45OTk3NywgMC45OTk5OSwgMC45OTk3NywgMS4wMDAzOCwgMC45OTk3NywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDA2NiwgMC45OTk2NywgMC45OTk2NywgMS4wMDA0MSwgMC45OTk5OCwgMC45OTk5OSwgMC45OTk3NywgMS4wMDAyMiwgMC45OTk2NywgMS4wMDAwMSwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk2NCwgMS4wMDAzMSwgMS4wMDAwMSwgMC45OTk5OSwgMC45OTk5OSwgMSwgMS4wMDAyMywgMSwgMSwgMC45OTk5OSwgMS4wMDAzNSwgMS4wMDAwMSwgMC45OTk5OSwgMC45OTk3MywgMC45OTk3NywgMC45OTk5OSwgMS4wMDA1OCwgMC45OTk3MywgMC45OTk3MywgMC45OTk1NSwgMC45OTk1LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDMyLCAwLjk5OTg5LCAxLjAwMDM0LCAwLjk5OTk5LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk5OTczLCAwLjQ1OTk4LCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTk5LCAwLjk5OTgyLCAwLjk5OTk0LCAwLjk5OTk2LCAxLCAxLjAwMDQyLCAxLjAwMDQ0LCAxLjAwMDI5LCAxLjAwMDIzLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDI2LCAwLjk5OTQ5LCAxLjAwMDAyLCAwLjk5OTczLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTc1LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDMyLCAwLjk4Njg1LCAwLjk5OTczLCAxLjAwMDI2LCAxLCAxLCAwLjk5OTY2LCAxLjAwMDQ0LCAxLjAwMDE2LCAxLjAwMDIyLCAxLjAwMDE2LCAxLjAwMDIyLCAxLjAwMDE2LCAxLjAwMDIyLCAxLjAwMDAxLCAwLjk5OTczLCAxLCAxLCAwLjk5OTczLCAxLCAxLCAwLjk5OTU1LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEsIDEsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzIsIDEsIDEsIDEuMDAxMDYsIDAuOTk5OTksIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTksIDAuOTk5OTgsIDEuNjY0NzUsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDEsIDAuOTk5NzMsIDAuOTk5NzEsIDAuOTk5NzgsIDEsIDEsIDAuOTk5OTEsIDAuOTk5ODQsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwOTgsIDEsIDEsIDEsIDEuMDAwNDksIDEsIDEsIDAuOTk5NzIsIDEsIDEuMjA5ODUsIDEuMzk3MTMsIDEuMDAwMDMsIDEuMDAwMzEsIDEuMDAwMTUsIDEsIDAuOTk1NjEsIDEuMDAwMjcsIDEuMDAwMzEsIDEuMDAwMzEsIDAuOTk5MTUsIDEuMDAwMzEsIDEuMDAwMzEsIDAuOTk5OTksIDEuMDAwMDMsIDAuOTk5OTksIDAuOTk5OTksIDEuNDExNDQsIDEuNiwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MDU3OSwgMS40MDU3OSwgMS4zNjYyNSwgMC45OTk5OSwgMSwgMC45OTg2MSwgMC45OTg2MSwgMSwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45OTk3MiwgMC45OTk5OSwgMC45OTk5OSwgMC45OTk5OSwgMC45OTk5OSwgMS40MDQ4MywgMSwgMC45OTk3NywgMS4wMDA1NCwgMSwgMSwgMC45OTk1MywgMC45OTk2MiwgMS4wMDA0MiwgMC45OTk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5IZWx2ZXRpY2FCb2xkSXRhbGljRmFjdG9ycyA9IEhlbHZldGljYUJvbGRJdGFsaWNGYWN0b3JzOwpjb25zdCBIZWx2ZXRpY2FCb2xkSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjM1LAogIGxpbmVHYXA6IDAuMgp9OwpleHBvcnRzLkhlbHZldGljYUJvbGRJdGFsaWNNZXRyaWNzID0gSGVsdmV0aWNhQm9sZEl0YWxpY01ldHJpY3M7CmNvbnN0IEhlbHZldGljYUl0YWxpY0ZhY3RvcnMgPSBbMC43NjExNiwgMSwgMSwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwMDYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5ODIsIDEuMDAwMDEsIDEuMDAwNDMsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5NTksIDEuMDAwMDMsIDEuMDAwNiwgMC45OTk5OCwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMSwgMS4wMDAwMywgMS4wMDAwMywgMS4wMDAwMywgMC45OTk3MywgMC45OTk4NywgMS4wMDAwMSwgMS4wMDAwMSwgMC45OTk3NywgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAyNiwgMS4wMDAyMiwgMC45OTk3NywgMS4wMDA2LCAxLCAxLjAwMDAxLCAwLjk5OTczLCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDAxLCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDE2LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTQ5LCAwLjk5OTczLCAwLjk5OTk4LCAwLjk5OTczLCAwLjk5OTczLCAxLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5MjQsIDAuOTk5MjQsIDEsIDAuOTk5MjQsIDAuOTk5OTksIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5OTgsIDEsIDEuMDAwNiwgMC45OTk3MywgMSwgMC45OTk3NywgMSwgMSwgMSwgMS4wMDAwNSwgMS4wMDA5LCAxLjAwMDA1LCAxLjAwMDAzLCAwLjk5OTk4LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDksIDAuOTk5NzMsIDAuOTk5OTgsIDEuMDAwMjUsIDAuOTk5NjgsIDAuOTk5NzMsIDEuMDAwMDMsIDEuMDAwMjUsIDAuNjAyOTksIDEuMDAwMjQsIDEuMDY0MDksIDEsIDEsIDAuOTk5OTgsIDEsIDAuOTk5OCwgMS4wMDA2LCAwLjk5OTk4LCAxLCAwLjk5OTM2LCAwLjk5OTczLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDI2LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMjIsIDEuMDAwMDMsIDEuMDAwMjIsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5ODIsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wNjQwOSwgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMSwgMC45OTk3MywgMSwgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMS4wMDAwMSwgMC45OTk3MywgMC45OTk3NywgMSwgMC45OTk3NywgMSwgMC45OTk3NywgMSwgMC45OTk3NywgMSwgMC45OTk3NywgMS4wMjg4LCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5MjQsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTQ2LCAxLjAwMDM0LCAxLCAwLjk5OTI0LCAxLjAwMDAxLCAxLCAxLCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTczLCAxLjA2MzExLCAwLjk5OTczLCAxLjAwMDI0LCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDQxLCAwLjk5OTgsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEsIDEuMDAwMTYsIDAuOTk5NzcsIDAuOTk5OTgsIDAuOTk5NzcsIDAuOTk5OTgsIDAuOTk5NzcsIDAuOTk5OTgsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDAyNiwgMC44OTU0NywgMS4wMDAyNiwgMS4wMDA2LCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDE2LCAwLjk5OTc3LCAxLjAwMDAxLCAxLCAxLjAwMDAxLCAxLjAwMDI2LCAxLCAxLjAwMDI2LCAxLCAxLjAwMDI2LCAxLCAwLjk5OTI0LCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLCAwLjk5OTgyLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDAxLCAxLCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDEuMDAwMDEsIDEsIDEuMDAwNTQsIDAuOTk5NzcsIDEuMDAwODQsIDEuMDAwMDcsIDAuOTk5NzMsIDEuMDAwMTMsIDAuOTk5MjQsIDEuMDAwMDEsIDEuMDAwMDEsIDAuOTk5NDUsIDAuOTEyMjEsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwNiwgMS4wMDAwMSwgMS4wMDAwMSwgMC45OTk5OSwgMC45OTk3NywgMC45OTkzMywgMS4wMDAyMiwgMS4wMDA1NCwgMS4wMDAwMSwgMS4wMDA2NSwgMS4wMDAyNiwgMS4wMDAwMSwgMS4wMDAxLCAxLjAwMDAxLCAxLjAwMDUyLCAxLCAxLjAwMDYsIDEuMDAwMDEsIDAuOTk5NDUsIDAuOTk4OTcsIDAuOTk5NjgsIDAuOTk5MjQsIDEuMDAwMzYsIDAuOTk5NDUsIDAuOTk5NDksIDEsIDEuMDAwNiwgMC45OTg5NywgMC45OTkxOCwgMC45OTk2OCwgMC45OTkxMSwgMC45OTkyNCwgMSwgMC45OTk2MiwgMS4wMTQ4NywgMSwgMS4wMDA1LCAwLjk5OTczLCAxLjAwMDEyLCAxLjAwMDQzLCAxLCAwLjk5OTk1LCAwLjk5OTk0LCAxLjAwMDM2LCAwLjk5OTQ3LCAxLjAwMDE5LCAxLjAwMDYzLCAxLjAwMDI1LCAwLjk5OTI0LCAxLjAwMDM2LCAwLjk5OTczLCAxLjAwMDM2LCAxLjAwMDI1LCAxLjAwMDAxLCAxLjAwMDAxLCAxLjAwMDI3LCAxLjAwMDEsIDEuMDAwNjgsIDEuMDAwMDEsIDEuMDAwNiwgMS4wMDA2LCAxLCAxLjAwMDA4LCAwLjk5OTU3LCAwLjk5OTcyLCAwLjk5OTQsIDAuOTk5NTQsIDAuOTk5NzUsIDEuMDAwNTEsIDEuMDAwMDEsIDEuMDAwMTksIDEuMDAwMDEsIDEuMDAwMSwgMC45OTk4NiwgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAzOCwgMC45OTk1NCwgMC45OTk1NCwgMC45OTk0LCAxLjAwMDY2LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDIyLCAxLjAwMDU0LCAxLjAwMDAxLCAwLjk5OTc3LCAxLjAwMDI2LCAwLjk5OTc1LCAxLjAwMDEsIDEuMDAwMDEsIDAuOTk5OTMsIDAuOTk5NSwgMC45OTk1NSwgMS4wMDAxNiwgMC45OTk3OCwgMC45OTk3NCwgMS4wMDAxOSwgMS4wMDAyMiwgMC45OTk1NSwgMS4wMDA1MywgMC45OTk3MywgMS4wMDA4OSwgMS4wMDAwNSwgMC45OTk2NywgMS4wMDA0OCwgMC45OTk3MywgMS4wMDAwMiwgMS4wMDAzNCwgMC45OTk3MywgMC45OTk3MywgMC45OTk2NCwgMS4wMDAwNiwgMS4wMDA2NiwgMC45OTk0NywgMC45OTk3MywgMC45ODg5NCwgMC45OTk3MywgMSwgMC40NDg5OCwgMSwgMC45OTk0NiwgMSwgMS4wMDAzOSwgMS4wMDA4MiwgMC45OTk5MSwgMC45OTk5MSwgMC45OTk4NSwgMS4wMDAyMiwgMS4wMDAyMywgMS4wMDA2MSwgMS4wMDAwNiwgMC45OTk2NiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDAxOSwgMS4wMDA4LCAxLCAwLjk5OTI0LCAwLjk5OTI0LCAwLjk5OTI0LCAwLjk5OTgzLCAxLjAwMDQ0LCAwLjk5OTczLCAwLjk5OTY0LCAwLjk4MzMyLCAxLCAwLjk5OTczLCAxLCAxLCAwLjk5OTYyLCAwLjk5ODk1LCAxLjAwMDE2LCAwLjk5OTc3LCAxLjAwMDE2LCAwLjk5OTc3LCAxLjAwMDE2LCAwLjk5OTc3LCAxLjAwMDAxLCAxLCAxLCAxLCAwLjk5OTczLCAxLCAxLCAwLjk5OTU1LCAwLjk5OTI0LCAwLjk5OTI0LCAwLjk5OTI0LCAwLjk5OTI0LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTcyLCAxLCAxLCAxLjAwMjY3LCAwLjk5OTk5LCAwLjk5OTk4LCAwLjk5OTk4LCAxLCAwLjk5OTk4LCAxLjY2NDc1LCAxLCAwLjk5OTczLCAwLjk5OTczLCAxLjAwMDIzLCAwLjk5OTczLCAxLjAwNDIzLCAwLjk5OTI1LCAwLjk5OTk5LCAxLCAwLjk5OTkxLCAwLjk5OTg0LCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDAyLCAxLjAwMDQ5LCAxLCAxLjAwMjQ1LCAxLCAxLCAxLCAxLCAwLjk2MzI5LCAxLCAxLjIwOTg1LCAxLjM5NzEzLCAxLjAwMDAzLCAwLjgyNTQsIDEuMDAwMTUsIDEsIDEuMDAwMzUsIDEuMDAwMjcsIDEuMDAwMzEsIDEuMDAwMzEsIDEuMDAwMDMsIDEuMDAwMzEsIDEuMDAwMzEsIDAuOTk5OTksIDEuMDAwMDMsIDAuOTk5OTksIDAuOTk5OTksIDEuNDExNDQsIDEuNiwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MTE0NCwgMS40MDU3OSwgMS40MDU3OSwgMS4zNjYyNSwgMC45OTk5OSwgMSwgMC45OTg2MSwgMC45OTg2MSwgMSwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMS4wMDAyNiwgMC45NTMxNywgMC45OTk5OSwgMC45OTk5OSwgMC45OTk5OSwgMC45OTk5OSwgMS40MDQ4MywgMSwgMC45OTk3NywgMS4wMDA1NCwgMSwgMSwgMC45OTk1MywgMC45OTk2MiwgMS4wMDA0MiwgMC45OTk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAwLjk5OTk4LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5IZWx2ZXRpY2FJdGFsaWNGYWN0b3JzID0gSGVsdmV0aWNhSXRhbGljRmFjdG9yczsKY29uc3QgSGVsdmV0aWNhSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjM1LAogIGxpbmVHYXA6IDAuMgp9OwpleHBvcnRzLkhlbHZldGljYUl0YWxpY01ldHJpY3MgPSBIZWx2ZXRpY2FJdGFsaWNNZXRyaWNzOwpjb25zdCBIZWx2ZXRpY2FSZWd1bGFyRmFjdG9ycyA9IFswLjc2MTE2LCAxLCAxLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMS4wMDAwMSwgMS4wMDA0MywgMC45OTk5OCwgMC45OTk5OCwgMC45OTk1OSwgMS4wMDAwMywgMS4wMDA2LCAwLjk5OTk4LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAxLCAxLjAwMDAzLCAxLjAwMDAzLCAxLjAwMDAzLCAwLjk5OTczLCAwLjk5OTg3LCAxLjAwMDAxLCAxLjAwMDAxLCAwLjk5OTc3LCAwLjk5OTc3LCAxLjAwMDAxLCAxLjAwMDI2LCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDYsIDEsIDEuMDAwMDEsIDAuOTk5NzMsIDAuOTk5OTksIDAuOTk5NzcsIDEuMDAwMjIsIDEuMDAwMDEsIDEuMDAwMjIsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMjYsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMTYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5NDksIDAuOTk5NzMsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNiwgMC45OTk3MywgMC45OTk3MywgMC45OTkyNCwgMC45OTkyNCwgMSwgMC45OTkyNCwgMC45OTk5OSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk5OCwgMSwgMS4wMDA2LCAwLjk5OTczLCAxLCAwLjk5OTc3LCAxLCAxLCAxLCAxLjAwMDA1LCAxLjAwMDksIDEuMDAwMDUsIDEuMDAwMDMsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwOSwgMC45OTk3MywgMC45OTk5OCwgMS4wMDAyNSwgMC45OTk2OCwgMC45OTk3MywgMS4wMDAwMywgMS4wMDAyNSwgMC42MDI5OSwgMS4wMDAyNCwgMS4wNjQwOSwgMSwgMSwgMC45OTk5OCwgMSwgMC45OTk4LCAxLjAwMDYsIDAuOTk5OTgsIDEsIDAuOTk5MzYsIDAuOTk5NzMsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMjYsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEsIDAuOTk5NzcsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMC45OTk3NywgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAyMiwgMS4wMDAwMywgMS4wMDAyMiwgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMC45OTk3NywgMS4wMDAwMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk4MiwgMSwgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMC45OTk3MywgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLjA2NDA5LCAxLjAwMDI2LCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAwLjk5OTczLCAxLCAwLjk5OTczLCAxLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLCAwLjk5OTc3LCAxLjA0NTk2LCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAxLjAwMDIyLCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDYsIDAuOTk5MjQsIDEuMDAwNiwgMS4wMDA2LCAxLjAwMDE5LCAxLjAwMDM0LCAxLCAwLjk5OTI0LCAxLjAwMDAxLCAxLCAxLCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTczLCAxLjAyNTcyLCAwLjk5OTczLCAxLjAwMDA1LCAwLjk5OTczLCAwLjk5OTI0LCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTk5LCAwLjk5OTgsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEuMDAwMjIsIDAuOTk5NzMsIDEsIDEuMDAwMTYsIDAuOTk5NzcsIDAuOTk5OTgsIDAuOTk5NzcsIDAuOTk5OTgsIDAuOTk5NzcsIDAuOTk5OTgsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMDEsIDEsIDEuMDAwMjYsIDEuMDAwNiwgMS4wMDAyNiwgMC44NDUzMywgMS4wMDAyNiwgMS4wMDA2LCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDE2LCAwLjk5OTc3LCAxLjAwMDAxLCAxLCAxLjAwMDAxLCAxLjAwMDI2LCAxLCAxLjAwMDI2LCAxLCAxLjAwMDI2LCAxLCAwLjk5OTI0LCAwLjk5OTczLCAxLjAwMDAxLCAwLjk5OTczLCAxLCAwLjk5OTgyLCAxLjAwMDIyLCAxLjAwMDI2LCAxLjAwMDAxLCAxLCAxLjAwMDI2LCAxLjAwMDYsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5MjgsIDEsIDAuOTk5NzcsIDEuMDAwMTMsIDEuMDAwNTUsIDAuOTk5NDcsIDAuOTk5NDUsIDAuOTk5NDEsIDAuOTk5MjQsIDEuMDAwMDEsIDEuMDAwMDEsIDEuMDAwNCwgMC45MTYyMSwgMS4wMDAwMSwgMS4wMDAyNiwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDA2LCAxLjAwMDAxLCAxLjAwMDA1LCAwLjk5OTk5LCAwLjk5OTc3LCAxLjAwMDE1LCAxLjAwMDIyLCAwLjk5OTc3LCAxLjAwMDAxLCAwLjk5OTczLCAxLjAwMDI2LCAxLjAwMDAxLCAxLjAwMDE5LCAxLjAwMDAxLCAwLjk5OTQ2LCAxLCAxLjAwMDYsIDEuMDAwMDEsIDAuOTk5NzgsIDEuMDAwNDUsIDAuOTk5NzMsIDAuOTk5MjQsIDEuMDAwMjMsIDAuOTk5NzgsIDAuOTk5NjYsIDEsIDEuMDAwNjUsIDEuMDAwNDUsIDEuMDAwMTksIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5MjQsIDEsIDEsIDAuOTY0OTksIDEsIDEuMDAwNTUsIDAuOTk5NzMsIDEuMDAwMDgsIDEuMDAwMjcsIDEsIDAuOTk5NywgMC45OTk5NSwgMS4wMDAyMywgMC45OTkzMywgMS4wMDAxOSwgMS4wMDAxNSwgMS4wMDAzMSwgMC45OTkyNCwgMS4wMDAyMywgMC45OTk3MywgMS4wMDAyMywgMS4wMDAzMSwgMS4wMDAwMSwgMC45OTkyOCwgMS4wMDAyOSwgMS4wMDA5MiwgMS4wMDAzNSwgMS4wMDAwMSwgMS4wMDA2LCAxLjAwMDYsIDEsIDAuOTk5ODgsIDAuOTk5NzUsIDEsIDEuMDAwODIsIDAuOTk1NjEsIDAuOTk5NiwgMS4wMDAzNSwgMS4wMDAwMSwgMC45OTk2MiwgMS4wMDAwMSwgMS4wMDA5MiwgMC45OTk2NCwgMS4wMDAwMSwgMC45OTk2MywgMC45OTk5OSwgMS4wMDAzNSwgMS4wMDAzNSwgMS4wMDA4MiwgMC45OTk2MiwgMC45OTk5OSwgMC45OTk3NywgMS4wMDAyMiwgMS4wMDAzNSwgMS4wMDAwMSwgMC45OTk3NywgMS4wMDAyNiwgMC45OTk2LCAwLjk5OTY3LCAxLjAwMDAxLCAxLjAwMDM0LCAxLjAwMDc0LCAxLjAwMDU0LCAxLjAwMDUzLCAxLjAwMDYzLCAwLjk5OTcxLCAwLjk5OTYyLCAxLjAwMDM1LCAwLjk5OTc1LCAwLjk5OTc3LCAwLjk5OTczLCAxLjAwMDQzLCAwLjk5OTUzLCAxLjAwMDcsIDAuOTk5MTUsIDAuOTk5NzMsIDEuMDAwMDgsIDAuOTk4OTIsIDEuMDAwNzMsIDEuMDAwNzMsIDEuMDAxMTQsIDAuOTk5MTUsIDEuMDAwNzMsIDAuOTk5NTUsIDAuOTk5NzMsIDEuMDAwOTIsIDAuOTk5NzMsIDEsIDAuOTk5OTgsIDEsIDEuMDAwMywgMSwgMS4wMDA0MywgMS4wMDAwMSwgMC45OTk2OSwgMS4wMDAzLCAxLCAxLjAwMDM1LCAxLjAwMDAxLCAwLjk5OTUsIDEsIDEuMDAwOTIsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwNywgMC45OTk1LCAxLCAwLjk5OTI0LCAxLjAwMDYsIDAuOTk5MjQsIDAuOTk5NzIsIDEuMDAwNjIsIDAuOTk5NzMsIDEuMDAxMTQsIDEuMDAwNzMsIDEsIDAuOTk5NTUsIDEsIDEsIDEuMDAwNDcsIDAuOTk5NjgsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMTYsIDAuOTk5NzcsIDEuMDAwMDEsIDEsIDEsIDEsIDAuOTk5NzMsIDEsIDEsIDAuOTk5NTUsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5MjQsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5OTgsIDAuOTk5NzMsIDAuOTk5NzMsIDAuOTk5NzIsIDEsIDEsIDEuMDAyNjcsIDAuOTk5OTksIDAuOTk5OTgsIDAuOTk5OTgsIDEsIDAuOTk5OTgsIDEuNjY0NzUsIDEsIDAuOTk5NzMsIDAuOTk5NzMsIDEuMDAwMjMsIDAuOTk5NzMsIDAuOTk5NzEsIDAuOTk5MjUsIDEuMDAwMjMsIDEsIDAuOTk5OTEsIDAuOTk5ODQsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEuMDAwMDIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTYzMjksIDEsIDEuMjA5ODUsIDEuMzk3MTMsIDEuMDAwMDMsIDAuODI1NCwgMS4wMDAxNSwgMSwgMS4wMDAzNSwgMS4wMDAyNywgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTkxNSwgMS4wMDAzMSwgMS4wMDAzMSwgMC45OTk5OSwgMS4wMDAwMywgMC45OTk5OSwgMC45OTk5OSwgMS40MTE0NCwgMS42LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQxMTQ0LCAxLjQwNTc5LCAxLjQwNTc5LCAxLjM2NjI1LCAwLjk5OTk5LCAxLCAwLjk5ODYxLCAwLjk5ODYxLCAxLCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAxLjAwMDI2LCAwLjk1MzE3LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAwLjk5OTk5LCAxLjQwNDgzLCAxLCAwLjk5OTc3LCAxLjAwMDU0LCAxLCAxLCAwLjk5OTUzLCAwLjk5OTYyLCAxLjAwMDQyLCAwLjk5OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLkhlbHZldGljYVJlZ3VsYXJGYWN0b3JzID0gSGVsdmV0aWNhUmVndWxhckZhY3RvcnM7CmNvbnN0IEhlbHZldGljYVJlZ3VsYXJNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5IZWx2ZXRpY2FSZWd1bGFyTWV0cmljcyA9IEhlbHZldGljYVJlZ3VsYXJNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTGliZXJhdGlvblNhbnNSZWd1bGFyV2lkdGhzID0gZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nID0gZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocyA9IGV4cG9ydHMuTGliZXJhdGlvblNhbnNJdGFsaWNNYXBwaW5nID0gZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMgPSBleHBvcnRzLkxpYmVyYXRpb25TYW5zQm9sZE1hcHBpbmcgPSBleHBvcnRzLkxpYmVyYXRpb25TYW5zQm9sZEl0YWxpY1dpZHRocyA9IGV4cG9ydHMuTGliZXJhdGlvblNhbnNCb2xkSXRhbGljTWFwcGluZyA9IHZvaWQgMDsKY29uc3QgTGliZXJhdGlvblNhbnNCb2xkV2lkdGhzID0gWzM2NSwgMCwgMzMzLCAyNzgsIDMzMywgNDc0LCA1NTYsIDU1NiwgODg5LCA3MjIsIDIzOCwgMzMzLCAzMzMsIDM4OSwgNTg0LCAyNzgsIDMzMywgMjc4LCAyNzgsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMzMzLCAzMzMsIDU4NCwgNTg0LCA1ODQsIDYxMSwgOTc1LCA3MjIsIDcyMiwgNzIyLCA3MjIsIDY2NywgNjExLCA3NzgsIDcyMiwgMjc4LCA1NTYsIDcyMiwgNjExLCA4MzMsIDcyMiwgNzc4LCA2NjcsIDc3OCwgNzIyLCA2NjcsIDYxMSwgNzIyLCA2NjcsIDk0NCwgNjY3LCA2NjcsIDYxMSwgMzMzLCAyNzgsIDMzMywgNTg0LCA1NTYsIDMzMywgNTU2LCA2MTEsIDU1NiwgNjExLCA1NTYsIDMzMywgNjExLCA2MTEsIDI3OCwgMjc4LCA1NTYsIDI3OCwgODg5LCA2MTEsIDYxMSwgNjExLCA2MTEsIDM4OSwgNTU2LCAzMzMsIDYxMSwgNTU2LCA3NzgsIDU1NiwgNTU2LCA1MDAsIDM4OSwgMjgwLCAzODksIDU4NCwgMzMzLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI4MCwgNTU2LCAzMzMsIDczNywgMzcwLCA1NTYsIDU4NCwgNzM3LCA1NTIsIDQwMCwgNTQ5LCAzMzMsIDMzMywgMzMzLCA1NzYsIDU1NiwgMjc4LCAzMzMsIDMzMywgMzY1LCA1NTYsIDgzNCwgODM0LCA4MzQsIDYxMSwgNzIyLCA3MjIsIDcyMiwgNzIyLCA3MjIsIDcyMiwgMTAwMCwgNzIyLCA2NjcsIDY2NywgNjY3LCA2NjcsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNzIyLCA3MjIsIDc3OCwgNzc4LCA3NzgsIDc3OCwgNzc4LCA1ODQsIDc3OCwgNzIyLCA3MjIsIDcyMiwgNzIyLCA2NjcsIDY2NywgNjExLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA4ODksIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNTQ5LCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNTU2LCA2MTEsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNzE5LCA3MjIsIDYxMSwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDc4NSwgNTU2LCA1NTYsIDI3OCwgNzIyLCA1NTYsIDU1NiwgNjExLCAyNzgsIDYxMSwgMjc4LCA2MTEsIDM4NSwgNjExLCA0NzksIDYxMSwgMjc4LCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MDgsIDcyMywgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCAxMDAwLCA5NDQsIDcyMiwgMzg5LCA3MjIsIDM4OSwgNzIyLCAzODksIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2MTEsIDMzMywgNjExLCA0NzksIDYxMSwgMzMzLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA5NDQsIDc3OCwgNjY3LCA1NTYsIDY2NywgNjExLCA1MDAsIDYxMSwgNTAwLCA2MTEsIDUwMCwgMjc4LCA1NTYsIDcyMiwgNTU2LCAxMDAwLCA4ODksIDc3OCwgNjExLCA2NjcsIDU1NiwgNjExLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgNDY1LCA3MjIsIDMzMywgODUzLCA5MDYsIDQ3NCwgODI1LCA5MjcsIDgzOCwgMjc4LCA3MjIsIDcyMiwgNjAxLCA3MTksIDY2NywgNjExLCA3MjIsIDc3OCwgMjc4LCA3MjIsIDY2NywgODMzLCA3MjIsIDY0NCwgNzc4LCA3MjIsIDY2NywgNjAwLCA2MTEsIDY2NywgODIxLCA2NjcsIDgwOSwgODAyLCAyNzgsIDY2NywgNjE1LCA0NTEsIDYxMSwgMjc4LCA1ODIsIDYxNSwgNjEwLCA1NTYsIDYwNiwgNDc1LCA0NjAsIDYxMSwgNTQxLCAyNzgsIDU1OCwgNTU2LCA2MTIsIDU1NiwgNDQ1LCA2MTEsIDc2NiwgNjE5LCA1MjAsIDY4NCwgNDQ2LCA1ODIsIDcxNSwgNTc2LCA3NTMsIDg0NSwgMjc4LCA1ODIsIDYxMSwgNTgyLCA4NDUsIDY2NywgNjY5LCA4ODUsIDU2NywgNzExLCA2NjcsIDI3OCwgMjc2LCA1NTYsIDEwOTQsIDEwNjIsIDg3NSwgNjEwLCA3MjIsIDYyMiwgNzE5LCA3MjIsIDcxOSwgNzIyLCA1NjcsIDcxMiwgNjY3LCA5MDQsIDYyNiwgNzE5LCA3MTksIDYxMCwgNzAyLCA4MzMsIDcyMiwgNzc4LCA3MTksIDY2NywgNzIyLCA2MTEsIDYyMiwgODU0LCA2NjcsIDczMCwgNzAzLCAxMDA1LCAxMDE5LCA4NzAsIDk3OSwgNzE5LCA3MTEsIDEwMzEsIDcxOSwgNTU2LCA2MTgsIDYxNSwgNDE3LCA2MzUsIDU1NiwgNzA5LCA0OTcsIDYxNSwgNjE1LCA1MDAsIDYzNSwgNzQwLCA2MDQsIDYxMSwgNjA0LCA2MTEsIDU1NiwgNDkwLCA1NTYsIDg3NSwgNTU2LCA2MTUsIDU4MSwgODMzLCA4NDQsIDcyOSwgODU0LCA2MTUsIDU1MiwgODU0LCA1ODMsIDU1NiwgNTU2LCA2MTEsIDQxNywgNTUyLCA1NTYsIDI3OCwgMjgxLCAyNzgsIDk2OSwgOTA2LCA2MTEsIDUwMCwgNjE1LCA1NTYsIDYwNCwgNzc4LCA2MTEsIDQ4NywgNDQ3LCA5NDQsIDc3OCwgOTQ0LCA3NzgsIDk0NCwgNzc4LCA2NjcsIDU1NiwgMzMzLCAzMzMsIDU1NiwgMTAwMCwgMTAwMCwgNTUyLCAyNzgsIDI3OCwgMjc4LCAyNzgsIDUwMCwgNTAwLCA1MDAsIDU1NiwgNTU2LCAzNTAsIDEwMDAsIDEwMDAsIDI0MCwgNDc5LCAzMzMsIDMzMywgNjA0LCAzMzMsIDE2NywgMzk2LCA1NTYsIDU1NiwgMTA5NCwgNTU2LCA4ODUsIDQ4OSwgMTExNSwgMTAwMCwgNzY4LCA2MDAsIDgzNCwgODM0LCA4MzQsIDgzNCwgMTAwMCwgNTAwLCAxMDAwLCA1MDAsIDEwMDAsIDUwMCwgNTAwLCA0OTQsIDYxMiwgODIzLCA3MTMsIDU4NCwgNTQ5LCA3MTMsIDk3OSwgNzIyLCAyNzQsIDU0OSwgNTQ5LCA1ODMsIDU0OSwgNTQ5LCA2MDQsIDU4NCwgNjA0LCA2MDQsIDcwOCwgNjI1LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MjksIDYwNCwgNjA0LCAzNTQsIDM1NCwgMTAwMCwgOTkwLCA5OTAsIDk5MCwgOTkwLCA0OTQsIDYwNCwgNjA0LCA2MDQsIDYwNCwgMzU0LCAxMDIxLCAxMDUyLCA5MTcsIDc1MCwgNzUwLCA1MzEsIDY1NiwgNTk0LCA1MTAsIDUwMCwgNzUwLCA3NTAsIDYxMSwgNjExLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMjIyLCAyMjIsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHMgPSBMaWJlcmF0aW9uU2Fuc0JvbGRXaWR0aHM7CmNvbnN0IExpYmVyYXRpb25TYW5zQm9sZE1hcHBpbmcgPSBbLTEsIC0xLCAtMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCA1MiwgNTMsIDU0LCA1NSwgNTYsIDU3LCA1OCwgNTksIDYwLCA2MSwgNjIsIDYzLCA2NCwgNjUsIDY2LCA2NywgNjgsIDY5LCA3MCwgNzEsIDcyLCA3MywgNzQsIDc1LCA3NiwgNzcsIDc4LCA3OSwgODAsIDgxLCA4MiwgODMsIDg0LCA4NSwgODYsIDg3LCA4OCwgODksIDkwLCA5MSwgOTIsIDkzLCA5NCwgOTUsIDk2LCA5NywgOTgsIDk5LCAxMDAsIDEwMSwgMTAyLCAxMDMsIDEwNCwgMTA1LCAxMDYsIDEwNywgMTA4LCAxMDksIDExMCwgMTExLCAxMTIsIDExMywgMTE0LCAxMTUsIDExNiwgMTE3LCAxMTgsIDExOSwgMTIwLCAxMjEsIDEyMiwgMTIzLCAxMjQsIDEyNSwgMTI2LCAxNjEsIDE2MiwgMTYzLCAxNjQsIDE2NSwgMTY2LCAxNjcsIDE2OCwgMTY5LCAxNzAsIDE3MSwgMTcyLCAxNzQsIDE3NSwgMTc2LCAxNzcsIDE3OCwgMTc5LCAxODAsIDE4MSwgMTgyLCAxODMsIDE4NCwgMTg1LCAxODYsIDE4NywgMTg4LCAxODksIDE5MCwgMTkxLCAxOTIsIDE5MywgMTk0LCAxOTUsIDE5NiwgMTk3LCAxOTgsIDE5OSwgMjAwLCAyMDEsIDIwMiwgMjAzLCAyMDQsIDIwNSwgMjA2LCAyMDcsIDIwOCwgMjA5LCAyMTAsIDIxMSwgMjEyLCAyMTMsIDIxNCwgMjE1LCAyMTYsIDIxNywgMjE4LCAyMTksIDIyMCwgMjIxLCAyMjIsIDIyMywgMjI0LCAyMjUsIDIyNiwgMjI3LCAyMjgsIDIyOSwgMjMwLCAyMzEsIDIzMiwgMjMzLCAyMzQsIDIzNSwgMjM2LCAyMzcsIDIzOCwgMjM5LCAyNDAsIDI0MSwgMjQyLCAyNDMsIDI0NCwgMjQ1LCAyNDYsIDI0NywgMjQ4LCAyNDksIDI1MCwgMjUxLCAyNTIsIDI1MywgMjU0LCAyNTUsIDI1NiwgMjU3LCAyNTgsIDI1OSwgMjYwLCAyNjEsIDI2MiwgMjYzLCAyNjQsIDI2NSwgMjY2LCAyNjcsIDI2OCwgMjY5LCAyNzAsIDI3MSwgMjcyLCAyNzMsIDI3NCwgMjc1LCAyNzYsIDI3NywgMjc4LCAyNzksIDI4MCwgMjgxLCAyODIsIDI4MywgMjg0LCAyODUsIDI4NiwgMjg3LCAyODgsIDI4OSwgMjkwLCAyOTEsIDI5MiwgMjkzLCAyOTQsIDI5NSwgMjk2LCAyOTcsIDI5OCwgMjk5LCAzMDAsIDMwMSwgMzAyLCAzMDMsIDMwNCwgMzA1LCAzMDYsIDMwNywgMzA4LCAzMDksIDMxMCwgMzExLCAzMTIsIDMxMywgMzE0LCAzMTUsIDMxNiwgMzE3LCAzMTgsIDMxOSwgMzIwLCAzMjEsIDMyMiwgMzIzLCAzMjQsIDMyNSwgMzI2LCAzMjcsIDMyOCwgMzI5LCAzMzAsIDMzMSwgMzMyLCAzMzMsIDMzNCwgMzM1LCAzMzYsIDMzNywgMzM4LCAzMzksIDM0MCwgMzQxLCAzNDIsIDM0MywgMzQ0LCAzNDUsIDM0NiwgMzQ3LCAzNDgsIDM0OSwgMzUwLCAzNTEsIDM1MiwgMzUzLCAzNTQsIDM1NSwgMzU2LCAzNTcsIDM1OCwgMzU5LCAzNjAsIDM2MSwgMzYyLCAzNjMsIDM2NCwgMzY1LCAzNjYsIDM2NywgMzY4LCAzNjksIDM3MCwgMzcxLCAzNzIsIDM3MywgMzc0LCAzNzUsIDM3NiwgMzc3LCAzNzgsIDM3OSwgMzgwLCAzODEsIDM4MiwgMzgzLCA0MDIsIDUwNiwgNTA3LCA1MDgsIDUwOSwgNTEwLCA1MTEsIDUzNiwgNTM3LCA1MzgsIDUzOSwgNzEwLCA3MTEsIDcxMywgNzI4LCA3MjksIDczMCwgNzMxLCA3MzIsIDczMywgOTAwLCA5MDEsIDkwMiwgOTAzLCA5MDQsIDkwNSwgOTA2LCA5MDgsIDkxMCwgOTExLCA5MTIsIDkxMywgOTE0LCA5MTUsIDkxNiwgOTE3LCA5MTgsIDkxOSwgOTIwLCA5MjEsIDkyMiwgOTIzLCA5MjQsIDkyNSwgOTI2LCA5MjcsIDkyOCwgOTI5LCA5MzEsIDkzMiwgOTMzLCA5MzQsIDkzNSwgOTM2LCA5MzcsIDkzOCwgOTM5LCA5NDAsIDk0MSwgOTQyLCA5NDMsIDk0NCwgOTQ1LCA5NDYsIDk0NywgOTQ4LCA5NDksIDk1MCwgOTUxLCA5NTIsIDk1MywgOTU0LCA5NTUsIDk1NiwgOTU3LCA5NTgsIDk1OSwgOTYwLCA5NjEsIDk2MiwgOTYzLCA5NjQsIDk2NSwgOTY2LCA5NjcsIDk2OCwgOTY5LCA5NzAsIDk3MSwgOTcyLCA5NzMsIDk3NCwgMTAyNCwgMTAyNSwgMTAyNiwgMTAyNywgMTAyOCwgMTAyOSwgMTAzMCwgMTAzMSwgMTAzMiwgMTAzMywgMTAzNCwgMTAzNSwgMTAzNiwgMTAzNywgMTAzOCwgMTAzOSwgMTA0MCwgMTA0MSwgMTA0MiwgMTA0MywgMTA0NCwgMTA0NSwgMTA0NiwgMTA0NywgMTA0OCwgMTA0OSwgMTA1MCwgMTA1MSwgMTA1MiwgMTA1MywgMTA1NCwgMTA1NSwgMTA1NiwgMTA1NywgMTA1OCwgMTA1OSwgMTA2MCwgMTA2MSwgMTA2MiwgMTA2MywgMTA2NCwgMTA2NSwgMTA2NiwgMTA2NywgMTA2OCwgMTA2OSwgMTA3MCwgMTA3MSwgMTA3MiwgMTA3MywgMTA3NCwgMTA3NSwgMTA3NiwgMTA3NywgMTA3OCwgMTA3OSwgMTA4MCwgMTA4MSwgMTA4MiwgMTA4MywgMTA4NCwgMTA4NSwgMTA4NiwgMTA4NywgMTA4OCwgMTA4OSwgMTA5MCwgMTA5MSwgMTA5MiwgMTA5MywgMTA5NCwgMTA5NSwgMTA5NiwgMTA5NywgMTA5OCwgMTA5OSwgMTEwMCwgMTEwMSwgMTEwMiwgMTEwMywgMTEwNCwgMTEwNSwgMTEwNiwgMTEwNywgMTEwOCwgMTEwOSwgMTExMCwgMTExMSwgMTExMiwgMTExMywgMTExNCwgMTExNSwgMTExNiwgMTExNywgMTExOCwgMTExOSwgMTEzOCwgMTEzOSwgMTE2OCwgMTE2OSwgNzgwOCwgNzgwOSwgNzgxMCwgNzgxMSwgNzgxMiwgNzgxMywgNzkyMiwgNzkyMywgODIwOCwgODIwOSwgODIxMSwgODIxMiwgODIxMywgODIxNSwgODIxNiwgODIxNywgODIxOCwgODIxOSwgODIyMCwgODIyMSwgODIyMiwgODIyNCwgODIyNSwgODIyNiwgODIzMCwgODI0MCwgODI0MiwgODI0MywgODI0OSwgODI1MCwgODI1MiwgODI1NCwgODI2MCwgODMxOSwgODM1NSwgODM1NiwgODM1OSwgODM2NCwgODQ1MywgODQ2NywgODQ3MCwgODQ4MiwgODQ4NiwgODQ5NCwgODUzOSwgODU0MCwgODU0MSwgODU0MiwgODU5MiwgODU5MywgODU5NCwgODU5NSwgODU5NiwgODU5NywgODYxNiwgODcwNiwgODcxMCwgODcxOSwgODcyMSwgODcyMiwgODczMCwgODczNCwgODczNSwgODc0NSwgODc0NywgODc3NiwgODgwMCwgODgwMSwgODgwNCwgODgwNSwgODk2MiwgODk3NiwgODk5MiwgODk5MywgOTQ3MiwgOTQ3NCwgOTQ4NCwgOTQ4OCwgOTQ5MiwgOTQ5NiwgOTUwMCwgOTUwOCwgOTUxNiwgOTUyNCwgOTUzMiwgOTU1MiwgOTU1MywgOTU1NCwgOTU1NSwgOTU1NiwgOTU1NywgOTU1OCwgOTU1OSwgOTU2MCwgOTU2MSwgOTU2MiwgOTU2MywgOTU2NCwgOTU2NSwgOTU2NiwgOTU2NywgOTU2OCwgOTU2OSwgOTU3MCwgOTU3MSwgOTU3MiwgOTU3MywgOTU3NCwgOTU3NSwgOTU3NiwgOTU3NywgOTU3OCwgOTU3OSwgOTU4MCwgOTYwMCwgOTYwNCwgOTYwOCwgOTYxMiwgOTYxNiwgOTYxNywgOTYxOCwgOTYxOSwgOTYzMiwgOTYzMywgOTY0MiwgOTY0MywgOTY0NCwgOTY1MCwgOTY1OCwgOTY2MCwgOTY2OCwgOTY3NCwgOTY3NSwgOTY3OSwgOTY4OCwgOTY4OSwgOTcwMiwgOTc4NiwgOTc4NywgOTc4OCwgOTc5MiwgOTc5NCwgOTgyNCwgOTgyNywgOTgyOSwgOTgzMCwgOTgzNCwgOTgzNSwgOTgzNiwgNjE0NDEsIDYxNDQyLCA2MTQ0NSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0JvbGRNYXBwaW5nID0gTGliZXJhdGlvblNhbnNCb2xkTWFwcGluZzsKY29uc3QgTGliZXJhdGlvblNhbnNCb2xkSXRhbGljV2lkdGhzID0gWzM2NSwgMCwgMzMzLCAyNzgsIDMzMywgNDc0LCA1NTYsIDU1NiwgODg5LCA3MjIsIDIzOCwgMzMzLCAzMzMsIDM4OSwgNTg0LCAyNzgsIDMzMywgMjc4LCAyNzgsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMzMzLCAzMzMsIDU4NCwgNTg0LCA1ODQsIDYxMSwgOTc1LCA3MjIsIDcyMiwgNzIyLCA3MjIsIDY2NywgNjExLCA3NzgsIDcyMiwgMjc4LCA1NTYsIDcyMiwgNjExLCA4MzMsIDcyMiwgNzc4LCA2NjcsIDc3OCwgNzIyLCA2NjcsIDYxMSwgNzIyLCA2NjcsIDk0NCwgNjY3LCA2NjcsIDYxMSwgMzMzLCAyNzgsIDMzMywgNTg0LCA1NTYsIDMzMywgNTU2LCA2MTEsIDU1NiwgNjExLCA1NTYsIDMzMywgNjExLCA2MTEsIDI3OCwgMjc4LCA1NTYsIDI3OCwgODg5LCA2MTEsIDYxMSwgNjExLCA2MTEsIDM4OSwgNTU2LCAzMzMsIDYxMSwgNTU2LCA3NzgsIDU1NiwgNTU2LCA1MDAsIDM4OSwgMjgwLCAzODksIDU4NCwgMzMzLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI4MCwgNTU2LCAzMzMsIDczNywgMzcwLCA1NTYsIDU4NCwgNzM3LCA1NTIsIDQwMCwgNTQ5LCAzMzMsIDMzMywgMzMzLCA1NzYsIDU1NiwgMjc4LCAzMzMsIDMzMywgMzY1LCA1NTYsIDgzNCwgODM0LCA4MzQsIDYxMSwgNzIyLCA3MjIsIDcyMiwgNzIyLCA3MjIsIDcyMiwgMTAwMCwgNzIyLCA2NjcsIDY2NywgNjY3LCA2NjcsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNzIyLCA3MjIsIDc3OCwgNzc4LCA3NzgsIDc3OCwgNzc4LCA1ODQsIDc3OCwgNzIyLCA3MjIsIDcyMiwgNzIyLCA2NjcsIDY2NywgNjExLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA4ODksIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDYxMSwgNjExLCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNTQ5LCA2MTEsIDYxMSwgNjExLCA2MTEsIDYxMSwgNTU2LCA2MTEsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNzQwLCA3MjIsIDYxMSwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCA3NzgsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDc4MiwgNTU2LCA1NTYsIDI3OCwgNzIyLCA1NTYsIDU1NiwgNjExLCAyNzgsIDYxMSwgMjc4LCA2MTEsIDM5NiwgNjExLCA0NzksIDYxMSwgMjc4LCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MDgsIDcyMywgNjExLCA3NzgsIDYxMSwgNzc4LCA2MTEsIDc3OCwgNjExLCAxMDAwLCA5NDQsIDcyMiwgMzg5LCA3MjIsIDM4OSwgNzIyLCAzODksIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2MTEsIDMzMywgNjExLCA0NzksIDYxMSwgMzMzLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA3MjIsIDYxMSwgNzIyLCA2MTEsIDcyMiwgNjExLCA5NDQsIDc3OCwgNjY3LCA1NTYsIDY2NywgNjExLCA1MDAsIDYxMSwgNTAwLCA2MTEsIDUwMCwgMjc4LCA1NTYsIDcyMiwgNTU2LCAxMDAwLCA4ODksIDc3OCwgNjExLCA2NjcsIDU1NiwgNjExLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCA3MjIsIDMzMywgODU0LCA5MDYsIDQ3MywgODQ0LCA5MzAsIDg0NywgMjc4LCA3MjIsIDcyMiwgNjEwLCA2NzEsIDY2NywgNjExLCA3MjIsIDc3OCwgMjc4LCA3MjIsIDY2NywgODMzLCA3MjIsIDY1NywgNzc4LCA3MTgsIDY2NywgNTkwLCA2MTEsIDY2NywgODIyLCA2NjcsIDgyOSwgNzgxLCAyNzgsIDY2NywgNjIwLCA0NzksIDYxMSwgMjc4LCA1OTEsIDYyMCwgNjIxLCA1NTYsIDYxMCwgNDc5LCA0OTIsIDYxMSwgNTU4LCAyNzgsIDU2NiwgNTU2LCA2MDMsIDU1NiwgNDUwLCA2MTEsIDcxMiwgNjA1LCA1MzIsIDY2NCwgNDA5LCA1OTEsIDcwNCwgNTc4LCA3NzMsIDgzNCwgMjc4LCA1OTEsIDYxMSwgNTkxLCA4MzQsIDY2NywgNjY3LCA4ODYsIDYxNCwgNzE5LCA2NjcsIDI3OCwgMjc4LCA1NTYsIDEwOTQsIDEwNDIsIDg1NCwgNjIyLCA3MTksIDY3NywgNzE5LCA3MjIsIDcwOCwgNzIyLCA2MTQsIDcyMiwgNjY3LCA5MjcsIDY0MywgNzE5LCA3MTksIDYxNSwgNjg3LCA4MzMsIDcyMiwgNzc4LCA3MTksIDY2NywgNzIyLCA2MTEsIDY3NywgNzgxLCA2NjcsIDcyOSwgNzA4LCA5NzksIDk4OSwgODU0LCAxMDAwLCA3MDgsIDcxOSwgMTA0MiwgNzI5LCA1NTYsIDYxOSwgNjA0LCA1MzQsIDYxOCwgNTU2LCA3MzYsIDUxMCwgNjExLCA2MTEsIDUwNywgNjIyLCA3NDAsIDYwNCwgNjExLCA2MTEsIDYxMSwgNTU2LCA4ODksIDU1NiwgODg1LCA1NTYsIDY0NiwgNTgzLCA4ODksIDkzNSwgNzA3LCA4NTQsIDU5NCwgNTUyLCA4NjUsIDU4OSwgNTU2LCA1NTYsIDYxMSwgNDY5LCA1NjMsIDU1NiwgMjc4LCAyNzgsIDI3OCwgOTY5LCA5MDYsIDYxMSwgNTA3LCA2MTksIDU1NiwgNjExLCA3NzgsIDYxMSwgNTc1LCA0NjcsIDk0NCwgNzc4LCA5NDQsIDc3OCwgOTQ0LCA3NzgsIDY2NywgNTU2LCAzMzMsIDMzMywgNTU2LCAxMDAwLCAxMDAwLCA1NTIsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNTAwLCA1MDAsIDUwMCwgNTU2LCA1NTYsIDM1MCwgMTAwMCwgMTAwMCwgMjQwLCA0NzksIDMzMywgMzMzLCA2MDQsIDMzMywgMTY3LCAzOTYsIDU1NiwgNTU2LCAxMTA0LCA1NTYsIDg4NSwgNTE2LCAxMTQ2LCAxMDAwLCA3NjgsIDYwMCwgODM0LCA4MzQsIDgzNCwgODM0LCA5OTksIDUwMCwgMTAwMCwgNTAwLCAxMDAwLCA1MDAsIDUwMCwgNDk0LCA2MTIsIDgyMywgNzEzLCA1ODQsIDU0OSwgNzEzLCA5NzksIDcyMiwgMjc0LCA1NDksIDU0OSwgNTgzLCA1NDksIDU0OSwgNjA0LCA1ODQsIDYwNCwgNjA0LCA3MDgsIDYyNSwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzI5LCA2MDQsIDYwNCwgMzU0LCAzNTQsIDEwMDAsIDk5MCwgOTkwLCA5OTAsIDk5MCwgNDk0LCA2MDQsIDYwNCwgNjA0LCA2MDQsIDM1NCwgMTAyMSwgMTA1MiwgOTE3LCA3NTAsIDc1MCwgNTMxLCA2NTYsIDU5NCwgNTEwLCA1MDAsIDc1MCwgNzUwLCA2MTEsIDYxMSwgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDIyMiwgMjIyLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzM107CmV4cG9ydHMuTGliZXJhdGlvblNhbnNCb2xkSXRhbGljV2lkdGhzID0gTGliZXJhdGlvblNhbnNCb2xkSXRhbGljV2lkdGhzOwpjb25zdCBMaWJlcmF0aW9uU2Fuc0JvbGRJdGFsaWNNYXBwaW5nID0gWy0xLCAtMSwgLTEsIDMyLCAzMywgMzQsIDM1LCAzNiwgMzcsIDM4LCAzOSwgNDAsIDQxLCA0MiwgNDMsIDQ0LCA0NSwgNDYsIDQ3LCA0OCwgNDksIDUwLCA1MSwgNTIsIDUzLCA1NCwgNTUsIDU2LCA1NywgNTgsIDU5LCA2MCwgNjEsIDYyLCA2MywgNjQsIDY1LCA2NiwgNjcsIDY4LCA2OSwgNzAsIDcxLCA3MiwgNzMsIDc0LCA3NSwgNzYsIDc3LCA3OCwgNzksIDgwLCA4MSwgODIsIDgzLCA4NCwgODUsIDg2LCA4NywgODgsIDg5LCA5MCwgOTEsIDkyLCA5MywgOTQsIDk1LCA5NiwgOTcsIDk4LCA5OSwgMTAwLCAxMDEsIDEwMiwgMTAzLCAxMDQsIDEwNSwgMTA2LCAxMDcsIDEwOCwgMTA5LCAxMTAsIDExMSwgMTEyLCAxMTMsIDExNCwgMTE1LCAxMTYsIDExNywgMTE4LCAxMTksIDEyMCwgMTIxLCAxMjIsIDEyMywgMTI0LCAxMjUsIDEyNiwgMTYxLCAxNjIsIDE2MywgMTY0LCAxNjUsIDE2NiwgMTY3LCAxNjgsIDE2OSwgMTcwLCAxNzEsIDE3MiwgMTc0LCAxNzUsIDE3NiwgMTc3LCAxNzgsIDE3OSwgMTgwLCAxODEsIDE4MiwgMTgzLCAxODQsIDE4NSwgMTg2LCAxODcsIDE4OCwgMTg5LCAxOTAsIDE5MSwgMTkyLCAxOTMsIDE5NCwgMTk1LCAxOTYsIDE5NywgMTk4LCAxOTksIDIwMCwgMjAxLCAyMDIsIDIwMywgMjA0LCAyMDUsIDIwNiwgMjA3LCAyMDgsIDIwOSwgMjEwLCAyMTEsIDIxMiwgMjEzLCAyMTQsIDIxNSwgMjE2LCAyMTcsIDIxOCwgMjE5LCAyMjAsIDIyMSwgMjIyLCAyMjMsIDIyNCwgMjI1LCAyMjYsIDIyNywgMjI4LCAyMjksIDIzMCwgMjMxLCAyMzIsIDIzMywgMjM0LCAyMzUsIDIzNiwgMjM3LCAyMzgsIDIzOSwgMjQwLCAyNDEsIDI0MiwgMjQzLCAyNDQsIDI0NSwgMjQ2LCAyNDcsIDI0OCwgMjQ5LCAyNTAsIDI1MSwgMjUyLCAyNTMsIDI1NCwgMjU1LCAyNTYsIDI1NywgMjU4LCAyNTksIDI2MCwgMjYxLCAyNjIsIDI2MywgMjY0LCAyNjUsIDI2NiwgMjY3LCAyNjgsIDI2OSwgMjcwLCAyNzEsIDI3MiwgMjczLCAyNzQsIDI3NSwgMjc2LCAyNzcsIDI3OCwgMjc5LCAyODAsIDI4MSwgMjgyLCAyODMsIDI4NCwgMjg1LCAyODYsIDI4NywgMjg4LCAyODksIDI5MCwgMjkxLCAyOTIsIDI5MywgMjk0LCAyOTUsIDI5NiwgMjk3LCAyOTgsIDI5OSwgMzAwLCAzMDEsIDMwMiwgMzAzLCAzMDQsIDMwNSwgMzA2LCAzMDcsIDMwOCwgMzA5LCAzMTAsIDMxMSwgMzEyLCAzMTMsIDMxNCwgMzE1LCAzMTYsIDMxNywgMzE4LCAzMTksIDMyMCwgMzIxLCAzMjIsIDMyMywgMzI0LCAzMjUsIDMyNiwgMzI3LCAzMjgsIDMyOSwgMzMwLCAzMzEsIDMzMiwgMzMzLCAzMzQsIDMzNSwgMzM2LCAzMzcsIDMzOCwgMzM5LCAzNDAsIDM0MSwgMzQyLCAzNDMsIDM0NCwgMzQ1LCAzNDYsIDM0NywgMzQ4LCAzNDksIDM1MCwgMzUxLCAzNTIsIDM1MywgMzU0LCAzNTUsIDM1NiwgMzU3LCAzNTgsIDM1OSwgMzYwLCAzNjEsIDM2MiwgMzYzLCAzNjQsIDM2NSwgMzY2LCAzNjcsIDM2OCwgMzY5LCAzNzAsIDM3MSwgMzcyLCAzNzMsIDM3NCwgMzc1LCAzNzYsIDM3NywgMzc4LCAzNzksIDM4MCwgMzgxLCAzODIsIDM4MywgNDAyLCA1MDYsIDUwNywgNTA4LCA1MDksIDUxMCwgNTExLCA1MzYsIDUzNywgNTM4LCA1MzksIDcxMCwgNzExLCA3MTMsIDcyOCwgNzI5LCA3MzAsIDczMSwgNzMyLCA3MzMsIDkwMCwgOTAxLCA5MDIsIDkwMywgOTA0LCA5MDUsIDkwNiwgOTA4LCA5MTAsIDkxMSwgOTEyLCA5MTMsIDkxNCwgOTE1LCA5MTYsIDkxNywgOTE4LCA5MTksIDkyMCwgOTIxLCA5MjIsIDkyMywgOTI0LCA5MjUsIDkyNiwgOTI3LCA5MjgsIDkyOSwgOTMxLCA5MzIsIDkzMywgOTM0LCA5MzUsIDkzNiwgOTM3LCA5MzgsIDkzOSwgOTQwLCA5NDEsIDk0MiwgOTQzLCA5NDQsIDk0NSwgOTQ2LCA5NDcsIDk0OCwgOTQ5LCA5NTAsIDk1MSwgOTUyLCA5NTMsIDk1NCwgOTU1LCA5NTYsIDk1NywgOTU4LCA5NTksIDk2MCwgOTYxLCA5NjIsIDk2MywgOTY0LCA5NjUsIDk2NiwgOTY3LCA5NjgsIDk2OSwgOTcwLCA5NzEsIDk3MiwgOTczLCA5NzQsIDEwMjQsIDEwMjUsIDEwMjYsIDEwMjcsIDEwMjgsIDEwMjksIDEwMzAsIDEwMzEsIDEwMzIsIDEwMzMsIDEwMzQsIDEwMzUsIDEwMzYsIDEwMzcsIDEwMzgsIDEwMzksIDEwNDAsIDEwNDEsIDEwNDIsIDEwNDMsIDEwNDQsIDEwNDUsIDEwNDYsIDEwNDcsIDEwNDgsIDEwNDksIDEwNTAsIDEwNTEsIDEwNTIsIDEwNTMsIDEwNTQsIDEwNTUsIDEwNTYsIDEwNTcsIDEwNTgsIDEwNTksIDEwNjAsIDEwNjEsIDEwNjIsIDEwNjMsIDEwNjQsIDEwNjUsIDEwNjYsIDEwNjcsIDEwNjgsIDEwNjksIDEwNzAsIDEwNzEsIDEwNzIsIDEwNzMsIDEwNzQsIDEwNzUsIDEwNzYsIDEwNzcsIDEwNzgsIDEwNzksIDEwODAsIDEwODEsIDEwODIsIDEwODMsIDEwODQsIDEwODUsIDEwODYsIDEwODcsIDEwODgsIDEwODksIDEwOTAsIDEwOTEsIDEwOTIsIDEwOTMsIDEwOTQsIDEwOTUsIDEwOTYsIDEwOTcsIDEwOTgsIDEwOTksIDExMDAsIDExMDEsIDExMDIsIDExMDMsIDExMDQsIDExMDUsIDExMDYsIDExMDcsIDExMDgsIDExMDksIDExMTAsIDExMTEsIDExMTIsIDExMTMsIDExMTQsIDExMTUsIDExMTYsIDExMTcsIDExMTgsIDExMTksIDExMzgsIDExMzksIDExNjgsIDExNjksIDc4MDgsIDc4MDksIDc4MTAsIDc4MTEsIDc4MTIsIDc4MTMsIDc5MjIsIDc5MjMsIDgyMDgsIDgyMDksIDgyMTEsIDgyMTIsIDgyMTMsIDgyMTUsIDgyMTYsIDgyMTcsIDgyMTgsIDgyMTksIDgyMjAsIDgyMjEsIDgyMjIsIDgyMjQsIDgyMjUsIDgyMjYsIDgyMzAsIDgyNDAsIDgyNDIsIDgyNDMsIDgyNDksIDgyNTAsIDgyNTIsIDgyNTQsIDgyNjAsIDgzMTksIDgzNTUsIDgzNTYsIDgzNTksIDgzNjQsIDg0NTMsIDg0NjcsIDg0NzAsIDg0ODIsIDg0ODYsIDg0OTQsIDg1MzksIDg1NDAsIDg1NDEsIDg1NDIsIDg1OTIsIDg1OTMsIDg1OTQsIDg1OTUsIDg1OTYsIDg1OTcsIDg2MTYsIDg3MDYsIDg3MTAsIDg3MTksIDg3MjEsIDg3MjIsIDg3MzAsIDg3MzQsIDg3MzUsIDg3NDUsIDg3NDcsIDg3NzYsIDg4MDAsIDg4MDEsIDg4MDQsIDg4MDUsIDg5NjIsIDg5NzYsIDg5OTIsIDg5OTMsIDk0NzIsIDk0NzQsIDk0ODQsIDk0ODgsIDk0OTIsIDk0OTYsIDk1MDAsIDk1MDgsIDk1MTYsIDk1MjQsIDk1MzIsIDk1NTIsIDk1NTMsIDk1NTQsIDk1NTUsIDk1NTYsIDk1NTcsIDk1NTgsIDk1NTksIDk1NjAsIDk1NjEsIDk1NjIsIDk1NjMsIDk1NjQsIDk1NjUsIDk1NjYsIDk1NjcsIDk1NjgsIDk1NjksIDk1NzAsIDk1NzEsIDk1NzIsIDk1NzMsIDk1NzQsIDk1NzUsIDk1NzYsIDk1NzcsIDk1NzgsIDk1NzksIDk1ODAsIDk2MDAsIDk2MDQsIDk2MDgsIDk2MTIsIDk2MTYsIDk2MTcsIDk2MTgsIDk2MTksIDk2MzIsIDk2MzMsIDk2NDIsIDk2NDMsIDk2NDQsIDk2NTAsIDk2NTgsIDk2NjAsIDk2NjgsIDk2NzQsIDk2NzUsIDk2NzksIDk2ODgsIDk2ODksIDk3MDIsIDk3ODYsIDk3ODcsIDk3ODgsIDk3OTIsIDk3OTQsIDk4MjQsIDk4MjcsIDk4MjksIDk4MzAsIDk4MzQsIDk4MzUsIDk4MzYsIDYxNDQxLCA2MTQ0MiwgNjE0NDUsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMV07CmV4cG9ydHMuTGliZXJhdGlvblNhbnNCb2xkSXRhbGljTWFwcGluZyA9IExpYmVyYXRpb25TYW5zQm9sZEl0YWxpY01hcHBpbmc7CmNvbnN0IExpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzID0gWzM2NSwgMCwgMzMzLCAyNzgsIDI3OCwgMzU1LCA1NTYsIDU1NiwgODg5LCA2NjcsIDE5MSwgMzMzLCAzMzMsIDM4OSwgNTg0LCAyNzgsIDMzMywgMjc4LCAyNzgsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjc4LCAyNzgsIDU4NCwgNTg0LCA1ODQsIDU1NiwgMTAxNSwgNjY3LCA2NjcsIDcyMiwgNzIyLCA2NjcsIDYxMSwgNzc4LCA3MjIsIDI3OCwgNTAwLCA2NjcsIDU1NiwgODMzLCA3MjIsIDc3OCwgNjY3LCA3NzgsIDcyMiwgNjY3LCA2MTEsIDcyMiwgNjY3LCA5NDQsIDY2NywgNjY3LCA2MTEsIDI3OCwgMjc4LCAyNzgsIDQ2OSwgNTU2LCAzMzMsIDU1NiwgNTU2LCA1MDAsIDU1NiwgNTU2LCAyNzgsIDU1NiwgNTU2LCAyMjIsIDIyMiwgNTAwLCAyMjIsIDgzMywgNTU2LCA1NTYsIDU1NiwgNTU2LCAzMzMsIDUwMCwgMjc4LCA1NTYsIDUwMCwgNzIyLCA1MDAsIDUwMCwgNTAwLCAzMzQsIDI2MCwgMzM0LCA1ODQsIDMzMywgNTU2LCA1NTYsIDU1NiwgNTU2LCAyNjAsIDU1NiwgMzMzLCA3MzcsIDM3MCwgNTU2LCA1ODQsIDczNywgNTUyLCA0MDAsIDU0OSwgMzMzLCAzMzMsIDMzMywgNTc2LCA1MzcsIDI3OCwgMzMzLCAzMzMsIDM2NSwgNTU2LCA4MzQsIDgzNCwgODM0LCA2MTEsIDY2NywgNjY3LCA2NjcsIDY2NywgNjY3LCA2NjcsIDEwMDAsIDcyMiwgNjY3LCA2NjcsIDY2NywgNjY3LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDcyMiwgNzIyLCA3NzgsIDc3OCwgNzc4LCA3NzgsIDc3OCwgNTg0LCA3NzgsIDcyMiwgNzIyLCA3MjIsIDcyMiwgNjY3LCA2NjcsIDYxMSwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgODg5LCA1MDAsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjc4LCAyNzgsIDI3OCwgMjc4LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU0OSwgNjExLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDUwMCwgNTU2LCA1MDAsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDcyMiwgNTAwLCA3MjIsIDUwMCwgNzIyLCA1MDAsIDcyMiwgNTAwLCA3MjIsIDYyNSwgNzIyLCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyMjIsIDI3OCwgMjc4LCA3MzMsIDQ0NCwgNTAwLCAyMjIsIDY2NywgNTAwLCA1MDAsIDU1NiwgMjIyLCA1NTYsIDIyMiwgNTU2LCAyODEsIDU1NiwgNDAwLCA1NTYsIDIyMiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNjE1LCA3MjMsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgMTAwMCwgOTQ0LCA3MjIsIDMzMywgNzIyLCAzMzMsIDcyMiwgMzMzLCA2NjcsIDUwMCwgNjY3LCA1MDAsIDY2NywgNTAwLCA2NjcsIDUwMCwgNjExLCAyNzgsIDYxMSwgMzU0LCA2MTEsIDI3OCwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgOTQ0LCA3MjIsIDY2NywgNTAwLCA2NjcsIDYxMSwgNTAwLCA2MTEsIDUwMCwgNjExLCA1MDAsIDIyMiwgNTU2LCA2NjcsIDU1NiwgMTAwMCwgODg5LCA3NzgsIDYxMSwgNjY3LCA1MDAsIDYxMSwgMjc4LCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgNjY3LCAyNzgsIDc4OSwgODQ2LCAzODksIDc5NCwgODY1LCA3NzUsIDIyMiwgNjY3LCA2NjcsIDU3MCwgNjcxLCA2NjcsIDYxMSwgNzIyLCA3NzgsIDI3OCwgNjY3LCA2NjcsIDgzMywgNzIyLCA2NDgsIDc3OCwgNzI1LCA2NjcsIDYwMCwgNjExLCA2NjcsIDgzNywgNjY3LCA4MzEsIDc2MSwgMjc4LCA2NjcsIDU3MCwgNDM5LCA1NTUsIDIyMiwgNTUwLCA1NzAsIDU3MSwgNTAwLCA1NTYsIDQzOSwgNDYzLCA1NTUsIDU0MiwgMjIyLCA1MDAsIDQ5MiwgNTQ4LCA1MDAsIDQ0NywgNTU2LCA2NzAsIDU3MywgNDg2LCA2MDMsIDM3NCwgNTUwLCA2NTIsIDU0NiwgNzI4LCA3NzksIDIyMiwgNTUwLCA1NTYsIDU1MCwgNzc5LCA2NjcsIDY2NywgODQzLCA1NDQsIDcwOCwgNjY3LCAyNzgsIDI3OCwgNTAwLCAxMDY2LCA5ODIsIDg0NCwgNTg5LCA3MTUsIDYzOSwgNzI0LCA2NjcsIDY1MSwgNjY3LCA1NDQsIDcwNCwgNjY3LCA5MTcsIDYxNCwgNzE1LCA3MTUsIDU4OSwgNjg2LCA4MzMsIDcyMiwgNzc4LCA3MjUsIDY2NywgNzIyLCA2MTEsIDYzOSwgNzk1LCA2NjcsIDcyNywgNjczLCA5MjAsIDkyMywgODA1LCA4ODYsIDY1MSwgNjk0LCAxMDIyLCA2ODIsIDU1NiwgNTYyLCA1MjIsIDQ5MywgNTUzLCA1NTYsIDY4OCwgNDY1LCA1NTYsIDU1NiwgNDcyLCA1NjQsIDY4NiwgNTUwLCA1NTYsIDU1NiwgNTU2LCA1MDAsIDgzMywgNTAwLCA4MzUsIDUwMCwgNTcyLCA1MTgsIDgzMCwgODUxLCA2MjEsIDczNiwgNTI2LCA0OTIsIDc1MiwgNTM0LCA1NTYsIDU1NiwgNTU2LCAzNzgsIDQ5NiwgNTAwLCAyMjIsIDIyMiwgMjIyLCA5MTAsIDgyOCwgNTU2LCA0NzIsIDU2NSwgNTAwLCA1NTYsIDc3OCwgNTU2LCA0OTIsIDMzOSwgOTQ0LCA3MjIsIDk0NCwgNzIyLCA5NDQsIDcyMiwgNjY3LCA1MDAsIDMzMywgMzMzLCA1NTYsIDEwMDAsIDEwMDAsIDU1MiwgMjIyLCAyMjIsIDIyMiwgMjIyLCAzMzMsIDMzMywgMzMzLCA1NTYsIDU1NiwgMzUwLCAxMDAwLCAxMDAwLCAxODgsIDM1NCwgMzMzLCAzMzMsIDUwMCwgMzMzLCAxNjcsIDM2NSwgNTU2LCA1NTYsIDEwOTQsIDU1NiwgODg1LCAzMjMsIDEwODMsIDEwMDAsIDc2OCwgNjAwLCA4MzQsIDgzNCwgODM0LCA4MzQsIDEwMDAsIDUwMCwgOTk4LCA1MDAsIDEwMDAsIDUwMCwgNTAwLCA0OTQsIDYxMiwgODIzLCA3MTMsIDU4NCwgNTQ5LCA3MTMsIDk3OSwgNzE5LCAyNzQsIDU0OSwgNTQ5LCA1ODQsIDU0OSwgNTQ5LCA2MDQsIDU4NCwgNjA0LCA2MDQsIDcwOCwgNjI1LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MjksIDYwNCwgNjA0LCAzNTQsIDM1NCwgMTAwMCwgOTkwLCA5OTAsIDk5MCwgOTkwLCA0OTQsIDYwNCwgNjA0LCA2MDQsIDYwNCwgMzU0LCAxMDIxLCAxMDUyLCA5MTcsIDc1MCwgNzUwLCA1MzEsIDY1NiwgNTk0LCA1MTAsIDUwMCwgNzUwLCA3NTAsIDUwMCwgNTAwLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMjIyLCAyMjIsIDI5NCwgMjk0LCAzMjQsIDMyNCwgMzE2LCAzMjgsIDM5OCwgMjg1XTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0l0YWxpY1dpZHRocyA9IExpYmVyYXRpb25TYW5zSXRhbGljV2lkdGhzOwpjb25zdCBMaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcgPSBbLTEsIC0xLCAtMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCA1MiwgNTMsIDU0LCA1NSwgNTYsIDU3LCA1OCwgNTksIDYwLCA2MSwgNjIsIDYzLCA2NCwgNjUsIDY2LCA2NywgNjgsIDY5LCA3MCwgNzEsIDcyLCA3MywgNzQsIDc1LCA3NiwgNzcsIDc4LCA3OSwgODAsIDgxLCA4MiwgODMsIDg0LCA4NSwgODYsIDg3LCA4OCwgODksIDkwLCA5MSwgOTIsIDkzLCA5NCwgOTUsIDk2LCA5NywgOTgsIDk5LCAxMDAsIDEwMSwgMTAyLCAxMDMsIDEwNCwgMTA1LCAxMDYsIDEwNywgMTA4LCAxMDksIDExMCwgMTExLCAxMTIsIDExMywgMTE0LCAxMTUsIDExNiwgMTE3LCAxMTgsIDExOSwgMTIwLCAxMjEsIDEyMiwgMTIzLCAxMjQsIDEyNSwgMTI2LCAxNjEsIDE2MiwgMTYzLCAxNjQsIDE2NSwgMTY2LCAxNjcsIDE2OCwgMTY5LCAxNzAsIDE3MSwgMTcyLCAxNzQsIDE3NSwgMTc2LCAxNzcsIDE3OCwgMTc5LCAxODAsIDE4MSwgMTgyLCAxODMsIDE4NCwgMTg1LCAxODYsIDE4NywgMTg4LCAxODksIDE5MCwgMTkxLCAxOTIsIDE5MywgMTk0LCAxOTUsIDE5NiwgMTk3LCAxOTgsIDE5OSwgMjAwLCAyMDEsIDIwMiwgMjAzLCAyMDQsIDIwNSwgMjA2LCAyMDcsIDIwOCwgMjA5LCAyMTAsIDIxMSwgMjEyLCAyMTMsIDIxNCwgMjE1LCAyMTYsIDIxNywgMjE4LCAyMTksIDIyMCwgMjIxLCAyMjIsIDIyMywgMjI0LCAyMjUsIDIyNiwgMjI3LCAyMjgsIDIyOSwgMjMwLCAyMzEsIDIzMiwgMjMzLCAyMzQsIDIzNSwgMjM2LCAyMzcsIDIzOCwgMjM5LCAyNDAsIDI0MSwgMjQyLCAyNDMsIDI0NCwgMjQ1LCAyNDYsIDI0NywgMjQ4LCAyNDksIDI1MCwgMjUxLCAyNTIsIDI1MywgMjU0LCAyNTUsIDI1NiwgMjU3LCAyNTgsIDI1OSwgMjYwLCAyNjEsIDI2MiwgMjYzLCAyNjQsIDI2NSwgMjY2LCAyNjcsIDI2OCwgMjY5LCAyNzAsIDI3MSwgMjcyLCAyNzMsIDI3NCwgMjc1LCAyNzYsIDI3NywgMjc4LCAyNzksIDI4MCwgMjgxLCAyODIsIDI4MywgMjg0LCAyODUsIDI4NiwgMjg3LCAyODgsIDI4OSwgMjkwLCAyOTEsIDI5MiwgMjkzLCAyOTQsIDI5NSwgMjk2LCAyOTcsIDI5OCwgMjk5LCAzMDAsIDMwMSwgMzAyLCAzMDMsIDMwNCwgMzA1LCAzMDYsIDMwNywgMzA4LCAzMDksIDMxMCwgMzExLCAzMTIsIDMxMywgMzE0LCAzMTUsIDMxNiwgMzE3LCAzMTgsIDMxOSwgMzIwLCAzMjEsIDMyMiwgMzIzLCAzMjQsIDMyNSwgMzI2LCAzMjcsIDMyOCwgMzI5LCAzMzAsIDMzMSwgMzMyLCAzMzMsIDMzNCwgMzM1LCAzMzYsIDMzNywgMzM4LCAzMzksIDM0MCwgMzQxLCAzNDIsIDM0MywgMzQ0LCAzNDUsIDM0NiwgMzQ3LCAzNDgsIDM0OSwgMzUwLCAzNTEsIDM1MiwgMzUzLCAzNTQsIDM1NSwgMzU2LCAzNTcsIDM1OCwgMzU5LCAzNjAsIDM2MSwgMzYyLCAzNjMsIDM2NCwgMzY1LCAzNjYsIDM2NywgMzY4LCAzNjksIDM3MCwgMzcxLCAzNzIsIDM3MywgMzc0LCAzNzUsIDM3NiwgMzc3LCAzNzgsIDM3OSwgMzgwLCAzODEsIDM4MiwgMzgzLCA0MDIsIDUwNiwgNTA3LCA1MDgsIDUwOSwgNTEwLCA1MTEsIDUzNiwgNTM3LCA1MzgsIDUzOSwgNzEwLCA3MTEsIDcxMywgNzI4LCA3MjksIDczMCwgNzMxLCA3MzIsIDczMywgOTAwLCA5MDEsIDkwMiwgOTAzLCA5MDQsIDkwNSwgOTA2LCA5MDgsIDkxMCwgOTExLCA5MTIsIDkxMywgOTE0LCA5MTUsIDkxNiwgOTE3LCA5MTgsIDkxOSwgOTIwLCA5MjEsIDkyMiwgOTIzLCA5MjQsIDkyNSwgOTI2LCA5MjcsIDkyOCwgOTI5LCA5MzEsIDkzMiwgOTMzLCA5MzQsIDkzNSwgOTM2LCA5MzcsIDkzOCwgOTM5LCA5NDAsIDk0MSwgOTQyLCA5NDMsIDk0NCwgOTQ1LCA5NDYsIDk0NywgOTQ4LCA5NDksIDk1MCwgOTUxLCA5NTIsIDk1MywgOTU0LCA5NTUsIDk1NiwgOTU3LCA5NTgsIDk1OSwgOTYwLCA5NjEsIDk2MiwgOTYzLCA5NjQsIDk2NSwgOTY2LCA5NjcsIDk2OCwgOTY5LCA5NzAsIDk3MSwgOTcyLCA5NzMsIDk3NCwgMTAyNCwgMTAyNSwgMTAyNiwgMTAyNywgMTAyOCwgMTAyOSwgMTAzMCwgMTAzMSwgMTAzMiwgMTAzMywgMTAzNCwgMTAzNSwgMTAzNiwgMTAzNywgMTAzOCwgMTAzOSwgMTA0MCwgMTA0MSwgMTA0MiwgMTA0MywgMTA0NCwgMTA0NSwgMTA0NiwgMTA0NywgMTA0OCwgMTA0OSwgMTA1MCwgMTA1MSwgMTA1MiwgMTA1MywgMTA1NCwgMTA1NSwgMTA1NiwgMTA1NywgMTA1OCwgMTA1OSwgMTA2MCwgMTA2MSwgMTA2MiwgMTA2MywgMTA2NCwgMTA2NSwgMTA2NiwgMTA2NywgMTA2OCwgMTA2OSwgMTA3MCwgMTA3MSwgMTA3MiwgMTA3MywgMTA3NCwgMTA3NSwgMTA3NiwgMTA3NywgMTA3OCwgMTA3OSwgMTA4MCwgMTA4MSwgMTA4MiwgMTA4MywgMTA4NCwgMTA4NSwgMTA4NiwgMTA4NywgMTA4OCwgMTA4OSwgMTA5MCwgMTA5MSwgMTA5MiwgMTA5MywgMTA5NCwgMTA5NSwgMTA5NiwgMTA5NywgMTA5OCwgMTA5OSwgMTEwMCwgMTEwMSwgMTEwMiwgMTEwMywgMTEwNCwgMTEwNSwgMTEwNiwgMTEwNywgMTEwOCwgMTEwOSwgMTExMCwgMTExMSwgMTExMiwgMTExMywgMTExNCwgMTExNSwgMTExNiwgMTExNywgMTExOCwgMTExOSwgMTEzOCwgMTEzOSwgMTE2OCwgMTE2OSwgNzgwOCwgNzgwOSwgNzgxMCwgNzgxMSwgNzgxMiwgNzgxMywgNzkyMiwgNzkyMywgODIwOCwgODIwOSwgODIxMSwgODIxMiwgODIxMywgODIxNSwgODIxNiwgODIxNywgODIxOCwgODIxOSwgODIyMCwgODIyMSwgODIyMiwgODIyNCwgODIyNSwgODIyNiwgODIzMCwgODI0MCwgODI0MiwgODI0MywgODI0OSwgODI1MCwgODI1MiwgODI1NCwgODI2MCwgODMxOSwgODM1NSwgODM1NiwgODM1OSwgODM2NCwgODQ1MywgODQ2NywgODQ3MCwgODQ4MiwgODQ4NiwgODQ5NCwgODUzOSwgODU0MCwgODU0MSwgODU0MiwgODU5MiwgODU5MywgODU5NCwgODU5NSwgODU5NiwgODU5NywgODYxNiwgODcwNiwgODcxMCwgODcxOSwgODcyMSwgODcyMiwgODczMCwgODczNCwgODczNSwgODc0NSwgODc0NywgODc3NiwgODgwMCwgODgwMSwgODgwNCwgODgwNSwgODk2MiwgODk3NiwgODk5MiwgODk5MywgOTQ3MiwgOTQ3NCwgOTQ4NCwgOTQ4OCwgOTQ5MiwgOTQ5NiwgOTUwMCwgOTUwOCwgOTUxNiwgOTUyNCwgOTUzMiwgOTU1MiwgOTU1MywgOTU1NCwgOTU1NSwgOTU1NiwgOTU1NywgOTU1OCwgOTU1OSwgOTU2MCwgOTU2MSwgOTU2MiwgOTU2MywgOTU2NCwgOTU2NSwgOTU2NiwgOTU2NywgOTU2OCwgOTU2OSwgOTU3MCwgOTU3MSwgOTU3MiwgOTU3MywgOTU3NCwgOTU3NSwgOTU3NiwgOTU3NywgOTU3OCwgOTU3OSwgOTU4MCwgOTYwMCwgOTYwNCwgOTYwOCwgOTYxMiwgOTYxNiwgOTYxNywgOTYxOCwgOTYxOSwgOTYzMiwgOTYzMywgOTY0MiwgOTY0MywgOTY0NCwgOTY1MCwgOTY1OCwgOTY2MCwgOTY2OCwgOTY3NCwgOTY3NSwgOTY3OSwgOTY4OCwgOTY4OSwgOTcwMiwgOTc4NiwgOTc4NywgOTc4OCwgOTc5MiwgOTc5NCwgOTgyNCwgOTgyNywgOTgyOSwgOTgzMCwgOTgzNCwgOTgzNSwgOTgzNiwgNjE0NDEsIDYxNDQyLCA2MTQ0NSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmcgPSBMaWJlcmF0aW9uU2Fuc0l0YWxpY01hcHBpbmc7CmNvbnN0IExpYmVyYXRpb25TYW5zUmVndWxhcldpZHRocyA9IFszNjUsIDAsIDMzMywgMjc4LCAyNzgsIDM1NSwgNTU2LCA1NTYsIDg4OSwgNjY3LCAxOTEsIDMzMywgMzMzLCAzODksIDU4NCwgMjc4LCAzMzMsIDI3OCwgMjc4LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI3OCwgMjc4LCA1ODQsIDU4NCwgNTg0LCA1NTYsIDEwMTUsIDY2NywgNjY3LCA3MjIsIDcyMiwgNjY3LCA2MTEsIDc3OCwgNzIyLCAyNzgsIDUwMCwgNjY3LCA1NTYsIDgzMywgNzIyLCA3NzgsIDY2NywgNzc4LCA3MjIsIDY2NywgNjExLCA3MjIsIDY2NywgOTQ0LCA2NjcsIDY2NywgNjExLCAyNzgsIDI3OCwgMjc4LCA0NjksIDU1NiwgMzMzLCA1NTYsIDU1NiwgNTAwLCA1NTYsIDU1NiwgMjc4LCA1NTYsIDU1NiwgMjIyLCAyMjIsIDUwMCwgMjIyLCA4MzMsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMzMzLCA1MDAsIDI3OCwgNTU2LCA1MDAsIDcyMiwgNTAwLCA1MDAsIDUwMCwgMzM0LCAyNjAsIDMzNCwgNTg0LCAzMzMsIDU1NiwgNTU2LCA1NTYsIDU1NiwgMjYwLCA1NTYsIDMzMywgNzM3LCAzNzAsIDU1NiwgNTg0LCA3MzcsIDU1MiwgNDAwLCA1NDksIDMzMywgMzMzLCAzMzMsIDU3NiwgNTM3LCAyNzgsIDMzMywgMzMzLCAzNjUsIDU1NiwgODM0LCA4MzQsIDgzNCwgNjExLCA2NjcsIDY2NywgNjY3LCA2NjcsIDY2NywgNjY3LCAxMDAwLCA3MjIsIDY2NywgNjY3LCA2NjcsIDY2NywgMjc4LCAyNzgsIDI3OCwgMjc4LCA3MjIsIDcyMiwgNzc4LCA3NzgsIDc3OCwgNzc4LCA3NzgsIDU4NCwgNzc4LCA3MjIsIDcyMiwgNzIyLCA3MjIsIDY2NywgNjY3LCA2MTEsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDg4OSwgNTAwLCA1NTYsIDU1NiwgNTU2LCA1NTYsIDI3OCwgMjc4LCAyNzgsIDI3OCwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1NDksIDYxMSwgNTU2LCA1NTYsIDU1NiwgNTU2LCA1MDAsIDU1NiwgNTAwLCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA3MjIsIDUwMCwgNzIyLCA1MDAsIDcyMiwgNTAwLCA3MjIsIDUwMCwgNzIyLCA2MTUsIDcyMiwgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDY2NywgNTU2LCA2NjcsIDU1NiwgNjY3LCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDc3OCwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjc4LCAyNzgsIDI3OCwgMjIyLCAyNzgsIDI3OCwgNzM1LCA0NDQsIDUwMCwgMjIyLCA2NjcsIDUwMCwgNTAwLCA1NTYsIDIyMiwgNTU2LCAyMjIsIDU1NiwgMjkyLCA1NTYsIDMzNCwgNTU2LCAyMjIsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDYwNCwgNzIzLCA1NTYsIDc3OCwgNTU2LCA3NzgsIDU1NiwgNzc4LCA1NTYsIDEwMDAsIDk0NCwgNzIyLCAzMzMsIDcyMiwgMzMzLCA3MjIsIDMzMywgNjY3LCA1MDAsIDY2NywgNTAwLCA2NjcsIDUwMCwgNjY3LCA1MDAsIDYxMSwgMjc4LCA2MTEsIDM3NSwgNjExLCAyNzgsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDcyMiwgNTU2LCA3MjIsIDU1NiwgNzIyLCA1NTYsIDk0NCwgNzIyLCA2NjcsIDUwMCwgNjY3LCA2MTEsIDUwMCwgNjExLCA1MDAsIDYxMSwgNTAwLCAyMjIsIDU1NiwgNjY3LCA1NTYsIDEwMDAsIDg4OSwgNzc4LCA2MTEsIDY2NywgNTAwLCA2MTEsIDI3OCwgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDY2NywgMjc4LCA3ODQsIDgzOCwgMzg0LCA3NzQsIDg1NSwgNzUyLCAyMjIsIDY2NywgNjY3LCA1NTEsIDY2OCwgNjY3LCA2MTEsIDcyMiwgNzc4LCAyNzgsIDY2NywgNjY4LCA4MzMsIDcyMiwgNjUwLCA3NzgsIDcyMiwgNjY3LCA2MTgsIDYxMSwgNjY3LCA3OTgsIDY2NywgODM1LCA3NDgsIDI3OCwgNjY3LCA1NzgsIDQ0NiwgNTU2LCAyMjIsIDU0NywgNTc4LCA1NzUsIDUwMCwgNTU3LCA0NDYsIDQ0MSwgNTU2LCA1NTYsIDIyMiwgNTAwLCA1MDAsIDU3NiwgNTAwLCA0NDgsIDU1NiwgNjkwLCA1NjksIDQ4MiwgNjE3LCAzOTUsIDU0NywgNjQ4LCA1MjUsIDcxMywgNzgxLCAyMjIsIDU0NywgNTU2LCA1NDcsIDc4MSwgNjY3LCA2NjcsIDg2NSwgNTQyLCA3MTksIDY2NywgMjc4LCAyNzgsIDUwMCwgMTA1NywgMTAxMCwgODU0LCA1ODMsIDcyMiwgNjM1LCA3MTksIDY2NywgNjU2LCA2NjcsIDU0MiwgNjc3LCA2NjcsIDkyMywgNjA0LCA3MTksIDcxOSwgNTgzLCA2NTYsIDgzMywgNzIyLCA3NzgsIDcxOSwgNjY3LCA3MjIsIDYxMSwgNjM1LCA3NjAsIDY2NywgNzQwLCA2NjcsIDkxNywgOTM4LCA3OTIsIDg4NSwgNjU2LCA3MTksIDEwMTAsIDcyMiwgNTU2LCA1NzMsIDUzMSwgMzY1LCA1ODMsIDU1NiwgNjY5LCA0NTgsIDU1OSwgNTU5LCA0MzgsIDU4MywgNjg4LCA1NTIsIDU1NiwgNTQyLCA1NTYsIDUwMCwgNDU4LCA1MDAsIDgyMywgNTAwLCA1NzMsIDUyMSwgODAyLCA4MjMsIDYyNSwgNzE5LCA1MjEsIDUxMCwgNzUwLCA1NDIsIDU1NiwgNTU2LCA1NTYsIDM2NSwgNTEwLCA1MDAsIDIyMiwgMjc4LCAyMjIsIDkwNiwgODEyLCA1NTYsIDQzOCwgNTU5LCA1MDAsIDU1MiwgNzc4LCA1NTYsIDQ4OSwgNDExLCA5NDQsIDcyMiwgOTQ0LCA3MjIsIDk0NCwgNzIyLCA2NjcsIDUwMCwgMzMzLCAzMzMsIDU1NiwgMTAwMCwgMTAwMCwgNTUyLCAyMjIsIDIyMiwgMjIyLCAyMjIsIDMzMywgMzMzLCAzMzMsIDU1NiwgNTU2LCAzNTAsIDEwMDAsIDEwMDAsIDE4OCwgMzU0LCAzMzMsIDMzMywgNTAwLCAzMzMsIDE2NywgMzY1LCA1NTYsIDU1NiwgMTA5NCwgNTU2LCA4ODUsIDMyMywgMTA3MywgMTAwMCwgNzY4LCA2MDAsIDgzNCwgODM0LCA4MzQsIDgzNCwgMTAwMCwgNTAwLCAxMDAwLCA1MDAsIDEwMDAsIDUwMCwgNTAwLCA0OTQsIDYxMiwgODIzLCA3MTMsIDU4NCwgNTQ5LCA3MTMsIDk3OSwgNzE5LCAyNzQsIDU0OSwgNTQ5LCA1ODMsIDU0OSwgNTQ5LCA2MDQsIDU4NCwgNjA0LCA2MDQsIDcwOCwgNjI1LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MDgsIDcwOCwgNzA4LCA3MjksIDYwNCwgNjA0LCAzNTQsIDM1NCwgMTAwMCwgOTkwLCA5OTAsIDk5MCwgOTkwLCA0OTQsIDYwNCwgNjA0LCA2MDQsIDYwNCwgMzU0LCAxMDIxLCAxMDUyLCA5MTcsIDc1MCwgNzUwLCA1MzEsIDY1NiwgNTk0LCA1MTAsIDUwMCwgNzUwLCA3NTAsIDUwMCwgNTAwLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMzMzLCAzMzMsIDMzMywgMjIyLCAyMjIsIDI5NCwgMjk0LCAzMjQsIDMyNCwgMzE2LCAzMjgsIDM5OCwgMjg1XTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHMgPSBMaWJlcmF0aW9uU2Fuc1JlZ3VsYXJXaWR0aHM7CmNvbnN0IExpYmVyYXRpb25TYW5zUmVndWxhck1hcHBpbmcgPSBbLTEsIC0xLCAtMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCA1MiwgNTMsIDU0LCA1NSwgNTYsIDU3LCA1OCwgNTksIDYwLCA2MSwgNjIsIDYzLCA2NCwgNjUsIDY2LCA2NywgNjgsIDY5LCA3MCwgNzEsIDcyLCA3MywgNzQsIDc1LCA3NiwgNzcsIDc4LCA3OSwgODAsIDgxLCA4MiwgODMsIDg0LCA4NSwgODYsIDg3LCA4OCwgODksIDkwLCA5MSwgOTIsIDkzLCA5NCwgOTUsIDk2LCA5NywgOTgsIDk5LCAxMDAsIDEwMSwgMTAyLCAxMDMsIDEwNCwgMTA1LCAxMDYsIDEwNywgMTA4LCAxMDksIDExMCwgMTExLCAxMTIsIDExMywgMTE0LCAxMTUsIDExNiwgMTE3LCAxMTgsIDExOSwgMTIwLCAxMjEsIDEyMiwgMTIzLCAxMjQsIDEyNSwgMTI2LCAxNjEsIDE2MiwgMTYzLCAxNjQsIDE2NSwgMTY2LCAxNjcsIDE2OCwgMTY5LCAxNzAsIDE3MSwgMTcyLCAxNzQsIDE3NSwgMTc2LCAxNzcsIDE3OCwgMTc5LCAxODAsIDE4MSwgMTgyLCAxODMsIDE4NCwgMTg1LCAxODYsIDE4NywgMTg4LCAxODksIDE5MCwgMTkxLCAxOTIsIDE5MywgMTk0LCAxOTUsIDE5NiwgMTk3LCAxOTgsIDE5OSwgMjAwLCAyMDEsIDIwMiwgMjAzLCAyMDQsIDIwNSwgMjA2LCAyMDcsIDIwOCwgMjA5LCAyMTAsIDIxMSwgMjEyLCAyMTMsIDIxNCwgMjE1LCAyMTYsIDIxNywgMjE4LCAyMTksIDIyMCwgMjIxLCAyMjIsIDIyMywgMjI0LCAyMjUsIDIyNiwgMjI3LCAyMjgsIDIyOSwgMjMwLCAyMzEsIDIzMiwgMjMzLCAyMzQsIDIzNSwgMjM2LCAyMzcsIDIzOCwgMjM5LCAyNDAsIDI0MSwgMjQyLCAyNDMsIDI0NCwgMjQ1LCAyNDYsIDI0NywgMjQ4LCAyNDksIDI1MCwgMjUxLCAyNTIsIDI1MywgMjU0LCAyNTUsIDI1NiwgMjU3LCAyNTgsIDI1OSwgMjYwLCAyNjEsIDI2MiwgMjYzLCAyNjQsIDI2NSwgMjY2LCAyNjcsIDI2OCwgMjY5LCAyNzAsIDI3MSwgMjcyLCAyNzMsIDI3NCwgMjc1LCAyNzYsIDI3NywgMjc4LCAyNzksIDI4MCwgMjgxLCAyODIsIDI4MywgMjg0LCAyODUsIDI4NiwgMjg3LCAyODgsIDI4OSwgMjkwLCAyOTEsIDI5MiwgMjkzLCAyOTQsIDI5NSwgMjk2LCAyOTcsIDI5OCwgMjk5LCAzMDAsIDMwMSwgMzAyLCAzMDMsIDMwNCwgMzA1LCAzMDYsIDMwNywgMzA4LCAzMDksIDMxMCwgMzExLCAzMTIsIDMxMywgMzE0LCAzMTUsIDMxNiwgMzE3LCAzMTgsIDMxOSwgMzIwLCAzMjEsIDMyMiwgMzIzLCAzMjQsIDMyNSwgMzI2LCAzMjcsIDMyOCwgMzI5LCAzMzAsIDMzMSwgMzMyLCAzMzMsIDMzNCwgMzM1LCAzMzYsIDMzNywgMzM4LCAzMzksIDM0MCwgMzQxLCAzNDIsIDM0MywgMzQ0LCAzNDUsIDM0NiwgMzQ3LCAzNDgsIDM0OSwgMzUwLCAzNTEsIDM1MiwgMzUzLCAzNTQsIDM1NSwgMzU2LCAzNTcsIDM1OCwgMzU5LCAzNjAsIDM2MSwgMzYyLCAzNjMsIDM2NCwgMzY1LCAzNjYsIDM2NywgMzY4LCAzNjksIDM3MCwgMzcxLCAzNzIsIDM3MywgMzc0LCAzNzUsIDM3NiwgMzc3LCAzNzgsIDM3OSwgMzgwLCAzODEsIDM4MiwgMzgzLCA0MDIsIDUwNiwgNTA3LCA1MDgsIDUwOSwgNTEwLCA1MTEsIDUzNiwgNTM3LCA1MzgsIDUzOSwgNzEwLCA3MTEsIDcxMywgNzI4LCA3MjksIDczMCwgNzMxLCA3MzIsIDczMywgOTAwLCA5MDEsIDkwMiwgOTAzLCA5MDQsIDkwNSwgOTA2LCA5MDgsIDkxMCwgOTExLCA5MTIsIDkxMywgOTE0LCA5MTUsIDkxNiwgOTE3LCA5MTgsIDkxOSwgOTIwLCA5MjEsIDkyMiwgOTIzLCA5MjQsIDkyNSwgOTI2LCA5MjcsIDkyOCwgOTI5LCA5MzEsIDkzMiwgOTMzLCA5MzQsIDkzNSwgOTM2LCA5MzcsIDkzOCwgOTM5LCA5NDAsIDk0MSwgOTQyLCA5NDMsIDk0NCwgOTQ1LCA5NDYsIDk0NywgOTQ4LCA5NDksIDk1MCwgOTUxLCA5NTIsIDk1MywgOTU0LCA5NTUsIDk1NiwgOTU3LCA5NTgsIDk1OSwgOTYwLCA5NjEsIDk2MiwgOTYzLCA5NjQsIDk2NSwgOTY2LCA5NjcsIDk2OCwgOTY5LCA5NzAsIDk3MSwgOTcyLCA5NzMsIDk3NCwgMTAyNCwgMTAyNSwgMTAyNiwgMTAyNywgMTAyOCwgMTAyOSwgMTAzMCwgMTAzMSwgMTAzMiwgMTAzMywgMTAzNCwgMTAzNSwgMTAzNiwgMTAzNywgMTAzOCwgMTAzOSwgMTA0MCwgMTA0MSwgMTA0MiwgMTA0MywgMTA0NCwgMTA0NSwgMTA0NiwgMTA0NywgMTA0OCwgMTA0OSwgMTA1MCwgMTA1MSwgMTA1MiwgMTA1MywgMTA1NCwgMTA1NSwgMTA1NiwgMTA1NywgMTA1OCwgMTA1OSwgMTA2MCwgMTA2MSwgMTA2MiwgMTA2MywgMTA2NCwgMTA2NSwgMTA2NiwgMTA2NywgMTA2OCwgMTA2OSwgMTA3MCwgMTA3MSwgMTA3MiwgMTA3MywgMTA3NCwgMTA3NSwgMTA3NiwgMTA3NywgMTA3OCwgMTA3OSwgMTA4MCwgMTA4MSwgMTA4MiwgMTA4MywgMTA4NCwgMTA4NSwgMTA4NiwgMTA4NywgMTA4OCwgMTA4OSwgMTA5MCwgMTA5MSwgMTA5MiwgMTA5MywgMTA5NCwgMTA5NSwgMTA5NiwgMTA5NywgMTA5OCwgMTA5OSwgMTEwMCwgMTEwMSwgMTEwMiwgMTEwMywgMTEwNCwgMTEwNSwgMTEwNiwgMTEwNywgMTEwOCwgMTEwOSwgMTExMCwgMTExMSwgMTExMiwgMTExMywgMTExNCwgMTExNSwgMTExNiwgMTExNywgMTExOCwgMTExOSwgMTEzOCwgMTEzOSwgMTE2OCwgMTE2OSwgNzgwOCwgNzgwOSwgNzgxMCwgNzgxMSwgNzgxMiwgNzgxMywgNzkyMiwgNzkyMywgODIwOCwgODIwOSwgODIxMSwgODIxMiwgODIxMywgODIxNSwgODIxNiwgODIxNywgODIxOCwgODIxOSwgODIyMCwgODIyMSwgODIyMiwgODIyNCwgODIyNSwgODIyNiwgODIzMCwgODI0MCwgODI0MiwgODI0MywgODI0OSwgODI1MCwgODI1MiwgODI1NCwgODI2MCwgODMxOSwgODM1NSwgODM1NiwgODM1OSwgODM2NCwgODQ1MywgODQ2NywgODQ3MCwgODQ4MiwgODQ4NiwgODQ5NCwgODUzOSwgODU0MCwgODU0MSwgODU0MiwgODU5MiwgODU5MywgODU5NCwgODU5NSwgODU5NiwgODU5NywgODYxNiwgODcwNiwgODcxMCwgODcxOSwgODcyMSwgODcyMiwgODczMCwgODczNCwgODczNSwgODc0NSwgODc0NywgODc3NiwgODgwMCwgODgwMSwgODgwNCwgODgwNSwgODk2MiwgODk3NiwgODk5MiwgODk5MywgOTQ3MiwgOTQ3NCwgOTQ4NCwgOTQ4OCwgOTQ5MiwgOTQ5NiwgOTUwMCwgOTUwOCwgOTUxNiwgOTUyNCwgOTUzMiwgOTU1MiwgOTU1MywgOTU1NCwgOTU1NSwgOTU1NiwgOTU1NywgOTU1OCwgOTU1OSwgOTU2MCwgOTU2MSwgOTU2MiwgOTU2MywgOTU2NCwgOTU2NSwgOTU2NiwgOTU2NywgOTU2OCwgOTU2OSwgOTU3MCwgOTU3MSwgOTU3MiwgOTU3MywgOTU3NCwgOTU3NSwgOTU3NiwgOTU3NywgOTU3OCwgOTU3OSwgOTU4MCwgOTYwMCwgOTYwNCwgOTYwOCwgOTYxMiwgOTYxNiwgOTYxNywgOTYxOCwgOTYxOSwgOTYzMiwgOTYzMywgOTY0MiwgOTY0MywgOTY0NCwgOTY1MCwgOTY1OCwgOTY2MCwgOTY2OCwgOTY3NCwgOTY3NSwgOTY3OSwgOTY4OCwgOTY4OSwgOTcwMiwgOTc4NiwgOTc4NywgOTc4OCwgOTc5MiwgOTc5NCwgOTgyNCwgOTgyNywgOTgyOSwgOTgzMCwgOTgzNCwgOTgzNSwgOTgzNiwgNjE0NDEsIDYxNDQyLCA2MTQ0NSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXTsKZXhwb3J0cy5MaWJlcmF0aW9uU2Fuc1JlZ3VsYXJNYXBwaW5nID0gTGliZXJhdGlvblNhbnNSZWd1bGFyTWFwcGluZzsKCi8qKiovIH0pLAovKiA1NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk15cmlhZFByb1JlZ3VsYXJNZXRyaWNzID0gZXhwb3J0cy5NeXJpYWRQcm9SZWd1bGFyRmFjdG9ycyA9IGV4cG9ydHMuTXlyaWFkUHJvSXRhbGljTWV0cmljcyA9IGV4cG9ydHMuTXlyaWFkUHJvSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuTXlyaWFkUHJvQm9sZE1ldHJpY3MgPSBleHBvcnRzLk15cmlhZFByb0JvbGRJdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5NeXJpYWRQcm9Cb2xkSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuTXlyaWFkUHJvQm9sZEZhY3RvcnMgPSB2b2lkIDA7CmNvbnN0IE15cmlhZFByb0JvbGRGYWN0b3JzID0gWzEuMzY4OTgsIDEsIDEsIDAuNzI3MDYsIDAuODA0NzksIDAuODM3MzQsIDAuOTg4OTQsIDAuOTk3OTMsIDAuOTg5NywgMC45Mzg4NCwgMC44NjIwOSwgMC45NDI5MiwgMC45NDI5MiwgMS4xNjY2MSwgMS4wMjA1OCwgMC45MzU4MiwgMC45NjY5NCwgMC45MzU4MiwgMS4xOTEzNywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC45OTc5MywgMC43ODA3NiwgMC43ODA3NiwgMS4wMjA1OCwgMS4wMjA1OCwgMS4wMjA1OCwgMC43Mjg1MSwgMC43ODk2NiwgMC45MDgzOCwgMC44MzYzNywgMC44MjM5MSwgMC45NjM3NiwgMC44MDA2MSwgMC44NjI3NSwgMC44NzY4LCAwLjk1NDA3LCAxLjAyNTgsIDAuNzM5MDEsIDAuODUwMjIsIDAuODM2NTUsIDEuMDE1NiwgMC45NTU0NiwgMC45MjE3OSwgMC44NzEwNywgMC45MjE3OSwgMC44MjExNCwgMC44MDk2LCAwLjg5NzEzLCAwLjk0NDM4LCAwLjk1MzUzLCAwLjk0MDgzLCAwLjkxOTA1LCAwLjkwNDA2LCAwLjk0NDYsIDAuOTQyOTIsIDEuMTg3NzcsIDAuOTQyOTIsIDEuMDIwNTgsIDAuODk5MDMsIDAuOTAwODgsIDAuOTQ5MzgsIDAuOTc4OTgsIDAuODEwOTMsIDAuOTc1NzEsIDAuOTQ5MzgsIDEuMDI0LCAwLjk1NzcsIDAuOTU5MzMsIDAuOTg2MjEsIDEuMDQ3NCwgMC45NzQ1NSwgMC45ODk4MSwgMC45NjcyLCAwLjk1OTMzLCAwLjk0NDYsIDAuOTc4OTgsIDAuOTc0MDcsIDAuOTc2NDYsIDAuNzgwMzYsIDEuMTAyMDgsIDAuOTU0NDIsIDAuOTUyOTgsIDAuOTc1NzksIDAuOTMzMiwgMC45NDAzOSwgMC45MzgsIDAuODA2ODcsIDEuMDExNDksIDAuODA2ODcsIDEuMDIwNTgsIDAuODA0NzksIDAuOTk3OTMsIDAuOTk3OTMsIDAuOTk3OTMsIDAuOTk3OTMsIDEuMDExNDksIDEuMDA4NzIsIDAuOTAwODgsIDAuOTE4ODIsIDEuMDIxMywgMC44MzYxLCAxLjAyMDU4LCAwLjYyMjk1LCAwLjU0MzI0LCAwLjg5MDIyLCAxLjA4NTk1LCAxLCAxLCAwLjkwMDg4LCAxLCAwLjk3NDU1LCAwLjkzNTgyLCAwLjkwMDg4LCAxLCAxLjA1Njg2LCAwLjgzNjEsIDAuOTk2NDIsIDAuOTk2NDIsIDAuOTk2NDIsIDAuNzI4NTEsIDAuOTA4MzgsIDAuOTA4MzgsIDAuOTA4MzgsIDAuOTA4MzgsIDAuOTA4MzgsIDAuOTA4MzgsIDAuODY4LCAwLjgyMzkxLCAwLjgwMDYxLCAwLjgwMDYxLCAwLjgwMDYxLCAwLjgwMDYxLCAxLjAyNTgsIDEuMDI1OCwgMS4wMjU4LCAxLjAyNTgsIDAuOTc0ODQsIDAuOTU1NDYsIDAuOTIxNzksIDAuOTIxNzksIDAuOTIxNzksIDAuOTIxNzksIDAuOTIxNzksIDEuMDIwNTgsIDAuOTIxNzksIDAuOTQ0MzgsIDAuOTQ0MzgsIDAuOTQ0MzgsIDAuOTQ0MzgsIDAuOTA0MDYsIDAuODY5NTgsIDAuOTgyMjUsIDAuOTQ5MzgsIDAuOTQ5MzgsIDAuOTQ5MzgsIDAuOTQ5MzgsIDAuOTQ5MzgsIDAuOTQ5MzgsIDAuOTAzMSwgMC44MTA5MywgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45NDkzOCwgMC45ODYyMSwgMC45ODYyMSwgMC45ODYyMSwgMC45ODYyMSwgMC45Mzk2OSwgMC45NTkzMywgMC45NDQ2LCAwLjk0NDYsIDAuOTQ0NiwgMC45NDQ2LCAwLjk0NDYsIDEuMDg1OTUsIDAuOTQ0NiwgMC45NTQ0MiwgMC45NTQ0MiwgMC45NTQ0MiwgMC45NTQ0MiwgMC45NDAzOSwgMC45Nzg5OCwgMC45NDAzOSwgMC45MDgzOCwgMC45NDkzOCwgMC45MDgzOCwgMC45NDkzOCwgMC45MDgzOCwgMC45NDkzOCwgMC44MjM5MSwgMC44MTA5MywgMC44MjM5MSwgMC44MTA5MywgMC44MjM5MSwgMC44MTA5MywgMC44MjM5MSwgMC44MTA5MywgMC45NjM3NiwgMC44NDMxMywgMC45NzQ4NCwgMC45NzU3MSwgMC44MDA2MSwgMC45NDkzOCwgMC44MDA2MSwgMC45NDkzOCwgMC44MDA2MSwgMC45NDkzOCwgMC44MDA2MSwgMC45NDkzOCwgMC44MDA2MSwgMC45NDkzOCwgMC44NzY4LCAwLjk1NzcsIDAuODc2OCwgMC45NTc3LCAwLjg3NjgsIDAuOTU3NywgMSwgMSwgMC45NTQwNywgMC45NTkzMywgMC45NzA2OSwgMC45NTkzMywgMS4wMjU4LCAwLjk4NjIxLCAxLjAyNTgsIDAuOTg2MjEsIDEuMDI1OCwgMC45ODYyMSwgMS4wMjU4LCAwLjk4NjIxLCAxLjAyNTgsIDAuOTg2MjEsIDAuODg3LCAxLjAxNTkxLCAwLjczOTAxLCAxLjA0NzQsIDEsIDEsIDAuOTc0NTUsIDAuODM2NTUsIDAuOTg5ODEsIDEsIDEsIDAuODM2NTUsIDAuNzM5NzcsIDAuODM2NTUsIDAuNzM5MDMsIDAuODQ2MzgsIDEuMDMzLCAwLjk1NTQ2LCAwLjk1OTMzLCAxLCAxLCAwLjk1NTQ2LCAwLjk1OTMzLCAwLjgyNzEsIDAuOTU0MTcsIDAuOTU5MzMsIDAuOTIxNzksIDAuOTQ0NiwgMC45MjE3OSwgMC45NDQ2LCAwLjkyMTc5LCAwLjk0NDYsIDAuOTM2LCAwLjkxOTY0LCAwLjgyMTE0LCAwLjk3NjQ2LCAxLCAxLCAwLjgyMTE0LCAwLjk3NjQ2LCAwLjgwOTYsIDAuNzgwMzYsIDAuODA5NiwgMC43ODAzNiwgMSwgMSwgMC44MDk2LCAwLjc4MDM2LCAxLCAxLCAwLjg5NzEzLCAwLjc3NDUyLCAwLjg5NzEzLCAxLjEwMjA4LCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0NDM4LCAwLjk1NDQyLCAwLjk0MDgzLCAwLjk3NTc5LCAwLjkwNDA2LCAwLjk0MDM5LCAwLjkwNDA2LCAwLjk0NDYsIDAuOTM4LCAwLjk0NDYsIDAuOTM4LCAwLjk0NDYsIDAuOTM4LCAxLCAwLjk5NzkzLCAwLjkwODM4LCAwLjk0OTM4LCAwLjg2OCwgMC45MDMxLCAwLjkyMTc5LCAwLjk0NDYsIDEsIDEsIDAuODk3MTMsIDEuMTAyMDgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTA5ODksIDAuOTM1OCwgMC45MTk0NSwgMC44MzE4MSwgMC43NTI2MSwgMC44Nzk5MiwgMC44Mjk3NiwgMC45NjAzNCwgMC44MzY4OSwgMC45NzI2OCwgMS4wMDc4LCAwLjkwODM4LCAwLjgzNjM3LCAwLjgwMTksIDAuOTAxNTcsIDAuODAwNjEsIDAuOTQ0NiwgMC45NTQwNywgMC45MjQzNiwgMS4wMjU4LCAwLjg1MDIyLCAwLjk3MTUzLCAxLjAxNTYsIDAuOTU1NDYsIDAuODkxOTIsIDAuOTIxNzksIDAuOTIzNjEsIDAuODcxMDcsIDAuOTYzMTgsIDAuODk3MTMsIDAuOTM3MDQsIDAuOTU2MzgsIDAuOTE5MDUsIDAuOTE3MDksIDAuOTI3OTYsIDEuMDI1OCwgMC45MzcwNCwgMC45NDgzNiwgMS4wMzczLCAwLjk1OTMzLCAxLjAwNzgsIDAuOTU4NzEsIDAuOTQ4MzYsIDAuOTYxNzQsIDAuOTI2MDEsIDAuOTQ5OCwgMC45ODYwNywgMC45NTc3NiwgMC45NTkzMywgMS4wNTQ1MywgMS4wMDc4LCAwLjk4Mjc1LCAwLjkzMTQsIDAuOTU2MTcsIDAuOTE3MDEsIDEuMDU5OTMsIDAuOTQ0NiwgMC43ODM2NywgMC45NTUzLCAxLCAwLjg2ODMyLCAxLjAxMjgsIDAuOTU4NzEsIDAuOTkzOTQsIDAuODc1NDgsIDAuOTYzNjEsIDAuODY3NzQsIDEuMDA3OCwgMC45NTg3MSwgMC45NDQ2LCAwLjk1ODcxLCAwLjg2Nzc0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk0MDgzLCAwLjk3NTc5LCAwLjk0MDgzLCAwLjk3NTc5LCAwLjk0MDgzLCAwLjk3NTc5LCAwLjkwNDA2LCAwLjk0MDM5LCAwLjk2Njk0LCAxLCAwLjg5OTAzLCAxLCAxLCAxLCAwLjkzNTgyLCAwLjkzNTgyLCAwLjkzNTgyLCAxLCAwLjkwOCwgMC45MDgsIDAuOTE4LCAwLjk0MjE5LCAwLjk0MjE5LCAwLjk2NTQ0LCAxLCAxLjI4NSwgMSwgMSwgMC44MTA3OSwgMC44MTA3OSwgMSwgMSwgMC43NDg1NCwgMSwgMSwgMSwgMSwgMC45OTc5MywgMSwgMSwgMSwgMC42NSwgMSwgMS4zNjE0NSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4xNzE3MywgMSwgMC44MDUzNSwgMC43NjE2OSwgMS4wMjA1OCwgMS4wNzMyLCAxLjA1NDg2LCAxLCAxLCAxLjMwNjkyLCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjE2MTYxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5NeXJpYWRQcm9Cb2xkRmFjdG9ycyA9IE15cmlhZFByb0JvbGRGYWN0b3JzOwpjb25zdCBNeXJpYWRQcm9Cb2xkTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIsCiAgbGluZUdhcDogMC4yCn07CmV4cG9ydHMuTXlyaWFkUHJvQm9sZE1ldHJpY3MgPSBNeXJpYWRQcm9Cb2xkTWV0cmljczsKY29uc3QgTXlyaWFkUHJvQm9sZEl0YWxpY0ZhY3RvcnMgPSBbMS4zNjg5OCwgMSwgMSwgMC42NjIyNywgMC44MDc3OSwgMC44MTYyNSwgMC45NzI3NiwgMC45NzI3NiwgMC45NzczMywgMC45MjIyMiwgMC44MzI2NiwgMC45NDI5MiwgMC45NDI5MiwgMS4xNjE0OCwgMS4wMjA1OCwgMC45MzU4MiwgMC45NjY5NCwgMC45MzU4MiwgMS4xNzMzNywgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC43ODA3NiwgMC43ODA3NiwgMS4wMjA1OCwgMS4wMjA1OCwgMS4wMjA1OCwgMC43MTU0MSwgMC43NjgxMywgMC44NTU3NiwgMC44MDU5MSwgMC44MDcyOSwgMC45NDI5OSwgMC43NzUxMiwgMC44MzY1NSwgMC44NjUyMywgMC45MjIyMiwgMC45ODYyMSwgMC43MTc0MywgMC44MTY5OCwgMC43OTcyNiwgMC45ODU1OCwgMC45MjIyMiwgMC45MDYzNywgMC44MzgwOSwgMC45MDYzNywgMC44MDcyOSwgMC43NjQ2MywgMC44NjI3NSwgMC45MDY5OSwgMC45MTYwNSwgMC45MTU0LCAwLjg1MzA4LCAwLjg1NDU4LCAwLjkwNTMxLCAwLjk0MjkyLCAxLjIxMjk2LCAwLjk0MjkyLCAxLjAyMDU4LCAwLjg5OTAzLCAxLjE4NjE2LCAwLjk5NjEzLCAwLjkxNjc3LCAwLjc4MjE2LCAwLjkxNjc3LCAwLjkwMDgzLCAwLjk4Nzk2LCAwLjkxMzUsIDAuOTIxNjgsIDAuOTUzODEsIDAuOTg5ODEsIDAuOTUyOTgsIDAuOTUzODEsIDAuOTM0NTksIDAuOTIxNjgsIDAuOTE1MTMsIDAuOTIwMDQsIDAuOTE2NzcsIDAuOTUwNzcsIDAuNzQ4LCAxLjA0NTAyLCAwLjkxNjc3LCAwLjkyMDYxLCAwLjk0MjM2LCAwLjg5NTQ0LCAwLjg5MzY0LCAwLjksIDAuODA2ODcsIDAuODU3OCwgMC44MDY4NywgMS4wMjA1OCwgMC44MDc3OSwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC45NzI3NiwgMC44NTc4LCAwLjk5OTczLCAxLjE4NjE2LCAwLjkxMzM5LCAxLjA4MDc0LCAwLjgyODkxLCAxLjAyMDU4LCAwLjU1NTA5LCAwLjcxNTI2LCAwLjg5MDIyLCAxLjA4NTk1LCAxLCAxLCAxLjE4NjE2LCAxLCAwLjk2NzM2LCAwLjkzNTgyLCAxLjE4NjE2LCAxLCAxLjA0ODY0LCAwLjgyNzExLCAwLjk5MDQzLCAwLjk5MDQzLCAwLjk5MDQzLCAwLjcxNTQxLCAwLjg1NTc2LCAwLjg1NTc2LCAwLjg1NTc2LCAwLjg1NTc2LCAwLjg1NTc2LCAwLjg1NTc2LCAwLjg0NSwgMC44MDcyOSwgMC43NzUxMiwgMC43NzUxMiwgMC43NzUxMiwgMC43NzUxMiwgMC45ODYyMSwgMC45ODYyMSwgMC45ODYyMSwgMC45ODYyMSwgMC45NTk2MSwgMC45MjIyMiwgMC45MDYzNywgMC45MDYzNywgMC45MDYzNywgMC45MDYzNywgMC45MDYzNywgMS4wMjA1OCwgMC45MDI1MSwgMC45MDY5OSwgMC45MDY5OSwgMC45MDY5OSwgMC45MDY5OSwgMC44NTQ1OCwgMC44MzY1OSwgMC45NDk1MSwgMC45OTYxMywgMC45OTYxMywgMC45OTYxMywgMC45OTYxMywgMC45OTYxMywgMC45OTYxMywgMC44NTgxMSwgMC43ODIxNiwgMC45MDA4MywgMC45MDA4MywgMC45MDA4MywgMC45MDA4MywgMC45NTM4MSwgMC45NTM4MSwgMC45NTM4MSwgMC45NTM4MSwgMC45MTM1LCAwLjkyMTY4LCAwLjkxNTEzLCAwLjkxNTEzLCAwLjkxNTEzLCAwLjkxNTEzLCAwLjkxNTEzLCAxLjA4NTk1LCAwLjkxNjc3LCAwLjkxNjc3LCAwLjkxNjc3LCAwLjkxNjc3LCAwLjkxNjc3LCAwLjg5MzY0LCAwLjkyMzMyLCAwLjg5MzY0LCAwLjg1NTc2LCAwLjk5NjEzLCAwLjg1NTc2LCAwLjk5NjEzLCAwLjg1NTc2LCAwLjk5NjEzLCAwLjgwNzI5LCAwLjc4MjE2LCAwLjgwNzI5LCAwLjc4MjE2LCAwLjgwNzI5LCAwLjc4MjE2LCAwLjgwNzI5LCAwLjc4MjE2LCAwLjk0Mjk5LCAwLjc2NzgzLCAwLjk1OTYxLCAwLjkxNjc3LCAwLjc3NTEyLCAwLjkwMDgzLCAwLjc3NTEyLCAwLjkwMDgzLCAwLjc3NTEyLCAwLjkwMDgzLCAwLjc3NTEyLCAwLjkwMDgzLCAwLjc3NTEyLCAwLjkwMDgzLCAwLjg2NTIzLCAwLjkxMzUsIDAuODY1MjMsIDAuOTEzNSwgMC44NjUyMywgMC45MTM1LCAxLCAxLCAwLjkyMjIyLCAwLjkyMTY4LCAwLjkyMjIyLCAwLjkyMTY4LCAwLjk4NjIxLCAwLjk1MzgxLCAwLjk4NjIxLCAwLjk1MzgxLCAwLjk4NjIxLCAwLjk1MzgxLCAwLjk4NjIxLCAwLjk1MzgxLCAwLjk4NjIxLCAwLjk1MzgxLCAwLjg2MDM2LCAwLjk3MDk2LCAwLjcxNzQzLCAwLjk4OTgxLCAxLCAxLCAwLjk1Mjk4LCAwLjc5NzI2LCAwLjk1MzgxLCAxLCAxLCAwLjc5NzI2LCAwLjY4OTQsIDAuNzk3MjYsIDAuNzQzMjEsIDAuODE2OTEsIDEuMDAwNiwgMC45MjIyMiwgMC45MjE2OCwgMSwgMSwgMC45MjIyMiwgMC45MjE2OCwgMC43OTQ2NCwgMC45MjA5OCwgMC45MjE2OCwgMC45MDYzNywgMC45MTUxMywgMC45MDYzNywgMC45MTUxMywgMC45MDYzNywgMC45MTUxMywgMC45MDksIDAuODc1MTQsIDAuODA3MjksIDAuOTUwNzcsIDEsIDEsIDAuODA3MjksIDAuOTUwNzcsIDAuNzY0NjMsIDAuNzQ4LCAwLjc2NDYzLCAwLjc0OCwgMSwgMSwgMC43NjQ2MywgMC43NDgsIDEsIDEsIDAuODYyNzUsIDAuNzI2NTEsIDAuODYyNzUsIDEuMDQ1MDIsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTA2OTksIDAuOTE2NzcsIDAuOTE1NCwgMC45NDIzNiwgMC44NTQ1OCwgMC44OTM2NCwgMC44NTQ1OCwgMC45MDUzMSwgMC45LCAwLjkwNTMxLCAwLjksIDAuOTA1MzEsIDAuOSwgMSwgMC45NzI3NiwgMC44NTU3NiwgMC45OTYxMywgMC44NDUsIDAuODU4MTEsIDAuOTAyNTEsIDAuOTE2NzcsIDEsIDEsIDAuODYyNzUsIDEuMDQ1MDIsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMTg2MTYsIDEuMDA4OTksIDEuMzA2MjgsIDAuODU1NzYsIDAuODAxNzgsIDAuNjY4NjIsIDAuNzkyNywgMC42OTMyMywgMC44ODEyNywgMC43MjQ1OSwgMC44OTcxMSwgMC45NTM4MSwgMC44NTU3NiwgMC44MDU5MSwgMC43ODA1LCAwLjk0NzI5LCAwLjc3NTEyLCAwLjkwNTMxLCAwLjkyMjIyLCAwLjkwNjM3LCAwLjk4NjIxLCAwLjgxNjk4LCAwLjkyNjU1LCAwLjk4NTU4LCAwLjkyMjIyLCAwLjg1MzU5LCAwLjkwNjM3LCAwLjkwOTc2LCAwLjgzODA5LCAwLjk0NTIzLCAwLjg2Mjc1LCAwLjgzNTA5LCAwLjkzMTU3LCAwLjg1MzA4LCAwLjgzMzkyLCAwLjkyMzQ2LCAwLjk4NjIxLCAwLjgzNTA5LCAwLjkyODg2LCAwLjkxMzI0LCAwLjkyMTY4LCAwLjk1MzgxLCAwLjkwNjQ2LCAwLjkyODg2LCAwLjkwNTU3LCAwLjg2ODQ3LCAwLjkwMjc2LCAwLjkxMzI0LCAwLjg2ODQyLCAwLjkyMTY4LCAwLjk5NTMxLCAwLjk1MzgxLCAwLjkyMjQsIDAuODU0MDgsIDAuOTI2OTksIDAuODY4NDcsIDEuMDA1MSwgMC45MTUxMywgMC44MDQ4NywgMC45MzQ4MSwgMSwgMC44ODE1OSwgMS4wNTIxNCwgMC45MDY0NiwgMC45NzM1NSwgMC44MTUzOSwgMC44OTM5OCwgMC44NTkyMywgMC45NTM4MSwgMC45MDY0NiwgMC45MTUxMywgMC45MDY0NiwgMC44NTkyMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MTU0LCAwLjk0MjM2LCAwLjkxNTQsIDAuOTQyMzYsIDAuOTE1NCwgMC45NDIzNiwgMC44NTQ1OCwgMC44OTM2NCwgMC45NjY5NCwgMSwgMC44OTkwMywgMSwgMSwgMSwgMC45MTc4MiwgMC45MTc4MiwgMC45MTc4MiwgMSwgMC44OTYsIDAuODk2LCAwLjg5NiwgMC45MzMyLCAwLjkzMzIsIDAuOTU5NzMsIDEsIDEuMjYsIDEsIDEsIDAuODA0NzksIDAuODAxNzgsIDEsIDEsIDAuODU2MzMsIDEsIDEsIDEsIDEsIDAuOTcyNzYsIDEsIDEsIDEsIDAuNjk4LCAxLCAxLjM2MTQ1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjE0NTQyLCAxLCAwLjc5MTk5LCAwLjc4Njk0LCAxLjAyMDU4LCAxLjAzNDkzLCAxLjA1NDg2LCAxLCAxLCAxLjIzMDI2LCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjIwMDA2LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5NeXJpYWRQcm9Cb2xkSXRhbGljRmFjdG9ycyA9IE15cmlhZFByb0JvbGRJdGFsaWNGYWN0b3JzOwpjb25zdCBNeXJpYWRQcm9Cb2xkSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIsCiAgbGluZUdhcDogMC4yCn07CmV4cG9ydHMuTXlyaWFkUHJvQm9sZEl0YWxpY01ldHJpY3MgPSBNeXJpYWRQcm9Cb2xkSXRhbGljTWV0cmljczsKY29uc3QgTXlyaWFkUHJvSXRhbGljRmFjdG9ycyA9IFsxLjM2ODk4LCAxLCAxLCAwLjY1NTA3LCAwLjg0OTQzLCAwLjg1NjM5LCAwLjg4NDY1LCAwLjg4NDY1LCAwLjg2OTM2LCAwLjg4MzA3LCAwLjg2OTQ4LCAwLjg1MjgzLCAwLjg1MjgzLCAxLjA2MzgzLCAxLjAyMDU4LCAwLjc1OTQ1LCAwLjkyMTksIDAuNzU5NDUsIDEuMTczMzcsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuODg0NjUsIDAuNzU5NDUsIDAuNzU5NDUsIDEuMDIwNTgsIDEuMDIwNTgsIDEuMDIwNTgsIDAuNjkwNDYsIDAuNzA5MjYsIDAuODUxNTgsIDAuNzc4MTIsIDAuNzY4NTIsIDAuODk1OTEsIDAuNzA0NjYsIDAuNzYxMjUsIDAuODAwOTQsIDAuODY4MjIsIDAuODM4NjQsIDAuNzI4LCAwLjc3MjEyLCAwLjc5NDc1LCAwLjkzNjM3LCAwLjg3NTE0LCAwLjg1ODgsIDAuNzYwMTMsIDAuODU4OCwgMC43MjQyMSwgMC42OTg2NiwgMC43NzU5OCwgMC44NTk5MSwgMC44MDgxMSwgMC44NzgzMiwgMC43ODExMiwgMC43NzUxMiwgMC44NTYyLCAxLjAyMjIsIDEuMTg0MTcsIDEuMDIyMiwgMS4yNzAxNCwgMC44OTkwMywgMS4xNTAxMiwgMC45Mzg1OSwgMC45NDM5OSwgMC44NDYsIDAuOTQzOTksIDAuODE0NTMsIDEuMDE4NiwgMC45NDIxOSwgMC45NjAxNywgMS4wMzA3NSwgMS4wMjE3NSwgMC45MTIsIDEuMDMwNzUsIDAuOTY5OTgsIDAuOTYwMTcsIDAuOTM4NTksIDAuOTQzOTksIDAuOTQzOTksIDAuOTU0OTMsIDAuNzQ2LCAxLjEyNjU4LCAwLjk0NTc4LCAwLjkxLCAwLjk3OSwgMC44ODIsIDAuODgyLCAwLjgzLCAwLjg1MDM0LCAwLjgzNTM3LCAwLjg1MDM0LCAxLjAyMDU4LCAwLjcwODY5LCAwLjg4NDY1LCAwLjg4NDY1LCAwLjg4NDY1LCAwLjg4NDY1LCAwLjgzNTM3LCAwLjkwMDgzLCAxLjE1MDEyLCAwLjkxNjEsIDAuOTQ1NjUsIDAuNzM1NDEsIDEuMDIwNTgsIDAuNTM2MDksIDAuNjkzNTMsIDAuNzk1MTksIDEuMDg1OTUsIDEsIDEsIDEuMTUwMTIsIDEsIDAuOTE5NzQsIDAuNzU5NDUsIDEuMTUwMTIsIDEsIDAuOTQ0NiwgMC43MzM2MSwgMC45MDA1LCAwLjkwMDUsIDAuOTAwNSwgMC42Mjg2NCwgMC44NTE1OCwgMC44NTE1OCwgMC44NTE1OCwgMC44NTE1OCwgMC44NTE1OCwgMC44NTE1OCwgMC43NzMsIDAuNzY4NTIsIDAuNzA0NjYsIDAuNzA0NjYsIDAuNzA0NjYsIDAuNzA0NjYsIDAuODM4NjQsIDAuODM4NjQsIDAuODM4NjQsIDAuODM4NjQsIDAuOTA1NjEsIDAuODc1MTQsIDAuODU4OCwgMC44NTg4LCAwLjg1ODgsIDAuODU4OCwgMC44NTg4LCAxLjAyMDU4LCAwLjg1NzUxLCAwLjg1OTkxLCAwLjg1OTkxLCAwLjg1OTkxLCAwLjg1OTkxLCAwLjc3NTEyLCAwLjc2MDEzLCAwLjg4MDc1LCAwLjkzODU5LCAwLjkzODU5LCAwLjkzODU5LCAwLjkzODU5LCAwLjkzODU5LCAwLjkzODU5LCAwLjgwNzUsIDAuODQ2LCAwLjgxNDUzLCAwLjgxNDUzLCAwLjgxNDUzLCAwLjgxNDUzLCAwLjgyNDI0LCAwLjgyNDI0LCAwLjgyNDI0LCAwLjgyNDI0LCAwLjkyNzgsIDAuOTYwMTcsIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDAuOTM4NTksIDEuMDg1OTUsIDAuODU2MiwgMC45NDU3OCwgMC45NDU3OCwgMC45NDU3OCwgMC45NDU3OCwgMC44ODIsIDAuOTQ1NzgsIDAuODgyLCAwLjg1MTU4LCAwLjkzODU5LCAwLjg1MTU4LCAwLjkzODU5LCAwLjg1MTU4LCAwLjkzODU5LCAwLjc2ODUyLCAwLjg0NiwgMC43Njg1MiwgMC44NDYsIDAuNzY4NTIsIDAuODQ2LCAwLjc2ODUyLCAwLjg0NiwgMC44OTU5MSwgMC44NTQ0LCAwLjkwNTYxLCAwLjk0Mzk5LCAwLjcwNDY2LCAwLjgxNDUzLCAwLjcwNDY2LCAwLjgxNDUzLCAwLjcwNDY2LCAwLjgxNDUzLCAwLjcwNDY2LCAwLjgxNDUzLCAwLjcwNDY2LCAwLjgxNDUzLCAwLjgwMDk0LCAwLjk0MjE5LCAwLjgwMDk0LCAwLjk0MjE5LCAwLjgwMDk0LCAwLjk0MjE5LCAxLCAxLCAwLjg2ODIyLCAwLjk2MDE3LCAwLjg2ODIyLCAwLjk2MDE3LCAwLjgzODY0LCAwLjgyNDI0LCAwLjgzODY0LCAwLjgyNDI0LCAwLjgzODY0LCAwLjgyNDI0LCAwLjgzODY0LCAxLjAzMDc1LCAwLjgzODY0LCAwLjgyNDI0LCAwLjgxNDAyLCAxLjAyNzM4LCAwLjcyOCwgMS4wMjE3NSwgMSwgMSwgMC45MTIsIDAuNzk0NzUsIDEuMDMwNzUsIDEsIDEsIDAuNzk0NzUsIDAuODM5MTEsIDAuNzk0NzUsIDAuNjYyNjYsIDAuODA1NTMsIDEuMDY2NzYsIDAuODc1MTQsIDAuOTYwMTcsIDEsIDEsIDAuODc1MTQsIDAuOTYwMTcsIDAuODY4NjUsIDAuODczOTYsIDAuOTYwMTcsIDAuODU4OCwgMC45Mzg1OSwgMC44NTg4LCAwLjkzODU5LCAwLjg1ODgsIDAuOTM4NTksIDAuODY3LCAwLjg0NzU5LCAwLjcyNDIxLCAwLjk1NDkzLCAxLCAxLCAwLjcyNDIxLCAwLjk1NDkzLCAwLjY5ODY2LCAwLjc0NiwgMC42OTg2NiwgMC43NDYsIDEsIDEsIDAuNjk4NjYsIDAuNzQ2LCAxLCAxLCAwLjc3NTk4LCAwLjg4NDE3LCAwLjc3NTk4LCAxLjEyNjU4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg1OTkxLCAwLjk0NTc4LCAwLjg3ODMyLCAwLjk3OSwgMC43NzUxMiwgMC44ODIsIDAuNzc1MTIsIDAuODU2MiwgMC44MywgMC44NTYyLCAwLjgzLCAwLjg1NjIsIDAuODMsIDEsIDAuODg0NjUsIDAuODUxNTgsIDAuOTM4NTksIDAuNzczLCAwLjgwNzUsIDAuODU3NTEsIDAuODU2MiwgMSwgMSwgMC43NzU5OCwgMS4xMjY1OCwgMS4xNTAxMiwgMS4xNTAxMiwgMS4xNTAxMiwgMS4xNTAxMiwgMS4xNTAxMiwgMS4xNTMxMywgMS4xNTAxMiwgMS4xNTAxMiwgMS4xNTAxMiwgMS4wODEwNiwgMS4wMzkwMSwgMC44NTE1OCwgMC43NzAyNSwgMC42MjI2NCwgMC43NjQ2LCAwLjY1MzUxLCAwLjg2MDI2LCAwLjY5NDYxLCAwLjg5OTQ3LCAxLjAzMDc1LCAwLjg1MTU4LCAwLjc3ODEyLCAwLjc2NDQ5LCAwLjg4ODM2LCAwLjcwNDY2LCAwLjg1NjIsIDAuODY4MjIsIDAuODU4OCwgMC44Mzg2NCwgMC43NzIxMiwgMC44NTMwOCwgMC45MzYzNywgMC44NzUxNCwgMC44MjM1MiwgMC44NTg4LCAwLjg1NzAxLCAwLjc2MDEzLCAwLjg5MDU4LCAwLjc3NTk4LCAwLjgxNTYsIDAuODI1NjUsIDAuNzgxMTIsIDAuNzc4OTksIDAuODkzODYsIDAuODM4NjQsIDAuODE1NiwgMC45NDg2LCAwLjkyMzg4LCAwLjk2MTg2LCAxLjAzMDc1LCAwLjkxMTIzLCAwLjk0ODYsIDAuOTMyOTgsIDAuODc4LCAwLjkzOTQyLCAwLjkyMzg4LCAwLjg0NTk2LCAwLjk2MTg2LCAwLjk1MTE5LCAxLjAzMDc1LCAwLjkyMiwgMC44ODc4NywgMC45NTgyOSwgMC44OCwgMC45MzU1OSwgMC45Mzg1OSwgMC43ODgxNSwgMC45Mzc1OCwgMSwgMC44OTIxNywgMS4wMzczNywgMC45MTEyMywgMC45Mzk2OSwgMC43NzQ4NywgMC44NTc2OSwgMC44Njc5OSwgMS4wMzA3NSwgMC45MTEyMywgMC45Mzg1OSwgMC45MTEyMywgMC44Njc5OSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44NzgzMiwgMC45NzksIDAuODc4MzIsIDAuOTc5LCAwLjg3ODMyLCAwLjk3OSwgMC43NzUxMiwgMC44ODIsIDAuOTIxOSwgMSwgMC44OTkwMywgMSwgMSwgMSwgMC44NzMyMSwgMC44NzMyMSwgMC44NzMyMSwgMSwgMS4wMjcsIDEuMDI3LCAxLjAyNywgMC44Njg0NywgMC44Njg0NywgMC43OTEyMSwgMSwgMS4xMjQsIDEsIDEsIDAuNzM1NzIsIDAuNzM1NzIsIDEsIDEsIDAuODUwMzQsIDEsIDEsIDEsIDEsIDAuODg0NjUsIDEsIDEsIDEsIDAuNjY5LCAxLCAxLjM2MTQ1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA0ODI4LCAxLCAwLjc0OTQ4LCAwLjc1MTg3LCAxLjAyMDU4LCAwLjk4MzkxLCAxLjAyMTE5LCAxLCAxLCAxLjA2MjMzLCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLjA4NTk1LCAxLjA4NTk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA1MjMzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxXTsKZXhwb3J0cy5NeXJpYWRQcm9JdGFsaWNGYWN0b3JzID0gTXlyaWFkUHJvSXRhbGljRmFjdG9yczsKY29uc3QgTXlyaWFkUHJvSXRhbGljTWV0cmljcyA9IHsKICBsaW5lSGVpZ2h0OiAxLjIsCiAgbGluZUdhcDogMC4yCn07CmV4cG9ydHMuTXlyaWFkUHJvSXRhbGljTWV0cmljcyA9IE15cmlhZFByb0l0YWxpY01ldHJpY3M7CmNvbnN0IE15cmlhZFByb1JlZ3VsYXJGYWN0b3JzID0gWzEuMzY4OTgsIDEsIDEsIDAuNzYzMDUsIDAuODI3ODQsIDAuOTQ5MzUsIDAuODkzNjQsIDAuOTIyNDEsIDAuODkwNzMsIDAuOTA3MDYsIDAuOTg0NzIsIDAuODUyODMsIDAuODUyODMsIDEuMDY2NCwgMS4wMjA1OCwgMC43NDUwNSwgMC45MjE5LCAwLjc0NTA1LCAxLjIzNDU2LCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjkyMjQxLCAwLjc0NTA1LCAwLjc0NTA1LCAxLjAyMDU4LCAxLjAyMDU4LCAxLjAyMDU4LCAwLjczMDAyLCAwLjcyNjAxLCAwLjkxNzU1LCAwLjgxMjYsIDAuODAzMTQsIDAuOTIyMjIsIDAuNzM3NjQsIDAuNzk3MjYsIDAuODMwNTEsIDAuOTAyODQsIDAuODYwMjMsIDAuNzQsIDAuODEyNiwgMC44NDg2OSwgMC45NjUxOCwgMC45MTExNSwgMC44ODU4LCAwLjc5NzYxLCAwLjg4NTgsIDAuNzQ0OTgsIDAuNzM5MTQsIDAuODEzNjMsIDAuODk1OTEsIDAuODM2NTksIDAuODk2MzMsIDAuODU2MDgsIDAuODExMSwgMC45MDUzMSwgMS4wMjIyLCAxLjIyNzM2LCAxLjAyMjIsIDEuMjcwMTQsIDAuODk5MDMsIDAuOTAwODgsIDAuODY2NjcsIDEuMDIzMSwgMC44OTYsIDEuMDE0MTEsIDAuOTAwODMsIDEuMDUwOTksIDEuMDA1MTIsIDAuOTk3OTMsIDEuMDUzMjYsIDEuMDkzNzcsIDAuOTM4LCAxLjA2MjI2LCAxLjAwMTE5LCAwLjk5NzkzLCAwLjk4NzE0LCAxLjAyMzEsIDEuMDEyMzEsIDAuOTgxOTYsIDAuNzkyLCAxLjE5MTM3LCAwLjk5MDc0LCAwLjk2MiwgMS4wMTkxNSwgMC45MjYsIDAuOTQyLCAwLjg1NiwgMC44NTAzNCwgMC45MjAwNiwgMC44NTAzNCwgMS4wMjA1OCwgMC42OTA2NywgMC45MjI0MSwgMC45MjI0MSwgMC45MjI0MSwgMC45MjI0MSwgMC45MjAwNiwgMC45MzMyLCAwLjkwMDg4LCAwLjkxODgyLCAwLjkzNDg0LCAwLjc1MzM5LCAxLjAyMDU4LCAwLjU2ODY2LCAwLjU0MzI0LCAwLjc5NTE5LCAxLjA4NTk1LCAxLCAxLCAwLjkwMDg4LCAxLCAwLjk1MzI1LCAwLjc0NTA1LCAwLjkwMDg4LCAxLCAwLjk3MTk4LCAwLjc1MzM5LCAwLjkxMDA5LCAwLjkxMDA5LCAwLjkxMDA5LCAwLjY2NDY2LCAwLjkxNzU1LCAwLjkxNzU1LCAwLjkxNzU1LCAwLjkxNzU1LCAwLjkxNzU1LCAwLjkxNzU1LCAwLjc4OCwgMC44MDMxNCwgMC43Mzc2NCwgMC43Mzc2NCwgMC43Mzc2NCwgMC43Mzc2NCwgMC44NjAyMywgMC44NjAyMywgMC44NjAyMywgMC44NjAyMywgMC45MjkxNSwgMC45MTExNSwgMC44ODU4LCAwLjg4NTgsIDAuODg1OCwgMC44ODU4LCAwLjg4NTgsIDEuMDIwNTgsIDAuODg1OCwgMC44OTU5MSwgMC44OTU5MSwgMC44OTU5MSwgMC44OTU5MSwgMC44MTExLCAwLjc5NjExLCAwLjg5NzEzLCAwLjg2NjY3LCAwLjg2NjY3LCAwLjg2NjY3LCAwLjg2NjY3LCAwLjg2NjY3LCAwLjg2NjY3LCAwLjg2OTM2LCAwLjg5NiwgMC45MDA4MywgMC45MDA4MywgMC45MDA4MywgMC45MDA4MywgMC44NDIyNCwgMC44NDIyNCwgMC44NDIyNCwgMC44NDIyNCwgMC45NzI3NiwgMC45OTc5MywgMC45ODcxNCwgMC45ODcxNCwgMC45ODcxNCwgMC45ODcxNCwgMC45ODcxNCwgMS4wODU5NSwgMC44OTg3NiwgMC45OTA3NCwgMC45OTA3NCwgMC45OTA3NCwgMC45OTA3NCwgMC45NDIsIDEuMDIzMSwgMC45NDIsIDAuOTE3NTUsIDAuODY2NjcsIDAuOTE3NTUsIDAuODY2NjcsIDAuOTE3NTUsIDAuODY2NjcsIDAuODAzMTQsIDAuODk2LCAwLjgwMzE0LCAwLjg5NiwgMC44MDMxNCwgMC44OTYsIDAuODAzMTQsIDAuODk2LCAwLjkyMjIyLCAwLjkzMzcyLCAwLjkyOTE1LCAxLjAxNDExLCAwLjczNzY0LCAwLjkwMDgzLCAwLjczNzY0LCAwLjkwMDgzLCAwLjczNzY0LCAwLjkwMDgzLCAwLjczNzY0LCAwLjkwMDgzLCAwLjczNzY0LCAwLjkwMDgzLCAwLjgzMDUxLCAxLjAwNTEyLCAwLjgzMDUxLCAxLjAwNTEyLCAwLjgzMDUxLCAxLjAwNTEyLCAxLCAxLCAwLjkwMjg0LCAwLjk5NzkzLCAwLjkwOTc2LCAwLjk5NzkzLCAwLjg2MDIzLCAwLjg0MjI0LCAwLjg2MDIzLCAwLjg0MjI0LCAwLjg2MDIzLCAwLjg0MjI0LCAwLjg2MDIzLCAxLjA1MzI2LCAwLjg2MDIzLCAwLjg0MjI0LCAwLjgyODczLCAxLjA3NDY5LCAwLjc0LCAxLjA5Mzc3LCAxLCAxLCAwLjkzOCwgMC44NDg2OSwgMS4wNjIyNiwgMSwgMSwgMC44NDg2OSwgMC44MzcwNCwgMC44NDg2OSwgMC44MTQ0MSwgMC44NTU4OCwgMS4wODkyNywgMC45MTExNSwgMC45OTc5MywgMSwgMSwgMC45MTExNSwgMC45OTc5MywgMC45MTg4NywgMC45MDk5MSwgMC45OTc5MywgMC44ODU4LCAwLjk4NzE0LCAwLjg4NTgsIDAuOTg3MTQsIDAuODg1OCwgMC45ODcxNCwgMC44OTQsIDAuOTE0MzQsIDAuNzQ0OTgsIDAuOTgxOTYsIDEsIDEsIDAuNzQ0OTgsIDAuOTgxOTYsIDAuNzM5MTQsIDAuNzkyLCAwLjczOTE0LCAwLjc5MiwgMSwgMSwgMC43MzkxNCwgMC43OTIsIDEsIDEsIDAuODEzNjMsIDAuOTA0LCAwLjgxMzYzLCAxLjE5MTM3LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NTkxLCAwLjk5MDc0LCAwLjg5NjMzLCAxLjAxOTE1LCAwLjgxMTEsIDAuOTQyLCAwLjgxMTEsIDAuOTA1MzEsIDAuODU2LCAwLjkwNTMxLCAwLjg1NiwgMC45MDUzMSwgMC44NTYsIDEsIDAuOTIyNDEsIDAuOTE3NTUsIDAuODY2NjcsIDAuNzg4LCAwLjg2OTM2LCAwLjg4NTgsIDAuODk4NzYsIDEsIDEsIDAuODEzNjMsIDEuMTkxMzcsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAwODgsIDAuOTAzODgsIDEuMDM5MDEsIDAuOTIxMzgsIDAuNzgxMDUsIDAuNzE1NCwgMC44NjE2OSwgMC44MDUxMywgMC45NDAwNywgMC44MjUyOCwgMC45ODYxMiwgMS4wNjIyNiwgMC45MTc1NSwgMC44MTI2LCAwLjgxODg0LCAwLjkyODE5LCAwLjczNzY0LCAwLjkwNTMxLCAwLjkwMjg0LCAwLjg4NTgsIDAuODYwMjMsIDAuODEyNiwgMC45MTE3MiwgMC45NjUxOCwgMC45MTExNSwgMC44MzA4OSwgMC44ODU4LCAwLjg3NzkxLCAwLjc5NzYxLCAwLjg5Mjk3LCAwLjgxMzYzLCAwLjg4MTU3LCAwLjg5OTkyLCAwLjg1NjA4LCAwLjgxOTkyLCAwLjk0MzA3LCAwLjg2MDIzLCAwLjg4MTU3LCAwLjk1MzA4LCAwLjk4Njk5LCAwLjk5NzkzLCAxLjA2MjI2LCAwLjk1ODE3LCAwLjk1MzA4LCAwLjk3MzU4LCAwLjkyOCwgMC45ODA4OCwgMC45ODY5OSwgMC45Mjc2MSwgMC45OTc5MywgMC45NjAxNywgMS4wNjIyNiwgMC45ODYsIDAuOTQ0LCAwLjk1OTc4LCAwLjkzOCwgMC45NjcwNSwgMC45ODcxNCwgMC44MDQ0MiwgMC45ODk3MiwgMSwgMC44OTc2MiwgMS4wNDU1MiwgMC45NTgxNywgMC45OTAwNywgMC44NzA2NCwgMC45MTg3OSwgMC44ODg4OCwgMS4wNjIyNiwgMC45NTgxNywgMC45ODcxNCwgMC45NTgxNywgMC44ODg4OCwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC44OTYzMywgMS4wMTkxNSwgMC44OTYzMywgMS4wMTkxNSwgMC44OTYzMywgMS4wMTkxNSwgMC44MTExLCAwLjk0MiwgMC45MjE5LCAxLCAwLjg5OTAzLCAxLCAxLCAxLCAwLjkzMTczLCAwLjkzMTczLCAwLjkzMTczLCAxLCAxLjA2MzA0LCAxLjA2MzA0LCAxLjA2OTA0LCAwLjg5OTAzLCAwLjg5OTAzLCAwLjgwNTQ5LCAxLCAxLjE1NiwgMSwgMSwgMC43NjU3NSwgMC43NjU3NSwgMSwgMSwgMC43MjQ1OCwgMSwgMSwgMSwgMSwgMC45MjI0MSwgMSwgMSwgMSwgMC42MTksIDEsIDEuMzYxNDUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDcyNTcsIDEsIDAuNzQ3MDUsIDAuNzExMTksIDEuMDIwNTgsIDEuMDI0LCAxLjAyMTE5LCAxLCAxLCAxLjE1MzYsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEuMDg1OTUsIDEuMDg1OTUsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDU2MzgsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLk15cmlhZFByb1JlZ3VsYXJGYWN0b3JzID0gTXlyaWFkUHJvUmVndWxhckZhY3RvcnM7CmNvbnN0IE15cmlhZFByb1JlZ3VsYXJNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMiwKICBsaW5lR2FwOiAwLjIKfTsKZXhwb3J0cy5NeXJpYWRQcm9SZWd1bGFyTWV0cmljcyA9IE15cmlhZFByb1JlZ3VsYXJNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuU2Vnb2V1aVJlZ3VsYXJNZXRyaWNzID0gZXhwb3J0cy5TZWdvZXVpUmVndWxhckZhY3RvcnMgPSBleHBvcnRzLlNlZ29ldWlJdGFsaWNNZXRyaWNzID0gZXhwb3J0cy5TZWdvZXVpSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuU2Vnb2V1aUJvbGRNZXRyaWNzID0gZXhwb3J0cy5TZWdvZXVpQm9sZEl0YWxpY01ldHJpY3MgPSBleHBvcnRzLlNlZ29ldWlCb2xkSXRhbGljRmFjdG9ycyA9IGV4cG9ydHMuU2Vnb2V1aUJvbGRGYWN0b3JzID0gdm9pZCAwOwpjb25zdCBTZWdvZXVpQm9sZEZhY3RvcnMgPSBbMS43NjczOCwgMSwgMSwgMC45OTI5NywgMC45ODI0LCAxLjA0MDE2LCAxLjA2NDk3LCAxLjAzNDI0LCAwLjk3NTI5LCAxLjE3NjQ3LCAxLjIzMjAzLCAxLjEwODUsIDEuMTA4NSwgMS4xNjkzOSwgMS4yMTA3LCAwLjk3NTQsIDEuMjE0MDgsIDAuOTc1NCwgMS41OTU3OCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMC44MTM3OCwgMC44MTM3OCwgMS4yMTA3LCAxLjIxMDcsIDEuMjEwNywgMC43MTcwMywgMC45Nzg0NywgMC45NzM2MywgMC44ODc3NiwgMC44NjQxLCAxLjAyMDk2LCAwLjc5Nzk1LCAwLjg1MTMyLCAwLjkxNCwgMS4wNjA4NSwgMS4xNDA2LCAwLjgwMDcsIDAuODk4NTgsIDAuODM2OTMsIDEuMTQ4ODksIDEuMDkzOTgsIDAuOTc0ODksIDAuOTIwOTQsIDAuOTc0ODksIDAuOTAzOTksIDAuODQwNDEsIDAuOTU5MjMsIDEuMDAxMzUsIDEsIDEuMDY0NjcsIDAuOTgyNDMsIDAuOTA5OTYsIDAuOTkzNjEsIDEuMTA4NSwgMS41Njk0MiwgMS4xMDg1LCAxLjIxMDcsIDAuNzQ2MjcsIDAuOTQyODIsIDAuOTY3NTIsIDEuMDE1MTksIDAuODYzMDQsIDEuMDEzNTksIDAuOTcyNzgsIDEuMTUxMDMsIDEuMDEzNTksIDAuOTg1NjEsIDEuMDIyODUsIDEuMDIyODUsIDEuMDA1MjcsIDEuMDIyODUsIDEuMDMwMiwgMC45OTA0MSwgMS4wMDA4LCAxLjAxNTE5LCAxLjAxMzU5LCAxLjAyMjU4LCAwLjc5MTA0LCAxLjE2ODYyLCAwLjk5MDQxLCAwLjk3NDU0LCAxLjAyNTExLCAwLjk5Mjk4LCAwLjk2NzUyLCAwLjk1ODAxLCAwLjk0ODU2LCAxLjE2NTc5LCAwLjk0ODU2LCAxLjIxMDcsIDAuOTgyNCwgMS4wMzQyNCwgMS4wMzQyNCwgMSwgMS4wMzQyNCwgMS4xNjU3OSwgMC44NzI3LCAxLjM4NzEsIDEuMTg2MjIsIDEuMTA4MTgsIDEuMDQ0NzgsIDEuMjEwNywgMS4xODYyMiwgMC43NTE1NSwgMC45NDk5NCwgMS4yODgyNiwgMS4yMTQwOCwgMS4yMTQwOCwgMC45MTA1NiwgMSwgMC45MTU3MiwgMC45NzU0LCAwLjY0NjYzLCAxLjE4MzI4LCAxLjI0ODY2LCAxLjA0NDc4LCAxLjE0MTY5LCAxLjE1NzQ5LCAxLjE3Mzg5LCAwLjcxNzAzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjkzNTA2LCAwLjg2NDEsIDAuNzk3OTUsIDAuNzk3OTUsIDAuNzk3OTUsIDAuNzk3OTUsIDEuMTQwNiwgMS4xNDA2LCAxLjE0MDYsIDEuMTQwNiwgMS4wMjA5NiwgMS4wOTM5OCwgMC45NzQyNiwgMC45NzQyNiwgMC45NzQyNiwgMC45NzQyNiwgMC45NzQyNiwgMS4yMTA3LCAwLjk3NDg5LCAxLjAwMTM1LCAxLjAwMTM1LCAxLjAwMTM1LCAxLjAwMTM1LCAwLjkwOTk2LCAwLjkyMDk0LCAxLjAyNzk4LCAwLjk2NzUyLCAwLjk2NzUyLCAwLjk2NzUyLCAwLjk2NzUyLCAwLjk2NzUyLCAwLjk2NzUyLCAwLjkzMTM2LCAwLjg2MzA0LCAwLjk3Mjc4LCAwLjk3Mjc4LCAwLjk3Mjc4LCAwLjk3Mjc4LCAxLjAyMjg1LCAxLjAyMjg1LCAxLjAyMjg1LCAxLjAyMjg1LCAwLjk3MTIyLCAwLjk5MDQxLCAxLCAxLCAxLCAxLCAxLCAxLjI4ODI2LCAxLjAwMDgsIDAuOTkwNDEsIDAuOTkwNDEsIDAuOTkwNDEsIDAuOTkwNDEsIDAuOTY3NTIsIDEuMDE1MTksIDAuOTY3NTIsIDAuOTczNjMsIDAuOTY3NTIsIDAuOTczNjMsIDAuOTY3NTIsIDAuOTczNjMsIDAuOTY3NTIsIDAuODY0MSwgMC44NjMwNCwgMC44NjQxLCAwLjg2MzA0LCAwLjg2NDEsIDAuODYzMDQsIDAuODY0MSwgMC44NjMwNCwgMS4wMjA5NiwgMS4wMzA1NywgMS4wMjA5NiwgMS4wMzUxNywgMC43OTc5NSwgMC45NzI3OCwgMC43OTc5NSwgMC45NzI3OCwgMC43OTc5NSwgMC45NzI3OCwgMC43OTc5NSwgMC45NzI3OCwgMC43OTc5NSwgMC45NzI3OCwgMC45MTQsIDEuMDEzNTksIDAuOTE0LCAxLjAxMzU5LCAwLjkxNCwgMS4wMTM1OSwgMSwgMSwgMS4wNjA4NSwgMC45ODU2MSwgMS4wNjA4NSwgMS4wMDg3OSwgMS4xNDA2LCAxLjAyMjg1LCAxLjE0MDYsIDEuMDIyODUsIDEuMTQwNiwgMS4wMjI4NSwgMS4xNDA2LCAxLjAyMjg1LCAxLjE0MDYsIDEuMDIyODUsIDAuOTcxMzgsIDEuMDg2OTIsIDAuODAwNywgMS4wMjI4NSwgMSwgMSwgMS4wMDUyNywgMC44MzY5MywgMS4wMjI4NSwgMSwgMSwgMC44MzY5MywgMC45NDU1LCAwLjgzNjkzLCAwLjkwNDE4LCAwLjgzNjkzLCAxLjEzMDA1LCAxLjA5Mzk4LCAwLjk5MDQxLCAxLCAxLCAxLjA5Mzk4LCAwLjk5MDQxLCAwLjk2NjkyLCAxLjA5MjUxLCAwLjk5MDQxLCAwLjk3NDg5LCAxLjAwMDgsIDAuOTc0ODksIDEuMDAwOCwgMC45NzQ4OSwgMS4wMDA4LCAwLjkzOTk0LCAwLjk3OTMxLCAwLjkwMzk5LCAxLjAyMjU4LCAxLCAxLCAwLjkwMzk5LCAxLjAyMjU4LCAwLjg0MDQxLCAwLjc5MTA0LCAwLjg0MDQxLCAwLjc5MTA0LCAwLjg0MDQxLCAwLjc5MTA0LCAwLjg0MDQxLCAwLjc5MTA0LCAxLCAxLCAwLjk1OTIzLCAxLjA3MDM0LCAwLjk1OTIzLCAxLjE2ODYyLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjAwMTM1LCAwLjk5MDQxLCAxLjA2NDY3LCAxLjAyNTExLCAwLjkwOTk2LCAwLjk2NzUyLCAwLjkwOTk2LCAwLjk5MzYxLCAwLjk1ODAxLCAwLjk5MzYxLCAwLjk1ODAxLCAwLjk5MzYxLCAwLjk1ODAxLCAxLjA3NzMzLCAxLjAzNDI0LCAwLjk3MzYzLCAwLjk2NzUyLCAwLjkzNTA2LCAwLjkzMTM2LCAwLjk3NDg5LCAxLjAwMDgsIDEsIDEsIDAuOTU5MjMsIDEuMTY4NjIsIDEuMTUxMDMsIDEuMTUxMDMsIDEuMDExNzMsIDEuMDM5NTksIDAuNzU5NTMsIDAuODEzNzgsIDAuNzk5MTIsIDEuMTUxMDMsIDEuMjE5OTQsIDAuOTUxNjEsIDAuODc4MTUsIDEuMDExNDksIDAuODE1MjUsIDAuNzY3NiwgMC45ODE2NywgMS4wMTEzNCwgMS4wMjU0NiwgMC44NDA5NywgMS4wMzA4OSwgMS4xODEwMiwgMC45NzM2MywgMC44ODc3NiwgMC44NTEzNCwgMC45NzgyNiwgMC43OTc5NSwgMC45OTM2MSwgMS4wNjA4NSwgMC45NzQ4OSwgMS4xNDA2LCAwLjg5ODU4LCAxLjAzODgsIDEuMTQ4ODksIDEuMDkzOTgsIDAuODYwMzksIDAuOTc0ODksIDEuMDU5NSwgMC45MjA5NCwgMC45NDc5MywgMC45NTkyMywgMC45MDk5NiwgMC45OTM0NiwgMC45ODI0MywgMS4wMjExMiwgMC45NTQ5MywgMS4xNDA2LCAwLjkwOTk2LCAxLjAzNTc0LCAxLjAyNTk3LCAxLjAwMDgsIDEuMTgxMDIsIDEuMDY2MjgsIDEuMDM1NzQsIDEuMDE5MiwgMS4wMTkzMiwgMS4wMDg4NiwgMC45NzUzMSwgMS4wMTA2LCAxLjAwMDgsIDEuMTMxODksIDEuMTgxMDIsIDEuMDIyNzcsIDAuOTg2ODMsIDEuMDAxNiwgMC45OTU2MSwgMS4wNzIzNywgMS4wMDA4LCAwLjkwNDM0LCAwLjk5OTIxLCAwLjkzODAzLCAwLjg5NjUsIDEuMjMwODUsIDEuMDY2MjgsIDEuMDQ5ODMsIDAuOTYyNjgsIDEuMDQ5OSwgMC45ODQzOSwgMS4xODEwMiwgMS4wNjYyOCwgMS4wMDA4LCAxLjA2NjI4LCAwLjk4NDM5LCAwLjc5Nzk1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA5NDY2LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk3Mjc4LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjAyMDY1LCAxLCAxLCAxLCAxLCAxLCAxLCAxLjA2NDY3LCAxLjAyNTExLCAxLjA2NDY3LCAxLjAyNTExLCAxLjA2NDY3LCAxLjAyNTExLCAwLjkwOTk2LCAwLjk2NzUyLCAxLCAxLjIxNDA4LCAwLjg5OTAzLCAxLCAxLCAwLjc1MTU1LCAxLjA0Mzk0LCAxLjA0Mzk0LCAxLjA0Mzk0LCAxLjA0Mzk0LCAwLjk4NjMzLCAwLjk4NjMzLCAwLjk4NjMzLCAwLjczMDQ3LCAwLjczMDQ3LCAxLjIwNjQyLCAwLjkxMjExLCAxLjI1NjM1LCAxLjIyMiwgMS4wMjk1NiwgMS4wMzM3MiwgMS4wMzM3MiwgMC45NjAzOSwgMS4yNDYzMywgMSwgMS4xMjQ1NCwgMC45MzUwMywgMS4wMzQyNCwgMS4xOTY4NywgMS4wMzQyNCwgMSwgMSwgMSwgMC43NzEsIDEsIDEsIDEuMTU3NDksIDEuMTU3NDksIDEuMTU3NDksIDEuMTA5NDgsIDAuODYyNzksIDAuOTQ0MzQsIDAuODYyNzksIDAuOTQ0MzQsIDAuODYxODIsIDEsIDEsIDEuMTY4OTcsIDEsIDAuOTYwODUsIDAuOTAxMzcsIDEuMjEwNywgMS4xODQxNiwgMS4xMzk3MywgMC42OTgyNSwgMC45NzE2LCAyLjEwMzM5LCAxLjI5MDA0LCAxLjI5MDA0LCAxLjIxMTcyLCAxLjI5MDA0LCAxLjI5MDA0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjQyNjAzLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAxLjE4ODc0LCAxLjQyNjAzLCAxLCAxLjQyNjAzLCAxLjQyNjAzLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjI4ODYsIDEuMDQzMTUsIDEuMTUyOTYsIDEuMzQxNjMsIDEsIDEsIDEsIDEuMDkxOTMsIDEuMDkxOTMsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLlNlZ29ldWlCb2xkRmFjdG9ycyA9IFNlZ29ldWlCb2xkRmFjdG9yczsKY29uc3QgU2Vnb2V1aUJvbGRNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMzMwMDgsCiAgbGluZUdhcDogMAp9OwpleHBvcnRzLlNlZ29ldWlCb2xkTWV0cmljcyA9IFNlZ29ldWlCb2xkTWV0cmljczsKY29uc3QgU2Vnb2V1aUJvbGRJdGFsaWNGYWN0b3JzID0gWzEuNzY3MzgsIDEsIDEsIDAuOTg5NDYsIDEuMDM5NTksIDEuMDQwMTYsIDEuMDI4MDksIDEuMDM2LCAwLjk3NjM5LCAxLjEwOTUzLCAxLjIzMjAzLCAxLjExMTQ0LCAxLjExMTQ0LCAxLjE2OTM5LCAxLjIxMjM3LCAwLjk3NTQsIDEuMjEyNjEsIDAuOTc1NCwgMS41OTc1NCwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMS4wMzYsIDEuMDM2LCAxLjAzNiwgMS4wMzYsIDAuODEzNzgsIDAuODEzNzgsIDEuMjEyMzcsIDEuMjEyMzcsIDEuMjEyMzcsIDAuNzM1NDEsIDAuOTc4NDcsIDAuOTczNjMsIDAuODk3MjMsIDAuODc4OTcsIDEuMDQyNiwgMC43OTQyOSwgMC44NTI5MiwgMC45MTE0OSwgMS4wNTgxNSwgMS4xNDA2LCAwLjc5NjMxLCAwLjkwMTI4LCAwLjgzODUzLCAxLjA0Mzk2LCAxLjEwNjE1LCAwLjk3NTUyLCAwLjk0NDM2LCAwLjk3NTUyLCAwLjg4NjQxLCAwLjgwNTI3LCAwLjk2MDgzLCAxLjAwMTM1LCAxLCAxLjA2Nzc3LCAwLjk4MTcsIDAuOTExNDIsIDAuOTkzNjEsIDEuMTExNDQsIDEuNTcyOTMsIDEuMTExNDQsIDEuMjEyMzcsIDAuNzQ2MjcsIDEuMzE4MTgsIDEuMDY1ODUsIDAuOTcwNDIsIDAuODMwNTUsIDAuOTcwNDIsIDAuOTM1MDMsIDEuMTI2MSwgMC45NzA0MiwgMC45NzkyMiwgMS4xNDIzNiwgMC45NDU1MiwgMS4wMTA1NCwgMS4xNDIzNiwgMS4wMjQ3MSwgMC45NzkyMiwgMC45NDE2NSwgMC45NzA0MiwgMC45NzA0MiwgMS4wMjc2LCAwLjc4OTI5LCAxLjEyNjEsIDAuOTc5MjIsIDAuOTU4NzQsIDEuMDIxOTcsIDAuOTg1MDcsIDAuOTY3NTIsIDAuOTcxNjgsIDAuOTUxMDcsIDEuMTY1NzksIDAuOTUxMDcsIDEuMjEyMzcsIDEuMDM5NTksIDEuMDM2LCAxLjAzNiwgMSwgMS4wMzYsIDEuMTY1NzksIDAuODczNTcsIDEuMzE4MTgsIDEuMTg3NTQsIDEuMjY3ODEsIDEuMDUzNTYsIDEuMjEyMzcsIDEuMTg2MjIsIDAuNzk0ODcsIDAuOTQ5OTQsIDEuMjkwMDQsIDEuMjQwNDcsIDEuMjQwNDcsIDEuMzE4MTgsIDEsIDAuOTE0ODQsIDAuOTc1NCwgMS4zMTgxOCwgMS4xMzQ5LCAxLjI0ODY2LCAxLjA1MzU2LCAxLjEzOTM0LCAxLjE1NTc0LCAxLjE3Mzg5LCAwLjczNTQxLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk3MzYzLCAwLjk0Mzg1LCAwLjg3ODk3LCAwLjc5NDI5LCAwLjc5NDI5LCAwLjc5NDI5LCAwLjc5NDI5LCAxLjE0MDYsIDEuMTQwNiwgMS4xNDA2LCAxLjE0MDYsIDEuMDQyNiwgMS4xMDYxNSwgMC45NzU1MiwgMC45NzU1MiwgMC45NzU1MiwgMC45NzU1MiwgMC45NzU1MiwgMS4yMTIzNywgMC45NzU1MiwgMS4wMDEzNSwgMS4wMDEzNSwgMS4wMDEzNSwgMS4wMDEzNSwgMC45MTE0MiwgMC45NDQzNiwgMC45ODcyMSwgMS4wNjU4NSwgMS4wNjU4NSwgMS4wNjU4NSwgMS4wNjU4NSwgMS4wNjU4NSwgMS4wNjU4NSwgMC45NjcwNSwgMC44MzA1NSwgMC45MzUwMywgMC45MzUwMywgMC45MzUwMywgMC45MzUwMywgMS4xNDIzNiwgMS4xNDIzNiwgMS4xNDIzNiwgMS4xNDIzNiwgMC45MzEyNSwgMC45NzkyMiwgMC45NDE2NSwgMC45NDE2NSwgMC45NDE2NSwgMC45NDE2NSwgMC45NDE2NSwgMS4yOTAwNCwgMC45NDE2NSwgMC45NzkyMiwgMC45NzkyMiwgMC45NzkyMiwgMC45NzkyMiwgMC45Njc1MiwgMC45NzA0MiwgMC45Njc1MiwgMC45NzM2MywgMS4wNjU4NSwgMC45NzM2MywgMS4wNjU4NSwgMC45NzM2MywgMS4wNjU4NSwgMC44Nzg5NywgMC44MzA1NSwgMC44Nzg5NywgMC44MzA1NSwgMC44Nzg5NywgMC44MzA1NSwgMC44Nzg5NywgMC44MzA1NSwgMS4wNDI2LCAxLjAwMzMsIDEuMDQyNiwgMC45NzA0MiwgMC43OTQyOSwgMC45MzUwMywgMC43OTQyOSwgMC45MzUwMywgMC43OTQyOSwgMC45MzUwMywgMC43OTQyOSwgMC45MzUwMywgMC43OTQyOSwgMC45MzUwMywgMC45MTE0OSwgMC45NzA0MiwgMC45MTE0OSwgMC45NzA0MiwgMC45MTE0OSwgMC45NzA0MiwgMSwgMSwgMS4wNTgxNSwgMC45NzkyMiwgMS4wNTgxNSwgMC45NzkyMiwgMS4xNDA2LCAxLjE0MjM2LCAxLjE0MDYsIDEuMTQyMzYsIDEuMTQwNiwgMS4xNDIzNiwgMS4xNDA2LCAxLjE0MjM2LCAxLjE0MDYsIDEuMTQyMzYsIDAuOTc0NDEsIDEuMDQzMDIsIDAuNzk2MzEsIDEuMDE1ODIsIDEsIDEsIDEuMDEwNTQsIDAuODM4NTMsIDEuMTQyMzYsIDEsIDEsIDAuODM4NTMsIDEuMDkxMjUsIDAuODM4NTMsIDAuOTA0MTgsIDAuODM4NTMsIDEuMTk1MDgsIDEuMTA2MTUsIDAuOTc5MjIsIDEsIDEsIDEuMTA2MTUsIDAuOTc5MjIsIDEuMDEwMzQsIDEuMTA0NjYsIDAuOTc5MjIsIDAuOTc1NTIsIDAuOTQxNjUsIDAuOTc1NTIsIDAuOTQxNjUsIDAuOTc1NTIsIDAuOTQxNjUsIDAuOTE2MDIsIDAuOTE5ODEsIDAuODg2NDEsIDEuMDI3NiwgMSwgMSwgMC44ODY0MSwgMS4wMjc2LCAwLjgwNTI3LCAwLjc4OTI5LCAwLjgwNTI3LCAwLjc4OTI5LCAwLjgwNTI3LCAwLjc4OTI5LCAwLjgwNTI3LCAwLjc4OTI5LCAxLCAxLCAwLjk2MDgzLCAxLjA1NDAzLCAwLjk1OTIzLCAxLjE2ODYyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjAwMTM1LCAwLjk3OTIyLCAxLjA2Nzc3LCAxLjAyMTk3LCAwLjkxMTQyLCAwLjk2NzUyLCAwLjkxMTQyLCAwLjk5MzYxLCAwLjk3MTY4LCAwLjk5MzYxLCAwLjk3MTY4LCAwLjk5MzYxLCAwLjk3MTY4LCAxLjIzMTk5LCAxLjAzNiwgMC45NzM2MywgMS4wNjU4NSwgMC45NDM4NSwgMC45NjcwNSwgMC45NzU1MiwgMC45NDE2NSwgMSwgMSwgMC45NjA4MywgMS4xMjYxLCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAxLjMxODE4LCAwLjk1MTYxLCAxLjI3MTI2LCAxLjAwODExLCAwLjgzMjg0LCAwLjc3NzAyLCAwLjk5MTM3LCAwLjk1MjUzLCAxLjAzNDcsIDAuODYxNDIsIDEuMDcyMDUsIDEuMTQyMzYsIDAuOTczNjMsIDAuODk3MjMsIDAuODY4NjksIDEuMDk4MTgsIDAuNzk0MjksIDAuOTkzNjEsIDEuMDU4MTUsIDAuOTc1NTIsIDEuMTQwNiwgMC45MDEyOCwgMS4wNjY2MiwgMS4wNDM5NiwgMS4xMDYxNSwgMC44NDkxOCwgMC45NzU1MiwgMS4wNDY5NCwgMC45NDQzNiwgMC45ODAxNSwgMC45NjA4MywgMC45MTE0MiwgMS4wMDM1NiwgMC45ODE3LCAxLjAxOTQ1LCAwLjk4OTk5LCAxLjE0MDYsIDAuOTExNDIsIDEuMDQ5NjEsIDAuOTg5OCwgMS4wMDYzOSwgMS4xNDIzNiwgMS4wNzUxNCwgMS4wNDk2MSwgMC45OTYwNywgMS4wMjg5NywgMS4wMDgsIDAuOTg5OCwgMC45NTEzNCwgMS4wMDYzOSwgMS4xMTEyMSwgMS4xNDIzNiwgMS4wMDUxOCwgMC45Nzk4MSwgMS4wMjE4NiwgMSwgMS4wODU3OCwgMC45NDE2NSwgMC45OTMxNCwgMC45ODM4NywgMC45MzAyOCwgMC45MzM3NywgMS4zNTEyNSwgMS4wNzUxNCwgMS4xMDY4NywgMC45MzQ5MSwgMS4wNDIzMiwgMS4wMDM1MSwgMS4xNDIzNiwgMS4wNzUxNCwgMC45NDE2NSwgMS4wNzUxNCwgMS4wMDM1MSwgMC43OTQyOSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wOTA5NywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45MzUwMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45NjYwOSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wNjc3NywgMS4wMjE5NywgMS4wNjc3NywgMS4wMjE5NywgMS4wNjc3NywgMS4wMjE5NywgMC45MTE0MiwgMC45Njc1MiwgMSwgMS4yMTI2MSwgMC44OTkwMywgMSwgMSwgMC43NTE1NSwgMS4wNDc0NSwgMS4wNDc0NSwgMS4wNDc0NSwgMS4wNDM5NCwgMC45ODYzMywgMC45ODYzMywgMC45ODYzMywgMC43Mjk1OSwgMC43Mjk1OSwgMS4yMDUwMiwgMC45MTQwNiwgMS4yNjUxNCwgMS4yMjIsIDEuMDI5NTYsIDEuMDMzNzIsIDEuMDMzNzIsIDAuOTYwMzksIDEuMjQ2MzMsIDEsIDEuMDkxMjUsIDAuOTMzMjcsIDEuMDMzMzYsIDEuMTY1NDEsIDEuMDM2LCAxLCAxLCAxLCAwLjc3MSwgMSwgMSwgMS4xNTU3NCwgMS4xNTU3NCwgMS4xNTU3NCwgMS4xNTU3NCwgMC44NjM2NCwgMC45NDQzNCwgMC44NjI3OSwgMC45NDQzNCwgMC44NjIyNCwgMSwgMSwgMS4xNjc5OCwgMSwgMC45NjA4NSwgMC45MDA2OCwgMS4yMTIzNywgMS4xODQxNiwgMS4xMzkwNCwgMC42OTgyNSwgMC45NzE2LCAyLjEwMzM5LCAxLjI5MDA0LCAxLjI5MDA0LCAxLjIxMzM5LCAxLjI5MDA0LCAxLjI5MDA0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjQyNjAzLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAxLjE4Nzc1LCAxLjQyNjAzLCAxLCAxLjQyNjAzLCAxLjQyNjAzLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjI4ODYsIDEuMDQzMTUsIDEuMTUyOTYsIDEuMzQxNjMsIDEsIDEsIDEsIDEuMTMyNjksIDEuMTMyNjksIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLlNlZ29ldWlCb2xkSXRhbGljRmFjdG9ycyA9IFNlZ29ldWlCb2xkSXRhbGljRmFjdG9yczsKY29uc3QgU2Vnb2V1aUJvbGRJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMzMwMDgsCiAgbGluZUdhcDogMAp9OwpleHBvcnRzLlNlZ29ldWlCb2xkSXRhbGljTWV0cmljcyA9IFNlZ29ldWlCb2xkSXRhbGljTWV0cmljczsKY29uc3QgU2Vnb2V1aUl0YWxpY0ZhY3RvcnMgPSBbMS43NjczOCwgMSwgMSwgMC45ODk0NiwgMS4xNDc2MywgMS4wNTM2NSwgMS4wNjIzNCwgMC45NjkyNywgMC45MjU4NiwgMS4xNTM3MywgMS4xODQxNCwgMC45MTM0OSwgMC45MTM0OSwgMS4wNzQwMywgMS4xNzMwOCwgMC43ODM4MywgMS4yMDA4OCwgMC43ODM4MywgMS40MjUzMSwgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC43ODM4MywgMC43ODM4MywgMS4xNzMwOCwgMS4xNzMwOCwgMS4xNzMwOCwgMC43NzM0OSwgMC45NDU2NSwgMC45NDcyOSwgMC44NTk0NCwgMC44ODUwNiwgMC45ODU4LCAwLjc0ODE3LCAwLjgwMDE2LCAwLjg4NDQ5LCAwLjk4MDM5LCAwLjk1NzgyLCAwLjY5MjM4LCAwLjg5ODk4LCAwLjgzMjMxLCAwLjk4MTgzLCAxLjAzOTg5LCAwLjk2OTI0LCAwLjg2MjM3LCAwLjk2OTI0LCAwLjgwNTk1LCAwLjc0NTI0LCAwLjg2MDkxLCAwLjk1NDAyLCAwLjk0MTQzLCAwLjk4NDQ4LCAwLjg4NTgsIDAuODMwODksIDAuOTMyODUsIDEuMDk0OSwgMS4zOTAxNiwgMS4wOTQ5LCAxLjQ1OTk0LCAwLjc0NjI3LCAxLjA0ODM5LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjg3MjA3LCAwLjk3NDU0LCAwLjg3NTMzLCAxLjA2MTUxLCAwLjk3NDU0LCAxLjAwMTc2LCAxLjE2NDg0LCAxLjA4MTMyLCAwLjk4MDQ3LCAxLjE2NDg0LCAxLjAyOTg5LCAxLjAxMDU0LCAwLjk2MjI1LCAwLjk3NDU0LCAwLjk3NDU0LCAxLjA2NTk4LCAwLjc5MDA0LCAxLjE2MzQ0LCAxLjAwMzUxLCAwLjk0NjI5LCAwLjk5NzMsIDAuOTEwMTYsIDAuOTY3NzcsIDAuOTA0MywgMC45MTA4MiwgMC45MjQ4MSwgMC45MTA4MiwgMS4xNzMwOCwgMC45NTc0OCwgMC45NjkyNywgMC45NjkyNywgMSwgMC45NjkyNywgMC45MjQ4MSwgMC44MDU5NywgMS4wNDgzOSwgMS4yMzM5MywgMS4xNzgxLCAwLjkyNDUsIDEuMTczMDgsIDEuMjA4MDgsIDAuNjMyMTgsIDAuOTQyNjEsIDEuMjQ4MjIsIDEuMDk5NzEsIDEuMDk5NzEsIDEuMDQ4MzksIDEsIDAuODUyNzMsIDAuNzgwMzIsIDEuMDQ4MzksIDEuMDk5NzEsIDEuMjIzMjYsIDAuOTI0NSwgMS4wOTgzNiwgMS4xMzUyNSwgMS4xNTIyMiwgMC43MDQyNCwgMC45NDcyOSwgMC45NDcyOSwgMC45NDcyOSwgMC45NDcyOSwgMC45NDcyOSwgMC45NDcyOSwgMC44NTQ5OCwgMC44ODUwNiwgMC43NDgxNywgMC43NDgxNywgMC43NDgxNywgMC43NDgxNywgMC45NTc4MiwgMC45NTc4MiwgMC45NTc4MiwgMC45NTc4MiwgMC45ODU4LCAxLjAzOTg5LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAxLjE3MzA4LCAwLjk2OTI0LCAwLjk1NDAyLCAwLjk1NDAyLCAwLjk1NDAyLCAwLjk1NDAyLCAwLjgzMDg5LCAwLjg2MjM3LCAwLjg4NDA5LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjk3NDU0LCAwLjkyOTE2LCAwLjg3MjA3LCAwLjg3NTMzLCAwLjg3NTMzLCAwLjg3NTMzLCAwLjg3NTMzLCAwLjkzMTQ2LCAwLjkzMTQ2LCAwLjkzMTQ2LCAwLjkzMTQ2LCAwLjkzODU0LCAxLjAxMDU0LCAwLjk2MjI1LCAwLjk2MjI1LCAwLjk2MjI1LCAwLjk2MjI1LCAwLjk2MjI1LCAxLjI0ODIyLCAwLjg3NjEsIDEuMDAzNTEsIDEuMDAzNTEsIDEuMDAzNTEsIDEuMDAzNTEsIDAuOTY3NzcsIDAuOTc0NTQsIDAuOTY3NzcsIDAuOTQ3MjksIDAuOTc0NTQsIDAuOTQ3MjksIDAuOTc0NTQsIDAuOTQ3MjksIDAuOTc0NTQsIDAuODg1MDYsIDAuODcyMDcsIDAuODg1MDYsIDAuODcyMDcsIDAuODg1MDYsIDAuODcyMDcsIDAuODg1MDYsIDAuODcyMDcsIDAuOTg1OCwgMC45NTM5MSwgMC45ODU4LCAwLjk3NDU0LCAwLjc0ODE3LCAwLjg3NTMzLCAwLjc0ODE3LCAwLjg3NTMzLCAwLjc0ODE3LCAwLjg3NTMzLCAwLjc0ODE3LCAwLjg3NTMzLCAwLjc0ODE3LCAwLjg3NTMzLCAwLjg4NDQ5LCAwLjk3NDU0LCAwLjg4NDQ5LCAwLjk3NDU0LCAwLjg4NDQ5LCAwLjk3NDU0LCAxLCAxLCAwLjk4MDM5LCAxLjAwMTc2LCAwLjk4MDM5LCAxLjAwMTc2LCAwLjk1NzgyLCAwLjkzMTQ2LCAwLjk1NzgyLCAwLjkzMTQ2LCAwLjk1NzgyLCAwLjkzMTQ2LCAwLjk1NzgyLCAxLjE2NDg0LCAwLjk1NzgyLCAwLjkzMTQ2LCAwLjg0NDIxLCAxLjEyNzYxLCAwLjY5MjM4LCAxLjA4MTMyLCAxLCAxLCAwLjk4MDQ3LCAwLjgzMjMxLCAxLjE2NDg0LCAxLCAxLCAwLjg0NzIzLCAxLjA0ODYxLCAwLjg0NzIzLCAwLjc4NzU1LCAwLjgzMjMxLCAxLjIzNzM2LCAxLjAzOTg5LCAxLjAxMDU0LCAxLCAxLCAxLjAzOTg5LCAxLjAxMDU0LCAwLjk4NTcsIDEuMDM4NDksIDEuMDEwNTQsIDAuOTY5MjQsIDAuOTYyMjUsIDAuOTY5MjQsIDAuOTYyMjUsIDAuOTY5MjQsIDAuOTYyMjUsIDAuOTIzODMsIDAuOTAxNzEsIDAuODA1OTUsIDEuMDY1OTgsIDEsIDEsIDAuODA1OTUsIDEuMDY1OTgsIDAuNzQ1MjQsIDAuNzkwMDQsIDAuNzQ1MjQsIDAuNzkwMDQsIDAuNzQ1MjQsIDAuNzkwMDQsIDAuNzQ1MjQsIDAuNzkwMDQsIDEsIDEsIDAuODYwOTEsIDEuMDI3NTksIDAuODU3NzEsIDEuMTYzNDQsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTU0MDIsIDEuMDAzNTEsIDAuOTg0NDgsIDAuOTk3MywgMC44MzA4OSwgMC45Njc3NywgMC44MzA4OSwgMC45MzI4NSwgMC45MDQzLCAwLjkzMjg1LCAwLjkwNDMsIDAuOTMyODUsIDAuOTA0MywgMS4zMTg2OCwgMC45NjkyNywgMC45NDcyOSwgMC45NzQ1NCwgMC44NTQ5OCwgMC45MjkxNiwgMC45NjkyNCwgMC44NzYxLCAxLCAxLCAwLjg2MDkxLCAxLjE2MzQ0LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAxLjA0ODM5LCAwLjgxOTY1LCAwLjgxOTY1LCAwLjk0NzI5LCAwLjc4MDMyLCAwLjcxMDIyLCAwLjkwODgzLCAwLjg0MTcxLCAwLjk5ODc3LCAwLjc3NTk2LCAxLjA1NzM0LCAxLjIsIDAuOTQ3MjksIDAuODU5NDQsIDAuODI3OTEsIDAuOTYwNywgMC43NDgxNywgMC45MzI4NSwgMC45ODAzOSwgMC45NjkyNCwgMC45NTc4MiwgMC44OTg5OCwgMC45ODMxNiwgMC45ODE4MywgMS4wMzk4OSwgMC43ODYxNCwgMC45NjkyNCwgMC45NzY0MiwgMC44NjIzNywgMC44NjA3NSwgMC44NjA5MSwgMC44MzA4OSwgMC45MDA4MiwgMC44ODU4LCAwLjk3Mjk2LCAxLjAxMjg0LCAwLjk1NzgyLCAwLjgzMDg5LCAxLjA5NzYsIDEuMDQsIDEuMDMzNDIsIDEuMiwgMS4wNjc1LCAxLjA5NzYsIDAuOTgyMDUsIDEuMDM4MDksIDEuMDUwOTcsIDEuMDQsIDAuOTUzNjQsIDEuMDMzNDIsIDEuMDU0MDEsIDEuMiwgMS4wMjE0OCwgMS4wMTE5LCAxLjA0NzI0LCAxLjAxMjcsIDEuMDI3MzIsIDAuOTYyMjUsIDAuODk2NSwgMC45Nzc4MywgMC45MzU3NCwgMC45NDgxOCwgMS4zMDY3OSwgMS4wNjc1LCAxLjExODI2LCAwLjk5ODIxLCAxLjA1NTcsIDEuMDMyNiwgMS4yLCAxLjA2NzUsIDAuOTYyMjUsIDEuMDY3NSwgMS4wMzI2LCAwLjc0ODE3LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjAzNzU0LCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjg3NTMzLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk4NzA1LCAxLCAxLCAxLCAxLCAxLCAxLCAwLjk4NDQ4LCAwLjk5NzMsIDAuOTg0NDgsIDAuOTk3MywgMC45ODQ0OCwgMC45OTczLCAwLjgzMDg5LCAwLjk2Nzc3LCAxLCAxLjIwMDg4LCAwLjg5OTAzLCAxLCAxLCAwLjc1MTU1LCAwLjk0OTQ1LCAwLjk0OTQ1LCAwLjk0OTQ1LCAwLjk0OTQ1LCAxLjEyMzE3LCAxLjEyMzE3LCAxLjEyMzE3LCAwLjY3NjAzLCAwLjY3NjAzLCAxLjE1NjIxLCAwLjczNTg0LCAxLjIxMTkxLCAxLjIyMTM1LCAxLjA2NDgzLCAwLjk0ODY4LCAwLjk0ODY4LCAwLjk1OTk2LCAxLjI0NjMzLCAxLCAxLjA3NDk3LCAwLjg3NzA5LCAwLjk2OTI3LCAxLjAxNDczLCAwLjk2OTI3LCAxLCAxLCAxLCAwLjc3Mjk1LCAxLCAxLCAxLjA5ODM2LCAxLjA5ODM2LCAxLjA5ODM2LCAxLjAxNTIyLCAwLjg2MzIxLCAwLjk0NDM0LCAwLjg2NDksIDAuOTQ0MzQsIDAuODYxODIsIDEsIDEsIDEuMDgzLCAxLCAwLjkxNTc4LCAwLjg2NDM4LCAxLjE3MzA4LCAxLjE4NDE2LCAxLjE0NTg5LCAwLjY5ODI1LCAwLjk3NjIyLCAxLjk2NzkxLCAxLjI0ODIyLCAxLjI0ODIyLCAxLjE3MzA4LCAxLjI0ODIyLCAxLjI0ODIyLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLCAxLjQyNjAzLCAxLCAwLjk5ODYyLCAwLjk5ODYyLCAxLCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAwLjg3MDI1LCAxLjE3OTg0LCAxLjQyNjAzLCAxLCAxLjQyNjAzLCAxLjQyNjAzLCAwLjk5ODYyLCAxLCAxLCAxLCAxLCAxLCAxLjI4ODYsIDEuMDQzMTUsIDEuMTUyOTYsIDEuMzQxNjMsIDEsIDEsIDEsIDEuMTA3NDIsIDEuMTA3NDIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdOwpleHBvcnRzLlNlZ29ldWlJdGFsaWNGYWN0b3JzID0gU2Vnb2V1aUl0YWxpY0ZhY3RvcnM7CmNvbnN0IFNlZ29ldWlJdGFsaWNNZXRyaWNzID0gewogIGxpbmVIZWlnaHQ6IDEuMzMwMDgsCiAgbGluZUdhcDogMAp9OwpleHBvcnRzLlNlZ29ldWlJdGFsaWNNZXRyaWNzID0gU2Vnb2V1aUl0YWxpY01ldHJpY3M7CmNvbnN0IFNlZ29ldWlSZWd1bGFyRmFjdG9ycyA9IFsxLjc2NzM4LCAxLCAxLCAwLjk4NTk0LCAxLjAyMjg1LCAxLjEwNDU0LCAxLjA2MjM0LCAwLjk2OTI3LCAwLjkyMDM3LCAxLjE5OTg1LCAxLjIwNDYsIDAuOTA2MTYsIDAuOTA2MTYsIDEuMDcxNTIsIDEuMTcxNCwgMC43ODAzMiwgMS4yMDA4OCwgMC43ODAzMiwgMS40MDI0NiwgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC45NjkyNywgMC43ODAzMiwgMC43ODAzMiwgMS4xNzE0LCAxLjE3MTQsIDEuMTcxNCwgMC44MDU5NywgMC45NDA4NCwgMC45NjcwNiwgMC44NTk0NCwgMC44NTczNCwgMC45NzA5MywgMC43NTg0MiwgMC43OTkzNiwgMC44ODE5OCwgMC45ODMxLCAwLjk1NzgyLCAwLjcxMzg3LCAwLjg2OTY5LCAwLjg0NjM2LCAxLjA3Nzk2LCAxLjAzNTg0LCAwLjk2OTI0LCAwLjgzOTY4LCAwLjk2OTI0LCAwLjgyODI2LCAwLjc5NjQ5LCAwLjg1NzcxLCAwLjk1MTMyLCAwLjkzMTE5LCAwLjk4OTY1LCAwLjg4NDMzLCAwLjgyODcsIDAuOTMzNjUsIDEuMDg2MTIsIDEuMzYzOCwgMS4wODYxMiwgMS40NTc4NiwgMC43NDYyNywgMC44MDQ5OSwgMC45MTQ4NCwgMS4wNTcwNywgMC45MjM4MywgMS4wNTg4MiwgMC45NDAzLCAxLjEyNjU0LCAxLjA1ODgyLCAxLjAxNzU2LCAxLjA5MDExLCAxLjA5MDExLCAwLjk5NDE0LCAxLjA5MDExLCAxLjAzNCwgMS4wMTc1NiwgMS4wNTM1NiwgMS4wNTcwNywgMS4wNTg4MiwgMS4wNDM5OSwgMC44NDg2MywgMS4yMTk2OCwgMS4wMTc1NiwgMC45NTgwMSwgMS4wMDA2OCwgMC45MTc5NywgMC45Njc3NywgMC45MDQzLCAwLjkwMzUxLCAwLjkyMTA1LCAwLjkwMzUxLCAxLjE3MTQsIDAuODUzMzcsIDAuOTY5MjcsIDAuOTY5MjcsIDAuOTk5MTIsIDAuOTY5MjcsIDAuOTIxMDUsIDAuODA1OTcsIDEuMjQzNCwgMS4yMDgwOCwgMS4wNTkzNywgMC45MDk1NywgMS4xNzE0LCAxLjIwODA4LCAwLjc1MTU1LCAwLjk0MjYxLCAxLjI0NjQ0LCAxLjA5OTcxLCAxLjA5OTcxLCAwLjg0NzUxLCAxLCAwLjg1MjczLCAwLjc4MDMyLCAwLjYxNTg0LCAxLjA1NDI1LCAxLjE3OTE0LCAwLjkwOTU3LCAxLjA4NjY1LCAxLjExNTkzLCAxLjE0MTY5LCAwLjczMzgxLCAwLjk2NzA2LCAwLjk2NzA2LCAwLjk2NzA2LCAwLjk2NzA2LCAwLjk2NzA2LCAwLjk2NzA2LCAwLjg2MDM1LCAwLjg1NzM0LCAwLjc1ODQyLCAwLjc1ODQyLCAwLjc1ODQyLCAwLjc1ODQyLCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk1NzgyLCAwLjk3MDkzLCAxLjAzNTg0LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAwLjk2OTI0LCAxLjE3MTQsIDAuOTY5MjQsIDAuOTUxMzIsIDAuOTUxMzIsIDAuOTUxMzIsIDAuOTUxMzIsIDAuODI4NywgMC44Mzk2OCwgMC44OTA0OSwgMC45MTQ4NCwgMC45MTQ4NCwgMC45MTQ4NCwgMC45MTQ4NCwgMC45MTQ4NCwgMC45MTQ4NCwgMC45MzU3NSwgMC45MjM4MywgMC45NDAzLCAwLjk0MDMsIDAuOTQwMywgMC45NDAzLCAwLjg3MTcsIDAuODcxNywgMC44NzE3LCAwLjg3MTcsIDEuMDA1MjcsIDEuMDE3NTYsIDEuMDUzNTYsIDEuMDUzNTYsIDEuMDUzNTYsIDEuMDUzNTYsIDEuMDUzNTYsIDEuMjQ2NDQsIDAuOTU5MjMsIDEuMDE3NTYsIDEuMDE3NTYsIDEuMDE3NTYsIDEuMDE3NTYsIDAuOTY3NzcsIDEuMDU3MDcsIDAuOTY3NzcsIDAuOTY3MDYsIDAuOTE0ODQsIDAuOTY3MDYsIDAuOTE0ODQsIDAuOTY3MDYsIDAuOTE0ODQsIDAuODU3MzQsIDAuOTIzODMsIDAuODU3MzQsIDAuOTIzODMsIDAuODU3MzQsIDAuOTIzODMsIDAuODU3MzQsIDAuOTIzODMsIDAuOTcwOTMsIDEuMDk2OSwgMC45NzA5MywgMS4wNTg4MiwgMC43NTg0MiwgMC45NDAzLCAwLjc1ODQyLCAwLjk0MDMsIDAuNzU4NDIsIDAuOTQwMywgMC43NTg0MiwgMC45NDAzLCAwLjc1ODQyLCAwLjk0MDMsIDAuODgxOTgsIDEuMDU4ODIsIDAuODgxOTgsIDEuMDU4ODIsIDAuODgxOTgsIDEuMDU4ODIsIDEsIDEsIDAuOTgzMSwgMS4wMTc1NiwgMC45ODMxLCAxLjAxNzU2LCAwLjk1NzgyLCAwLjg3MTcsIDAuOTU3ODIsIDAuODcxNywgMC45NTc4MiwgMC44NzE3LCAwLjk1NzgyLCAxLjA5MDExLCAwLjk1NzgyLCAwLjg3MTcsIDAuODQ3ODQsIDEuMTE1NTEsIDAuNzEzODcsIDEuMDkwMTEsIDEsIDEsIDAuOTk0MTQsIDAuODQ2MzYsIDEuMDkwMTEsIDEsIDEsIDAuODQ2MzYsIDEuMDUzNiwgMC44NDYzNiwgMC45NDI5OCwgMC44NDYzNiwgMS4yMzI5NywgMS4wMzU4NCwgMS4wMTc1NiwgMSwgMSwgMS4wMzU4NCwgMS4wMTc1NiwgMS4wMDMyMywgMS4wMzQ0NCwgMS4wMTc1NiwgMC45NjkyNCwgMS4wNTM1NiwgMC45NjkyNCwgMS4wNTM1NiwgMC45NjkyNCwgMS4wNTM1NiwgMC45MzA2NiwgMC45ODI5MywgMC44MjgyNiwgMS4wNDM5OSwgMSwgMSwgMC44MjgyNiwgMS4wNDM5OSwgMC43OTY0OSwgMC44NDg2MywgMC43OTY0OSwgMC44NDg2MywgMC43OTY0OSwgMC44NDg2MywgMC43OTY0OSwgMC44NDg2MywgMSwgMSwgMC44NTc3MSwgMS4xNzMxOCwgMC44NTc3MSwgMS4yMTk2OCwgMC45NTEzMiwgMS4wMTc1NiwgMC45NTEzMiwgMS4wMTc1NiwgMC45NTEzMiwgMS4wMTc1NiwgMC45NTEzMiwgMS4wMTc1NiwgMC45NTEzMiwgMS4wMTc1NiwgMC45NTEzMiwgMS4wMTc1NiwgMC45ODk2NSwgMS4wMDA2OCwgMC44Mjg3LCAwLjk2Nzc3LCAwLjgyODcsIDAuOTMzNjUsIDAuOTA0MywgMC45MzM2NSwgMC45MDQzLCAwLjkzMzY1LCAwLjkwNDMsIDEuMDg1NzEsIDAuOTY5MjcsIDAuOTY3MDYsIDAuOTE0ODQsIDAuODYwMzUsIDAuOTM1NzUsIDAuOTY5MjQsIDAuOTU5MjMsIDEsIDEsIDAuODU3NzEsIDEuMjE5NjgsIDEuMTE0MzcsIDEuMTE0MzcsIDAuOTMxMDksIDAuOTEyMDIsIDAuNjA0MTEsIDAuODQxNjQsIDAuNTU1NzIsIDEuMDExNzMsIDAuOTczNjEsIDAuODE4MTgsIDAuODE4MTgsIDAuOTY2MzUsIDAuNzgwMzIsIDAuNzI3MjcsIDAuOTIzNjYsIDAuOTg2MDEsIDEuMDM0MDUsIDAuNzc5NjgsIDEuMDk3OTksIDEuMiwgMC45NjcwNiwgMC44NTk0NCwgMC44NTYzOCwgMC45NjQ5MSwgMC43NTg0MiwgMC45MzM2NSwgMC45ODMxLCAwLjk2OTI0LCAwLjk1NzgyLCAwLjg2OTY5LCAwLjk0MTUyLCAxLjA3Nzk2LCAxLjAzNTg0LCAwLjc4NDM3LCAwLjk2OTI0LCAwLjk4NzE1LCAwLjgzOTY4LCAwLjgzNDkxLCAwLjg1NzcxLCAwLjgyODcsIDAuOTQ0OTIsIDAuODg0MzMsIDAuOTI4NywgMS4wMDk4LCAwLjk1NzgyLCAwLjgyODcsIDEuMDYyNSwgMC45ODI0OCwgMS4wMzQyNCwgMS4yLCAxLjAxMDcxLCAxLjA2MjUsIDAuOTUyNDYsIDEuMDM4MDksIDEuMDQ5MTIsIDAuOTgyNDgsIDEuMDAyMjEsIDEuMDM0MjQsIDEuMDU0NDMsIDEuMiwgMS4wNDc4NSwgMC45OTYwOSwgMS4wMDE2OSwgMS4wNTE3NiwgMC45OTM0NiwgMS4wNTM1NiwgMC45MDg3LCAxLjAzMDA0LCAwLjk1NTQyLCAwLjkzMTE3LCAxLjIzMzYyLCAxLjAxMDcxLCAxLjA3ODMxLCAxLjAyNTEyLCAxLjA1MjA1LCAxLjAzNTAyLCAxLjIsIDEuMDEwNzEsIDEuMDUzNTYsIDEuMDEwNzEsIDEuMDM1MDIsIDAuNzU4NDIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuMDM3MTksIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDAuOTQwMywgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMS4wNDAyMSwgMSwgMSwgMSwgMSwgMSwgMSwgMC45ODk2NSwgMS4wMDA2OCwgMC45ODk2NSwgMS4wMDA2OCwgMC45ODk2NSwgMS4wMDA2OCwgMC44Mjg3LCAwLjk2Nzc3LCAxLCAxLjIwMDg4LCAwLjg5OTAzLCAxLCAxLCAwLjc1MTU1LCAxLjAzMDc3LCAxLjAzMDc3LCAxLjAzMDc3LCAxLjAzMDc3LCAxLjEzMTk2LCAxLjEzMTk2LCAxLjEzMTk2LCAwLjY3NDI4LCAwLjY3NDI4LCAxLjE2MDM5LCAwLjczMjkxLCAxLjIwOTk2LCAxLjIyMTM1LCAxLjA2NDgzLCAwLjk0ODY4LCAwLjk0ODY4LCAwLjk1OTk2LCAxLjI0NjMzLCAxLCAxLjA3NDk3LCAwLjg3Nzk2LCAwLjk2OTI3LCAxLjAxNTE4LCAwLjk2OTI3LCAxLCAxLCAxLCAwLjc3Mjk1LCAxLCAxLCAxLjEwNTM5LCAxLjEwNTM5LCAxLjExMzU4LCAxLjA2OTY3LCAwLjg2Mjc5LCAwLjk0NDM0LCAwLjg2Mjc5LCAwLjk0NDM0LCAwLjg2MTgyLCAxLCAxLCAxLjA4MywgMSwgMC45MTU3OCwgMC44NjUwNywgMS4xNzE0LCAxLjE4NDE2LCAxLjE0NTg5LCAwLjY5ODI1LCAwLjk3NjIyLCAxLjk2OTcsIDEuMjQ4MjIsIDEuMjQ4MjIsIDEuMTcyMzgsIDEuMjQ4MjIsIDEuMjQ4MjIsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEuNDI2MDMsIDEsIDAuOTk4NjIsIDAuOTk4NjIsIDEsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDAuODcwMjUsIDEuMTgwODMsIDEuNDI2MDMsIDEsIDEuNDI2MDMsIDEuNDI2MDMsIDAuOTk4NjIsIDEsIDEsIDEsIDEsIDEsIDEuMjg4NiwgMS4wNDMxNSwgMS4xNTI5NiwgMS4zNDE2MywgMSwgMSwgMSwgMS4xMDkzOCwgMS4xMDkzOCwgMSwgMSwgMSwgMS4wNTQyNSwgMS4wOTk3MSwgMS4wOTk3MSwgMS4wOTk3MSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07CmV4cG9ydHMuU2Vnb2V1aVJlZ3VsYXJGYWN0b3JzID0gU2Vnb2V1aVJlZ3VsYXJGYWN0b3JzOwpjb25zdCBTZWdvZXVpUmVndWxhck1ldHJpY3MgPSB7CiAgbGluZUhlaWdodDogMS4zMzAwOCwKICBsaW5lR2FwOiAwCn07CmV4cG9ydHMuU2Vnb2V1aVJlZ3VsYXJNZXRyaWNzID0gU2Vnb2V1aVJlZ3VsYXJNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDU3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuUG9zdFNjcmlwdEV2YWx1YXRvciA9IGV4cG9ydHMuUG9zdFNjcmlwdENvbXBpbGVyID0gZXhwb3J0cy5QREZGdW5jdGlvbkZhY3RvcnkgPSB2b2lkIDA7CmV4cG9ydHMuaXNQREZGdW5jdGlvbiA9IGlzUERGRnVuY3Rpb247Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfcHNfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXyg1OCk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfaW1hZ2VfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU5KTsKCmNsYXNzIFBERkZ1bmN0aW9uRmFjdG9yeSB7CiAgY29uc3RydWN0b3IoewogICAgeHJlZiwKICAgIGlzRXZhbFN1cHBvcnRlZCA9IHRydWUKICB9KSB7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5pc0V2YWxTdXBwb3J0ZWQgPSBpc0V2YWxTdXBwb3J0ZWQgIT09IGZhbHNlOwogIH0KCiAgY3JlYXRlKGZuKSB7CiAgICBjb25zdCBjYWNoZWRGdW5jdGlvbiA9IHRoaXMuZ2V0Q2FjaGVkKGZuKTsKCiAgICBpZiAoY2FjaGVkRnVuY3Rpb24pIHsKICAgICAgcmV0dXJuIGNhY2hlZEZ1bmN0aW9uOwogICAgfQoKICAgIGNvbnN0IHBhcnNlZEZ1bmN0aW9uID0gUERGRnVuY3Rpb24ucGFyc2UoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZDogdGhpcy5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgIGZuOiBmbiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IHRoaXMueHJlZi5mZXRjaChmbikgOiBmbgogICAgfSk7CgogICAgdGhpcy5fY2FjaGUoZm4sIHBhcnNlZEZ1bmN0aW9uKTsKCiAgICByZXR1cm4gcGFyc2VkRnVuY3Rpb247CiAgfQoKICBjcmVhdGVGcm9tQXJyYXkoZm5PYmopIHsKICAgIGNvbnN0IGNhY2hlZEZ1bmN0aW9uID0gdGhpcy5nZXRDYWNoZWQoZm5PYmopOwoKICAgIGlmIChjYWNoZWRGdW5jdGlvbikgewogICAgICByZXR1cm4gY2FjaGVkRnVuY3Rpb247CiAgICB9CgogICAgY29uc3QgcGFyc2VkRnVuY3Rpb24gPSBQREZGdW5jdGlvbi5wYXJzZUFycmF5KHsKICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICBpc0V2YWxTdXBwb3J0ZWQ6IHRoaXMuaXNFdmFsU3VwcG9ydGVkLAogICAgICBmbk9iajogZm5PYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgPyB0aGlzLnhyZWYuZmV0Y2goZm5PYmopIDogZm5PYmoKICAgIH0pOwoKICAgIHRoaXMuX2NhY2hlKGZuT2JqLCBwYXJzZWRGdW5jdGlvbik7CgogICAgcmV0dXJuIHBhcnNlZEZ1bmN0aW9uOwogIH0KCiAgZ2V0Q2FjaGVkKGNhY2hlS2V5KSB7CiAgICBsZXQgZm5SZWY7CgogICAgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXk7CiAgICB9IGVsc2UgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBmblJlZiA9IGNhY2hlS2V5Lm9iaklkOwogICAgfSBlbHNlIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXkuZGljdCAmJiBjYWNoZUtleS5kaWN0Lm9iaklkOwogICAgfQoKICAgIGlmIChmblJlZikgewogICAgICBjb25zdCBsb2NhbEZ1bmN0aW9uID0gdGhpcy5fbG9jYWxGdW5jdGlvbkNhY2hlLmdldEJ5UmVmKGZuUmVmKTsKCiAgICAgIGlmIChsb2NhbEZ1bmN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGxvY2FsRnVuY3Rpb247CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIF9jYWNoZShjYWNoZUtleSwgcGFyc2VkRnVuY3Rpb24pIHsKICAgIGlmICghcGFyc2VkRnVuY3Rpb24pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdQREZGdW5jdGlvbkZhY3RvcnkuX2NhY2hlIC0gZXhwZWN0ZWQgInBhcnNlZEZ1bmN0aW9uIiBhcmd1bWVudC4nKTsKICAgIH0KCiAgICBsZXQgZm5SZWY7CgogICAgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXk7CiAgICB9IGVsc2UgaWYgKGNhY2hlS2V5IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBmblJlZiA9IGNhY2hlS2V5Lm9iaklkOwogICAgfSBlbHNlIGlmIChjYWNoZUtleSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICAgIGZuUmVmID0gY2FjaGVLZXkuZGljdCAmJiBjYWNoZUtleS5kaWN0Lm9iaklkOwogICAgfQoKICAgIGlmIChmblJlZikgewogICAgICB0aGlzLl9sb2NhbEZ1bmN0aW9uQ2FjaGUuc2V0KG51bGwsIGZuUmVmLCBwYXJzZWRGdW5jdGlvbik7CiAgICB9CiAgfQoKICBnZXQgX2xvY2FsRnVuY3Rpb25DYWNoZSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiX2xvY2FsRnVuY3Rpb25DYWNoZSIsIG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxGdW5jdGlvbkNhY2hlKCkpOwogIH0KCn0KCmV4cG9ydHMuUERGRnVuY3Rpb25GYWN0b3J5ID0gUERGRnVuY3Rpb25GYWN0b3J5OwoKZnVuY3Rpb24gdG9OdW1iZXJBcnJheShhcnIpIHsKICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBsZW5ndGggPSBhcnIubGVuZ3RoOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICBpZiAodHlwZW9mIGFycltpXSAhPT0gIm51bWJlciIpIHsKICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IEFycmF5KGxlbmd0aCk7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxlbmd0aDsgaisrKSB7CiAgICAgICAgcmVzdWx0W2pdID0gK2FycltqXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9CgogIHJldHVybiBhcnI7Cn0KCmNsYXNzIFBERkZ1bmN0aW9uIHsKICBzdGF0aWMgZ2V0U2FtcGxlQXJyYXkoc2l6ZSwgb3V0cHV0U2l6ZSwgYnBzLCBzdHJlYW0pIHsKICAgIGxldCBpLCBpaTsKICAgIGxldCBsZW5ndGggPSAxOwoKICAgIGZvciAoaSA9IDAsIGlpID0gc2l6ZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGxlbmd0aCAqPSBzaXplW2ldOwogICAgfQoKICAgIGxlbmd0aCAqPSBvdXRwdXRTaXplOwogICAgY29uc3QgYXJyYXkgPSBuZXcgQXJyYXkobGVuZ3RoKTsKICAgIGxldCBjb2RlU2l6ZSA9IDA7CiAgICBsZXQgY29kZUJ1ZiA9IDA7CiAgICBjb25zdCBzYW1wbGVNdWwgPSAxLjAgLyAoMi4wICoqIGJwcyAtIDEpOwogICAgY29uc3Qgc3RyQnl0ZXMgPSBzdHJlYW0uZ2V0Qnl0ZXMoKGxlbmd0aCAqIGJwcyArIDcpIC8gOCk7CiAgICBsZXQgc3RySWR4ID0gMDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgd2hpbGUgKGNvZGVTaXplIDwgYnBzKSB7CiAgICAgICAgY29kZUJ1ZiA8PD0gODsKICAgICAgICBjb2RlQnVmIHw9IHN0ckJ5dGVzW3N0cklkeCsrXTsKICAgICAgICBjb2RlU2l6ZSArPSA4OwogICAgICB9CgogICAgICBjb2RlU2l6ZSAtPSBicHM7CiAgICAgIGFycmF5W2ldID0gKGNvZGVCdWYgPj4gY29kZVNpemUpICogc2FtcGxlTXVsOwogICAgICBjb2RlQnVmICY9ICgxIDw8IGNvZGVTaXplKSAtIDE7CiAgICB9CgogICAgcmV0dXJuIGFycmF5OwogIH0KCiAgc3RhdGljIHBhcnNlKHsKICAgIHhyZWYsCiAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICBmbgogIH0pIHsKICAgIGNvbnN0IGRpY3QgPSBmbi5kaWN0IHx8IGZuOwogICAgY29uc3QgdHlwZU51bSA9IGRpY3QuZ2V0KCJGdW5jdGlvblR5cGUiKTsKCiAgICBzd2l0Y2ggKHR5cGVOdW0pIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFNhbXBsZWQoewogICAgICAgICAgeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGZuLAogICAgICAgICAgZGljdAogICAgICAgIH0pOwoKICAgICAgY2FzZSAxOgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdEludGVycG9sYXRlZCh7CiAgICAgICAgICB4cmVmLAogICAgICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgZGljdAogICAgICAgIH0pOwoKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFN0aWNoZWQoewogICAgICAgICAgeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGRpY3QKICAgICAgICB9KTsKCiAgICAgIGNhc2UgNDoKICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RQb3N0U2NyaXB0KHsKICAgICAgICAgIHhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiwKICAgICAgICAgIGRpY3QKICAgICAgICB9KTsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gdHlwZSBvZiBmdW5jdGlvbiIpOwogIH0KCiAgc3RhdGljIHBhcnNlQXJyYXkoewogICAgeHJlZiwKICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgIGZuT2JqCiAgfSkgewogICAgaWYgKCFBcnJheS5pc0FycmF5KGZuT2JqKSkgewogICAgICByZXR1cm4gdGhpcy5wYXJzZSh7CiAgICAgICAgeHJlZiwKICAgICAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgZm46IGZuT2JqCiAgICAgIH0pOwogICAgfQoKICAgIGNvbnN0IGZuQXJyYXkgPSBbXTsKCiAgICBmb3IgKGxldCBqID0gMCwgamogPSBmbk9iai5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgIGZuQXJyYXkucHVzaCh0aGlzLnBhcnNlKHsKICAgICAgICB4cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICBmbjogeHJlZi5mZXRjaElmUmVmKGZuT2JqW2pdKQogICAgICB9KSk7CiAgICB9CgogICAgcmV0dXJuIGZ1bmN0aW9uIChzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBmbkFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBmbkFycmF5W2ldKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0ICsgaSk7CiAgICAgIH0KICAgIH07CiAgfQoKICBzdGF0aWMgY29uc3RydWN0U2FtcGxlZCh7CiAgICB4cmVmLAogICAgaXNFdmFsU3VwcG9ydGVkLAogICAgZm4sCiAgICBkaWN0CiAgfSkgewogICAgZnVuY3Rpb24gdG9NdWx0aUFycmF5KGFycikgewogICAgICBjb25zdCBpbnB1dExlbmd0aCA9IGFyci5sZW5ndGg7CiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgb3V0W2luZGV4KytdID0gW2FycltpXSwgYXJyW2kgKyAxXV07CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXQ7CiAgICB9CgogICAgZnVuY3Rpb24gaW50ZXJwb2xhdGUoeCwgeG1pbiwgeG1heCwgeW1pbiwgeW1heCkgewogICAgICByZXR1cm4geW1pbiArICh4IC0geG1pbikgKiAoKHltYXggLSB5bWluKSAvICh4bWF4IC0geG1pbikpOwogICAgfQoKICAgIGxldCBkb21haW4gPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkRvbWFpbiIpKTsKICAgIGxldCByYW5nZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiUmFuZ2UiKSk7CgogICAgaWYgKCFkb21haW4gfHwgIXJhbmdlKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm8gZG9tYWluIG9yIHJhbmdlIik7CiAgICB9CgogICAgY29uc3QgaW5wdXRTaXplID0gZG9tYWluLmxlbmd0aCAvIDI7CiAgICBjb25zdCBvdXRwdXRTaXplID0gcmFuZ2UubGVuZ3RoIC8gMjsKICAgIGRvbWFpbiA9IHRvTXVsdGlBcnJheShkb21haW4pOwogICAgcmFuZ2UgPSB0b011bHRpQXJyYXkocmFuZ2UpOwogICAgY29uc3Qgc2l6ZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiU2l6ZSIpKTsKICAgIGNvbnN0IGJwcyA9IGRpY3QuZ2V0KCJCaXRzUGVyU2FtcGxlIik7CiAgICBjb25zdCBvcmRlciA9IGRpY3QuZ2V0KCJPcmRlciIpIHx8IDE7CgogICAgaWYgKG9yZGVyICE9PSAxKSB7CiAgICAgICgwLCBfdXRpbC5pbmZvKSgiTm8gc3VwcG9ydCBmb3IgY3ViaWMgc3BsaW5lIGludGVycG9sYXRpb246ICIgKyBvcmRlcik7CiAgICB9CgogICAgbGV0IGVuY29kZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRW5jb2RlIikpOwoKICAgIGlmICghZW5jb2RlKSB7CiAgICAgIGVuY29kZSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFNpemU7ICsraSkgewogICAgICAgIGVuY29kZS5wdXNoKFswLCBzaXplW2ldIC0gMV0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBlbmNvZGUgPSB0b011bHRpQXJyYXkoZW5jb2RlKTsKICAgIH0KCiAgICBsZXQgZGVjb2RlID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJEZWNvZGUiKSk7CgogICAgaWYgKCFkZWNvZGUpIHsKICAgICAgZGVjb2RlID0gcmFuZ2U7CiAgICB9IGVsc2UgewogICAgICBkZWNvZGUgPSB0b011bHRpQXJyYXkoZGVjb2RlKTsKICAgIH0KCiAgICBjb25zdCBzYW1wbGVzID0gdGhpcy5nZXRTYW1wbGVBcnJheShzaXplLCBvdXRwdXRTaXplLCBicHMsIGZuKTsKICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RTYW1wbGVkRm4oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgY29uc3QgY3ViZVZlcnRpY2VzID0gMSA8PCBpbnB1dFNpemU7CiAgICAgIGNvbnN0IGN1YmVOID0gbmV3IEZsb2F0NjRBcnJheShjdWJlVmVydGljZXMpOwogICAgICBjb25zdCBjdWJlVmVydGV4ID0gbmV3IFVpbnQzMkFycmF5KGN1YmVWZXJ0aWNlcyk7CiAgICAgIGxldCBpLCBqOwoKICAgICAgZm9yIChqID0gMDsgaiA8IGN1YmVWZXJ0aWNlczsgaisrKSB7CiAgICAgICAgY3ViZU5bal0gPSAxOwogICAgICB9CgogICAgICBsZXQgayA9IG91dHB1dFNpemUsCiAgICAgICAgICBwb3MgPSAxOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGlucHV0U2l6ZTsgKytpKSB7CiAgICAgICAgY29uc3QgZG9tYWluXzJpID0gZG9tYWluW2ldWzBdOwogICAgICAgIGNvbnN0IGRvbWFpbl8yaV8xID0gZG9tYWluW2ldWzFdOwogICAgICAgIGNvbnN0IHhpID0gTWF0aC5taW4oTWF0aC5tYXgoc3JjW3NyY09mZnNldCArIGldLCBkb21haW5fMmkpLCBkb21haW5fMmlfMSk7CiAgICAgICAgbGV0IGUgPSBpbnRlcnBvbGF0ZSh4aSwgZG9tYWluXzJpLCBkb21haW5fMmlfMSwgZW5jb2RlW2ldWzBdLCBlbmNvZGVbaV1bMV0pOwogICAgICAgIGNvbnN0IHNpemVfaSA9IHNpemVbaV07CiAgICAgICAgZSA9IE1hdGgubWluKE1hdGgubWF4KGUsIDApLCBzaXplX2kgLSAxKTsKICAgICAgICBjb25zdCBlMCA9IGUgPCBzaXplX2kgLSAxID8gTWF0aC5mbG9vcihlKSA6IGUgLSAxOwogICAgICAgIGNvbnN0IG4wID0gZTAgKyAxIC0gZTsKICAgICAgICBjb25zdCBuMSA9IGUgLSBlMDsKICAgICAgICBjb25zdCBvZmZzZXQwID0gZTAgKiBrOwogICAgICAgIGNvbnN0IG9mZnNldDEgPSBvZmZzZXQwICsgazsKCiAgICAgICAgZm9yIChqID0gMDsgaiA8IGN1YmVWZXJ0aWNlczsgaisrKSB7CiAgICAgICAgICBpZiAoaiAmIHBvcykgewogICAgICAgICAgICBjdWJlTltqXSAqPSBuMTsKICAgICAgICAgICAgY3ViZVZlcnRleFtqXSArPSBvZmZzZXQxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3ViZU5bal0gKj0gbjA7CiAgICAgICAgICAgIGN1YmVWZXJ0ZXhbal0gKz0gb2Zmc2V0MDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGsgKj0gc2l6ZV9pOwogICAgICAgIHBvcyA8PD0gMTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG91dHB1dFNpemU7ICsraikgewogICAgICAgIGxldCByaiA9IDA7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBjdWJlVmVydGljZXM7IGkrKykgewogICAgICAgICAgcmogKz0gc2FtcGxlc1tjdWJlVmVydGV4W2ldICsgal0gKiBjdWJlTltpXTsKICAgICAgICB9CgogICAgICAgIHJqID0gaW50ZXJwb2xhdGUocmosIDAsIDEsIGRlY29kZVtqXVswXSwgZGVjb2RlW2pdWzFdKTsKICAgICAgICBkZXN0W2Rlc3RPZmZzZXQgKyBqXSA9IE1hdGgubWluKE1hdGgubWF4KHJqLCByYW5nZVtqXVswXSksIHJhbmdlW2pdWzFdKTsKICAgICAgfQogICAgfTsKICB9CgogIHN0YXRpYyBjb25zdHJ1Y3RJbnRlcnBvbGF0ZWQoewogICAgeHJlZiwKICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgIGRpY3QKICB9KSB7CiAgICBjb25zdCBjMCA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiQzAiKSkgfHwgWzBdOwogICAgY29uc3QgYzEgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkMxIikpIHx8IFsxXTsKICAgIGNvbnN0IG4gPSBkaWN0LmdldCgiTiIpOwogICAgY29uc3QgZGlmZiA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGMwLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgZGlmZi5wdXNoKGMxW2ldIC0gYzBbaV0pOwogICAgfQoKICAgIGNvbnN0IGxlbmd0aCA9IGRpZmYubGVuZ3RoOwogICAgcmV0dXJuIGZ1bmN0aW9uIGNvbnN0cnVjdEludGVycG9sYXRlZEZuKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGNvbnN0IHggPSBuID09PSAxID8gc3JjW3NyY09mZnNldF0gOiBzcmNbc3JjT2Zmc2V0XSAqKiBuOwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsZW5ndGg7ICsraikgewogICAgICAgIGRlc3RbZGVzdE9mZnNldCArIGpdID0gYzBbal0gKyB4ICogZGlmZltqXTsKICAgICAgfQogICAgfTsKICB9CgogIHN0YXRpYyBjb25zdHJ1Y3RTdGljaGVkKHsKICAgIHhyZWYsCiAgICBpc0V2YWxTdXBwb3J0ZWQsCiAgICBkaWN0CiAgfSkgewogICAgY29uc3QgZG9tYWluID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJEb21haW4iKSk7CgogICAgaWYgKCFkb21haW4pIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBkb21haW4iKTsKICAgIH0KCiAgICBjb25zdCBpbnB1dFNpemUgPSBkb21haW4ubGVuZ3RoIC8gMjsKCiAgICBpZiAoaW5wdXRTaXplICE9PSAxKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGRvbWFpbiBmb3Igc3RpY2hlZCBmdW5jdGlvbiIpOwogICAgfQoKICAgIGNvbnN0IGZuUmVmcyA9IGRpY3QuZ2V0KCJGdW5jdGlvbnMiKTsKICAgIGNvbnN0IGZucyA9IFtdOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGZuUmVmcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGZucy5wdXNoKHRoaXMucGFyc2UoewogICAgICAgIHhyZWYsCiAgICAgICAgaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIGZuOiB4cmVmLmZldGNoSWZSZWYoZm5SZWZzW2ldKQogICAgICB9KSk7CiAgICB9CgogICAgY29uc3QgYm91bmRzID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJCb3VuZHMiKSk7CiAgICBjb25zdCBlbmNvZGUgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkVuY29kZSIpKTsKICAgIGNvbnN0IHRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkoMSk7CiAgICByZXR1cm4gZnVuY3Rpb24gY29uc3RydWN0U3RpY2hlZEZuKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGNvbnN0IGNsaXAgPSBmdW5jdGlvbiBjb25zdHJ1Y3RTdGljaGVkRnJvbUlSQ2xpcCh2LCBtaW4sIG1heCkgewogICAgICAgIGlmICh2ID4gbWF4KSB7CiAgICAgICAgICB2ID0gbWF4OwogICAgICAgIH0gZWxzZSBpZiAodiA8IG1pbikgewogICAgICAgICAgdiA9IG1pbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiB2OwogICAgICB9OwoKICAgICAgY29uc3QgdiA9IGNsaXAoc3JjW3NyY09mZnNldF0sIGRvbWFpblswXSwgZG9tYWluWzFdKTsKICAgICAgY29uc3QgbGVuZ3RoID0gYm91bmRzLmxlbmd0aDsKICAgICAgbGV0IGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICBpZiAodiA8IGJvdW5kc1tpXSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQgZG1pbiA9IGRvbWFpblswXTsKCiAgICAgIGlmIChpID4gMCkgewogICAgICAgIGRtaW4gPSBib3VuZHNbaSAtIDFdOwogICAgICB9CgogICAgICBsZXQgZG1heCA9IGRvbWFpblsxXTsKCiAgICAgIGlmIChpIDwgYm91bmRzLmxlbmd0aCkgewogICAgICAgIGRtYXggPSBib3VuZHNbaV07CiAgICAgIH0KCiAgICAgIGNvbnN0IHJtaW4gPSBlbmNvZGVbMiAqIGldOwogICAgICBjb25zdCBybWF4ID0gZW5jb2RlWzIgKiBpICsgMV07CiAgICAgIHRtcEJ1ZlswXSA9IGRtaW4gPT09IGRtYXggPyBybWluIDogcm1pbiArICh2IC0gZG1pbikgKiAocm1heCAtIHJtaW4pIC8gKGRtYXggLSBkbWluKTsKICAgICAgZm5zW2ldKHRtcEJ1ZiwgMCwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICB9OwogIH0KCiAgc3RhdGljIGNvbnN0cnVjdFBvc3RTY3JpcHQoewogICAgeHJlZiwKICAgIGlzRXZhbFN1cHBvcnRlZCwKICAgIGZuLAogICAgZGljdAogIH0pIHsKICAgIGNvbnN0IGRvbWFpbiA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRG9tYWluIikpOwogICAgY29uc3QgcmFuZ2UgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIlJhbmdlIikpOwoKICAgIGlmICghZG9tYWluKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm8gZG9tYWluLiIpOwogICAgfQoKICAgIGlmICghcmFuZ2UpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyByYW5nZS4iKTsKICAgIH0KCiAgICBjb25zdCBsZXhlciA9IG5ldyBfcHNfcGFyc2VyLlBvc3RTY3JpcHRMZXhlcihmbik7CiAgICBjb25zdCBwYXJzZXIgPSBuZXcgX3BzX3BhcnNlci5Qb3N0U2NyaXB0UGFyc2VyKGxleGVyKTsKICAgIGNvbnN0IGNvZGUgPSBwYXJzZXIucGFyc2UoKTsKCiAgICBpZiAoaXNFdmFsU3VwcG9ydGVkICYmIF91dGlsLkZlYXR1cmVUZXN0LmlzRXZhbFN1cHBvcnRlZCkgewogICAgICBjb25zdCBjb21waWxlZCA9IG5ldyBQb3N0U2NyaXB0Q29tcGlsZXIoKS5jb21waWxlKGNvZGUsIGRvbWFpbiwgcmFuZ2UpOwoKICAgICAgaWYgKGNvbXBpbGVkKSB7CiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigic3JjIiwgInNyY09mZnNldCIsICJkZXN0IiwgImRlc3RPZmZzZXQiLCBjb21waWxlZCk7CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwuaW5mbykoIlVuYWJsZSB0byBjb21waWxlIFBTIGZ1bmN0aW9uIik7CiAgICBjb25zdCBudW1PdXRwdXRzID0gcmFuZ2UubGVuZ3RoID4+IDE7CiAgICBjb25zdCBudW1JbnB1dHMgPSBkb21haW4ubGVuZ3RoID4+IDE7CiAgICBjb25zdCBldmFsdWF0b3IgPSBuZXcgUG9zdFNjcmlwdEV2YWx1YXRvcihjb2RlKTsKICAgIGNvbnN0IGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIGNvbnN0IE1BWF9DQUNIRV9TSVpFID0gMjA0OCAqIDQ7CiAgICBsZXQgY2FjaGVfYXZhaWxhYmxlID0gTUFYX0NBQ0hFX1NJWkU7CiAgICBjb25zdCB0bXBCdWYgPSBuZXcgRmxvYXQzMkFycmF5KG51bUlucHV0cyk7CiAgICByZXR1cm4gZnVuY3Rpb24gY29uc3RydWN0UG9zdFNjcmlwdEZuKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIGxldCBpLCB2YWx1ZTsKICAgICAgbGV0IGtleSA9ICIiOwogICAgICBjb25zdCBpbnB1dCA9IHRtcEJ1ZjsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1JbnB1dHM7IGkrKykgewogICAgICAgIHZhbHVlID0gc3JjW3NyY09mZnNldCArIGldOwogICAgICAgIGlucHV0W2ldID0gdmFsdWU7CiAgICAgICAga2V5ICs9IHZhbHVlICsgIl8iOwogICAgICB9CgogICAgICBjb25zdCBjYWNoZWRWYWx1ZSA9IGNhY2hlW2tleV07CgogICAgICBpZiAoY2FjaGVkVmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGRlc3Quc2V0KGNhY2hlZFZhbHVlLCBkZXN0T2Zmc2V0KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IG91dHB1dCA9IG5ldyBGbG9hdDMyQXJyYXkobnVtT3V0cHV0cyk7CiAgICAgIGNvbnN0IHN0YWNrID0gZXZhbHVhdG9yLmV4ZWN1dGUoaW5wdXQpOwogICAgICBjb25zdCBzdGFja0luZGV4ID0gc3RhY2subGVuZ3RoIC0gbnVtT3V0cHV0czsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1PdXRwdXRzOyBpKyspIHsKICAgICAgICB2YWx1ZSA9IHN0YWNrW3N0YWNrSW5kZXggKyBpXTsKICAgICAgICBsZXQgYm91bmQgPSByYW5nZVtpICogMl07CgogICAgICAgIGlmICh2YWx1ZSA8IGJvdW5kKSB7CiAgICAgICAgICB2YWx1ZSA9IGJvdW5kOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBib3VuZCA9IHJhbmdlW2kgKiAyICsgMV07CgogICAgICAgICAgaWYgKHZhbHVlID4gYm91bmQpIHsKICAgICAgICAgICAgdmFsdWUgPSBib3VuZDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG91dHB1dFtpXSA9IHZhbHVlOwogICAgICB9CgogICAgICBpZiAoY2FjaGVfYXZhaWxhYmxlID4gMCkgewogICAgICAgIGNhY2hlX2F2YWlsYWJsZS0tOwogICAgICAgIGNhY2hlW2tleV0gPSBvdXRwdXQ7CiAgICAgIH0KCiAgICAgIGRlc3Quc2V0KG91dHB1dCwgZGVzdE9mZnNldCk7CiAgICB9OwogIH0KCn0KCmZ1bmN0aW9uIGlzUERGRnVuY3Rpb24odikgewogIGxldCBmbkRpY3Q7CgogIGlmICh0eXBlb2YgdiAhPT0gIm9iamVjdCIpIHsKICAgIHJldHVybiBmYWxzZTsKICB9IGVsc2UgaWYgKHYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICBmbkRpY3QgPSB2OwogIH0gZWxzZSBpZiAodiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICBmbkRpY3QgPSB2LmRpY3Q7CiAgfSBlbHNlIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiBmbkRpY3QuaGFzKCJGdW5jdGlvblR5cGUiKTsKfQoKY2xhc3MgUG9zdFNjcmlwdFN0YWNrIHsKICBzdGF0aWMgZ2V0IE1BWF9TVEFDS19TSVpFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNQVhfU1RBQ0tfU0laRSIsIDEwMCk7CiAgfQoKICBjb25zdHJ1Y3Rvcihpbml0aWFsU3RhY2spIHsKICAgIHRoaXMuc3RhY2sgPSAhaW5pdGlhbFN0YWNrID8gW10gOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChpbml0aWFsU3RhY2ssIDApOwogIH0KCiAgcHVzaCh2YWx1ZSkgewogICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoID49IFBvc3RTY3JpcHRTdGFjay5NQVhfU1RBQ0tfU0laRSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlBvc3RTY3JpcHQgZnVuY3Rpb24gc3RhY2sgb3ZlcmZsb3cuIik7CiAgICB9CgogICAgdGhpcy5zdGFjay5wdXNoKHZhbHVlKTsKICB9CgogIHBvcCgpIHsKICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8PSAwKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiUG9zdFNjcmlwdCBmdW5jdGlvbiBzdGFjayB1bmRlcmZsb3cuIik7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuc3RhY2sucG9wKCk7CiAgfQoKICBjb3B5KG4pIHsKICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCArIG4gPj0gUG9zdFNjcmlwdFN0YWNrLk1BWF9TVEFDS19TSVpFKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiUG9zdFNjcmlwdCBmdW5jdGlvbiBzdGFjayBvdmVyZmxvdy4iKTsKICAgIH0KCiAgICBjb25zdCBzdGFjayA9IHRoaXMuc3RhY2s7CgogICAgZm9yIChsZXQgaSA9IHN0YWNrLmxlbmd0aCAtIG4sIGogPSBuIC0gMTsgaiA+PSAwOyBqLS0sIGkrKykgewogICAgICBzdGFjay5wdXNoKHN0YWNrW2ldKTsKICAgIH0KICB9CgogIGluZGV4KG4pIHsKICAgIHRoaXMucHVzaCh0aGlzLnN0YWNrW3RoaXMuc3RhY2subGVuZ3RoIC0gbiAtIDFdKTsKICB9CgogIHJvbGwobiwgcCkgewogICAgY29uc3Qgc3RhY2sgPSB0aGlzLnN0YWNrOwogICAgY29uc3QgbCA9IHN0YWNrLmxlbmd0aCAtIG47CiAgICBjb25zdCByID0gc3RhY2subGVuZ3RoIC0gMTsKICAgIGNvbnN0IGMgPSBsICsgKHAgLSBNYXRoLmZsb29yKHAgLyBuKSAqIG4pOwoKICAgIGZvciAobGV0IGkgPSBsLCBqID0gcjsgaSA8IGo7IGkrKywgai0tKSB7CiAgICAgIGNvbnN0IHQgPSBzdGFja1tpXTsKICAgICAgc3RhY2tbaV0gPSBzdGFja1tqXTsKICAgICAgc3RhY2tbal0gPSB0OwogICAgfQoKICAgIGZvciAobGV0IGkgPSBsLCBqID0gYyAtIDE7IGkgPCBqOyBpKyssIGotLSkgewogICAgICBjb25zdCB0ID0gc3RhY2tbaV07CiAgICAgIHN0YWNrW2ldID0gc3RhY2tbal07CiAgICAgIHN0YWNrW2pdID0gdDsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gYywgaiA9IHI7IGkgPCBqOyBpKyssIGotLSkgewogICAgICBjb25zdCB0ID0gc3RhY2tbaV07CiAgICAgIHN0YWNrW2ldID0gc3RhY2tbal07CiAgICAgIHN0YWNrW2pdID0gdDsKICAgIH0KICB9Cgp9CgpjbGFzcyBQb3N0U2NyaXB0RXZhbHVhdG9yIHsKICBjb25zdHJ1Y3RvcihvcGVyYXRvcnMpIHsKICAgIHRoaXMub3BlcmF0b3JzID0gb3BlcmF0b3JzOwogIH0KCiAgZXhlY3V0ZShpbml0aWFsU3RhY2spIHsKICAgIGNvbnN0IHN0YWNrID0gbmV3IFBvc3RTY3JpcHRTdGFjayhpbml0aWFsU3RhY2spOwogICAgbGV0IGNvdW50ZXIgPSAwOwogICAgY29uc3Qgb3BlcmF0b3JzID0gdGhpcy5vcGVyYXRvcnM7CiAgICBjb25zdCBsZW5ndGggPSBvcGVyYXRvcnMubGVuZ3RoOwogICAgbGV0IG9wZXJhdG9yLCBhLCBiOwoKICAgIHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CiAgICAgIG9wZXJhdG9yID0gb3BlcmF0b3JzW2NvdW50ZXIrK107CgogICAgICBpZiAodHlwZW9mIG9wZXJhdG9yID09PSAibnVtYmVyIikgewogICAgICAgIHN0YWNrLnB1c2gob3BlcmF0b3IpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7CiAgICAgICAgY2FzZSAianoiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgIGlmICghYSkgewogICAgICAgICAgICBjb3VudGVyID0gYjsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiaiI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBjb3VudGVyID0gYTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJhYnMiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLmFicyhhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYWRkIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSArIGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImFuZCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKHR5cGVvZiBhID09PSAiYm9vbGVhbiIgJiYgdHlwZW9mIGIgPT09ICJib29sZWFuIikgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgJiYgYik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgJiBiKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYXRhbiI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguYXRhbihhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiYml0c2hpZnQiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgIGlmIChhID4gMCkgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgPDwgYik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFjay5wdXNoKGEgPj4gYik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImNlaWxpbmciOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLmNlaWwoYSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImNvcHkiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2suY29weShhKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJjb3MiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLmNvcyhhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiY3ZpIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKSB8IDA7CiAgICAgICAgICBzdGFjay5wdXNoKGEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImN2ciI6CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZGl2IjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAvIGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImR1cCI6CiAgICAgICAgICBzdGFjay5jb3B5KDEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImVxIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSA9PT0gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZXhjaCI6CiAgICAgICAgICBzdGFjay5yb2xsKDIsIDEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImV4cCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgKiogYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZmFsc2UiOgogICAgICAgICAgc3RhY2sucHVzaChmYWxzZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZmxvb3IiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLmZsb29yKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJnZSI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgPj0gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZ3QiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhID4gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiaWRpdiI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgLyBiIHwgMCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiaW5kZXgiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2suaW5kZXgoYSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibGUiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhIDw9IGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImxuIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5sb2coYSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImxvZyI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGgubG9nKGEpIC8gTWF0aC5MTjEwKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJsdCI6CiAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGEgPCBiKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtb2QiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChhICUgYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibXVsIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAqIGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm5lIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAhPT0gYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibmVnIjoKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goLWEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm5vdCI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKHR5cGVvZiBhID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgc3RhY2sucHVzaCghYSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGFjay5wdXNoKH5hKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAib3IiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgIGlmICh0eXBlb2YgYSA9PT0gImJvb2xlYW4iICYmIHR5cGVvZiBiID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhIHx8IGIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhIHwgYik7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInBvcCI6CiAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJyb2xsIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnJvbGwoYSwgYik7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAicm91bmQiOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLnJvdW5kKGEpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJzaW4iOgogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChNYXRoLnNpbihhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAic3FydCI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKE1hdGguc3FydChhKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAic3ViIjoKICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgIHN0YWNrLnB1c2goYSAtIGIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInRydWUiOgogICAgICAgICAgc3RhY2sucHVzaCh0cnVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJ0cnVuY2F0ZSI6CiAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhID0gYSA8IDAgPyBNYXRoLmNlaWwoYSkgOiBNYXRoLmZsb29yKGEpOwogICAgICAgICAgc3RhY2sucHVzaChhKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJ4b3IiOgogICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgIGlmICh0eXBlb2YgYSA9PT0gImJvb2xlYW4iICYmIHR5cGVvZiBiID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhICE9PSBiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSBeIGIpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKGBVbmtub3duIG9wZXJhdG9yICR7b3BlcmF0b3J9YCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3RhY2suc3RhY2s7CiAgfQoKfQoKZXhwb3J0cy5Qb3N0U2NyaXB0RXZhbHVhdG9yID0gUG9zdFNjcmlwdEV2YWx1YXRvcjsKCmNsYXNzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKHR5cGUpIHsKICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgfQoKICB2aXNpdCh2aXNpdG9yKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJhYnN0cmFjdCBtZXRob2QiKTsKICB9Cgp9CgpjbGFzcyBBc3RBcmd1bWVudCBleHRlbmRzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKGluZGV4LCBtaW4sIG1heCkgewogICAgc3VwZXIoImFyZ3MiKTsKICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIHRoaXMubWluID0gbWluOwogICAgdGhpcy5tYXggPSBtYXg7CiAgfQoKICB2aXNpdCh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0QXJndW1lbnQodGhpcyk7CiAgfQoKfQoKY2xhc3MgQXN0TGl0ZXJhbCBleHRlbmRzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKG51bWJlcikgewogICAgc3VwZXIoImxpdGVyYWwiKTsKICAgIHRoaXMubnVtYmVyID0gbnVtYmVyOwogICAgdGhpcy5taW4gPSBudW1iZXI7CiAgICB0aGlzLm1heCA9IG51bWJlcjsKICB9CgogIHZpc2l0KHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRMaXRlcmFsKHRoaXMpOwogIH0KCn0KCmNsYXNzIEFzdEJpbmFyeU9wZXJhdGlvbiBleHRlbmRzIEFzdE5vZGUgewogIGNvbnN0cnVjdG9yKG9wLCBhcmcxLCBhcmcyLCBtaW4sIG1heCkgewogICAgc3VwZXIoImJpbmFyeSIpOwogICAgdGhpcy5vcCA9IG9wOwogICAgdGhpcy5hcmcxID0gYXJnMTsKICAgIHRoaXMuYXJnMiA9IGFyZzI7CiAgICB0aGlzLm1pbiA9IG1pbjsKICAgIHRoaXMubWF4ID0gbWF4OwogIH0KCiAgdmlzaXQodmlzaXRvcikgewogICAgdmlzaXRvci52aXNpdEJpbmFyeU9wZXJhdGlvbih0aGlzKTsKICB9Cgp9CgpjbGFzcyBBc3RNaW4gZXh0ZW5kcyBBc3ROb2RlIHsKICBjb25zdHJ1Y3RvcihhcmcsIG1heCkgewogICAgc3VwZXIoIm1heCIpOwogICAgdGhpcy5hcmcgPSBhcmc7CiAgICB0aGlzLm1pbiA9IGFyZy5taW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CgogIHZpc2l0KHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRNaW4odGhpcyk7CiAgfQoKfQoKY2xhc3MgQXN0VmFyaWFibGUgZXh0ZW5kcyBBc3ROb2RlIHsKICBjb25zdHJ1Y3RvcihpbmRleCwgbWluLCBtYXgpIHsKICAgIHN1cGVyKCJ2YXIiKTsKICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIHRoaXMubWluID0gbWluOwogICAgdGhpcy5tYXggPSBtYXg7CiAgfQoKICB2aXNpdCh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0VmFyaWFibGUodGhpcyk7CiAgfQoKfQoKY2xhc3MgQXN0VmFyaWFibGVEZWZpbml0aW9uIGV4dGVuZHMgQXN0Tm9kZSB7CiAgY29uc3RydWN0b3IodmFyaWFibGUsIGFyZykgewogICAgc3VwZXIoImRlZmluaXRpb24iKTsKICAgIHRoaXMudmFyaWFibGUgPSB2YXJpYWJsZTsKICAgIHRoaXMuYXJnID0gYXJnOwogIH0KCiAgdmlzaXQodmlzaXRvcikgewogICAgdmlzaXRvci52aXNpdFZhcmlhYmxlRGVmaW5pdGlvbih0aGlzKTsKICB9Cgp9CgpjbGFzcyBFeHByZXNzaW9uQnVpbGRlclZpc2l0b3IgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5wYXJ0cyA9IFtdOwogIH0KCiAgdmlzaXRBcmd1bWVudChhcmcpIHsKICAgIHRoaXMucGFydHMucHVzaCgiTWF0aC5tYXgoIiwgYXJnLm1pbiwgIiwgTWF0aC5taW4oIiwgYXJnLm1heCwgIiwgc3JjW3NyY09mZnNldCArICIsIGFyZy5pbmRleCwgIl0pKSIpOwogIH0KCiAgdmlzaXRWYXJpYWJsZSh2YXJpYWJsZSkgewogICAgdGhpcy5wYXJ0cy5wdXNoKCJ2IiwgdmFyaWFibGUuaW5kZXgpOwogIH0KCiAgdmlzaXRMaXRlcmFsKGxpdGVyYWwpIHsKICAgIHRoaXMucGFydHMucHVzaChsaXRlcmFsLm51bWJlcik7CiAgfQoKICB2aXNpdEJpbmFyeU9wZXJhdGlvbihvcGVyYXRpb24pIHsKICAgIHRoaXMucGFydHMucHVzaCgiKCIpOwogICAgb3BlcmF0aW9uLmFyZzEudmlzaXQodGhpcyk7CiAgICB0aGlzLnBhcnRzLnB1c2goIiAiLCBvcGVyYXRpb24ub3AsICIgIik7CiAgICBvcGVyYXRpb24uYXJnMi52aXNpdCh0aGlzKTsKICAgIHRoaXMucGFydHMucHVzaCgiKSIpOwogIH0KCiAgdmlzaXRWYXJpYWJsZURlZmluaXRpb24oZGVmaW5pdGlvbikgewogICAgdGhpcy5wYXJ0cy5wdXNoKCJ2YXIgIik7CiAgICBkZWZpbml0aW9uLnZhcmlhYmxlLnZpc2l0KHRoaXMpOwogICAgdGhpcy5wYXJ0cy5wdXNoKCIgPSAiKTsKICAgIGRlZmluaXRpb24uYXJnLnZpc2l0KHRoaXMpOwogICAgdGhpcy5wYXJ0cy5wdXNoKCI7Iik7CiAgfQoKICB2aXNpdE1pbihtYXgpIHsKICAgIHRoaXMucGFydHMucHVzaCgiTWF0aC5taW4oIik7CiAgICBtYXguYXJnLnZpc2l0KHRoaXMpOwogICAgdGhpcy5wYXJ0cy5wdXNoKCIsICIsIG1heC5tYXgsICIpIik7CiAgfQoKICB0b1N0cmluZygpIHsKICAgIHJldHVybiB0aGlzLnBhcnRzLmpvaW4oIiIpOwogIH0KCn0KCmZ1bmN0aW9uIGJ1aWxkQWRkT3BlcmF0aW9uKG51bTEsIG51bTIpIHsKICBpZiAobnVtMi50eXBlID09PSAibGl0ZXJhbCIgJiYgbnVtMi5udW1iZXIgPT09IDApIHsKICAgIHJldHVybiBudW0xOwogIH0KCiAgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiICYmIG51bTEubnVtYmVyID09PSAwKSB7CiAgICByZXR1cm4gbnVtMjsKICB9CgogIGlmIChudW0yLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0xLnR5cGUgPT09ICJsaXRlcmFsIikgewogICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKG51bTEubnVtYmVyICsgbnVtMi5udW1iZXIpOwogIH0KCiAgcmV0dXJuIG5ldyBBc3RCaW5hcnlPcGVyYXRpb24oIisiLCBudW0xLCBudW0yLCBudW0xLm1pbiArIG51bTIubWluLCBudW0xLm1heCArIG51bTIubWF4KTsKfQoKZnVuY3Rpb24gYnVpbGRNdWxPcGVyYXRpb24obnVtMSwgbnVtMikgewogIGlmIChudW0yLnR5cGUgPT09ICJsaXRlcmFsIikgewogICAgaWYgKG51bTIubnVtYmVyID09PSAwKSB7CiAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbCgwKTsKICAgIH0gZWxzZSBpZiAobnVtMi5udW1iZXIgPT09IDEpIHsKICAgICAgcmV0dXJuIG51bTE7CiAgICB9IGVsc2UgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbChudW0xLm51bWJlciAqIG51bTIubnVtYmVyKTsKICAgIH0KICB9CgogIGlmIChudW0xLnR5cGUgPT09ICJsaXRlcmFsIikgewogICAgaWYgKG51bTEubnVtYmVyID09PSAwKSB7CiAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbCgwKTsKICAgIH0gZWxzZSBpZiAobnVtMS5udW1iZXIgPT09IDEpIHsKICAgICAgcmV0dXJuIG51bTI7CiAgICB9CiAgfQoKICBjb25zdCBtaW4gPSBNYXRoLm1pbihudW0xLm1pbiAqIG51bTIubWluLCBudW0xLm1pbiAqIG51bTIubWF4LCBudW0xLm1heCAqIG51bTIubWluLCBudW0xLm1heCAqIG51bTIubWF4KTsKICBjb25zdCBtYXggPSBNYXRoLm1heChudW0xLm1pbiAqIG51bTIubWluLCBudW0xLm1pbiAqIG51bTIubWF4LCBudW0xLm1heCAqIG51bTIubWluLCBudW0xLm1heCAqIG51bTIubWF4KTsKICByZXR1cm4gbmV3IEFzdEJpbmFyeU9wZXJhdGlvbigiKiIsIG51bTEsIG51bTIsIG1pbiwgbWF4KTsKfQoKZnVuY3Rpb24gYnVpbGRTdWJPcGVyYXRpb24obnVtMSwgbnVtMikgewogIGlmIChudW0yLnR5cGUgPT09ICJsaXRlcmFsIikgewogICAgaWYgKG51bTIubnVtYmVyID09PSAwKSB7CiAgICAgIHJldHVybiBudW0xOwogICAgfSBlbHNlIGlmIChudW0xLnR5cGUgPT09ICJsaXRlcmFsIikgewogICAgICByZXR1cm4gbmV3IEFzdExpdGVyYWwobnVtMS5udW1iZXIgLSBudW0yLm51bWJlcik7CiAgICB9CiAgfQoKICBpZiAobnVtMi50eXBlID09PSAiYmluYXJ5IiAmJiBudW0yLm9wID09PSAiLSIgJiYgbnVtMS50eXBlID09PSAibGl0ZXJhbCIgJiYgbnVtMS5udW1iZXIgPT09IDEgJiYgbnVtMi5hcmcxLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0yLmFyZzEubnVtYmVyID09PSAxKSB7CiAgICByZXR1cm4gbnVtMi5hcmcyOwogIH0KCiAgcmV0dXJuIG5ldyBBc3RCaW5hcnlPcGVyYXRpb24oIi0iLCBudW0xLCBudW0yLCBudW0xLm1pbiAtIG51bTIubWF4LCBudW0xLm1heCAtIG51bTIubWluKTsKfQoKZnVuY3Rpb24gYnVpbGRNaW5PcGVyYXRpb24obnVtMSwgbWF4KSB7CiAgaWYgKG51bTEubWluID49IG1heCkgewogICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKG1heCk7CiAgfSBlbHNlIGlmIChudW0xLm1heCA8PSBtYXgpIHsKICAgIHJldHVybiBudW0xOwogIH0KCiAgcmV0dXJuIG5ldyBBc3RNaW4obnVtMSwgbWF4KTsKfQoKY2xhc3MgUG9zdFNjcmlwdENvbXBpbGVyIHsKICBjb21waWxlKGNvZGUsIGRvbWFpbiwgcmFuZ2UpIHsKICAgIGNvbnN0IHN0YWNrID0gW107CiAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBbXTsKICAgIGNvbnN0IGlucHV0U2l6ZSA9IGRvbWFpbi5sZW5ndGggPj4gMSwKICAgICAgICAgIG91dHB1dFNpemUgPSByYW5nZS5sZW5ndGggPj4gMTsKICAgIGxldCBsYXN0UmVnaXN0ZXIgPSAwOwogICAgbGV0IG4sIGo7CiAgICBsZXQgbnVtMSwgbnVtMiwgYXN0MSwgYXN0MiwgdG1wVmFyLCBpdGVtOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXRTaXplOyBpKyspIHsKICAgICAgc3RhY2sucHVzaChuZXcgQXN0QXJndW1lbnQoaSwgZG9tYWluW2kgKiAyXSwgZG9tYWluW2kgKiAyICsgMV0pKTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb2RlLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgaXRlbSA9IGNvZGVbaV07CgogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJudW1iZXIiKSB7CiAgICAgICAgc3RhY2sucHVzaChuZXcgQXN0TGl0ZXJhbChpdGVtKSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAoaXRlbSkgewogICAgICAgIGNhc2UgImFkZCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkQWRkT3BlcmF0aW9uKG51bTEsIG51bTIpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJjdnIiOgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm11bCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkTXVsT3BlcmF0aW9uKG51bTEsIG51bTIpKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJzdWIiOgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgbnVtMiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgbnVtMSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgc3RhY2sucHVzaChidWlsZFN1Yk9wZXJhdGlvbihudW0xLCBudW0yKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZXhjaCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBhc3QxID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBhc3QyID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBzdGFjay5wdXNoKGFzdDEsIGFzdDIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInBvcCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJpbmRleCI6CiAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgaWYgKG51bTEudHlwZSAhPT0gImxpdGVyYWwiKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIG4gPSBudW0xLm51bWJlcjsKCiAgICAgICAgICBpZiAobiA8IDAgfHwgIU51bWJlci5pc0ludGVnZXIobikgfHwgc3RhY2subGVuZ3RoIDwgbikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBhc3QxID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gbiAtIDFdOwoKICAgICAgICAgIGlmIChhc3QxLnR5cGUgPT09ICJsaXRlcmFsIiB8fCBhc3QxLnR5cGUgPT09ICJ2YXIiKSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYXN0MSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHRtcFZhciA9IG5ldyBBc3RWYXJpYWJsZShsYXN0UmVnaXN0ZXIrKywgYXN0MS5taW4sIGFzdDEubWF4KTsKICAgICAgICAgIHN0YWNrW3N0YWNrLmxlbmd0aCAtIG4gLSAxXSA9IHRtcFZhcjsKICAgICAgICAgIHN0YWNrLnB1c2godG1wVmFyKTsKICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKG5ldyBBc3RWYXJpYWJsZURlZmluaXRpb24odG1wVmFyLCBhc3QxKSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZHVwIjoKICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0eXBlb2YgY29kZVtpICsgMV0gPT09ICJudW1iZXIiICYmIGNvZGVbaSArIDJdID09PSAiZ3QiICYmIGNvZGVbaSArIDNdID09PSBpICsgNyAmJiBjb2RlW2kgKyA0XSA9PT0gImp6IiAmJiBjb2RlW2kgKyA1XSA9PT0gInBvcCIgJiYgY29kZVtpICsgNl0gPT09IGNvZGVbaSArIDFdKSB7CiAgICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChidWlsZE1pbk9wZXJhdGlvbihudW0xLCBjb2RlW2kgKyAxXSkpOwogICAgICAgICAgICBpICs9IDY7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFzdDEgPSBzdGFjay5hdCgtMSk7CgogICAgICAgICAgaWYgKGFzdDEudHlwZSA9PT0gImxpdGVyYWwiIHx8IGFzdDEudHlwZSA9PT0gInZhciIpIHsKICAgICAgICAgICAgc3RhY2sucHVzaChhc3QxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdG1wVmFyID0gbmV3IEFzdFZhcmlhYmxlKGxhc3RSZWdpc3RlcisrLCBhc3QxLm1pbiwgYXN0MS5tYXgpOwogICAgICAgICAgc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gPSB0bXBWYXI7CiAgICAgICAgICBzdGFjay5wdXNoKHRtcFZhcik7CiAgICAgICAgICBpbnN0cnVjdGlvbnMucHVzaChuZXcgQXN0VmFyaWFibGVEZWZpbml0aW9uKHRtcFZhciwgYXN0MSkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInJvbGwiOgogICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgbnVtMiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgbnVtMSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgIGlmIChudW0yLnR5cGUgIT09ICJsaXRlcmFsIiB8fCBudW0xLnR5cGUgIT09ICJsaXRlcmFsIikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBqID0gbnVtMi5udW1iZXI7CiAgICAgICAgICBuID0gbnVtMS5udW1iZXI7CgogICAgICAgICAgaWYgKG4gPD0gMCB8fCAhTnVtYmVyLmlzSW50ZWdlcihuKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihqKSB8fCBzdGFjay5sZW5ndGggPCBuKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGogPSAoaiAlIG4gKyBuKSAlIG47CgogICAgICAgICAgaWYgKGogPT09IDApIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoc3RhY2ssIHN0YWNrLnNwbGljZShzdGFjay5sZW5ndGggLSBuLCBuIC0gaikpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGlmIChzdGFjay5sZW5ndGggIT09IG91dHB1dFNpemUpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgcmVzdWx0ID0gW107CgogICAgZm9yIChjb25zdCBpbnN0cnVjdGlvbiBvZiBpbnN0cnVjdGlvbnMpIHsKICAgICAgY29uc3Qgc3RhdGVtZW50QnVpbGRlciA9IG5ldyBFeHByZXNzaW9uQnVpbGRlclZpc2l0b3IoKTsKICAgICAgaW5zdHJ1Y3Rpb24udmlzaXQoc3RhdGVtZW50QnVpbGRlcik7CiAgICAgIHJlc3VsdC5wdXNoKHN0YXRlbWVudEJ1aWxkZXIudG9TdHJpbmcoKSk7CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3RhY2subGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBjb25zdCBleHByID0gc3RhY2tbaV0sCiAgICAgICAgICAgIHN0YXRlbWVudEJ1aWxkZXIgPSBuZXcgRXhwcmVzc2lvbkJ1aWxkZXJWaXNpdG9yKCk7CiAgICAgIGV4cHIudmlzaXQoc3RhdGVtZW50QnVpbGRlcik7CiAgICAgIGNvbnN0IG1pbiA9IHJhbmdlW2kgKiAyXSwKICAgICAgICAgICAgbWF4ID0gcmFuZ2VbaSAqIDIgKyAxXTsKICAgICAgY29uc3Qgb3V0ID0gW3N0YXRlbWVudEJ1aWxkZXIudG9TdHJpbmcoKV07CgogICAgICBpZiAobWluID4gZXhwci5taW4pIHsKICAgICAgICBvdXQudW5zaGlmdCgiTWF0aC5tYXgoIiwgbWluLCAiLCAiKTsKICAgICAgICBvdXQucHVzaCgiKSIpOwogICAgICB9CgogICAgICBpZiAobWF4IDwgZXhwci5tYXgpIHsKICAgICAgICBvdXQudW5zaGlmdCgiTWF0aC5taW4oIiwgbWF4LCAiLCAiKTsKICAgICAgICBvdXQucHVzaCgiKSIpOwogICAgICB9CgogICAgICBvdXQudW5zaGlmdCgiZGVzdFtkZXN0T2Zmc2V0ICsgIiwgaSwgIl0gPSAiKTsKICAgICAgb3V0LnB1c2goIjsiKTsKICAgICAgcmVzdWx0LnB1c2gob3V0LmpvaW4oIiIpKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0LmpvaW4oIlxuIik7CiAgfQoKfQoKZXhwb3J0cy5Qb3N0U2NyaXB0Q29tcGlsZXIgPSBQb3N0U2NyaXB0Q29tcGlsZXI7CgovKioqLyB9KSwKLyogNTggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Qb3N0U2NyaXB0UGFyc2VyID0gZXhwb3J0cy5Qb3N0U2NyaXB0TGV4ZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7CgpjbGFzcyBQb3N0U2NyaXB0UGFyc2VyIHsKICBjb25zdHJ1Y3RvcihsZXhlcikgewogICAgdGhpcy5sZXhlciA9IGxleGVyOwogICAgdGhpcy5vcGVyYXRvcnMgPSBbXTsKICAgIHRoaXMudG9rZW4gPSBudWxsOwogICAgdGhpcy5wcmV2ID0gbnVsbDsKICB9CgogIG5leHRUb2tlbigpIHsKICAgIHRoaXMucHJldiA9IHRoaXMudG9rZW47CiAgICB0aGlzLnRva2VuID0gdGhpcy5sZXhlci5nZXRUb2tlbigpOwogIH0KCiAgYWNjZXB0KHR5cGUpIHsKICAgIGlmICh0aGlzLnRva2VuLnR5cGUgPT09IHR5cGUpIHsKICAgICAgdGhpcy5uZXh0VG9rZW4oKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZXhwZWN0KHR5cGUpIHsKICAgIGlmICh0aGlzLmFjY2VwdCh0eXBlKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFVuZXhwZWN0ZWQgc3ltYm9sOiBmb3VuZCAke3RoaXMudG9rZW4udHlwZX0gZXhwZWN0ZWQgJHt0eXBlfS5gKTsKICB9CgogIHBhcnNlKCkgewogICAgdGhpcy5uZXh0VG9rZW4oKTsKICAgIHRoaXMuZXhwZWN0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSk7CiAgICB0aGlzLnBhcnNlQmxvY2soKTsKICAgIHRoaXMuZXhwZWN0KFBvc3RTY3JpcHRUb2tlblR5cGVzLlJCUkFDRSk7CiAgICByZXR1cm4gdGhpcy5vcGVyYXRvcnM7CiAgfQoKICBwYXJzZUJsb2NrKCkgewogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLk5VTUJFUikpIHsKICAgICAgICB0aGlzLm9wZXJhdG9ycy5wdXNoKHRoaXMucHJldi52YWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5hY2NlcHQoUG9zdFNjcmlwdFRva2VuVHlwZXMuT1BFUkFUT1IpKSB7CiAgICAgICAgdGhpcy5vcGVyYXRvcnMucHVzaCh0aGlzLnByZXYudmFsdWUpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSkpIHsKICAgICAgICB0aGlzLnBhcnNlQ29uZGl0aW9uKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUNvbmRpdGlvbigpIHsKICAgIGNvbnN0IGNvbmRpdGlvbkxvY2F0aW9uID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgdGhpcy5vcGVyYXRvcnMucHVzaChudWxsLCBudWxsKTsKICAgIHRoaXMucGFyc2VCbG9jaygpOwogICAgdGhpcy5leHBlY3QoUG9zdFNjcmlwdFRva2VuVHlwZXMuUkJSQUNFKTsKCiAgICBpZiAodGhpcy5hY2NlcHQoUG9zdFNjcmlwdFRva2VuVHlwZXMuSUYpKSB7CiAgICAgIHRoaXMub3BlcmF0b3JzW2NvbmRpdGlvbkxvY2F0aW9uXSA9IHRoaXMub3BlcmF0b3JzLmxlbmd0aDsKICAgICAgdGhpcy5vcGVyYXRvcnNbY29uZGl0aW9uTG9jYXRpb24gKyAxXSA9ICJqeiI7CiAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSkpIHsKICAgICAgY29uc3QganVtcExvY2F0aW9uID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgICB0aGlzLm9wZXJhdG9ycy5wdXNoKG51bGwsIG51bGwpOwogICAgICBjb25zdCBlbmRPZlRydWUgPSB0aGlzLm9wZXJhdG9ycy5sZW5ndGg7CiAgICAgIHRoaXMucGFyc2VCbG9jaygpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5JRkVMU0UpOwogICAgICB0aGlzLm9wZXJhdG9yc1tqdW1wTG9jYXRpb25dID0gdGhpcy5vcGVyYXRvcnMubGVuZ3RoOwogICAgICB0aGlzLm9wZXJhdG9yc1tqdW1wTG9jYXRpb24gKyAxXSA9ICJqIjsKICAgICAgdGhpcy5vcGVyYXRvcnNbY29uZGl0aW9uTG9jYXRpb25dID0gZW5kT2ZUcnVlOwogICAgICB0aGlzLm9wZXJhdG9yc1tjb25kaXRpb25Mb2NhdGlvbiArIDFdID0gImp6IjsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUFMgRnVuY3Rpb246IGVycm9yIHBhcnNpbmcgY29uZGl0aW9uYWwuIik7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5Qb3N0U2NyaXB0UGFyc2VyID0gUG9zdFNjcmlwdFBhcnNlcjsKY29uc3QgUG9zdFNjcmlwdFRva2VuVHlwZXMgPSB7CiAgTEJSQUNFOiAwLAogIFJCUkFDRTogMSwKICBOVU1CRVI6IDIsCiAgT1BFUkFUT1I6IDMsCiAgSUY6IDQsCiAgSUZFTFNFOiA1Cn07CgpjbGFzcyBQb3N0U2NyaXB0VG9rZW4gewogIHN0YXRpYyBnZXQgb3BDYWNoZSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAib3BDYWNoZSIsIE9iamVjdC5jcmVhdGUobnVsbCkpOwogIH0KCiAgY29uc3RydWN0b3IodHlwZSwgdmFsdWUpIHsKICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgfQoKICBzdGF0aWMgZ2V0T3BlcmF0b3Iob3ApIHsKICAgIGNvbnN0IG9wVmFsdWUgPSBQb3N0U2NyaXB0VG9rZW4ub3BDYWNoZVtvcF07CgogICAgaWYgKG9wVmFsdWUpIHsKICAgICAgcmV0dXJuIG9wVmFsdWU7CiAgICB9CgogICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5vcENhY2hlW29wXSA9IG5ldyBQb3N0U2NyaXB0VG9rZW4oUG9zdFNjcmlwdFRva2VuVHlwZXMuT1BFUkFUT1IsIG9wKTsKICB9CgogIHN0YXRpYyBnZXQgTEJSQUNFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJMQlJBQ0UiLCBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLkxCUkFDRSwgInsiKSk7CiAgfQoKICBzdGF0aWMgZ2V0IFJCUkFDRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiUkJSQUNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UsICJ9IikpOwogIH0KCiAgc3RhdGljIGdldCBJRigpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiSUYiLCBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLklGLCAiSUYiKSk7CiAgfQoKICBzdGF0aWMgZ2V0IElGRUxTRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiSUZFTFNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5JRkVMU0UsICJJRkVMU0UiKSk7CiAgfQoKfQoKY2xhc3MgUG9zdFNjcmlwdExleGVyIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0pIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5uZXh0Q2hhcigpOwogICAgdGhpcy5zdHJCdWYgPSBbXTsKICB9CgogIG5leHRDaGFyKCkgewogICAgcmV0dXJuIHRoaXMuY3VycmVudENoYXIgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgfQoKICBnZXRUb2tlbigpIHsKICAgIGxldCBjb21tZW50ID0gZmFsc2U7CiAgICBsZXQgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGlmIChjaCA8IDApIHsKICAgICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuRU9GOwogICAgICB9CgogICAgICBpZiAoY29tbWVudCkgewogICAgICAgIGlmIChjaCA9PT0gMHgwYSB8fCBjaCA9PT0gMHgwZCkgewogICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyNSkgewogICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICB9CgogICAgc3dpdGNoIChjaCB8IDApIHsKICAgICAgY2FzZSAweDMwOgogICAgICBjYXNlIDB4MzE6CiAgICAgIGNhc2UgMHgzMjoKICAgICAgY2FzZSAweDMzOgogICAgICBjYXNlIDB4MzQ6CiAgICAgIGNhc2UgMHgzNToKICAgICAgY2FzZSAweDM2OgogICAgICBjYXNlIDB4Mzc6CiAgICAgIGNhc2UgMHgzODoKICAgICAgY2FzZSAweDM5OgogICAgICBjYXNlIDB4MmI6CiAgICAgIGNhc2UgMHgyZDoKICAgICAgY2FzZSAweDJlOgogICAgICAgIHJldHVybiBuZXcgUG9zdFNjcmlwdFRva2VuKFBvc3RTY3JpcHRUb2tlblR5cGVzLk5VTUJFUiwgdGhpcy5nZXROdW1iZXIoKSk7CgogICAgICBjYXNlIDB4N2I6CiAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIHJldHVybiBQb3N0U2NyaXB0VG9rZW4uTEJSQUNFOwoKICAgICAgY2FzZSAweDdkOgogICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLlJCUkFDRTsKICAgIH0KCiAgICBjb25zdCBzdHJCdWYgPSB0aGlzLnN0ckJ1ZjsKICAgIHN0ckJ1Zi5sZW5ndGggPSAwOwogICAgc3RyQnVmWzBdID0gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CgogICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCAmJiAoY2ggPj0gMHg0MSAmJiBjaCA8PSAweDVhIHx8IGNoID49IDB4NjEgJiYgY2ggPD0gMHg3YSkpIHsKICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgfQoKICAgIGNvbnN0IHN0ciA9IHN0ckJ1Zi5qb2luKCIiKTsKCiAgICBzd2l0Y2ggKHN0ci50b0xvd2VyQ2FzZSgpKSB7CiAgICAgIGNhc2UgImlmIjoKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLklGOwoKICAgICAgY2FzZSAiaWZlbHNlIjoKICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLklGRUxTRTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5nZXRPcGVyYXRvcihzdHIpOwogICAgfQogIH0KCiAgZ2V0TnVtYmVyKCkgewogICAgbGV0IGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKICAgIGNvbnN0IHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICBzdHJCdWZbMF0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKCiAgICB3aGlsZSAoKGNoID0gdGhpcy5uZXh0Q2hhcigpKSA+PSAwKSB7CiAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkgfHwgY2ggPT09IDB4MmQgfHwgY2ggPT09IDB4MmUpIHsKICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyQnVmLmpvaW4oIiIpKTsKCiAgICBpZiAoaXNOYU4odmFsdWUpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBmbG9hdGluZyBwb2ludCBudW1iZXI6ICR7dmFsdWV9YCk7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCn0KCmV4cG9ydHMuUG9zdFNjcmlwdExleGVyID0gUG9zdFNjcmlwdExleGVyOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUgPSBleHBvcnRzLkxvY2FsSW1hZ2VDYWNoZSA9IGV4cG9ydHMuTG9jYWxHU3RhdGVDYWNoZSA9IGV4cG9ydHMuTG9jYWxGdW5jdGlvbkNhY2hlID0gZXhwb3J0cy5Mb2NhbENvbG9yU3BhY2VDYWNoZSA9IGV4cG9ydHMuR2xvYmFsSW1hZ2VDYWNoZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKY2xhc3MgQmFzZUxvY2FsQ2FjaGUgewogIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlTG9jYWxDYWNoZSkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBCYXNlTG9jYWxDYWNoZS4iKTsKICAgIH0KCiAgICB0aGlzLl9vbmx5UmVmcyA9IChvcHRpb25zICYmIG9wdGlvbnMub25seVJlZnMpID09PSB0cnVlOwoKICAgIGlmICghdGhpcy5fb25seVJlZnMpIHsKICAgICAgdGhpcy5fbmFtZVJlZk1hcCA9IG5ldyBNYXAoKTsKICAgICAgdGhpcy5faW1hZ2VNYXAgPSBuZXcgTWFwKCk7CiAgICB9CgogICAgdGhpcy5faW1hZ2VDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogIH0KCiAgZ2V0QnlOYW1lKG5hbWUpIHsKICAgIGlmICh0aGlzLl9vbmx5UmVmcykgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJTaG91bGQgbm90IGNhbGwgYGdldEJ5TmFtZWAgbWV0aG9kLiIpOwogICAgfQoKICAgIGNvbnN0IHJlZiA9IHRoaXMuX25hbWVSZWZNYXAuZ2V0KG5hbWUpOwoKICAgIGlmIChyZWYpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0QnlSZWYocmVmKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5faW1hZ2VNYXAuZ2V0KG5hbWUpIHx8IG51bGw7CiAgfQoKICBnZXRCeVJlZihyZWYpIHsKICAgIHJldHVybiB0aGlzLl9pbWFnZUNhY2hlLmdldChyZWYpIHx8IG51bGw7CiAgfQoKICBzZXQobmFtZSwgcmVmLCBkYXRhKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYHNldGAgY2FsbGVkLiIpOwogIH0KCn0KCmNsYXNzIExvY2FsSW1hZ2VDYWNoZSBleHRlbmRzIEJhc2VMb2NhbENhY2hlIHsKICBzZXQobmFtZSwgcmVmID0gbnVsbCwgZGF0YSkgewogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAic3RyaW5nIikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsSW1hZ2VDYWNoZS5zZXQgLSBleHBlY3RlZCAibmFtZSIgYXJndW1lbnQuJyk7CiAgICB9CgogICAgaWYgKHJlZikgewogICAgICBpZiAodGhpcy5faW1hZ2VDYWNoZS5oYXMocmVmKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fbmFtZVJlZk1hcC5zZXQobmFtZSwgcmVmKTsKCiAgICAgIHRoaXMuX2ltYWdlQ2FjaGUucHV0KHJlZiwgZGF0YSk7CgogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuX2ltYWdlTWFwLmhhcyhuYW1lKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5faW1hZ2VNYXAuc2V0KG5hbWUsIGRhdGEpOwogIH0KCn0KCmV4cG9ydHMuTG9jYWxJbWFnZUNhY2hlID0gTG9jYWxJbWFnZUNhY2hlOwoKY2xhc3MgTG9jYWxDb2xvclNwYWNlQ2FjaGUgZXh0ZW5kcyBCYXNlTG9jYWxDYWNoZSB7CiAgc2V0KG5hbWUgPSBudWxsLCByZWYgPSBudWxsLCBkYXRhKSB7CiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICJzdHJpbmciICYmICFyZWYpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2NhbENvbG9yU3BhY2VDYWNoZS5zZXQgLSBleHBlY3RlZCAibmFtZSIgYW5kL29yICJyZWYiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmIChyZWYpIHsKICAgICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChuYW1lICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5fbmFtZVJlZk1hcC5zZXQobmFtZSwgcmVmKTsKICAgICAgfQoKICAgICAgdGhpcy5faW1hZ2VDYWNoZS5wdXQocmVmLCBkYXRhKTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5faW1hZ2VNYXAuaGFzKG5hbWUpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9pbWFnZU1hcC5zZXQobmFtZSwgZGF0YSk7CiAgfQoKfQoKZXhwb3J0cy5Mb2NhbENvbG9yU3BhY2VDYWNoZSA9IExvY2FsQ29sb3JTcGFjZUNhY2hlOwoKY2xhc3MgTG9jYWxGdW5jdGlvbkNhY2hlIGV4dGVuZHMgQmFzZUxvY2FsQ2FjaGUgewogIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHsKICAgIHN1cGVyKHsKICAgICAgb25seVJlZnM6IHRydWUKICAgIH0pOwogIH0KCiAgc2V0KG5hbWUgPSBudWxsLCByZWYsIGRhdGEpIHsKICAgIGlmICghcmVmKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxGdW5jdGlvbkNhY2hlLnNldCAtIGV4cGVjdGVkICJyZWYiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwogIH0KCn0KCmV4cG9ydHMuTG9jYWxGdW5jdGlvbkNhY2hlID0gTG9jYWxGdW5jdGlvbkNhY2hlOwoKY2xhc3MgTG9jYWxHU3RhdGVDYWNoZSBleHRlbmRzIEJhc2VMb2NhbENhY2hlIHsKICBzZXQobmFtZSwgcmVmID0gbnVsbCwgZGF0YSkgewogICAgaWYgKHR5cGVvZiBuYW1lICE9PSAic3RyaW5nIikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsR1N0YXRlQ2FjaGUuc2V0IC0gZXhwZWN0ZWQgIm5hbWUiIGFyZ3VtZW50LicpOwogICAgfQoKICAgIGlmIChyZWYpIHsKICAgICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX25hbWVSZWZNYXAuc2V0KG5hbWUsIHJlZik7CgogICAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLl9pbWFnZU1hcC5oYXMobmFtZSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuX2ltYWdlTWFwLnNldChuYW1lLCBkYXRhKTsKICB9Cgp9CgpleHBvcnRzLkxvY2FsR1N0YXRlQ2FjaGUgPSBMb2NhbEdTdGF0ZUNhY2hlOwoKY2xhc3MgTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGUgZXh0ZW5kcyBCYXNlTG9jYWxDYWNoZSB7CiAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgc3VwZXIoewogICAgICBvbmx5UmVmczogdHJ1ZQogICAgfSk7CiAgfQoKICBzZXQobmFtZSA9IG51bGwsIHJlZiwgZGF0YSkgewogICAgaWYgKCFyZWYpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2NhbFRpbGluZ1BhdHRlcm5DYWNoZS5zZXQgLSBleHBlY3RlZCAicmVmIiBhcmd1bWVudC4nKTsKICAgIH0KCiAgICBpZiAodGhpcy5faW1hZ2VDYWNoZS5oYXMocmVmKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5faW1hZ2VDYWNoZS5wdXQocmVmLCBkYXRhKTsKICB9Cgp9CgpleHBvcnRzLkxvY2FsVGlsaW5nUGF0dGVybkNhY2hlID0gTG9jYWxUaWxpbmdQYXR0ZXJuQ2FjaGU7CgpjbGFzcyBHbG9iYWxJbWFnZUNhY2hlIHsKICBzdGF0aWMgZ2V0IE5VTV9QQUdFU19USFJFU0hPTEQoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIk5VTV9QQUdFU19USFJFU0hPTEQiLCAyKTsKICB9CgogIHN0YXRpYyBnZXQgTUlOX0lNQUdFU19UT19DQUNIRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTUlOX0lNQUdFU19UT19DQUNIRSIsIDEwKTsKICB9CgogIHN0YXRpYyBnZXQgTUFYX0JZVEVfU0laRSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTUFYX0JZVEVfU0laRSIsIDQwZTYpOwogIH0KCiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLl9yZWZDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5faW1hZ2VDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogIH0KCiAgZ2V0IF9ieXRlU2l6ZSgpIHsKICAgIGxldCBieXRlU2l6ZSA9IDA7CgogICAgZm9yIChjb25zdCBpbWFnZURhdGEgb2YgdGhpcy5faW1hZ2VDYWNoZSkgewogICAgICBieXRlU2l6ZSArPSBpbWFnZURhdGEuYnl0ZVNpemU7CiAgICB9CgogICAgcmV0dXJuIGJ5dGVTaXplOwogIH0KCiAgZ2V0IF9jYWNoZUxpbWl0UmVhY2hlZCgpIHsKICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLnNpemUgPCBHbG9iYWxJbWFnZUNhY2hlLk1JTl9JTUFHRVNfVE9fQ0FDSEUpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLl9ieXRlU2l6ZSA8IEdsb2JhbEltYWdlQ2FjaGUuTUFYX0JZVEVfU0laRSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBzaG91bGRDYWNoZShyZWYsIHBhZ2VJbmRleCkgewogICAgY29uc3QgcGFnZUluZGV4U2V0ID0gdGhpcy5fcmVmQ2FjaGUuZ2V0KHJlZik7CgogICAgY29uc3QgbnVtUGFnZXMgPSBwYWdlSW5kZXhTZXQgPyBwYWdlSW5kZXhTZXQuc2l6ZSArIChwYWdlSW5kZXhTZXQuaGFzKHBhZ2VJbmRleCkgPyAwIDogMSkgOiAxOwoKICAgIGlmIChudW1QYWdlcyA8IEdsb2JhbEltYWdlQ2FjaGUuTlVNX1BBR0VTX1RIUkVTSE9MRCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKCF0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpICYmIHRoaXMuX2NhY2hlTGltaXRSZWFjaGVkKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGFkZFBhZ2VJbmRleChyZWYsIHBhZ2VJbmRleCkgewogICAgbGV0IHBhZ2VJbmRleFNldCA9IHRoaXMuX3JlZkNhY2hlLmdldChyZWYpOwoKICAgIGlmICghcGFnZUluZGV4U2V0KSB7CiAgICAgIHBhZ2VJbmRleFNldCA9IG5ldyBTZXQoKTsKCiAgICAgIHRoaXMuX3JlZkNhY2hlLnB1dChyZWYsIHBhZ2VJbmRleFNldCk7CiAgICB9CgogICAgcGFnZUluZGV4U2V0LmFkZChwYWdlSW5kZXgpOwogIH0KCiAgYWRkQnl0ZVNpemUocmVmLCBieXRlU2l6ZSkgewogICAgY29uc3QgaW1hZ2VEYXRhID0gdGhpcy5faW1hZ2VDYWNoZS5nZXQocmVmKTsKCiAgICBpZiAoIWltYWdlRGF0YSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGltYWdlRGF0YS5ieXRlU2l6ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaW1hZ2VEYXRhLmJ5dGVTaXplID0gYnl0ZVNpemU7CiAgfQoKICBnZXREYXRhKHJlZiwgcGFnZUluZGV4KSB7CiAgICBjb25zdCBwYWdlSW5kZXhTZXQgPSB0aGlzLl9yZWZDYWNoZS5nZXQocmVmKTsKCiAgICBpZiAoIXBhZ2VJbmRleFNldCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAocGFnZUluZGV4U2V0LnNpemUgPCBHbG9iYWxJbWFnZUNhY2hlLk5VTV9QQUdFU19USFJFU0hPTEQpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3QgaW1hZ2VEYXRhID0gdGhpcy5faW1hZ2VDYWNoZS5nZXQocmVmKTsKCiAgICBpZiAoIWltYWdlRGF0YSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwYWdlSW5kZXhTZXQuYWRkKHBhZ2VJbmRleCk7CiAgICByZXR1cm4gaW1hZ2VEYXRhOwogIH0KCiAgc2V0RGF0YShyZWYsIGRhdGEpIHsKICAgIGlmICghdGhpcy5fcmVmQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdHbG9iYWxJbWFnZUNhY2hlLnNldERhdGEgLSBleHBlY3RlZCAiYWRkUGFnZUluZGV4IiB0byBoYXZlIGJlZW4gY2FsbGVkLicpOwogICAgfQoKICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5fY2FjaGVMaW1pdFJlYWNoZWQpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJHbG9iYWxJbWFnZUNhY2hlLnNldERhdGEgLSBjYWNoZSBsaW1pdCByZWFjaGVkLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5faW1hZ2VDYWNoZS5wdXQocmVmLCBkYXRhKTsKICB9CgogIGNsZWFyKG9ubHlEYXRhID0gZmFsc2UpIHsKICAgIGlmICghb25seURhdGEpIHsKICAgICAgdGhpcy5fcmVmQ2FjaGUuY2xlYXIoKTsKICAgIH0KCiAgICB0aGlzLl9pbWFnZUNhY2hlLmNsZWFyKCk7CiAgfQoKfQoKZXhwb3J0cy5HbG9iYWxJbWFnZUNhY2hlID0gR2xvYmFsSW1hZ2VDYWNoZTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmJpZGkgPSBiaWRpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IGJhc2VUeXBlcyA9IFsiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiUyIsICJCIiwgIlMiLCAiV1MiLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCIiwgIkIiLCAiQiIsICJTIiwgIldTIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVUIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkVTIiwgIkNTIiwgIkVTIiwgIkNTIiwgIkNTIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkNTIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiT04iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJDUyIsICJPTiIsICJFVCIsICJFVCIsICJFVCIsICJFVCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIk9OIiwgIk9OIiwgIkJOIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVOIiwgIkVOIiwgIk9OIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiRU4iLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiXTsKY29uc3QgYXJhYmljVHlwZXMgPSBbIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIk9OIiwgIk9OIiwgIkFMIiwgIkVUIiwgIkVUIiwgIkFMIiwgIkNTIiwgIkFMIiwgIk9OIiwgIk9OIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkFOIiwgIkVUIiwgIkFOIiwgIkFOIiwgIkFMIiwgIkFMIiwgIkFMIiwgIk5TTSIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQU4iLCAiT04iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiTlNNIiwgIk5TTSIsICJPTiIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiQUwiLCAiQUwiLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiRU4iLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiXTsKCmZ1bmN0aW9uIGlzT2RkKGkpIHsKICByZXR1cm4gKGkgJiAxKSAhPT0gMDsKfQoKZnVuY3Rpb24gaXNFdmVuKGkpIHsKICByZXR1cm4gKGkgJiAxKSA9PT0gMDsKfQoKZnVuY3Rpb24gZmluZFVuZXF1YWwoYXJyLCBzdGFydCwgdmFsdWUpIHsKICBsZXQgaiwgamo7CgogIGZvciAoaiA9IHN0YXJ0LCBqaiA9IGFyci5sZW5ndGg7IGogPCBqajsgKytqKSB7CiAgICBpZiAoYXJyW2pdICE9PSB2YWx1ZSkgewogICAgICByZXR1cm4gajsKICAgIH0KICB9CgogIHJldHVybiBqOwp9CgpmdW5jdGlvbiBzZXRWYWx1ZXMoYXJyLCBzdGFydCwgZW5kLCB2YWx1ZSkgewogIGZvciAobGV0IGogPSBzdGFydDsgaiA8IGVuZDsgKytqKSB7CiAgICBhcnJbal0gPSB2YWx1ZTsKICB9Cn0KCmZ1bmN0aW9uIHJldmVyc2VWYWx1ZXMoYXJyLCBzdGFydCwgZW5kKSB7CiAgZm9yIChsZXQgaSA9IHN0YXJ0LCBqID0gZW5kIC0gMTsgaSA8IGo7ICsraSwgLS1qKSB7CiAgICBjb25zdCB0ZW1wID0gYXJyW2ldOwogICAgYXJyW2ldID0gYXJyW2pdOwogICAgYXJyW2pdID0gdGVtcDsKICB9Cn0KCmZ1bmN0aW9uIGNyZWF0ZUJpZGlUZXh0KHN0ciwgaXNMVFIsIHZlcnRpY2FsID0gZmFsc2UpIHsKICBsZXQgZGlyID0gImx0ciI7CgogIGlmICh2ZXJ0aWNhbCkgewogICAgZGlyID0gInR0YiI7CiAgfSBlbHNlIGlmICghaXNMVFIpIHsKICAgIGRpciA9ICJydGwiOwogIH0KCiAgcmV0dXJuIHsKICAgIHN0ciwKICAgIGRpcgogIH07Cn0KCmNvbnN0IGNoYXJzID0gW107CmNvbnN0IHR5cGVzID0gW107CgpmdW5jdGlvbiBiaWRpKHN0ciwgc3RhcnRMZXZlbCA9IC0xLCB2ZXJ0aWNhbCA9IGZhbHNlKSB7CiAgbGV0IGlzTFRSID0gdHJ1ZTsKICBjb25zdCBzdHJMZW5ndGggPSBzdHIubGVuZ3RoOwoKICBpZiAoc3RyTGVuZ3RoID09PSAwIHx8IHZlcnRpY2FsKSB7CiAgICByZXR1cm4gY3JlYXRlQmlkaVRleHQoc3RyLCBpc0xUUiwgdmVydGljYWwpOwogIH0KCiAgY2hhcnMubGVuZ3RoID0gc3RyTGVuZ3RoOwogIHR5cGVzLmxlbmd0aCA9IHN0ckxlbmd0aDsKICBsZXQgbnVtQmlkaSA9IDA7CiAgbGV0IGksIGlpOwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIGNoYXJzW2ldID0gc3RyLmNoYXJBdChpKTsKICAgIGNvbnN0IGNoYXJDb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7CiAgICBsZXQgY2hhclR5cGUgPSAiTCI7CgogICAgaWYgKGNoYXJDb2RlIDw9IDB4MDBmZikgewogICAgICBjaGFyVHlwZSA9IGJhc2VUeXBlc1tjaGFyQ29kZV07CiAgICB9IGVsc2UgaWYgKDB4MDU5MCA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSAweDA1ZjQpIHsKICAgICAgY2hhclR5cGUgPSAiUiI7CiAgICB9IGVsc2UgaWYgKDB4MDYwMCA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSAweDA2ZmYpIHsKICAgICAgY2hhclR5cGUgPSBhcmFiaWNUeXBlc1tjaGFyQ29kZSAmIDB4ZmZdOwoKICAgICAgaWYgKCFjaGFyVHlwZSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiQmlkaTogaW52YWxpZCBVbmljb2RlIGNoYXJhY3RlciAiICsgY2hhckNvZGUudG9TdHJpbmcoMTYpKTsKICAgICAgfQogICAgfSBlbHNlIGlmICgweDA3MDAgPD0gY2hhckNvZGUgJiYgY2hhckNvZGUgPD0gMHgwOGFjKSB7CiAgICAgIGNoYXJUeXBlID0gIkFMIjsKICAgIH0KCiAgICBpZiAoY2hhclR5cGUgPT09ICJSIiB8fCBjaGFyVHlwZSA9PT0gIkFMIiB8fCBjaGFyVHlwZSA9PT0gIkFOIikgewogICAgICBudW1CaWRpKys7CiAgICB9CgogICAgdHlwZXNbaV0gPSBjaGFyVHlwZTsKICB9CgogIGlmIChudW1CaWRpID09PSAwKSB7CiAgICBpc0xUUiA9IHRydWU7CiAgICByZXR1cm4gY3JlYXRlQmlkaVRleHQoc3RyLCBpc0xUUik7CiAgfQoKICBpZiAoc3RhcnRMZXZlbCA9PT0gLTEpIHsKICAgIGlmIChudW1CaWRpIC8gc3RyTGVuZ3RoIDwgMC4zICYmIHN0ckxlbmd0aCA+IDQpIHsKICAgICAgaXNMVFIgPSB0cnVlOwogICAgICBzdGFydExldmVsID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGlzTFRSID0gZmFsc2U7CiAgICAgIHN0YXJ0TGV2ZWwgPSAxOwogICAgfQogIH0KCiAgY29uc3QgbGV2ZWxzID0gW107CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgbGV2ZWxzW2ldID0gc3RhcnRMZXZlbDsKICB9CgogIGNvbnN0IGUgPSBpc09kZChzdGFydExldmVsKSA/ICJSIiA6ICJMIjsKICBjb25zdCBzb3IgPSBlOwogIGNvbnN0IGVvciA9IHNvcjsKICBsZXQgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgaWYgKHR5cGVzW2ldID09PSAiTlNNIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlOwogICAgfSBlbHNlIHsKICAgICAgbGFzdFR5cGUgPSB0eXBlc1tpXTsKICAgIH0KICB9CgogIGxhc3RUeXBlID0gc29yOwogIGxldCB0OwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkVOIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlID09PSAiQUwiID8gIkFOIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIgfHwgdCA9PT0gIkFMIikgewogICAgICBsYXN0VHlwZSA9IHQ7CiAgICB9CiAgfQoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkFMIikgewogICAgICB0eXBlc1tpXSA9ICJSIjsKICAgIH0KICB9CgogIGZvciAoaSA9IDE7IGkgPCBzdHJMZW5ndGggLSAxOyArK2kpIHsKICAgIGlmICh0eXBlc1tpXSA9PT0gIkVTIiAmJiB0eXBlc1tpIC0gMV0gPT09ICJFTiIgJiYgdHlwZXNbaSArIDFdID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gIkVOIjsKICAgIH0KCiAgICBpZiAodHlwZXNbaV0gPT09ICJDUyIgJiYgKHR5cGVzW2kgLSAxXSA9PT0gIkVOIiB8fCB0eXBlc1tpIC0gMV0gPT09ICJBTiIpICYmIHR5cGVzW2kgKyAxXSA9PT0gdHlwZXNbaSAtIDFdKSB7CiAgICAgIHR5cGVzW2ldID0gdHlwZXNbaSAtIDFdOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJFTiIpIHsKICAgICAgZm9yIChsZXQgaiA9IGkgLSAxOyBqID49IDA7IC0taikgewogICAgICAgIGlmICh0eXBlc1tqXSAhPT0gIkVUIikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICB0eXBlc1tqXSA9ICJFTiI7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IHN0ckxlbmd0aDsgKytqKSB7CiAgICAgICAgaWYgKHR5cGVzW2pdICE9PSAiRVQiKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHR5cGVzW2pdID0gIkVOIjsKICAgICAgfQogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICB0ID0gdHlwZXNbaV07CgogICAgaWYgKHQgPT09ICJXUyIgfHwgdCA9PT0gIkVTIiB8fCB0ID09PSAiRVQiIHx8IHQgPT09ICJDUyIpIHsKICAgICAgdHlwZXNbaV0gPSAiT04iOwogICAgfQogIH0KCiAgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgdCA9IHR5cGVzW2ldOwoKICAgIGlmICh0ID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gbGFzdFR5cGUgPT09ICJMIiA/ICJMIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIpIHsKICAgICAgbGFzdFR5cGUgPSB0OwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJPTiIpIHsKICAgICAgY29uc3QgZW5kID0gZmluZFVuZXF1YWwodHlwZXMsIGkgKyAxLCAiT04iKTsKICAgICAgbGV0IGJlZm9yZSA9IHNvcjsKCiAgICAgIGlmIChpID4gMCkgewogICAgICAgIGJlZm9yZSA9IHR5cGVzW2kgLSAxXTsKICAgICAgfQoKICAgICAgbGV0IGFmdGVyID0gZW9yOwoKICAgICAgaWYgKGVuZCArIDEgPCBzdHJMZW5ndGgpIHsKICAgICAgICBhZnRlciA9IHR5cGVzW2VuZCArIDFdOwogICAgICB9CgogICAgICBpZiAoYmVmb3JlICE9PSAiTCIpIHsKICAgICAgICBiZWZvcmUgPSAiUiI7CiAgICAgIH0KCiAgICAgIGlmIChhZnRlciAhPT0gIkwiKSB7CiAgICAgICAgYWZ0ZXIgPSAiUiI7CiAgICAgIH0KCiAgICAgIGlmIChiZWZvcmUgPT09IGFmdGVyKSB7CiAgICAgICAgc2V0VmFsdWVzKHR5cGVzLCBpLCBlbmQsIGJlZm9yZSk7CiAgICAgIH0KCiAgICAgIGkgPSBlbmQgLSAxOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJPTiIpIHsKICAgICAgdHlwZXNbaV0gPSBlOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICB0ID0gdHlwZXNbaV07CgogICAgaWYgKGlzRXZlbihsZXZlbHNbaV0pKSB7CiAgICAgIGlmICh0ID09PSAiUiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMTsKICAgICAgfSBlbHNlIGlmICh0ID09PSAiQU4iIHx8IHQgPT09ICJFTiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKHQgPT09ICJMIiB8fCB0ID09PSAiQU4iIHx8IHQgPT09ICJFTiIpIHsKICAgICAgICBsZXZlbHNbaV0gKz0gMTsKICAgICAgfQogICAgfQogIH0KCiAgbGV0IGhpZ2hlc3RMZXZlbCA9IC0xOwogIGxldCBsb3dlc3RPZGRMZXZlbCA9IDk5OwogIGxldCBsZXZlbDsKCiAgZm9yIChpID0gMCwgaWkgPSBsZXZlbHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgbGV2ZWwgPSBsZXZlbHNbaV07CgogICAgaWYgKGhpZ2hlc3RMZXZlbCA8IGxldmVsKSB7CiAgICAgIGhpZ2hlc3RMZXZlbCA9IGxldmVsOwogICAgfQoKICAgIGlmIChsb3dlc3RPZGRMZXZlbCA+IGxldmVsICYmIGlzT2RkKGxldmVsKSkgewogICAgICBsb3dlc3RPZGRMZXZlbCA9IGxldmVsOwogICAgfQogIH0KCiAgZm9yIChsZXZlbCA9IGhpZ2hlc3RMZXZlbDsgbGV2ZWwgPj0gbG93ZXN0T2RkTGV2ZWw7IC0tbGV2ZWwpIHsKICAgIGxldCBzdGFydCA9IC0xOwoKICAgIGZvciAoaSA9IDAsIGlpID0gbGV2ZWxzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgaWYgKGxldmVsc1tpXSA8IGxldmVsKSB7CiAgICAgICAgaWYgKHN0YXJ0ID49IDApIHsKICAgICAgICAgIHJldmVyc2VWYWx1ZXMoY2hhcnMsIHN0YXJ0LCBpKTsKICAgICAgICAgIHN0YXJ0ID0gLTE7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHN0YXJ0IDwgMCkgewogICAgICAgIHN0YXJ0ID0gaTsKICAgICAgfQogICAgfQoKICAgIGlmIChzdGFydCA+PSAwKSB7CiAgICAgIHJldmVyc2VWYWx1ZXMoY2hhcnMsIHN0YXJ0LCBsZXZlbHMubGVuZ3RoKTsKICAgIH0KICB9CgogIGZvciAoaSA9IDAsIGlpID0gY2hhcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgY29uc3QgY2ggPSBjaGFyc1tpXTsKCiAgICBpZiAoY2ggPT09ICI8IiB8fCBjaCA9PT0gIj4iKSB7CiAgICAgIGNoYXJzW2ldID0gIiI7CiAgICB9CiAgfQoKICByZXR1cm4gY3JlYXRlQmlkaVRleHQoY2hhcnMuam9pbigiIiksIGlzTFRSKTsKfQoKLyoqKi8gfSksCi8qIDYxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTXVybXVySGFzaDNfNjQgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgU0VFRCA9IDB4YzNkMmUxZjA7CmNvbnN0IE1BU0tfSElHSCA9IDB4ZmZmZjAwMDA7CmNvbnN0IE1BU0tfTE9XID0gMHhmZmZmOwoKY2xhc3MgTXVybXVySGFzaDNfNjQgewogIGNvbnN0cnVjdG9yKHNlZWQpIHsKICAgIHRoaXMuaDEgPSBzZWVkID8gc2VlZCAmIDB4ZmZmZmZmZmYgOiBTRUVEOwogICAgdGhpcy5oMiA9IHNlZWQgPyBzZWVkICYgMHhmZmZmZmZmZiA6IFNFRUQ7CiAgfQoKICB1cGRhdGUoaW5wdXQpIHsKICAgIGxldCBkYXRhLCBsZW5ndGg7CgogICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gInN0cmluZyIpIHsKICAgICAgZGF0YSA9IG5ldyBVaW50OEFycmF5KGlucHV0Lmxlbmd0aCAqIDIpOwogICAgICBsZW5ndGggPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gaW5wdXQubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGNvZGUgPSBpbnB1dC5jaGFyQ29kZUF0KGkpOwoKICAgICAgICBpZiAoY29kZSA8PSAweGZmKSB7CiAgICAgICAgICBkYXRhW2xlbmd0aCsrXSA9IGNvZGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRhdGFbbGVuZ3RoKytdID0gY29kZSA+Pj4gODsKICAgICAgICAgIGRhdGFbbGVuZ3RoKytdID0gY29kZSAmIDB4ZmY7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc0FycmF5QnVmZmVyKShpbnB1dCkpIHsKICAgICAgZGF0YSA9IGlucHV0LnNsaWNlKCk7CiAgICAgIGxlbmd0aCA9IGRhdGEuYnl0ZUxlbmd0aDsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV3JvbmcgZGF0YSBmb3JtYXQgaW4gTXVybXVySGFzaDNfNjRfdXBkYXRlLiAiICsgIklucHV0IG11c3QgYmUgYSBzdHJpbmcgb3IgYXJyYXkuIik7CiAgICB9CgogICAgY29uc3QgYmxvY2tDb3VudHMgPSBsZW5ndGggPj4gMjsKICAgIGNvbnN0IHRhaWxMZW5ndGggPSBsZW5ndGggLSBibG9ja0NvdW50cyAqIDQ7CiAgICBjb25zdCBkYXRhVWludDMyID0gbmV3IFVpbnQzMkFycmF5KGRhdGEuYnVmZmVyLCAwLCBibG9ja0NvdW50cyk7CiAgICBsZXQgazEgPSAwLAogICAgICAgIGsyID0gMDsKICAgIGxldCBoMSA9IHRoaXMuaDEsCiAgICAgICAgaDIgPSB0aGlzLmgyOwogICAgY29uc3QgQzEgPSAweGNjOWUyZDUxLAogICAgICAgICAgQzIgPSAweDFiODczNTkzOwogICAgY29uc3QgQzFfTE9XID0gQzEgJiBNQVNLX0xPVywKICAgICAgICAgIEMyX0xPVyA9IEMyICYgTUFTS19MT1c7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja0NvdW50czsgaSsrKSB7CiAgICAgIGlmIChpICYgMSkgewogICAgICAgIGsxID0gZGF0YVVpbnQzMltpXTsKICAgICAgICBrMSA9IGsxICogQzEgJiBNQVNLX0hJR0ggfCBrMSAqIEMxX0xPVyAmIE1BU0tfTE9XOwogICAgICAgIGsxID0gazEgPDwgMTUgfCBrMSA+Pj4gMTc7CiAgICAgICAgazEgPSBrMSAqIEMyICYgTUFTS19ISUdIIHwgazEgKiBDMl9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBoMSBePSBrMTsKICAgICAgICBoMSA9IGgxIDw8IDEzIHwgaDEgPj4+IDE5OwogICAgICAgIGgxID0gaDEgKiA1ICsgMHhlNjU0NmI2NDsKICAgICAgfSBlbHNlIHsKICAgICAgICBrMiA9IGRhdGFVaW50MzJbaV07CiAgICAgICAgazIgPSBrMiAqIEMxICYgTUFTS19ISUdIIHwgazIgKiBDMV9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBrMiA9IGsyIDw8IDE1IHwgazIgPj4+IDE3OwogICAgICAgIGsyID0gazIgKiBDMiAmIE1BU0tfSElHSCB8IGsyICogQzJfTE9XICYgTUFTS19MT1c7CiAgICAgICAgaDIgXj0gazI7CiAgICAgICAgaDIgPSBoMiA8PCAxMyB8IGgyID4+PiAxOTsKICAgICAgICBoMiA9IGgyICogNSArIDB4ZTY1NDZiNjQ7CiAgICAgIH0KICAgIH0KCiAgICBrMSA9IDA7CgogICAgc3dpdGNoICh0YWlsTGVuZ3RoKSB7CiAgICAgIGNhc2UgMzoKICAgICAgICBrMSBePSBkYXRhW2Jsb2NrQ291bnRzICogNCArIDJdIDw8IDE2OwoKICAgICAgY2FzZSAyOgogICAgICAgIGsxIF49IGRhdGFbYmxvY2tDb3VudHMgKiA0ICsgMV0gPDwgODsKCiAgICAgIGNhc2UgMToKICAgICAgICBrMSBePSBkYXRhW2Jsb2NrQ291bnRzICogNF07CiAgICAgICAgazEgPSBrMSAqIEMxICYgTUFTS19ISUdIIHwgazEgKiBDMV9MT1cgJiBNQVNLX0xPVzsKICAgICAgICBrMSA9IGsxIDw8IDE1IHwgazEgPj4+IDE3OwogICAgICAgIGsxID0gazEgKiBDMiAmIE1BU0tfSElHSCB8IGsxICogQzJfTE9XICYgTUFTS19MT1c7CgogICAgICAgIGlmIChibG9ja0NvdW50cyAmIDEpIHsKICAgICAgICAgIGgxIF49IGsxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoMiBePSBrMTsKICAgICAgICB9CgogICAgfQoKICAgIHRoaXMuaDEgPSBoMTsKICAgIHRoaXMuaDIgPSBoMjsKICB9CgogIGhleGRpZ2VzdCgpIHsKICAgIGxldCBoMSA9IHRoaXMuaDEsCiAgICAgICAgaDIgPSB0aGlzLmgyOwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBoMSA9IGgxICogMHhlZDU1OGNjZCAmIE1BU0tfSElHSCB8IGgxICogMHg4Y2NkICYgTUFTS19MT1c7CiAgICBoMiA9IGgyICogMHhmZjUxYWZkNyAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhhZmQ3ZWQ1NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBoMSA9IGgxICogMHgxYTg1ZWM1MyAmIE1BU0tfSElHSCB8IGgxICogMHhlYzUzICYgTUFTS19MT1c7CiAgICBoMiA9IGgyICogMHhjNGNlYjlmZSAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhiOWZlMWE4NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgaDEgXj0gaDIgPj4+IDE7CiAgICBjb25zdCBoZXgxID0gKGgxID4+PiAwKS50b1N0cmluZygxNiksCiAgICAgICAgICBoZXgyID0gKGgyID4+PiAwKS50b1N0cmluZygxNik7CiAgICByZXR1cm4gaGV4MS5wYWRTdGFydCg4LCAiMCIpICsgaGV4Mi5wYWRTdGFydCg4LCAiMCIpOwogIH0KCn0KCmV4cG9ydHMuTXVybXVySGFzaDNfNjQgPSBNdXJtdXJIYXNoM182NDsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9wZXJhdG9yTGlzdCA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpmdW5jdGlvbiBhZGRTdGF0ZShwYXJlbnRTdGF0ZSwgcGF0dGVybiwgY2hlY2tGbiwgaXRlcmF0ZUZuLCBwcm9jZXNzRm4pIHsKICBsZXQgc3RhdGUgPSBwYXJlbnRTdGF0ZTsKCiAgZm9yIChsZXQgaSA9IDAsIGlpID0gcGF0dGVybi5sZW5ndGggLSAxOyBpIDwgaWk7IGkrKykgewogICAgY29uc3QgaXRlbSA9IHBhdHRlcm5baV07CiAgICBzdGF0ZSA9IHN0YXRlW2l0ZW1dIHx8IChzdGF0ZVtpdGVtXSA9IFtdKTsKICB9CgogIHN0YXRlW3BhdHRlcm4uYXQoLTEpXSA9IHsKICAgIGNoZWNrRm4sCiAgICBpdGVyYXRlRm4sCiAgICBwcm9jZXNzRm4KICB9Owp9Cgpjb25zdCBJbml0aWFsU3RhdGUgPSBbXTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBudWxsLCBmdW5jdGlvbiBpdGVyYXRlSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgY29uc3QgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheTsKICBjb25zdCBpRmlyc3RTYXZlID0gY29udGV4dC5pQ3VyciAtIDM7CiAgY29uc3QgcG9zID0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CgogIHN3aXRjaCAocG9zKSB7CiAgICBjYXNlIDA6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2F2ZTsKCiAgICBjYXNlIDE6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMudHJhbnNmb3JtOwoKICAgIGNhc2UgMjoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdDsKCiAgICBjYXNlIDM6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZUlubGluZUltYWdlR3JvdXAgLSBpbnZhbGlkIHBvczogJHtwb3N9YCk7Cn0sIGZ1bmN0aW9uIGZvdW5kSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgY29uc3QgTUlOX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMTA7CiAgY29uc3QgTUFYX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMjAwOwogIGNvbnN0IE1BWF9XSURUSCA9IDEwMDA7CiAgY29uc3QgSU1BR0VfUEFERElORyA9IDE7CiAgY29uc3QgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheSwKICAgICAgICBhcmdzQXJyYXkgPSBjb250ZXh0LmFyZ3NBcnJheTsKICBjb25zdCBjdXJyID0gY29udGV4dC5pQ3VycjsKICBjb25zdCBpRmlyc3RTYXZlID0gY3VyciAtIDM7CiAgY29uc3QgaUZpcnN0VHJhbnNmb3JtID0gY3VyciAtIDI7CiAgY29uc3QgaUZpcnN0UElJWE8gPSBjdXJyIC0gMTsKICBjb25zdCBjb3VudCA9IE1hdGgubWluKE1hdGguZmxvb3IoKGkgLSBpRmlyc3RTYXZlKSAvIDQpLCBNQVhfSU1BR0VTX0lOX0lOTElORV9JTUFHRVNfQkxPQ0spOwoKICBpZiAoY291bnQgPCBNSU5fSU1BR0VTX0lOX0lOTElORV9JTUFHRVNfQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CiAgfQoKICBsZXQgbWF4WCA9IDA7CiAgY29uc3QgbWFwID0gW107CiAgbGV0IG1heExpbmVIZWlnaHQgPSAwOwogIGxldCBjdXJyZW50WCA9IElNQUdFX1BBRERJTkcsCiAgICAgIGN1cnJlbnRZID0gSU1BR0VfUEFERElORzsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb3VudDsgcSsrKSB7CiAgICBjb25zdCB0cmFuc2Zvcm0gPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtICsgKHEgPDwgMildOwogICAgY29uc3QgaW1nID0gYXJnc0FycmF5W2lGaXJzdFBJSVhPICsgKHEgPDwgMildWzBdOwoKICAgIGlmIChjdXJyZW50WCArIGltZy53aWR0aCA+IE1BWF9XSURUSCkgewogICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgY3VycmVudFgpOwogICAgICBjdXJyZW50WSArPSBtYXhMaW5lSGVpZ2h0ICsgMiAqIElNQUdFX1BBRERJTkc7CiAgICAgIGN1cnJlbnRYID0gMDsKICAgICAgbWF4TGluZUhlaWdodCA9IDA7CiAgICB9CgogICAgbWFwLnB1c2goewogICAgICB0cmFuc2Zvcm0sCiAgICAgIHg6IGN1cnJlbnRYLAogICAgICB5OiBjdXJyZW50WSwKICAgICAgdzogaW1nLndpZHRoLAogICAgICBoOiBpbWcuaGVpZ2h0CiAgICB9KTsKICAgIGN1cnJlbnRYICs9IGltZy53aWR0aCArIDIgKiBJTUFHRV9QQURESU5HOwogICAgbWF4TGluZUhlaWdodCA9IE1hdGgubWF4KG1heExpbmVIZWlnaHQsIGltZy5oZWlnaHQpOwogIH0KCiAgY29uc3QgaW1nV2lkdGggPSBNYXRoLm1heChtYXhYLCBjdXJyZW50WCkgKyBJTUFHRV9QQURESU5HOwogIGNvbnN0IGltZ0hlaWdodCA9IGN1cnJlbnRZICsgbWF4TGluZUhlaWdodCArIElNQUdFX1BBRERJTkc7CiAgY29uc3QgaW1nRGF0YSA9IG5ldyBVaW50OEFycmF5KGltZ1dpZHRoICogaW1nSGVpZ2h0ICogNCk7CiAgY29uc3QgaW1nUm93U2l6ZSA9IGltZ1dpZHRoIDw8IDI7CgogIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKykgewogICAgY29uc3QgZGF0YSA9IGFyZ3NBcnJheVtpRmlyc3RQSUlYTyArIChxIDw8IDIpXVswXS5kYXRhOwogICAgY29uc3Qgcm93U2l6ZSA9IG1hcFtxXS53IDw8IDI7CiAgICBsZXQgZGF0YU9mZnNldCA9IDA7CiAgICBsZXQgb2Zmc2V0ID0gbWFwW3FdLnggKyBtYXBbcV0ueSAqIGltZ1dpZHRoIDw8IDI7CiAgICBpbWdEYXRhLnNldChkYXRhLnN1YmFycmF5KDAsIHJvd1NpemUpLCBvZmZzZXQgLSBpbWdSb3dTaXplKTsKCiAgICBmb3IgKGxldCBrID0gMCwga2sgPSBtYXBbcV0uaDsgayA8IGtrOyBrKyspIHsKICAgICAgaW1nRGF0YS5zZXQoZGF0YS5zdWJhcnJheShkYXRhT2Zmc2V0LCBkYXRhT2Zmc2V0ICsgcm93U2l6ZSksIG9mZnNldCk7CiAgICAgIGRhdGFPZmZzZXQgKz0gcm93U2l6ZTsKICAgICAgb2Zmc2V0ICs9IGltZ1Jvd1NpemU7CiAgICB9CgogICAgaW1nRGF0YS5zZXQoZGF0YS5zdWJhcnJheShkYXRhT2Zmc2V0IC0gcm93U2l6ZSwgZGF0YU9mZnNldCksIG9mZnNldCk7CgogICAgd2hpbGUgKG9mZnNldCA+PSAwKSB7CiAgICAgIGRhdGFbb2Zmc2V0IC0gNF0gPSBkYXRhW29mZnNldF07CiAgICAgIGRhdGFbb2Zmc2V0IC0gM10gPSBkYXRhW29mZnNldCArIDFdOwogICAgICBkYXRhW29mZnNldCAtIDJdID0gZGF0YVtvZmZzZXQgKyAyXTsKICAgICAgZGF0YVtvZmZzZXQgLSAxXSA9IGRhdGFbb2Zmc2V0ICsgM107CiAgICAgIGRhdGFbb2Zmc2V0ICsgcm93U2l6ZV0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSA0XTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgMV0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAzXTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgMl0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAyXTsKICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgM10gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAxXTsKICAgICAgb2Zmc2V0IC09IGltZ1Jvd1NpemU7CiAgICB9CiAgfQoKICBmbkFycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdEdyb3VwKTsKICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW3sKICAgIHdpZHRoOiBpbWdXaWR0aCwKICAgIGhlaWdodDogaW1nSGVpZ2h0LAogICAga2luZDogX3V0aWwuSW1hZ2VLaW5kLlJHQkFfMzJCUFAsCiAgICBkYXRhOiBpbWdEYXRhCiAgfSwgbWFwXSk7CiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QsIF91dGlsLk9QUy5yZXN0b3JlXSwgbnVsbCwgZnVuY3Rpb24gaXRlcmF0ZUltYWdlTWFza0dyb3VwKGNvbnRleHQsIGkpIHsKICBjb25zdCBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5OwogIGNvbnN0IGlGaXJzdFNhdmUgPSBjb250ZXh0LmlDdXJyIC0gMzsKICBjb25zdCBwb3MgPSAoaSAtIGlGaXJzdFNhdmUpICUgNDsKCiAgc3dpdGNoIChwb3MpIHsKICAgIGNhc2UgMDoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5zYXZlOwoKICAgIGNhc2UgMToKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy50cmFuc2Zvcm07CgogICAgY2FzZSAyOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdDsKCiAgICBjYXNlIDM6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZUltYWdlTWFza0dyb3VwIC0gaW52YWxpZCBwb3M6ICR7cG9zfWApOwp9LCBmdW5jdGlvbiBmb3VuZEltYWdlTWFza0dyb3VwKGNvbnRleHQsIGkpIHsKICBjb25zdCBNSU5fSU1BR0VTX0lOX01BU0tTX0JMT0NLID0gMTA7CiAgY29uc3QgTUFYX0lNQUdFU19JTl9NQVNLU19CTE9DSyA9IDEwMDsKICBjb25zdCBNQVhfU0FNRV9JTUFHRVNfSU5fTUFTS1NfQkxPQ0sgPSAxMDAwOwogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgY3VyciA9IGNvbnRleHQuaUN1cnI7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGN1cnIgLSAzOwogIGNvbnN0IGlGaXJzdFRyYW5zZm9ybSA9IGN1cnIgLSAyOwogIGNvbnN0IGlGaXJzdFBJTVhPID0gY3VyciAtIDE7CiAgbGV0IGNvdW50ID0gTWF0aC5mbG9vcigoaSAtIGlGaXJzdFNhdmUpIC8gNCk7CgogIGlmIChjb3VudCA8IE1JTl9JTUFHRVNfSU5fTUFTS1NfQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CiAgfQoKICBsZXQgaXNTYW1lSW1hZ2UgPSBmYWxzZTsKICBsZXQgaVRyYW5zZm9ybSwgdHJhbnNmb3JtQXJnczsKICBjb25zdCBmaXJzdFBJTVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSU1YT11bMF07CiAgY29uc3QgZmlyc3RUcmFuc2Zvcm1BcmcwID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMF0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmcxID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMV0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmcyID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMl0sCiAgICAgICAgZmlyc3RUcmFuc2Zvcm1BcmczID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bM107CgogIGlmIChmaXJzdFRyYW5zZm9ybUFyZzEgPT09IGZpcnN0VHJhbnNmb3JtQXJnMikgewogICAgaXNTYW1lSW1hZ2UgPSB0cnVlOwogICAgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybSArIDQ7CiAgICBsZXQgaVBJTVhPID0gaUZpcnN0UElNWE8gKyA0OwoKICAgIGZvciAobGV0IHEgPSAxOyBxIDwgY291bnQ7IHErKywgaVRyYW5zZm9ybSArPSA0LCBpUElNWE8gKz0gNCkgewogICAgICB0cmFuc2Zvcm1BcmdzID0gYXJnc0FycmF5W2lUcmFuc2Zvcm1dOwoKICAgICAgaWYgKGFyZ3NBcnJheVtpUElNWE9dWzBdICE9PSBmaXJzdFBJTVhPQXJnMCB8fCB0cmFuc2Zvcm1BcmdzWzBdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzAgfHwgdHJhbnNmb3JtQXJnc1sxXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmcxIHx8IHRyYW5zZm9ybUFyZ3NbMl0gIT09IGZpcnN0VHJhbnNmb3JtQXJnMiB8fCB0cmFuc2Zvcm1BcmdzWzNdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzMpIHsKICAgICAgICBpZiAocSA8IE1JTl9JTUFHRVNfSU5fTUFTS1NfQkxPQ0spIHsKICAgICAgICAgIGlzU2FtZUltYWdlID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvdW50ID0gcTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoaXNTYW1lSW1hZ2UpIHsKICAgIGNvdW50ID0gTWF0aC5taW4oY291bnQsIE1BWF9TQU1FX0lNQUdFU19JTl9NQVNLU19CTE9DSyk7CiAgICBjb25zdCBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KGNvdW50ICogMik7CiAgICBpVHJhbnNmb3JtID0gaUZpcnN0VHJhbnNmb3JtOwoKICAgIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKywgaVRyYW5zZm9ybSArPSA0KSB7CiAgICAgIHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CiAgICAgIHBvc2l0aW9uc1txIDw8IDFdID0gdHJhbnNmb3JtQXJnc1s0XTsKICAgICAgcG9zaXRpb25zWyhxIDw8IDEpICsgMV0gPSB0cmFuc2Zvcm1BcmdzWzVdOwogICAgfQoKICAgIGZuQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdFJlcGVhdCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW2ZpcnN0UElNWE9BcmcwLCBmaXJzdFRyYW5zZm9ybUFyZzAsIGZpcnN0VHJhbnNmb3JtQXJnMSwgZmlyc3RUcmFuc2Zvcm1BcmcyLCBmaXJzdFRyYW5zZm9ybUFyZzMsIHBvc2l0aW9uc10pOwogIH0gZWxzZSB7CiAgICBjb3VudCA9IE1hdGgubWluKGNvdW50LCBNQVhfSU1BR0VTX0lOX01BU0tTX0JMT0NLKTsKICAgIGNvbnN0IGltYWdlcyA9IFtdOwoKICAgIGZvciAobGV0IHEgPSAwOyBxIDwgY291bnQ7IHErKykgewogICAgICB0cmFuc2Zvcm1BcmdzID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybSArIChxIDw8IDIpXTsKICAgICAgY29uc3QgbWFza1BhcmFtcyA9IGFyZ3NBcnJheVtpRmlyc3RQSU1YTyArIChxIDw8IDIpXVswXTsKICAgICAgaW1hZ2VzLnB1c2goewogICAgICAgIGRhdGE6IG1hc2tQYXJhbXMuZGF0YSwKICAgICAgICB3aWR0aDogbWFza1BhcmFtcy53aWR0aCwKICAgICAgICBoZWlnaHQ6IG1hc2tQYXJhbXMuaGVpZ2h0LAogICAgICAgIGludGVycG9sYXRlOiBtYXNrUGFyYW1zLmludGVycG9sYXRlLAogICAgICAgIGNvdW50OiBtYXNrUGFyYW1zLmNvdW50LAogICAgICAgIHRyYW5zZm9ybTogdHJhbnNmb3JtQXJncwogICAgICB9KTsKICAgIH0KCiAgICBmbkFycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3RHcm91cCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW2ltYWdlc10pOwogIH0KCiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBmdW5jdGlvbiAoY29udGV4dCkgewogIGNvbnN0IGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogIGNvbnN0IGlGaXJzdFRyYW5zZm9ybSA9IGNvbnRleHQuaUN1cnIgLSAyOwogIHJldHVybiBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVsxXSA9PT0gMCAmJiBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVsyXSA9PT0gMDsKfSwgZnVuY3Rpb24gaXRlcmF0ZUltYWdlR3JvdXAoY29udGV4dCwgaSkgewogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGNvbnRleHQuaUN1cnIgLSAzOwogIGNvbnN0IHBvcyA9IChpIC0gaUZpcnN0U2F2ZSkgJSA0OwoKICBzd2l0Y2ggKHBvcykgewogICAgY2FzZSAwOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnNhdmU7CgogICAgY2FzZSAxOgogICAgICBpZiAoZm5BcnJheVtpXSAhPT0gX3V0aWwuT1BTLnRyYW5zZm9ybSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgY29uc3QgaUZpcnN0VHJhbnNmb3JtID0gY29udGV4dC5pQ3VyciAtIDI7CiAgICAgIGNvbnN0IGZpcnN0VHJhbnNmb3JtQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm1dWzBdOwogICAgICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0VHJhbnNmb3JtQXJnMCB8fCBhcmdzQXJyYXlbaV1bMV0gIT09IDAgfHwgYXJnc0FycmF5W2ldWzJdICE9PSAwIHx8IGFyZ3NBcnJheVtpXVszXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmczKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKCiAgICBjYXNlIDI6CiAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMucGFpbnRJbWFnZVhPYmplY3QpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlGaXJzdFBJWE8gPSBjb250ZXh0LmlDdXJyIC0gMTsKICAgICAgY29uc3QgZmlyc3RQSVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSVhPXVswXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0UElYT0FyZzApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGNhc2UgMzoKICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5yZXN0b3JlOwogIH0KCiAgdGhyb3cgbmV3IEVycm9yKGBpdGVyYXRlSW1hZ2VHcm91cCAtIGludmFsaWQgcG9zOiAke3Bvc31gKTsKfSwgZnVuY3Rpb24gKGNvbnRleHQsIGkpIHsKICBjb25zdCBNSU5fSU1BR0VTX0lOX0JMT0NLID0gMzsKICBjb25zdCBNQVhfSU1BR0VTX0lOX0JMT0NLID0gMTAwMDsKICBjb25zdCBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5LAogICAgICAgIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogIGNvbnN0IGN1cnIgPSBjb250ZXh0LmlDdXJyOwogIGNvbnN0IGlGaXJzdFNhdmUgPSBjdXJyIC0gMzsKICBjb25zdCBpRmlyc3RUcmFuc2Zvcm0gPSBjdXJyIC0gMjsKICBjb25zdCBpRmlyc3RQSVhPID0gY3VyciAtIDE7CiAgY29uc3QgZmlyc3RQSVhPQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RQSVhPXVswXTsKICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzAgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVswXTsKICBjb25zdCBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKICBjb25zdCBjb3VudCA9IE1hdGgubWluKE1hdGguZmxvb3IoKGkgLSBpRmlyc3RTYXZlKSAvIDQpLCBNQVhfSU1BR0VTX0lOX0JMT0NLKTsKCiAgaWYgKGNvdW50IDwgTUlOX0lNQUdFU19JTl9CTE9DSykgewogICAgcmV0dXJuIGkgLSAoaSAtIGlGaXJzdFNhdmUpICUgNDsKICB9CgogIGNvbnN0IHBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoY291bnQgKiAyKTsKICBsZXQgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybTsKCiAgZm9yIChsZXQgcSA9IDA7IHEgPCBjb3VudDsgcSsrLCBpVHJhbnNmb3JtICs9IDQpIHsKICAgIGNvbnN0IHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CiAgICBwb3NpdGlvbnNbcSA8PCAxXSA9IHRyYW5zZm9ybUFyZ3NbNF07CiAgICBwb3NpdGlvbnNbKHEgPDwgMSkgKyAxXSA9IHRyYW5zZm9ybUFyZ3NbNV07CiAgfQoKICBjb25zdCBhcmdzID0gW2ZpcnN0UElYT0FyZzAsIGZpcnN0VHJhbnNmb3JtQXJnMCwgZmlyc3RUcmFuc2Zvcm1BcmczLCBwb3NpdGlvbnNdOwogIGZuQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0UmVwZWF0KTsKICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgYXJncyk7CiAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwp9KTsKYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLmJlZ2luVGV4dCwgX3V0aWwuT1BTLnNldEZvbnQsIF91dGlsLk9QUy5zZXRUZXh0TWF0cml4LCBfdXRpbC5PUFMuc2hvd1RleHQsIF91dGlsLk9QUy5lbmRUZXh0XSwgbnVsbCwgZnVuY3Rpb24gaXRlcmF0ZVNob3dUZXh0R3JvdXAoY29udGV4dCwgaSkgewogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgaUZpcnN0U2F2ZSA9IGNvbnRleHQuaUN1cnIgLSA0OwogIGNvbnN0IHBvcyA9IChpIC0gaUZpcnN0U2F2ZSkgJSA1OwoKICBzd2l0Y2ggKHBvcykgewogICAgY2FzZSAwOgogICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLmJlZ2luVGV4dDsKCiAgICBjYXNlIDE6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2V0Rm9udDsKCiAgICBjYXNlIDI6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2V0VGV4dE1hdHJpeDsKCiAgICBjYXNlIDM6CiAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMuc2hvd1RleHQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlGaXJzdFNldEZvbnQgPSBjb250ZXh0LmlDdXJyIC0gMzsKICAgICAgY29uc3QgZmlyc3RTZXRGb250QXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVswXTsKICAgICAgY29uc3QgZmlyc3RTZXRGb250QXJnMSA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVsxXTsKCiAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0U2V0Rm9udEFyZzAgfHwgYXJnc0FycmF5W2ldWzFdICE9PSBmaXJzdFNldEZvbnRBcmcxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKCiAgICBjYXNlIDQ6CiAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuZW5kVGV4dDsKICB9CgogIHRocm93IG5ldyBFcnJvcihgaXRlcmF0ZVNob3dUZXh0R3JvdXAgLSBpbnZhbGlkIHBvczogJHtwb3N9YCk7Cn0sIGZ1bmN0aW9uIChjb250ZXh0LCBpKSB7CiAgY29uc3QgTUlOX0NIQVJTX0lOX0JMT0NLID0gMzsKICBjb25zdCBNQVhfQ0hBUlNfSU5fQkxPQ0sgPSAxMDAwOwogIGNvbnN0IGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgY29uc3QgY3VyciA9IGNvbnRleHQuaUN1cnI7CiAgY29uc3QgaUZpcnN0QmVnaW5UZXh0ID0gY3VyciAtIDQ7CiAgY29uc3QgaUZpcnN0U2V0Rm9udCA9IGN1cnIgLSAzOwogIGNvbnN0IGlGaXJzdFNldFRleHRNYXRyaXggPSBjdXJyIC0gMjsKICBjb25zdCBpRmlyc3RTaG93VGV4dCA9IGN1cnIgLSAxOwogIGNvbnN0IGlGaXJzdEVuZFRleHQgPSBjdXJyOwogIGNvbnN0IGZpcnN0U2V0Rm9udEFyZzAgPSBhcmdzQXJyYXlbaUZpcnN0U2V0Rm9udF1bMF07CiAgY29uc3QgZmlyc3RTZXRGb250QXJnMSA9IGFyZ3NBcnJheVtpRmlyc3RTZXRGb250XVsxXTsKICBsZXQgY291bnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKChpIC0gaUZpcnN0QmVnaW5UZXh0KSAvIDUpLCBNQVhfQ0hBUlNfSU5fQkxPQ0spOwoKICBpZiAoY291bnQgPCBNSU5fQ0hBUlNfSU5fQkxPQ0spIHsKICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RCZWdpblRleHQpICUgNTsKICB9CgogIGxldCBpRmlyc3QgPSBpRmlyc3RCZWdpblRleHQ7CgogIGlmIChpRmlyc3RCZWdpblRleHQgPj0gNCAmJiBmbkFycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDRdID09PSBmbkFycmF5W2lGaXJzdFNldEZvbnRdICYmIGZuQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gM10gPT09IGZuQXJyYXlbaUZpcnN0U2V0VGV4dE1hdHJpeF0gJiYgZm5BcnJheVtpRmlyc3RCZWdpblRleHQgLSAyXSA9PT0gZm5BcnJheVtpRmlyc3RTaG93VGV4dF0gJiYgZm5BcnJheVtpRmlyc3RCZWdpblRleHQgLSAxXSA9PT0gZm5BcnJheVtpRmlyc3RFbmRUZXh0XSAmJiBhcmdzQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gNF1bMF0gPT09IGZpcnN0U2V0Rm9udEFyZzAgJiYgYXJnc0FycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDRdWzFdID09PSBmaXJzdFNldEZvbnRBcmcxKSB7CiAgICBjb3VudCsrOwogICAgaUZpcnN0IC09IDU7CiAgfQoKICBsZXQgaUVuZFRleHQgPSBpRmlyc3QgKyA0OwoKICBmb3IgKGxldCBxID0gMTsgcSA8IGNvdW50OyBxKyspIHsKICAgIGZuQXJyYXkuc3BsaWNlKGlFbmRUZXh0LCAzKTsKICAgIGFyZ3NBcnJheS5zcGxpY2UoaUVuZFRleHQsIDMpOwogICAgaUVuZFRleHQgKz0gMjsKICB9CgogIHJldHVybiBpRW5kVGV4dCArIDE7Cn0pOwoKY2xhc3MgTnVsbE9wdGltaXplciB7CiAgY29uc3RydWN0b3IocXVldWUpIHsKICAgIHRoaXMucXVldWUgPSBxdWV1ZTsKICB9CgogIF9vcHRpbWl6ZSgpIHt9CgogIHB1c2goZm4sIGFyZ3MpIHsKICAgIHRoaXMucXVldWUuZm5BcnJheS5wdXNoKGZuKTsKICAgIHRoaXMucXVldWUuYXJnc0FycmF5LnB1c2goYXJncyk7CgogICAgdGhpcy5fb3B0aW1pemUoKTsKICB9CgogIGZsdXNoKCkge30KCiAgcmVzZXQoKSB7fQoKfQoKY2xhc3MgUXVldWVPcHRpbWl6ZXIgZXh0ZW5kcyBOdWxsT3B0aW1pemVyIHsKICBjb25zdHJ1Y3RvcihxdWV1ZSkgewogICAgc3VwZXIocXVldWUpOwogICAgdGhpcy5zdGF0ZSA9IG51bGw7CiAgICB0aGlzLmNvbnRleHQgPSB7CiAgICAgIGlDdXJyOiAwLAogICAgICBmbkFycmF5OiBxdWV1ZS5mbkFycmF5LAogICAgICBhcmdzQXJyYXk6IHF1ZXVlLmFyZ3NBcnJheQogICAgfTsKICAgIHRoaXMubWF0Y2ggPSBudWxsOwogICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gMDsKICB9CgogIF9vcHRpbWl6ZSgpIHsKICAgIGNvbnN0IGZuQXJyYXkgPSB0aGlzLnF1ZXVlLmZuQXJyYXk7CiAgICBsZXQgaSA9IHRoaXMubGFzdFByb2Nlc3NlZCwKICAgICAgICBpaSA9IGZuQXJyYXkubGVuZ3RoOwogICAgbGV0IHN0YXRlID0gdGhpcy5zdGF0ZTsKICAgIGxldCBtYXRjaCA9IHRoaXMubWF0Y2g7CgogICAgaWYgKCFzdGF0ZSAmJiAhbWF0Y2ggJiYgaSArIDEgPT09IGlpICYmICFJbml0aWFsU3RhdGVbZm5BcnJheVtpXV0pIHsKICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gaWk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0OwoKICAgIHdoaWxlIChpIDwgaWkpIHsKICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgY29uc3QgaXRlcmF0ZSA9ICgwLCBtYXRjaC5pdGVyYXRlRm4pKGNvbnRleHQsIGkpOwoKICAgICAgICBpZiAoaXRlcmF0ZSkgewogICAgICAgICAgaSsrOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpID0gKDAsIG1hdGNoLnByb2Nlc3NGbikoY29udGV4dCwgaSArIDEpOwogICAgICAgIGlpID0gZm5BcnJheS5sZW5ndGg7CiAgICAgICAgbWF0Y2ggPSBudWxsOwogICAgICAgIHN0YXRlID0gbnVsbDsKCiAgICAgICAgaWYgKGkgPj0gaWkpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RhdGUgPSAoc3RhdGUgfHwgSW5pdGlhbFN0YXRlKVtmbkFycmF5W2ldXTsKCiAgICAgIGlmICghc3RhdGUgfHwgQXJyYXkuaXNBcnJheShzdGF0ZSkpIHsKICAgICAgICBpKys7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnRleHQuaUN1cnIgPSBpOwogICAgICBpKys7CgogICAgICBpZiAoc3RhdGUuY2hlY2tGbiAmJiAhKDAsIHN0YXRlLmNoZWNrRm4pKGNvbnRleHQpKSB7CiAgICAgICAgc3RhdGUgPSBudWxsOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBtYXRjaCA9IHN0YXRlOwogICAgICBzdGF0ZSA9IG51bGw7CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5tYXRjaCA9IG1hdGNoOwogICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gaTsKICB9CgogIGZsdXNoKCkgewogICAgd2hpbGUgKHRoaXMubWF0Y2gpIHsKICAgICAgY29uc3QgbGVuZ3RoID0gdGhpcy5xdWV1ZS5mbkFycmF5Lmxlbmd0aDsKICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkID0gKDAsIHRoaXMubWF0Y2gucHJvY2Vzc0ZuKSh0aGlzLmNvbnRleHQsIGxlbmd0aCk7CiAgICAgIHRoaXMubWF0Y2ggPSBudWxsOwogICAgICB0aGlzLnN0YXRlID0gbnVsbDsKCiAgICAgIHRoaXMuX29wdGltaXplKCk7CiAgICB9CiAgfQoKICByZXNldCgpIHsKICAgIHRoaXMuc3RhdGUgPSBudWxsOwogICAgdGhpcy5tYXRjaCA9IG51bGw7CiAgICB0aGlzLmxhc3RQcm9jZXNzZWQgPSAwOwogIH0KCn0KCmNsYXNzIE9wZXJhdG9yTGlzdCB7CiAgc3RhdGljIGdldCBDSFVOS19TSVpFKCkgewogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJDSFVOS19TSVpFIiwgMTAwMCk7CiAgfQoKICBzdGF0aWMgZ2V0IENIVU5LX1NJWkVfQUJPVVQoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIkNIVU5LX1NJWkVfQUJPVVQiLCB0aGlzLkNIVU5LX1NJWkUgLSA1KTsKICB9CgogIGNvbnN0cnVjdG9yKGludGVudCA9IDAsIHN0cmVhbVNpbmspIHsKICAgIHRoaXMuX3N0cmVhbVNpbmsgPSBzdHJlYW1TaW5rOwogICAgdGhpcy5mbkFycmF5ID0gW107CiAgICB0aGlzLmFyZ3NBcnJheSA9IFtdOwoKICAgIGlmIChzdHJlYW1TaW5rICYmICEoaW50ZW50ICYgX3V0aWwuUmVuZGVyaW5nSW50ZW50RmxhZy5PUExJU1QpKSB7CiAgICAgIHRoaXMub3B0aW1pemVyID0gbmV3IFF1ZXVlT3B0aW1pemVyKHRoaXMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5vcHRpbWl6ZXIgPSBuZXcgTnVsbE9wdGltaXplcih0aGlzKTsKICAgIH0KCiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IG5ldyBTZXQoKTsKICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gMDsKICAgIHRoaXMud2VpZ2h0ID0gMDsKICAgIHRoaXMuX3Jlc29sdmVkID0gc3RyZWFtU2luayA/IG51bGwgOiBQcm9taXNlLnJlc29sdmUoKTsKICB9CgogIGdldCBsZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5hcmdzQXJyYXkubGVuZ3RoOwogIH0KCiAgZ2V0IHJlYWR5KCkgewogICAgcmV0dXJuIHRoaXMuX3Jlc29sdmVkIHx8IHRoaXMuX3N0cmVhbVNpbmsucmVhZHk7CiAgfQoKICBnZXQgdG90YWxMZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5fdG90YWxMZW5ndGggKyB0aGlzLmxlbmd0aDsKICB9CgogIGFkZE9wKGZuLCBhcmdzKSB7CiAgICB0aGlzLm9wdGltaXplci5wdXNoKGZuLCBhcmdzKTsKICAgIHRoaXMud2VpZ2h0Kys7CgogICAgaWYgKHRoaXMuX3N0cmVhbVNpbmspIHsKICAgICAgaWYgKHRoaXMud2VpZ2h0ID49IE9wZXJhdG9yTGlzdC5DSFVOS19TSVpFKSB7CiAgICAgICAgdGhpcy5mbHVzaCgpOwogICAgICB9IGVsc2UgaWYgKHRoaXMud2VpZ2h0ID49IE9wZXJhdG9yTGlzdC5DSFVOS19TSVpFX0FCT1VUICYmIChmbiA9PT0gX3V0aWwuT1BTLnJlc3RvcmUgfHwgZm4gPT09IF91dGlsLk9QUy5lbmRUZXh0KSkgewogICAgICAgIHRoaXMuZmx1c2goKTsKICAgICAgfQogICAgfQogIH0KCiAgYWRkSW1hZ2VPcHMoZm4sIGFyZ3MsIG9wdGlvbmFsQ29udGVudCkgewogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHRoaXMuYWRkT3AoX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudFByb3BzLCBbIk9DIiwgb3B0aW9uYWxDb250ZW50XSk7CiAgICB9CgogICAgdGhpcy5hZGRPcChmbiwgYXJncyk7CgogICAgaWYgKG9wdGlvbmFsQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHRoaXMuYWRkT3AoX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsIFtdKTsKICAgIH0KICB9CgogIGFkZERlcGVuZGVuY3koZGVwZW5kZW5jeSkgewogICAgaWYgKHRoaXMuZGVwZW5kZW5jaWVzLmhhcyhkZXBlbmRlbmN5KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5kZXBlbmRlbmNpZXMuYWRkKGRlcGVuZGVuY3kpOwogICAgdGhpcy5hZGRPcChfdXRpbC5PUFMuZGVwZW5kZW5jeSwgW2RlcGVuZGVuY3ldKTsKICB9CgogIGFkZERlcGVuZGVuY2llcyhkZXBlbmRlbmNpZXMpIHsKICAgIGZvciAoY29uc3QgZGVwZW5kZW5jeSBvZiBkZXBlbmRlbmNpZXMpIHsKICAgICAgdGhpcy5hZGREZXBlbmRlbmN5KGRlcGVuZGVuY3kpOwogICAgfQogIH0KCiAgYWRkT3BMaXN0KG9wTGlzdCkgewogICAgaWYgKCEob3BMaXN0IGluc3RhbmNlb2YgT3BlcmF0b3JMaXN0KSkgewogICAgICAoMCwgX3V0aWwud2FybikoJ2FkZE9wTGlzdCAtIGlnbm9yaW5nIGludmFsaWQgIm9wTGlzdCIgcGFyYW1ldGVyLicpOwogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIG9wTGlzdC5kZXBlbmRlbmNpZXMpIHsKICAgICAgdGhpcy5kZXBlbmRlbmNpZXMuYWRkKGRlcGVuZGVuY3kpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IG9wTGlzdC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHRoaXMuYWRkT3Aob3BMaXN0LmZuQXJyYXlbaV0sIG9wTGlzdC5hcmdzQXJyYXlbaV0pOwogICAgfQogIH0KCiAgZ2V0SVIoKSB7CiAgICByZXR1cm4gewogICAgICBmbkFycmF5OiB0aGlzLmZuQXJyYXksCiAgICAgIGFyZ3NBcnJheTogdGhpcy5hcmdzQXJyYXksCiAgICAgIGxlbmd0aDogdGhpcy5sZW5ndGgKICAgIH07CiAgfQoKICBnZXQgX3RyYW5zZmVycygpIHsKICAgIGNvbnN0IHRyYW5zZmVycyA9IFtdOwogICAgY29uc3QgewogICAgICBmbkFycmF5LAogICAgICBhcmdzQXJyYXksCiAgICAgIGxlbmd0aAogICAgfSA9IHRoaXM7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBzd2l0Y2ggKGZuQXJyYXlbaV0pIHsKICAgICAgICBjYXNlIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdDoKICAgICAgICBjYXNlIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdEdyb3VwOgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdDoKICAgICAgICAgIGNvbnN0IGFyZyA9IGFyZ3NBcnJheVtpXVswXTsKCiAgICAgICAgICBpZiAoIWFyZy5jYWNoZWQgJiYgYXJnLmRhdGEgJiYgYXJnLmRhdGEuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKICAgICAgICAgICAgdHJhbnNmZXJzLnB1c2goYXJnLmRhdGEuYnVmZmVyKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cmFuc2ZlcnM7CiAgfQoKICBmbHVzaChsYXN0Q2h1bmsgPSBmYWxzZSwgc2VwYXJhdGVBbm5vdHMgPSBudWxsKSB7CiAgICB0aGlzLm9wdGltaXplci5mbHVzaCgpOwogICAgY29uc3QgbGVuZ3RoID0gdGhpcy5sZW5ndGg7CiAgICB0aGlzLl90b3RhbExlbmd0aCArPSBsZW5ndGg7CgogICAgdGhpcy5fc3RyZWFtU2luay5lbnF1ZXVlKHsKICAgICAgZm5BcnJheTogdGhpcy5mbkFycmF5LAogICAgICBhcmdzQXJyYXk6IHRoaXMuYXJnc0FycmF5LAogICAgICBsYXN0Q2h1bmssCiAgICAgIHNlcGFyYXRlQW5ub3RzLAogICAgICBsZW5ndGgKICAgIH0sIDEsIHRoaXMuX3RyYW5zZmVycyk7CgogICAgdGhpcy5kZXBlbmRlbmNpZXMuY2xlYXIoKTsKICAgIHRoaXMuZm5BcnJheS5sZW5ndGggPSAwOwogICAgdGhpcy5hcmdzQXJyYXkubGVuZ3RoID0gMDsKICAgIHRoaXMud2VpZ2h0ID0gMDsKICAgIHRoaXMub3B0aW1pemVyLnJlc2V0KCk7CiAgfQoKfQoKZXhwb3J0cy5PcGVyYXRvckxpc3QgPSBPcGVyYXRvckxpc3Q7CgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5QREZJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2ltYWdlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2NCk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQpOwoKdmFyIF9kZWNvZGVfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7Cgp2YXIgX2pwZWdfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyNyk7Cgp2YXIgX2pweCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzApOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCmZ1bmN0aW9uIGRlY29kZUFuZENsYW1wKHZhbHVlLCBhZGRlbmQsIGNvZWZmaWNpZW50LCBtYXgpIHsKICB2YWx1ZSA9IGFkZGVuZCArIHZhbHVlICogY29lZmZpY2llbnQ7CgogIGlmICh2YWx1ZSA8IDApIHsKICAgIHZhbHVlID0gMDsKICB9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7CiAgICB2YWx1ZSA9IG1heDsKICB9CgogIHJldHVybiB2YWx1ZTsKfQoKZnVuY3Rpb24gcmVzaXplSW1hZ2VNYXNrKHNyYywgYnBjLCB3MSwgaDEsIHcyLCBoMikgewogIGNvbnN0IGxlbmd0aCA9IHcyICogaDI7CiAgbGV0IGRlc3Q7CgogIGlmIChicGMgPD0gOCkgewogICAgZGVzdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgfSBlbHNlIGlmIChicGMgPD0gMTYpIHsKICAgIGRlc3QgPSBuZXcgVWludDE2QXJyYXkobGVuZ3RoKTsKICB9IGVsc2UgewogICAgZGVzdCA9IG5ldyBVaW50MzJBcnJheShsZW5ndGgpOwogIH0KCiAgY29uc3QgeFJhdGlvID0gdzEgLyB3MjsKICBjb25zdCB5UmF0aW8gPSBoMSAvIGgyOwogIGxldCBpLAogICAgICBqLAogICAgICBweSwKICAgICAgbmV3SW5kZXggPSAwLAogICAgICBvbGRJbmRleDsKICBjb25zdCB4U2NhbGVkID0gbmV3IFVpbnQxNkFycmF5KHcyKTsKICBjb25zdCB3MVNjYW5saW5lID0gdzE7CgogIGZvciAoaSA9IDA7IGkgPCB3MjsgaSsrKSB7CiAgICB4U2NhbGVkW2ldID0gTWF0aC5mbG9vcihpICogeFJhdGlvKTsKICB9CgogIGZvciAoaSA9IDA7IGkgPCBoMjsgaSsrKSB7CiAgICBweSA9IE1hdGguZmxvb3IoaSAqIHlSYXRpbykgKiB3MVNjYW5saW5lOwoKICAgIGZvciAoaiA9IDA7IGogPCB3MjsgaisrKSB7CiAgICAgIG9sZEluZGV4ID0gcHkgKyB4U2NhbGVkW2pdOwogICAgICBkZXN0W25ld0luZGV4KytdID0gc3JjW29sZEluZGV4XTsKICAgIH0KICB9CgogIHJldHVybiBkZXN0Owp9CgpjbGFzcyBQREZJbWFnZSB7CiAgY29uc3RydWN0b3IoewogICAgeHJlZiwKICAgIHJlcywKICAgIGltYWdlLAogICAgaXNJbmxpbmUgPSBmYWxzZSwKICAgIHNtYXNrID0gbnVsbCwKICAgIG1hc2sgPSBudWxsLAogICAgaXNNYXNrID0gZmFsc2UsCiAgICBwZGZGdW5jdGlvbkZhY3RvcnksCiAgICBsb2NhbENvbG9yU3BhY2VDYWNoZQogIH0pIHsKICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKICAgIGNvbnN0IGRpY3QgPSBpbWFnZS5kaWN0OwogICAgY29uc3QgZmlsdGVyID0gZGljdC5nZXQoIkYiLCAiRmlsdGVyIik7CiAgICBsZXQgZmlsdGVyTmFtZTsKCiAgICBpZiAoZmlsdGVyIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyLm5hbWU7CiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyKSkgewogICAgICBjb25zdCBmaWx0ZXJaZXJvID0geHJlZi5mZXRjaElmUmVmKGZpbHRlclswXSk7CgogICAgICBpZiAoZmlsdGVyWmVybyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyWmVyby5uYW1lOwogICAgICB9CiAgICB9CgogICAgc3dpdGNoIChmaWx0ZXJOYW1lKSB7CiAgICAgIGNhc2UgIkpQWERlY29kZSI6CiAgICAgICAgY29uc3QganB4SW1hZ2UgPSBuZXcgX2pweC5KcHhJbWFnZSgpOwogICAgICAgIGpweEltYWdlLnBhcnNlSW1hZ2VQcm9wZXJ0aWVzKGltYWdlLnN0cmVhbSk7CiAgICAgICAgaW1hZ2Uuc3RyZWFtLnJlc2V0KCk7CiAgICAgICAgaW1hZ2Uud2lkdGggPSBqcHhJbWFnZS53aWR0aDsKICAgICAgICBpbWFnZS5oZWlnaHQgPSBqcHhJbWFnZS5oZWlnaHQ7CiAgICAgICAgaW1hZ2UuYml0c1BlckNvbXBvbmVudCA9IGpweEltYWdlLmJpdHNQZXJDb21wb25lbnQ7CiAgICAgICAgaW1hZ2UubnVtQ29tcHMgPSBqcHhJbWFnZS5jb21wb25lbnRzQ291bnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJKQklHMkRlY29kZSI6CiAgICAgICAgaW1hZ2UuYml0c1BlckNvbXBvbmVudCA9IDE7CiAgICAgICAgaW1hZ2UubnVtQ29tcHMgPSAxOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGxldCB3aWR0aCA9IGRpY3QuZ2V0KCJXIiwgIldpZHRoIik7CiAgICBsZXQgaGVpZ2h0ID0gZGljdC5nZXQoIkgiLCAiSGVpZ2h0Iik7CgogICAgaWYgKE51bWJlci5pc0ludGVnZXIoaW1hZ2Uud2lkdGgpICYmIGltYWdlLndpZHRoID4gMCAmJiBOdW1iZXIuaXNJbnRlZ2VyKGltYWdlLmhlaWdodCkgJiYgaW1hZ2UuaGVpZ2h0ID4gMCAmJiAoaW1hZ2Uud2lkdGggIT09IHdpZHRoIHx8IGltYWdlLmhlaWdodCAhPT0gaGVpZ2h0KSkgewogICAgICAoMCwgX3V0aWwud2FybikoIlBERkltYWdlIC0gdXNpbmcgdGhlIFdpZHRoL0hlaWdodCBvZiB0aGUgaW1hZ2UgZGF0YSwgIiArICJyYXRoZXIgdGhhbiB0aGUgaW1hZ2UgZGljdGlvbmFyeS4iKTsKICAgICAgd2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgaGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0OwogICAgfQoKICAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgaW1hZ2Ugd2lkdGg6ICR7d2lkdGh9IG9yIGhlaWdodDogJHtoZWlnaHR9YCk7CiAgICB9CgogICAgdGhpcy53aWR0aCA9IHdpZHRoOwogICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICB0aGlzLmludGVycG9sYXRlID0gZGljdC5nZXQoIkkiLCAiSW50ZXJwb2xhdGUiKTsKICAgIHRoaXMuaW1hZ2VNYXNrID0gZGljdC5nZXQoIklNIiwgIkltYWdlTWFzayIpIHx8IGZhbHNlOwogICAgdGhpcy5tYXR0ZSA9IGRpY3QuZ2V0KCJNYXR0ZSIpIHx8IGZhbHNlOwogICAgbGV0IGJpdHNQZXJDb21wb25lbnQgPSBpbWFnZS5iaXRzUGVyQ29tcG9uZW50OwoKICAgIGlmICghYml0c1BlckNvbXBvbmVudCkgewogICAgICBiaXRzUGVyQ29tcG9uZW50ID0gZGljdC5nZXQoIkJQQyIsICJCaXRzUGVyQ29tcG9uZW50Iik7CgogICAgICBpZiAoIWJpdHNQZXJDb21wb25lbnQpIHsKICAgICAgICBpZiAodGhpcy5pbWFnZU1hc2spIHsKICAgICAgICAgIGJpdHNQZXJDb21wb25lbnQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEJpdHMgcGVyIGNvbXBvbmVudCBtaXNzaW5nIGluIGltYWdlOiAke3RoaXMuaW1hZ2VNYXNrfWApOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHRoaXMuYnBjID0gYml0c1BlckNvbXBvbmVudDsKCiAgICBpZiAoIXRoaXMuaW1hZ2VNYXNrKSB7CiAgICAgIGxldCBjb2xvclNwYWNlID0gZGljdC5nZXRSYXcoIkNTIikgfHwgZGljdC5nZXRSYXcoIkNvbG9yU3BhY2UiKTsKCiAgICAgIGlmICghY29sb3JTcGFjZSkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiSlBYIGltYWdlcyAod2hpY2ggZG8gbm90IHJlcXVpcmUgY29sb3Igc3BhY2VzKSIpOwoKICAgICAgICBzd2l0Y2ggKGltYWdlLm51bUNvbXBzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRGV2aWNlR3JheSIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRGV2aWNlUkdCIik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY29sb3JTcGFjZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJEZXZpY2VDTVlLIik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSlBYIGltYWdlcyB3aXRoICR7aW1hZ2UubnVtQ29tcHN9IGNvbG9yIGNvbXBvbmVudHMgbm90IHN1cHBvcnRlZC5gKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuY29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2UucGFyc2UoewogICAgICAgIGNzOiBjb2xvclNwYWNlLAogICAgICAgIHhyZWYsCiAgICAgICAgcmVzb3VyY2VzOiBpc0lubGluZSA/IHJlcyA6IG51bGwsCiAgICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgIH0pOwogICAgICB0aGlzLm51bUNvbXBzID0gdGhpcy5jb2xvclNwYWNlLm51bUNvbXBzOwogICAgfQoKICAgIHRoaXMuZGVjb2RlID0gZGljdC5nZXRBcnJheSgiRCIsICJEZWNvZGUiKTsKICAgIHRoaXMubmVlZHNEZWNvZGUgPSBmYWxzZTsKCiAgICBpZiAodGhpcy5kZWNvZGUgJiYgKHRoaXMuY29sb3JTcGFjZSAmJiAhdGhpcy5jb2xvclNwYWNlLmlzRGVmYXVsdERlY29kZSh0aGlzLmRlY29kZSwgYml0c1BlckNvbXBvbmVudCkgfHwgaXNNYXNrICYmICFfY29sb3JzcGFjZS5Db2xvclNwYWNlLmlzRGVmYXVsdERlY29kZSh0aGlzLmRlY29kZSwgMSkpKSB7CiAgICAgIHRoaXMubmVlZHNEZWNvZGUgPSB0cnVlOwogICAgICBjb25zdCBtYXggPSAoMSA8PCBiaXRzUGVyQ29tcG9uZW50KSAtIDE7CiAgICAgIHRoaXMuZGVjb2RlQ29lZmZpY2llbnRzID0gW107CiAgICAgIHRoaXMuZGVjb2RlQWRkZW5kcyA9IFtdOwogICAgICBjb25zdCBpc0luZGV4ZWQgPSB0aGlzLmNvbG9yU3BhY2UgJiYgdGhpcy5jb2xvclNwYWNlLm5hbWUgPT09ICJJbmRleGVkIjsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHRoaXMuZGVjb2RlLmxlbmd0aDsgaSArPSAyLCArK2opIHsKICAgICAgICBjb25zdCBkbWluID0gdGhpcy5kZWNvZGVbaV07CiAgICAgICAgY29uc3QgZG1heCA9IHRoaXMuZGVjb2RlW2kgKyAxXTsKICAgICAgICB0aGlzLmRlY29kZUNvZWZmaWNpZW50c1tqXSA9IGlzSW5kZXhlZCA/IChkbWF4IC0gZG1pbikgLyBtYXggOiBkbWF4IC0gZG1pbjsKICAgICAgICB0aGlzLmRlY29kZUFkZGVuZHNbal0gPSBpc0luZGV4ZWQgPyBkbWluIDogbWF4ICogZG1pbjsKICAgICAgfQogICAgfQoKICAgIGlmIChzbWFzaykgewogICAgICB0aGlzLnNtYXNrID0gbmV3IFBERkltYWdlKHsKICAgICAgICB4cmVmLAogICAgICAgIHJlcywKICAgICAgICBpbWFnZTogc21hc2ssCiAgICAgICAgaXNJbmxpbmUsCiAgICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgICAgIGxvY2FsQ29sb3JTcGFjZUNhY2hlCiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChtYXNrKSB7CiAgICAgIGlmIChtYXNrIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBjb25zdCBtYXNrRGljdCA9IG1hc2suZGljdCwKICAgICAgICAgICAgICBpbWFnZU1hc2sgPSBtYXNrRGljdC5nZXQoIklNIiwgIkltYWdlTWFzayIpOwoKICAgICAgICBpZiAoIWltYWdlTWFzaykgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJZ25vcmluZyAvTWFzayBpbiBpbWFnZSB3aXRob3V0IC9JbWFnZU1hc2suIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubWFzayA9IG5ldyBQREZJbWFnZSh7CiAgICAgICAgICAgIHhyZWYsCiAgICAgICAgICAgIHJlcywKICAgICAgICAgICAgaW1hZ2U6IG1hc2ssCiAgICAgICAgICAgIGlzSW5saW5lLAogICAgICAgICAgICBpc01hc2s6IHRydWUsCiAgICAgICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1hc2sgPSBtYXNrOwogICAgICB9CiAgICB9CiAgfQoKICBzdGF0aWMgYXN5bmMgYnVpbGRJbWFnZSh7CiAgICB4cmVmLAogICAgcmVzLAogICAgaW1hZ2UsCiAgICBpc0lubGluZSA9IGZhbHNlLAogICAgcGRmRnVuY3Rpb25GYWN0b3J5LAogICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICB9KSB7CiAgICBjb25zdCBpbWFnZURhdGEgPSBpbWFnZTsKICAgIGxldCBzbWFza0RhdGEgPSBudWxsOwogICAgbGV0IG1hc2tEYXRhID0gbnVsbDsKICAgIGNvbnN0IHNtYXNrID0gaW1hZ2UuZGljdC5nZXQoIlNNYXNrIik7CiAgICBjb25zdCBtYXNrID0gaW1hZ2UuZGljdC5nZXQoIk1hc2siKTsKCiAgICBpZiAoc21hc2spIHsKICAgICAgaWYgKHNtYXNrIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBzbWFza0RhdGEgPSBzbWFzazsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuc3VwcG9ydGVkIC9TTWFzayBmb3JtYXQuIik7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAobWFzaykgewogICAgICBpZiAobWFzayBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtIHx8IEFycmF5LmlzQXJyYXkobWFzaykpIHsKICAgICAgICBtYXNrRGF0YSA9IG1hc2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCAvTWFzayBmb3JtYXQuIik7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbmV3IFBERkltYWdlKHsKICAgICAgeHJlZiwKICAgICAgcmVzLAogICAgICBpbWFnZTogaW1hZ2VEYXRhLAogICAgICBpc0lubGluZSwKICAgICAgc21hc2s6IHNtYXNrRGF0YSwKICAgICAgbWFzazogbWFza0RhdGEsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSwKICAgICAgbG9jYWxDb2xvclNwYWNlQ2FjaGUKICAgIH0pOwogIH0KCiAgc3RhdGljIGNyZWF0ZVJhd01hc2soewogICAgaW1nQXJyYXksCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGltYWdlSXNGcm9tRGVjb2RlU3RyZWFtLAogICAgaW52ZXJzZURlY29kZSwKICAgIGludGVycG9sYXRlCiAgfSkgewogICAgY29uc3QgY29tcHV0ZWRMZW5ndGggPSAod2lkdGggKyA3ID4+IDMpICogaGVpZ2h0OwogICAgY29uc3QgYWN0dWFsTGVuZ3RoID0gaW1nQXJyYXkuYnl0ZUxlbmd0aDsKICAgIGNvbnN0IGhhdmVGdWxsRGF0YSA9IGNvbXB1dGVkTGVuZ3RoID09PSBhY3R1YWxMZW5ndGg7CiAgICBsZXQgZGF0YSwgaTsKCiAgICBpZiAoaW1hZ2VJc0Zyb21EZWNvZGVTdHJlYW0gJiYgKCFpbnZlcnNlRGVjb2RlIHx8IGhhdmVGdWxsRGF0YSkpIHsKICAgICAgZGF0YSA9IGltZ0FycmF5OwogICAgfSBlbHNlIGlmICghaW52ZXJzZURlY29kZSkgewogICAgICBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoaW1nQXJyYXkpOwogICAgfSBlbHNlIHsKICAgICAgZGF0YSA9IG5ldyBVaW50OEFycmF5KGNvbXB1dGVkTGVuZ3RoKTsKICAgICAgZGF0YS5zZXQoaW1nQXJyYXkpOwogICAgICBkYXRhLmZpbGwoMHhmZiwgYWN0dWFsTGVuZ3RoKTsKICAgIH0KCiAgICBpZiAoaW52ZXJzZURlY29kZSkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgYWN0dWFsTGVuZ3RoOyBpKyspIHsKICAgICAgICBkYXRhW2ldIF49IDB4ZmY7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICBkYXRhLAogICAgICB3aWR0aCwKICAgICAgaGVpZ2h0LAogICAgICBpbnRlcnBvbGF0ZQogICAgfTsKICB9CgogIHN0YXRpYyBjcmVhdGVNYXNrKHsKICAgIGltZ0FycmF5LAogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBpbWFnZUlzRnJvbURlY29kZVN0cmVhbSwKICAgIGludmVyc2VEZWNvZGUsCiAgICBpbnRlcnBvbGF0ZQogIH0pIHsKICAgIGNvbnN0IGlzU2luZ2xlT3BhcXVlUGl4ZWwgPSB3aWR0aCA9PT0gMSAmJiBoZWlnaHQgPT09IDEgJiYgaW52ZXJzZURlY29kZSA9PT0gKGltZ0FycmF5Lmxlbmd0aCA9PT0gMCB8fCAhIShpbWdBcnJheVswXSAmIDEyOCkpOwoKICAgIGlmIChpc1NpbmdsZU9wYXF1ZVBpeGVsKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaXNTaW5nbGVPcGFxdWVQaXhlbAogICAgICB9OwogICAgfQoKICAgIGlmIChfdXRpbC5GZWF0dXJlVGVzdC5pc09mZnNjcmVlbkNhbnZhc1N1cHBvcnRlZCkgewogICAgICBjb25zdCBjYW52YXMgPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgaW1nRGF0YSA9IGN0eC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CiAgICAgICgwLCBfaW1hZ2VfdXRpbHMuYXBwbHlNYXNrSW1hZ2VEYXRhKSh7CiAgICAgICAgc3JjOiBpbWdBcnJheSwKICAgICAgICBkZXN0OiBpbWdEYXRhLmRhdGEsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGludmVyc2VEZWNvZGUKICAgICAgfSk7CiAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1nRGF0YSwgMCwgMCk7CiAgICAgIGNvbnN0IGJpdG1hcCA9IGNhbnZhcy50cmFuc2ZlclRvSW1hZ2VCaXRtYXAoKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBkYXRhOiBudWxsLAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBpbnRlcnBvbGF0ZSwKICAgICAgICBiaXRtYXAKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jcmVhdGVSYXdNYXNrKHsKICAgICAgaW1nQXJyYXksCiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQsCiAgICAgIGludmVyc2VEZWNvZGUsCiAgICAgIGltYWdlSXNGcm9tRGVjb2RlU3RyZWFtLAogICAgICBpbnRlcnBvbGF0ZQogICAgfSk7CiAgfQoKICBnZXQgZHJhd1dpZHRoKCkgewogICAgcmV0dXJuIE1hdGgubWF4KHRoaXMud2lkdGgsIHRoaXMuc21hc2sgJiYgdGhpcy5zbWFzay53aWR0aCB8fCAwLCB0aGlzLm1hc2sgJiYgdGhpcy5tYXNrLndpZHRoIHx8IDApOwogIH0KCiAgZ2V0IGRyYXdIZWlnaHQoKSB7CiAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5oZWlnaHQsIHRoaXMuc21hc2sgJiYgdGhpcy5zbWFzay5oZWlnaHQgfHwgMCwgdGhpcy5tYXNrICYmIHRoaXMubWFzay5oZWlnaHQgfHwgMCk7CiAgfQoKICBkZWNvZGVCdWZmZXIoYnVmZmVyKSB7CiAgICBjb25zdCBicGMgPSB0aGlzLmJwYzsKICAgIGNvbnN0IG51bUNvbXBzID0gdGhpcy5udW1Db21wczsKICAgIGNvbnN0IGRlY29kZUFkZGVuZHMgPSB0aGlzLmRlY29kZUFkZGVuZHM7CiAgICBjb25zdCBkZWNvZGVDb2VmZmljaWVudHMgPSB0aGlzLmRlY29kZUNvZWZmaWNpZW50czsKICAgIGNvbnN0IG1heCA9ICgxIDw8IGJwYykgLSAxOwogICAgbGV0IGksIGlpOwoKICAgIGlmIChicGMgPT09IDEpIHsKICAgICAgZm9yIChpID0gMCwgaWkgPSBidWZmZXIubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGJ1ZmZlcltpXSA9ICshYnVmZmVyW2ldOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGluZGV4ID0gMDsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IHRoaXMud2lkdGggKiB0aGlzLmhlaWdodDsgaSA8IGlpOyBpKyspIHsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1Db21wczsgaisrKSB7CiAgICAgICAgYnVmZmVyW2luZGV4XSA9IGRlY29kZUFuZENsYW1wKGJ1ZmZlcltpbmRleF0sIGRlY29kZUFkZGVuZHNbal0sIGRlY29kZUNvZWZmaWNpZW50c1tqXSwgbWF4KTsKICAgICAgICBpbmRleCsrOwogICAgICB9CiAgICB9CiAgfQoKICBnZXRDb21wb25lbnRzKGJ1ZmZlcikgewogICAgY29uc3QgYnBjID0gdGhpcy5icGM7CgogICAgaWYgKGJwYyA9PT0gOCkgewogICAgICByZXR1cm4gYnVmZmVyOwogICAgfQoKICAgIGNvbnN0IHdpZHRoID0gdGhpcy53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwogICAgY29uc3QgbGVuZ3RoID0gd2lkdGggKiBoZWlnaHQgKiBudW1Db21wczsKICAgIGxldCBidWZmZXJQb3MgPSAwOwogICAgbGV0IG91dHB1dDsKCiAgICBpZiAoYnBjIDw9IDgpIHsKICAgICAgb3V0cHV0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICAgIH0gZWxzZSBpZiAoYnBjIDw9IDE2KSB7CiAgICAgIG91dHB1dCA9IG5ldyBVaW50MTZBcnJheShsZW5ndGgpOwogICAgfSBlbHNlIHsKICAgICAgb3V0cHV0ID0gbmV3IFVpbnQzMkFycmF5KGxlbmd0aCk7CiAgICB9CgogICAgY29uc3Qgcm93Q29tcHMgPSB3aWR0aCAqIG51bUNvbXBzOwogICAgY29uc3QgbWF4ID0gKDEgPDwgYnBjKSAtIDE7CiAgICBsZXQgaSA9IDAsCiAgICAgICAgaWksCiAgICAgICAgYnVmOwoKICAgIGlmIChicGMgPT09IDEpIHsKICAgICAgbGV0IG1hc2ssIGxvb3AxRW5kLCBsb29wMkVuZDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaGVpZ2h0OyBqKyspIHsKICAgICAgICBsb29wMUVuZCA9IGkgKyAocm93Q29tcHMgJiB+Nyk7CiAgICAgICAgbG9vcDJFbmQgPSBpICsgcm93Q29tcHM7CgogICAgICAgIHdoaWxlIChpIDwgbG9vcDFFbmQpIHsKICAgICAgICAgIGJ1ZiA9IGJ1ZmZlcltidWZmZXJQb3MrK107CiAgICAgICAgICBvdXRwdXRbaV0gPSBidWYgPj4gNyAmIDE7CiAgICAgICAgICBvdXRwdXRbaSArIDFdID0gYnVmID4+IDYgJiAxOwogICAgICAgICAgb3V0cHV0W2kgKyAyXSA9IGJ1ZiA+PiA1ICYgMTsKICAgICAgICAgIG91dHB1dFtpICsgM10gPSBidWYgPj4gNCAmIDE7CiAgICAgICAgICBvdXRwdXRbaSArIDRdID0gYnVmID4+IDMgJiAxOwogICAgICAgICAgb3V0cHV0W2kgKyA1XSA9IGJ1ZiA+PiAyICYgMTsKICAgICAgICAgIG91dHB1dFtpICsgNl0gPSBidWYgPj4gMSAmIDE7CiAgICAgICAgICBvdXRwdXRbaSArIDddID0gYnVmICYgMTsKICAgICAgICAgIGkgKz0gODsKICAgICAgICB9CgogICAgICAgIGlmIChpIDwgbG9vcDJFbmQpIHsKICAgICAgICAgIGJ1ZiA9IGJ1ZmZlcltidWZmZXJQb3MrK107CiAgICAgICAgICBtYXNrID0gMTI4OwoKICAgICAgICAgIHdoaWxlIChpIDwgbG9vcDJFbmQpIHsKICAgICAgICAgICAgb3V0cHV0W2krK10gPSArISEoYnVmICYgbWFzayk7CiAgICAgICAgICAgIG1hc2sgPj49IDE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBsZXQgYml0cyA9IDA7CiAgICAgIGJ1ZiA9IDA7CgogICAgICBmb3IgKGkgPSAwLCBpaSA9IGxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBpZiAoaSAlIHJvd0NvbXBzID09PSAwKSB7CiAgICAgICAgICBidWYgPSAwOwogICAgICAgICAgYml0cyA9IDA7CiAgICAgICAgfQoKICAgICAgICB3aGlsZSAoYml0cyA8IGJwYykgewogICAgICAgICAgYnVmID0gYnVmIDw8IDggfCBidWZmZXJbYnVmZmVyUG9zKytdOwogICAgICAgICAgYml0cyArPSA4OwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVtYWluaW5nQml0cyA9IGJpdHMgLSBicGM7CiAgICAgICAgbGV0IHZhbHVlID0gYnVmID4+IHJlbWFpbmluZ0JpdHM7CgogICAgICAgIGlmICh2YWx1ZSA8IDApIHsKICAgICAgICAgIHZhbHVlID0gMDsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7CiAgICAgICAgICB2YWx1ZSA9IG1heDsKICAgICAgICB9CgogICAgICAgIG91dHB1dFtpXSA9IHZhbHVlOwogICAgICAgIGJ1ZiAmPSAoMSA8PCByZW1haW5pbmdCaXRzKSAtIDE7CiAgICAgICAgYml0cyA9IHJlbWFpbmluZ0JpdHM7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gb3V0cHV0OwogIH0KCiAgZmlsbE9wYWNpdHkocmdiYUJ1Ziwgd2lkdGgsIGhlaWdodCwgYWN0dWFsSGVpZ2h0LCBpbWFnZSkgewogICAgY29uc3Qgc21hc2sgPSB0aGlzLnNtYXNrOwogICAgY29uc3QgbWFzayA9IHRoaXMubWFzazsKICAgIGxldCBhbHBoYUJ1Ziwgc3csIHNoLCBpLCBpaSwgajsKCiAgICBpZiAoc21hc2spIHsKICAgICAgc3cgPSBzbWFzay53aWR0aDsKICAgICAgc2ggPSBzbWFzay5oZWlnaHQ7CiAgICAgIGFscGhhQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHN3ICogc2gpOwogICAgICBzbWFzay5maWxsR3JheUJ1ZmZlcihhbHBoYUJ1Zik7CgogICAgICBpZiAoc3cgIT09IHdpZHRoIHx8IHNoICE9PSBoZWlnaHQpIHsKICAgICAgICBhbHBoYUJ1ZiA9IHJlc2l6ZUltYWdlTWFzayhhbHBoYUJ1Ziwgc21hc2suYnBjLCBzdywgc2gsIHdpZHRoLCBoZWlnaHQpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKG1hc2spIHsKICAgICAgaWYgKG1hc2sgaW5zdGFuY2VvZiBQREZJbWFnZSkgewogICAgICAgIHN3ID0gbWFzay53aWR0aDsKICAgICAgICBzaCA9IG1hc2suaGVpZ2h0OwogICAgICAgIGFscGhhQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHN3ICogc2gpOwogICAgICAgIG1hc2subnVtQ29tcHMgPSAxOwogICAgICAgIG1hc2suZmlsbEdyYXlCdWZmZXIoYWxwaGFCdWYpOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHN3ICogc2g7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgICBhbHBoYUJ1ZltpXSA9IDI1NSAtIGFscGhhQnVmW2ldOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN3ICE9PSB3aWR0aCB8fCBzaCAhPT0gaGVpZ2h0KSB7CiAgICAgICAgICBhbHBoYUJ1ZiA9IHJlc2l6ZUltYWdlTWFzayhhbHBoYUJ1ZiwgbWFzay5icGMsIHN3LCBzaCwgd2lkdGgsIGhlaWdodCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkobWFzaykpIHsKICAgICAgICBhbHBoYUJ1ZiA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCAqIGhlaWdodCk7CiAgICAgICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHdpZHRoICogaGVpZ2h0OyBpIDwgaWk7ICsraSkgewogICAgICAgICAgbGV0IG9wYWNpdHkgPSAwOwogICAgICAgICAgY29uc3QgaW1hZ2VPZmZzZXQgPSBpICogbnVtQ29tcHM7CgogICAgICAgICAgZm9yIChqID0gMDsgaiA8IG51bUNvbXBzOyArK2opIHsKICAgICAgICAgICAgY29uc3QgY29sb3IgPSBpbWFnZVtpbWFnZU9mZnNldCArIGpdOwogICAgICAgICAgICBjb25zdCBtYXNrT2Zmc2V0ID0gaiAqIDI7CgogICAgICAgICAgICBpZiAoY29sb3IgPCBtYXNrW21hc2tPZmZzZXRdIHx8IGNvbG9yID4gbWFza1ttYXNrT2Zmc2V0ICsgMV0pIHsKICAgICAgICAgICAgICBvcGFjaXR5ID0gMjU1OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYWxwaGFCdWZbaV0gPSBvcGFjaXR5OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gbWFzayBmb3JtYXQuIik7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoYWxwaGFCdWYpIHsKICAgICAgZm9yIChpID0gMCwgaiA9IDMsIGlpID0gd2lkdGggKiBhY3R1YWxIZWlnaHQ7IGkgPCBpaTsgKytpLCBqICs9IDQpIHsKICAgICAgICByZ2JhQnVmW2pdID0gYWxwaGFCdWZbaV07CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAoaSA9IDAsIGogPSAzLCBpaSA9IHdpZHRoICogYWN0dWFsSGVpZ2h0OyBpIDwgaWk7ICsraSwgaiArPSA0KSB7CiAgICAgICAgcmdiYUJ1ZltqXSA9IDI1NTsKICAgICAgfQogICAgfQogIH0KCiAgdW5kb1ByZWJsZW5kKGJ1ZmZlciwgd2lkdGgsIGhlaWdodCkgewogICAgY29uc3QgbWF0dGUgPSB0aGlzLnNtYXNrICYmIHRoaXMuc21hc2subWF0dGU7CgogICAgaWYgKCFtYXR0ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgbWF0dGVSZ2IgPSB0aGlzLmNvbG9yU3BhY2UuZ2V0UmdiKG1hdHRlLCAwKTsKICAgIGNvbnN0IG1hdHRlUiA9IG1hdHRlUmdiWzBdOwogICAgY29uc3QgbWF0dGVHID0gbWF0dGVSZ2JbMV07CiAgICBjb25zdCBtYXR0ZUIgPSBtYXR0ZVJnYlsyXTsKICAgIGNvbnN0IGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0ICogNDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSA0KSB7CiAgICAgIGNvbnN0IGFscGhhID0gYnVmZmVyW2kgKyAzXTsKCiAgICAgIGlmIChhbHBoYSA9PT0gMCkgewogICAgICAgIGJ1ZmZlcltpXSA9IDI1NTsKICAgICAgICBidWZmZXJbaSArIDFdID0gMjU1OwogICAgICAgIGJ1ZmZlcltpICsgMl0gPSAyNTU7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGsgPSAyNTUgLyBhbHBoYTsKICAgICAgYnVmZmVyW2ldID0gKGJ1ZmZlcltpXSAtIG1hdHRlUikgKiBrICsgbWF0dGVSOwogICAgICBidWZmZXJbaSArIDFdID0gKGJ1ZmZlcltpICsgMV0gLSBtYXR0ZUcpICogayArIG1hdHRlRzsKICAgICAgYnVmZmVyW2kgKyAyXSA9IChidWZmZXJbaSArIDJdIC0gbWF0dGVCKSAqIGsgKyBtYXR0ZUI7CiAgICB9CiAgfQoKICBjcmVhdGVJbWFnZURhdGEoZm9yY2VSR0JBID0gZmFsc2UpIHsKICAgIGNvbnN0IGRyYXdXaWR0aCA9IHRoaXMuZHJhd1dpZHRoOwogICAgY29uc3QgZHJhd0hlaWdodCA9IHRoaXMuZHJhd0hlaWdodDsKICAgIGNvbnN0IGltZ0RhdGEgPSB7CiAgICAgIHdpZHRoOiBkcmF3V2lkdGgsCiAgICAgIGhlaWdodDogZHJhd0hlaWdodCwKICAgICAgaW50ZXJwb2xhdGU6IHRoaXMuaW50ZXJwb2xhdGUsCiAgICAgIGtpbmQ6IDAsCiAgICAgIGRhdGE6IG51bGwKICAgIH07CiAgICBjb25zdCBudW1Db21wcyA9IHRoaXMubnVtQ29tcHM7CiAgICBjb25zdCBvcmlnaW5hbFdpZHRoID0gdGhpcy53aWR0aDsKICAgIGNvbnN0IG9yaWdpbmFsSGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICBjb25zdCBicGMgPSB0aGlzLmJwYzsKICAgIGNvbnN0IHJvd0J5dGVzID0gb3JpZ2luYWxXaWR0aCAqIG51bUNvbXBzICogYnBjICsgNyA+PiAzOwoKICAgIGlmICghZm9yY2VSR0JBKSB7CiAgICAgIGxldCBraW5kOwoKICAgICAgaWYgKHRoaXMuY29sb3JTcGFjZS5uYW1lID09PSAiRGV2aWNlR3JheSIgJiYgYnBjID09PSAxKSB7CiAgICAgICAga2luZCA9IF91dGlsLkltYWdlS2luZC5HUkFZU0NBTEVfMUJQUDsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbG9yU3BhY2UubmFtZSA9PT0gIkRldmljZVJHQiIgJiYgYnBjID09PSA4ICYmICF0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgICAga2luZCA9IF91dGlsLkltYWdlS2luZC5SR0JfMjRCUFA7CiAgICAgIH0KCiAgICAgIGlmIChraW5kICYmICF0aGlzLnNtYXNrICYmICF0aGlzLm1hc2sgJiYgZHJhd1dpZHRoID09PSBvcmlnaW5hbFdpZHRoICYmIGRyYXdIZWlnaHQgPT09IG9yaWdpbmFsSGVpZ2h0KSB7CiAgICAgICAgaW1nRGF0YS5raW5kID0ga2luZDsKICAgICAgICBpbWdEYXRhLmRhdGEgPSB0aGlzLmdldEltYWdlQnl0ZXMob3JpZ2luYWxIZWlnaHQgKiByb3dCeXRlcywge30pOwoKICAgICAgICBpZiAodGhpcy5uZWVkc0RlY29kZSkgewogICAgICAgICAgKDAsIF91dGlsLmFzc2VydCkoa2luZCA9PT0gX3V0aWwuSW1hZ2VLaW5kLkdSQVlTQ0FMRV8xQlBQLCAiUERGSW1hZ2UuY3JlYXRlSW1hZ2VEYXRhOiBUaGUgaW1hZ2UgbXVzdCBiZSBncmF5c2NhbGUuIik7CiAgICAgICAgICBjb25zdCBidWZmZXIgPSBpbWdEYXRhLmRhdGE7CgogICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYnVmZmVyLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgYnVmZmVyW2ldIF49IDB4ZmY7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaW1nRGF0YTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaW1hZ2UgaW5zdGFuY2VvZiBfanBlZ19zdHJlYW0uSnBlZ1N0cmVhbSAmJiAhdGhpcy5zbWFzayAmJiAhdGhpcy5tYXNrKSB7CiAgICAgICAgbGV0IGltYWdlTGVuZ3RoID0gb3JpZ2luYWxIZWlnaHQgKiByb3dCeXRlczsKCiAgICAgICAgc3dpdGNoICh0aGlzLmNvbG9yU3BhY2UubmFtZSkgewogICAgICAgICAgY2FzZSAiRGV2aWNlR3JheSI6CiAgICAgICAgICAgIGltYWdlTGVuZ3RoICo9IDM7CgogICAgICAgICAgY2FzZSAiRGV2aWNlUkdCIjoKICAgICAgICAgIGNhc2UgIkRldmljZUNNWUsiOgogICAgICAgICAgICBpbWdEYXRhLmtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuUkdCXzI0QlBQOwogICAgICAgICAgICBpbWdEYXRhLmRhdGEgPSB0aGlzLmdldEltYWdlQnl0ZXMoaW1hZ2VMZW5ndGgsIHsKICAgICAgICAgICAgICBkcmF3V2lkdGgsCiAgICAgICAgICAgICAgZHJhd0hlaWdodCwKICAgICAgICAgICAgICBmb3JjZVJHQjogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGltZ0RhdGE7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgY29uc3QgaW1nQXJyYXkgPSB0aGlzLmdldEltYWdlQnl0ZXMob3JpZ2luYWxIZWlnaHQgKiByb3dCeXRlcywgewogICAgICBpbnRlcm5hbDogdHJ1ZQogICAgfSk7CiAgICBjb25zdCBhY3R1YWxIZWlnaHQgPSAwIHwgaW1nQXJyYXkubGVuZ3RoIC8gcm93Qnl0ZXMgKiBkcmF3SGVpZ2h0IC8gb3JpZ2luYWxIZWlnaHQ7CiAgICBjb25zdCBjb21wcyA9IHRoaXMuZ2V0Q29tcG9uZW50cyhpbWdBcnJheSk7CiAgICBsZXQgYWxwaGEwMSwgbWF5YmVVbmRvUHJlYmxlbmQ7CgogICAgaWYgKCFmb3JjZVJHQkEgJiYgIXRoaXMuc21hc2sgJiYgIXRoaXMubWFzaykgewogICAgICBpbWdEYXRhLmtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuUkdCXzI0QlBQOwogICAgICBpbWdEYXRhLmRhdGEgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoZHJhd1dpZHRoICogZHJhd0hlaWdodCAqIDMpOwogICAgICBhbHBoYTAxID0gMDsKICAgICAgbWF5YmVVbmRvUHJlYmxlbmQgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIGltZ0RhdGEua2luZCA9IF91dGlsLkltYWdlS2luZC5SR0JBXzMyQlBQOwogICAgICBpbWdEYXRhLmRhdGEgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoZHJhd1dpZHRoICogZHJhd0hlaWdodCAqIDQpOwogICAgICBhbHBoYTAxID0gMTsKICAgICAgbWF5YmVVbmRvUHJlYmxlbmQgPSB0cnVlOwogICAgICB0aGlzLmZpbGxPcGFjaXR5KGltZ0RhdGEuZGF0YSwgZHJhd1dpZHRoLCBkcmF3SGVpZ2h0LCBhY3R1YWxIZWlnaHQsIGNvbXBzKTsKICAgIH0KCiAgICBpZiAodGhpcy5uZWVkc0RlY29kZSkgewogICAgICB0aGlzLmRlY29kZUJ1ZmZlcihjb21wcyk7CiAgICB9CgogICAgdGhpcy5jb2xvclNwYWNlLmZpbGxSZ2IoaW1nRGF0YS5kYXRhLCBvcmlnaW5hbFdpZHRoLCBvcmlnaW5hbEhlaWdodCwgZHJhd1dpZHRoLCBkcmF3SGVpZ2h0LCBhY3R1YWxIZWlnaHQsIGJwYywgY29tcHMsIGFscGhhMDEpOwoKICAgIGlmIChtYXliZVVuZG9QcmVibGVuZCkgewogICAgICB0aGlzLnVuZG9QcmVibGVuZChpbWdEYXRhLmRhdGEsIGRyYXdXaWR0aCwgYWN0dWFsSGVpZ2h0KTsKICAgIH0KCiAgICByZXR1cm4gaW1nRGF0YTsKICB9CgogIGZpbGxHcmF5QnVmZmVyKGJ1ZmZlcikgewogICAgY29uc3QgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwoKICAgIGlmIChudW1Db21wcyAhPT0gMSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYFJlYWRpbmcgZ3JheSBzY2FsZSBmcm9tIGEgY29sb3IgaW1hZ2U6ICR7bnVtQ29tcHN9YCk7CiAgICB9CgogICAgY29uc3Qgd2lkdGggPSB0aGlzLndpZHRoOwogICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICBjb25zdCBicGMgPSB0aGlzLmJwYzsKICAgIGNvbnN0IHJvd0J5dGVzID0gd2lkdGggKiBudW1Db21wcyAqIGJwYyArIDcgPj4gMzsKICAgIGNvbnN0IGltZ0FycmF5ID0gdGhpcy5nZXRJbWFnZUJ5dGVzKGhlaWdodCAqIHJvd0J5dGVzLCB7CiAgICAgIGludGVybmFsOiB0cnVlCiAgICB9KTsKICAgIGNvbnN0IGNvbXBzID0gdGhpcy5nZXRDb21wb25lbnRzKGltZ0FycmF5KTsKICAgIGxldCBpLCBsZW5ndGg7CgogICAgaWYgKGJwYyA9PT0gMSkgewogICAgICBsZW5ndGggPSB3aWR0aCAqIGhlaWdodDsKCiAgICAgIGlmICh0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgICBidWZmZXJbaV0gPSBjb21wc1tpXSAtIDEgJiAyNTU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgYnVmZmVyW2ldID0gLWNvbXBzW2ldICYgMjU1OwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgIHRoaXMuZGVjb2RlQnVmZmVyKGNvbXBzKTsKICAgIH0KCiAgICBsZW5ndGggPSB3aWR0aCAqIGhlaWdodDsKICAgIGNvbnN0IHNjYWxlID0gMjU1IC8gKCgxIDw8IGJwYykgLSAxKTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgYnVmZmVyW2ldID0gc2NhbGUgKiBjb21wc1tpXTsKICAgIH0KICB9CgogIGdldEltYWdlQnl0ZXMobGVuZ3RoLCB7CiAgICBkcmF3V2lkdGgsCiAgICBkcmF3SGVpZ2h0LAogICAgZm9yY2VSR0IgPSBmYWxzZSwKICAgIGludGVybmFsID0gZmFsc2UKICB9KSB7CiAgICB0aGlzLmltYWdlLnJlc2V0KCk7CiAgICB0aGlzLmltYWdlLmRyYXdXaWR0aCA9IGRyYXdXaWR0aCB8fCB0aGlzLndpZHRoOwogICAgdGhpcy5pbWFnZS5kcmF3SGVpZ2h0ID0gZHJhd0hlaWdodCB8fCB0aGlzLmhlaWdodDsKICAgIHRoaXMuaW1hZ2UuZm9yY2VSR0IgPSAhIWZvcmNlUkdCOwogICAgY29uc3QgaW1hZ2VCeXRlcyA9IHRoaXMuaW1hZ2UuZ2V0Qnl0ZXMobGVuZ3RoKTsKCiAgICBpZiAoaW50ZXJuYWwgfHwgdGhpcy5pbWFnZSBpbnN0YW5jZW9mIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSkgewogICAgICByZXR1cm4gaW1hZ2VCeXRlczsKICAgIH0KCiAgICAoMCwgX3V0aWwuYXNzZXJ0KShpbWFnZUJ5dGVzIGluc3RhbmNlb2YgVWludDhBcnJheSwgJ1BERkltYWdlLmdldEltYWdlQnl0ZXM6IFVuc3VwcG9ydGVkICJpbWFnZUJ5dGVzIiB0eXBlLicpOwogICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGltYWdlQnl0ZXMpOwogIH0KCn0KCmV4cG9ydHMuUERGSW1hZ2UgPSBQREZJbWFnZTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmFwcGx5TWFza0ltYWdlRGF0YSA9IGFwcGx5TWFza0ltYWdlRGF0YTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpmdW5jdGlvbiBhcHBseU1hc2tJbWFnZURhdGEoewogIHNyYywKICBzcmNQb3MgPSAwLAogIGRlc3QsCiAgZGVzdFBvcyA9IDAsCiAgd2lkdGgsCiAgaGVpZ2h0LAogIGludmVyc2VEZWNvZGUgPSBmYWxzZQp9KSB7CiAgY29uc3Qgb3BhcXVlID0gX3V0aWwuRmVhdHVyZVRlc3QuaXNMaXR0bGVFbmRpYW4gPyAweGZmMDAwMDAwIDogMHgwMDAwMDBmZjsKICBjb25zdCBbemVyb01hcHBpbmcsIG9uZU1hcHBpbmddID0gIWludmVyc2VEZWNvZGUgPyBbb3BhcXVlLCAwXSA6IFswLCBvcGFxdWVdOwogIGNvbnN0IHdpZHRoSW5Tb3VyY2UgPSB3aWR0aCA+PiAzOwogIGNvbnN0IHdpZHRoUmVtYWluZGVyID0gd2lkdGggJiA3OwogIGNvbnN0IHNyY0xlbmd0aCA9IHNyYy5sZW5ndGg7CiAgZGVzdCA9IG5ldyBVaW50MzJBcnJheShkZXN0LmJ1ZmZlcik7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgIGZvciAoY29uc3QgbWF4ID0gc3JjUG9zICsgd2lkdGhJblNvdXJjZTsgc3JjUG9zIDwgbWF4OyBzcmNQb3MrKykgewogICAgICBjb25zdCBlbGVtID0gc3JjUG9zIDwgc3JjTGVuZ3RoID8gc3JjW3NyY1Bvc10gOiAyNTU7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwMDAwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwMDAgPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxMDAgPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICAgIGRlc3RbZGVzdFBvcysrXSA9IGVsZW0gJiAwYjEwID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgICBkZXN0W2Rlc3RQb3MrK10gPSBlbGVtICYgMGIxID8gb25lTWFwcGluZyA6IHplcm9NYXBwaW5nOwogICAgfQoKICAgIGlmICh3aWR0aFJlbWFpbmRlciA9PT0gMCkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBjb25zdCBlbGVtID0gc3JjUG9zIDwgc3JjTGVuZ3RoID8gc3JjW3NyY1BvcysrXSA6IDI1NTsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdpZHRoUmVtYWluZGVyOyBqKyspIHsKICAgICAgZGVzdFtkZXN0UG9zKytdID0gZWxlbSAmIDEgPDwgNyAtIGogPyBvbmVNYXBwaW5nIDogemVyb01hcHBpbmc7CiAgICB9CiAgfQoKICByZXR1cm4gewogICAgc3JjUG9zLAogICAgZGVzdFBvcwogIH07Cn0KCi8qKiovIH0pLAovKiA2NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmluY3JlbWVudGFsVXBkYXRlID0gaW5jcmVtZW50YWxVcGRhdGU7CmV4cG9ydHMud3JpdGVEaWN0ID0gd3JpdGVEaWN0OwpleHBvcnRzLndyaXRlT2JqZWN0ID0gd3JpdGVPYmplY3Q7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX3htbF9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY2KTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9jcnlwdG8gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDY3KTsKCmZ1bmN0aW9uIHdyaXRlT2JqZWN0KHJlZiwgb2JqLCBidWZmZXIsIHRyYW5zZm9ybSkgewogIGJ1ZmZlci5wdXNoKGAke3JlZi5udW19ICR7cmVmLmdlbn0gb2JqXG5gKTsKCiAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIHdyaXRlRGljdChvYmosIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICB3cml0ZVN0cmVhbShvYmosIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9CgogIGJ1ZmZlci5wdXNoKCJcbmVuZG9ialxuIik7Cn0KCmZ1bmN0aW9uIHdyaXRlRGljdChkaWN0LCBidWZmZXIsIHRyYW5zZm9ybSkgewogIGJ1ZmZlci5wdXNoKCI8PCIpOwoKICBmb3IgKGNvbnN0IGtleSBvZiBkaWN0LmdldEtleXMoKSkgewogICAgYnVmZmVyLnB1c2goYCAvJHsoMCwgX2NvcmVfdXRpbHMuZXNjYXBlUERGTmFtZSkoa2V5KX0gYCk7CiAgICB3cml0ZVZhbHVlKGRpY3QuZ2V0UmF3KGtleSksIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9CgogIGJ1ZmZlci5wdXNoKCI+PiIpOwp9CgpmdW5jdGlvbiB3cml0ZVN0cmVhbShzdHJlYW0sIGJ1ZmZlciwgdHJhbnNmb3JtKSB7CiAgd3JpdGVEaWN0KHN0cmVhbS5kaWN0LCBidWZmZXIsIHRyYW5zZm9ybSk7CiAgYnVmZmVyLnB1c2goIiBzdHJlYW1cbiIpOwogIGxldCBzdHJpbmcgPSBzdHJlYW0uZ2V0U3RyaW5nKCk7CgogIGlmICh0cmFuc2Zvcm0gIT09IG51bGwpIHsKICAgIHN0cmluZyA9IHRyYW5zZm9ybS5lbmNyeXB0U3RyaW5nKHN0cmluZyk7CiAgfQoKICBidWZmZXIucHVzaChzdHJpbmcsICJcbmVuZHN0cmVhbVxuIik7Cn0KCmZ1bmN0aW9uIHdyaXRlQXJyYXkoYXJyYXksIGJ1ZmZlciwgdHJhbnNmb3JtKSB7CiAgYnVmZmVyLnB1c2goIlsiKTsKICBsZXQgZmlyc3QgPSB0cnVlOwoKICBmb3IgKGNvbnN0IHZhbCBvZiBhcnJheSkgewogICAgaWYgKCFmaXJzdCkgewogICAgICBidWZmZXIucHVzaCgiICIpOwogICAgfSBlbHNlIHsKICAgICAgZmlyc3QgPSBmYWxzZTsKICAgIH0KCiAgICB3cml0ZVZhbHVlKHZhbCwgYnVmZmVyLCB0cmFuc2Zvcm0pOwogIH0KCiAgYnVmZmVyLnB1c2goIl0iKTsKfQoKZnVuY3Rpb24gd3JpdGVWYWx1ZSh2YWx1ZSwgYnVmZmVyLCB0cmFuc2Zvcm0pIHsKICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICBidWZmZXIucHVzaChgLyR7KDAsIF9jb3JlX3V0aWxzLmVzY2FwZVBERk5hbWUpKHZhbHVlLm5hbWUpfWApOwogIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgIGJ1ZmZlci5wdXNoKGAke3ZhbHVlLm51bX0gJHt2YWx1ZS5nZW59IFJgKTsKICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICB3cml0ZUFycmF5KHZhbHVlLCBidWZmZXIsIHRyYW5zZm9ybSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciKSB7CiAgICBpZiAodHJhbnNmb3JtICE9PSBudWxsKSB7CiAgICAgIHZhbHVlID0gdHJhbnNmb3JtLmVuY3J5cHRTdHJpbmcodmFsdWUpOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKGAoJHsoMCwgX3V0aWwuZXNjYXBlU3RyaW5nKSh2YWx1ZSl9KWApOwogIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAibnVtYmVyIikgewogICAgYnVmZmVyLnB1c2goKDAsIF9jb3JlX3V0aWxzLm51bWJlclRvU3RyaW5nKSh2YWx1ZSkpOwogIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAiYm9vbGVhbiIpIHsKICAgIGJ1ZmZlci5wdXNoKHZhbHVlLnRvU3RyaW5nKCkpOwogIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICB3cml0ZURpY3QodmFsdWUsIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgIHdyaXRlU3RyZWFtKHZhbHVlLCBidWZmZXIsIHRyYW5zZm9ybSk7CiAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gbnVsbCkgewogICAgYnVmZmVyLnB1c2goIm51bGwiKTsKICB9IGVsc2UgewogICAgKDAsIF91dGlsLndhcm4pKGBVbmhhbmRsZWQgdmFsdWUgaW4gd3JpdGVyOiAke3R5cGVvZiB2YWx1ZX0sIHBsZWFzZSBmaWxlIGEgYnVnLmApOwogIH0KfQoKZnVuY3Rpb24gd3JpdGVJbnQobnVtYmVyLCBzaXplLCBvZmZzZXQsIGJ1ZmZlcikgewogIGZvciAobGV0IGkgPSBzaXplICsgb2Zmc2V0IC0gMTsgaSA+IG9mZnNldCAtIDE7IGktLSkgewogICAgYnVmZmVyW2ldID0gbnVtYmVyICYgMHhmZjsKICAgIG51bWJlciA+Pj0gODsKICB9CgogIHJldHVybiBvZmZzZXQgKyBzaXplOwp9CgpmdW5jdGlvbiB3cml0ZVN0cmluZyhzdHJpbmcsIG9mZnNldCwgYnVmZmVyKSB7CiAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHN0cmluZy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgYnVmZmVyW29mZnNldCArIGldID0gc3RyaW5nLmNoYXJDb2RlQXQoaSkgJiAweGZmOwogIH0KfQoKZnVuY3Rpb24gY29tcHV0ZU1ENShmaWxlc2l6ZSwgeHJlZkluZm8pIHsKICBjb25zdCB0aW1lID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7CiAgY29uc3QgZmlsZW5hbWUgPSB4cmVmSW5mby5maWxlbmFtZSB8fCAiIjsKICBjb25zdCBtZDVCdWZmZXIgPSBbdGltZS50b1N0cmluZygpLCBmaWxlbmFtZSwgZmlsZXNpemUudG9TdHJpbmcoKV07CiAgbGV0IG1kNUJ1ZmZlckxlbiA9IG1kNUJ1ZmZlci5yZWR1Y2UoKGEsIHN0cikgPT4gYSArIHN0ci5sZW5ndGgsIDApOwoKICBmb3IgKGNvbnN0IHZhbHVlIG9mIE9iamVjdC52YWx1ZXMoeHJlZkluZm8uaW5mbykpIHsKICAgIG1kNUJ1ZmZlci5wdXNoKHZhbHVlKTsKICAgIG1kNUJ1ZmZlckxlbiArPSB2YWx1ZS5sZW5ndGg7CiAgfQoKICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KG1kNUJ1ZmZlckxlbik7CiAgbGV0IG9mZnNldCA9IDA7CgogIGZvciAoY29uc3Qgc3RyIG9mIG1kNUJ1ZmZlcikgewogICAgd3JpdGVTdHJpbmcoc3RyLCBvZmZzZXQsIGFycmF5KTsKICAgIG9mZnNldCArPSBzdHIubGVuZ3RoOwogIH0KCiAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKSgoMCwgX2NyeXB0by5jYWxjdWxhdGVNRDUpKGFycmF5KSk7Cn0KCmZ1bmN0aW9uIHdyaXRlWEZBRGF0YUZvckFjcm9mb3JtKHN0ciwgbmV3UmVmcykgewogIGNvbnN0IHhtbCA9IG5ldyBfeG1sX3BhcnNlci5TaW1wbGVYTUxQYXJzZXIoewogICAgaGFzQXR0cmlidXRlczogdHJ1ZQogIH0pLnBhcnNlRnJvbVN0cmluZyhzdHIpOwoKICBmb3IgKGNvbnN0IHsKICAgIHhmYQogIH0gb2YgbmV3UmVmcykgewogICAgaWYgKCF4ZmEpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3QgewogICAgICBwYXRoLAogICAgICB2YWx1ZQogICAgfSA9IHhmYTsKCiAgICBpZiAoIXBhdGgpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgY29uc3Qgbm9kZSA9IHhtbC5kb2N1bWVudEVsZW1lbnQuc2VhcmNoTm9kZSgoMCwgX2NvcmVfdXRpbHMucGFyc2VYRkFQYXRoKShwYXRoKSwgMCk7CgogICAgaWYgKG5vZGUpIHsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgbm9kZS5jaGlsZE5vZGVzID0gdmFsdWUubWFwKHZhbCA9PiBuZXcgX3htbF9wYXJzZXIuU2ltcGxlRE9NTm9kZSgidmFsdWUiLCB2YWwpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBub2RlLmNoaWxkTm9kZXMgPSBbbmV3IF94bWxfcGFyc2VyLlNpbXBsZURPTU5vZGUoIiN0ZXh0IiwgdmFsdWUpXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBOb2RlIG5vdCBmb3VuZCBmb3IgcGF0aDogJHtwYXRofWApOwogICAgfQogIH0KCiAgY29uc3QgYnVmZmVyID0gW107CiAgeG1sLmRvY3VtZW50RWxlbWVudC5kdW1wKGJ1ZmZlcik7CiAgcmV0dXJuIGJ1ZmZlci5qb2luKCIiKTsKfQoKZnVuY3Rpb24gdXBkYXRlWEZBKHsKICB4ZmFEYXRhLAogIHhmYURhdGFzZXRzUmVmLAogIGhhc1hmYURhdGFzZXRzRW50cnksCiAgYWNyb0Zvcm1SZWYsCiAgYWNyb0Zvcm0sCiAgbmV3UmVmcywKICB4cmVmLAogIHhyZWZJbmZvCn0pIHsKICBpZiAoeHJlZiA9PT0gbnVsbCkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKCFoYXNYZmFEYXRhc2V0c0VudHJ5KSB7CiAgICBpZiAoIWFjcm9Gb3JtUmVmKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiWEZBIC0gQ2Fubm90IHNhdmUgaXQiKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG9sZFhmYSA9IGFjcm9Gb3JtLmdldCgiWEZBIik7CiAgICBjb25zdCBuZXdYZmEgPSBvbGRYZmEuc2xpY2UoKTsKICAgIG5ld1hmYS5zcGxpY2UoMiwgMCwgImRhdGFzZXRzIik7CiAgICBuZXdYZmEuc3BsaWNlKDMsIDAsIHhmYURhdGFzZXRzUmVmKTsKICAgIGFjcm9Gb3JtLnNldCgiWEZBIiwgbmV3WGZhKTsKICAgIGNvbnN0IGVuY3J5cHQgPSB4cmVmLmVuY3J5cHQ7CiAgICBsZXQgdHJhbnNmb3JtID0gbnVsbDsKCiAgICBpZiAoZW5jcnlwdCkgewogICAgICB0cmFuc2Zvcm0gPSBlbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShhY3JvRm9ybVJlZi5udW0sIGFjcm9Gb3JtUmVmLmdlbik7CiAgICB9CgogICAgY29uc3QgYnVmZmVyID0gW2Ake2Fjcm9Gb3JtUmVmLm51bX0gJHthY3JvRm9ybVJlZi5nZW59IG9ialxuYF07CiAgICB3cml0ZURpY3QoYWNyb0Zvcm0sIGJ1ZmZlciwgdHJhbnNmb3JtKTsKICAgIGJ1ZmZlci5wdXNoKCJcbiIpOwogICAgYWNyb0Zvcm0uc2V0KCJYRkEiLCBvbGRYZmEpOwogICAgbmV3UmVmcy5wdXNoKHsKICAgICAgcmVmOiBhY3JvRm9ybVJlZiwKICAgICAgZGF0YTogYnVmZmVyLmpvaW4oIiIpCiAgICB9KTsKICB9CgogIGlmICh4ZmFEYXRhID09PSBudWxsKSB7CiAgICBjb25zdCBkYXRhc2V0cyA9IHhyZWYuZmV0Y2hJZlJlZih4ZmFEYXRhc2V0c1JlZik7CiAgICB4ZmFEYXRhID0gd3JpdGVYRkFEYXRhRm9yQWNyb2Zvcm0oZGF0YXNldHMuZ2V0U3RyaW5nKCksIG5ld1JlZnMpOwogIH0KCiAgY29uc3QgZW5jcnlwdCA9IHhyZWYuZW5jcnlwdDsKCiAgaWYgKGVuY3J5cHQpIHsKICAgIGNvbnN0IHRyYW5zZm9ybSA9IGVuY3J5cHQuY3JlYXRlQ2lwaGVyVHJhbnNmb3JtKHhmYURhdGFzZXRzUmVmLm51bSwgeGZhRGF0YXNldHNSZWYuZ2VuKTsKICAgIHhmYURhdGEgPSB0cmFuc2Zvcm0uZW5jcnlwdFN0cmluZyh4ZmFEYXRhKTsKICB9CgogIGNvbnN0IGRhdGEgPSBgJHt4ZmFEYXRhc2V0c1JlZi5udW19ICR7eGZhRGF0YXNldHNSZWYuZ2VufSBvYmpcbmAgKyBgPDwgL1R5cGUgL0VtYmVkZGVkRmlsZSAvTGVuZ3RoICR7eGZhRGF0YS5sZW5ndGh9Pj5cbnN0cmVhbVxuYCArIHhmYURhdGEgKyAiXG5lbmRzdHJlYW1cbmVuZG9ialxuIjsKICBuZXdSZWZzLnB1c2goewogICAgcmVmOiB4ZmFEYXRhc2V0c1JlZiwKICAgIGRhdGEKICB9KTsKfQoKZnVuY3Rpb24gaW5jcmVtZW50YWxVcGRhdGUoewogIG9yaWdpbmFsRGF0YSwKICB4cmVmSW5mbywKICBuZXdSZWZzLAogIHhyZWYgPSBudWxsLAogIGhhc1hmYSA9IGZhbHNlLAogIHhmYURhdGFzZXRzUmVmID0gbnVsbCwKICBoYXNYZmFEYXRhc2V0c0VudHJ5ID0gZmFsc2UsCiAgYWNyb0Zvcm1SZWYgPSBudWxsLAogIGFjcm9Gb3JtID0gbnVsbCwKICB4ZmFEYXRhID0gbnVsbAp9KSB7CiAgaWYgKGhhc1hmYSkgewogICAgdXBkYXRlWEZBKHsKICAgICAgeGZhRGF0YSwKICAgICAgeGZhRGF0YXNldHNSZWYsCiAgICAgIGhhc1hmYURhdGFzZXRzRW50cnksCiAgICAgIGFjcm9Gb3JtUmVmLAogICAgICBhY3JvRm9ybSwKICAgICAgbmV3UmVmcywKICAgICAgeHJlZiwKICAgICAgeHJlZkluZm8KICAgIH0pOwogIH0KCiAgY29uc3QgbmV3WHJlZiA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KG51bGwpOwogIGNvbnN0IHJlZkZvclhyZWZUYWJsZSA9IHhyZWZJbmZvLm5ld1JlZjsKICBsZXQgYnVmZmVyLCBiYXNlT2Zmc2V0OwogIGNvbnN0IGxhc3RCeXRlID0gb3JpZ2luYWxEYXRhLmF0KC0xKTsKCiAgaWYgKGxhc3RCeXRlID09PSAweDBhIHx8IGxhc3RCeXRlID09PSAweDBkKSB7CiAgICBidWZmZXIgPSBbXTsKICAgIGJhc2VPZmZzZXQgPSBvcmlnaW5hbERhdGEubGVuZ3RoOwogIH0gZWxzZSB7CiAgICBidWZmZXIgPSBbIlxuIl07CiAgICBiYXNlT2Zmc2V0ID0gb3JpZ2luYWxEYXRhLmxlbmd0aCArIDE7CiAgfQoKICBuZXdYcmVmLnNldCgiU2l6ZSIsIHJlZkZvclhyZWZUYWJsZS5udW0gKyAxKTsKICBuZXdYcmVmLnNldCgiUHJldiIsIHhyZWZJbmZvLnN0YXJ0WFJlZik7CiAgbmV3WHJlZi5zZXQoIlR5cGUiLCBfcHJpbWl0aXZlcy5OYW1lLmdldCgiWFJlZiIpKTsKCiAgaWYgKHhyZWZJbmZvLnJvb3RSZWYgIT09IG51bGwpIHsKICAgIG5ld1hyZWYuc2V0KCJSb290IiwgeHJlZkluZm8ucm9vdFJlZik7CiAgfQoKICBpZiAoeHJlZkluZm8uaW5mb1JlZiAhPT0gbnVsbCkgewogICAgbmV3WHJlZi5zZXQoIkluZm8iLCB4cmVmSW5mby5pbmZvUmVmKTsKICB9CgogIGlmICh4cmVmSW5mby5lbmNyeXB0UmVmICE9PSBudWxsKSB7CiAgICBuZXdYcmVmLnNldCgiRW5jcnlwdCIsIHhyZWZJbmZvLmVuY3J5cHRSZWYpOwogIH0KCiAgbmV3UmVmcy5wdXNoKHsKICAgIHJlZjogcmVmRm9yWHJlZlRhYmxlLAogICAgZGF0YTogIiIKICB9KTsKICBuZXdSZWZzID0gbmV3UmVmcy5zb3J0KChhLCBiKSA9PiB7CiAgICByZXR1cm4gYS5yZWYubnVtIC0gYi5yZWYubnVtOwogIH0pOwogIGNvbnN0IHhyZWZUYWJsZURhdGEgPSBbWzAsIDEsIDB4ZmZmZl1dOwogIGNvbnN0IGluZGV4ZXMgPSBbMCwgMV07CiAgbGV0IG1heE9mZnNldCA9IDA7CgogIGZvciAoY29uc3QgewogICAgcmVmLAogICAgZGF0YQogIH0gb2YgbmV3UmVmcykgewogICAgbWF4T2Zmc2V0ID0gTWF0aC5tYXgobWF4T2Zmc2V0LCBiYXNlT2Zmc2V0KTsKICAgIHhyZWZUYWJsZURhdGEucHVzaChbMSwgYmFzZU9mZnNldCwgTWF0aC5taW4ocmVmLmdlbiwgMHhmZmZmKV0pOwogICAgYmFzZU9mZnNldCArPSBkYXRhLmxlbmd0aDsKICAgIGluZGV4ZXMucHVzaChyZWYubnVtLCAxKTsKICAgIGJ1ZmZlci5wdXNoKGRhdGEpOwogIH0KCiAgbmV3WHJlZi5zZXQoIkluZGV4IiwgaW5kZXhlcyk7CgogIGlmIChBcnJheS5pc0FycmF5KHhyZWZJbmZvLmZpbGVJZHMpICYmIHhyZWZJbmZvLmZpbGVJZHMubGVuZ3RoID4gMCkgewogICAgY29uc3QgbWQ1ID0gY29tcHV0ZU1ENShiYXNlT2Zmc2V0LCB4cmVmSW5mbyk7CiAgICBuZXdYcmVmLnNldCgiSUQiLCBbeHJlZkluZm8uZmlsZUlkc1swXSwgbWQ1XSk7CiAgfQoKICBjb25zdCBvZmZzZXRTaXplID0gTWF0aC5jZWlsKE1hdGgubG9nMihtYXhPZmZzZXQpIC8gOCk7CiAgY29uc3Qgc2l6ZXMgPSBbMSwgb2Zmc2V0U2l6ZSwgMl07CiAgY29uc3Qgc3RydWN0U2l6ZSA9IHNpemVzWzBdICsgc2l6ZXNbMV0gKyBzaXplc1syXTsKICBjb25zdCB0YWJsZUxlbmd0aCA9IHN0cnVjdFNpemUgKiB4cmVmVGFibGVEYXRhLmxlbmd0aDsKICBuZXdYcmVmLnNldCgiVyIsIHNpemVzKTsKICBuZXdYcmVmLnNldCgiTGVuZ3RoIiwgdGFibGVMZW5ndGgpOwogIGJ1ZmZlci5wdXNoKGAke3JlZkZvclhyZWZUYWJsZS5udW19ICR7cmVmRm9yWHJlZlRhYmxlLmdlbn0gb2JqXG5gKTsKICB3cml0ZURpY3QobmV3WHJlZiwgYnVmZmVyLCBudWxsKTsKICBidWZmZXIucHVzaCgiIHN0cmVhbVxuIik7CiAgY29uc3QgYnVmZmVyTGVuID0gYnVmZmVyLnJlZHVjZSgoYSwgc3RyKSA9PiBhICsgc3RyLmxlbmd0aCwgMCk7CiAgY29uc3QgZm9vdGVyID0gYFxuZW5kc3RyZWFtXG5lbmRvYmpcbnN0YXJ0eHJlZlxuJHtiYXNlT2Zmc2V0fVxuJSVFT0ZcbmA7CiAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShvcmlnaW5hbERhdGEubGVuZ3RoICsgYnVmZmVyTGVuICsgdGFibGVMZW5ndGggKyBmb290ZXIubGVuZ3RoKTsKICBhcnJheS5zZXQob3JpZ2luYWxEYXRhKTsKICBsZXQgb2Zmc2V0ID0gb3JpZ2luYWxEYXRhLmxlbmd0aDsKCiAgZm9yIChjb25zdCBzdHIgb2YgYnVmZmVyKSB7CiAgICB3cml0ZVN0cmluZyhzdHIsIG9mZnNldCwgYXJyYXkpOwogICAgb2Zmc2V0ICs9IHN0ci5sZW5ndGg7CiAgfQoKICBmb3IgKGNvbnN0IFt0eXBlLCBvYmpPZmZzZXQsIGdlbl0gb2YgeHJlZlRhYmxlRGF0YSkgewogICAgb2Zmc2V0ID0gd3JpdGVJbnQodHlwZSwgc2l6ZXNbMF0sIG9mZnNldCwgYXJyYXkpOwogICAgb2Zmc2V0ID0gd3JpdGVJbnQob2JqT2Zmc2V0LCBzaXplc1sxXSwgb2Zmc2V0LCBhcnJheSk7CiAgICBvZmZzZXQgPSB3cml0ZUludChnZW4sIHNpemVzWzJdLCBvZmZzZXQsIGFycmF5KTsKICB9CgogIHdyaXRlU3RyaW5nKGZvb3Rlciwgb2Zmc2V0LCBhcnJheSk7CiAgcmV0dXJuIGFycmF5Owp9CgovKioqLyB9KSwKLyogNjYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5YTUxQYXJzZXJFcnJvckNvZGUgPSBleHBvcnRzLlhNTFBhcnNlckJhc2UgPSBleHBvcnRzLlNpbXBsZVhNTFBhcnNlciA9IGV4cG9ydHMuU2ltcGxlRE9NTm9kZSA9IHZvaWQgMDsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgpjb25zdCBYTUxQYXJzZXJFcnJvckNvZGUgPSB7CiAgTm9FcnJvcjogMCwKICBFbmRPZkRvY3VtZW50OiAtMSwKICBVbnRlcm1pbmF0ZWRDZGF0OiAtMiwKICBVbnRlcm1pbmF0ZWRYbWxEZWNsYXJhdGlvbjogLTMsCiAgVW50ZXJtaW5hdGVkRG9jdHlwZURlY2xhcmF0aW9uOiAtNCwKICBVbnRlcm1pbmF0ZWRDb21tZW50OiAtNSwKICBNYWxmb3JtZWRFbGVtZW50OiAtNiwKICBPdXRPZk1lbW9yeTogLTcsCiAgVW50ZXJtaW5hdGVkQXR0cmlidXRlVmFsdWU6IC04LAogIFVudGVybWluYXRlZEVsZW1lbnQ6IC05LAogIEVsZW1lbnROZXZlckJlZ3VuOiAtMTAKfTsKZXhwb3J0cy5YTUxQYXJzZXJFcnJvckNvZGUgPSBYTUxQYXJzZXJFcnJvckNvZGU7CgpmdW5jdGlvbiBpc1doaXRlc3BhY2UocywgaW5kZXgpIHsKICBjb25zdCBjaCA9IHNbaW5kZXhdOwogIHJldHVybiBjaCA9PT0gIiAiIHx8IGNoID09PSAiXG4iIHx8IGNoID09PSAiXHIiIHx8IGNoID09PSAiXHQiOwp9CgpmdW5jdGlvbiBpc1doaXRlc3BhY2VTdHJpbmcocykgewogIGZvciAobGV0IGkgPSAwLCBpaSA9IHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgaWYgKCFpc1doaXRlc3BhY2UocywgaSkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KCiAgcmV0dXJuIHRydWU7Cn0KCmNsYXNzIFhNTFBhcnNlckJhc2UgewogIF9yZXNvbHZlRW50aXRpZXMocykgewogICAgcmV0dXJuIHMucmVwbGFjZSgvJihbXjtdKyk7L2csIChhbGwsIGVudGl0eSkgPT4gewogICAgICBpZiAoZW50aXR5LnN1YnN0cmluZygwLCAyKSA9PT0gIiN4IikgewogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludChlbnRpdHkuc3Vic3RyaW5nKDIpLCAxNikpOwogICAgICB9IGVsc2UgaWYgKGVudGl0eS5zdWJzdHJpbmcoMCwgMSkgPT09ICIjIikgewogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludChlbnRpdHkuc3Vic3RyaW5nKDEpLCAxMCkpOwogICAgICB9CgogICAgICBzd2l0Y2ggKGVudGl0eSkgewogICAgICAgIGNhc2UgImx0IjoKICAgICAgICAgIHJldHVybiAiPCI7CgogICAgICAgIGNhc2UgImd0IjoKICAgICAgICAgIHJldHVybiAiPiI7CgogICAgICAgIGNhc2UgImFtcCI6CiAgICAgICAgICByZXR1cm4gIiYiOwoKICAgICAgICBjYXNlICJxdW90IjoKICAgICAgICAgIHJldHVybiAnIic7CgogICAgICAgIGNhc2UgImFwb3MiOgogICAgICAgICAgcmV0dXJuICInIjsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMub25SZXNvbHZlRW50aXR5KGVudGl0eSk7CiAgICB9KTsKICB9CgogIF9wYXJzZUNvbnRlbnQocywgc3RhcnQpIHsKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBbXTsKICAgIGxldCBwb3MgPSBzdGFydDsKCiAgICBmdW5jdGlvbiBza2lwV3MoKSB7CiAgICAgIHdoaWxlIChwb3MgPCBzLmxlbmd0aCAmJiBpc1doaXRlc3BhY2UocywgcG9zKSkgewogICAgICAgICsrcG9zOwogICAgICB9CiAgICB9CgogICAgd2hpbGUgKHBvcyA8IHMubGVuZ3RoICYmICFpc1doaXRlc3BhY2UocywgcG9zKSAmJiBzW3Bvc10gIT09ICI+IiAmJiBzW3Bvc10gIT09ICIvIikgewogICAgICArK3BvczsKICAgIH0KCiAgICBjb25zdCBuYW1lID0gcy5zdWJzdHJpbmcoc3RhcnQsIHBvcyk7CiAgICBza2lwV3MoKTsKCiAgICB3aGlsZSAocG9zIDwgcy5sZW5ndGggJiYgc1twb3NdICE9PSAiPiIgJiYgc1twb3NdICE9PSAiLyIgJiYgc1twb3NdICE9PSAiPyIpIHsKICAgICAgc2tpcFdzKCk7CiAgICAgIGxldCBhdHRyTmFtZSA9ICIiLAogICAgICAgICAgYXR0clZhbHVlID0gIiI7CgogICAgICB3aGlsZSAocG9zIDwgcy5sZW5ndGggJiYgIWlzV2hpdGVzcGFjZShzLCBwb3MpICYmIHNbcG9zXSAhPT0gIj0iKSB7CiAgICAgICAgYXR0ck5hbWUgKz0gc1twb3NdOwogICAgICAgICsrcG9zOwogICAgICB9CgogICAgICBza2lwV3MoKTsKCiAgICAgIGlmIChzW3Bvc10gIT09ICI9IikgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICArK3BvczsKICAgICAgc2tpcFdzKCk7CiAgICAgIGNvbnN0IGF0dHJFbmRDaGFyID0gc1twb3NdOwoKICAgICAgaWYgKGF0dHJFbmRDaGFyICE9PSAnIicgJiYgYXR0ckVuZENoYXIgIT09ICInIikgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBhdHRyRW5kSW5kZXggPSBzLmluZGV4T2YoYXR0ckVuZENoYXIsICsrcG9zKTsKCiAgICAgIGlmIChhdHRyRW5kSW5kZXggPCAwKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGF0dHJWYWx1ZSA9IHMuc3Vic3RyaW5nKHBvcywgYXR0ckVuZEluZGV4KTsKICAgICAgYXR0cmlidXRlcy5wdXNoKHsKICAgICAgICBuYW1lOiBhdHRyTmFtZSwKICAgICAgICB2YWx1ZTogdGhpcy5fcmVzb2x2ZUVudGl0aWVzKGF0dHJWYWx1ZSkKICAgICAgfSk7CiAgICAgIHBvcyA9IGF0dHJFbmRJbmRleCArIDE7CiAgICAgIHNraXBXcygpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIG5hbWUsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIHBhcnNlZDogcG9zIC0gc3RhcnQKICAgIH07CiAgfQoKICBfcGFyc2VQcm9jZXNzaW5nSW5zdHJ1Y3Rpb24ocywgc3RhcnQpIHsKICAgIGxldCBwb3MgPSBzdGFydDsKCiAgICBmdW5jdGlvbiBza2lwV3MoKSB7CiAgICAgIHdoaWxlIChwb3MgPCBzLmxlbmd0aCAmJiBpc1doaXRlc3BhY2UocywgcG9zKSkgewogICAgICAgICsrcG9zOwogICAgICB9CiAgICB9CgogICAgd2hpbGUgKHBvcyA8IHMubGVuZ3RoICYmICFpc1doaXRlc3BhY2UocywgcG9zKSAmJiBzW3Bvc10gIT09ICI+IiAmJiBzW3Bvc10gIT09ICI/IiAmJiBzW3Bvc10gIT09ICIvIikgewogICAgICArK3BvczsKICAgIH0KCiAgICBjb25zdCBuYW1lID0gcy5zdWJzdHJpbmcoc3RhcnQsIHBvcyk7CiAgICBza2lwV3MoKTsKICAgIGNvbnN0IGF0dHJTdGFydCA9IHBvczsKCiAgICB3aGlsZSAocG9zIDwgcy5sZW5ndGggJiYgKHNbcG9zXSAhPT0gIj8iIHx8IHNbcG9zICsgMV0gIT09ICI+IikpIHsKICAgICAgKytwb3M7CiAgICB9CgogICAgY29uc3QgdmFsdWUgPSBzLnN1YnN0cmluZyhhdHRyU3RhcnQsIHBvcyk7CiAgICByZXR1cm4gewogICAgICBuYW1lLAogICAgICB2YWx1ZSwKICAgICAgcGFyc2VkOiBwb3MgLSBzdGFydAogICAgfTsKICB9CgogIHBhcnNlWG1sKHMpIHsKICAgIGxldCBpID0gMDsKCiAgICB3aGlsZSAoaSA8IHMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGNoID0gc1tpXTsKICAgICAgbGV0IGogPSBpOwoKICAgICAgaWYgKGNoID09PSAiPCIpIHsKICAgICAgICArK2o7CiAgICAgICAgY29uc3QgY2gyID0gc1tqXTsKICAgICAgICBsZXQgcTsKCiAgICAgICAgc3dpdGNoIChjaDIpIHsKICAgICAgICAgIGNhc2UgIi8iOgogICAgICAgICAgICArK2o7CiAgICAgICAgICAgIHEgPSBzLmluZGV4T2YoIj4iLCBqKTsKCiAgICAgICAgICAgIGlmIChxIDwgMCkgewogICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuVW50ZXJtaW5hdGVkRWxlbWVudCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLm9uRW5kRWxlbWVudChzLnN1YnN0cmluZyhqLCBxKSk7CiAgICAgICAgICAgIGogPSBxICsgMTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiPyI6CiAgICAgICAgICAgICsrajsKCiAgICAgICAgICAgIGNvbnN0IHBpID0gdGhpcy5fcGFyc2VQcm9jZXNzaW5nSW5zdHJ1Y3Rpb24ocywgaik7CgogICAgICAgICAgICBpZiAocy5zdWJzdHJpbmcoaiArIHBpLnBhcnNlZCwgaiArIHBpLnBhcnNlZCArIDIpICE9PSAiPz4iKSB7CiAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5VbnRlcm1pbmF0ZWRYbWxEZWNsYXJhdGlvbik7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLm9uUGkocGkubmFtZSwgcGkudmFsdWUpOwogICAgICAgICAgICBqICs9IHBpLnBhcnNlZCArIDI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIiEiOgogICAgICAgICAgICBpZiAocy5zdWJzdHJpbmcoaiArIDEsIGogKyAzKSA9PT0gIi0tIikgewogICAgICAgICAgICAgIHEgPSBzLmluZGV4T2YoIi0tPiIsIGogKyAzKTsKCiAgICAgICAgICAgICAgaWYgKHEgPCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLlVudGVybWluYXRlZENvbW1lbnQpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5vbkNvbW1lbnQocy5zdWJzdHJpbmcoaiArIDMsIHEpKTsKICAgICAgICAgICAgICBqID0gcSArIDM7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocy5zdWJzdHJpbmcoaiArIDEsIGogKyA4KSA9PT0gIltDREFUQVsiKSB7CiAgICAgICAgICAgICAgcSA9IHMuaW5kZXhPZigiXV0+IiwgaiArIDgpOwoKICAgICAgICAgICAgICBpZiAocSA8IDApIHsKICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuVW50ZXJtaW5hdGVkQ2RhdCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLm9uQ2RhdGEocy5zdWJzdHJpbmcoaiArIDgsIHEpKTsKICAgICAgICAgICAgICBqID0gcSArIDM7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocy5zdWJzdHJpbmcoaiArIDEsIGogKyA4KSA9PT0gIkRPQ1RZUEUiKSB7CiAgICAgICAgICAgICAgY29uc3QgcTIgPSBzLmluZGV4T2YoIlsiLCBqICsgOCk7CiAgICAgICAgICAgICAgbGV0IGNvbXBsZXhEb2N0eXBlID0gZmFsc2U7CiAgICAgICAgICAgICAgcSA9IHMuaW5kZXhPZigiPiIsIGogKyA4KTsKCiAgICAgICAgICAgICAgaWYgKHEgPCAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLlVudGVybWluYXRlZERvY3R5cGVEZWNsYXJhdGlvbik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocTIgPiAwICYmIHEgPiBxMikgewogICAgICAgICAgICAgICAgcSA9IHMuaW5kZXhPZigiXT4iLCBqICsgOCk7CgogICAgICAgICAgICAgICAgaWYgKHEgPCAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcihYTUxQYXJzZXJFcnJvckNvZGUuVW50ZXJtaW5hdGVkRG9jdHlwZURlY2xhcmF0aW9uKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbXBsZXhEb2N0eXBlID0gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IGRvY3R5cGVDb250ZW50ID0gcy5zdWJzdHJpbmcoaiArIDgsIHEgKyAoY29tcGxleERvY3R5cGUgPyAxIDogMCkpOwogICAgICAgICAgICAgIHRoaXMub25Eb2N0eXBlKGRvY3R5cGVDb250ZW50KTsKICAgICAgICAgICAgICBqID0gcSArIChjb21wbGV4RG9jdHlwZSA/IDIgOiAxKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoWE1MUGFyc2VyRXJyb3JDb2RlLk1hbGZvcm1lZEVsZW1lbnQpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuX3BhcnNlQ29udGVudChzLCBqKTsKCiAgICAgICAgICAgIGlmIChjb250ZW50ID09PSBudWxsKSB7CiAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5NYWxmb3JtZWRFbGVtZW50KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBpc0Nsb3NlZCA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHMuc3Vic3RyaW5nKGogKyBjb250ZW50LnBhcnNlZCwgaiArIGNvbnRlbnQucGFyc2VkICsgMikgPT09ICIvPiIpIHsKICAgICAgICAgICAgICBpc0Nsb3NlZCA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocy5zdWJzdHJpbmcoaiArIGNvbnRlbnQucGFyc2VkLCBqICsgY29udGVudC5wYXJzZWQgKyAxKSAhPT0gIj4iKSB7CiAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKFhNTFBhcnNlckVycm9yQ29kZS5VbnRlcm1pbmF0ZWRFbGVtZW50KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMub25CZWdpbkVsZW1lbnQoY29udGVudC5uYW1lLCBjb250ZW50LmF0dHJpYnV0ZXMsIGlzQ2xvc2VkKTsKICAgICAgICAgICAgaiArPSBjb250ZW50LnBhcnNlZCArIChpc0Nsb3NlZCA/IDIgOiAxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHdoaWxlIChqIDwgcy5sZW5ndGggJiYgc1tqXSAhPT0gIjwiKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB0ZXh0ID0gcy5zdWJzdHJpbmcoaSwgaik7CiAgICAgICAgdGhpcy5vblRleHQodGhpcy5fcmVzb2x2ZUVudGl0aWVzKHRleHQpKTsKICAgICAgfQoKICAgICAgaSA9IGo7CiAgICB9CiAgfQoKICBvblJlc29sdmVFbnRpdHkobmFtZSkgewogICAgcmV0dXJuIGAmJHtuYW1lfTtgOwogIH0KCiAgb25QaShuYW1lLCB2YWx1ZSkge30KCiAgb25Db21tZW50KHRleHQpIHt9CgogIG9uQ2RhdGEodGV4dCkge30KCiAgb25Eb2N0eXBlKGRvY3R5cGVDb250ZW50KSB7fQoKICBvblRleHQodGV4dCkge30KCiAgb25CZWdpbkVsZW1lbnQobmFtZSwgYXR0cmlidXRlcywgaXNFbXB0eSkge30KCiAgb25FbmRFbGVtZW50KG5hbWUpIHt9CgogIG9uRXJyb3IoY29kZSkge30KCn0KCmV4cG9ydHMuWE1MUGFyc2VyQmFzZSA9IFhNTFBhcnNlckJhc2U7CgpjbGFzcyBTaW1wbGVET01Ob2RlIHsKICBjb25zdHJ1Y3Rvcihub2RlTmFtZSwgbm9kZVZhbHVlKSB7CiAgICB0aGlzLm5vZGVOYW1lID0gbm9kZU5hbWU7CiAgICB0aGlzLm5vZGVWYWx1ZSA9IG5vZGVWYWx1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyZW50Tm9kZSIsIHsKICAgICAgdmFsdWU6IG51bGwsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9CgogIGdldCBmaXJzdENoaWxkKCkgewogICAgcmV0dXJuIHRoaXMuY2hpbGROb2RlcyAmJiB0aGlzLmNoaWxkTm9kZXNbMF07CiAgfQoKICBnZXQgbmV4dFNpYmxpbmcoKSB7CiAgICBjb25zdCBjaGlsZE5vZGVzID0gdGhpcy5wYXJlbnROb2RlLmNoaWxkTm9kZXM7CgogICAgaWYgKCFjaGlsZE5vZGVzKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgY29uc3QgaW5kZXggPSBjaGlsZE5vZGVzLmluZGV4T2YodGhpcyk7CgogICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBjaGlsZE5vZGVzW2luZGV4ICsgMV07CiAgfQoKICBnZXQgdGV4dENvbnRlbnQoKSB7CiAgICBpZiAoIXRoaXMuY2hpbGROb2RlcykgewogICAgICByZXR1cm4gdGhpcy5ub2RlVmFsdWUgfHwgIiI7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuY2hpbGROb2Rlcy5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgIHJldHVybiBjaGlsZC50ZXh0Q29udGVudDsKICAgIH0pLmpvaW4oIiIpOwogIH0KCiAgZ2V0IGNoaWxkcmVuKCkgewogICAgcmV0dXJuIHRoaXMuY2hpbGROb2RlcyB8fCBbXTsKICB9CgogIGhhc0NoaWxkTm9kZXMoKSB7CiAgICByZXR1cm4gdGhpcy5jaGlsZE5vZGVzICYmIHRoaXMuY2hpbGROb2Rlcy5sZW5ndGggPiAwOwogIH0KCiAgc2VhcmNoTm9kZShwYXRocywgcG9zKSB7CiAgICBpZiAocG9zID49IHBhdGhzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBjb25zdCBjb21wb25lbnQgPSBwYXRoc1twb3NdOwogICAgY29uc3Qgc3RhY2sgPSBbXTsKICAgIGxldCBub2RlID0gdGhpczsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBpZiAoY29tcG9uZW50Lm5hbWUgPT09IG5vZGUubm9kZU5hbWUpIHsKICAgICAgICBpZiAoY29tcG9uZW50LnBvcyA9PT0gMCkgewogICAgICAgICAgY29uc3QgcmVzID0gbm9kZS5zZWFyY2hOb2RlKHBhdGhzLCBwb3MgKyAxKTsKCiAgICAgICAgICBpZiAocmVzICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBbcGFyZW50XSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgbGV0IHNpYmxpbmdQb3MgPSAwOwoKICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgcGFyZW50LmNoaWxkTm9kZXMpIHsKICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5uYW1lID09PSBjaGlsZC5ub2RlTmFtZSkgewogICAgICAgICAgICAgIGlmIChzaWJsaW5nUG9zID09PSBjb21wb25lbnQucG9zKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQuc2VhcmNoTm9kZShwYXRocywgcG9zICsgMSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzaWJsaW5nUG9zKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbm9kZS5zZWFyY2hOb2RlKHBhdGhzLCBwb3MgKyAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChub2RlLmNoaWxkTm9kZXMgJiYgbm9kZS5jaGlsZE5vZGVzLmxlbmd0aCAhPT0gMCkgewogICAgICAgIHN0YWNrLnB1c2goW25vZGUsIDBdKTsKICAgICAgICBub2RlID0gbm9kZS5jaGlsZE5vZGVzWzBdOwogICAgICB9IGVsc2UgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggIT09IDApIHsKICAgICAgICAgIGNvbnN0IFtwYXJlbnQsIGN1cnJlbnRQb3NdID0gc3RhY2sucG9wKCk7CiAgICAgICAgICBjb25zdCBuZXdQb3MgPSBjdXJyZW50UG9zICsgMTsKCiAgICAgICAgICBpZiAobmV3UG9zIDwgcGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoKSB7CiAgICAgICAgICAgIHN0YWNrLnB1c2goW3BhcmVudCwgbmV3UG9zXSk7CiAgICAgICAgICAgIG5vZGUgPSBwYXJlbnQuY2hpbGROb2Rlc1tuZXdQb3NdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZHVtcChidWZmZXIpIHsKICAgIGlmICh0aGlzLm5vZGVOYW1lID09PSAiI3RleHQiKSB7CiAgICAgIGJ1ZmZlci5wdXNoKCgwLCBfY29yZV91dGlscy5lbmNvZGVUb1htbFN0cmluZykodGhpcy5ub2RlVmFsdWUpKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGJ1ZmZlci5wdXNoKGA8JHt0aGlzLm5vZGVOYW1lfWApOwoKICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMpIHsKICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgdGhpcy5hdHRyaWJ1dGVzKSB7CiAgICAgICAgYnVmZmVyLnB1c2goYCAke2F0dHJpYnV0ZS5uYW1lfT0iJHsoMCwgX2NvcmVfdXRpbHMuZW5jb2RlVG9YbWxTdHJpbmcpKGF0dHJpYnV0ZS52YWx1ZSl9ImApOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuaGFzQ2hpbGROb2RlcygpKSB7CiAgICAgIGJ1ZmZlci5wdXNoKCI+Iik7CgogICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMuY2hpbGROb2RlcykgewogICAgICAgIGNoaWxkLmR1bXAoYnVmZmVyKTsKICAgICAgfQoKICAgICAgYnVmZmVyLnB1c2goYDwvJHt0aGlzLm5vZGVOYW1lfT5gKTsKICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlVmFsdWUpIHsKICAgICAgYnVmZmVyLnB1c2goYD4keygwLCBfY29yZV91dGlscy5lbmNvZGVUb1htbFN0cmluZykodGhpcy5ub2RlVmFsdWUpfTwvJHt0aGlzLm5vZGVOYW1lfT5gKTsKICAgIH0gZWxzZSB7CiAgICAgIGJ1ZmZlci5wdXNoKCIvPiIpOwogICAgfQogIH0KCn0KCmV4cG9ydHMuU2ltcGxlRE9NTm9kZSA9IFNpbXBsZURPTU5vZGU7CgpjbGFzcyBTaW1wbGVYTUxQYXJzZXIgZXh0ZW5kcyBYTUxQYXJzZXJCYXNlIHsKICBjb25zdHJ1Y3Rvcih7CiAgICBoYXNBdHRyaWJ1dGVzID0gZmFsc2UsCiAgICBsb3dlckNhc2VOYW1lID0gZmFsc2UKICB9KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fY3VycmVudEZyYWdtZW50ID0gbnVsbDsKICAgIHRoaXMuX3N0YWNrID0gbnVsbDsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IFhNTFBhcnNlckVycm9yQ29kZS5Ob0Vycm9yOwogICAgdGhpcy5faGFzQXR0cmlidXRlcyA9IGhhc0F0dHJpYnV0ZXM7CiAgICB0aGlzLl9sb3dlckNhc2VOYW1lID0gbG93ZXJDYXNlTmFtZTsKICB9CgogIHBhcnNlRnJvbVN0cmluZyhkYXRhKSB7CiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQgPSBbXTsKICAgIHRoaXMuX3N0YWNrID0gW107CiAgICB0aGlzLl9lcnJvckNvZGUgPSBYTUxQYXJzZXJFcnJvckNvZGUuTm9FcnJvcjsKICAgIHRoaXMucGFyc2VYbWwoZGF0YSk7CgogICAgaWYgKHRoaXMuX2Vycm9yQ29kZSAhPT0gWE1MUGFyc2VyRXJyb3JDb2RlLk5vRXJyb3IpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICBjb25zdCBbZG9jdW1lbnRFbGVtZW50XSA9IHRoaXMuX2N1cnJlbnRGcmFnbWVudDsKCiAgICBpZiAoIWRvY3VtZW50RWxlbWVudCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGRvY3VtZW50RWxlbWVudAogICAgfTsKICB9CgogIG9uVGV4dCh0ZXh0KSB7CiAgICBpZiAoaXNXaGl0ZXNwYWNlU3RyaW5nKHRleHQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBub2RlID0gbmV3IFNpbXBsZURPTU5vZGUoIiN0ZXh0IiwgdGV4dCk7CgogICAgdGhpcy5fY3VycmVudEZyYWdtZW50LnB1c2gobm9kZSk7CiAgfQoKICBvbkNkYXRhKHRleHQpIHsKICAgIGNvbnN0IG5vZGUgPSBuZXcgU2ltcGxlRE9NTm9kZSgiI3RleHQiLCB0ZXh0KTsKCiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQucHVzaChub2RlKTsKICB9CgogIG9uQmVnaW5FbGVtZW50KG5hbWUsIGF0dHJpYnV0ZXMsIGlzRW1wdHkpIHsKICAgIGlmICh0aGlzLl9sb3dlckNhc2VOYW1lKSB7CiAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICB9CgogICAgY29uc3Qgbm9kZSA9IG5ldyBTaW1wbGVET01Ob2RlKG5hbWUpOwogICAgbm9kZS5jaGlsZE5vZGVzID0gW107CgogICAgaWYgKHRoaXMuX2hhc0F0dHJpYnV0ZXMpIHsKICAgICAgbm9kZS5hdHRyaWJ1dGVzID0gYXR0cmlidXRlczsKICAgIH0KCiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQucHVzaChub2RlKTsKCiAgICBpZiAoaXNFbXB0eSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fc3RhY2sucHVzaCh0aGlzLl9jdXJyZW50RnJhZ21lbnQpOwoKICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudCA9IG5vZGUuY2hpbGROb2RlczsKICB9CgogIG9uRW5kRWxlbWVudChuYW1lKSB7CiAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQgPSB0aGlzLl9zdGFjay5wb3AoKSB8fCBbXTsKCiAgICBjb25zdCBsYXN0RWxlbWVudCA9IHRoaXMuX2N1cnJlbnRGcmFnbWVudC5hdCgtMSk7CgogICAgaWYgKCFsYXN0RWxlbWVudCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBsYXN0RWxlbWVudC5jaGlsZE5vZGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgbGFzdEVsZW1lbnQuY2hpbGROb2Rlc1tpXS5wYXJlbnROb2RlID0gbGFzdEVsZW1lbnQ7CiAgICB9CgogICAgcmV0dXJuIGxhc3RFbGVtZW50OwogIH0KCiAgb25FcnJvcihjb2RlKSB7CiAgICB0aGlzLl9lcnJvckNvZGUgPSBjb2RlOwogIH0KCn0KCmV4cG9ydHMuU2ltcGxlWE1MUGFyc2VyID0gU2ltcGxlWE1MUGFyc2VyOwoKLyoqKi8gfSksCi8qIDY3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuY2FsY3VsYXRlU0hBMjU2ID0gZXhwb3J0cy5jYWxjdWxhdGVNRDUgPSBleHBvcnRzLlBERjIwID0gZXhwb3J0cy5QREYxNyA9IGV4cG9ydHMuQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeSA9IGV4cG9ydHMuQVJDRm91ckNpcGhlciA9IGV4cG9ydHMuQUVTMjU2Q2lwaGVyID0gZXhwb3J0cy5BRVMxMjhDaXBoZXIgPSB2b2lkIDA7CmV4cG9ydHMuY2FsY3VsYXRlU0hBMzg0ID0gY2FsY3VsYXRlU0hBMzg0OwpleHBvcnRzLmNhbGN1bGF0ZVNIQTUxMiA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9kZWNyeXB0X3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oNjgpOwoKY2xhc3MgQVJDRm91ckNpcGhlciB7CiAgY29uc3RydWN0b3Ioa2V5KSB7CiAgICB0aGlzLmEgPSAwOwogICAgdGhpcy5iID0gMDsKICAgIGNvbnN0IHMgPSBuZXcgVWludDhBcnJheSgyNTYpOwogICAgY29uc3Qga2V5TGVuZ3RoID0ga2V5Lmxlbmd0aDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7CiAgICAgIHNbaV0gPSBpOwogICAgfQoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IDI1NjsgKytpKSB7CiAgICAgIGNvbnN0IHRtcCA9IHNbaV07CiAgICAgIGogPSBqICsgdG1wICsga2V5W2kgJSBrZXlMZW5ndGhdICYgMHhmZjsKICAgICAgc1tpXSA9IHNbal07CiAgICAgIHNbal0gPSB0bXA7CiAgICB9CgogICAgdGhpcy5zID0gczsKICB9CgogIGVuY3J5cHRCbG9jayhkYXRhKSB7CiAgICBsZXQgYSA9IHRoaXMuYSwKICAgICAgICBiID0gdGhpcy5iOwogICAgY29uc3QgcyA9IHRoaXMuczsKICAgIGNvbnN0IG4gPSBkYXRhLmxlbmd0aDsKICAgIGNvbnN0IG91dHB1dCA9IG5ldyBVaW50OEFycmF5KG4pOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgIGEgPSBhICsgMSAmIDB4ZmY7CiAgICAgIGNvbnN0IHRtcCA9IHNbYV07CiAgICAgIGIgPSBiICsgdG1wICYgMHhmZjsKICAgICAgY29uc3QgdG1wMiA9IHNbYl07CiAgICAgIHNbYV0gPSB0bXAyOwogICAgICBzW2JdID0gdG1wOwogICAgICBvdXRwdXRbaV0gPSBkYXRhW2ldIF4gc1t0bXAgKyB0bXAyICYgMHhmZl07CiAgICB9CgogICAgdGhpcy5hID0gYTsKICAgIHRoaXMuYiA9IGI7CiAgICByZXR1cm4gb3V0cHV0OwogIH0KCiAgZGVjcnlwdEJsb2NrKGRhdGEpIHsKICAgIHJldHVybiB0aGlzLmVuY3J5cHRCbG9jayhkYXRhKTsKICB9CgogIGVuY3J5cHQoZGF0YSkgewogICAgcmV0dXJuIHRoaXMuZW5jcnlwdEJsb2NrKGRhdGEpOwogIH0KCn0KCmV4cG9ydHMuQVJDRm91ckNpcGhlciA9IEFSQ0ZvdXJDaXBoZXI7Cgpjb25zdCBjYWxjdWxhdGVNRDUgPSBmdW5jdGlvbiBjYWxjdWxhdGVNRDVDbG9zdXJlKCkgewogIGNvbnN0IHIgPSBuZXcgVWludDhBcnJheShbNywgMTIsIDE3LCAyMiwgNywgMTIsIDE3LCAyMiwgNywgMTIsIDE3LCAyMiwgNywgMTIsIDE3LCAyMiwgNSwgOSwgMTQsIDIwLCA1LCA5LCAxNCwgMjAsIDUsIDksIDE0LCAyMCwgNSwgOSwgMTQsIDIwLCA0LCAxMSwgMTYsIDIzLCA0LCAxMSwgMTYsIDIzLCA0LCAxMSwgMTYsIDIzLCA0LCAxMSwgMTYsIDIzLCA2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxXSk7CiAgY29uc3QgayA9IG5ldyBJbnQzMkFycmF5KFstNjgwODc2OTM2LCAtMzg5NTY0NTg2LCA2MDYxMDU4MTksIC0xMDQ0NTI1MzMwLCAtMTc2NDE4ODk3LCAxMjAwMDgwNDI2LCAtMTQ3MzIzMTM0MSwgLTQ1NzA1OTgzLCAxNzcwMDM1NDE2LCAtMTk1ODQxNDQxNywgLTQyMDYzLCAtMTk5MDQwNDE2MiwgMTgwNDYwMzY4MiwgLTQwMzQxMTAxLCAtMTUwMjAwMjI5MCwgMTIzNjUzNTMyOSwgLTE2NTc5NjUxMCwgLTEwNjk1MDE2MzIsIDY0MzcxNzcxMywgLTM3Mzg5NzMwMiwgLTcwMTU1ODY5MSwgMzgwMTYwODMsIC02NjA0NzgzMzUsIC00MDU1Mzc4NDgsIDU2ODQ0NjQzOCwgLTEwMTk4MDM2OTAsIC0xODczNjM5NjEsIDExNjM1MzE1MDEsIC0xNDQ0NjgxNDY3LCAtNTE0MDM3ODQsIDE3MzUzMjg0NzMsIC0xOTI2NjA3NzM0LCAtMzc4NTU4LCAtMjAyMjU3NDQ2MywgMTgzOTAzMDU2MiwgLTM1MzA5NTU2LCAtMTUzMDk5MjA2MCwgMTI3Mjg5MzM1MywgLTE1NTQ5NzYzMiwgLTEwOTQ3MzA2NDAsIDY4MTI3OTE3NCwgLTM1ODUzNzIyMiwgLTcyMjUyMTk3OSwgNzYwMjkxODksIC02NDAzNjQ0ODcsIC00MjE4MTU4MzUsIDUzMDc0MjUyMCwgLTk5NTMzODY1MSwgLTE5ODYzMDg0NCwgMTEyNjg5MTQxNSwgLTE0MTYzNTQ5MDUsIC01NzQzNDA1NSwgMTcwMDQ4NTU3MSwgLTE4OTQ5ODY2MDYsIC0xMDUxNTIzLCAtMjA1NDkyMjc5OSwgMTg3MzMxMzM1OSwgLTMwNjExNzQ0LCAtMTU2MDE5ODM4MCwgMTMwOTE1MTY0OSwgLTE0NTUyMzA3MCwgLTExMjAyMTAzNzksIDcxODc4NzI1OSwgLTM0MzQ4NTU1MV0pOwoKICBmdW5jdGlvbiBoYXNoKGRhdGEsIG9mZnNldCwgbGVuZ3RoKSB7CiAgICBsZXQgaDAgPSAxNzMyNTg0MTkzLAogICAgICAgIGgxID0gLTI3MTczMzg3OSwKICAgICAgICBoMiA9IC0xNzMyNTg0MTk0LAogICAgICAgIGgzID0gMjcxNzMzODc4OwogICAgY29uc3QgcGFkZGVkTGVuZ3RoID0gbGVuZ3RoICsgNzIgJiB+NjM7CiAgICBjb25zdCBwYWRkZWQgPSBuZXcgVWludDhBcnJheShwYWRkZWRMZW5ndGgpOwogICAgbGV0IGksIGo7CgogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgIHBhZGRlZFtpXSA9IGRhdGFbb2Zmc2V0KytdOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gMHg4MDsKICAgIGNvbnN0IG4gPSBwYWRkZWRMZW5ndGggLSA4OwoKICAgIHdoaWxlIChpIDwgbikgewogICAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICB9CgogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPDwgMyAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiA1ICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDEzICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDIxICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+PiAyOSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBjb25zdCB3ID0gbmV3IEludDMyQXJyYXkoMTYpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBwYWRkZWRMZW5ndGg7KSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCAxNjsgKytqLCBpICs9IDQpIHsKICAgICAgICB3W2pdID0gcGFkZGVkW2ldIHwgcGFkZGVkW2kgKyAxXSA8PCA4IHwgcGFkZGVkW2kgKyAyXSA8PCAxNiB8IHBhZGRlZFtpICsgM10gPDwgMjQ7CiAgICAgIH0KCiAgICAgIGxldCBhID0gaDAsCiAgICAgICAgICBiID0gaDEsCiAgICAgICAgICBjID0gaDIsCiAgICAgICAgICBkID0gaDMsCiAgICAgICAgICBmLAogICAgICAgICAgZzsKCiAgICAgIGZvciAoaiA9IDA7IGogPCA2NDsgKytqKSB7CiAgICAgICAgaWYgKGogPCAxNikgewogICAgICAgICAgZiA9IGIgJiBjIHwgfmIgJiBkOwogICAgICAgICAgZyA9IGo7CiAgICAgICAgfSBlbHNlIGlmIChqIDwgMzIpIHsKICAgICAgICAgIGYgPSBkICYgYiB8IH5kICYgYzsKICAgICAgICAgIGcgPSA1ICogaiArIDEgJiAxNTsKICAgICAgICB9IGVsc2UgaWYgKGogPCA0OCkgewogICAgICAgICAgZiA9IGIgXiBjIF4gZDsKICAgICAgICAgIGcgPSAzICogaiArIDUgJiAxNTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZiA9IGMgXiAoYiB8IH5kKTsKICAgICAgICAgIGcgPSA3ICogaiAmIDE1OwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdG1wID0gZCwKICAgICAgICAgICAgICByb3RhdGVBcmcgPSBhICsgZiArIGtbal0gKyB3W2ddIHwgMCwKICAgICAgICAgICAgICByb3RhdGUgPSByW2pdOwogICAgICAgIGQgPSBjOwogICAgICAgIGMgPSBiOwogICAgICAgIGIgPSBiICsgKHJvdGF0ZUFyZyA8PCByb3RhdGUgfCByb3RhdGVBcmcgPj4+IDMyIC0gcm90YXRlKSB8IDA7CiAgICAgICAgYSA9IHRtcDsKICAgICAgfQoKICAgICAgaDAgPSBoMCArIGEgfCAwOwogICAgICBoMSA9IGgxICsgYiB8IDA7CiAgICAgIGgyID0gaDIgKyBjIHwgMDsKICAgICAgaDMgPSBoMyArIGQgfCAwOwogICAgfQoKICAgIHJldHVybiBuZXcgVWludDhBcnJheShbaDAgJiAweEZGLCBoMCA+PiA4ICYgMHhGRiwgaDAgPj4gMTYgJiAweEZGLCBoMCA+Pj4gMjQgJiAweEZGLCBoMSAmIDB4RkYsIGgxID4+IDggJiAweEZGLCBoMSA+PiAxNiAmIDB4RkYsIGgxID4+PiAyNCAmIDB4RkYsIGgyICYgMHhGRiwgaDIgPj4gOCAmIDB4RkYsIGgyID4+IDE2ICYgMHhGRiwgaDIgPj4+IDI0ICYgMHhGRiwgaDMgJiAweEZGLCBoMyA+PiA4ICYgMHhGRiwgaDMgPj4gMTYgJiAweEZGLCBoMyA+Pj4gMjQgJiAweEZGXSk7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVNRDUgPSBjYWxjdWxhdGVNRDU7CgpjbGFzcyBXb3JkNjQgewogIGNvbnN0cnVjdG9yKGhpZ2hJbnRlZ2VyLCBsb3dJbnRlZ2VyKSB7CiAgICB0aGlzLmhpZ2ggPSBoaWdoSW50ZWdlciB8IDA7CiAgICB0aGlzLmxvdyA9IGxvd0ludGVnZXIgfCAwOwogIH0KCiAgYW5kKHdvcmQpIHsKICAgIHRoaXMuaGlnaCAmPSB3b3JkLmhpZ2g7CiAgICB0aGlzLmxvdyAmPSB3b3JkLmxvdzsKICB9CgogIHhvcih3b3JkKSB7CiAgICB0aGlzLmhpZ2ggXj0gd29yZC5oaWdoOwogICAgdGhpcy5sb3cgXj0gd29yZC5sb3c7CiAgfQoKICBvcih3b3JkKSB7CiAgICB0aGlzLmhpZ2ggfD0gd29yZC5oaWdoOwogICAgdGhpcy5sb3cgfD0gd29yZC5sb3c7CiAgfQoKICBzaGlmdFJpZ2h0KHBsYWNlcykgewogICAgaWYgKHBsYWNlcyA+PSAzMikgewogICAgICB0aGlzLmxvdyA9IHRoaXMuaGlnaCA+Pj4gcGxhY2VzIC0gMzIgfCAwOwogICAgICB0aGlzLmhpZ2ggPSAwOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5sb3cgPSB0aGlzLmxvdyA+Pj4gcGxhY2VzIHwgdGhpcy5oaWdoIDw8IDMyIC0gcGxhY2VzOwogICAgICB0aGlzLmhpZ2ggPSB0aGlzLmhpZ2ggPj4+IHBsYWNlcyB8IDA7CiAgICB9CiAgfQoKICBzaGlmdExlZnQocGxhY2VzKSB7CiAgICBpZiAocGxhY2VzID49IDMyKSB7CiAgICAgIHRoaXMuaGlnaCA9IHRoaXMubG93IDw8IHBsYWNlcyAtIDMyOwogICAgICB0aGlzLmxvdyA9IDA7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmhpZ2ggPSB0aGlzLmhpZ2ggPDwgcGxhY2VzIHwgdGhpcy5sb3cgPj4+IDMyIC0gcGxhY2VzOwogICAgICB0aGlzLmxvdyA8PD0gcGxhY2VzOwogICAgfQogIH0KCiAgcm90YXRlUmlnaHQocGxhY2VzKSB7CiAgICBsZXQgbG93LCBoaWdoOwoKICAgIGlmIChwbGFjZXMgJiAzMikgewogICAgICBoaWdoID0gdGhpcy5sb3c7CiAgICAgIGxvdyA9IHRoaXMuaGlnaDsKICAgIH0gZWxzZSB7CiAgICAgIGxvdyA9IHRoaXMubG93OwogICAgICBoaWdoID0gdGhpcy5oaWdoOwogICAgfQoKICAgIHBsYWNlcyAmPSAzMTsKICAgIHRoaXMubG93ID0gbG93ID4+PiBwbGFjZXMgfCBoaWdoIDw8IDMyIC0gcGxhY2VzOwogICAgdGhpcy5oaWdoID0gaGlnaCA+Pj4gcGxhY2VzIHwgbG93IDw8IDMyIC0gcGxhY2VzOwogIH0KCiAgbm90KCkgewogICAgdGhpcy5oaWdoID0gfnRoaXMuaGlnaDsKICAgIHRoaXMubG93ID0gfnRoaXMubG93OwogIH0KCiAgYWRkKHdvcmQpIHsKICAgIGNvbnN0IGxvd0FkZCA9ICh0aGlzLmxvdyA+Pj4gMCkgKyAod29yZC5sb3cgPj4+IDApOwogICAgbGV0IGhpZ2hBZGQgPSAodGhpcy5oaWdoID4+PiAwKSArICh3b3JkLmhpZ2ggPj4+IDApOwoKICAgIGlmIChsb3dBZGQgPiAweGZmZmZmZmZmKSB7CiAgICAgIGhpZ2hBZGQgKz0gMTsKICAgIH0KCiAgICB0aGlzLmxvdyA9IGxvd0FkZCB8IDA7CiAgICB0aGlzLmhpZ2ggPSBoaWdoQWRkIHwgMDsKICB9CgogIGNvcHlUbyhieXRlcywgb2Zmc2V0KSB7CiAgICBieXRlc1tvZmZzZXRdID0gdGhpcy5oaWdoID4+PiAyNCAmIDB4ZmY7CiAgICBieXRlc1tvZmZzZXQgKyAxXSA9IHRoaXMuaGlnaCA+PiAxNiAmIDB4ZmY7CiAgICBieXRlc1tvZmZzZXQgKyAyXSA9IHRoaXMuaGlnaCA+PiA4ICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDNdID0gdGhpcy5oaWdoICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDRdID0gdGhpcy5sb3cgPj4+IDI0ICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDVdID0gdGhpcy5sb3cgPj4gMTYgJiAweGZmOwogICAgYnl0ZXNbb2Zmc2V0ICsgNl0gPSB0aGlzLmxvdyA+PiA4ICYgMHhmZjsKICAgIGJ5dGVzW29mZnNldCArIDddID0gdGhpcy5sb3cgJiAweGZmOwogIH0KCiAgYXNzaWduKHdvcmQpIHsKICAgIHRoaXMuaGlnaCA9IHdvcmQuaGlnaDsKICAgIHRoaXMubG93ID0gd29yZC5sb3c7CiAgfQoKfQoKY29uc3QgY2FsY3VsYXRlU0hBMjU2ID0gZnVuY3Rpb24gY2FsY3VsYXRlU0hBMjU2Q2xvc3VyZSgpIHsKICBmdW5jdGlvbiByb3RyKHgsIG4pIHsKICAgIHJldHVybiB4ID4+PiBuIHwgeCA8PCAzMiAtIG47CiAgfQoKICBmdW5jdGlvbiBjaCh4LCB5LCB6KSB7CiAgICByZXR1cm4geCAmIHkgXiB+eCAmIHo7CiAgfQoKICBmdW5jdGlvbiBtYWooeCwgeSwgeikgewogICAgcmV0dXJuIHggJiB5IF4geCAmIHogXiB5ICYgejsKICB9CgogIGZ1bmN0aW9uIHNpZ21hKHgpIHsKICAgIHJldHVybiByb3RyKHgsIDIpIF4gcm90cih4LCAxMykgXiByb3RyKHgsIDIyKTsKICB9CgogIGZ1bmN0aW9uIHNpZ21hUHJpbWUoeCkgewogICAgcmV0dXJuIHJvdHIoeCwgNikgXiByb3RyKHgsIDExKSBeIHJvdHIoeCwgMjUpOwogIH0KCiAgZnVuY3Rpb24gbGl0dGxlU2lnbWEoeCkgewogICAgcmV0dXJuIHJvdHIoeCwgNykgXiByb3RyKHgsIDE4KSBeIHggPj4+IDM7CiAgfQoKICBmdW5jdGlvbiBsaXR0bGVTaWdtYVByaW1lKHgpIHsKICAgIHJldHVybiByb3RyKHgsIDE3KSBeIHJvdHIoeCwgMTkpIF4geCA+Pj4gMTA7CiAgfQoKICBjb25zdCBrID0gWzB4NDI4YTJmOTgsIDB4NzEzNzQ0OTEsIDB4YjVjMGZiY2YsIDB4ZTliNWRiYTUsIDB4Mzk1NmMyNWIsIDB4NTlmMTExZjEsIDB4OTIzZjgyYTQsIDB4YWIxYzVlZDUsIDB4ZDgwN2FhOTgsIDB4MTI4MzViMDEsIDB4MjQzMTg1YmUsIDB4NTUwYzdkYzMsIDB4NzJiZTVkNzQsIDB4ODBkZWIxZmUsIDB4OWJkYzA2YTcsIDB4YzE5YmYxNzQsIDB4ZTQ5YjY5YzEsIDB4ZWZiZTQ3ODYsIDB4MGZjMTlkYzYsIDB4MjQwY2ExY2MsIDB4MmRlOTJjNmYsIDB4NGE3NDg0YWEsIDB4NWNiMGE5ZGMsIDB4NzZmOTg4ZGEsIDB4OTgzZTUxNTIsIDB4YTgzMWM2NmQsIDB4YjAwMzI3YzgsIDB4YmY1OTdmYzcsIDB4YzZlMDBiZjMsIDB4ZDVhNzkxNDcsIDB4MDZjYTYzNTEsIDB4MTQyOTI5NjcsIDB4MjdiNzBhODUsIDB4MmUxYjIxMzgsIDB4NGQyYzZkZmMsIDB4NTMzODBkMTMsIDB4NjUwYTczNTQsIDB4NzY2YTBhYmIsIDB4ODFjMmM5MmUsIDB4OTI3MjJjODUsIDB4YTJiZmU4YTEsIDB4YTgxYTY2NGIsIDB4YzI0YjhiNzAsIDB4Yzc2YzUxYTMsIDB4ZDE5MmU4MTksIDB4ZDY5OTA2MjQsIDB4ZjQwZTM1ODUsIDB4MTA2YWEwNzAsIDB4MTlhNGMxMTYsIDB4MWUzNzZjMDgsIDB4Mjc0ODc3NGMsIDB4MzRiMGJjYjUsIDB4MzkxYzBjYjMsIDB4NGVkOGFhNGEsIDB4NWI5Y2NhNGYsIDB4NjgyZTZmZjMsIDB4NzQ4ZjgyZWUsIDB4NzhhNTYzNmYsIDB4ODRjODc4MTQsIDB4OGNjNzAyMDgsIDB4OTBiZWZmZmEsIDB4YTQ1MDZjZWIsIDB4YmVmOWEzZjcsIDB4YzY3MTc4ZjJdOwoKICBmdW5jdGlvbiBoYXNoKGRhdGEsIG9mZnNldCwgbGVuZ3RoKSB7CiAgICBsZXQgaDAgPSAweDZhMDllNjY3LAogICAgICAgIGgxID0gMHhiYjY3YWU4NSwKICAgICAgICBoMiA9IDB4M2M2ZWYzNzIsCiAgICAgICAgaDMgPSAweGE1NGZmNTNhLAogICAgICAgIGg0ID0gMHg1MTBlNTI3ZiwKICAgICAgICBoNSA9IDB4OWIwNTY4OGMsCiAgICAgICAgaDYgPSAweDFmODNkOWFiLAogICAgICAgIGg3ID0gMHg1YmUwY2QxOTsKICAgIGNvbnN0IHBhZGRlZExlbmd0aCA9IE1hdGguY2VpbCgobGVuZ3RoICsgOSkgLyA2NCkgKiA2NDsKICAgIGNvbnN0IHBhZGRlZCA9IG5ldyBVaW50OEFycmF5KHBhZGRlZExlbmd0aCk7CiAgICBsZXQgaSwgajsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgcGFkZGVkW2ldID0gZGF0YVtvZmZzZXQrK107CiAgICB9CgogICAgcGFkZGVkW2krK10gPSAweDgwOwogICAgY29uc3QgbiA9IHBhZGRlZExlbmd0aCAtIDg7CgogICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgIHBhZGRlZFtpKytdID0gMDsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+Pj4gMjkgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMjEgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMTMgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gNSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA8PCAzICYgMHhmZjsKICAgIGNvbnN0IHcgPSBuZXcgVWludDMyQXJyYXkoNjQpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBwYWRkZWRMZW5ndGg7KSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCAxNjsgKytqKSB7CiAgICAgICAgd1tqXSA9IHBhZGRlZFtpXSA8PCAyNCB8IHBhZGRlZFtpICsgMV0gPDwgMTYgfCBwYWRkZWRbaSArIDJdIDw8IDggfCBwYWRkZWRbaSArIDNdOwogICAgICAgIGkgKz0gNDsKICAgICAgfQoKICAgICAgZm9yIChqID0gMTY7IGogPCA2NDsgKytqKSB7CiAgICAgICAgd1tqXSA9IGxpdHRsZVNpZ21hUHJpbWUod1tqIC0gMl0pICsgd1tqIC0gN10gKyBsaXR0bGVTaWdtYSh3W2ogLSAxNV0pICsgd1tqIC0gMTZdIHwgMDsKICAgICAgfQoKICAgICAgbGV0IGEgPSBoMCwKICAgICAgICAgIGIgPSBoMSwKICAgICAgICAgIGMgPSBoMiwKICAgICAgICAgIGQgPSBoMywKICAgICAgICAgIGUgPSBoNCwKICAgICAgICAgIGYgPSBoNSwKICAgICAgICAgIGcgPSBoNiwKICAgICAgICAgIGggPSBoNywKICAgICAgICAgIHQxLAogICAgICAgICAgdDI7CgogICAgICBmb3IgKGogPSAwOyBqIDwgNjQ7ICsraikgewogICAgICAgIHQxID0gaCArIHNpZ21hUHJpbWUoZSkgKyBjaChlLCBmLCBnKSArIGtbal0gKyB3W2pdOwogICAgICAgIHQyID0gc2lnbWEoYSkgKyBtYWooYSwgYiwgYyk7CiAgICAgICAgaCA9IGc7CiAgICAgICAgZyA9IGY7CiAgICAgICAgZiA9IGU7CiAgICAgICAgZSA9IGQgKyB0MSB8IDA7CiAgICAgICAgZCA9IGM7CiAgICAgICAgYyA9IGI7CiAgICAgICAgYiA9IGE7CiAgICAgICAgYSA9IHQxICsgdDIgfCAwOwogICAgICB9CgogICAgICBoMCA9IGgwICsgYSB8IDA7CiAgICAgIGgxID0gaDEgKyBiIHwgMDsKICAgICAgaDIgPSBoMiArIGMgfCAwOwogICAgICBoMyA9IGgzICsgZCB8IDA7CiAgICAgIGg0ID0gaDQgKyBlIHwgMDsKICAgICAgaDUgPSBoNSArIGYgfCAwOwogICAgICBoNiA9IGg2ICsgZyB8IDA7CiAgICAgIGg3ID0gaDcgKyBoIHwgMDsKICAgIH0KCiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoW2gwID4+IDI0ICYgMHhGRiwgaDAgPj4gMTYgJiAweEZGLCBoMCA+PiA4ICYgMHhGRiwgaDAgJiAweEZGLCBoMSA+PiAyNCAmIDB4RkYsIGgxID4+IDE2ICYgMHhGRiwgaDEgPj4gOCAmIDB4RkYsIGgxICYgMHhGRiwgaDIgPj4gMjQgJiAweEZGLCBoMiA+PiAxNiAmIDB4RkYsIGgyID4+IDggJiAweEZGLCBoMiAmIDB4RkYsIGgzID4+IDI0ICYgMHhGRiwgaDMgPj4gMTYgJiAweEZGLCBoMyA+PiA4ICYgMHhGRiwgaDMgJiAweEZGLCBoNCA+PiAyNCAmIDB4RkYsIGg0ID4+IDE2ICYgMHhGRiwgaDQgPj4gOCAmIDB4RkYsIGg0ICYgMHhGRiwgaDUgPj4gMjQgJiAweEZGLCBoNSA+PiAxNiAmIDB4RkYsIGg1ID4+IDggJiAweEZGLCBoNSAmIDB4RkYsIGg2ID4+IDI0ICYgMHhGRiwgaDYgPj4gMTYgJiAweEZGLCBoNiA+PiA4ICYgMHhGRiwgaDYgJiAweEZGLCBoNyA+PiAyNCAmIDB4RkYsIGg3ID4+IDE2ICYgMHhGRiwgaDcgPj4gOCAmIDB4RkYsIGg3ICYgMHhGRl0pOwogIH0KCiAgcmV0dXJuIGhhc2g7Cn0oKTsKCmV4cG9ydHMuY2FsY3VsYXRlU0hBMjU2ID0gY2FsY3VsYXRlU0hBMjU2OwoKY29uc3QgY2FsY3VsYXRlU0hBNTEyID0gZnVuY3Rpb24gY2FsY3VsYXRlU0hBNTEyQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBjaChyZXN1bHQsIHgsIHksIHosIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5hbmQoeSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLm5vdCgpOwogICAgdG1wLmFuZCh6KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIG1haihyZXN1bHQsIHgsIHksIHosIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5hbmQoeSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLmFuZCh6KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeSk7CiAgICB0bXAuYW5kKHopOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gc2lnbWEocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMjgpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCgzNCk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDM5KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIHNpZ21hUHJpbWUocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMTQpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCgxOCk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDQxKTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hKHJlc3VsdCwgeCwgdG1wKSB7CiAgICByZXN1bHQuYXNzaWduKHgpOwogICAgcmVzdWx0LnJvdGF0ZVJpZ2h0KDEpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCg4KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAuc2hpZnRSaWdodCg3KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hUHJpbWUocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMTkpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCg2MSk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnNoaWZ0UmlnaHQoNik7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgfQoKICBjb25zdCBrID0gW25ldyBXb3JkNjQoMHg0MjhhMmY5OCwgMHhkNzI4YWUyMiksIG5ldyBXb3JkNjQoMHg3MTM3NDQ5MSwgMHgyM2VmNjVjZCksIG5ldyBXb3JkNjQoMHhiNWMwZmJjZiwgMHhlYzRkM2IyZiksIG5ldyBXb3JkNjQoMHhlOWI1ZGJhNSwgMHg4MTg5ZGJiYyksIG5ldyBXb3JkNjQoMHgzOTU2YzI1YiwgMHhmMzQ4YjUzOCksIG5ldyBXb3JkNjQoMHg1OWYxMTFmMSwgMHhiNjA1ZDAxOSksIG5ldyBXb3JkNjQoMHg5MjNmODJhNCwgMHhhZjE5NGY5YiksIG5ldyBXb3JkNjQoMHhhYjFjNWVkNSwgMHhkYTZkODExOCksIG5ldyBXb3JkNjQoMHhkODA3YWE5OCwgMHhhMzAzMDI0MiksIG5ldyBXb3JkNjQoMHgxMjgzNWIwMSwgMHg0NTcwNmZiZSksIG5ldyBXb3JkNjQoMHgyNDMxODViZSwgMHg0ZWU0YjI4YyksIG5ldyBXb3JkNjQoMHg1NTBjN2RjMywgMHhkNWZmYjRlMiksIG5ldyBXb3JkNjQoMHg3MmJlNWQ3NCwgMHhmMjdiODk2ZiksIG5ldyBXb3JkNjQoMHg4MGRlYjFmZSwgMHgzYjE2OTZiMSksIG5ldyBXb3JkNjQoMHg5YmRjMDZhNywgMHgyNWM3MTIzNSksIG5ldyBXb3JkNjQoMHhjMTliZjE3NCwgMHhjZjY5MjY5NCksIG5ldyBXb3JkNjQoMHhlNDliNjljMSwgMHg5ZWYxNGFkMiksIG5ldyBXb3JkNjQoMHhlZmJlNDc4NiwgMHgzODRmMjVlMyksIG5ldyBXb3JkNjQoMHgwZmMxOWRjNiwgMHg4YjhjZDViNSksIG5ldyBXb3JkNjQoMHgyNDBjYTFjYywgMHg3N2FjOWM2NSksIG5ldyBXb3JkNjQoMHgyZGU5MmM2ZiwgMHg1OTJiMDI3NSksIG5ldyBXb3JkNjQoMHg0YTc0ODRhYSwgMHg2ZWE2ZTQ4MyksIG5ldyBXb3JkNjQoMHg1Y2IwYTlkYywgMHhiZDQxZmJkNCksIG5ldyBXb3JkNjQoMHg3NmY5ODhkYSwgMHg4MzExNTNiNSksIG5ldyBXb3JkNjQoMHg5ODNlNTE1MiwgMHhlZTY2ZGZhYiksIG5ldyBXb3JkNjQoMHhhODMxYzY2ZCwgMHgyZGI0MzIxMCksIG5ldyBXb3JkNjQoMHhiMDAzMjdjOCwgMHg5OGZiMjEzZiksIG5ldyBXb3JkNjQoMHhiZjU5N2ZjNywgMHhiZWVmMGVlNCksIG5ldyBXb3JkNjQoMHhjNmUwMGJmMywgMHgzZGE4OGZjMiksIG5ldyBXb3JkNjQoMHhkNWE3OTE0NywgMHg5MzBhYTcyNSksIG5ldyBXb3JkNjQoMHgwNmNhNjM1MSwgMHhlMDAzODI2ZiksIG5ldyBXb3JkNjQoMHgxNDI5Mjk2NywgMHgwYTBlNmU3MCksIG5ldyBXb3JkNjQoMHgyN2I3MGE4NSwgMHg0NmQyMmZmYyksIG5ldyBXb3JkNjQoMHgyZTFiMjEzOCwgMHg1YzI2YzkyNiksIG5ldyBXb3JkNjQoMHg0ZDJjNmRmYywgMHg1YWM0MmFlZCksIG5ldyBXb3JkNjQoMHg1MzM4MGQxMywgMHg5ZDk1YjNkZiksIG5ldyBXb3JkNjQoMHg2NTBhNzM1NCwgMHg4YmFmNjNkZSksIG5ldyBXb3JkNjQoMHg3NjZhMGFiYiwgMHgzYzc3YjJhOCksIG5ldyBXb3JkNjQoMHg4MWMyYzkyZSwgMHg0N2VkYWVlNiksIG5ldyBXb3JkNjQoMHg5MjcyMmM4NSwgMHgxNDgyMzUzYiksIG5ldyBXb3JkNjQoMHhhMmJmZThhMSwgMHg0Y2YxMDM2NCksIG5ldyBXb3JkNjQoMHhhODFhNjY0YiwgMHhiYzQyMzAwMSksIG5ldyBXb3JkNjQoMHhjMjRiOGI3MCwgMHhkMGY4OTc5MSksIG5ldyBXb3JkNjQoMHhjNzZjNTFhMywgMHgwNjU0YmUzMCksIG5ldyBXb3JkNjQoMHhkMTkyZTgxOSwgMHhkNmVmNTIxOCksIG5ldyBXb3JkNjQoMHhkNjk5MDYyNCwgMHg1NTY1YTkxMCksIG5ldyBXb3JkNjQoMHhmNDBlMzU4NSwgMHg1NzcxMjAyYSksIG5ldyBXb3JkNjQoMHgxMDZhYTA3MCwgMHgzMmJiZDFiOCksIG5ldyBXb3JkNjQoMHgxOWE0YzExNiwgMHhiOGQyZDBjOCksIG5ldyBXb3JkNjQoMHgxZTM3NmMwOCwgMHg1MTQxYWI1MyksIG5ldyBXb3JkNjQoMHgyNzQ4Nzc0YywgMHhkZjhlZWI5OSksIG5ldyBXb3JkNjQoMHgzNGIwYmNiNSwgMHhlMTliNDhhOCksIG5ldyBXb3JkNjQoMHgzOTFjMGNiMywgMHhjNWM5NWE2MyksIG5ldyBXb3JkNjQoMHg0ZWQ4YWE0YSwgMHhlMzQxOGFjYiksIG5ldyBXb3JkNjQoMHg1YjljY2E0ZiwgMHg3NzYzZTM3MyksIG5ldyBXb3JkNjQoMHg2ODJlNmZmMywgMHhkNmIyYjhhMyksIG5ldyBXb3JkNjQoMHg3NDhmODJlZSwgMHg1ZGVmYjJmYyksIG5ldyBXb3JkNjQoMHg3OGE1NjM2ZiwgMHg0MzE3MmY2MCksIG5ldyBXb3JkNjQoMHg4NGM4NzgxNCwgMHhhMWYwYWI3MiksIG5ldyBXb3JkNjQoMHg4Y2M3MDIwOCwgMHgxYTY0MzllYyksIG5ldyBXb3JkNjQoMHg5MGJlZmZmYSwgMHgyMzYzMWUyOCksIG5ldyBXb3JkNjQoMHhhNDUwNmNlYiwgMHhkZTgyYmRlOSksIG5ldyBXb3JkNjQoMHhiZWY5YTNmNywgMHhiMmM2NzkxNSksIG5ldyBXb3JkNjQoMHhjNjcxNzhmMiwgMHhlMzcyNTMyYiksIG5ldyBXb3JkNjQoMHhjYTI3M2VjZSwgMHhlYTI2NjE5YyksIG5ldyBXb3JkNjQoMHhkMTg2YjhjNywgMHgyMWMwYzIwNyksIG5ldyBXb3JkNjQoMHhlYWRhN2RkNiwgMHhjZGUwZWIxZSksIG5ldyBXb3JkNjQoMHhmNTdkNGY3ZiwgMHhlZTZlZDE3OCksIG5ldyBXb3JkNjQoMHgwNmYwNjdhYSwgMHg3MjE3NmZiYSksIG5ldyBXb3JkNjQoMHgwYTYzN2RjNSwgMHhhMmM4OThhNiksIG5ldyBXb3JkNjQoMHgxMTNmOTgwNCwgMHhiZWY5MGRhZSksIG5ldyBXb3JkNjQoMHgxYjcxMGIzNSwgMHgxMzFjNDcxYiksIG5ldyBXb3JkNjQoMHgyOGRiNzdmNSwgMHgyMzA0N2Q4NCksIG5ldyBXb3JkNjQoMHgzMmNhYWI3YiwgMHg0MGM3MjQ5MyksIG5ldyBXb3JkNjQoMHgzYzllYmUwYSwgMHgxNWM5YmViYyksIG5ldyBXb3JkNjQoMHg0MzFkNjdjNCwgMHg5YzEwMGQ0YyksIG5ldyBXb3JkNjQoMHg0Y2M1ZDRiZSwgMHhjYjNlNDJiNiksIG5ldyBXb3JkNjQoMHg1OTdmMjk5YywgMHhmYzY1N2UyYSksIG5ldyBXb3JkNjQoMHg1ZmNiNmZhYiwgMHgzYWQ2ZmFlYyksIG5ldyBXb3JkNjQoMHg2YzQ0MTk4YywgMHg0YTQ3NTgxNyldOwoKICBmdW5jdGlvbiBoYXNoKGRhdGEsIG9mZnNldCwgbGVuZ3RoLCBtb2RlMzg0ID0gZmFsc2UpIHsKICAgIGxldCBoMCwgaDEsIGgyLCBoMywgaDQsIGg1LCBoNiwgaDc7CgogICAgaWYgKCFtb2RlMzg0KSB7CiAgICAgIGgwID0gbmV3IFdvcmQ2NCgweDZhMDllNjY3LCAweGYzYmNjOTA4KTsKICAgICAgaDEgPSBuZXcgV29yZDY0KDB4YmI2N2FlODUsIDB4ODRjYWE3M2IpOwogICAgICBoMiA9IG5ldyBXb3JkNjQoMHgzYzZlZjM3MiwgMHhmZTk0ZjgyYik7CiAgICAgIGgzID0gbmV3IFdvcmQ2NCgweGE1NGZmNTNhLCAweDVmMWQzNmYxKTsKICAgICAgaDQgPSBuZXcgV29yZDY0KDB4NTEwZTUyN2YsIDB4YWRlNjgyZDEpOwogICAgICBoNSA9IG5ldyBXb3JkNjQoMHg5YjA1Njg4YywgMHgyYjNlNmMxZik7CiAgICAgIGg2ID0gbmV3IFdvcmQ2NCgweDFmODNkOWFiLCAweGZiNDFiZDZiKTsKICAgICAgaDcgPSBuZXcgV29yZDY0KDB4NWJlMGNkMTksIDB4MTM3ZTIxNzkpOwogICAgfSBlbHNlIHsKICAgICAgaDAgPSBuZXcgV29yZDY0KDB4Y2JiYjlkNWQsIDB4YzEwNTllZDgpOwogICAgICBoMSA9IG5ldyBXb3JkNjQoMHg2MjlhMjkyYSwgMHgzNjdjZDUwNyk7CiAgICAgIGgyID0gbmV3IFdvcmQ2NCgweDkxNTkwMTVhLCAweDMwNzBkZDE3KTsKICAgICAgaDMgPSBuZXcgV29yZDY0KDB4MTUyZmVjZDgsIDB4ZjcwZTU5MzkpOwogICAgICBoNCA9IG5ldyBXb3JkNjQoMHg2NzMzMjY2NywgMHhmZmMwMGIzMSk7CiAgICAgIGg1ID0gbmV3IFdvcmQ2NCgweDhlYjQ0YTg3LCAweDY4NTgxNTExKTsKICAgICAgaDYgPSBuZXcgV29yZDY0KDB4ZGIwYzJlMGQsIDB4NjRmOThmYTcpOwogICAgICBoNyA9IG5ldyBXb3JkNjQoMHg0N2I1NDgxZCwgMHhiZWZhNGZhNCk7CiAgICB9CgogICAgY29uc3QgcGFkZGVkTGVuZ3RoID0gTWF0aC5jZWlsKChsZW5ndGggKyAxNykgLyAxMjgpICogMTI4OwogICAgY29uc3QgcGFkZGVkID0gbmV3IFVpbnQ4QXJyYXkocGFkZGVkTGVuZ3RoKTsKICAgIGxldCBpLCBqOwoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICBwYWRkZWRbaV0gPSBkYXRhW29mZnNldCsrXTsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDB4ODA7CiAgICBjb25zdCBuID0gcGFkZGVkTGVuZ3RoIC0gMTY7CgogICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgIHBhZGRlZFtpKytdID0gMDsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+Pj4gMjkgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMjEgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gMTMgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gNSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA8PCAzICYgMHhmZjsKICAgIGNvbnN0IHcgPSBuZXcgQXJyYXkoODApOwoKICAgIGZvciAoaSA9IDA7IGkgPCA4MDsgaSsrKSB7CiAgICAgIHdbaV0gPSBuZXcgV29yZDY0KDAsIDApOwogICAgfQoKICAgIGxldCBhID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBiID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBjID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGxldCBkID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBlID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBmID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGxldCBnID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBoID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGNvbnN0IHQxID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICAgIHQyID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIGNvbnN0IHRtcDEgPSBuZXcgV29yZDY0KDAsIDApLAogICAgICAgICAgdG1wMiA9IG5ldyBXb3JkNjQoMCwgMCk7CiAgICBsZXQgdG1wMzsKCiAgICBmb3IgKGkgPSAwOyBpIDwgcGFkZGVkTGVuZ3RoOykgewogICAgICBmb3IgKGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgIHdbal0uaGlnaCA9IHBhZGRlZFtpXSA8PCAyNCB8IHBhZGRlZFtpICsgMV0gPDwgMTYgfCBwYWRkZWRbaSArIDJdIDw8IDggfCBwYWRkZWRbaSArIDNdOwogICAgICAgIHdbal0ubG93ID0gcGFkZGVkW2kgKyA0XSA8PCAyNCB8IHBhZGRlZFtpICsgNV0gPDwgMTYgfCBwYWRkZWRbaSArIDZdIDw8IDggfCBwYWRkZWRbaSArIDddOwogICAgICAgIGkgKz0gODsKICAgICAgfQoKICAgICAgZm9yIChqID0gMTY7IGogPCA4MDsgKytqKSB7CiAgICAgICAgdG1wMyA9IHdbal07CiAgICAgICAgbGl0dGxlU2lnbWFQcmltZSh0bXAzLCB3W2ogLSAyXSwgdG1wMik7CiAgICAgICAgdG1wMy5hZGQod1tqIC0gN10pOwogICAgICAgIGxpdHRsZVNpZ21hKHRtcDEsIHdbaiAtIDE1XSwgdG1wMik7CiAgICAgICAgdG1wMy5hZGQodG1wMSk7CiAgICAgICAgdG1wMy5hZGQod1tqIC0gMTZdKTsKICAgICAgfQoKICAgICAgYS5hc3NpZ24oaDApOwogICAgICBiLmFzc2lnbihoMSk7CiAgICAgIGMuYXNzaWduKGgyKTsKICAgICAgZC5hc3NpZ24oaDMpOwogICAgICBlLmFzc2lnbihoNCk7CiAgICAgIGYuYXNzaWduKGg1KTsKICAgICAgZy5hc3NpZ24oaDYpOwogICAgICBoLmFzc2lnbihoNyk7CgogICAgICBmb3IgKGogPSAwOyBqIDwgODA7ICsraikgewogICAgICAgIHQxLmFzc2lnbihoKTsKICAgICAgICBzaWdtYVByaW1lKHRtcDEsIGUsIHRtcDIpOwogICAgICAgIHQxLmFkZCh0bXAxKTsKICAgICAgICBjaCh0bXAxLCBlLCBmLCBnLCB0bXAyKTsKICAgICAgICB0MS5hZGQodG1wMSk7CiAgICAgICAgdDEuYWRkKGtbal0pOwogICAgICAgIHQxLmFkZCh3W2pdKTsKICAgICAgICBzaWdtYSh0MiwgYSwgdG1wMik7CiAgICAgICAgbWFqKHRtcDEsIGEsIGIsIGMsIHRtcDIpOwogICAgICAgIHQyLmFkZCh0bXAxKTsKICAgICAgICB0bXAzID0gaDsKICAgICAgICBoID0gZzsKICAgICAgICBnID0gZjsKICAgICAgICBmID0gZTsKICAgICAgICBkLmFkZCh0MSk7CiAgICAgICAgZSA9IGQ7CiAgICAgICAgZCA9IGM7CiAgICAgICAgYyA9IGI7CiAgICAgICAgYiA9IGE7CiAgICAgICAgdG1wMy5hc3NpZ24odDEpOwogICAgICAgIHRtcDMuYWRkKHQyKTsKICAgICAgICBhID0gdG1wMzsKICAgICAgfQoKICAgICAgaDAuYWRkKGEpOwogICAgICBoMS5hZGQoYik7CiAgICAgIGgyLmFkZChjKTsKICAgICAgaDMuYWRkKGQpOwogICAgICBoNC5hZGQoZSk7CiAgICAgIGg1LmFkZChmKTsKICAgICAgaDYuYWRkKGcpOwogICAgICBoNy5hZGQoaCk7CiAgICB9CgogICAgbGV0IHJlc3VsdDsKCiAgICBpZiAoIW1vZGUzODQpIHsKICAgICAgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoNjQpOwogICAgICBoMC5jb3B5VG8ocmVzdWx0LCAwKTsKICAgICAgaDEuY29weVRvKHJlc3VsdCwgOCk7CiAgICAgIGgyLmNvcHlUbyhyZXN1bHQsIDE2KTsKICAgICAgaDMuY29weVRvKHJlc3VsdCwgMjQpOwogICAgICBoNC5jb3B5VG8ocmVzdWx0LCAzMik7CiAgICAgIGg1LmNvcHlUbyhyZXN1bHQsIDQwKTsKICAgICAgaDYuY29weVRvKHJlc3VsdCwgNDgpOwogICAgICBoNy5jb3B5VG8ocmVzdWx0LCA1Nik7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQgPSBuZXcgVWludDhBcnJheSg0OCk7CiAgICAgIGgwLmNvcHlUbyhyZXN1bHQsIDApOwogICAgICBoMS5jb3B5VG8ocmVzdWx0LCA4KTsKICAgICAgaDIuY29weVRvKHJlc3VsdCwgMTYpOwogICAgICBoMy5jb3B5VG8ocmVzdWx0LCAyNCk7CiAgICAgIGg0LmNvcHlUbyhyZXN1bHQsIDMyKTsKICAgICAgaDUuY29weVRvKHJlc3VsdCwgNDApOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVTSEE1MTIgPSBjYWxjdWxhdGVTSEE1MTI7CgpmdW5jdGlvbiBjYWxjdWxhdGVTSEEzODQoZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICByZXR1cm4gY2FsY3VsYXRlU0hBNTEyKGRhdGEsIG9mZnNldCwgbGVuZ3RoLCB0cnVlKTsKfQoKY2xhc3MgTnVsbENpcGhlciB7CiAgZGVjcnlwdEJsb2NrKGRhdGEpIHsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgZW5jcnlwdChkYXRhKSB7CiAgICByZXR1cm4gZGF0YTsKICB9Cgp9CgpjbGFzcyBBRVNCYXNlQ2lwaGVyIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBBRVNCYXNlQ2lwaGVyKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIEFFU0Jhc2VDaXBoZXIuIik7CiAgICB9CgogICAgdGhpcy5fcyA9IG5ldyBVaW50OEFycmF5KFsweDYzLCAweDdjLCAweDc3LCAweDdiLCAweGYyLCAweDZiLCAweDZmLCAweGM1LCAweDMwLCAweDAxLCAweDY3LCAweDJiLCAweGZlLCAweGQ3LCAweGFiLCAweDc2LCAweGNhLCAweDgyLCAweGM5LCAweDdkLCAweGZhLCAweDU5LCAweDQ3LCAweGYwLCAweGFkLCAweGQ0LCAweGEyLCAweGFmLCAweDljLCAweGE0LCAweDcyLCAweGMwLCAweGI3LCAweGZkLCAweDkzLCAweDI2LCAweDM2LCAweDNmLCAweGY3LCAweGNjLCAweDM0LCAweGE1LCAweGU1LCAweGYxLCAweDcxLCAweGQ4LCAweDMxLCAweDE1LCAweDA0LCAweGM3LCAweDIzLCAweGMzLCAweDE4LCAweDk2LCAweDA1LCAweDlhLCAweDA3LCAweDEyLCAweDgwLCAweGUyLCAweGViLCAweDI3LCAweGIyLCAweDc1LCAweDA5LCAweDgzLCAweDJjLCAweDFhLCAweDFiLCAweDZlLCAweDVhLCAweGEwLCAweDUyLCAweDNiLCAweGQ2LCAweGIzLCAweDI5LCAweGUzLCAweDJmLCAweDg0LCAweDUzLCAweGQxLCAweDAwLCAweGVkLCAweDIwLCAweGZjLCAweGIxLCAweDViLCAweDZhLCAweGNiLCAweGJlLCAweDM5LCAweDRhLCAweDRjLCAweDU4LCAweGNmLCAweGQwLCAweGVmLCAweGFhLCAweGZiLCAweDQzLCAweDRkLCAweDMzLCAweDg1LCAweDQ1LCAweGY5LCAweDAyLCAweDdmLCAweDUwLCAweDNjLCAweDlmLCAweGE4LCAweDUxLCAweGEzLCAweDQwLCAweDhmLCAweDkyLCAweDlkLCAweDM4LCAweGY1LCAweGJjLCAweGI2LCAweGRhLCAweDIxLCAweDEwLCAweGZmLCAweGYzLCAweGQyLCAweGNkLCAweDBjLCAweDEzLCAweGVjLCAweDVmLCAweDk3LCAweDQ0LCAweDE3LCAweGM0LCAweGE3LCAweDdlLCAweDNkLCAweDY0LCAweDVkLCAweDE5LCAweDczLCAweDYwLCAweDgxLCAweDRmLCAweGRjLCAweDIyLCAweDJhLCAweDkwLCAweDg4LCAweDQ2LCAweGVlLCAweGI4LCAweDE0LCAweGRlLCAweDVlLCAweDBiLCAweGRiLCAweGUwLCAweDMyLCAweDNhLCAweDBhLCAweDQ5LCAweDA2LCAweDI0LCAweDVjLCAweGMyLCAweGQzLCAweGFjLCAweDYyLCAweDkxLCAweDk1LCAweGU0LCAweDc5LCAweGU3LCAweGM4LCAweDM3LCAweDZkLCAweDhkLCAweGQ1LCAweDRlLCAweGE5LCAweDZjLCAweDU2LCAweGY0LCAweGVhLCAweDY1LCAweDdhLCAweGFlLCAweDA4LCAweGJhLCAweDc4LCAweDI1LCAweDJlLCAweDFjLCAweGE2LCAweGI0LCAweGM2LCAweGU4LCAweGRkLCAweDc0LCAweDFmLCAweDRiLCAweGJkLCAweDhiLCAweDhhLCAweDcwLCAweDNlLCAweGI1LCAweDY2LCAweDQ4LCAweDAzLCAweGY2LCAweDBlLCAweDYxLCAweDM1LCAweDU3LCAweGI5LCAweDg2LCAweGMxLCAweDFkLCAweDllLCAweGUxLCAweGY4LCAweDk4LCAweDExLCAweDY5LCAweGQ5LCAweDhlLCAweDk0LCAweDliLCAweDFlLCAweDg3LCAweGU5LCAweGNlLCAweDU1LCAweDI4LCAweGRmLCAweDhjLCAweGExLCAweDg5LCAweDBkLCAweGJmLCAweGU2LCAweDQyLCAweDY4LCAweDQxLCAweDk5LCAweDJkLCAweDBmLCAweGIwLCAweDU0LCAweGJiLCAweDE2XSk7CiAgICB0aGlzLl9pbnZfcyA9IG5ldyBVaW50OEFycmF5KFsweDUyLCAweDA5LCAweDZhLCAweGQ1LCAweDMwLCAweDM2LCAweGE1LCAweDM4LCAweGJmLCAweDQwLCAweGEzLCAweDllLCAweDgxLCAweGYzLCAweGQ3LCAweGZiLCAweDdjLCAweGUzLCAweDM5LCAweDgyLCAweDliLCAweDJmLCAweGZmLCAweDg3LCAweDM0LCAweDhlLCAweDQzLCAweDQ0LCAweGM0LCAweGRlLCAweGU5LCAweGNiLCAweDU0LCAweDdiLCAweDk0LCAweDMyLCAweGE2LCAweGMyLCAweDIzLCAweDNkLCAweGVlLCAweDRjLCAweDk1LCAweDBiLCAweDQyLCAweGZhLCAweGMzLCAweDRlLCAweDA4LCAweDJlLCAweGExLCAweDY2LCAweDI4LCAweGQ5LCAweDI0LCAweGIyLCAweDc2LCAweDViLCAweGEyLCAweDQ5LCAweDZkLCAweDhiLCAweGQxLCAweDI1LCAweDcyLCAweGY4LCAweGY2LCAweDY0LCAweDg2LCAweDY4LCAweDk4LCAweDE2LCAweGQ0LCAweGE0LCAweDVjLCAweGNjLCAweDVkLCAweDY1LCAweGI2LCAweDkyLCAweDZjLCAweDcwLCAweDQ4LCAweDUwLCAweGZkLCAweGVkLCAweGI5LCAweGRhLCAweDVlLCAweDE1LCAweDQ2LCAweDU3LCAweGE3LCAweDhkLCAweDlkLCAweDg0LCAweDkwLCAweGQ4LCAweGFiLCAweDAwLCAweDhjLCAweGJjLCAweGQzLCAweDBhLCAweGY3LCAweGU0LCAweDU4LCAweDA1LCAweGI4LCAweGIzLCAweDQ1LCAweDA2LCAweGQwLCAweDJjLCAweDFlLCAweDhmLCAweGNhLCAweDNmLCAweDBmLCAweDAyLCAweGMxLCAweGFmLCAweGJkLCAweDAzLCAweDAxLCAweDEzLCAweDhhLCAweDZiLCAweDNhLCAweDkxLCAweDExLCAweDQxLCAweDRmLCAweDY3LCAweGRjLCAweGVhLCAweDk3LCAweGYyLCAweGNmLCAweGNlLCAweGYwLCAweGI0LCAweGU2LCAweDczLCAweDk2LCAweGFjLCAweDc0LCAweDIyLCAweGU3LCAweGFkLCAweDM1LCAweDg1LCAweGUyLCAweGY5LCAweDM3LCAweGU4LCAweDFjLCAweDc1LCAweGRmLCAweDZlLCAweDQ3LCAweGYxLCAweDFhLCAweDcxLCAweDFkLCAweDI5LCAweGM1LCAweDg5LCAweDZmLCAweGI3LCAweDYyLCAweDBlLCAweGFhLCAweDE4LCAweGJlLCAweDFiLCAweGZjLCAweDU2LCAweDNlLCAweDRiLCAweGM2LCAweGQyLCAweDc5LCAweDIwLCAweDlhLCAweGRiLCAweGMwLCAweGZlLCAweDc4LCAweGNkLCAweDVhLCAweGY0LCAweDFmLCAweGRkLCAweGE4LCAweDMzLCAweDg4LCAweDA3LCAweGM3LCAweDMxLCAweGIxLCAweDEyLCAweDEwLCAweDU5LCAweDI3LCAweDgwLCAweGVjLCAweDVmLCAweDYwLCAweDUxLCAweDdmLCAweGE5LCAweDE5LCAweGI1LCAweDRhLCAweDBkLCAweDJkLCAweGU1LCAweDdhLCAweDlmLCAweDkzLCAweGM5LCAweDljLCAweGVmLCAweGEwLCAweGUwLCAweDNiLCAweDRkLCAweGFlLCAweDJhLCAweGY1LCAweGIwLCAweGM4LCAweGViLCAweGJiLCAweDNjLCAweDgzLCAweDUzLCAweDk5LCAweDYxLCAweDE3LCAweDJiLCAweDA0LCAweDdlLCAweGJhLCAweDc3LCAweGQ2LCAweDI2LCAweGUxLCAweDY5LCAweDE0LCAweDYzLCAweDU1LCAweDIxLCAweDBjLCAweDdkXSk7CiAgICB0aGlzLl9taXggPSBuZXcgVWludDMyQXJyYXkoWzB4MDAwMDAwMDAsIDB4MGUwOTBkMGIsIDB4MWMxMjFhMTYsIDB4MTIxYjE3MWQsIDB4MzgyNDM0MmMsIDB4MzYyZDM5MjcsIDB4MjQzNjJlM2EsIDB4MmEzZjIzMzEsIDB4NzA0ODY4NTgsIDB4N2U0MTY1NTMsIDB4NmM1YTcyNGUsIDB4NjI1MzdmNDUsIDB4NDg2YzVjNzQsIDB4NDY2NTUxN2YsIDB4NTQ3ZTQ2NjIsIDB4NWE3NzRiNjksIDB4ZTA5MGQwYjAsIDB4ZWU5OWRkYmIsIDB4ZmM4MmNhYTYsIDB4ZjI4YmM3YWQsIDB4ZDhiNGU0OWMsIDB4ZDZiZGU5OTcsIDB4YzRhNmZlOGEsIDB4Y2FhZmYzODEsIDB4OTBkOGI4ZTgsIDB4OWVkMWI1ZTMsIDB4OGNjYWEyZmUsIDB4ODJjM2FmZjUsIDB4YThmYzhjYzQsIDB4YTZmNTgxY2YsIDB4YjRlZTk2ZDIsIDB4YmFlNzliZDksIDB4ZGIzYmJiN2IsIDB4ZDUzMmI2NzAsIDB4YzcyOWExNmQsIDB4YzkyMGFjNjYsIDB4ZTMxZjhmNTcsIDB4ZWQxNjgyNWMsIDB4ZmYwZDk1NDEsIDB4ZjEwNDk4NGEsIDB4YWI3M2QzMjMsIDB4YTU3YWRlMjgsIDB4Yjc2MWM5MzUsIDB4Yjk2OGM0M2UsIDB4OTM1N2U3MGYsIDB4OWQ1ZWVhMDQsIDB4OGY0NWZkMTksIDB4ODE0Y2YwMTIsIDB4M2JhYjZiY2IsIDB4MzVhMjY2YzAsIDB4MjdiOTcxZGQsIDB4MjliMDdjZDYsIDB4MDM4ZjVmZTcsIDB4MGQ4NjUyZWMsIDB4MWY5ZDQ1ZjEsIDB4MTE5NDQ4ZmEsIDB4NGJlMzAzOTMsIDB4NDVlYTBlOTgsIDB4NTdmMTE5ODUsIDB4NTlmODE0OGUsIDB4NzNjNzM3YmYsIDB4N2RjZTNhYjQsIDB4NmZkNTJkYTksIDB4NjFkYzIwYTIsIDB4YWQ3NjZkZjYsIDB4YTM3ZjYwZmQsIDB4YjE2NDc3ZTAsIDB4YmY2ZDdhZWIsIDB4OTU1MjU5ZGEsIDB4OWI1YjU0ZDEsIDB4ODk0MDQzY2MsIDB4ODc0OTRlYzcsIDB4ZGQzZTA1YWUsIDB4ZDMzNzA4YTUsIDB4YzEyYzFmYjgsIDB4Y2YyNTEyYjMsIDB4ZTUxYTMxODIsIDB4ZWIxMzNjODksIDB4ZjkwODJiOTQsIDB4ZjcwMTI2OWYsIDB4NGRlNmJkNDYsIDB4NDNlZmIwNGQsIDB4NTFmNGE3NTAsIDB4NWZmZGFhNWIsIDB4NzVjMjg5NmEsIDB4N2JjYjg0NjEsIDB4NjlkMDkzN2MsIDB4NjdkOTllNzcsIDB4M2RhZWQ1MWUsIDB4MzNhN2Q4MTUsIDB4MjFiY2NmMDgsIDB4MmZiNWMyMDMsIDB4MDU4YWUxMzIsIDB4MGI4M2VjMzksIDB4MTk5OGZiMjQsIDB4MTc5MWY2MmYsIDB4NzY0ZGQ2OGQsIDB4Nzg0NGRiODYsIDB4NmE1ZmNjOWIsIDB4NjQ1NmMxOTAsIDB4NGU2OWUyYTEsIDB4NDA2MGVmYWEsIDB4NTI3YmY4YjcsIDB4NWM3MmY1YmMsIDB4MDYwNWJlZDUsIDB4MDgwY2IzZGUsIDB4MWExN2E0YzMsIDB4MTQxZWE5YzgsIDB4M2UyMThhZjksIDB4MzAyODg3ZjIsIDB4MjIzMzkwZWYsIDB4MmMzYTlkZTQsIDB4OTZkZDA2M2QsIDB4OThkNDBiMzYsIDB4OGFjZjFjMmIsIDB4ODRjNjExMjAsIDB4YWVmOTMyMTEsIDB4YTBmMDNmMWEsIDB4YjJlYjI4MDcsIDB4YmNlMjI1MGMsIDB4ZTY5NTZlNjUsIDB4ZTg5YzYzNmUsIDB4ZmE4Nzc0NzMsIDB4ZjQ4ZTc5NzgsIDB4ZGViMTVhNDksIDB4ZDBiODU3NDIsIDB4YzJhMzQwNWYsIDB4Y2NhYTRkNTQsIDB4NDFlY2RhZjcsIDB4NGZlNWQ3ZmMsIDB4NWRmZWMwZTEsIDB4NTNmN2NkZWEsIDB4NzljOGVlZGIsIDB4NzdjMWUzZDAsIDB4NjVkYWY0Y2QsIDB4NmJkM2Y5YzYsIDB4MzFhNGIyYWYsIDB4M2ZhZGJmYTQsIDB4MmRiNmE4YjksIDB4MjNiZmE1YjIsIDB4MDk4MDg2ODMsIDB4MDc4OThiODgsIDB4MTU5MjljOTUsIDB4MWI5YjkxOWUsIDB4YTE3YzBhNDcsIDB4YWY3NTA3NGMsIDB4YmQ2ZTEwNTEsIDB4YjM2NzFkNWEsIDB4OTk1ODNlNmIsIDB4OTc1MTMzNjAsIDB4ODU0YTI0N2QsIDB4OGI0MzI5NzYsIDB4ZDEzNDYyMWYsIDB4ZGYzZDZmMTQsIDB4Y2QyNjc4MDksIDB4YzMyZjc1MDIsIDB4ZTkxMDU2MzMsIDB4ZTcxOTViMzgsIDB4ZjUwMjRjMjUsIDB4ZmIwYjQxMmUsIDB4OWFkNzYxOGMsIDB4OTRkZTZjODcsIDB4ODZjNTdiOWEsIDB4ODhjYzc2OTEsIDB4YTJmMzU1YTAsIDB4YWNmYTU4YWIsIDB4YmVlMTRmYjYsIDB4YjBlODQyYmQsIDB4ZWE5ZjA5ZDQsIDB4ZTQ5NjA0ZGYsIDB4ZjY4ZDEzYzIsIDB4Zjg4NDFlYzksIDB4ZDJiYjNkZjgsIDB4ZGNiMjMwZjMsIDB4Y2VhOTI3ZWUsIDB4YzBhMDJhZTUsIDB4N2E0N2IxM2MsIDB4NzQ0ZWJjMzcsIDB4NjY1NWFiMmEsIDB4Njg1Y2E2MjEsIDB4NDI2Mzg1MTAsIDB4NGM2YTg4MWIsIDB4NWU3MTlmMDYsIDB4NTA3ODkyMGQsIDB4MGEwZmQ5NjQsIDB4MDQwNmQ0NmYsIDB4MTYxZGMzNzIsIDB4MTgxNGNlNzksIDB4MzIyYmVkNDgsIDB4M2MyMmUwNDMsIDB4MmUzOWY3NWUsIDB4MjAzMGZhNTUsIDB4ZWM5YWI3MDEsIDB4ZTI5M2JhMGEsIDB4ZjA4OGFkMTcsIDB4ZmU4MWEwMWMsIDB4ZDRiZTgzMmQsIDB4ZGFiNzhlMjYsIDB4YzhhYzk5M2IsIDB4YzZhNTk0MzAsIDB4OWNkMmRmNTksIDB4OTJkYmQyNTIsIDB4ODBjMGM1NGYsIDB4OGVjOWM4NDQsIDB4YTRmNmViNzUsIDB4YWFmZmU2N2UsIDB4YjhlNGYxNjMsIDB4YjZlZGZjNjgsIDB4MGMwYTY3YjEsIDB4MDIwMzZhYmEsIDB4MTAxODdkYTcsIDB4MWUxMTcwYWMsIDB4MzQyZTUzOWQsIDB4M2EyNzVlOTYsIDB4MjgzYzQ5OGIsIDB4MjYzNTQ0ODAsIDB4N2M0MjBmZTksIDB4NzI0YjAyZTIsIDB4NjA1MDE1ZmYsIDB4NmU1OTE4ZjQsIDB4NDQ2NjNiYzUsIDB4NGE2ZjM2Y2UsIDB4NTg3NDIxZDMsIDB4NTY3ZDJjZDgsIDB4MzdhMTBjN2EsIDB4MzlhODAxNzEsIDB4MmJiMzE2NmMsIDB4MjViYTFiNjcsIDB4MGY4NTM4NTYsIDB4MDE4YzM1NWQsIDB4MTM5NzIyNDAsIDB4MWQ5ZTJmNGIsIDB4NDdlOTY0MjIsIDB4NDllMDY5MjksIDB4NWJmYjdlMzQsIDB4NTVmMjczM2YsIDB4N2ZjZDUwMGUsIDB4NzFjNDVkMDUsIDB4NjNkZjRhMTgsIDB4NmRkNjQ3MTMsIDB4ZDczMWRjY2EsIDB4ZDkzOGQxYzEsIDB4Y2IyM2M2ZGMsIDB4YzUyYWNiZDcsIDB4ZWYxNWU4ZTYsIDB4ZTExY2U1ZWQsIDB4ZjMwN2YyZjAsIDB4ZmQwZWZmZmIsIDB4YTc3OWI0OTIsIDB4YTk3MGI5OTksIDB4YmI2YmFlODQsIDB4YjU2MmEzOGYsIDB4OWY1ZDgwYmUsIDB4OTE1NDhkYjUsIDB4ODM0ZjlhYTgsIDB4OGQ0Njk3YTNdKTsKICAgIHRoaXMuX21peENvbCA9IG5ldyBVaW50OEFycmF5KDI1Nik7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICBpZiAoaSA8IDEyOCkgewogICAgICAgIHRoaXMuX21peENvbFtpXSA9IGkgPDwgMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9taXhDb2xbaV0gPSBpIDw8IDEgXiAweDFiOwogICAgICB9CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICB0aGlzLmJ1ZmZlclBvc2l0aW9uID0gMDsKICB9CgogIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgY2FsbCBgX2V4cGFuZEtleWAgb24gdGhlIGJhc2UgY2xhc3MiKTsKICB9CgogIF9kZWNyeXB0KGlucHV0LCBrZXkpIHsKICAgIGxldCB0LCB1LCB2OwogICAgY29uc3Qgc3RhdGUgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICBzdGF0ZS5zZXQoaW5wdXQpOwoKICAgIGZvciAobGV0IGogPSAwLCBrID0gdGhpcy5fa2V5U2l6ZTsgaiA8IDE2OyArK2osICsraykgewogICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICB9CgogICAgZm9yIChsZXQgaSA9IHRoaXMuX2N5Y2xlc09mUmVwZXRpdGlvbiAtIDE7IGkgPj0gMTsgLS1pKSB7CiAgICAgIHQgPSBzdGF0ZVsxM107CiAgICAgIHN0YXRlWzEzXSA9IHN0YXRlWzldOwogICAgICBzdGF0ZVs5XSA9IHN0YXRlWzVdOwogICAgICBzdGF0ZVs1XSA9IHN0YXRlWzFdOwogICAgICBzdGF0ZVsxXSA9IHQ7CiAgICAgIHQgPSBzdGF0ZVsxNF07CiAgICAgIHUgPSBzdGF0ZVsxMF07CiAgICAgIHN0YXRlWzE0XSA9IHN0YXRlWzZdOwogICAgICBzdGF0ZVsxMF0gPSBzdGF0ZVsyXTsKICAgICAgc3RhdGVbNl0gPSB0OwogICAgICBzdGF0ZVsyXSA9IHU7CiAgICAgIHQgPSBzdGF0ZVsxNV07CiAgICAgIHUgPSBzdGF0ZVsxMV07CiAgICAgIHYgPSBzdGF0ZVs3XTsKICAgICAgc3RhdGVbMTVdID0gc3RhdGVbM107CiAgICAgIHN0YXRlWzExXSA9IHQ7CiAgICAgIHN0YXRlWzddID0gdTsKICAgICAgc3RhdGVbM10gPSB2OwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7CiAgICAgICAgc3RhdGVbal0gPSB0aGlzLl9pbnZfc1tzdGF0ZVtqXV07CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAwLCBrID0gaSAqIDE2OyBqIDwgMTY7ICsraiwgKytrKSB7CiAgICAgICAgc3RhdGVbal0gXj0ga2V5W2tdOwogICAgICB9CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyBqICs9IDQpIHsKICAgICAgICBjb25zdCBzMCA9IHRoaXMuX21peFtzdGF0ZVtqXV07CiAgICAgICAgY29uc3QgczEgPSB0aGlzLl9taXhbc3RhdGVbaiArIDFdXTsKICAgICAgICBjb25zdCBzMiA9IHRoaXMuX21peFtzdGF0ZVtqICsgMl1dOwogICAgICAgIGNvbnN0IHMzID0gdGhpcy5fbWl4W3N0YXRlW2ogKyAzXV07CiAgICAgICAgdCA9IHMwIF4gczEgPj4+IDggXiBzMSA8PCAyNCBeIHMyID4+PiAxNiBeIHMyIDw8IDE2IF4gczMgPj4+IDI0IF4gczMgPDwgODsKICAgICAgICBzdGF0ZVtqXSA9IHQgPj4+IDI0ICYgMHhmZjsKICAgICAgICBzdGF0ZVtqICsgMV0gPSB0ID4+IDE2ICYgMHhmZjsKICAgICAgICBzdGF0ZVtqICsgMl0gPSB0ID4+IDggJiAweGZmOwogICAgICAgIHN0YXRlW2ogKyAzXSA9IHQgJiAweGZmOwogICAgICB9CiAgICB9CgogICAgdCA9IHN0YXRlWzEzXTsKICAgIHN0YXRlWzEzXSA9IHN0YXRlWzldOwogICAgc3RhdGVbOV0gPSBzdGF0ZVs1XTsKICAgIHN0YXRlWzVdID0gc3RhdGVbMV07CiAgICBzdGF0ZVsxXSA9IHQ7CiAgICB0ID0gc3RhdGVbMTRdOwogICAgdSA9IHN0YXRlWzEwXTsKICAgIHN0YXRlWzE0XSA9IHN0YXRlWzZdOwogICAgc3RhdGVbMTBdID0gc3RhdGVbMl07CiAgICBzdGF0ZVs2XSA9IHQ7CiAgICBzdGF0ZVsyXSA9IHU7CiAgICB0ID0gc3RhdGVbMTVdOwogICAgdSA9IHN0YXRlWzExXTsKICAgIHYgPSBzdGF0ZVs3XTsKICAgIHN0YXRlWzE1XSA9IHN0YXRlWzNdOwogICAgc3RhdGVbMTFdID0gdDsKICAgIHN0YXRlWzddID0gdTsKICAgIHN0YXRlWzNdID0gdjsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgc3RhdGVbal0gPSB0aGlzLl9pbnZfc1tzdGF0ZVtqXV07CiAgICAgIHN0YXRlW2pdIF49IGtleVtqXTsKICAgIH0KCiAgICByZXR1cm4gc3RhdGU7CiAgfQoKICBfZW5jcnlwdChpbnB1dCwga2V5KSB7CiAgICBjb25zdCBzID0gdGhpcy5fczsKICAgIGxldCB0LCB1LCB2OwogICAgY29uc3Qgc3RhdGUgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICBzdGF0ZS5zZXQoaW5wdXQpOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICBzdGF0ZVtqXSBePSBrZXlbal07CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLl9jeWNsZXNPZlJlcGV0aXRpb247IGkrKykgewogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICBzdGF0ZVtqXSA9IHNbc3RhdGVbal1dOwogICAgICB9CgogICAgICB2ID0gc3RhdGVbMV07CiAgICAgIHN0YXRlWzFdID0gc3RhdGVbNV07CiAgICAgIHN0YXRlWzVdID0gc3RhdGVbOV07CiAgICAgIHN0YXRlWzldID0gc3RhdGVbMTNdOwogICAgICBzdGF0ZVsxM10gPSB2OwogICAgICB2ID0gc3RhdGVbMl07CiAgICAgIHUgPSBzdGF0ZVs2XTsKICAgICAgc3RhdGVbMl0gPSBzdGF0ZVsxMF07CiAgICAgIHN0YXRlWzZdID0gc3RhdGVbMTRdOwogICAgICBzdGF0ZVsxMF0gPSB2OwogICAgICBzdGF0ZVsxNF0gPSB1OwogICAgICB2ID0gc3RhdGVbM107CiAgICAgIHUgPSBzdGF0ZVs3XTsKICAgICAgdCA9IHN0YXRlWzExXTsKICAgICAgc3RhdGVbM10gPSBzdGF0ZVsxNV07CiAgICAgIHN0YXRlWzddID0gdjsKICAgICAgc3RhdGVbMTFdID0gdTsKICAgICAgc3RhdGVbMTVdID0gdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7IGogKz0gNCkgewogICAgICAgIGNvbnN0IHMwID0gc3RhdGVbaiArIDBdOwogICAgICAgIGNvbnN0IHMxID0gc3RhdGVbaiArIDFdOwogICAgICAgIGNvbnN0IHMyID0gc3RhdGVbaiArIDJdOwogICAgICAgIGNvbnN0IHMzID0gc3RhdGVbaiArIDNdOwogICAgICAgIHQgPSBzMCBeIHMxIF4gczIgXiBzMzsKICAgICAgICBzdGF0ZVtqICsgMF0gXj0gdCBeIHRoaXMuX21peENvbFtzMCBeIHMxXTsKICAgICAgICBzdGF0ZVtqICsgMV0gXj0gdCBeIHRoaXMuX21peENvbFtzMSBeIHMyXTsKICAgICAgICBzdGF0ZVtqICsgMl0gXj0gdCBeIHRoaXMuX21peENvbFtzMiBeIHMzXTsKICAgICAgICBzdGF0ZVtqICsgM10gXj0gdCBeIHRoaXMuX21peENvbFtzMyBeIHMwXTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IDAsIGsgPSBpICogMTY7IGogPCAxNjsgKytqLCArK2spIHsKICAgICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgc3RhdGVbal0gPSBzW3N0YXRlW2pdXTsKICAgIH0KCiAgICB2ID0gc3RhdGVbMV07CiAgICBzdGF0ZVsxXSA9IHN0YXRlWzVdOwogICAgc3RhdGVbNV0gPSBzdGF0ZVs5XTsKICAgIHN0YXRlWzldID0gc3RhdGVbMTNdOwogICAgc3RhdGVbMTNdID0gdjsKICAgIHYgPSBzdGF0ZVsyXTsKICAgIHUgPSBzdGF0ZVs2XTsKICAgIHN0YXRlWzJdID0gc3RhdGVbMTBdOwogICAgc3RhdGVbNl0gPSBzdGF0ZVsxNF07CiAgICBzdGF0ZVsxMF0gPSB2OwogICAgc3RhdGVbMTRdID0gdTsKICAgIHYgPSBzdGF0ZVszXTsKICAgIHUgPSBzdGF0ZVs3XTsKICAgIHQgPSBzdGF0ZVsxMV07CiAgICBzdGF0ZVszXSA9IHN0YXRlWzE1XTsKICAgIHN0YXRlWzddID0gdjsKICAgIHN0YXRlWzExXSA9IHU7CiAgICBzdGF0ZVsxNV0gPSB0OwoKICAgIGZvciAobGV0IGogPSAwLCBrID0gdGhpcy5fa2V5U2l6ZTsgaiA8IDE2OyArK2osICsraykgewogICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICB9CgogICAgcmV0dXJuIHN0YXRlOwogIH0KCiAgX2RlY3J5cHRCbG9jazIoZGF0YSwgZmluYWxpemUpIHsKICAgIGNvbnN0IHNvdXJjZUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgbGV0IGJ1ZmZlciA9IHRoaXMuYnVmZmVyLAogICAgICAgIGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyUG9zaXRpb247CiAgICBjb25zdCByZXN1bHQgPSBbXTsKICAgIGxldCBpdiA9IHRoaXMuaXY7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2VMZW5ndGg7ICsraSkgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoXSA9IGRhdGFbaV07CiAgICAgICsrYnVmZmVyTGVuZ3RoOwoKICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBsYWluID0gdGhpcy5fZGVjcnlwdChidWZmZXIsIHRoaXMuX2tleSk7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICBwbGFpbltqXSBePSBpdltqXTsKICAgICAgfQoKICAgICAgaXYgPSBidWZmZXI7CiAgICAgIHJlc3VsdC5wdXNoKHBsYWluKTsKICAgICAgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICBidWZmZXJMZW5ndGggPSAwOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgICB0aGlzLml2ID0gaXY7CgogICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgfQoKICAgIGxldCBvdXRwdXRMZW5ndGggPSAxNiAqIHJlc3VsdC5sZW5ndGg7CgogICAgaWYgKGZpbmFsaXplKSB7CiAgICAgIGNvbnN0IGxhc3RCbG9jayA9IHJlc3VsdC5hdCgtMSk7CiAgICAgIGxldCBwc0xlbiA9IGxhc3RCbG9ja1sxNV07CgogICAgICBpZiAocHNMZW4gPD0gMTYpIHsKICAgICAgICBmb3IgKGxldCBpID0gMTUsIGlpID0gMTYgLSBwc0xlbjsgaSA+PSBpaTsgLS1pKSB7CiAgICAgICAgICBpZiAobGFzdEJsb2NrW2ldICE9PSBwc0xlbikgewogICAgICAgICAgICBwc0xlbiA9IDA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3V0cHV0TGVuZ3RoIC09IHBzTGVuOwogICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0gPSBsYXN0QmxvY2suc3ViYXJyYXkoMCwgMTYgLSBwc0xlbik7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBvdXRwdXQgPSBuZXcgVWludDhBcnJheShvdXRwdXRMZW5ndGgpOwoKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMCwgaWkgPSByZXN1bHQubGVuZ3RoOyBpIDwgaWk7ICsraSwgaiArPSAxNikgewogICAgICBvdXRwdXQuc2V0KHJlc3VsdFtpXSwgaik7CiAgICB9CgogICAgcmV0dXJuIG91dHB1dDsKICB9CgogIGRlY3J5cHRCbG9jayhkYXRhLCBmaW5hbGl6ZSwgaXYgPSBudWxsKSB7CiAgICBjb25zdCBzb3VyY2VMZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuYnVmZmVyOwogICAgbGV0IGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyUG9zaXRpb247CgogICAgaWYgKGl2KSB7CiAgICAgIHRoaXMuaXYgPSBpdjsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBidWZmZXJMZW5ndGggPCAxNiAmJiBpIDwgc291cmNlTGVuZ3RoOyArK2ksICsrYnVmZmVyTGVuZ3RoKSB7CiAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aF0gPSBkYXRhW2ldOwogICAgICB9CgogICAgICBpZiAoYnVmZmVyTGVuZ3RoIDwgMTYpIHsKICAgICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7CiAgICAgIH0KCiAgICAgIHRoaXMuaXYgPSBidWZmZXI7CiAgICAgIGRhdGEgPSBkYXRhLnN1YmFycmF5KDE2KTsKICAgIH0KCiAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gMDsKICAgIHRoaXMuZGVjcnlwdEJsb2NrID0gdGhpcy5fZGVjcnlwdEJsb2NrMjsKICAgIHJldHVybiB0aGlzLmRlY3J5cHRCbG9jayhkYXRhLCBmaW5hbGl6ZSk7CiAgfQoKICBlbmNyeXB0KGRhdGEsIGl2KSB7CiAgICBjb25zdCBzb3VyY2VMZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgIGxldCBidWZmZXIgPSB0aGlzLmJ1ZmZlciwKICAgICAgICBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlclBvc2l0aW9uOwogICAgY29uc3QgcmVzdWx0ID0gW107CgogICAgaWYgKCFpdikgewogICAgICBpdiA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgIH0KCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZUxlbmd0aDsgKytpKSB7CiAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGhdID0gZGF0YVtpXTsKICAgICAgKytidWZmZXJMZW5ndGg7CgogICAgICBpZiAoYnVmZmVyTGVuZ3RoIDwgMTYpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7CiAgICAgICAgYnVmZmVyW2pdIF49IGl2W2pdOwogICAgICB9CgogICAgICBjb25zdCBjaXBoZXIgPSB0aGlzLl9lbmNyeXB0KGJ1ZmZlciwgdGhpcy5fa2V5KTsKCiAgICAgIGl2ID0gY2lwaGVyOwogICAgICByZXN1bHQucHVzaChjaXBoZXIpOwogICAgICBidWZmZXIgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICAgIGJ1ZmZlckxlbmd0aCA9IDA7CiAgICB9CgogICAgdGhpcy5idWZmZXIgPSBidWZmZXI7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICAgIHRoaXMuaXYgPSBpdjsKCiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7CiAgICB9CgogICAgY29uc3Qgb3V0cHV0TGVuZ3RoID0gMTYgKiByZXN1bHQubGVuZ3RoOwogICAgY29uc3Qgb3V0cHV0ID0gbmV3IFVpbnQ4QXJyYXkob3V0cHV0TGVuZ3RoKTsKCiAgICBmb3IgKGxldCBpID0gMCwgaiA9IDAsIGlpID0gcmVzdWx0Lmxlbmd0aDsgaSA8IGlpOyArK2ksIGogKz0gMTYpIHsKICAgICAgb3V0cHV0LnNldChyZXN1bHRbaV0sIGopOwogICAgfQoKICAgIHJldHVybiBvdXRwdXQ7CiAgfQoKfQoKY2xhc3MgQUVTMTI4Q2lwaGVyIGV4dGVuZHMgQUVTQmFzZUNpcGhlciB7CiAgY29uc3RydWN0b3Ioa2V5KSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5fY3ljbGVzT2ZSZXBldGl0aW9uID0gMTA7CiAgICB0aGlzLl9rZXlTaXplID0gMTYwOwogICAgdGhpcy5fcmNvbiA9IG5ldyBVaW50OEFycmF5KFsweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkXSk7CiAgICB0aGlzLl9rZXkgPSB0aGlzLl9leHBhbmRLZXkoa2V5KTsKICB9CgogIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICBjb25zdCBiID0gMTc2OwogICAgY29uc3QgcyA9IHRoaXMuX3M7CiAgICBjb25zdCByY29uID0gdGhpcy5fcmNvbjsKICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGIpOwogICAgcmVzdWx0LnNldChjaXBoZXJLZXkpOwoKICAgIGZvciAobGV0IGogPSAxNiwgaSA9IDE7IGogPCBiOyArK2kpIHsKICAgICAgbGV0IHQxID0gcmVzdWx0W2ogLSAzXTsKICAgICAgbGV0IHQyID0gcmVzdWx0W2ogLSAyXTsKICAgICAgbGV0IHQzID0gcmVzdWx0W2ogLSAxXTsKICAgICAgbGV0IHQ0ID0gcmVzdWx0W2ogLSA0XTsKICAgICAgdDEgPSBzW3QxXTsKICAgICAgdDIgPSBzW3QyXTsKICAgICAgdDMgPSBzW3QzXTsKICAgICAgdDQgPSBzW3Q0XTsKICAgICAgdDEgXj0gcmNvbltpXTsKCiAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgNDsgKytuKSB7CiAgICAgICAgcmVzdWx0W2pdID0gdDEgXj0gcmVzdWx0W2ogLSAxNl07CiAgICAgICAgaisrOwogICAgICAgIHJlc3VsdFtqXSA9IHQyIF49IHJlc3VsdFtqIC0gMTZdOwogICAgICAgIGorKzsKICAgICAgICByZXN1bHRbal0gPSB0MyBePSByZXN1bHRbaiAtIDE2XTsKICAgICAgICBqKys7CiAgICAgICAgcmVzdWx0W2pdID0gdDQgXj0gcmVzdWx0W2ogLSAxNl07CiAgICAgICAgaisrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9Cgp9CgpleHBvcnRzLkFFUzEyOENpcGhlciA9IEFFUzEyOENpcGhlcjsKCmNsYXNzIEFFUzI1NkNpcGhlciBleHRlbmRzIEFFU0Jhc2VDaXBoZXIgewogIGNvbnN0cnVjdG9yKGtleSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX2N5Y2xlc09mUmVwZXRpdGlvbiA9IDE0OwogICAgdGhpcy5fa2V5U2l6ZSA9IDIyNDsKICAgIHRoaXMuX2tleSA9IHRoaXMuX2V4cGFuZEtleShrZXkpOwogIH0KCiAgX2V4cGFuZEtleShjaXBoZXJLZXkpIHsKICAgIGNvbnN0IGIgPSAyNDA7CiAgICBjb25zdCBzID0gdGhpcy5fczsKICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGIpOwogICAgcmVzdWx0LnNldChjaXBoZXJLZXkpOwogICAgbGV0IHIgPSAxOwogICAgbGV0IHQxLCB0MiwgdDMsIHQ0OwoKICAgIGZvciAobGV0IGogPSAzMiwgaSA9IDE7IGogPCBiOyArK2kpIHsKICAgICAgaWYgKGogJSAzMiA9PT0gMTYpIHsKICAgICAgICB0MSA9IHNbdDFdOwogICAgICAgIHQyID0gc1t0Ml07CiAgICAgICAgdDMgPSBzW3QzXTsKICAgICAgICB0NCA9IHNbdDRdOwogICAgICB9IGVsc2UgaWYgKGogJSAzMiA9PT0gMCkgewogICAgICAgIHQxID0gcmVzdWx0W2ogLSAzXTsKICAgICAgICB0MiA9IHJlc3VsdFtqIC0gMl07CiAgICAgICAgdDMgPSByZXN1bHRbaiAtIDFdOwogICAgICAgIHQ0ID0gcmVzdWx0W2ogLSA0XTsKICAgICAgICB0MSA9IHNbdDFdOwogICAgICAgIHQyID0gc1t0Ml07CiAgICAgICAgdDMgPSBzW3QzXTsKICAgICAgICB0NCA9IHNbdDRdOwogICAgICAgIHQxIF49IHI7CgogICAgICAgIGlmICgociA8PD0gMSkgPj0gMjU2KSB7CiAgICAgICAgICByID0gKHIgXiAweDFiKSAmIDB4ZmY7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDQ7ICsrbikgewogICAgICAgIHJlc3VsdFtqXSA9IHQxIF49IHJlc3VsdFtqIC0gMzJdOwogICAgICAgIGorKzsKICAgICAgICByZXN1bHRbal0gPSB0MiBePSByZXN1bHRbaiAtIDMyXTsKICAgICAgICBqKys7CiAgICAgICAgcmVzdWx0W2pdID0gdDMgXj0gcmVzdWx0W2ogLSAzMl07CiAgICAgICAgaisrOwogICAgICAgIHJlc3VsdFtqXSA9IHQ0IF49IHJlc3VsdFtqIC0gMzJdOwogICAgICAgIGorKzsKICAgICAgfQogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfQoKfQoKZXhwb3J0cy5BRVMyNTZDaXBoZXIgPSBBRVMyNTZDaXBoZXI7CgpjbGFzcyBQREYxNyB7CiAgY2hlY2tPd25lclBhc3N3b3JkKHBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCB1c2VyQnl0ZXMsIG93bmVyUGFzc3dvcmQpIHsKICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgNTYpOwogICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgIGhhc2hEYXRhLnNldChvd25lclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgaGFzaERhdGEuc2V0KHVzZXJCeXRlcywgcGFzc3dvcmQubGVuZ3RoICsgb3duZXJWYWxpZGF0aW9uU2FsdC5sZW5ndGgpOwogICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgcmV0dXJuICgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKHJlc3VsdCwgb3duZXJQYXNzd29yZCk7CiAgfQoKICBjaGVja1VzZXJQYXNzd29yZChwYXNzd29yZCwgdXNlclZhbGlkYXRpb25TYWx0LCB1c2VyUGFzc3dvcmQpIHsKICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgOCk7CiAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgaGFzaERhdGEuc2V0KHVzZXJWYWxpZGF0aW9uU2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgIGNvbnN0IHJlc3VsdCA9IGNhbGN1bGF0ZVNIQTI1NihoYXNoRGF0YSwgMCwgaGFzaERhdGEubGVuZ3RoKTsKICAgIHJldHVybiAoMCwgX3V0aWwuaXNBcnJheUVxdWFsKShyZXN1bHQsIHVzZXJQYXNzd29yZCk7CiAgfQoKICBnZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1c2VyQnl0ZXMsIG93bmVyRW5jcnlwdGlvbikgewogICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgaGFzaERhdGEuc2V0KG93bmVyS2V5U2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyS2V5U2FsdC5sZW5ndGgpOwogICAgY29uc3Qga2V5ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgY29uc3QgY2lwaGVyID0gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sob3duZXJFbmNyeXB0aW9uLCBmYWxzZSwgbmV3IFVpbnQ4QXJyYXkoMTYpKTsKICB9CgogIGdldFVzZXJLZXkocGFzc3dvcmQsIHVzZXJLZXlTYWx0LCB1c2VyRW5jcnlwdGlvbikgewogICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA4KTsKICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICBoYXNoRGF0YS5zZXQodXNlcktleVNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICBjb25zdCBrZXkgPSBjYWxjdWxhdGVTSEEyNTYoaGFzaERhdGEsIDAsIGhhc2hEYXRhLmxlbmd0aCk7CiAgICBjb25zdCBjaXBoZXIgPSBuZXcgQUVTMjU2Q2lwaGVyKGtleSk7CiAgICByZXR1cm4gY2lwaGVyLmRlY3J5cHRCbG9jayh1c2VyRW5jcnlwdGlvbiwgZmFsc2UsIG5ldyBVaW50OEFycmF5KDE2KSk7CiAgfQoKfQoKZXhwb3J0cy5QREYxNyA9IFBERjE3OwoKY29uc3QgUERGMjAgPSBmdW5jdGlvbiBQREYyMENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBpbnB1dCwgdXNlckJ5dGVzKSB7CiAgICBsZXQgayA9IGNhbGN1bGF0ZVNIQTI1NihpbnB1dCwgMCwgaW5wdXQubGVuZ3RoKS5zdWJhcnJheSgwLCAzMik7CiAgICBsZXQgZSA9IFswXTsKICAgIGxldCBpID0gMDsKCiAgICB3aGlsZSAoaSA8IDY0IHx8IGUuYXQoLTEpID4gaSAtIDMyKSB7CiAgICAgIGNvbnN0IGNvbWJpbmVkTGVuZ3RoID0gcGFzc3dvcmQubGVuZ3RoICsgay5sZW5ndGggKyB1c2VyQnl0ZXMubGVuZ3RoLAogICAgICAgICAgICBjb21iaW5lZEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoY29tYmluZWRMZW5ndGgpOwogICAgICBsZXQgd3JpdGVPZmZzZXQgPSAwOwogICAgICBjb21iaW5lZEFycmF5LnNldChwYXNzd29yZCwgd3JpdGVPZmZzZXQpOwogICAgICB3cml0ZU9mZnNldCArPSBwYXNzd29yZC5sZW5ndGg7CiAgICAgIGNvbWJpbmVkQXJyYXkuc2V0KGssIHdyaXRlT2Zmc2V0KTsKICAgICAgd3JpdGVPZmZzZXQgKz0gay5sZW5ndGg7CiAgICAgIGNvbWJpbmVkQXJyYXkuc2V0KHVzZXJCeXRlcywgd3JpdGVPZmZzZXQpOwogICAgICBjb25zdCBrMSA9IG5ldyBVaW50OEFycmF5KGNvbWJpbmVkTGVuZ3RoICogNjQpOwoKICAgICAgZm9yIChsZXQgaiA9IDAsIHBvcyA9IDA7IGogPCA2NDsgaisrLCBwb3MgKz0gY29tYmluZWRMZW5ndGgpIHsKICAgICAgICBrMS5zZXQoY29tYmluZWRBcnJheSwgcG9zKTsKICAgICAgfQoKICAgICAgY29uc3QgY2lwaGVyID0gbmV3IEFFUzEyOENpcGhlcihrLnN1YmFycmF5KDAsIDE2KSk7CiAgICAgIGUgPSBjaXBoZXIuZW5jcnlwdChrMSwgay5zdWJhcnJheSgxNiwgMzIpKTsKICAgICAgbGV0IHJlbWFpbmRlciA9IDA7CgogICAgICBmb3IgKGxldCB6ID0gMDsgeiA8IDE2OyB6KyspIHsKICAgICAgICByZW1haW5kZXIgKj0gMjU2ICUgMzsKICAgICAgICByZW1haW5kZXIgJT0gMzsKICAgICAgICByZW1haW5kZXIgKz0gKGVbel0gPj4+IDApICUgMzsKICAgICAgICByZW1haW5kZXIgJT0gMzsKICAgICAgfQoKICAgICAgaWYgKHJlbWFpbmRlciA9PT0gMCkgewogICAgICAgIGsgPSBjYWxjdWxhdGVTSEEyNTYoZSwgMCwgZS5sZW5ndGgpOwogICAgICB9IGVsc2UgaWYgKHJlbWFpbmRlciA9PT0gMSkgewogICAgICAgIGsgPSBjYWxjdWxhdGVTSEEzODQoZSwgMCwgZS5sZW5ndGgpOwogICAgICB9IGVsc2UgaWYgKHJlbWFpbmRlciA9PT0gMikgewogICAgICAgIGsgPSBjYWxjdWxhdGVTSEE1MTIoZSwgMCwgZS5sZW5ndGgpOwogICAgICB9CgogICAgICBpKys7CiAgICB9CgogICAgcmV0dXJuIGsuc3ViYXJyYXkoMCwgMzIpOwogIH0KCiAgY2xhc3MgUERGMjAgewogICAgaGFzaChwYXNzd29yZCwgY29uY2F0Qnl0ZXMsIHVzZXJCeXRlcykgewogICAgICByZXR1cm4gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBjb25jYXRCeXRlcywgdXNlckJ5dGVzKTsKICAgIH0KCiAgICBjaGVja093bmVyUGFzc3dvcmQocGFzc3dvcmQsIG93bmVyVmFsaWRhdGlvblNhbHQsIHVzZXJCeXRlcywgb3duZXJQYXNzd29yZCkgewogICAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDU2KTsKICAgICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgICAgaGFzaERhdGEuc2V0KG93bmVyVmFsaWRhdGlvblNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyVmFsaWRhdGlvblNhbHQubGVuZ3RoKTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBoYXNoRGF0YSwgdXNlckJ5dGVzKTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKHJlc3VsdCwgb3duZXJQYXNzd29yZCk7CiAgICB9CgogICAgY2hlY2tVc2VyUGFzc3dvcmQocGFzc3dvcmQsIHVzZXJWYWxpZGF0aW9uU2FsdCwgdXNlclBhc3N3b3JkKSB7CiAgICAgIGNvbnN0IGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgOCk7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyVmFsaWRhdGlvblNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaGFzaERhdGEsIFtdKTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKHJlc3VsdCwgdXNlclBhc3N3b3JkKTsKICAgIH0KCiAgICBnZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1c2VyQnl0ZXMsIG93bmVyRW5jcnlwdGlvbikgewogICAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDU2KTsKICAgICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgICAgaGFzaERhdGEuc2V0KG93bmVyS2V5U2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgaGFzaERhdGEuc2V0KHVzZXJCeXRlcywgcGFzc3dvcmQubGVuZ3RoICsgb3duZXJLZXlTYWx0Lmxlbmd0aCk7CiAgICAgIGNvbnN0IGtleSA9IGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaGFzaERhdGEsIHVzZXJCeXRlcyk7CiAgICAgIGNvbnN0IGNpcGhlciA9IG5ldyBBRVMyNTZDaXBoZXIoa2V5KTsKICAgICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sob3duZXJFbmNyeXB0aW9uLCBmYWxzZSwgbmV3IFVpbnQ4QXJyYXkoMTYpKTsKICAgIH0KCiAgICBnZXRVc2VyS2V5KHBhc3N3b3JkLCB1c2VyS2V5U2FsdCwgdXNlckVuY3J5cHRpb24pIHsKICAgICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA4KTsKICAgICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgICAgaGFzaERhdGEuc2V0KHVzZXJLZXlTYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICBjb25zdCBrZXkgPSBjYWxjdWxhdGVQREYyMEhhc2gocGFzc3dvcmQsIGhhc2hEYXRhLCBbXSk7CiAgICAgIGNvbnN0IGNpcGhlciA9IG5ldyBBRVMyNTZDaXBoZXIoa2V5KTsKICAgICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sodXNlckVuY3J5cHRpb24sIGZhbHNlLCBuZXcgVWludDhBcnJheSgxNikpOwogICAgfQoKICB9CgogIHJldHVybiBQREYyMDsKfSgpOwoKZXhwb3J0cy5QREYyMCA9IFBERjIwOwoKY2xhc3MgQ2lwaGVyVHJhbnNmb3JtIHsKICBjb25zdHJ1Y3RvcihzdHJpbmdDaXBoZXJDb25zdHJ1Y3Rvciwgc3RyZWFtQ2lwaGVyQ29uc3RydWN0b3IpIHsKICAgIHRoaXMuU3RyaW5nQ2lwaGVyQ29uc3RydWN0b3IgPSBzdHJpbmdDaXBoZXJDb25zdHJ1Y3RvcjsKICAgIHRoaXMuU3RyZWFtQ2lwaGVyQ29uc3RydWN0b3IgPSBzdHJlYW1DaXBoZXJDb25zdHJ1Y3RvcjsKICB9CgogIGNyZWF0ZVN0cmVhbShzdHJlYW0sIGxlbmd0aCkgewogICAgY29uc3QgY2lwaGVyID0gbmV3IHRoaXMuU3RyZWFtQ2lwaGVyQ29uc3RydWN0b3IoKTsKICAgIHJldHVybiBuZXcgX2RlY3J5cHRfc3RyZWFtLkRlY3J5cHRTdHJlYW0oc3RyZWFtLCBsZW5ndGgsIGZ1bmN0aW9uIGNpcGhlclRyYW5zZm9ybURlY3J5cHRTdHJlYW0oZGF0YSwgZmluYWxpemUpIHsKICAgICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2soZGF0YSwgZmluYWxpemUpOwogICAgfSk7CiAgfQoKICBkZWNyeXB0U3RyaW5nKHMpIHsKICAgIGNvbnN0IGNpcGhlciA9IG5ldyB0aGlzLlN0cmluZ0NpcGhlckNvbnN0cnVjdG9yKCk7CiAgICBsZXQgZGF0YSA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShzKTsKICAgIGRhdGEgPSBjaXBoZXIuZGVjcnlwdEJsb2NrKGRhdGEsIHRydWUpOwogICAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShkYXRhKTsKICB9CgogIGVuY3J5cHRTdHJpbmcocykgewogICAgY29uc3QgY2lwaGVyID0gbmV3IHRoaXMuU3RyaW5nQ2lwaGVyQ29uc3RydWN0b3IoKTsKCiAgICBpZiAoY2lwaGVyIGluc3RhbmNlb2YgQUVTQmFzZUNpcGhlcikgewogICAgICBjb25zdCBzdHJMZW4gPSBzLmxlbmd0aDsKICAgICAgY29uc3QgcGFkID0gMTYgLSBzdHJMZW4gJSAxNjsKICAgICAgcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhZCkucmVwZWF0KHBhZCk7CiAgICAgIGNvbnN0IGl2ID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwoKICAgICAgaWYgKHR5cGVvZiBjcnlwdG8gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhpdik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgICAgICBpdltpXSA9IE1hdGguZmxvb3IoMjU2ICogTWF0aC5yYW5kb20oKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQgZGF0YSA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShzKTsKICAgICAgZGF0YSA9IGNpcGhlci5lbmNyeXB0KGRhdGEsIGl2KTsKICAgICAgY29uc3QgYnVmID0gbmV3IFVpbnQ4QXJyYXkoMTYgKyBkYXRhLmxlbmd0aCk7CiAgICAgIGJ1Zi5zZXQoaXYpOwogICAgICBidWYuc2V0KGRhdGEsIDE2KTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShidWYpOwogICAgfQoKICAgIGxldCBkYXRhID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHMpOwogICAgZGF0YSA9IGNpcGhlci5lbmNyeXB0KGRhdGEpOwogICAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShkYXRhKTsKICB9Cgp9Cgpjb25zdCBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5ID0gZnVuY3Rpb24gQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeUNsb3N1cmUoKSB7CiAgY29uc3QgZGVmYXVsdFBhc3N3b3JkQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMHgyOCwgMHhiZiwgMHg0ZSwgMHg1ZSwgMHg0ZSwgMHg3NSwgMHg4YSwgMHg0MSwgMHg2NCwgMHgwMCwgMHg0ZSwgMHg1NiwgMHhmZiwgMHhmYSwgMHgwMSwgMHgwOCwgMHgyZSwgMHgyZSwgMHgwMCwgMHhiNiwgMHhkMCwgMHg2OCwgMHgzZSwgMHg4MCwgMHgyZiwgMHgwYywgMHhhOSwgMHhmZSwgMHg2NCwgMHg1MywgMHg2OSwgMHg3YV0pOwoKICBmdW5jdGlvbiBjcmVhdGVFbmNyeXB0aW9uS2V5MjAocmV2aXNpb24sIHBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCBvd25lcktleVNhbHQsIHVCeXRlcywgdXNlclBhc3N3b3JkLCB1c2VyVmFsaWRhdGlvblNhbHQsIHVzZXJLZXlTYWx0LCBvd25lckVuY3J5cHRpb24sIHVzZXJFbmNyeXB0aW9uLCBwZXJtcykgewogICAgaWYgKHBhc3N3b3JkKSB7CiAgICAgIGNvbnN0IHBhc3N3b3JkTGVuZ3RoID0gTWF0aC5taW4oMTI3LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICBwYXNzd29yZCA9IHBhc3N3b3JkLnN1YmFycmF5KDAsIHBhc3N3b3JkTGVuZ3RoKTsKICAgIH0gZWxzZSB7CiAgICAgIHBhc3N3b3JkID0gW107CiAgICB9CgogICAgbGV0IHBkZkFsZ29yaXRobTsKCiAgICBpZiAocmV2aXNpb24gPT09IDYpIHsKICAgICAgcGRmQWxnb3JpdGhtID0gbmV3IFBERjIwKCk7CiAgICB9IGVsc2UgewogICAgICBwZGZBbGdvcml0aG0gPSBuZXcgUERGMTcoKTsKICAgIH0KCiAgICBpZiAocGRmQWxnb3JpdGhtLmNoZWNrVXNlclBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyVmFsaWRhdGlvblNhbHQsIHVzZXJQYXNzd29yZCkpIHsKICAgICAgcmV0dXJuIHBkZkFsZ29yaXRobS5nZXRVc2VyS2V5KHBhc3N3b3JkLCB1c2VyS2V5U2FsdCwgdXNlckVuY3J5cHRpb24pOwogICAgfSBlbHNlIGlmIChwYXNzd29yZC5sZW5ndGggJiYgcGRmQWxnb3JpdGhtLmNoZWNrT3duZXJQYXNzd29yZChwYXNzd29yZCwgb3duZXJWYWxpZGF0aW9uU2FsdCwgdUJ5dGVzLCBvd25lclBhc3N3b3JkKSkgewogICAgICByZXR1cm4gcGRmQWxnb3JpdGhtLmdldE93bmVyS2V5KHBhc3N3b3JkLCBvd25lcktleVNhbHQsIHVCeXRlcywgb3duZXJFbmNyeXB0aW9uKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIHByZXBhcmVLZXlEYXRhKGZpbGVJZCwgcGFzc3dvcmQsIG93bmVyUGFzc3dvcmQsIHVzZXJQYXNzd29yZCwgZmxhZ3MsIHJldmlzaW9uLCBrZXlMZW5ndGgsIGVuY3J5cHRNZXRhZGF0YSkgewogICAgY29uc3QgaGFzaERhdGFTaXplID0gNDAgKyBvd25lclBhc3N3b3JkLmxlbmd0aCArIGZpbGVJZC5sZW5ndGg7CiAgICBjb25zdCBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KGhhc2hEYXRhU2l6ZSk7CiAgICBsZXQgaSA9IDAsCiAgICAgICAgaiwKICAgICAgICBuOwoKICAgIGlmIChwYXNzd29yZCkgewogICAgICBuID0gTWF0aC5taW4oMzIsIHBhc3N3b3JkLmxlbmd0aCk7CgogICAgICBmb3IgKDsgaSA8IG47ICsraSkgewogICAgICAgIGhhc2hEYXRhW2ldID0gcGFzc3dvcmRbaV07CiAgICAgIH0KICAgIH0KCiAgICBqID0gMDsKCiAgICB3aGlsZSAoaSA8IDMyKSB7CiAgICAgIGhhc2hEYXRhW2krK10gPSBkZWZhdWx0UGFzc3dvcmRCeXRlc1tqKytdOwogICAgfQoKICAgIGZvciAoaiA9IDAsIG4gPSBvd25lclBhc3N3b3JkLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICBoYXNoRGF0YVtpKytdID0gb3duZXJQYXNzd29yZFtqXTsKICAgIH0KCiAgICBoYXNoRGF0YVtpKytdID0gZmxhZ3MgJiAweGZmOwogICAgaGFzaERhdGFbaSsrXSA9IGZsYWdzID4+IDggJiAweGZmOwogICAgaGFzaERhdGFbaSsrXSA9IGZsYWdzID4+IDE2ICYgMHhmZjsKICAgIGhhc2hEYXRhW2krK10gPSBmbGFncyA+Pj4gMjQgJiAweGZmOwoKICAgIGZvciAoaiA9IDAsIG4gPSBmaWxlSWQubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgIGhhc2hEYXRhW2krK10gPSBmaWxlSWRbal07CiAgICB9CgogICAgaWYgKHJldmlzaW9uID49IDQgJiYgIWVuY3J5cHRNZXRhZGF0YSkgewogICAgICBoYXNoRGF0YVtpKytdID0gMHhmZjsKICAgICAgaGFzaERhdGFbaSsrXSA9IDB4ZmY7CiAgICAgIGhhc2hEYXRhW2krK10gPSAweGZmOwogICAgICBoYXNoRGF0YVtpKytdID0gMHhmZjsKICAgIH0KCiAgICBsZXQgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoRGF0YSwgMCwgaSk7CiAgICBjb25zdCBrZXlMZW5ndGhJbkJ5dGVzID0ga2V5TGVuZ3RoID4+IDM7CgogICAgaWYgKHJldmlzaW9uID49IDMpIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDUwOyArK2opIHsKICAgICAgICBoYXNoID0gY2FsY3VsYXRlTUQ1KGhhc2gsIDAsIGtleUxlbmd0aEluQnl0ZXMpOwogICAgICB9CiAgICB9CgogICAgY29uc3QgZW5jcnlwdGlvbktleSA9IGhhc2guc3ViYXJyYXkoMCwga2V5TGVuZ3RoSW5CeXRlcyk7CiAgICBsZXQgY2lwaGVyLCBjaGVja0RhdGE7CgogICAgaWYgKHJldmlzaW9uID49IDMpIHsKICAgICAgZm9yIChpID0gMDsgaSA8IDMyOyArK2kpIHsKICAgICAgICBoYXNoRGF0YVtpXSA9IGRlZmF1bHRQYXNzd29yZEJ5dGVzW2ldOwogICAgICB9CgogICAgICBmb3IgKGogPSAwLCBuID0gZmlsZUlkLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICAgIGhhc2hEYXRhW2krK10gPSBmaWxlSWRbal07CiAgICAgIH0KCiAgICAgIGNpcGhlciA9IG5ldyBBUkNGb3VyQ2lwaGVyKGVuY3J5cHRpb25LZXkpOwogICAgICBjaGVja0RhdGEgPSBjaXBoZXIuZW5jcnlwdEJsb2NrKGNhbGN1bGF0ZU1ENShoYXNoRGF0YSwgMCwgaSkpOwogICAgICBuID0gZW5jcnlwdGlvbktleS5sZW5ndGg7CiAgICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBuZXcgVWludDhBcnJheShuKTsKCiAgICAgIGZvciAoaiA9IDE7IGogPD0gMTk7ICsraikgewogICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbjsgKytrKSB7CiAgICAgICAgICBkZXJpdmVkS2V5W2tdID0gZW5jcnlwdGlvbktleVtrXSBeIGo7CiAgICAgICAgfQoKICAgICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihkZXJpdmVkS2V5KTsKICAgICAgICBjaGVja0RhdGEgPSBjaXBoZXIuZW5jcnlwdEJsb2NrKGNoZWNrRGF0YSk7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDAsIG4gPSBjaGVja0RhdGEubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgaWYgKHVzZXJQYXNzd29yZFtqXSAhPT0gY2hlY2tEYXRhW2pdKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNpcGhlciA9IG5ldyBBUkNGb3VyQ2lwaGVyKGVuY3J5cHRpb25LZXkpOwogICAgICBjaGVja0RhdGEgPSBjaXBoZXIuZW5jcnlwdEJsb2NrKGRlZmF1bHRQYXNzd29yZEJ5dGVzKTsKCiAgICAgIGZvciAoaiA9IDAsIG4gPSBjaGVja0RhdGEubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgaWYgKHVzZXJQYXNzd29yZFtqXSAhPT0gY2hlY2tEYXRhW2pdKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZW5jcnlwdGlvbktleTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZVVzZXJQYXNzd29yZChwYXNzd29yZCwgb3duZXJQYXNzd29yZCwgcmV2aXNpb24sIGtleUxlbmd0aCkgewogICAgY29uc3QgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheSgzMik7CiAgICBsZXQgaSA9IDA7CiAgICBjb25zdCBuID0gTWF0aC5taW4oMzIsIHBhc3N3b3JkLmxlbmd0aCk7CgogICAgZm9yICg7IGkgPCBuOyArK2kpIHsKICAgICAgaGFzaERhdGFbaV0gPSBwYXNzd29yZFtpXTsKICAgIH0KCiAgICBsZXQgaiA9IDA7CgogICAgd2hpbGUgKGkgPCAzMikgewogICAgICBoYXNoRGF0YVtpKytdID0gZGVmYXVsdFBhc3N3b3JkQnl0ZXNbaisrXTsKICAgIH0KCiAgICBsZXQgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoRGF0YSwgMCwgaSk7CiAgICBjb25zdCBrZXlMZW5ndGhJbkJ5dGVzID0ga2V5TGVuZ3RoID4+IDM7CgogICAgaWYgKHJldmlzaW9uID49IDMpIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDUwOyArK2opIHsKICAgICAgICBoYXNoID0gY2FsY3VsYXRlTUQ1KGhhc2gsIDAsIGhhc2gubGVuZ3RoKTsKICAgICAgfQogICAgfQoKICAgIGxldCBjaXBoZXIsIHVzZXJQYXNzd29yZDsKCiAgICBpZiAocmV2aXNpb24gPj0gMykgewogICAgICB1c2VyUGFzc3dvcmQgPSBvd25lclBhc3N3b3JkOwogICAgICBjb25zdCBkZXJpdmVkS2V5ID0gbmV3IFVpbnQ4QXJyYXkoa2V5TGVuZ3RoSW5CeXRlcyk7CgogICAgICBmb3IgKGogPSAxOTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGtleUxlbmd0aEluQnl0ZXM7ICsraykgewogICAgICAgICAgZGVyaXZlZEtleVtrXSA9IGhhc2hba10gXiBqOwogICAgICAgIH0KCiAgICAgICAgY2lwaGVyID0gbmV3IEFSQ0ZvdXJDaXBoZXIoZGVyaXZlZEtleSk7CiAgICAgICAgdXNlclBhc3N3b3JkID0gY2lwaGVyLmVuY3J5cHRCbG9jayh1c2VyUGFzc3dvcmQpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihoYXNoLnN1YmFycmF5KDAsIGtleUxlbmd0aEluQnl0ZXMpKTsKICAgICAgdXNlclBhc3N3b3JkID0gY2lwaGVyLmVuY3J5cHRCbG9jayhvd25lclBhc3N3b3JkKTsKICAgIH0KCiAgICByZXR1cm4gdXNlclBhc3N3b3JkOwogIH0KCiAgY29uc3QgaWRlbnRpdHlOYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIklkZW50aXR5Iik7CgogIGZ1bmN0aW9uIGJ1aWxkT2JqZWN0S2V5KG51bSwgZ2VuLCBlbmNyeXB0aW9uS2V5LCBpc0FlcyA9IGZhbHNlKSB7CiAgICBjb25zdCBrZXkgPSBuZXcgVWludDhBcnJheShlbmNyeXB0aW9uS2V5Lmxlbmd0aCArIDkpOwogICAgY29uc3QgbiA9IGVuY3J5cHRpb25LZXkubGVuZ3RoOwogICAgbGV0IGk7CgogICAgZm9yIChpID0gMDsgaSA8IG47ICsraSkgewogICAgICBrZXlbaV0gPSBlbmNyeXB0aW9uS2V5W2ldOwogICAgfQoKICAgIGtleVtpKytdID0gbnVtICYgMHhmZjsKICAgIGtleVtpKytdID0gbnVtID4+IDggJiAweGZmOwogICAga2V5W2krK10gPSBudW0gPj4gMTYgJiAweGZmOwogICAga2V5W2krK10gPSBnZW4gJiAweGZmOwogICAga2V5W2krK10gPSBnZW4gPj4gOCAmIDB4ZmY7CgogICAgaWYgKGlzQWVzKSB7CiAgICAgIGtleVtpKytdID0gMHg3MzsKICAgICAga2V5W2krK10gPSAweDQxOwogICAgICBrZXlbaSsrXSA9IDB4NmM7CiAgICAgIGtleVtpKytdID0gMHg1NDsKICAgIH0KCiAgICBjb25zdCBoYXNoID0gY2FsY3VsYXRlTUQ1KGtleSwgMCwgaSk7CiAgICByZXR1cm4gaGFzaC5zdWJhcnJheSgwLCBNYXRoLm1pbihlbmNyeXB0aW9uS2V5Lmxlbmd0aCArIDUsIDE2KSk7CiAgfQoKICBmdW5jdGlvbiBidWlsZENpcGhlckNvbnN0cnVjdG9yKGNmLCBuYW1lLCBudW0sIGdlbiwga2V5KSB7CiAgICBpZiAoIShuYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGNyeXB0IGZpbHRlciBuYW1lLiIpOwogICAgfQoKICAgIGNvbnN0IGNyeXB0RmlsdGVyID0gY2YuZ2V0KG5hbWUubmFtZSk7CiAgICBsZXQgY2ZtOwoKICAgIGlmIChjcnlwdEZpbHRlciAhPT0gbnVsbCAmJiBjcnlwdEZpbHRlciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNmbSA9IGNyeXB0RmlsdGVyLmdldCgiQ0ZNIik7CiAgICB9CgogICAgaWYgKCFjZm0gfHwgY2ZtLm5hbWUgPT09ICJOb25lIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JOb25lKCkgewogICAgICAgIHJldHVybiBuZXcgTnVsbENpcGhlcigpOwogICAgICB9OwogICAgfQoKICAgIGlmIChjZm0ubmFtZSA9PT0gIlYyIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JWMigpIHsKICAgICAgICByZXR1cm4gbmV3IEFSQ0ZvdXJDaXBoZXIoYnVpbGRPYmplY3RLZXkobnVtLCBnZW4sIGtleSwgZmFsc2UpKTsKICAgICAgfTsKICAgIH0KCiAgICBpZiAoY2ZtLm5hbWUgPT09ICJBRVNWMiIpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNpcGhlclRyYW5zZm9ybUZhY3RvcnlCdWlsZENpcGhlckNvbnN0cnVjdG9yQUVTVjIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBRVMxMjhDaXBoZXIoYnVpbGRPYmplY3RLZXkobnVtLCBnZW4sIGtleSwgdHJ1ZSkpOwogICAgICB9OwogICAgfQoKICAgIGlmIChjZm0ubmFtZSA9PT0gIkFFU1YzIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JBRVNWMygpIHsKICAgICAgICByZXR1cm4gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgICB9OwogICAgfQoKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjcnlwdG8gbWV0aG9kIik7CiAgfQoKICBjbGFzcyBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5IHsKICAgIGNvbnN0cnVjdG9yKGRpY3QsIGZpbGVJZCwgcGFzc3dvcmQpIHsKICAgICAgY29uc3QgZmlsdGVyID0gZGljdC5nZXQoIkZpbHRlciIpOwoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShmaWx0ZXIsICJTdGFuZGFyZCIpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bmtub3duIGVuY3J5cHRpb24gbWV0aG9kIik7CiAgICAgIH0KCiAgICAgIHRoaXMuZmlsdGVyTmFtZSA9IGZpbHRlci5uYW1lOwogICAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgICBjb25zdCBhbGdvcml0aG0gPSBkaWN0LmdldCgiViIpOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGFsZ29yaXRobSkgfHwgYWxnb3JpdGhtICE9PSAxICYmIGFsZ29yaXRobSAhPT0gMiAmJiBhbGdvcml0aG0gIT09IDQgJiYgYWxnb3JpdGhtICE9PSA1KSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bnN1cHBvcnRlZCBlbmNyeXB0aW9uIGFsZ29yaXRobSIpOwogICAgICB9CgogICAgICB0aGlzLmFsZ29yaXRobSA9IGFsZ29yaXRobTsKICAgICAgbGV0IGtleUxlbmd0aCA9IGRpY3QuZ2V0KCJMZW5ndGgiKTsKCiAgICAgIGlmICgha2V5TGVuZ3RoKSB7CiAgICAgICAgaWYgKGFsZ29yaXRobSA8PSAzKSB7CiAgICAgICAgICBrZXlMZW5ndGggPSA0MDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgY2ZEaWN0ID0gZGljdC5nZXQoIkNGIik7CiAgICAgICAgICBjb25zdCBzdHJlYW1DcnlwdG9OYW1lID0gZGljdC5nZXQoIlN0bUYiKTsKCiAgICAgICAgICBpZiAoY2ZEaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBzdHJlYW1DcnlwdG9OYW1lIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBjZkRpY3Quc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgaGFuZGxlckRpY3QgPSBjZkRpY3QuZ2V0KHN0cmVhbUNyeXB0b05hbWUubmFtZSk7CiAgICAgICAgICAgIGtleUxlbmd0aCA9IGhhbmRsZXJEaWN0ICYmIGhhbmRsZXJEaWN0LmdldCgiTGVuZ3RoIikgfHwgMTI4OwoKICAgICAgICAgICAgaWYgKGtleUxlbmd0aCA8IDQwKSB7CiAgICAgICAgICAgICAga2V5TGVuZ3RoIDw8PSAzOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoa2V5TGVuZ3RoKSB8fCBrZXlMZW5ndGggPCA0MCB8fCBrZXlMZW5ndGggJSA4ICE9PSAwKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGtleSBsZW5ndGgiKTsKICAgICAgfQoKICAgICAgY29uc3Qgb3duZXJQYXNzd29yZCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiTyIpKS5zdWJhcnJheSgwLCAzMik7CiAgICAgIGNvbnN0IHVzZXJQYXNzd29yZCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiVSIpKS5zdWJhcnJheSgwLCAzMik7CiAgICAgIGNvbnN0IGZsYWdzID0gZGljdC5nZXQoIlAiKTsKICAgICAgY29uc3QgcmV2aXNpb24gPSBkaWN0LmdldCgiUiIpOwogICAgICBjb25zdCBlbmNyeXB0TWV0YWRhdGEgPSAoYWxnb3JpdGhtID09PSA0IHx8IGFsZ29yaXRobSA9PT0gNSkgJiYgZGljdC5nZXQoIkVuY3J5cHRNZXRhZGF0YSIpICE9PSBmYWxzZTsKICAgICAgdGhpcy5lbmNyeXB0TWV0YWRhdGEgPSBlbmNyeXB0TWV0YWRhdGE7CiAgICAgIGNvbnN0IGZpbGVJZEJ5dGVzID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGZpbGVJZCk7CiAgICAgIGxldCBwYXNzd29yZEJ5dGVzOwoKICAgICAgaWYgKHBhc3N3b3JkKSB7CiAgICAgICAgaWYgKHJldmlzaW9uID09PSA2KSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBwYXNzd29yZCA9ICgwLCBfdXRpbC51dGY4U3RyaW5nVG9TdHJpbmcpKHBhc3N3b3JkKTsKICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeTogIiArICJVbmFibGUgdG8gY29udmVydCBVVEY4IGVuY29kZWQgcGFzc3dvcmQuIik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwYXNzd29yZEJ5dGVzID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHBhc3N3b3JkKTsKICAgICAgfQoKICAgICAgbGV0IGVuY3J5cHRpb25LZXk7CgogICAgICBpZiAoYWxnb3JpdGhtICE9PSA1KSB7CiAgICAgICAgZW5jcnlwdGlvbktleSA9IHByZXBhcmVLZXlEYXRhKGZpbGVJZEJ5dGVzLCBwYXNzd29yZEJ5dGVzLCBvd25lclBhc3N3b3JkLCB1c2VyUGFzc3dvcmQsIGZsYWdzLCByZXZpc2lvbiwga2V5TGVuZ3RoLCBlbmNyeXB0TWV0YWRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IG93bmVyVmFsaWRhdGlvblNhbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIk8iKSkuc3ViYXJyYXkoMzIsIDQwKTsKICAgICAgICBjb25zdCBvd25lcktleVNhbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIk8iKSkuc3ViYXJyYXkoNDAsIDQ4KTsKICAgICAgICBjb25zdCB1Qnl0ZXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlUiKSkuc3ViYXJyYXkoMCwgNDgpOwogICAgICAgIGNvbnN0IHVzZXJWYWxpZGF0aW9uU2FsdCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiVSIpKS5zdWJhcnJheSgzMiwgNDApOwogICAgICAgIGNvbnN0IHVzZXJLZXlTYWx0ID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVIikpLnN1YmFycmF5KDQwLCA0OCk7CiAgICAgICAgY29uc3Qgb3duZXJFbmNyeXB0aW9uID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJPRSIpKTsKICAgICAgICBjb25zdCB1c2VyRW5jcnlwdGlvbiA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiVUUiKSk7CiAgICAgICAgY29uc3QgcGVybXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlBlcm1zIikpOwogICAgICAgIGVuY3J5cHRpb25LZXkgPSBjcmVhdGVFbmNyeXB0aW9uS2V5MjAocmV2aXNpb24sIHBhc3N3b3JkQnl0ZXMsIG93bmVyUGFzc3dvcmQsIG93bmVyVmFsaWRhdGlvblNhbHQsIG93bmVyS2V5U2FsdCwgdUJ5dGVzLCB1c2VyUGFzc3dvcmQsIHVzZXJWYWxpZGF0aW9uU2FsdCwgdXNlcktleVNhbHQsIG93bmVyRW5jcnlwdGlvbiwgdXNlckVuY3J5cHRpb24sIHBlcm1zKTsKICAgICAgfQoKICAgICAgaWYgKCFlbmNyeXB0aW9uS2V5ICYmICFwYXNzd29yZCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5QYXNzd29yZEV4Y2VwdGlvbigiTm8gcGFzc3dvcmQgZ2l2ZW4iLCBfdXRpbC5QYXNzd29yZFJlc3BvbnNlcy5ORUVEX1BBU1NXT1JEKTsKICAgICAgfSBlbHNlIGlmICghZW5jcnlwdGlvbktleSAmJiBwYXNzd29yZCkgewogICAgICAgIGNvbnN0IGRlY29kZWRQYXNzd29yZCA9IGRlY29kZVVzZXJQYXNzd29yZChwYXNzd29yZEJ5dGVzLCBvd25lclBhc3N3b3JkLCByZXZpc2lvbiwga2V5TGVuZ3RoKTsKICAgICAgICBlbmNyeXB0aW9uS2V5ID0gcHJlcGFyZUtleURhdGEoZmlsZUlkQnl0ZXMsIGRlY29kZWRQYXNzd29yZCwgb3duZXJQYXNzd29yZCwgdXNlclBhc3N3b3JkLCBmbGFncywgcmV2aXNpb24sIGtleUxlbmd0aCwgZW5jcnlwdE1ldGFkYXRhKTsKICAgICAgfQoKICAgICAgaWYgKCFlbmNyeXB0aW9uS2V5KSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLlBhc3N3b3JkRXhjZXB0aW9uKCJJbmNvcnJlY3QgUGFzc3dvcmQiLCBfdXRpbC5QYXNzd29yZFJlc3BvbnNlcy5JTkNPUlJFQ1RfUEFTU1dPUkQpOwogICAgICB9CgogICAgICB0aGlzLmVuY3J5cHRpb25LZXkgPSBlbmNyeXB0aW9uS2V5OwoKICAgICAgaWYgKGFsZ29yaXRobSA+PSA0KSB7CiAgICAgICAgY29uc3QgY2YgPSBkaWN0LmdldCgiQ0YiKTsKCiAgICAgICAgaWYgKGNmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgY2Yuc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY2YgPSBjZjsKICAgICAgICB0aGlzLnN0bWYgPSBkaWN0LmdldCgiU3RtRiIpIHx8IGlkZW50aXR5TmFtZTsKICAgICAgICB0aGlzLnN0cmYgPSBkaWN0LmdldCgiU3RyRiIpIHx8IGlkZW50aXR5TmFtZTsKICAgICAgICB0aGlzLmVmZiA9IGRpY3QuZ2V0KCJFRkYiKSB8fCB0aGlzLnN0bWY7CiAgICAgIH0KICAgIH0KCiAgICBjcmVhdGVDaXBoZXJUcmFuc2Zvcm0obnVtLCBnZW4pIHsKICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtID09PSA0IHx8IHRoaXMuYWxnb3JpdGhtID09PSA1KSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaXBoZXJUcmFuc2Zvcm0oYnVpbGRDaXBoZXJDb25zdHJ1Y3Rvcih0aGlzLmNmLCB0aGlzLnN0cmYsIG51bSwgZ2VuLCB0aGlzLmVuY3J5cHRpb25LZXkpLCBidWlsZENpcGhlckNvbnN0cnVjdG9yKHRoaXMuY2YsIHRoaXMuc3RtZiwgbnVtLCBnZW4sIHRoaXMuZW5jcnlwdGlvbktleSkpOwogICAgICB9CgogICAgICBjb25zdCBrZXkgPSBidWlsZE9iamVjdEtleShudW0sIGdlbiwgdGhpcy5lbmNyeXB0aW9uS2V5LCBmYWxzZSk7CgogICAgICBjb25zdCBjaXBoZXJDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIGJ1aWxkQ2lwaGVyQ2lwaGVyQ29uc3RydWN0b3IoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBUkNGb3VyQ2lwaGVyKGtleSk7CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IENpcGhlclRyYW5zZm9ybShjaXBoZXJDb25zdHJ1Y3RvciwgY2lwaGVyQ29uc3RydWN0b3IpOwogICAgfQoKICB9CgogIHJldHVybiBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5Owp9KCk7CgpleHBvcnRzLkNpcGhlclRyYW5zZm9ybUZhY3RvcnkgPSBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRGVjcnlwdFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfZGVjb2RlX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwoKY29uc3QgY2h1bmtTaXplID0gNTEyOwoKY2xhc3MgRGVjcnlwdFN0cmVhbSBleHRlbmRzIF9kZWNvZGVfc3RyZWFtLkRlY29kZVN0cmVhbSB7CiAgY29uc3RydWN0b3Ioc3RyLCBtYXliZUxlbmd0aCwgZGVjcnlwdCkgewogICAgc3VwZXIobWF5YmVMZW5ndGgpOwogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuZGVjcnlwdCA9IGRlY3J5cHQ7CiAgICB0aGlzLm5leHRDaHVuayA9IG51bGw7CiAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7CiAgfQoKICByZWFkQmxvY2soKSB7CiAgICBsZXQgY2h1bms7CgogICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHsKICAgICAgY2h1bmsgPSB0aGlzLm5leHRDaHVuazsKICAgIH0gZWxzZSB7CiAgICAgIGNodW5rID0gdGhpcy5zdHIuZ2V0Qnl0ZXMoY2h1bmtTaXplKTsKICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7CiAgICB9CgogICAgaWYgKCFjaHVuayB8fCBjaHVuay5sZW5ndGggPT09IDApIHsKICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5uZXh0Q2h1bmsgPSB0aGlzLnN0ci5nZXRCeXRlcyhjaHVua1NpemUpOwogICAgY29uc3QgaGFzTW9yZURhdGEgPSB0aGlzLm5leHRDaHVuayAmJiB0aGlzLm5leHRDaHVuay5sZW5ndGggPiAwOwogICAgY29uc3QgZGVjcnlwdCA9IHRoaXMuZGVjcnlwdDsKICAgIGNodW5rID0gZGVjcnlwdChjaHVuaywgIWhhc01vcmVEYXRhKTsKICAgIGxldCBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIGNvbnN0IG4gPSBjaHVuay5sZW5ndGgsCiAgICAgICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyBuKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gY2h1bmtbaV07CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgfQoKfQoKZXhwb3J0cy5EZWNyeXB0U3RyZWFtID0gRGVjcnlwdFN0cmVhbTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkNhdGFsb2cgPSB2b2lkIDA7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX25hbWVfbnVtYmVyX3RyZWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcwKTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9jbGVhbnVwX2hlbHBlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNzEpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7Cgp2YXIgX2ZpbGVfc3BlYyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzIpOwoKdmFyIF9pbWFnZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNTkpOwoKdmFyIF9tZXRhZGF0YV9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDczKTsKCnZhciBfc3RydWN0X3RyZWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc0KTsKCmZ1bmN0aW9uIGZldGNoRGVzdGluYXRpb24oZGVzdCkgewogIGlmIChkZXN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgZGVzdCA9IGRlc3QuZ2V0KCJEIik7CiAgfQoKICByZXR1cm4gQXJyYXkuaXNBcnJheShkZXN0KSA/IGRlc3QgOiBudWxsOwp9CgpjbGFzcyBDYXRhbG9nIHsKICBjb25zdHJ1Y3RvcihwZGZNYW5hZ2VyLCB4cmVmKSB7CiAgICB0aGlzLnBkZk1hbmFnZXIgPSBwZGZNYW5hZ2VyOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMuX2NhdERpY3QgPSB4cmVmLmdldENhdGFsb2dPYmooKTsKCiAgICBpZiAoISh0aGlzLl9jYXREaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJDYXRhbG9nIG9iamVjdCBpcyBub3QgYSBkaWN0aW9uYXJ5LiIpOwogICAgfQoKICAgIHRoaXMudG9wbGV2ZWxQYWdlc0RpY3Q7CiAgICB0aGlzLl9hY3R1YWxOdW1QYWdlcyA9IG51bGw7CiAgICB0aGlzLmZvbnRDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5idWlsdEluQ01hcENhY2hlID0gbmV3IE1hcCgpOwogICAgdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUgPSBuZXcgTWFwKCk7CiAgICB0aGlzLmdsb2JhbEltYWdlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkdsb2JhbEltYWdlQ2FjaGUoKTsKICAgIHRoaXMucGFnZUtpZHNDb3VudENhY2hlID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldENhY2hlKCk7CiAgICB0aGlzLnBhZ2VJbmRleENhY2hlID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldENhY2hlKCk7CiAgICB0aGlzLm5vbkJsZW5kTW9kZXNTZXQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CiAgfQoKICBnZXQgdmVyc2lvbigpIHsKICAgIGNvbnN0IHZlcnNpb24gPSB0aGlzLl9jYXREaWN0LmdldCgiVmVyc2lvbiIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAidmVyc2lvbiIsIHZlcnNpb24gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gdmVyc2lvbi5uYW1lIDogbnVsbCk7CiAgfQoKICBnZXQgbGFuZygpIHsKICAgIGNvbnN0IGxhbmcgPSB0aGlzLl9jYXREaWN0LmdldCgiTGFuZyIpOwoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibGFuZyIsIHR5cGVvZiBsYW5nID09PSAic3RyaW5nIiA/ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykobGFuZykgOiBudWxsKTsKICB9CgogIGdldCBuZWVkc1JlbmRlcmluZygpIHsKICAgIGNvbnN0IG5lZWRzUmVuZGVyaW5nID0gdGhpcy5fY2F0RGljdC5nZXQoIk5lZWRzUmVuZGVyaW5nIik7CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJuZWVkc1JlbmRlcmluZyIsIHR5cGVvZiBuZWVkc1JlbmRlcmluZyA9PT0gImJvb2xlYW4iID8gbmVlZHNSZW5kZXJpbmcgOiBmYWxzZSk7CiAgfQoKICBnZXQgY29sbGVjdGlvbigpIHsKICAgIGxldCBjb2xsZWN0aW9uID0gbnVsbDsKCiAgICB0cnkgewogICAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiQ29sbGVjdGlvbiIpOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgb2JqLnNpemUgPiAwKSB7CiAgICAgICAgY29sbGVjdGlvbiA9IG9iajsKICAgICAgfQogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLmluZm8pKCJDYW5ub3QgZmV0Y2ggQ29sbGVjdGlvbiBlbnRyeTsgYXNzdW1pbmcgbm8gY29sbGVjdGlvbiBpcyBwcmVzZW50LiIpOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiY29sbGVjdGlvbiIsIGNvbGxlY3Rpb24pOwogIH0KCiAgZ2V0IGFjcm9Gb3JtKCkgewogICAgbGV0IGFjcm9Gb3JtID0gbnVsbDsKCiAgICB0cnkgewogICAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiQWNyb0Zvcm0iKTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmIG9iai5zaXplID4gMCkgewogICAgICAgIGFjcm9Gb3JtID0gb2JqOwogICAgICB9CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwuaW5mbykoIkNhbm5vdCBmZXRjaCBBY3JvRm9ybSBlbnRyeTsgYXNzdW1pbmcgbm8gZm9ybXMgYXJlIHByZXNlbnQuIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJhY3JvRm9ybSIsIGFjcm9Gb3JtKTsKICB9CgogIGdldCBhY3JvRm9ybVJlZigpIHsKICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fY2F0RGljdC5nZXRSYXcoIkFjcm9Gb3JtIik7CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJhY3JvRm9ybVJlZiIsIHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmID8gdmFsdWUgOiBudWxsKTsKICB9CgogIGdldCBtZXRhZGF0YSgpIHsKICAgIGNvbnN0IHN0cmVhbVJlZiA9IHRoaXMuX2NhdERpY3QuZ2V0UmF3KCJNZXRhZGF0YSIpOwoKICAgIGlmICghKHN0cmVhbVJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJtZXRhZGF0YSIsIG51bGwpOwogICAgfQoKICAgIGxldCBtZXRhZGF0YSA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgY29uc3Qgc3VwcHJlc3NFbmNyeXB0aW9uID0gISh0aGlzLnhyZWYuZW5jcnlwdCAmJiB0aGlzLnhyZWYuZW5jcnlwdC5lbmNyeXB0TWV0YWRhdGEpOwogICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnhyZWYuZmV0Y2goc3RyZWFtUmVmLCBzdXBwcmVzc0VuY3J5cHRpb24pOwoKICAgICAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtICYmIHN0cmVhbS5kaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIGNvbnN0IHR5cGUgPSBzdHJlYW0uZGljdC5nZXQoIlR5cGUiKTsKICAgICAgICBjb25zdCBzdWJ0eXBlID0gc3RyZWFtLmRpY3QuZ2V0KCJTdWJ0eXBlIik7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0eXBlLCAiTWV0YWRhdGEiKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShzdWJ0eXBlLCAiWE1MIikpIHsKICAgICAgICAgIGNvbnN0IGRhdGEgPSAoMCwgX3V0aWwuc3RyaW5nVG9VVEY4U3RyaW5nKShzdHJlYW0uZ2V0U3RyaW5nKCkpOwoKICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgIG1ldGFkYXRhID0gbmV3IF9tZXRhZGF0YV9wYXJzZXIuTWV0YWRhdGFQYXJzZXIoZGF0YSkuc2VyaWFsaXphYmxlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLmluZm8pKGBTa2lwcGluZyBpbnZhbGlkIE1ldGFkYXRhOiAiJHtleH0iLmApOwogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibWV0YWRhdGEiLCBtZXRhZGF0YSk7CiAgfQoKICBnZXQgbWFya0luZm8oKSB7CiAgICBsZXQgbWFya0luZm8gPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIG1hcmtJbmZvID0gdGhpcy5fcmVhZE1hcmtJbmZvKCk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byByZWFkIG1hcmsgaW5mby4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm1hcmtJbmZvIiwgbWFya0luZm8pOwogIH0KCiAgX3JlYWRNYXJrSW5mbygpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJNYXJrSW5mbyIpOwoKICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IG1hcmtJbmZvID0gewogICAgICBNYXJrZWQ6IGZhbHNlLAogICAgICBVc2VyUHJvcGVydGllczogZmFsc2UsCiAgICAgIFN1c3BlY3RzOiBmYWxzZQogICAgfTsKCiAgICBmb3IgKGNvbnN0IGtleSBpbiBtYXJrSW5mbykgewogICAgICBjb25zdCB2YWx1ZSA9IG9iai5nZXQoa2V5KTsKCiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJib29sZWFuIikgewogICAgICAgIG1hcmtJbmZvW2tleV0gPSB2YWx1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBtYXJrSW5mbzsKICB9CgogIGdldCBzdHJ1Y3RUcmVlUm9vdCgpIHsKICAgIGxldCBzdHJ1Y3RUcmVlID0gbnVsbDsKCiAgICB0cnkgewogICAgICBzdHJ1Y3RUcmVlID0gdGhpcy5fcmVhZFN0cnVjdFRyZWVSb290KCk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSByZWFkIHRvIHN0cnVjdFRyZWVSb290IGluZm8uIik7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJzdHJ1Y3RUcmVlUm9vdCIsIHN0cnVjdFRyZWUpOwogIH0KCiAgX3JlYWRTdHJ1Y3RUcmVlUm9vdCgpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJTdHJ1Y3RUcmVlUm9vdCIpOwoKICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHJvb3QgPSBuZXcgX3N0cnVjdF90cmVlLlN0cnVjdFRyZWVSb290KG9iaik7CiAgICByb290LmluaXQoKTsKICAgIHJldHVybiByb290OwogIH0KCiAgZ2V0IHRvcGxldmVsUGFnZXNEaWN0KCkgewogICAgY29uc3QgcGFnZXNPYmogPSB0aGlzLl9jYXREaWN0LmdldCgiUGFnZXMiKTsKCiAgICBpZiAoIShwYWdlc09iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCB0b3AtbGV2ZWwgcGFnZXMgZGljdGlvbmFyeS4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInRvcGxldmVsUGFnZXNEaWN0IiwgcGFnZXNPYmopOwogIH0KCiAgZ2V0IGRvY3VtZW50T3V0bGluZSgpIHsKICAgIGxldCBvYmogPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIG9iaiA9IHRoaXMuX3JlYWREb2N1bWVudE91dGxpbmUoKTsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKSgiVW5hYmxlIHRvIHJlYWQgZG9jdW1lbnQgb3V0bGluZS4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImRvY3VtZW50T3V0bGluZSIsIG9iaik7CiAgfQoKICBfcmVhZERvY3VtZW50T3V0bGluZSgpIHsKICAgIGxldCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiT3V0bGluZXMiKTsKCiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBvYmogPSBvYmouZ2V0UmF3KCJGaXJzdCIpOwoKICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgY29uc3Qgcm9vdCA9IHsKICAgICAgaXRlbXM6IFtdCiAgICB9OwogICAgY29uc3QgcXVldWUgPSBbewogICAgICBvYmosCiAgICAgIHBhcmVudDogcm9vdAogICAgfV07CiAgICBjb25zdCBwcm9jZXNzZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CiAgICBwcm9jZXNzZWQucHV0KG9iaik7CiAgICBjb25zdCB4cmVmID0gdGhpcy54cmVmLAogICAgICAgICAgYmxhY2tDb2xvciA9IG5ldyBVaW50OENsYW1wZWRBcnJheSgzKTsKCiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBpID0gcXVldWUuc2hpZnQoKTsKICAgICAgY29uc3Qgb3V0bGluZURpY3QgPSB4cmVmLmZldGNoSWZSZWYoaS5vYmopOwoKICAgICAgaWYgKG91dGxpbmVEaWN0ID09PSBudWxsKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghb3V0bGluZURpY3QuaGFzKCJUaXRsZSIpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIG91dGxpbmUgaXRlbSBlbmNvdW50ZXJlZC4iKTsKICAgICAgfQoKICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICB1cmw6IG51bGwsCiAgICAgICAgZGVzdDogbnVsbAogICAgICB9OwogICAgICBDYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICAgIGRlc3REaWN0OiBvdXRsaW5lRGljdCwKICAgICAgICByZXN1bHRPYmo6IGRhdGEsCiAgICAgICAgZG9jQmFzZVVybDogdGhpcy5wZGZNYW5hZ2VyLmRvY0Jhc2VVcmwKICAgICAgfSk7CiAgICAgIGNvbnN0IHRpdGxlID0gb3V0bGluZURpY3QuZ2V0KCJUaXRsZSIpOwogICAgICBjb25zdCBmbGFncyA9IG91dGxpbmVEaWN0LmdldCgiRiIpIHx8IDA7CiAgICAgIGNvbnN0IGNvbG9yID0gb3V0bGluZURpY3QuZ2V0QXJyYXkoIkMiKTsKICAgICAgY29uc3QgY291bnQgPSBvdXRsaW5lRGljdC5nZXQoIkNvdW50Iik7CiAgICAgIGxldCByZ2JDb2xvciA9IGJsYWNrQ29sb3I7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2xvcikgJiYgY29sb3IubGVuZ3RoID09PSAzICYmIChjb2xvclswXSAhPT0gMCB8fCBjb2xvclsxXSAhPT0gMCB8fCBjb2xvclsyXSAhPT0gMCkpIHsKICAgICAgICByZ2JDb2xvciA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2IuZ2V0UmdiKGNvbG9yLCAwKTsKICAgICAgfQoKICAgICAgY29uc3Qgb3V0bGluZUl0ZW0gPSB7CiAgICAgICAgZGVzdDogZGF0YS5kZXN0LAogICAgICAgIHVybDogZGF0YS51cmwsCiAgICAgICAgdW5zYWZlVXJsOiBkYXRhLnVuc2FmZVVybCwKICAgICAgICBuZXdXaW5kb3c6IGRhdGEubmV3V2luZG93LAogICAgICAgIHRpdGxlOiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHRpdGxlKSwKICAgICAgICBjb2xvcjogcmdiQ29sb3IsCiAgICAgICAgY291bnQ6IE51bWJlci5pc0ludGVnZXIoY291bnQpID8gY291bnQgOiB1bmRlZmluZWQsCiAgICAgICAgYm9sZDogISEoZmxhZ3MgJiAyKSwKICAgICAgICBpdGFsaWM6ICEhKGZsYWdzICYgMSksCiAgICAgICAgaXRlbXM6IFtdCiAgICAgIH07CiAgICAgIGkucGFyZW50Lml0ZW1zLnB1c2gob3V0bGluZUl0ZW0pOwogICAgICBvYmogPSBvdXRsaW5lRGljdC5nZXRSYXcoIkZpcnN0Iik7CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmICYmICFwcm9jZXNzZWQuaGFzKG9iaikpIHsKICAgICAgICBxdWV1ZS5wdXNoKHsKICAgICAgICAgIG9iaiwKICAgICAgICAgIHBhcmVudDogb3V0bGluZUl0ZW0KICAgICAgICB9KTsKICAgICAgICBwcm9jZXNzZWQucHV0KG9iaik7CiAgICAgIH0KCiAgICAgIG9iaiA9IG91dGxpbmVEaWN0LmdldFJhdygiTmV4dCIpOwoKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiAmJiAhcHJvY2Vzc2VkLmhhcyhvYmopKSB7CiAgICAgICAgcXVldWUucHVzaCh7CiAgICAgICAgICBvYmosCiAgICAgICAgICBwYXJlbnQ6IGkucGFyZW50CiAgICAgICAgfSk7CiAgICAgICAgcHJvY2Vzc2VkLnB1dChvYmopOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJvb3QuaXRlbXMubGVuZ3RoID4gMCA/IHJvb3QuaXRlbXMgOiBudWxsOwogIH0KCiAgZ2V0IHBlcm1pc3Npb25zKCkgewogICAgbGV0IHBlcm1pc3Npb25zID0gbnVsbDsKCiAgICB0cnkgewogICAgICBwZXJtaXNzaW9ucyA9IHRoaXMuX3JlYWRQZXJtaXNzaW9ucygpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmFibGUgdG8gcmVhZCBwZXJtaXNzaW9ucy4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInBlcm1pc3Npb25zIiwgcGVybWlzc2lvbnMpOwogIH0KCiAgX3JlYWRQZXJtaXNzaW9ucygpIHsKICAgIGNvbnN0IGVuY3J5cHQgPSB0aGlzLnhyZWYudHJhaWxlci5nZXQoIkVuY3J5cHQiKTsKCiAgICBpZiAoIShlbmNyeXB0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgbGV0IGZsYWdzID0gZW5jcnlwdC5nZXQoIlAiKTsKCiAgICBpZiAodHlwZW9mIGZsYWdzICE9PSAibnVtYmVyIikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmbGFncyArPSAyICoqIDMyOwogICAgY29uc3QgcGVybWlzc2lvbnMgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGtleSBpbiBfdXRpbC5QZXJtaXNzaW9uRmxhZykgewogICAgICBjb25zdCB2YWx1ZSA9IF91dGlsLlBlcm1pc3Npb25GbGFnW2tleV07CgogICAgICBpZiAoZmxhZ3MgJiB2YWx1ZSkgewogICAgICAgIHBlcm1pc3Npb25zLnB1c2godmFsdWUpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHBlcm1pc3Npb25zOwogIH0KCiAgZ2V0IG9wdGlvbmFsQ29udGVudENvbmZpZygpIHsKICAgIGxldCBjb25maWcgPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLl9jYXREaWN0LmdldCgiT0NQcm9wZXJ0aWVzIik7CgogICAgICBpZiAoIXByb3BlcnRpZXMpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm9wdGlvbmFsQ29udGVudENvbmZpZyIsIG51bGwpOwogICAgICB9CgogICAgICBjb25zdCBkZWZhdWx0Q29uZmlnID0gcHJvcGVydGllcy5nZXQoIkQiKTsKCiAgICAgIGlmICghZGVmYXVsdENvbmZpZykgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAib3B0aW9uYWxDb250ZW50Q29uZmlnIiwgbnVsbCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGdyb3Vwc0RhdGEgPSBwcm9wZXJ0aWVzLmdldCgiT0NHcyIpOwoKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGdyb3Vwc0RhdGEpKSB7CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJvcHRpb25hbENvbnRlbnRDb25maWciLCBudWxsKTsKICAgICAgfQoKICAgICAgY29uc3QgZ3JvdXBzID0gW107CiAgICAgIGNvbnN0IGdyb3VwUmVmcyA9IFtdOwoKICAgICAgZm9yIChjb25zdCBncm91cFJlZiBvZiBncm91cHNEYXRhKSB7CiAgICAgICAgaWYgKCEoZ3JvdXBSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGdyb3VwUmVmcy5wdXNoKGdyb3VwUmVmKTsKICAgICAgICBjb25zdCBncm91cCA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGdyb3VwUmVmKTsKICAgICAgICBncm91cHMucHVzaCh7CiAgICAgICAgICBpZDogZ3JvdXBSZWYudG9TdHJpbmcoKSwKICAgICAgICAgIG5hbWU6IHR5cGVvZiBncm91cC5nZXQoIk5hbWUiKSA9PT0gInN0cmluZyIgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGdyb3VwLmdldCgiTmFtZSIpKSA6IG51bGwsCiAgICAgICAgICBpbnRlbnQ6IHR5cGVvZiBncm91cC5nZXQoIkludGVudCIpID09PSAic3RyaW5nIiA/ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZ3JvdXAuZ2V0KCJJbnRlbnQiKSkgOiBudWxsCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGNvbmZpZyA9IHRoaXMuX3JlYWRPcHRpb25hbENvbnRlbnRDb25maWcoZGVmYXVsdENvbmZpZywgZ3JvdXBSZWZzKTsKICAgICAgY29uZmlnLmdyb3VwcyA9IGdyb3VwczsKICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgdGhyb3cgZXg7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC53YXJuKShgVW5hYmxlIHRvIHJlYWQgb3B0aW9uYWwgY29udGVudCBjb25maWc6ICR7ZXh9YCk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJvcHRpb25hbENvbnRlbnRDb25maWciLCBjb25maWcpOwogIH0KCiAgX3JlYWRPcHRpb25hbENvbnRlbnRDb25maWcoY29uZmlnLCBjb250ZW50R3JvdXBSZWZzKSB7CiAgICBmdW5jdGlvbiBwYXJzZU9uT2ZmKHJlZnMpIHsKICAgICAgY29uc3Qgb25QYXJzZWQgPSBbXTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlZnMpKSB7CiAgICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiByZWZzKSB7CiAgICAgICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGNvbnRlbnRHcm91cFJlZnMuaW5jbHVkZXModmFsdWUpKSB7CiAgICAgICAgICAgIG9uUGFyc2VkLnB1c2godmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gb25QYXJzZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gcGFyc2VPcmRlcihyZWZzLCBuZXN0ZWRMZXZlbHMgPSAwKSB7CiAgICAgIGlmICghQXJyYXkuaXNBcnJheShyZWZzKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBvcmRlciA9IFtdOwoKICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiByZWZzKSB7CiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmICYmIGNvbnRlbnRHcm91cFJlZnMuaW5jbHVkZXModmFsdWUpKSB7CiAgICAgICAgICBwYXJzZWRPcmRlclJlZnMucHV0KHZhbHVlKTsKICAgICAgICAgIG9yZGVyLnB1c2godmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG5lc3RlZE9yZGVyID0gcGFyc2VOZXN0ZWRPcmRlcih2YWx1ZSwgbmVzdGVkTGV2ZWxzKTsKCiAgICAgICAgaWYgKG5lc3RlZE9yZGVyKSB7CiAgICAgICAgICBvcmRlci5wdXNoKG5lc3RlZE9yZGVyKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChuZXN0ZWRMZXZlbHMgPiAwKSB7CiAgICAgICAgcmV0dXJuIG9yZGVyOwogICAgICB9CgogICAgICBjb25zdCBoaWRkZW5Hcm91cHMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgZ3JvdXBSZWYgb2YgY29udGVudEdyb3VwUmVmcykgewogICAgICAgIGlmIChwYXJzZWRPcmRlclJlZnMuaGFzKGdyb3VwUmVmKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBoaWRkZW5Hcm91cHMucHVzaChncm91cFJlZi50b1N0cmluZygpKTsKICAgICAgfQoKICAgICAgaWYgKGhpZGRlbkdyb3Vwcy5sZW5ndGgpIHsKICAgICAgICBvcmRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6IG51bGwsCiAgICAgICAgICBvcmRlcjogaGlkZGVuR3JvdXBzCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBvcmRlcjsKICAgIH0KCiAgICBmdW5jdGlvbiBwYXJzZU5lc3RlZE9yZGVyKHJlZiwgbmVzdGVkTGV2ZWxzKSB7CiAgICAgIGlmICgrK25lc3RlZExldmVscyA+IE1BWF9ORVNURURfTEVWRUxTKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJwYXJzZU5lc3RlZE9yZGVyIC0gcmVhY2hlZCBNQVhfTkVTVEVEX0xFVkVMUy4iKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgdmFsdWUgPSB4cmVmLmZldGNoSWZSZWYocmVmKTsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgY29uc3QgbmVzdGVkTmFtZSA9IHhyZWYuZmV0Y2hJZlJlZih2YWx1ZVswXSk7CgogICAgICBpZiAodHlwZW9mIG5lc3RlZE5hbWUgIT09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5lc3RlZE9yZGVyID0gcGFyc2VPcmRlcih2YWx1ZS5zbGljZSgxKSwgbmVzdGVkTGV2ZWxzKTsKCiAgICAgIGlmICghbmVzdGVkT3JkZXIgfHwgIW5lc3RlZE9yZGVyLmxlbmd0aCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIG5hbWU6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykobmVzdGVkTmFtZSksCiAgICAgICAgb3JkZXI6IG5lc3RlZE9yZGVyCiAgICAgIH07CiAgICB9CgogICAgY29uc3QgeHJlZiA9IHRoaXMueHJlZiwKICAgICAgICAgIHBhcnNlZE9yZGVyUmVmcyA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXQoKSwKICAgICAgICAgIE1BWF9ORVNURURfTEVWRUxTID0gMTA7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB0eXBlb2YgY29uZmlnLmdldCgiTmFtZSIpID09PSAic3RyaW5nIiA/ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY29uZmlnLmdldCgiTmFtZSIpKSA6IG51bGwsCiAgICAgIGNyZWF0b3I6IHR5cGVvZiBjb25maWcuZ2V0KCJDcmVhdG9yIikgPT09ICJzdHJpbmciID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShjb25maWcuZ2V0KCJDcmVhdG9yIikpIDogbnVsbCwKICAgICAgYmFzZVN0YXRlOiBjb25maWcuZ2V0KCJCYXNlU3RhdGUiKSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUgPyBjb25maWcuZ2V0KCJCYXNlU3RhdGUiKS5uYW1lIDogbnVsbCwKICAgICAgb246IHBhcnNlT25PZmYoY29uZmlnLmdldCgiT04iKSksCiAgICAgIG9mZjogcGFyc2VPbk9mZihjb25maWcuZ2V0KCJPRkYiKSksCiAgICAgIG9yZGVyOiBwYXJzZU9yZGVyKGNvbmZpZy5nZXQoIk9yZGVyIikpLAogICAgICBncm91cHM6IG51bGwKICAgIH07CiAgfQoKICBzZXRBY3R1YWxOdW1QYWdlcyhudW0gPSBudWxsKSB7CiAgICB0aGlzLl9hY3R1YWxOdW1QYWdlcyA9IG51bTsKICB9CgogIGdldCBoYXNBY3R1YWxOdW1QYWdlcygpIHsKICAgIHJldHVybiB0aGlzLl9hY3R1YWxOdW1QYWdlcyAhPT0gbnVsbDsKICB9CgogIGdldCBfcGFnZXNDb3VudCgpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMudG9wbGV2ZWxQYWdlc0RpY3QuZ2V0KCJDb3VudCIpOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBjb3VudCBpbiB0b3AtbGV2ZWwgcGFnZXMgZGljdGlvbmFyeSBpcyBub3QgYW4gaW50ZWdlci4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIl9wYWdlc0NvdW50Iiwgb2JqKTsKICB9CgogIGdldCBudW1QYWdlcygpIHsKICAgIHJldHVybiB0aGlzLmhhc0FjdHVhbE51bVBhZ2VzID8gdGhpcy5fYWN0dWFsTnVtUGFnZXMgOiB0aGlzLl9wYWdlc0NvdW50OwogIH0KCiAgZ2V0IGRlc3RpbmF0aW9ucygpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX3JlYWREZXN0cygpLAogICAgICAgICAgZGVzdHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfbmFtZV9udW1iZXJfdHJlZS5OYW1lVHJlZSkgewogICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBvYmouZ2V0QWxsKCkpIHsKICAgICAgICBjb25zdCBkZXN0ID0gZmV0Y2hEZXN0aW5hdGlvbih2YWx1ZSk7CgogICAgICAgIGlmIChkZXN0KSB7CiAgICAgICAgICBkZXN0c1soMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGtleSldID0gZGVzdDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBvYmouZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgIGNvbnN0IGRlc3QgPSBmZXRjaERlc3RpbmF0aW9uKHZhbHVlKTsKCiAgICAgICAgaWYgKGRlc3QpIHsKICAgICAgICAgIGRlc3RzW2tleV0gPSBkZXN0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkZXN0aW5hdGlvbnMiLCBkZXN0cyk7CiAgfQoKICBnZXREZXN0aW5hdGlvbihpZCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fcmVhZERlc3RzKCk7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9uYW1lX251bWJlcl90cmVlLk5hbWVUcmVlKSB7CiAgICAgIGNvbnN0IGRlc3QgPSBmZXRjaERlc3RpbmF0aW9uKG9iai5nZXQoaWQpKTsKCiAgICAgIGlmIChkZXN0KSB7CiAgICAgICAgcmV0dXJuIGRlc3Q7CiAgICAgIH0KCiAgICAgIGNvbnN0IGFsbERlc3QgPSB0aGlzLmRlc3RpbmF0aW9uc1tpZF07CgogICAgICBpZiAoYWxsRGVzdCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgRm91bmQgIiR7aWR9IiBhdCBhbiBpbmNvcnJlY3QgcG9zaXRpb24gaW4gdGhlIE5hbWVUcmVlLmApOwogICAgICAgIHJldHVybiBhbGxEZXN0OwogICAgICB9CiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgZGVzdCA9IGZldGNoRGVzdGluYXRpb24ob2JqLmdldChpZCkpOwoKICAgICAgaWYgKGRlc3QpIHsKICAgICAgICByZXR1cm4gZGVzdDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgX3JlYWREZXN0cygpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJOYW1lcyIpOwoKICAgIGlmIChvYmogJiYgb2JqLmhhcygiRGVzdHMiKSkgewogICAgICByZXR1cm4gbmV3IF9uYW1lX251bWJlcl90cmVlLk5hbWVUcmVlKG9iai5nZXRSYXcoIkRlc3RzIiksIHRoaXMueHJlZik7CiAgICB9IGVsc2UgaWYgKHRoaXMuX2NhdERpY3QuaGFzKCJEZXN0cyIpKSB7CiAgICAgIHJldHVybiB0aGlzLl9jYXREaWN0LmdldCgiRGVzdHMiKTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgZ2V0IHBhZ2VMYWJlbHMoKSB7CiAgICBsZXQgb2JqID0gbnVsbDsKCiAgICB0cnkgewogICAgICBvYmogPSB0aGlzLl9yZWFkUGFnZUxhYmVscygpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmFibGUgdG8gcmVhZCBwYWdlIGxhYmVscy4iKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInBhZ2VMYWJlbHMiLCBvYmopOwogIH0KCiAgX3JlYWRQYWdlTGFiZWxzKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXRSYXcoIlBhZ2VMYWJlbHMiKTsKCiAgICBpZiAoIW9iaikgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBwYWdlTGFiZWxzID0gbmV3IEFycmF5KHRoaXMubnVtUGFnZXMpOwogICAgbGV0IHN0eWxlID0gbnVsbCwKICAgICAgICBwcmVmaXggPSAiIjsKICAgIGNvbnN0IG51bWJlclRyZWUgPSBuZXcgX25hbWVfbnVtYmVyX3RyZWUuTnVtYmVyVHJlZShvYmosIHRoaXMueHJlZik7CiAgICBjb25zdCBudW1zID0gbnVtYmVyVHJlZS5nZXRBbGwoKTsKICAgIGxldCBjdXJyZW50TGFiZWwgPSAiIiwKICAgICAgICBjdXJyZW50SW5kZXggPSAxOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHRoaXMubnVtUGFnZXM7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IGxhYmVsRGljdCA9IG51bXMuZ2V0KGkpOwoKICAgICAgaWYgKGxhYmVsRGljdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKCEobGFiZWxEaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZUxhYmVsIGlzIG5vdCBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobGFiZWxEaWN0LmhhcygiVHlwZSIpICYmICEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShsYWJlbERpY3QuZ2V0KCJUeXBlIiksICJQYWdlTGFiZWwiKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIHR5cGUgaW4gUGFnZUxhYmVsIGRpY3Rpb25hcnkuIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobGFiZWxEaWN0LmhhcygiUyIpKSB7CiAgICAgICAgICBjb25zdCBzID0gbGFiZWxEaWN0LmdldCgiUyIpOwoKICAgICAgICAgIGlmICghKHMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgc3R5bGUgaW4gUGFnZUxhYmVsIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgc3R5bGUgPSBzLm5hbWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0eWxlID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJQIikpIHsKICAgICAgICAgIGNvbnN0IHAgPSBsYWJlbERpY3QuZ2V0KCJQIik7CgogICAgICAgICAgaWYgKHR5cGVvZiBwICE9PSAic3RyaW5nIikgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgcHJlZml4IGluIFBhZ2VMYWJlbCBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHByZWZpeCA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykocCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByZWZpeCA9ICIiOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxhYmVsRGljdC5oYXMoIlN0IikpIHsKICAgICAgICAgIGNvbnN0IHN0ID0gbGFiZWxEaWN0LmdldCgiU3QiKTsKCiAgICAgICAgICBpZiAoIShOdW1iZXIuaXNJbnRlZ2VyKHN0KSAmJiBzdCA+PSAxKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgc3RhcnQgaW4gUGFnZUxhYmVsIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgY3VycmVudEluZGV4ID0gc3Q7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRJbmRleCA9IDE7CiAgICAgICAgfQogICAgICB9CgogICAgICBzd2l0Y2ggKHN0eWxlKSB7CiAgICAgICAgY2FzZSAiRCI6CiAgICAgICAgICBjdXJyZW50TGFiZWwgPSBjdXJyZW50SW5kZXg7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiUiI6CiAgICAgICAgY2FzZSAiciI6CiAgICAgICAgICBjdXJyZW50TGFiZWwgPSAoMCwgX2NvcmVfdXRpbHMudG9Sb21hbk51bWVyYWxzKShjdXJyZW50SW5kZXgsIHN0eWxlID09PSAiciIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkEiOgogICAgICAgIGNhc2UgImEiOgogICAgICAgICAgY29uc3QgTElNSVQgPSAyNjsKICAgICAgICAgIGNvbnN0IEFfVVBQRVJfQ0FTRSA9IDB4NDEsCiAgICAgICAgICAgICAgICBBX0xPV0VSX0NBU0UgPSAweDYxOwogICAgICAgICAgY29uc3QgYmFzZUNoYXJDb2RlID0gc3R5bGUgPT09ICJhIiA/IEFfTE9XRVJfQ0FTRSA6IEFfVVBQRVJfQ0FTRTsKICAgICAgICAgIGNvbnN0IGxldHRlckluZGV4ID0gY3VycmVudEluZGV4IC0gMTsKICAgICAgICAgIGNvbnN0IGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYmFzZUNoYXJDb2RlICsgbGV0dGVySW5kZXggJSBMSU1JVCk7CiAgICAgICAgICBjdXJyZW50TGFiZWwgPSBjaGFyYWN0ZXIucmVwZWF0KE1hdGguZmxvb3IobGV0dGVySW5kZXggLyBMSU1JVCkgKyAxKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgaWYgKHN0eWxlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBzdHlsZSAiJHtzdHlsZX0iIGluIFBhZ2VMYWJlbCBkaWN0aW9uYXJ5LmApOwogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRMYWJlbCA9ICIiOwogICAgICB9CgogICAgICBwYWdlTGFiZWxzW2ldID0gcHJlZml4ICsgY3VycmVudExhYmVsOwogICAgICBjdXJyZW50SW5kZXgrKzsKICAgIH0KCiAgICByZXR1cm4gcGFnZUxhYmVsczsKICB9CgogIGdldCBwYWdlTGF5b3V0KCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIlBhZ2VMYXlvdXQiKTsKCiAgICBsZXQgcGFnZUxheW91dCA9ICIiOwoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHN3aXRjaCAob2JqLm5hbWUpIHsKICAgICAgICBjYXNlICJTaW5nbGVQYWdlIjoKICAgICAgICBjYXNlICJPbmVDb2x1bW4iOgogICAgICAgIGNhc2UgIlR3b0NvbHVtbkxlZnQiOgogICAgICAgIGNhc2UgIlR3b0NvbHVtblJpZ2h0IjoKICAgICAgICBjYXNlICJUd29QYWdlTGVmdCI6CiAgICAgICAgY2FzZSAiVHdvUGFnZVJpZ2h0IjoKICAgICAgICAgIHBhZ2VMYXlvdXQgPSBvYmoubmFtZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicGFnZUxheW91dCIsIHBhZ2VMYXlvdXQpOwogIH0KCiAgZ2V0IHBhZ2VNb2RlKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIlBhZ2VNb2RlIik7CgogICAgbGV0IHBhZ2VNb2RlID0gIlVzZU5vbmUiOwoKICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgIHN3aXRjaCAob2JqLm5hbWUpIHsKICAgICAgICBjYXNlICJVc2VOb25lIjoKICAgICAgICBjYXNlICJVc2VPdXRsaW5lcyI6CiAgICAgICAgY2FzZSAiVXNlVGh1bWJzIjoKICAgICAgICBjYXNlICJGdWxsU2NyZWVuIjoKICAgICAgICBjYXNlICJVc2VPQyI6CiAgICAgICAgY2FzZSAiVXNlQXR0YWNobWVudHMiOgogICAgICAgICAgcGFnZU1vZGUgPSBvYmoubmFtZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicGFnZU1vZGUiLCBwYWdlTW9kZSk7CiAgfQoKICBnZXQgdmlld2VyUHJlZmVyZW5jZXMoKSB7CiAgICBjb25zdCBvYmogPSB0aGlzLl9jYXREaWN0LmdldCgiVmlld2VyUHJlZmVyZW5jZXMiKTsKCiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInZpZXdlclByZWZlcmVuY2VzIiwgbnVsbCk7CiAgICB9CgogICAgbGV0IHByZWZzID0gbnVsbDsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBvYmouZ2V0S2V5cygpKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gb2JqLmdldChrZXkpOwogICAgICBsZXQgcHJlZlZhbHVlOwoKICAgICAgc3dpdGNoIChrZXkpIHsKICAgICAgICBjYXNlICJIaWRlVG9vbGJhciI6CiAgICAgICAgY2FzZSAiSGlkZU1lbnViYXIiOgogICAgICAgIGNhc2UgIkhpZGVXaW5kb3dVSSI6CiAgICAgICAgY2FzZSAiRml0V2luZG93IjoKICAgICAgICBjYXNlICJDZW50ZXJXaW5kb3ciOgogICAgICAgIGNhc2UgIkRpc3BsYXlEb2NUaXRsZSI6CiAgICAgICAgY2FzZSAiUGlja1RyYXlCeVBERlNpemUiOgogICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKSB7CiAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJOb25GdWxsU2NyZWVuUGFnZU1vZGUiOgogICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgICAgICAgICAgICBjYXNlICJVc2VOb25lIjoKICAgICAgICAgICAgICBjYXNlICJVc2VPdXRsaW5lcyI6CiAgICAgICAgICAgICAgY2FzZSAiVXNlVGh1bWJzIjoKICAgICAgICAgICAgICBjYXNlICJVc2VPQyI6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZS5uYW1lOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSAiVXNlTm9uZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiRGlyZWN0aW9uIjoKICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgc3dpdGNoICh2YWx1ZS5uYW1lKSB7CiAgICAgICAgICAgICAgY2FzZSAiTDJSIjoKICAgICAgICAgICAgICBjYXNlICJSMkwiOgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIkwyUiI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiVmlld0FyZWEiOgogICAgICAgIGNhc2UgIlZpZXdDbGlwIjoKICAgICAgICBjYXNlICJQcmludEFyZWEiOgogICAgICAgIGNhc2UgIlByaW50Q2xpcCI6CiAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSB7CiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgIGNhc2UgIk1lZGlhQm94IjoKICAgICAgICAgICAgICBjYXNlICJDcm9wQm94IjoKICAgICAgICAgICAgICBjYXNlICJCbGVlZEJveCI6CiAgICAgICAgICAgICAgY2FzZSAiVHJpbUJveCI6CiAgICAgICAgICAgICAgY2FzZSAiQXJ0Qm94IjoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlLm5hbWU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9ICJDcm9wQm94IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJQcmludFNjYWxpbmciOgogICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgICAgICAgICAgICBjYXNlICJOb25lIjoKICAgICAgICAgICAgICBjYXNlICJBcHBEZWZhdWx0IjoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlLm5hbWU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9ICJBcHBEZWZhdWx0IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJEdXBsZXgiOgogICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgICAgICAgICAgICBjYXNlICJTaW1wbGV4IjoKICAgICAgICAgICAgICBjYXNlICJEdXBsZXhGbGlwU2hvcnRFZGdlIjoKICAgICAgICAgICAgICBjYXNlICJEdXBsZXhGbGlwTG9uZ0VkZ2UiOgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIk5vbmUiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlByaW50UGFnZVJhbmdlIjoKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggJSAyID09PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSB2YWx1ZS5ldmVyeSgocGFnZSwgaSwgYXJyKSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIocGFnZSkgJiYgcGFnZSA+IDAgJiYgKGkgPT09IDAgfHwgcGFnZSA+PSBhcnJbaSAtIDFdKSAmJiBwYWdlIDw9IHRoaXMubnVtUGFnZXM7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKGlzVmFsaWQpIHsKICAgICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJOdW1Db3BpZXMiOgogICAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIodmFsdWUpICYmIHZhbHVlID4gMCkgewogICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgSWdub3Jpbmcgbm9uLXN0YW5kYXJkIGtleSBpbiBWaWV3ZXJQcmVmZXJlbmNlczogJHtrZXl9LmApOwogICAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChwcmVmVmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgQmFkIHZhbHVlLCBmb3Iga2V5ICIke2tleX0iLCBpbiBWaWV3ZXJQcmVmZXJlbmNlczogJHt2YWx1ZX0uYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghcHJlZnMpIHsKICAgICAgICBwcmVmcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIH0KCiAgICAgIHByZWZzW2tleV0gPSBwcmVmVmFsdWU7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ2aWV3ZXJQcmVmZXJlbmNlcyIsIHByZWZzKTsKICB9CgogIGdldCBvcGVuQWN0aW9uKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk9wZW5BY3Rpb24iKTsKCiAgICBjb25zdCBvcGVuQWN0aW9uID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBkZXN0RGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHRoaXMueHJlZik7CiAgICAgIGRlc3REaWN0LnNldCgiQSIsIG9iaik7CiAgICAgIGNvbnN0IHJlc3VsdE9iaiA9IHsKICAgICAgICB1cmw6IG51bGwsCiAgICAgICAgZGVzdDogbnVsbCwKICAgICAgICBhY3Rpb246IG51bGwKICAgICAgfTsKICAgICAgQ2F0YWxvZy5wYXJzZURlc3REaWN0aW9uYXJ5KHsKICAgICAgICBkZXN0RGljdCwKICAgICAgICByZXN1bHRPYmoKICAgICAgfSk7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHRPYmouZGVzdCkpIHsKICAgICAgICBvcGVuQWN0aW9uLmRlc3QgPSByZXN1bHRPYmouZGVzdDsKICAgICAgfSBlbHNlIGlmIChyZXN1bHRPYmouYWN0aW9uKSB7CiAgICAgICAgb3BlbkFjdGlvbi5hY3Rpb24gPSByZXN1bHRPYmouYWN0aW9uOwogICAgICB9CiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgewogICAgICBvcGVuQWN0aW9uLmRlc3QgPSBvYmo7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJvcGVuQWN0aW9uIiwgKDAsIF91dGlsLm9iamVjdFNpemUpKG9wZW5BY3Rpb24pID4gMCA/IG9wZW5BY3Rpb24gOiBudWxsKTsKICB9CgogIGdldCBhdHRhY2htZW50cygpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJOYW1lcyIpOwoKICAgIGxldCBhdHRhY2htZW50cyA9IG51bGw7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgb2JqLmhhcygiRW1iZWRkZWRGaWxlcyIpKSB7CiAgICAgIGNvbnN0IG5hbWVUcmVlID0gbmV3IF9uYW1lX251bWJlcl90cmVlLk5hbWVUcmVlKG9iai5nZXRSYXcoIkVtYmVkZGVkRmlsZXMiKSwgdGhpcy54cmVmKTsKCiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIG5hbWVUcmVlLmdldEFsbCgpKSB7CiAgICAgICAgY29uc3QgZnMgPSBuZXcgX2ZpbGVfc3BlYy5GaWxlU3BlYyh2YWx1ZSwgdGhpcy54cmVmKTsKCiAgICAgICAgaWYgKCFhdHRhY2htZW50cykgewogICAgICAgICAgYXR0YWNobWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgIH0KCiAgICAgICAgYXR0YWNobWVudHNbKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShrZXkpXSA9IGZzLnNlcmlhbGl6YWJsZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYXR0YWNobWVudHMiLCBhdHRhY2htZW50cyk7CiAgfQoKICBnZXQgeGZhSW1hZ2VzKCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5fY2F0RGljdC5nZXQoIk5hbWVzIik7CgogICAgbGV0IHhmYUltYWdlcyA9IG51bGw7CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgb2JqLmhhcygiWEZBSW1hZ2VzIikpIHsKICAgICAgY29uc3QgbmFtZVRyZWUgPSBuZXcgX25hbWVfbnVtYmVyX3RyZWUuTmFtZVRyZWUob2JqLmdldFJhdygiWEZBSW1hZ2VzIiksIHRoaXMueHJlZik7CgogICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBuYW1lVHJlZS5nZXRBbGwoKSkgewogICAgICAgIGlmICgheGZhSW1hZ2VzKSB7CiAgICAgICAgICB4ZmFJbWFnZXMgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCh0aGlzLnhyZWYpOwogICAgICAgIH0KCiAgICAgICAgeGZhSW1hZ2VzLnNldCgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGtleSksIHZhbHVlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAieGZhSW1hZ2VzIiwgeGZhSW1hZ2VzKTsKICB9CgogIF9jb2xsZWN0SmF2YVNjcmlwdCgpIHsKICAgIGNvbnN0IG9iaiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJOYW1lcyIpOwoKICAgIGxldCBqYXZhU2NyaXB0ID0gbnVsbDsKCiAgICBmdW5jdGlvbiBhcHBlbmRJZkphdmFTY3JpcHREaWN0KG5hbWUsIGpzRGljdCkgewogICAgICBpZiAoIShqc0RpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShqc0RpY3QuZ2V0KCJTIiksICJKYXZhU2NyaXB0IikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxldCBqcyA9IGpzRGljdC5nZXQoIkpTIik7CgogICAgICBpZiAoanMgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGpzID0ganMuZ2V0U3RyaW5nKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGpzICE9PSAic3RyaW5nIikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGphdmFTY3JpcHQgPT09IG51bGwpIHsKICAgICAgICBqYXZhU2NyaXB0ID0gbmV3IE1hcCgpOwogICAgICB9CgogICAgICBqcyA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoanMpLnJlcGxhY2UoL1x1MDAwMC9nLCAiIik7CiAgICAgIGphdmFTY3JpcHQuc2V0KG5hbWUsIGpzKTsKICAgIH0KCiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiBvYmouaGFzKCJKYXZhU2NyaXB0IikpIHsKICAgICAgY29uc3QgbmFtZVRyZWUgPSBuZXcgX25hbWVfbnVtYmVyX3RyZWUuTmFtZVRyZWUob2JqLmdldFJhdygiSmF2YVNjcmlwdCIpLCB0aGlzLnhyZWYpOwoKICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbmFtZVRyZWUuZ2V0QWxsKCkpIHsKICAgICAgICBhcHBlbmRJZkphdmFTY3JpcHREaWN0KCgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoa2V5KSwgdmFsdWUpOwogICAgICB9CiAgICB9CgogICAgY29uc3Qgb3BlbkFjdGlvbiA9IHRoaXMuX2NhdERpY3QuZ2V0KCJPcGVuQWN0aW9uIik7CgogICAgaWYgKG9wZW5BY3Rpb24pIHsKICAgICAgYXBwZW5kSWZKYXZhU2NyaXB0RGljdCgiT3BlbkFjdGlvbiIsIG9wZW5BY3Rpb24pOwogICAgfQoKICAgIHJldHVybiBqYXZhU2NyaXB0OwogIH0KCiAgZ2V0IGphdmFTY3JpcHQoKSB7CiAgICBjb25zdCBqYXZhU2NyaXB0ID0gdGhpcy5fY29sbGVjdEphdmFTY3JpcHQoKTsKCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImphdmFTY3JpcHQiLCBqYXZhU2NyaXB0ID8gWy4uLmphdmFTY3JpcHQudmFsdWVzKCldIDogbnVsbCk7CiAgfQoKICBnZXQganNBY3Rpb25zKCkgewogICAgY29uc3QgamF2YVNjcmlwdCA9IHRoaXMuX2NvbGxlY3RKYXZhU2NyaXB0KCk7CgogICAgbGV0IGFjdGlvbnMgPSAoMCwgX2NvcmVfdXRpbHMuY29sbGVjdEFjdGlvbnMpKHRoaXMueHJlZiwgdGhpcy5fY2F0RGljdCwgX3V0aWwuRG9jdW1lbnRBY3Rpb25FdmVudFR5cGUpOwoKICAgIGlmIChqYXZhU2NyaXB0KSB7CiAgICAgIGlmICghYWN0aW9ucykgewogICAgICAgIGFjdGlvbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbF0gb2YgamF2YVNjcmlwdCkgewogICAgICAgIGlmIChrZXkgaW4gYWN0aW9ucykgewogICAgICAgICAgYWN0aW9uc1trZXldLnB1c2godmFsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWN0aW9uc1trZXldID0gW3ZhbF07CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJqc0FjdGlvbnMiLCBhY3Rpb25zKTsKICB9CgogIGFzeW5jIGZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcikgewogICAgY29uc3QgdHJhbnNsYXRlZEZvbnRzID0gYXdhaXQgUHJvbWlzZS5hbGwodGhpcy5mb250Q2FjaGUpOwoKICAgIGZvciAoY29uc3QgdHJhbnNsYXRlZEZvbnQgb2YgdHJhbnNsYXRlZEZvbnRzKSB7CiAgICAgIGlmICh0cmFuc2xhdGVkRm9udC5sb2FkZWROYW1lID09PSBpZCkgewogICAgICAgIHRyYW5zbGF0ZWRGb250LmZhbGxiYWNrKGhhbmRsZXIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgY2xlYW51cChtYW51YWxseVRyaWdnZXJlZCA9IGZhbHNlKSB7CiAgICAoMCwgX2NsZWFudXBfaGVscGVyLmNsZWFyR2xvYmFsQ2FjaGVzKSgpOwogICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlLmNsZWFyKG1hbnVhbGx5VHJpZ2dlcmVkKTsKICAgIHRoaXMucGFnZUtpZHNDb3VudENhY2hlLmNsZWFyKCk7CiAgICB0aGlzLnBhZ2VJbmRleENhY2hlLmNsZWFyKCk7CiAgICB0aGlzLm5vbkJsZW5kTW9kZXNTZXQuY2xlYXIoKTsKICAgIGNvbnN0IHRyYW5zbGF0ZWRGb250cyA9IGF3YWl0IFByb21pc2UuYWxsKHRoaXMuZm9udENhY2hlKTsKCiAgICBmb3IgKGNvbnN0IHsKICAgICAgZGljdAogICAgfSBvZiB0cmFuc2xhdGVkRm9udHMpIHsKICAgICAgZGVsZXRlIGRpY3QuY2FjaGVLZXk7CiAgICB9CgogICAgdGhpcy5mb250Q2FjaGUuY2xlYXIoKTsKICAgIHRoaXMuYnVpbHRJbkNNYXBDYWNoZS5jbGVhcigpOwogICAgdGhpcy5zdGFuZGFyZEZvbnREYXRhQ2FjaGUuY2xlYXIoKTsKICB9CgogIGFzeW5jIGdldFBhZ2VEaWN0KHBhZ2VJbmRleCkgewogICAgY29uc3Qgbm9kZXNUb1Zpc2l0ID0gW3RoaXMudG9wbGV2ZWxQYWdlc0RpY3RdOwogICAgY29uc3QgdmlzaXRlZE5vZGVzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwoKICAgIGNvbnN0IHBhZ2VzUmVmID0gdGhpcy5fY2F0RGljdC5nZXRSYXcoIlBhZ2VzIik7CgogICAgaWYgKHBhZ2VzUmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgIHZpc2l0ZWROb2Rlcy5wdXQocGFnZXNSZWYpOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWYsCiAgICAgICAgICBwYWdlS2lkc0NvdW50Q2FjaGUgPSB0aGlzLnBhZ2VLaWRzQ291bnRDYWNoZSwKICAgICAgICAgIHBhZ2VJbmRleENhY2hlID0gdGhpcy5wYWdlSW5kZXhDYWNoZTsKICAgIGxldCBjdXJyZW50UGFnZUluZGV4ID0gMDsKCiAgICB3aGlsZSAobm9kZXNUb1Zpc2l0Lmxlbmd0aCkgewogICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IG5vZGVzVG9WaXNpdC5wb3AoKTsKCiAgICAgIGlmIChjdXJyZW50Tm9kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIGNvbnN0IGNvdW50ID0gcGFnZUtpZHNDb3VudENhY2hlLmdldChjdXJyZW50Tm9kZSk7CgogICAgICAgIGlmIChjb3VudCA+PSAwICYmIGN1cnJlbnRQYWdlSW5kZXggKyBjb3VudCA8PSBwYWdlSW5kZXgpIHsKICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXggKz0gY291bnQ7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICh2aXNpdGVkTm9kZXMuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlcyB0cmVlIGNvbnRhaW5zIGNpcmN1bGFyIHJlZmVyZW5jZS4iKTsKICAgICAgICB9CgogICAgICAgIHZpc2l0ZWROb2Rlcy5wdXQoY3VycmVudE5vZGUpOwogICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyhjdXJyZW50Tm9kZSk7CgogICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICBsZXQgdHlwZSA9IG9iai5nZXRSYXcoIlR5cGUiKTsKCiAgICAgICAgICBpZiAodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICB0eXBlID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKHR5cGUpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0eXBlLCAiUGFnZSIpIHx8ICFvYmouaGFzKCJLaWRzIikpIHsKICAgICAgICAgICAgaWYgKCFwYWdlS2lkc0NvdW50Q2FjaGUuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgICAgIHBhZ2VLaWRzQ291bnRDYWNoZS5wdXQoY3VycmVudE5vZGUsIDEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXBhZ2VJbmRleENhY2hlLmhhcyhjdXJyZW50Tm9kZSkpIHsKICAgICAgICAgICAgICBwYWdlSW5kZXhDYWNoZS5wdXQoY3VycmVudE5vZGUsIGN1cnJlbnRQYWdlSW5kZXgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY3VycmVudFBhZ2VJbmRleCA9PT0gcGFnZUluZGV4KSB7CiAgICAgICAgICAgICAgcmV0dXJuIFtvYmosIGN1cnJlbnROb2RlXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VycmVudFBhZ2VJbmRleCsrOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG5vZGVzVG9WaXNpdC5wdXNoKG9iaik7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghKGN1cnJlbnROb2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2UgZGljdGlvbmFyeSBraWQgcmVmZXJlbmNlIHBvaW50cyB0byB3cm9uZyB0eXBlIG9mIG9iamVjdC4iKTsKICAgICAgfQoKICAgICAgY29uc3QgewogICAgICAgIG9iaklkCiAgICAgIH0gPSBjdXJyZW50Tm9kZTsKICAgICAgbGV0IGNvdW50ID0gY3VycmVudE5vZGUuZ2V0UmF3KCJDb3VudCIpOwoKICAgICAgaWYgKGNvdW50IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgY291bnQgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmMoY291bnQpOwogICAgICB9CgogICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihjb3VudCkgJiYgY291bnQgPj0gMCkgewogICAgICAgIGlmIChvYmpJZCAmJiAhcGFnZUtpZHNDb3VudENhY2hlLmhhcyhvYmpJZCkpIHsKICAgICAgICAgIHBhZ2VLaWRzQ291bnRDYWNoZS5wdXQob2JqSWQsIGNvdW50KTsKICAgICAgICB9CgogICAgICAgIGlmIChjdXJyZW50UGFnZUluZGV4ICsgY291bnQgPD0gcGFnZUluZGV4KSB7CiAgICAgICAgICBjdXJyZW50UGFnZUluZGV4ICs9IGNvdW50OwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBsZXQga2lkcyA9IGN1cnJlbnROb2RlLmdldFJhdygiS2lkcyIpOwoKICAgICAgaWYgKGtpZHMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBraWRzID0gYXdhaXQgeHJlZi5mZXRjaEFzeW5jKGtpZHMpOwogICAgICB9CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoa2lkcykpIHsKICAgICAgICBsZXQgdHlwZSA9IGN1cnJlbnROb2RlLmdldFJhdygiVHlwZSIpOwoKICAgICAgICBpZiAodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgdHlwZSA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyh0eXBlKTsKICAgICAgICB9CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0eXBlLCAiUGFnZSIpIHx8ICFjdXJyZW50Tm9kZS5oYXMoIktpZHMiKSkgewogICAgICAgICAgaWYgKGN1cnJlbnRQYWdlSW5kZXggPT09IHBhZ2VJbmRleCkgewogICAgICAgICAgICByZXR1cm4gW2N1cnJlbnROb2RlLCBudWxsXTsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50UGFnZUluZGV4Kys7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBkaWN0aW9uYXJ5IGtpZHMgb2JqZWN0IGlzIG5vdCBhbiBhcnJheS4iKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgbGFzdCA9IGtpZHMubGVuZ3RoIC0gMTsgbGFzdCA+PSAwOyBsYXN0LS0pIHsKICAgICAgICBub2Rlc1RvVmlzaXQucHVzaChraWRzW2xhc3RdKTsKICAgICAgfQogICAgfQoKICAgIHRocm93IG5ldyBFcnJvcihgUGFnZSBpbmRleCAke3BhZ2VJbmRleH0gbm90IGZvdW5kLmApOwogIH0KCiAgYXN5bmMgZ2V0QWxsUGFnZURpY3RzKHJlY292ZXJ5TW9kZSA9IGZhbHNlKSB7CiAgICBjb25zdCBxdWV1ZSA9IFt7CiAgICAgIGN1cnJlbnROb2RlOiB0aGlzLnRvcGxldmVsUGFnZXNEaWN0LAogICAgICBwb3NJbktpZHM6IDAKICAgIH1dOwogICAgY29uc3QgdmlzaXRlZE5vZGVzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwoKICAgIGNvbnN0IHBhZ2VzUmVmID0gdGhpcy5fY2F0RGljdC5nZXRSYXcoIlBhZ2VzIik7CgogICAgaWYgKHBhZ2VzUmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgIHZpc2l0ZWROb2Rlcy5wdXQocGFnZXNSZWYpOwogICAgfQoKICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKSwKICAgICAgICAgIHhyZWYgPSB0aGlzLnhyZWYsCiAgICAgICAgICBwYWdlSW5kZXhDYWNoZSA9IHRoaXMucGFnZUluZGV4Q2FjaGU7CiAgICBsZXQgcGFnZUluZGV4ID0gMDsKCiAgICBmdW5jdGlvbiBhZGRQYWdlRGljdChwYWdlRGljdCwgcGFnZVJlZikgewogICAgICBpZiAocGFnZVJlZiAmJiAhcGFnZUluZGV4Q2FjaGUuaGFzKHBhZ2VSZWYpKSB7CiAgICAgICAgcGFnZUluZGV4Q2FjaGUucHV0KHBhZ2VSZWYsIHBhZ2VJbmRleCk7CiAgICAgIH0KCiAgICAgIG1hcC5zZXQocGFnZUluZGV4KyssIFtwYWdlRGljdCwgcGFnZVJlZl0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFBhZ2VFcnJvcihlcnJvcikgewogICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24gJiYgIXJlY292ZXJ5TW9kZSkgewogICAgICAgIHRocm93IGVycm9yOwogICAgICB9CgogICAgICBtYXAuc2V0KHBhZ2VJbmRleCsrLCBbZXJyb3IsIG51bGxdKTsKICAgIH0KCiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBxdWV1ZUl0ZW0gPSBxdWV1ZS5hdCgtMSk7CiAgICAgIGNvbnN0IHsKICAgICAgICBjdXJyZW50Tm9kZSwKICAgICAgICBwb3NJbktpZHMKICAgICAgfSA9IHF1ZXVlSXRlbTsKICAgICAgbGV0IGtpZHMgPSBjdXJyZW50Tm9kZS5nZXRSYXcoIktpZHMiKTsKCiAgICAgIGlmIChraWRzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGtpZHMgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmMoa2lkcyk7CiAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgIGFkZFBhZ2VFcnJvcihleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghQXJyYXkuaXNBcnJheShraWRzKSkgewogICAgICAgIGFkZFBhZ2VFcnJvcihuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2UgZGljdGlvbmFyeSBraWRzIG9iamVjdCBpcyBub3QgYW4gYXJyYXkuIikpOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAocG9zSW5LaWRzID49IGtpZHMubGVuZ3RoKSB7CiAgICAgICAgcXVldWUucG9wKCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGtpZE9iaiA9IGtpZHNbcG9zSW5LaWRzXTsKICAgICAgbGV0IG9iajsKCiAgICAgIGlmIChraWRPYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBpZiAodmlzaXRlZE5vZGVzLmhhcyhraWRPYmopKSB7CiAgICAgICAgICBhZGRQYWdlRXJyb3IobmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlcyB0cmVlIGNvbnRhaW5zIGNpcmN1bGFyIHJlZmVyZW5jZS4iKSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHZpc2l0ZWROb2Rlcy5wdXQoa2lkT2JqKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIG9iaiA9IGF3YWl0IHhyZWYuZmV0Y2hBc3luYyhraWRPYmopOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICBhZGRQYWdlRXJyb3IoZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIG9iaiA9IGtpZE9iajsKICAgICAgfQoKICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICBhZGRQYWdlRXJyb3IobmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlIGRpY3Rpb25hcnkga2lkIHJlZmVyZW5jZSBwb2ludHMgdG8gd3JvbmcgdHlwZSBvZiBvYmplY3QuIikpOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZXQgdHlwZSA9IG9iai5nZXRSYXcoIlR5cGUiKTsKCiAgICAgIGlmICh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHR5cGUgPSBhd2FpdCB4cmVmLmZldGNoQXN5bmModHlwZSk7CiAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgIGFkZFBhZ2VFcnJvcihleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0eXBlLCAiUGFnZSIpIHx8ICFvYmouaGFzKCJLaWRzIikpIHsKICAgICAgICBhZGRQYWdlRGljdChvYmosIGtpZE9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IGtpZE9iaiA6IG51bGwpOwogICAgICB9IGVsc2UgewogICAgICAgIHF1ZXVlLnB1c2goewogICAgICAgICAgY3VycmVudE5vZGU6IG9iaiwKICAgICAgICAgIHBvc0luS2lkczogMAogICAgICAgIH0pOwogICAgICB9CgogICAgICBxdWV1ZUl0ZW0ucG9zSW5LaWRzKys7CiAgICB9CgogICAgcmV0dXJuIG1hcDsKICB9CgogIGdldFBhZ2VJbmRleChwYWdlUmVmKSB7CiAgICBjb25zdCBjYWNoZWRQYWdlSW5kZXggPSB0aGlzLnBhZ2VJbmRleENhY2hlLmdldChwYWdlUmVmKTsKCiAgICBpZiAoY2FjaGVkUGFnZUluZGV4ICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjYWNoZWRQYWdlSW5kZXgpOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWY7CgogICAgZnVuY3Rpb24gcGFnZXNCZWZvcmVSZWYoa2lkUmVmKSB7CiAgICAgIGxldCB0b3RhbCA9IDAsCiAgICAgICAgICBwYXJlbnRSZWY7CiAgICAgIHJldHVybiB4cmVmLmZldGNoQXN5bmMoa2lkUmVmKS50aGVuKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1JlZnNFcXVhbCkoa2lkUmVmLCBwYWdlUmVmKSAmJiAhKDAsIF9wcmltaXRpdmVzLmlzRGljdCkobm9kZSwgIlBhZ2UiKSAmJiAhKG5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmICFub2RlLmhhcygiVHlwZSIpICYmIG5vZGUuaGFzKCJDb250ZW50cyIpKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUaGUgcmVmZXJlbmNlIGRvZXMgbm90IHBvaW50IHRvIGEgL1BhZ2UgZGljdGlvbmFyeS4iKTsKICAgICAgICB9CgogICAgICAgIGlmICghbm9kZSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm9kZSBtdXN0IGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgICB9CgogICAgICAgIHBhcmVudFJlZiA9IG5vZGUuZ2V0UmF3KCJQYXJlbnQiKTsKICAgICAgICByZXR1cm4gbm9kZS5nZXRBc3luYygiUGFyZW50Iik7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHBhcmVudCkgewogICAgICAgIGlmICghcGFyZW50KSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICghKHBhcmVudCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhcmVudCBtdXN0IGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwYXJlbnQuZ2V0QXN5bmMoIktpZHMiKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAoa2lkcykgewogICAgICAgIGlmICgha2lkcykgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBraWRQcm9taXNlcyA9IFtdOwogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwoKICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBraWRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGtpZCA9IGtpZHNbaV07CgogICAgICAgICAgaWYgKCEoa2lkIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIktpZCBtdXN0IGJlIGEgcmVmZXJlbmNlLiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNSZWZzRXF1YWwpKGtpZCwga2lkUmVmKSkgewogICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGtpZFByb21pc2VzLnB1c2goeHJlZi5mZXRjaEFzeW5jKGtpZCkudGhlbihmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJLaWQgbm9kZSBtdXN0IGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG9iai5oYXMoIkNvdW50IikpIHsKICAgICAgICAgICAgICB0b3RhbCArPSBvYmouZ2V0KCJDb3VudCIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRvdGFsKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKTsKICAgICAgICB9CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiS2lkIHJlZmVyZW5jZSBub3QgZm91bmQgaW4gcGFyZW50J3Mga2lkcy4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBQcm9taXNlLmFsbChraWRQcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3RvdGFsLCBwYXJlbnRSZWZdOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICBsZXQgdG90YWwgPSAwOwoKICAgIGNvbnN0IG5leHQgPSByZWYgPT4gcGFnZXNCZWZvcmVSZWYocmVmKS50aGVuKGFyZ3MgPT4gewogICAgICBpZiAoIWFyZ3MpIHsKICAgICAgICB0aGlzLnBhZ2VJbmRleENhY2hlLnB1dChwYWdlUmVmLCB0b3RhbCk7CiAgICAgICAgcmV0dXJuIHRvdGFsOwogICAgICB9CgogICAgICBjb25zdCBbY291bnQsIHBhcmVudFJlZl0gPSBhcmdzOwogICAgICB0b3RhbCArPSBjb3VudDsKICAgICAgcmV0dXJuIG5leHQocGFyZW50UmVmKTsKICAgIH0pOwoKICAgIHJldHVybiBuZXh0KHBhZ2VSZWYpOwogIH0KCiAgZ2V0IGJhc2VVcmwoKSB7CiAgICBjb25zdCB1cmkgPSB0aGlzLl9jYXREaWN0LmdldCgiVVJJIik7CgogICAgaWYgKHVyaSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgYmFzZSA9IHVyaS5nZXQoIkJhc2UiKTsKCiAgICAgIGlmICh0eXBlb2YgYmFzZSA9PT0gInN0cmluZyIpIHsKICAgICAgICBjb25zdCBhYnNvbHV0ZVVybCA9ICgwLCBfdXRpbC5jcmVhdGVWYWxpZEFic29sdXRlVXJsKShiYXNlLCBudWxsLCB7CiAgICAgICAgICB0cnlDb252ZXJ0RW5jb2Rpbmc6IHRydWUKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGFic29sdXRlVXJsKSB7CiAgICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImJhc2VVcmwiLCBhYnNvbHV0ZVVybC5ocmVmKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImJhc2VVcmwiLCBudWxsKTsKICB9CgogIHN0YXRpYyBwYXJzZURlc3REaWN0aW9uYXJ5KHBhcmFtcykgewogICAgY29uc3QgZGVzdERpY3QgPSBwYXJhbXMuZGVzdERpY3Q7CgogICAgaWYgKCEoZGVzdERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlRGVzdERpY3Rpb25hcnk6IGBkZXN0RGljdGAgbXVzdCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCByZXN1bHRPYmogPSBwYXJhbXMucmVzdWx0T2JqOwoKICAgIGlmICh0eXBlb2YgcmVzdWx0T2JqICE9PSAib2JqZWN0IikgewogICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlRGVzdERpY3Rpb25hcnk6IGByZXN1bHRPYmpgIG11c3QgYmUgYW4gb2JqZWN0LiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZG9jQmFzZVVybCA9IHBhcmFtcy5kb2NCYXNlVXJsIHx8IG51bGw7CiAgICBsZXQgYWN0aW9uID0gZGVzdERpY3QuZ2V0KCJBIiksCiAgICAgICAgdXJsLAogICAgICAgIGRlc3Q7CgogICAgaWYgKCEoYWN0aW9uIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgaWYgKGRlc3REaWN0LmhhcygiRGVzdCIpKSB7CiAgICAgICAgYWN0aW9uID0gZGVzdERpY3QuZ2V0KCJEZXN0Iik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aW9uID0gZGVzdERpY3QuZ2V0KCJBQSIpOwoKICAgICAgICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgICAgaWYgKGFjdGlvbi5oYXMoIkQiKSkgewogICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb24uZ2V0KCJEIik7CiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5oYXMoIlUiKSkgewogICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb24uZ2V0KCJVIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgY29uc3QgYWN0aW9uVHlwZSA9IGFjdGlvbi5nZXQoIlMiKTsKCiAgICAgIGlmICghKGFjdGlvblR5cGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VEZXN0RGljdGlvbmFyeTogSW52YWxpZCB0eXBlIGluIEFjdGlvbiBkaWN0aW9uYXJ5LiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgYWN0aW9uTmFtZSA9IGFjdGlvblR5cGUubmFtZTsKCiAgICAgIHN3aXRjaCAoYWN0aW9uTmFtZSkgewogICAgICAgIGNhc2UgIlJlc2V0Rm9ybSI6CiAgICAgICAgICBjb25zdCBmbGFncyA9IGFjdGlvbi5nZXQoIkZsYWdzIik7CiAgICAgICAgICBjb25zdCBpbmNsdWRlID0gKCh0eXBlb2YgZmxhZ3MgPT09ICJudW1iZXIiID8gZmxhZ3MgOiAwKSAmIDEpID09PSAwOwogICAgICAgICAgY29uc3QgZmllbGRzID0gW107CiAgICAgICAgICBjb25zdCByZWZzID0gW107CgogICAgICAgICAgZm9yIChjb25zdCBvYmogb2YgYWN0aW9uLmdldCgiRmllbGRzIikgfHwgW10pIHsKICAgICAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgIHJlZnMucHVzaChvYmoudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBmaWVsZHMucHVzaCgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKG9iaikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmVzdWx0T2JqLnJlc2V0Rm9ybSA9IHsKICAgICAgICAgICAgZmllbGRzLAogICAgICAgICAgICByZWZzLAogICAgICAgICAgICBpbmNsdWRlCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlVSSSI6CiAgICAgICAgICB1cmwgPSBhY3Rpb24uZ2V0KCJVUkkiKTsKCiAgICAgICAgICBpZiAodXJsIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICB1cmwgPSAiLyIgKyB1cmwubmFtZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiR29UbyI6CiAgICAgICAgICBkZXN0ID0gYWN0aW9uLmdldCgiRCIpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkxhdW5jaCI6CiAgICAgICAgY2FzZSAiR29Ub1IiOgogICAgICAgICAgY29uc3QgdXJsRGljdCA9IGFjdGlvbi5nZXQoIkYiKTsKCiAgICAgICAgICBpZiAodXJsRGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgICAgdXJsID0gdXJsRGljdC5nZXQoIkYiKSB8fCBudWxsOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdXJsRGljdCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgdXJsID0gdXJsRGljdDsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcmVtb3RlRGVzdCA9IGFjdGlvbi5nZXQoIkQiKTsKCiAgICAgICAgICBpZiAocmVtb3RlRGVzdCkgewogICAgICAgICAgICBpZiAocmVtb3RlRGVzdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICAgICAgICByZW1vdGVEZXN0ID0gcmVtb3RlRGVzdC5uYW1lOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIHVybCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBjb25zdCBiYXNlVXJsID0gdXJsLnNwbGl0KCIjIilbMF07CgogICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVtb3RlRGVzdCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmwgKyAiIyIgKyByZW1vdGVEZXN0OwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZW1vdGVEZXN0KSkgewogICAgICAgICAgICAgICAgdXJsID0gYmFzZVVybCArICIjIiArIEpTT04uc3RyaW5naWZ5KHJlbW90ZURlc3QpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IG5ld1dpbmRvdyA9IGFjdGlvbi5nZXQoIk5ld1dpbmRvdyIpOwoKICAgICAgICAgIGlmICh0eXBlb2YgbmV3V2luZG93ID09PSAiYm9vbGVhbiIpIHsKICAgICAgICAgICAgcmVzdWx0T2JqLm5ld1dpbmRvdyA9IG5ld1dpbmRvdzsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiTmFtZWQiOgogICAgICAgICAgY29uc3QgbmFtZWRBY3Rpb24gPSBhY3Rpb24uZ2V0KCJOIik7CgogICAgICAgICAgaWYgKG5hbWVkQWN0aW9uIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICByZXN1bHRPYmouYWN0aW9uID0gbmFtZWRBY3Rpb24ubmFtZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiSmF2YVNjcmlwdCI6CiAgICAgICAgICBjb25zdCBqc0FjdGlvbiA9IGFjdGlvbi5nZXQoIkpTIik7CiAgICAgICAgICBsZXQganM7CgogICAgICAgICAgaWYgKGpzQWN0aW9uIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICAgICAganMgPSBqc0FjdGlvbi5nZXRTdHJpbmcoKTsKICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGpzQWN0aW9uID09PSAic3RyaW5nIikgewogICAgICAgICAgICBqcyA9IGpzQWN0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IGpzVVJMID0ganMgJiYgKDAsIF9jb3JlX3V0aWxzLnJlY292ZXJKc1VSTCkoKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShqcykpOwoKICAgICAgICAgIGlmIChqc1VSTCkgewogICAgICAgICAgICB1cmwgPSBqc1VSTC51cmw7CiAgICAgICAgICAgIHJlc3VsdE9iai5uZXdXaW5kb3cgPSBqc1VSTC5uZXdXaW5kb3c7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgaWYgKGFjdGlvbk5hbWUgPT09ICJKYXZhU2NyaXB0IiB8fCBhY3Rpb25OYW1lID09PSAiU3VibWl0Rm9ybSIpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBwYXJzZURlc3REaWN0aW9uYXJ5IC0gdW5zdXBwb3J0ZWQgYWN0aW9uOiAiJHthY3Rpb25OYW1lfSIuYCk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfSBlbHNlIGlmIChkZXN0RGljdC5oYXMoIkRlc3QiKSkgewogICAgICBkZXN0ID0gZGVzdERpY3QuZ2V0KCJEZXN0Iik7CiAgICB9CgogICAgaWYgKHR5cGVvZiB1cmwgPT09ICJzdHJpbmciKSB7CiAgICAgIGNvbnN0IGFic29sdXRlVXJsID0gKDAsIF91dGlsLmNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwpKHVybCwgZG9jQmFzZVVybCwgewogICAgICAgIGFkZERlZmF1bHRQcm90b2NvbDogdHJ1ZSwKICAgICAgICB0cnlDb252ZXJ0RW5jb2Rpbmc6IHRydWUKICAgICAgfSk7CgogICAgICBpZiAoYWJzb2x1dGVVcmwpIHsKICAgICAgICByZXN1bHRPYmoudXJsID0gYWJzb2x1dGVVcmwuaHJlZjsKICAgICAgfQoKICAgICAgcmVzdWx0T2JqLnVuc2FmZVVybCA9IHVybDsKICAgIH0KCiAgICBpZiAoZGVzdCkgewogICAgICBpZiAoZGVzdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLk5hbWUpIHsKICAgICAgICBkZXN0ID0gZGVzdC5uYW1lOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGRlc3QgPT09ICJzdHJpbmciKSB7CiAgICAgICAgcmVzdWx0T2JqLmRlc3QgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGRlc3QpOwogICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZGVzdCkpIHsKICAgICAgICByZXN1bHRPYmouZGVzdCA9IGRlc3Q7CiAgICAgIH0KICAgIH0KICB9Cgp9CgpleHBvcnRzLkNhdGFsb2cgPSBDYXRhbG9nOwoKLyoqKi8gfSksCi8qIDcwICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTnVtYmVyVHJlZSA9IGV4cG9ydHMuTmFtZVRyZWUgPSB2b2lkIDA7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIE5hbWVPck51bWJlclRyZWUgewogIGNvbnN0cnVjdG9yKHJvb3QsIHhyZWYsIHR5cGUpIHsKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBOYW1lT3JOdW1iZXJUcmVlKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIE5hbWVPck51bWJlclRyZWUuIik7CiAgICB9CgogICAgdGhpcy5yb290ID0gcm9vdDsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLl90eXBlID0gdHlwZTsKICB9CgogIGdldEFsbCgpIHsKICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsKCiAgICBpZiAoIXRoaXMucm9vdCkgewogICAgICByZXR1cm4gbWFwOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWY7CiAgICBjb25zdCBwcm9jZXNzZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CiAgICBwcm9jZXNzZWQucHV0KHRoaXMucm9vdCk7CiAgICBjb25zdCBxdWV1ZSA9IFt0aGlzLnJvb3RdOwoKICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IG9iaiA9IHhyZWYuZmV0Y2hJZlJlZihxdWV1ZS5zaGlmdCgpKTsKCiAgICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChvYmouaGFzKCJLaWRzIikpIHsKICAgICAgICBjb25zdCBraWRzID0gb2JqLmdldCgiS2lkcyIpOwoKICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoa2lkcykpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgZm9yIChjb25zdCBraWQgb2Yga2lkcykgewogICAgICAgICAgaWYgKHByb2Nlc3NlZC5oYXMoa2lkKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYER1cGxpY2F0ZSBlbnRyeSBpbiAiJHt0aGlzLl90eXBlfSIgdHJlZS5gKTsKICAgICAgICAgIH0KCiAgICAgICAgICBxdWV1ZS5wdXNoKGtpZCk7CiAgICAgICAgICBwcm9jZXNzZWQucHV0KGtpZCk7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgZW50cmllcyA9IG9iai5nZXQodGhpcy5fdHlwZSk7CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZW50cmllcykpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZW50cmllcy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgICAgbWFwLnNldCh4cmVmLmZldGNoSWZSZWYoZW50cmllc1tpXSksIHhyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW2kgKyAxXSkpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG1hcDsKICB9CgogIGdldChrZXkpIHsKICAgIGlmICghdGhpcy5yb290KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGNvbnN0IHhyZWYgPSB0aGlzLnhyZWY7CiAgICBsZXQga2lkc09yRW50cmllcyA9IHhyZWYuZmV0Y2hJZlJlZih0aGlzLnJvb3QpOwogICAgbGV0IGxvb3BDb3VudCA9IDA7CiAgICBjb25zdCBNQVhfTEVWRUxTID0gMTA7CgogICAgd2hpbGUgKGtpZHNPckVudHJpZXMuaGFzKCJLaWRzIikpIHsKICAgICAgaWYgKCsrbG9vcENvdW50ID4gTUFYX0xFVkVMUykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgU2VhcmNoIGRlcHRoIGxpbWl0IHJlYWNoZWQgZm9yICIke3RoaXMuX3R5cGV9IiB0cmVlLmApOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCBraWRzID0ga2lkc09yRW50cmllcy5nZXQoIktpZHMiKTsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheShraWRzKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBsZXQgbCA9IDAsCiAgICAgICAgICByID0ga2lkcy5sZW5ndGggLSAxOwoKICAgICAgd2hpbGUgKGwgPD0gcikgewogICAgICAgIGNvbnN0IG0gPSBsICsgciA+PiAxOwogICAgICAgIGNvbnN0IGtpZCA9IHhyZWYuZmV0Y2hJZlJlZihraWRzW21dKTsKICAgICAgICBjb25zdCBsaW1pdHMgPSBraWQuZ2V0KCJMaW1pdHMiKTsKCiAgICAgICAgaWYgKGtleSA8IHhyZWYuZmV0Y2hJZlJlZihsaW1pdHNbMF0pKSB7CiAgICAgICAgICByID0gbSAtIDE7CiAgICAgICAgfSBlbHNlIGlmIChrZXkgPiB4cmVmLmZldGNoSWZSZWYobGltaXRzWzFdKSkgewogICAgICAgICAgbCA9IG0gKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBraWRzT3JFbnRyaWVzID0ga2lkOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAobCA+IHIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGVudHJpZXMgPSBraWRzT3JFbnRyaWVzLmdldCh0aGlzLl90eXBlKTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyaWVzKSkgewogICAgICBsZXQgbCA9IDAsCiAgICAgICAgICByID0gZW50cmllcy5sZW5ndGggLSAyOwoKICAgICAgd2hpbGUgKGwgPD0gcikgewogICAgICAgIGNvbnN0IHRtcCA9IGwgKyByID4+IDEsCiAgICAgICAgICAgICAgbSA9IHRtcCArICh0bXAgJiAxKTsKICAgICAgICBjb25zdCBjdXJyZW50S2V5ID0geHJlZi5mZXRjaElmUmVmKGVudHJpZXNbbV0pOwoKICAgICAgICBpZiAoa2V5IDwgY3VycmVudEtleSkgewogICAgICAgICAgciA9IG0gLSAyOwogICAgICAgIH0gZWxzZSBpZiAoa2V5ID4gY3VycmVudEtleSkgewogICAgICAgICAgbCA9IG0gKyAyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4geHJlZi5mZXRjaElmUmVmKGVudHJpZXNbbSArIDFdKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9Cgp9CgpjbGFzcyBOYW1lVHJlZSBleHRlbmRzIE5hbWVPck51bWJlclRyZWUgewogIGNvbnN0cnVjdG9yKHJvb3QsIHhyZWYpIHsKICAgIHN1cGVyKHJvb3QsIHhyZWYsICJOYW1lcyIpOwogIH0KCn0KCmV4cG9ydHMuTmFtZVRyZWUgPSBOYW1lVHJlZTsKCmNsYXNzIE51bWJlclRyZWUgZXh0ZW5kcyBOYW1lT3JOdW1iZXJUcmVlIHsKICBjb25zdHJ1Y3Rvcihyb290LCB4cmVmKSB7CiAgICBzdXBlcihyb290LCB4cmVmLCAiTnVtcyIpOwogIH0KCn0KCmV4cG9ydHMuTnVtYmVyVHJlZSA9IE51bWJlclRyZWU7CgovKioqLyB9KSwKLyogNzEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5jbGVhckdsb2JhbENhY2hlcyA9IGNsZWFyR2xvYmFsQ2FjaGVzOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfdW5pY29kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDApOwoKZnVuY3Rpb24gY2xlYXJHbG9iYWxDYWNoZXMoKSB7CiAgKDAsIF9wcmltaXRpdmVzLmNsZWFyUHJpbWl0aXZlQ2FjaGVzKSgpOwogICgwLCBfdW5pY29kZS5jbGVhclVuaWNvZGVDYWNoZXMpKCk7Cn0KCi8qKiovIH0pLAovKiA3MiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkZpbGVTcGVjID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfYmFzZV9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCmZ1bmN0aW9uIHBpY2tQbGF0Zm9ybUl0ZW0oZGljdCkgewogIGlmIChkaWN0LmhhcygiVUYiKSkgewogICAgcmV0dXJuIGRpY3QuZ2V0KCJVRiIpOwogIH0gZWxzZSBpZiAoZGljdC5oYXMoIkYiKSkgewogICAgcmV0dXJuIGRpY3QuZ2V0KCJGIik7CiAgfSBlbHNlIGlmIChkaWN0LmhhcygiVW5peCIpKSB7CiAgICByZXR1cm4gZGljdC5nZXQoIlVuaXgiKTsKICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJNYWMiKSkgewogICAgcmV0dXJuIGRpY3QuZ2V0KCJNYWMiKTsKICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJET1MiKSkgewogICAgcmV0dXJuIGRpY3QuZ2V0KCJET1MiKTsKICB9CgogIHJldHVybiBudWxsOwp9CgpjbGFzcyBGaWxlU3BlYyB7CiAgY29uc3RydWN0b3Iocm9vdCwgeHJlZikgewogICAgaWYgKCEocm9vdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5yb290ID0gcm9vdDsKCiAgICBpZiAocm9vdC5oYXMoIkZTIikpIHsKICAgICAgdGhpcy5mcyA9IHJvb3QuZ2V0KCJGUyIpOwogICAgfQoKICAgIHRoaXMuZGVzY3JpcHRpb24gPSByb290LmhhcygiRGVzYyIpID8gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShyb290LmdldCgiRGVzYyIpKSA6ICIiOwoKICAgIGlmIChyb290LmhhcygiUkYiKSkgewogICAgICAoMCwgX3V0aWwud2FybikoIlJlbGF0ZWQgZmlsZSBzcGVjaWZpY2F0aW9ucyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgfQoKICAgIHRoaXMuY29udGVudEF2YWlsYWJsZSA9IHRydWU7CgogICAgaWYgKCFyb290LmhhcygiRUYiKSkgewogICAgICB0aGlzLmNvbnRlbnRBdmFpbGFibGUgPSBmYWxzZTsKICAgICAgKDAsIF91dGlsLndhcm4pKCJOb24tZW1iZWRkZWQgZmlsZSBzcGVjaWZpY2F0aW9ucyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgfQogIH0KCiAgZ2V0IGZpbGVuYW1lKCkgewogICAgaWYgKCF0aGlzLl9maWxlbmFtZSAmJiB0aGlzLnJvb3QpIHsKICAgICAgY29uc3QgZmlsZW5hbWUgPSBwaWNrUGxhdGZvcm1JdGVtKHRoaXMucm9vdCkgfHwgInVubmFtZWQiOwogICAgICB0aGlzLl9maWxlbmFtZSA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZmlsZW5hbWUpLnJlcGxhY2UoL1xcXFwvZywgIlxcIikucmVwbGFjZSgvXFxcLy9nLCAiLyIpLnJlcGxhY2UoL1xcL2csICIvIik7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuX2ZpbGVuYW1lOwogIH0KCiAgZ2V0IGNvbnRlbnQoKSB7CiAgICBpZiAoIXRoaXMuY29udGVudEF2YWlsYWJsZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAoIXRoaXMuY29udGVudFJlZiAmJiB0aGlzLnJvb3QpIHsKICAgICAgdGhpcy5jb250ZW50UmVmID0gcGlja1BsYXRmb3JtSXRlbSh0aGlzLnJvb3QuZ2V0KCJFRiIpKTsKICAgIH0KCiAgICBsZXQgY29udGVudCA9IG51bGw7CgogICAgaWYgKHRoaXMuY29udGVudFJlZikgewogICAgICBjb25zdCBmaWxlT2JqID0gdGhpcy54cmVmLmZldGNoSWZSZWYodGhpcy5jb250ZW50UmVmKTsKCiAgICAgIGlmIChmaWxlT2JqIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBjb250ZW50ID0gZmlsZU9iai5nZXRCeXRlcygpOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiRW1iZWRkZWQgZmlsZSBzcGVjaWZpY2F0aW9uIHBvaW50cyB0byBub24tZXhpc3RpbmcvaW52YWxpZCBjb250ZW50Iik7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiRW1iZWRkZWQgZmlsZSBzcGVjaWZpY2F0aW9uIGRvZXMgbm90IGhhdmUgYSBjb250ZW50Iik7CiAgICB9CgogICAgcmV0dXJuIGNvbnRlbnQ7CiAgfQoKICBnZXQgc2VyaWFsaXphYmxlKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsCiAgICAgIGNvbnRlbnQ6IHRoaXMuY29udGVudAogICAgfTsKICB9Cgp9CgpleHBvcnRzLkZpbGVTcGVjID0gRmlsZVNwZWM7CgovKioqLyB9KSwKLyogNzMgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5NZXRhZGF0YVBhcnNlciA9IHZvaWQgMDsKCnZhciBfeG1sX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNjYpOwoKY2xhc3MgTWV0YWRhdGFQYXJzZXIgewogIGNvbnN0cnVjdG9yKGRhdGEpIHsKICAgIGRhdGEgPSB0aGlzLl9yZXBhaXIoZGF0YSk7CiAgICBjb25zdCBwYXJzZXIgPSBuZXcgX3htbF9wYXJzZXIuU2ltcGxlWE1MUGFyc2VyKHsKICAgICAgbG93ZXJDYXNlTmFtZTogdHJ1ZQogICAgfSk7CiAgICBjb25zdCB4bWxEb2N1bWVudCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoZGF0YSk7CiAgICB0aGlzLl9tZXRhZGF0YU1hcCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX2RhdGEgPSBkYXRhOwoKICAgIGlmICh4bWxEb2N1bWVudCkgewogICAgICB0aGlzLl9wYXJzZSh4bWxEb2N1bWVudCk7CiAgICB9CiAgfQoKICBfcmVwYWlyKGRhdGEpIHsKICAgIHJldHVybiBkYXRhLnJlcGxhY2UoL15bXjxdKy8sICIiKS5yZXBsYWNlKC8+XFwzNzZcXDM3NyhbXjxdKykvZywgZnVuY3Rpb24gKGFsbCwgY29kZXMpIHsKICAgICAgY29uc3QgYnl0ZXMgPSBjb2Rlcy5yZXBsYWNlKC9cXChbMC0zXSkoWzAtN10pKFswLTddKS9nLCBmdW5jdGlvbiAoY29kZSwgZDEsIGQyLCBkMykgewogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGQxICogNjQgKyBkMiAqIDggKyBkMyAqIDEpOwogICAgICB9KS5yZXBsYWNlKC8mKGFtcHxhcG9zfGd0fGx0fHF1b3QpOy9nLCBmdW5jdGlvbiAoc3RyLCBuYW1lKSB7CiAgICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgICBjYXNlICJhbXAiOgogICAgICAgICAgICByZXR1cm4gIiYiOwoKICAgICAgICAgIGNhc2UgImFwb3MiOgogICAgICAgICAgICByZXR1cm4gIiciOwoKICAgICAgICAgIGNhc2UgImd0IjoKICAgICAgICAgICAgcmV0dXJuICI+IjsKCiAgICAgICAgICBjYXNlICJsdCI6CiAgICAgICAgICAgIHJldHVybiAiPCI7CgogICAgICAgICAgY2FzZSAicXVvdCI6CiAgICAgICAgICAgIHJldHVybiAnIic7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYF9yZXBhaXI6ICR7bmFtZX0gaXNuJ3QgZGVmaW5lZC5gKTsKICAgICAgfSk7CiAgICAgIGNvbnN0IGNoYXJCdWYgPSBbXTsKCiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGJ5dGVzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgICBjb25zdCBjb2RlID0gYnl0ZXMuY2hhckNvZGVBdChpKSAqIDI1NiArIGJ5dGVzLmNoYXJDb2RlQXQoaSArIDEpOwoKICAgICAgICBpZiAoY29kZSA+PSAzMiAmJiBjb2RlIDwgMTI3ICYmIGNvZGUgIT09IDYwICYmIGNvZGUgIT09IDYyICYmIGNvZGUgIT09IDM4KSB7CiAgICAgICAgICBjaGFyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYXJCdWYucHVzaCgiJiN4IiArICgweDEwMDAwICsgY29kZSkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKSArICI7Iik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gIj4iICsgY2hhckJ1Zi5qb2luKCIiKTsKICAgIH0pOwogIH0KCiAgX2dldFNlcXVlbmNlKGVudHJ5KSB7CiAgICBjb25zdCBuYW1lID0gZW50cnkubm9kZU5hbWU7CgogICAgaWYgKG5hbWUgIT09ICJyZGY6YmFnIiAmJiBuYW1lICE9PSAicmRmOnNlcSIgJiYgbmFtZSAhPT0gInJkZjphbHQiKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiBlbnRyeS5jaGlsZE5vZGVzLmZpbHRlcihub2RlID0+IG5vZGUubm9kZU5hbWUgPT09ICJyZGY6bGkiKTsKICB9CgogIF9wYXJzZUFycmF5KGVudHJ5KSB7CiAgICBpZiAoIWVudHJ5Lmhhc0NoaWxkTm9kZXMoKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgW3NlcU5vZGVdID0gZW50cnkuY2hpbGROb2RlczsKICAgIGNvbnN0IHNlcXVlbmNlID0gdGhpcy5fZ2V0U2VxdWVuY2Uoc2VxTm9kZSkgfHwgW107CgogICAgdGhpcy5fbWV0YWRhdGFNYXAuc2V0KGVudHJ5Lm5vZGVOYW1lLCBzZXF1ZW5jZS5tYXAobm9kZSA9PiBub2RlLnRleHRDb250ZW50LnRyaW0oKSkpOwogIH0KCiAgX3BhcnNlKHhtbERvY3VtZW50KSB7CiAgICBsZXQgcmRmID0geG1sRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKICAgIGlmIChyZGYubm9kZU5hbWUgIT09ICJyZGY6cmRmIikgewogICAgICByZGYgPSByZGYuZmlyc3RDaGlsZDsKCiAgICAgIHdoaWxlIChyZGYgJiYgcmRmLm5vZGVOYW1lICE9PSAicmRmOnJkZiIpIHsKICAgICAgICByZGYgPSByZGYubmV4dFNpYmxpbmc7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXJkZiB8fCByZGYubm9kZU5hbWUgIT09ICJyZGY6cmRmIiB8fCAhcmRmLmhhc0NoaWxkTm9kZXMoKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBkZXNjIG9mIHJkZi5jaGlsZE5vZGVzKSB7CiAgICAgIGlmIChkZXNjLm5vZGVOYW1lICE9PSAicmRmOmRlc2NyaXB0aW9uIikgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRlc2MuY2hpbGROb2RlcykgewogICAgICAgIGNvbnN0IG5hbWUgPSBlbnRyeS5ub2RlTmFtZTsKCiAgICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgICBjYXNlICIjdGV4dCI6CiAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgIGNhc2UgImRjOmNyZWF0b3IiOgogICAgICAgICAgY2FzZSAiZGM6c3ViamVjdCI6CiAgICAgICAgICAgIHRoaXMuX3BhcnNlQXJyYXkoZW50cnkpOwoKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9tZXRhZGF0YU1hcC5zZXQobmFtZSwgZW50cnkudGV4dENvbnRlbnQudHJpbSgpKTsKICAgICAgfQogICAgfQogIH0KCiAgZ2V0IHNlcmlhbGl6YWJsZSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhcnNlZERhdGE6IHRoaXMuX21ldGFkYXRhTWFwLAogICAgICByYXdEYXRhOiB0aGlzLl9kYXRhCiAgICB9OwogIH0KCn0KCmV4cG9ydHMuTWV0YWRhdGFQYXJzZXIgPSBNZXRhZGF0YVBhcnNlcjsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlN0cnVjdFRyZWVSb290ID0gZXhwb3J0cy5TdHJ1Y3RUcmVlUGFnZSA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9uYW1lX251bWJlcl90cmVlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3MCk7Cgpjb25zdCBNQVhfREVQVEggPSA0MDsKY29uc3QgU3RydWN0RWxlbWVudFR5cGUgPSB7CiAgUEFHRV9DT05URU5UOiAiUEFHRV9DT05URU5UIiwKICBTVFJFQU1fQ09OVEVOVDogIlNUUkVBTV9DT05URU5UIiwKICBPQkpFQ1Q6ICJPQkpFQ1QiLAogIEVMRU1FTlQ6ICJFTEVNRU5UIgp9OwoKY2xhc3MgU3RydWN0VHJlZVJvb3QgewogIGNvbnN0cnVjdG9yKHJvb3REaWN0KSB7CiAgICB0aGlzLmRpY3QgPSByb290RGljdDsKICAgIHRoaXMucm9sZU1hcCA9IG5ldyBNYXAoKTsKICB9CgogIGluaXQoKSB7CiAgICB0aGlzLnJlYWRSb2xlTWFwKCk7CiAgfQoKICByZWFkUm9sZU1hcCgpIHsKICAgIGNvbnN0IHJvbGVNYXBEaWN0ID0gdGhpcy5kaWN0LmdldCgiUm9sZU1hcCIpOwoKICAgIGlmICghKHJvbGVNYXBEaWN0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJvbGVNYXBEaWN0LmZvckVhY2goKGtleSwgdmFsdWUpID0+IHsKICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5yb2xlTWFwLnNldChrZXksIHZhbHVlLm5hbWUpOwogICAgfSk7CiAgfQoKfQoKZXhwb3J0cy5TdHJ1Y3RUcmVlUm9vdCA9IFN0cnVjdFRyZWVSb290OwoKY2xhc3MgU3RydWN0RWxlbWVudE5vZGUgewogIGNvbnN0cnVjdG9yKHRyZWUsIGRpY3QpIHsKICAgIHRoaXMudHJlZSA9IHRyZWU7CiAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgdGhpcy5raWRzID0gW107CiAgICB0aGlzLnBhcnNlS2lkcygpOwogIH0KCiAgZ2V0IHJvbGUoKSB7CiAgICBjb25zdCBuYW1lT2JqID0gdGhpcy5kaWN0LmdldCgiUyIpOwogICAgY29uc3QgbmFtZSA9IG5hbWVPYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lID8gbmFtZU9iai5uYW1lIDogIiI7CiAgICBjb25zdCB7CiAgICAgIHJvb3QKICAgIH0gPSB0aGlzLnRyZWU7CgogICAgaWYgKHJvb3Qucm9sZU1hcC5oYXMobmFtZSkpIHsKICAgICAgcmV0dXJuIHJvb3Qucm9sZU1hcC5nZXQobmFtZSk7CiAgICB9CgogICAgcmV0dXJuIG5hbWU7CiAgfQoKICBwYXJzZUtpZHMoKSB7CiAgICBsZXQgcGFnZU9iaklkID0gbnVsbDsKICAgIGNvbnN0IG9ialJlZiA9IHRoaXMuZGljdC5nZXRSYXcoIlBnIik7CgogICAgaWYgKG9ialJlZiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBwYWdlT2JqSWQgPSBvYmpSZWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBjb25zdCBraWRzID0gdGhpcy5kaWN0LmdldCgiSyIpOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGtpZHMpKSB7CiAgICAgIGZvciAoY29uc3Qga2lkIG9mIGtpZHMpIHsKICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5wYXJzZUtpZChwYWdlT2JqSWQsIGtpZCk7CgogICAgICAgIGlmIChlbGVtZW50KSB7CiAgICAgICAgICB0aGlzLmtpZHMucHVzaChlbGVtZW50KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnBhcnNlS2lkKHBhZ2VPYmpJZCwga2lkcyk7CgogICAgICBpZiAoZWxlbWVudCkgewogICAgICAgIHRoaXMua2lkcy5wdXNoKGVsZW1lbnQpOwogICAgICB9CiAgICB9CiAgfQoKICBwYXJzZUtpZChwYWdlT2JqSWQsIGtpZCkgewogICAgaWYgKE51bWJlci5pc0ludGVnZXIoa2lkKSkgewogICAgICBpZiAodGhpcy50cmVlLnBhZ2VEaWN0Lm9iaklkICE9PSBwYWdlT2JqSWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgICB0eXBlOiBTdHJ1Y3RFbGVtZW50VHlwZS5QQUdFX0NPTlRFTlQsCiAgICAgICAgbWNpZDoga2lkLAogICAgICAgIHBhZ2VPYmpJZAogICAgICB9KTsKICAgIH0KCiAgICBsZXQga2lkRGljdCA9IG51bGw7CgogICAgaWYgKGtpZCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICBraWREaWN0ID0gdGhpcy5kaWN0LnhyZWYuZmV0Y2goa2lkKTsKICAgIH0gZWxzZSBpZiAoa2lkIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBraWREaWN0ID0ga2lkOwogICAgfQoKICAgIGlmICgha2lkRGljdCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBjb25zdCBwYWdlUmVmID0ga2lkRGljdC5nZXRSYXcoIlBnIik7CgogICAgaWYgKHBhZ2VSZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgcGFnZU9iaklkID0gcGFnZVJlZi50b1N0cmluZygpOwogICAgfQoKICAgIGNvbnN0IHR5cGUgPSBraWREaWN0LmdldCgiVHlwZSIpIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSA/IGtpZERpY3QuZ2V0KCJUeXBlIikubmFtZSA6IG51bGw7CgogICAgaWYgKHR5cGUgPT09ICJNQ1IiKSB7CiAgICAgIGlmICh0aGlzLnRyZWUucGFnZURpY3Qub2JqSWQgIT09IHBhZ2VPYmpJZCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFN0cnVjdEVsZW1lbnQoewogICAgICAgIHR5cGU6IFN0cnVjdEVsZW1lbnRUeXBlLlNUUkVBTV9DT05URU5ULAogICAgICAgIHJlZk9iaklkOiBraWREaWN0LmdldFJhdygiU3RtIikgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYgPyBraWREaWN0LmdldFJhdygiU3RtIikudG9TdHJpbmcoKSA6IG51bGwsCiAgICAgICAgcGFnZU9iaklkLAogICAgICAgIG1jaWQ6IGtpZERpY3QuZ2V0KCJNQ0lEIikKICAgICAgfSk7CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICJPQkpSIikgewogICAgICBpZiAodGhpcy50cmVlLnBhZ2VEaWN0Lm9iaklkICE9PSBwYWdlT2JqSWQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgICB0eXBlOiBTdHJ1Y3RFbGVtZW50VHlwZS5PQkpFQ1QsCiAgICAgICAgcmVmT2JqSWQ6IGtpZERpY3QuZ2V0UmF3KCJPYmoiKSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZiA/IGtpZERpY3QuZ2V0UmF3KCJPYmoiKS50b1N0cmluZygpIDogbnVsbCwKICAgICAgICBwYWdlT2JqSWQKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG5ldyBTdHJ1Y3RFbGVtZW50KHsKICAgICAgdHlwZTogU3RydWN0RWxlbWVudFR5cGUuRUxFTUVOVCwKICAgICAgZGljdDoga2lkRGljdAogICAgfSk7CiAgfQoKfQoKY2xhc3MgU3RydWN0RWxlbWVudCB7CiAgY29uc3RydWN0b3IoewogICAgdHlwZSwKICAgIGRpY3QgPSBudWxsLAogICAgbWNpZCA9IG51bGwsCiAgICBwYWdlT2JqSWQgPSBudWxsLAogICAgcmVmT2JqSWQgPSBudWxsCiAgfSkgewogICAgdGhpcy50eXBlID0gdHlwZTsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB0aGlzLm1jaWQgPSBtY2lkOwogICAgdGhpcy5wYWdlT2JqSWQgPSBwYWdlT2JqSWQ7CiAgICB0aGlzLnJlZk9iaklkID0gcmVmT2JqSWQ7CiAgICB0aGlzLnBhcmVudE5vZGUgPSBudWxsOwogIH0KCn0KCmNsYXNzIFN0cnVjdFRyZWVQYWdlIHsKICBjb25zdHJ1Y3RvcihzdHJ1Y3RUcmVlUm9vdCwgcGFnZURpY3QpIHsKICAgIHRoaXMucm9vdCA9IHN0cnVjdFRyZWVSb290OwogICAgdGhpcy5yb290RGljdCA9IHN0cnVjdFRyZWVSb290ID8gc3RydWN0VHJlZVJvb3QuZGljdCA6IG51bGw7CiAgICB0aGlzLnBhZ2VEaWN0ID0gcGFnZURpY3Q7CiAgICB0aGlzLm5vZGVzID0gW107CiAgfQoKICBwYXJzZSgpIHsKICAgIGlmICghdGhpcy5yb290IHx8ICF0aGlzLnJvb3REaWN0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBwYXJlbnRUcmVlID0gdGhpcy5yb290RGljdC5nZXQoIlBhcmVudFRyZWUiKTsKCiAgICBpZiAoIXBhcmVudFRyZWUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGlkID0gdGhpcy5wYWdlRGljdC5nZXQoIlN0cnVjdFBhcmVudHMiKTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaWQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBudW1iZXJUcmVlID0gbmV3IF9uYW1lX251bWJlcl90cmVlLk51bWJlclRyZWUocGFyZW50VHJlZSwgdGhpcy5yb290RGljdC54cmVmKTsKICAgIGNvbnN0IHBhcmVudEFycmF5ID0gbnVtYmVyVHJlZS5nZXQoaWQpOwoKICAgIGlmICghQXJyYXkuaXNBcnJheShwYXJlbnRBcnJheSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsKCiAgICBmb3IgKGNvbnN0IHJlZiBvZiBwYXJlbnRBcnJheSkgewogICAgICBpZiAocmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgdGhpcy5hZGROb2RlKHRoaXMucm9vdERpY3QueHJlZi5mZXRjaChyZWYpLCBtYXApOwogICAgICB9CiAgICB9CiAgfQoKICBhZGROb2RlKGRpY3QsIG1hcCwgbGV2ZWwgPSAwKSB7CiAgICBpZiAobGV2ZWwgPiBNQVhfREVQVEgpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJTdHJ1Y3RUcmVlIE1BWF9ERVBUSCByZWFjaGVkLiIpOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAobWFwLmhhcyhkaWN0KSkgewogICAgICByZXR1cm4gbWFwLmdldChkaWN0KTsKICAgIH0KCiAgICBjb25zdCBlbGVtZW50ID0gbmV3IFN0cnVjdEVsZW1lbnROb2RlKHRoaXMsIGRpY3QpOwogICAgbWFwLnNldChkaWN0LCBlbGVtZW50KTsKICAgIGNvbnN0IHBhcmVudCA9IGRpY3QuZ2V0KCJQIik7CgogICAgaWYgKCFwYXJlbnQgfHwgKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkocGFyZW50LmdldCgiVHlwZSIpLCAiU3RydWN0VHJlZVJvb3QiKSkgewogICAgICBpZiAoIXRoaXMuYWRkVG9wTGV2ZWxOb2RlKGRpY3QsIGVsZW1lbnQpKSB7CiAgICAgICAgbWFwLmRlbGV0ZShkaWN0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGVsZW1lbnQ7CiAgICB9CgogICAgY29uc3QgcGFyZW50Tm9kZSA9IHRoaXMuYWRkTm9kZShwYXJlbnQsIG1hcCwgbGV2ZWwgKyAxKTsKCiAgICBpZiAoIXBhcmVudE5vZGUpIHsKICAgICAgcmV0dXJuIGVsZW1lbnQ7CiAgICB9CgogICAgbGV0IHNhdmUgPSBmYWxzZTsKCiAgICBmb3IgKGNvbnN0IGtpZCBvZiBwYXJlbnROb2RlLmtpZHMpIHsKICAgICAgaWYgKGtpZC50eXBlID09PSBTdHJ1Y3RFbGVtZW50VHlwZS5FTEVNRU5UICYmIGtpZC5kaWN0ID09PSBkaWN0KSB7CiAgICAgICAga2lkLnBhcmVudE5vZGUgPSBlbGVtZW50OwogICAgICAgIHNhdmUgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKCFzYXZlKSB7CiAgICAgIG1hcC5kZWxldGUoZGljdCk7CiAgICB9CgogICAgcmV0dXJuIGVsZW1lbnQ7CiAgfQoKICBhZGRUb3BMZXZlbE5vZGUoZGljdCwgZWxlbWVudCkgewogICAgY29uc3Qgb2JqID0gdGhpcy5yb290RGljdC5nZXQoIksiKTsKCiAgICBpZiAoIW9iaikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgaWYgKG9iai5vYmpJZCAhPT0gZGljdC5vYmpJZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5ub2Rlc1swXSA9IGVsZW1lbnQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmICghQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGxldCBzYXZlID0gZmFsc2U7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3Qga2lkUmVmID0gb2JqW2ldOwoKICAgICAgaWYgKGtpZFJlZiAmJiBraWRSZWYudG9TdHJpbmcoKSA9PT0gZGljdC5vYmpJZCkgewogICAgICAgIHRoaXMubm9kZXNbaV0gPSBlbGVtZW50OwogICAgICAgIHNhdmUgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHNhdmU7CiAgfQoKICBnZXQgc2VyaWFsaXphYmxlKCkgewogICAgZnVuY3Rpb24gbm9kZVRvU2VyaWFsaXphYmxlKG5vZGUsIHBhcmVudCwgbGV2ZWwgPSAwKSB7CiAgICAgIGlmIChsZXZlbCA+IE1BWF9ERVBUSCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiU3RydWN0VHJlZSB0b28gZGVlcCB0byBiZSBmdWxseSBzZXJpYWxpemVkLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgb2JqLnJvbGUgPSBub2RlLnJvbGU7CiAgICAgIG9iai5jaGlsZHJlbiA9IFtdOwogICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChvYmopOwogICAgICBjb25zdCBhbHQgPSBub2RlLmRpY3QuZ2V0KCJBbHQiKTsKCiAgICAgIGlmICh0eXBlb2YgYWx0ID09PSAic3RyaW5nIikgewogICAgICAgIG9iai5hbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGFsdCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxhbmcgPSBub2RlLmRpY3QuZ2V0KCJMYW5nIik7CgogICAgICBpZiAodHlwZW9mIGxhbmcgPT09ICJzdHJpbmciKSB7CiAgICAgICAgb2JqLmxhbmcgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxhbmcpOwogICAgICB9CgogICAgICBmb3IgKGNvbnN0IGtpZCBvZiBub2RlLmtpZHMpIHsKICAgICAgICBjb25zdCBraWRFbGVtZW50ID0ga2lkLnR5cGUgPT09IFN0cnVjdEVsZW1lbnRUeXBlLkVMRU1FTlQgPyBraWQucGFyZW50Tm9kZSA6IG51bGw7CgogICAgICAgIGlmIChraWRFbGVtZW50KSB7CiAgICAgICAgICBub2RlVG9TZXJpYWxpemFibGUoa2lkRWxlbWVudCwgb2JqLCBsZXZlbCArIDEpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSBlbHNlIGlmIChraWQudHlwZSA9PT0gU3RydWN0RWxlbWVudFR5cGUuUEFHRV9DT05URU5UIHx8IGtpZC50eXBlID09PSBTdHJ1Y3RFbGVtZW50VHlwZS5TVFJFQU1fQ09OVEVOVCkgewogICAgICAgICAgb2JqLmNoaWxkcmVuLnB1c2goewogICAgICAgICAgICB0eXBlOiAiY29udGVudCIsCiAgICAgICAgICAgIGlkOiBgcGFnZSR7a2lkLnBhZ2VPYmpJZH1fbWNpZCR7a2lkLm1jaWR9YAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChraWQudHlwZSA9PT0gU3RydWN0RWxlbWVudFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBvYmouY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgIHR5cGU6ICJvYmplY3QiLAogICAgICAgICAgICBpZDoga2lkLnJlZk9iaklkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByb290ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHJvb3QuY2hpbGRyZW4gPSBbXTsKICAgIHJvb3Qucm9sZSA9ICJSb290IjsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMubm9kZXMpIHsKICAgICAgaWYgKCFjaGlsZCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBub2RlVG9TZXJpYWxpemFibGUoY2hpbGQsIHJvb3QpOwogICAgfQoKICAgIHJldHVybiByb290OwogIH0KCn0KCmV4cG9ydHMuU3RydWN0VHJlZVBhZ2UgPSBTdHJ1Y3RUcmVlUGFnZTsKCi8qKiovIH0pLAovKiA3NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk9iamVjdExvYWRlciA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKZnVuY3Rpb24gbWF5SGF2ZUNoaWxkcmVuKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmIHx8IHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCB8fCB2YWx1ZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtIHx8IEFycmF5LmlzQXJyYXkodmFsdWUpOwp9CgpmdW5jdGlvbiBhZGRDaGlsZHJlbihub2RlLCBub2Rlc1RvVmlzaXQpIHsKICBpZiAobm9kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgIG5vZGUgPSBub2RlLmdldFJhd1ZhbHVlcygpOwogIH0gZWxzZSBpZiAobm9kZSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSB7CiAgICBub2RlID0gbm9kZS5kaWN0LmdldFJhd1ZhbHVlcygpOwogIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkobm9kZSkpIHsKICAgIHJldHVybjsKICB9CgogIGZvciAoY29uc3QgcmF3VmFsdWUgb2Ygbm9kZSkgewogICAgaWYgKG1heUhhdmVDaGlsZHJlbihyYXdWYWx1ZSkpIHsKICAgICAgbm9kZXNUb1Zpc2l0LnB1c2gocmF3VmFsdWUpOwogICAgfQogIH0KfQoKY2xhc3MgT2JqZWN0TG9hZGVyIHsKICBjb25zdHJ1Y3RvcihkaWN0LCBrZXlzLCB4cmVmKSB7CiAgICB0aGlzLmRpY3QgPSBkaWN0OwogICAgdGhpcy5rZXlzID0ga2V5czsKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLnJlZlNldCA9IG51bGw7CiAgfQoKICBhc3luYyBsb2FkKCkgewogICAgaWYgKHRoaXMueHJlZi5zdHJlYW0uaXNEYXRhTG9hZGVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgY29uc3QgewogICAgICBrZXlzLAogICAgICBkaWN0CiAgICB9ID0gdGhpczsKICAgIHRoaXMucmVmU2V0ID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgY29uc3Qgbm9kZXNUb1Zpc2l0ID0gW107CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0ga2V5cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIGNvbnN0IHJhd1ZhbHVlID0gZGljdC5nZXRSYXcoa2V5c1tpXSk7CgogICAgICBpZiAocmF3VmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIG5vZGVzVG9WaXNpdC5wdXNoKHJhd1ZhbHVlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzLl93YWxrKG5vZGVzVG9WaXNpdCk7CiAgfQoKICBhc3luYyBfd2Fsayhub2Rlc1RvVmlzaXQpIHsKICAgIGNvbnN0IG5vZGVzVG9SZXZpc2l0ID0gW107CiAgICBjb25zdCBwZW5kaW5nUmVxdWVzdHMgPSBbXTsKCiAgICB3aGlsZSAobm9kZXNUb1Zpc2l0Lmxlbmd0aCkgewogICAgICBsZXQgY3VycmVudE5vZGUgPSBub2Rlc1RvVmlzaXQucG9wKCk7CgogICAgICBpZiAoY3VycmVudE5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICBpZiAodGhpcy5yZWZTZXQuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5yZWZTZXQucHV0KGN1cnJlbnROb2RlKTsKICAgICAgICAgIGN1cnJlbnROb2RlID0gdGhpcy54cmVmLmZldGNoKGN1cnJlbnROb2RlKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgaWYgKCEoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBPYmplY3RMb2FkZXIuX3dhbGsgLSByZXF1ZXN0aW5nIGFsbCBkYXRhOiAiJHtleH0iLmApOwogICAgICAgICAgICB0aGlzLnJlZlNldCA9IG51bGw7CiAgICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgICBtYW5hZ2VyCiAgICAgICAgICAgIH0gPSB0aGlzLnhyZWYuc3RyZWFtOwogICAgICAgICAgICByZXR1cm4gbWFuYWdlci5yZXF1ZXN0QWxsQ2h1bmtzKCk7CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZXNUb1JldmlzaXQucHVzaChjdXJyZW50Tm9kZSk7CiAgICAgICAgICBwZW5kaW5nUmVxdWVzdHMucHVzaCh7CiAgICAgICAgICAgIGJlZ2luOiBleC5iZWdpbiwKICAgICAgICAgICAgZW5kOiBleC5lbmQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGN1cnJlbnROb2RlIGluc3RhbmNlb2YgX2Jhc2Vfc3RyZWFtLkJhc2VTdHJlYW0pIHsKICAgICAgICBjb25zdCBiYXNlU3RyZWFtcyA9IGN1cnJlbnROb2RlLmdldEJhc2VTdHJlYW1zKCk7CgogICAgICAgIGlmIChiYXNlU3RyZWFtcykgewogICAgICAgICAgbGV0IGZvdW5kTWlzc2luZ0RhdGEgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiBiYXNlU3RyZWFtcykgewogICAgICAgICAgICBpZiAoc3RyZWFtLmlzRGF0YUxvYWRlZCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3VuZE1pc3NpbmdEYXRhID0gdHJ1ZTsKICAgICAgICAgICAgcGVuZGluZ1JlcXVlc3RzLnB1c2goewogICAgICAgICAgICAgIGJlZ2luOiBzdHJlYW0uc3RhcnQsCiAgICAgICAgICAgICAgZW5kOiBzdHJlYW0uZW5kCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChmb3VuZE1pc3NpbmdEYXRhKSB7CiAgICAgICAgICAgIG5vZGVzVG9SZXZpc2l0LnB1c2goY3VycmVudE5vZGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgYWRkQ2hpbGRyZW4oY3VycmVudE5vZGUsIG5vZGVzVG9WaXNpdCk7CiAgICB9CgogICAgaWYgKHBlbmRpbmdSZXF1ZXN0cy5sZW5ndGgpIHsKICAgICAgYXdhaXQgdGhpcy54cmVmLnN0cmVhbS5tYW5hZ2VyLnJlcXVlc3RSYW5nZXMocGVuZGluZ1JlcXVlc3RzKTsKCiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1RvUmV2aXNpdCkgewogICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICB0aGlzLnJlZlNldC5yZW1vdmUobm9kZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fd2Fsayhub2Rlc1RvUmV2aXNpdCk7CiAgICB9CgogICAgdGhpcy5yZWZTZXQgPSBudWxsOwogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9Cgp9CgpleHBvcnRzLk9iamVjdExvYWRlciA9IE9iamVjdExvYWRlcjsKCi8qKiovIH0pLAovKiA3NiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhGQUZhY3RvcnkgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfYmluZCA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwoKdmFyIF9kYXRhID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Nyk7Cgp2YXIgX2ZvbnRzID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7Cgp2YXIgX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OCk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg4KTsKCnZhciBfeGh0bWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk4KTsKCmNsYXNzIFhGQUZhY3RvcnkgewogIGNvbnN0cnVjdG9yKGRhdGEpIHsKICAgIHRyeSB7CiAgICAgIHRoaXMucm9vdCA9IG5ldyBfcGFyc2VyLlhGQVBhcnNlcigpLnBhcnNlKFhGQUZhY3RvcnkuX2NyZWF0ZURvY3VtZW50KGRhdGEpKTsKICAgICAgY29uc3QgYmluZGVyID0gbmV3IF9iaW5kLkJpbmRlcih0aGlzLnJvb3QpOwogICAgICB0aGlzLmZvcm0gPSBiaW5kZXIuYmluZCgpOwogICAgICB0aGlzLmRhdGFIYW5kbGVyID0gbmV3IF9kYXRhLkRhdGFIYW5kbGVyKHRoaXMucm9vdCwgYmluZGVyLmdldERhdGEoKSk7CiAgICAgIHRoaXMuZm9ybVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0udGVtcGxhdGUgPSB0aGlzLmZvcm07CiAgICB9IGNhdGNoIChlKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gYW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHBhcnNpbmcgYW5kIGJpbmRpbmc6ICR7ZX1gKTsKICAgIH0KICB9CgogIGlzVmFsaWQoKSB7CiAgICByZXR1cm4gdGhpcy5yb290ICYmIHRoaXMuZm9ybTsKICB9CgogIF9jcmVhdGVQYWdlc0hlbHBlcigpIHsKICAgIGNvbnN0IGl0ZXJhdG9yID0gdGhpcy5mb3JtW194ZmFfb2JqZWN0LiR0b1BhZ2VzXSgpOwoKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IG5leHRJdGVyYXRpb24gPSAoKSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gaXRlcmF0b3IubmV4dCgpOwoKICAgICAgICAgIGlmICh2YWx1ZS5kb25lKSB7CiAgICAgICAgICAgIHJlc29sdmUodmFsdWUudmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0VGltZW91dChuZXh0SXRlcmF0aW9uLCAwKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgc2V0VGltZW91dChuZXh0SXRlcmF0aW9uLCAwKTsKICAgIH0pOwogIH0KCiAgYXN5bmMgX2NyZWF0ZVBhZ2VzKCkgewogICAgdHJ5IHsKICAgICAgdGhpcy5wYWdlcyA9IGF3YWl0IHRoaXMuX2NyZWF0ZVBhZ2VzSGVscGVyKCk7CiAgICAgIHRoaXMuZGltcyA9IHRoaXMucGFnZXMuY2hpbGRyZW4ubWFwKGMgPT4gewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHdpZHRoLAogICAgICAgICAgaGVpZ2h0CiAgICAgICAgfSA9IGMuYXR0cmlidXRlcy5zdHlsZTsKICAgICAgICByZXR1cm4gWzAsIDAsIHBhcnNlSW50KHdpZHRoKSwgcGFyc2VJbnQoaGVpZ2h0KV07CiAgICAgIH0pOwogICAgfSBjYXRjaCAoZSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIGFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBsYXlvdXQ6ICR7ZX1gKTsKICAgIH0KICB9CgogIGdldEJvdW5kaW5nQm94KHBhZ2VJbmRleCkgewogICAgcmV0dXJuIHRoaXMuZGltc1twYWdlSW5kZXhdOwogIH0KCiAgYXN5bmMgZ2V0TnVtUGFnZXMoKSB7CiAgICBpZiAoIXRoaXMucGFnZXMpIHsKICAgICAgYXdhaXQgdGhpcy5fY3JlYXRlUGFnZXMoKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5kaW1zLmxlbmd0aDsKICB9CgogIHNldEltYWdlcyhpbWFnZXMpIHsKICAgIHRoaXMuZm9ybVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uaW1hZ2VzID0gaW1hZ2VzOwogIH0KCiAgc2V0Rm9udHMoZm9udHMpIHsKICAgIHRoaXMuZm9ybVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlciA9IG5ldyBfZm9udHMuRm9udEZpbmRlcihmb250cyk7CiAgICBjb25zdCBtaXNzaW5nRm9udHMgPSBbXTsKCiAgICBmb3IgKGxldCB0eXBlZmFjZSBvZiB0aGlzLmZvcm1bX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLnVzZWRUeXBlZmFjZXMpIHsKICAgICAgdHlwZWZhY2UgPSAoMCwgX3V0aWxzLnN0cmlwUXVvdGVzKSh0eXBlZmFjZSk7CgogICAgICBjb25zdCBmb250ID0gdGhpcy5mb3JtW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5mb250RmluZGVyLmZpbmQodHlwZWZhY2UpOwoKICAgICAgaWYgKCFmb250KSB7CiAgICAgICAgbWlzc2luZ0ZvbnRzLnB1c2godHlwZWZhY2UpOwogICAgICB9CiAgICB9CgogICAgaWYgKG1pc3NpbmdGb250cy5sZW5ndGggPiAwKSB7CiAgICAgIHJldHVybiBtaXNzaW5nRm9udHM7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBhcHBlbmRGb250cyhmb250cywgcmVhbGx5TWlzc2luZ0ZvbnRzKSB7CiAgICB0aGlzLmZvcm1bX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmZvbnRGaW5kZXIuYWRkKGZvbnRzLCByZWFsbHlNaXNzaW5nRm9udHMpOwogIH0KCiAgYXN5bmMgZ2V0UGFnZXMoKSB7CiAgICBpZiAoIXRoaXMucGFnZXMpIHsKICAgICAgYXdhaXQgdGhpcy5fY3JlYXRlUGFnZXMoKTsKICAgIH0KCiAgICBjb25zdCBwYWdlcyA9IHRoaXMucGFnZXM7CiAgICB0aGlzLnBhZ2VzID0gbnVsbDsKICAgIHJldHVybiBwYWdlczsKICB9CgogIHNlcmlhbGl6ZURhdGEoc3RvcmFnZSkgewogICAgcmV0dXJuIHRoaXMuZGF0YUhhbmRsZXIuc2VyaWFsaXplKHN0b3JhZ2UpOwogIH0KCiAgc3RhdGljIF9jcmVhdGVEb2N1bWVudChkYXRhKSB7CiAgICBpZiAoIWRhdGFbIi94ZHA6eGRwIl0pIHsKICAgICAgcmV0dXJuIGRhdGFbInhkcDp4ZHAiXTsKICAgIH0KCiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhkYXRhKS5qb2luKCIiKTsKICB9CgogIHN0YXRpYyBnZXRSaWNoVGV4dEFzSHRtbChyYykgewogICAgaWYgKCFyYyB8fCB0eXBlb2YgcmMgIT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHRyeSB7CiAgICAgIGxldCByb290ID0gbmV3IF9wYXJzZXIuWEZBUGFyc2VyKF94aHRtbC5YaHRtbE5hbWVzcGFjZSwgdHJ1ZSkucGFyc2UocmMpOwoKICAgICAgaWYgKCFbImJvZHkiLCAieGh0bWwiXS5pbmNsdWRlcyhyb290W194ZmFfb2JqZWN0LiRub2RlTmFtZV0pKSB7CiAgICAgICAgY29uc3QgbmV3Um9vdCA9IF94aHRtbC5YaHRtbE5hbWVzcGFjZS5ib2R5KHt9KTsKCiAgICAgICAgbmV3Um9vdFtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKHJvb3QpOwoKICAgICAgICByb290ID0gbmV3Um9vdDsKICAgICAgfQoKICAgICAgY29uc3QgcmVzdWx0ID0gcm9vdFtfeGZhX29iamVjdC4kdG9IVE1MXSgpOwoKICAgICAgaWYgKCFyZXN1bHQuc3VjY2VzcykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjb25zdCB7CiAgICAgICAgaHRtbAogICAgICB9ID0gcmVzdWx0OwogICAgICBjb25zdCB7CiAgICAgICAgYXR0cmlidXRlcwogICAgICB9ID0gaHRtbDsKCiAgICAgIGlmIChhdHRyaWJ1dGVzKSB7CiAgICAgICAgaWYgKGF0dHJpYnV0ZXMuY2xhc3MpIHsKICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSBhdHRyaWJ1dGVzLmNsYXNzLmZpbHRlcihhdHRyID0+ICFhdHRyLnN0YXJ0c1dpdGgoInhmYSIpKTsKICAgICAgICB9CgogICAgICAgIGF0dHJpYnV0ZXMuZGlyID0gImF1dG8iOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGh0bWwsCiAgICAgICAgc3RyOiByb290W194ZmFfb2JqZWN0LiR0ZXh0XSgpCiAgICAgIH07CiAgICB9IGNhdGNoIChlKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gYW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHBhcnNpbmcgb2YgcmljaCB0ZXh0OiAke2V9YCk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKZXhwb3J0cy5YRkFGYWN0b3J5ID0gWEZBRmFjdG9yeTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhtbE9iamVjdCA9IGV4cG9ydHMuWEZBT2JqZWN0QXJyYXkgPSBleHBvcnRzLlhGQU9iamVjdCA9IGV4cG9ydHMuWEZBQXR0cmlidXRlID0gZXhwb3J0cy5TdHJpbmdPYmplY3QgPSBleHBvcnRzLk9wdGlvbk9iamVjdCA9IGV4cG9ydHMuT3B0aW9uMTAgPSBleHBvcnRzLk9wdGlvbjAxID0gZXhwb3J0cy5JbnRlZ2VyT2JqZWN0ID0gZXhwb3J0cy5Db250ZW50T2JqZWN0ID0gZXhwb3J0cy4kdWlkID0gZXhwb3J0cy4kdG9TdHlsZSA9IGV4cG9ydHMuJHRvU3RyaW5nID0gZXhwb3J0cy4kdG9QYWdlcyA9IGV4cG9ydHMuJHRvSFRNTCA9IGV4cG9ydHMuJHRleHQgPSBleHBvcnRzLiR0YWJJbmRleCA9IGV4cG9ydHMuJHNldFZhbHVlID0gZXhwb3J0cy4kc2V0U2V0QXR0cmlidXRlcyA9IGV4cG9ydHMuJHNldElkID0gZXhwb3J0cy4kc2VhcmNoTm9kZSA9IGV4cG9ydHMuJHJvb3QgPSBleHBvcnRzLiRyZXNvbHZlUHJvdG90eXBlcyA9IGV4cG9ydHMuJHJlbW92ZUNoaWxkID0gZXhwb3J0cy4kcHVzaFBhcmEgPSBleHBvcnRzLiRwdXNoR2x5cGhzID0gZXhwb3J0cy4kcG9wUGFyYSA9IGV4cG9ydHMuJG9uVGV4dCA9IGV4cG9ydHMuJG9uQ2hpbGRDaGVjayA9IGV4cG9ydHMuJG9uQ2hpbGQgPSBleHBvcnRzLiRuc0F0dHJpYnV0ZXMgPSBleHBvcnRzLiRub2RlTmFtZSA9IGV4cG9ydHMuJG5hbWVzcGFjZUlkID0gZXhwb3J0cy4kaXNVc2FibGUgPSBleHBvcnRzLiRpc1RyYW5zcGFyZW50ID0gZXhwb3J0cy4kaXNUaGVyZU1vcmVXaWR0aCA9IGV4cG9ydHMuJGlzU3BsaXR0YWJsZSA9IGV4cG9ydHMuJGlzTnNBZ25vc3RpYyA9IGV4cG9ydHMuJGlzRGVzY2VuZGVudCA9IGV4cG9ydHMuJGlzRGF0YVZhbHVlID0gZXhwb3J0cy4kaXNDREFUQVhtbCA9IGV4cG9ydHMuJGlzQmluZGFibGUgPSBleHBvcnRzLiRpbnNlcnRBdCA9IGV4cG9ydHMuJGluZGV4T2YgPSBleHBvcnRzLiRpZHMgPSBleHBvcnRzLiRoYXNTZXR0YWJsZVZhbHVlID0gZXhwb3J0cy4kZ2xvYmFsRGF0YSA9IGV4cG9ydHMuJGdldFRlbXBsYXRlUm9vdCA9IGV4cG9ydHMuJGdldFN1YmZvcm1QYXJlbnQgPSBleHBvcnRzLiRnZXRSZWFsQ2hpbGRyZW5CeU5hbWVJdCA9IGV4cG9ydHMuJGdldFBhcmVudCA9IGV4cG9ydHMuJGdldE5leHRQYWdlID0gZXhwb3J0cy4kZ2V0RXh0cmEgPSBleHBvcnRzLiRnZXREYXRhVmFsdWUgPSBleHBvcnRzLiRnZXRDb250YWluZWRDaGlsZHJlbiA9IGV4cG9ydHMuJGdldENoaWxkcmVuQnlOYW1lSXQgPSBleHBvcnRzLiRnZXRDaGlsZHJlbkJ5TmFtZSA9IGV4cG9ydHMuJGdldENoaWxkcmVuQnlDbGFzcyA9IGV4cG9ydHMuJGdldENoaWxkcmVuID0gZXhwb3J0cy4kZ2V0QXZhaWxhYmxlU3BhY2UgPSBleHBvcnRzLiRnZXRBdHRyaWJ1dGVzID0gZXhwb3J0cy4kZ2V0QXR0cmlidXRlSXQgPSBleHBvcnRzLiRmbHVzaEhUTUwgPSBleHBvcnRzLiRmaW5hbGl6ZSA9IGV4cG9ydHMuJGV4dHJhID0gZXhwb3J0cy4kZHVtcCA9IGV4cG9ydHMuJGRhdGEgPSBleHBvcnRzLiRjb250ZW50ID0gZXhwb3J0cy4kY29uc3VtZWQgPSBleHBvcnRzLiRjbG9uZSA9IGV4cG9ydHMuJGNsZWFudXAgPSBleHBvcnRzLiRjbGVhblBhZ2UgPSBleHBvcnRzLiRjbGVhbiA9IGV4cG9ydHMuJGNoaWxkcmVuVG9IVE1MID0gZXhwb3J0cy4kYXBwZW5kQ2hpbGQgPSBleHBvcnRzLiRhZGRIVE1MID0gZXhwb3J0cy4kYWNjZXB0V2hpdGVzcGFjZSA9IHZvaWQgMDsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYpOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3NvbSA9IF9fd19wZGZqc19yZXF1aXJlX18oODApOwoKY29uc3QgJGFjY2VwdFdoaXRlc3BhY2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kYWNjZXB0V2hpdGVzcGFjZSA9ICRhY2NlcHRXaGl0ZXNwYWNlOwpjb25zdCAkYWRkSFRNTCA9IFN5bWJvbCgpOwpleHBvcnRzLiRhZGRIVE1MID0gJGFkZEhUTUw7CmNvbnN0ICRhcHBlbmRDaGlsZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRhcHBlbmRDaGlsZCA9ICRhcHBlbmRDaGlsZDsKY29uc3QgJGNoaWxkcmVuVG9IVE1MID0gU3ltYm9sKCk7CmV4cG9ydHMuJGNoaWxkcmVuVG9IVE1MID0gJGNoaWxkcmVuVG9IVE1MOwpjb25zdCAkY2xlYW4gPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW4gPSAkY2xlYW47CmNvbnN0ICRjbGVhblBhZ2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW5QYWdlID0gJGNsZWFuUGFnZTsKY29uc3QgJGNsZWFudXAgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xlYW51cCA9ICRjbGVhbnVwOwpjb25zdCAkY2xvbmUgPSBTeW1ib2woKTsKZXhwb3J0cy4kY2xvbmUgPSAkY2xvbmU7CmNvbnN0ICRjb25zdW1lZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRjb25zdW1lZCA9ICRjb25zdW1lZDsKY29uc3QgJGNvbnRlbnQgPSBTeW1ib2woImNvbnRlbnQiKTsKZXhwb3J0cy4kY29udGVudCA9ICRjb250ZW50Owpjb25zdCAkZGF0YSA9IFN5bWJvbCgiZGF0YSIpOwpleHBvcnRzLiRkYXRhID0gJGRhdGE7CmNvbnN0ICRkdW1wID0gU3ltYm9sKCk7CmV4cG9ydHMuJGR1bXAgPSAkZHVtcDsKY29uc3QgJGV4dHJhID0gU3ltYm9sKCJleHRyYSIpOwpleHBvcnRzLiRleHRyYSA9ICRleHRyYTsKY29uc3QgJGZpbmFsaXplID0gU3ltYm9sKCk7CmV4cG9ydHMuJGZpbmFsaXplID0gJGZpbmFsaXplOwpjb25zdCAkZmx1c2hIVE1MID0gU3ltYm9sKCk7CmV4cG9ydHMuJGZsdXNoSFRNTCA9ICRmbHVzaEhUTUw7CmNvbnN0ICRnZXRBdHRyaWJ1dGVJdCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRBdHRyaWJ1dGVJdCA9ICRnZXRBdHRyaWJ1dGVJdDsKY29uc3QgJGdldEF0dHJpYnV0ZXMgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0QXR0cmlidXRlcyA9ICRnZXRBdHRyaWJ1dGVzOwpjb25zdCAkZ2V0QXZhaWxhYmxlU3BhY2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0QXZhaWxhYmxlU3BhY2UgPSAkZ2V0QXZhaWxhYmxlU3BhY2U7CmNvbnN0ICRnZXRDaGlsZHJlbkJ5Q2xhc3MgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0Q2hpbGRyZW5CeUNsYXNzID0gJGdldENoaWxkcmVuQnlDbGFzczsKY29uc3QgJGdldENoaWxkcmVuQnlOYW1lID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldENoaWxkcmVuQnlOYW1lID0gJGdldENoaWxkcmVuQnlOYW1lOwpjb25zdCAkZ2V0Q2hpbGRyZW5CeU5hbWVJdCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRDaGlsZHJlbkJ5TmFtZUl0ID0gJGdldENoaWxkcmVuQnlOYW1lSXQ7CmNvbnN0ICRnZXREYXRhVmFsdWUgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0RGF0YVZhbHVlID0gJGdldERhdGFWYWx1ZTsKY29uc3QgJGdldEV4dHJhID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldEV4dHJhID0gJGdldEV4dHJhOwpjb25zdCAkZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQgPSAkZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXQ7CmNvbnN0ICRnZXRDaGlsZHJlbiA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRDaGlsZHJlbiA9ICRnZXRDaGlsZHJlbjsKY29uc3QgJGdldENvbnRhaW5lZENoaWxkcmVuID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldENvbnRhaW5lZENoaWxkcmVuID0gJGdldENvbnRhaW5lZENoaWxkcmVuOwpjb25zdCAkZ2V0TmV4dFBhZ2UgPSBTeW1ib2woKTsKZXhwb3J0cy4kZ2V0TmV4dFBhZ2UgPSAkZ2V0TmV4dFBhZ2U7CmNvbnN0ICRnZXRTdWJmb3JtUGFyZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldFN1YmZvcm1QYXJlbnQgPSAkZ2V0U3ViZm9ybVBhcmVudDsKY29uc3QgJGdldFBhcmVudCA9IFN5bWJvbCgpOwpleHBvcnRzLiRnZXRQYXJlbnQgPSAkZ2V0UGFyZW50Owpjb25zdCAkZ2V0VGVtcGxhdGVSb290ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdldFRlbXBsYXRlUm9vdCA9ICRnZXRUZW1wbGF0ZVJvb3Q7CmNvbnN0ICRnbG9iYWxEYXRhID0gU3ltYm9sKCk7CmV4cG9ydHMuJGdsb2JhbERhdGEgPSAkZ2xvYmFsRGF0YTsKY29uc3QgJGhhc1NldHRhYmxlVmFsdWUgPSBTeW1ib2woKTsKZXhwb3J0cy4kaGFzU2V0dGFibGVWYWx1ZSA9ICRoYXNTZXR0YWJsZVZhbHVlOwpjb25zdCAkaWRzID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlkcyA9ICRpZHM7CmNvbnN0ICRpbmRleE9mID0gU3ltYm9sKCk7CmV4cG9ydHMuJGluZGV4T2YgPSAkaW5kZXhPZjsKY29uc3QgJGluc2VydEF0ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGluc2VydEF0ID0gJGluc2VydEF0Owpjb25zdCAkaXNDREFUQVhtbCA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc0NEQVRBWG1sID0gJGlzQ0RBVEFYbWw7CmNvbnN0ICRpc0JpbmRhYmxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzQmluZGFibGUgPSAkaXNCaW5kYWJsZTsKY29uc3QgJGlzRGF0YVZhbHVlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzRGF0YVZhbHVlID0gJGlzRGF0YVZhbHVlOwpjb25zdCAkaXNEZXNjZW5kZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzRGVzY2VuZGVudCA9ICRpc0Rlc2NlbmRlbnQ7CmNvbnN0ICRpc05zQWdub3N0aWMgPSBTeW1ib2woKTsKZXhwb3J0cy4kaXNOc0Fnbm9zdGljID0gJGlzTnNBZ25vc3RpYzsKY29uc3QgJGlzU3BsaXR0YWJsZSA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc1NwbGl0dGFibGUgPSAkaXNTcGxpdHRhYmxlOwpjb25zdCAkaXNUaGVyZU1vcmVXaWR0aCA9IFN5bWJvbCgpOwpleHBvcnRzLiRpc1RoZXJlTW9yZVdpZHRoID0gJGlzVGhlcmVNb3JlV2lkdGg7CmNvbnN0ICRpc1RyYW5zcGFyZW50ID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzVHJhbnNwYXJlbnQgPSAkaXNUcmFuc3BhcmVudDsKY29uc3QgJGlzVXNhYmxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJGlzVXNhYmxlID0gJGlzVXNhYmxlOwpjb25zdCAkbGFzdEF0dHJpYnV0ZSA9IFN5bWJvbCgpOwpjb25zdCAkbmFtZXNwYWNlSWQgPSBTeW1ib2woIm5hbWVzcGFjZUlkIik7CmV4cG9ydHMuJG5hbWVzcGFjZUlkID0gJG5hbWVzcGFjZUlkOwpjb25zdCAkbm9kZU5hbWUgPSBTeW1ib2woIm5vZGVOYW1lIik7CmV4cG9ydHMuJG5vZGVOYW1lID0gJG5vZGVOYW1lOwpjb25zdCAkbnNBdHRyaWJ1dGVzID0gU3ltYm9sKCk7CmV4cG9ydHMuJG5zQXR0cmlidXRlcyA9ICRuc0F0dHJpYnV0ZXM7CmNvbnN0ICRvbkNoaWxkID0gU3ltYm9sKCk7CmV4cG9ydHMuJG9uQ2hpbGQgPSAkb25DaGlsZDsKY29uc3QgJG9uQ2hpbGRDaGVjayA9IFN5bWJvbCgpOwpleHBvcnRzLiRvbkNoaWxkQ2hlY2sgPSAkb25DaGlsZENoZWNrOwpjb25zdCAkb25UZXh0ID0gU3ltYm9sKCk7CmV4cG9ydHMuJG9uVGV4dCA9ICRvblRleHQ7CmNvbnN0ICRwdXNoR2x5cGhzID0gU3ltYm9sKCk7CmV4cG9ydHMuJHB1c2hHbHlwaHMgPSAkcHVzaEdseXBoczsKY29uc3QgJHBvcFBhcmEgPSBTeW1ib2woKTsKZXhwb3J0cy4kcG9wUGFyYSA9ICRwb3BQYXJhOwpjb25zdCAkcHVzaFBhcmEgPSBTeW1ib2woKTsKZXhwb3J0cy4kcHVzaFBhcmEgPSAkcHVzaFBhcmE7CmNvbnN0ICRyZW1vdmVDaGlsZCA9IFN5bWJvbCgpOwpleHBvcnRzLiRyZW1vdmVDaGlsZCA9ICRyZW1vdmVDaGlsZDsKY29uc3QgJHJvb3QgPSBTeW1ib2woInJvb3QiKTsKZXhwb3J0cy4kcm9vdCA9ICRyb290Owpjb25zdCAkcmVzb2x2ZVByb3RvdHlwZXMgPSBTeW1ib2woKTsKZXhwb3J0cy4kcmVzb2x2ZVByb3RvdHlwZXMgPSAkcmVzb2x2ZVByb3RvdHlwZXM7CmNvbnN0ICRzZWFyY2hOb2RlID0gU3ltYm9sKCk7CmV4cG9ydHMuJHNlYXJjaE5vZGUgPSAkc2VhcmNoTm9kZTsKY29uc3QgJHNldElkID0gU3ltYm9sKCk7CmV4cG9ydHMuJHNldElkID0gJHNldElkOwpjb25zdCAkc2V0U2V0QXR0cmlidXRlcyA9IFN5bWJvbCgpOwpleHBvcnRzLiRzZXRTZXRBdHRyaWJ1dGVzID0gJHNldFNldEF0dHJpYnV0ZXM7CmNvbnN0ICRzZXRWYWx1ZSA9IFN5bWJvbCgpOwpleHBvcnRzLiRzZXRWYWx1ZSA9ICRzZXRWYWx1ZTsKY29uc3QgJHRhYkluZGV4ID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRhYkluZGV4ID0gJHRhYkluZGV4Owpjb25zdCAkdGV4dCA9IFN5bWJvbCgpOwpleHBvcnRzLiR0ZXh0ID0gJHRleHQ7CmNvbnN0ICR0b1BhZ2VzID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRvUGFnZXMgPSAkdG9QYWdlczsKY29uc3QgJHRvSFRNTCA9IFN5bWJvbCgpOwpleHBvcnRzLiR0b0hUTUwgPSAkdG9IVE1MOwpjb25zdCAkdG9TdHJpbmcgPSBTeW1ib2woKTsKZXhwb3J0cy4kdG9TdHJpbmcgPSAkdG9TdHJpbmc7CmNvbnN0ICR0b1N0eWxlID0gU3ltYm9sKCk7CmV4cG9ydHMuJHRvU3R5bGUgPSAkdG9TdHlsZTsKY29uc3QgJHVpZCA9IFN5bWJvbCgidWlkIik7CmV4cG9ydHMuJHVpZCA9ICR1aWQ7Cgpjb25zdCBfYXBwbHlQcm90b3R5cGUgPSBTeW1ib2woKTsKCmNvbnN0IF9hdHRyaWJ1dGVzID0gU3ltYm9sKCk7Cgpjb25zdCBfYXR0cmlidXRlTmFtZXMgPSBTeW1ib2woKTsKCmNvbnN0IF9jaGlsZHJlbiA9IFN5bWJvbCgiX2NoaWxkcmVuIik7Cgpjb25zdCBfY2xvbmVBdHRyaWJ1dGUgPSBTeW1ib2woKTsKCmNvbnN0IF9kYXRhVmFsdWUgPSBTeW1ib2woKTsKCmNvbnN0IF9kZWZhdWx0VmFsdWUgPSBTeW1ib2woKTsKCmNvbnN0IF9maWx0ZXJlZENoaWxkcmVuR2VuZXJhdG9yID0gU3ltYm9sKCk7Cgpjb25zdCBfZ2V0UHJvdG90eXBlID0gU3ltYm9sKCk7Cgpjb25zdCBfZ2V0VW5zZXRBdHRyaWJ1dGVzID0gU3ltYm9sKCk7Cgpjb25zdCBfaGFzQ2hpbGRyZW4gPSBTeW1ib2woKTsKCmNvbnN0IF9tYXggPSBTeW1ib2woKTsKCmNvbnN0IF9vcHRpb25zID0gU3ltYm9sKCk7Cgpjb25zdCBfcGFyZW50ID0gU3ltYm9sKCJwYXJlbnQiKTsKCmNvbnN0IF9yZXNvbHZlUHJvdG90eXBlc0hlbHBlciA9IFN5bWJvbCgpOwoKY29uc3QgX3NldEF0dHJpYnV0ZXMgPSBTeW1ib2woKTsKCmNvbnN0IF92YWxpZGF0b3IgPSBTeW1ib2woKTsKCmxldCB1aWQgPSAwOwpjb25zdCBOU19EQVRBU0VUUyA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZDsKCmNsYXNzIFhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSwgaGFzQ2hpbGRyZW4gPSBmYWxzZSkgewogICAgdGhpc1skbmFtZXNwYWNlSWRdID0gbnNJZDsKICAgIHRoaXNbJG5vZGVOYW1lXSA9IG5hbWU7CiAgICB0aGlzW19oYXNDaGlsZHJlbl0gPSBoYXNDaGlsZHJlbjsKICAgIHRoaXNbX3BhcmVudF0gPSBudWxsOwogICAgdGhpc1tfY2hpbGRyZW5dID0gW107CiAgICB0aGlzWyR1aWRdID0gYCR7bmFtZX0ke3VpZCsrfWA7CiAgICB0aGlzWyRnbG9iYWxEYXRhXSA9IG51bGw7CiAgfQoKICBbJG9uQ2hpbGRdKGNoaWxkKSB7CiAgICBpZiAoIXRoaXNbX2hhc0NoaWxkcmVuXSB8fCAhdGhpc1skb25DaGlsZENoZWNrXShjaGlsZCkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGNvbnN0IG5hbWUgPSBjaGlsZFskbm9kZU5hbWVdOwogICAgY29uc3Qgbm9kZSA9IHRoaXNbbmFtZV07CgogICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBYRkFPYmplY3RBcnJheSkgewogICAgICBpZiAobm9kZS5wdXNoKGNoaWxkKSkgewogICAgICAgIHRoaXNbJGFwcGVuZENoaWxkXShjaGlsZCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChub2RlICE9PSBudWxsKSB7CiAgICAgICAgdGhpc1skcmVtb3ZlQ2hpbGRdKG5vZGUpOwogICAgICB9CgogICAgICB0aGlzW25hbWVdID0gY2hpbGQ7CiAgICAgIHRoaXNbJGFwcGVuZENoaWxkXShjaGlsZCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGxldCBpZCA9ICIiOwoKICAgIGlmICh0aGlzLmlkKSB7CiAgICAgIGlkID0gYCAoaWQ6ICR7dGhpcy5pZH0pYDsKICAgIH0gZWxzZSBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGlkID0gYCAobmFtZTogJHt0aGlzLm5hbWV9ICR7dGhpcy5oLnZhbHVlfSlgOwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gbm9kZSAiJHt0aGlzWyRub2RlTmFtZV19IiR7aWR9IGhhcyBhbHJlYWR5IGVub3VnaCAiJHtuYW1lfSIhYCk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJG9uQ2hpbGRDaGVja10oY2hpbGQpIHsKICAgIHJldHVybiB0aGlzLmhhc093blByb3BlcnR5KGNoaWxkWyRub2RlTmFtZV0pICYmIGNoaWxkWyRuYW1lc3BhY2VJZF0gPT09IHRoaXNbJG5hbWVzcGFjZUlkXTsKICB9CgogIFskaXNOc0Fnbm9zdGljXSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFskYWNjZXB0V2hpdGVzcGFjZV0oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJGlzQ0RBVEFYbWxdKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgWyRpc0JpbmRhYmxlXSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFskcG9wUGFyYV0oKSB7CiAgICBpZiAodGhpcy5wYXJhKSB7CiAgICAgIHRoaXNbJGdldFRlbXBsYXRlUm9vdF0oKVskZXh0cmFdLnBhcmFTdGFjay5wb3AoKTsKICAgIH0KICB9CgogIFskcHVzaFBhcmFdKCkgewogICAgdGhpc1skZ2V0VGVtcGxhdGVSb290XSgpWyRleHRyYV0ucGFyYVN0YWNrLnB1c2godGhpcy5wYXJhKTsKICB9CgogIFskc2V0SWRdKGlkcykgewogICAgaWYgKHRoaXMuaWQgJiYgdGhpc1skbmFtZXNwYWNlSWRdID09PSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMudGVtcGxhdGUuaWQpIHsKICAgICAgaWRzLnNldCh0aGlzLmlkLCB0aGlzKTsKICAgIH0KICB9CgogIFskZ2V0VGVtcGxhdGVSb290XSgpIHsKICAgIHJldHVybiB0aGlzWyRnbG9iYWxEYXRhXS50ZW1wbGF0ZTsKICB9CgogIFskaXNTcGxpdHRhYmxlXSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFskaXNUaGVyZU1vcmVXaWR0aF0oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbJGFwcGVuZENoaWxkXShjaGlsZCkgewogICAgY2hpbGRbX3BhcmVudF0gPSB0aGlzOwoKICAgIHRoaXNbX2NoaWxkcmVuXS5wdXNoKGNoaWxkKTsKCiAgICBpZiAoIWNoaWxkWyRnbG9iYWxEYXRhXSAmJiB0aGlzWyRnbG9iYWxEYXRhXSkgewogICAgICBjaGlsZFskZ2xvYmFsRGF0YV0gPSB0aGlzWyRnbG9iYWxEYXRhXTsKICAgIH0KICB9CgogIFskcmVtb3ZlQ2hpbGRdKGNoaWxkKSB7CiAgICBjb25zdCBpID0gdGhpc1tfY2hpbGRyZW5dLmluZGV4T2YoY2hpbGQpOwoKICAgIHRoaXNbX2NoaWxkcmVuXS5zcGxpY2UoaSwgMSk7CiAgfQoKICBbJGhhc1NldHRhYmxlVmFsdWVdKCkgewogICAgcmV0dXJuIHRoaXMuaGFzT3duUHJvcGVydHkoInZhbHVlIik7CiAgfQoKICBbJHNldFZhbHVlXShfKSB7fQoKICBbJG9uVGV4dF0oXykge30KCiAgWyRmaW5hbGl6ZV0oKSB7fQoKICBbJGNsZWFuXShidWlsZGVyKSB7CiAgICBkZWxldGUgdGhpc1tfaGFzQ2hpbGRyZW5dOwoKICAgIGlmICh0aGlzWyRjbGVhbnVwXSkgewogICAgICBidWlsZGVyLmNsZWFuKHRoaXNbJGNsZWFudXBdKTsKICAgICAgZGVsZXRlIHRoaXNbJGNsZWFudXBdOwogICAgfQogIH0KCiAgWyRpbmRleE9mXShjaGlsZCkgewogICAgcmV0dXJuIHRoaXNbX2NoaWxkcmVuXS5pbmRleE9mKGNoaWxkKTsKICB9CgogIFskaW5zZXJ0QXRdKGksIGNoaWxkKSB7CiAgICBjaGlsZFtfcGFyZW50XSA9IHRoaXM7CgogICAgdGhpc1tfY2hpbGRyZW5dLnNwbGljZShpLCAwLCBjaGlsZCk7CgogICAgaWYgKCFjaGlsZFskZ2xvYmFsRGF0YV0gJiYgdGhpc1skZ2xvYmFsRGF0YV0pIHsKICAgICAgY2hpbGRbJGdsb2JhbERhdGFdID0gdGhpc1skZ2xvYmFsRGF0YV07CiAgICB9CiAgfQoKICBbJGlzVHJhbnNwYXJlbnRdKCkgewogICAgcmV0dXJuICF0aGlzLm5hbWU7CiAgfQoKICBbJGxhc3RBdHRyaWJ1dGVdKCkgewogICAgcmV0dXJuICIiOwogIH0KCiAgWyR0ZXh0XSgpIHsKICAgIGlmICh0aGlzW19jaGlsZHJlbl0ubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiB0aGlzWyRjb250ZW50XTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLm1hcChjID0+IGNbJHRleHRdKCkpLmpvaW4oIiIpOwogIH0KCiAgZ2V0IFtfYXR0cmlidXRlTmFtZXNdKCkgewogICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcyk7CgogICAgaWYgKCFwcm90by5fYXR0cmlidXRlcykgewogICAgICBjb25zdCBhdHRyaWJ1dGVzID0gcHJvdG8uX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KCk7CgogICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgICBpZiAodGhpc1tuYW1lXSA9PT0gbnVsbCB8fCB0aGlzW25hbWVdIGluc3RhbmNlb2YgWEZBT2JqZWN0IHx8IHRoaXNbbmFtZV0gaW5zdGFuY2VvZiBYRkFPYmplY3RBcnJheSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBhdHRyaWJ1dGVzLmFkZChuYW1lKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCBfYXR0cmlidXRlTmFtZXMsIHByb3RvLl9hdHRyaWJ1dGVzKTsKICB9CgogIFskaXNEZXNjZW5kZW50XShwYXJlbnQpIHsKICAgIGxldCBub2RlID0gdGhpczsKCiAgICB3aGlsZSAobm9kZSkgewogICAgICBpZiAobm9kZSA9PT0gcGFyZW50KSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIG5vZGUgPSBub2RlWyRnZXRQYXJlbnRdKCk7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgWyRnZXRQYXJlbnRdKCkgewogICAgcmV0dXJuIHRoaXNbX3BhcmVudF07CiAgfQoKICBbJGdldFN1YmZvcm1QYXJlbnRdKCkgewogICAgcmV0dXJuIHRoaXNbJGdldFBhcmVudF0oKTsKICB9CgogIFskZ2V0Q2hpbGRyZW5dKG5hbWUgPSBudWxsKSB7CiAgICBpZiAoIW5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXNbX2NoaWxkcmVuXTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tuYW1lXTsKICB9CgogIFskZHVtcF0oKSB7CiAgICBjb25zdCBkdW1wZWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIGlmICh0aGlzWyRjb250ZW50XSkgewogICAgICBkdW1wZWQuJGNvbnRlbnQgPSB0aGlzWyRjb250ZW50XTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgY29uc3QgdmFsdWUgPSB0aGlzW25hbWVdOwoKICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFhGQU9iamVjdCkgewogICAgICAgIGR1bXBlZFtuYW1lXSA9IHZhbHVlWyRkdW1wXSgpOwogICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgWEZBT2JqZWN0QXJyYXkpIHsKICAgICAgICBpZiAoIXZhbHVlLmlzRW1wdHkoKSkgewogICAgICAgICAgZHVtcGVkW25hbWVdID0gdmFsdWUuZHVtcCgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBkdW1wZWRbbmFtZV0gPSB2YWx1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkdW1wZWQ7CiAgfQoKICBbJHRvU3R5bGVdKCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBbJHRvSFRNTF0oKSB7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKICAqWyRnZXRDb250YWluZWRDaGlsZHJlbl0oKSB7CiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpc1skZ2V0Q2hpbGRyZW5dKCkpIHsKICAgICAgeWllbGQgbm9kZTsKICAgIH0KICB9CgogICpbX2ZpbHRlcmVkQ2hpbGRyZW5HZW5lcmF0b3JdKGZpbHRlciwgaW5jbHVkZSkgewogICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXNbJGdldENvbnRhaW5lZENoaWxkcmVuXSgpKSB7CiAgICAgIGlmICghZmlsdGVyIHx8IGluY2x1ZGUgPT09IGZpbHRlci5oYXMobm9kZVskbm9kZU5hbWVdKSkgewogICAgICAgIGNvbnN0IGF2YWlsYWJsZVNwYWNlID0gdGhpc1skZ2V0QXZhaWxhYmxlU3BhY2VdKCk7CiAgICAgICAgY29uc3QgcmVzID0gbm9kZVskdG9IVE1MXShhdmFpbGFibGVTcGFjZSk7CgogICAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXNbJGV4dHJhXS5mYWlsaW5nTm9kZSA9IG5vZGU7CiAgICAgICAgfQoKICAgICAgICB5aWVsZCByZXM7CiAgICAgIH0KICAgIH0KICB9CgogIFskZmx1c2hIVE1MXSgpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgWyRhZGRIVE1MXShodG1sLCBiYm94KSB7CiAgICB0aGlzWyRleHRyYV0uY2hpbGRyZW4ucHVzaChodG1sKTsKICB9CgogIFskZ2V0QXZhaWxhYmxlU3BhY2VdKCkge30KCiAgWyRjaGlsZHJlblRvSFRNTF0oewogICAgZmlsdGVyID0gbnVsbCwKICAgIGluY2x1ZGUgPSB0cnVlCiAgfSkgewogICAgaWYgKCF0aGlzWyRleHRyYV0uZ2VuZXJhdG9yKSB7CiAgICAgIHRoaXNbJGV4dHJhXS5nZW5lcmF0b3IgPSB0aGlzW19maWx0ZXJlZENoaWxkcmVuR2VuZXJhdG9yXShmaWx0ZXIsIGluY2x1ZGUpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgYXZhaWxhYmxlU3BhY2UgPSB0aGlzWyRnZXRBdmFpbGFibGVTcGFjZV0oKTsKICAgICAgY29uc3QgcmVzID0gdGhpc1skZXh0cmFdLmZhaWxpbmdOb2RlWyR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gcmVzOwogICAgICB9CgogICAgICBpZiAocmVzLmh0bWwpIHsKICAgICAgICB0aGlzWyRhZGRIVE1MXShyZXMuaHRtbCwgcmVzLmJib3gpOwogICAgICB9CgogICAgICBkZWxldGUgdGhpc1skZXh0cmFdLmZhaWxpbmdOb2RlOwogICAgfQoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGNvbnN0IGdlbiA9IHRoaXNbJGV4dHJhXS5nZW5lcmF0b3IubmV4dCgpOwoKICAgICAgaWYgKGdlbi5kb25lKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlcyA9IGdlbi52YWx1ZTsKCiAgICAgIGlmICghcmVzLnN1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gcmVzOwogICAgICB9CgogICAgICBpZiAocmVzLmh0bWwpIHsKICAgICAgICB0aGlzWyRhZGRIVE1MXShyZXMuaHRtbCwgcmVzLmJib3gpOwogICAgICB9CiAgICB9CgogICAgdGhpc1skZXh0cmFdLmdlbmVyYXRvciA9IG51bGw7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKICBbJHNldFNldEF0dHJpYnV0ZXNdKGF0dHJpYnV0ZXMpIHsKICAgIHRoaXNbX3NldEF0dHJpYnV0ZXNdID0gbmV3IFNldChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSk7CiAgfQoKICBbX2dldFVuc2V0QXR0cmlidXRlc10ocHJvdG9BdHRyaWJ1dGVzKSB7CiAgICBjb25zdCBhbGxBdHRyID0gdGhpc1tfYXR0cmlidXRlTmFtZXNdOwogICAgY29uc3Qgc2V0QXR0ciA9IHRoaXNbX3NldEF0dHJpYnV0ZXNdOwogICAgcmV0dXJuIFsuLi5wcm90b0F0dHJpYnV0ZXNdLmZpbHRlcih4ID0+IGFsbEF0dHIuaGFzKHgpICYmICFzZXRBdHRyLmhhcyh4KSk7CiAgfQoKICBbJHJlc29sdmVQcm90b3R5cGVzXShpZHMsIGFuY2VzdG9ycyA9IG5ldyBTZXQoKSkgewogICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzW19jaGlsZHJlbl0pIHsKICAgICAgY2hpbGRbX3Jlc29sdmVQcm90b3R5cGVzSGVscGVyXShpZHMsIGFuY2VzdG9ycyk7CiAgICB9CiAgfQoKICBbX3Jlc29sdmVQcm90b3R5cGVzSGVscGVyXShpZHMsIGFuY2VzdG9ycykgewogICAgY29uc3QgcHJvdG8gPSB0aGlzW19nZXRQcm90b3R5cGVdKGlkcywgYW5jZXN0b3JzKTsKCiAgICBpZiAocHJvdG8pIHsKICAgICAgdGhpc1tfYXBwbHlQcm90b3R5cGVdKHByb3RvLCBpZHMsIGFuY2VzdG9ycyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzWyRyZXNvbHZlUHJvdG90eXBlc10oaWRzLCBhbmNlc3RvcnMpOwogICAgfQogIH0KCiAgW19nZXRQcm90b3R5cGVdKGlkcywgYW5jZXN0b3JzKSB7CiAgICBjb25zdCB7CiAgICAgIHVzZSwKICAgICAgdXNlaHJlZgogICAgfSA9IHRoaXM7CgogICAgaWYgKCF1c2UgJiYgIXVzZWhyZWYpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgbGV0IHByb3RvID0gbnVsbDsKICAgIGxldCBzb21FeHByZXNzaW9uID0gbnVsbDsKICAgIGxldCBpZCA9IG51bGw7CiAgICBsZXQgcmVmID0gdXNlOwoKICAgIGlmICh1c2VocmVmKSB7CiAgICAgIHJlZiA9IHVzZWhyZWY7CgogICAgICBpZiAodXNlaHJlZi5zdGFydHNXaXRoKCIjc29tKCIpICYmIHVzZWhyZWYuZW5kc1dpdGgoIikiKSkgewogICAgICAgIHNvbUV4cHJlc3Npb24gPSB1c2VocmVmLnNsaWNlKCIjc29tKCIubGVuZ3RoLCB1c2VocmVmLmxlbmd0aCAtIDEpOwogICAgICB9IGVsc2UgaWYgKHVzZWhyZWYuc3RhcnRzV2l0aCgiLiNzb20oIikgJiYgdXNlaHJlZi5lbmRzV2l0aCgiKSIpKSB7CiAgICAgICAgc29tRXhwcmVzc2lvbiA9IHVzZWhyZWYuc2xpY2UoIi4jc29tKCIubGVuZ3RoLCB1c2VocmVmLmxlbmd0aCAtIDEpOwogICAgICB9IGVsc2UgaWYgKHVzZWhyZWYuc3RhcnRzV2l0aCgiIyIpKSB7CiAgICAgICAgaWQgPSB1c2VocmVmLnNsaWNlKDEpOwogICAgICB9IGVsc2UgaWYgKHVzZWhyZWYuc3RhcnRzV2l0aCgiLiMiKSkgewogICAgICAgIGlkID0gdXNlaHJlZi5zbGljZSgyKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh1c2Uuc3RhcnRzV2l0aCgiIyIpKSB7CiAgICAgIGlkID0gdXNlLnNsaWNlKDEpOwogICAgfSBlbHNlIHsKICAgICAgc29tRXhwcmVzc2lvbiA9IHVzZTsKICAgIH0KCiAgICB0aGlzLnVzZSA9IHRoaXMudXNlaHJlZiA9ICIiOwoKICAgIGlmIChpZCkgewogICAgICBwcm90byA9IGlkcy5nZXQoaWQpOwogICAgfSBlbHNlIHsKICAgICAgcHJvdG8gPSAoMCwgX3NvbS5zZWFyY2hOb2RlKShpZHMuZ2V0KCRyb290KSwgdGhpcywgc29tRXhwcmVzc2lvbiwgdHJ1ZSwgZmFsc2UpOwoKICAgICAgaWYgKHByb3RvKSB7CiAgICAgICAgcHJvdG8gPSBwcm90b1swXTsKICAgICAgfQogICAgfQoKICAgIGlmICghcHJvdG8pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHByb3RvdHlwZSByZWZlcmVuY2U6ICR7cmVmfS5gKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKHByb3RvWyRub2RlTmFtZV0gIT09IHRoaXNbJG5vZGVOYW1lXSkgewogICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEluY29tcGF0aWJsZSBwcm90b3R5cGU6ICR7cHJvdG9bJG5vZGVOYW1lXX0gIT09ICR7dGhpc1skbm9kZU5hbWVdfS5gKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKGFuY2VzdG9ycy5oYXMocHJvdG8pKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gQ3ljbGUgZGV0ZWN0ZWQgaW4gcHJvdG90eXBlcyB1c2UuYCk7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGFuY2VzdG9ycy5hZGQocHJvdG8pOwoKICAgIGNvbnN0IHByb3RvUHJvdG8gPSBwcm90b1tfZ2V0UHJvdG90eXBlXShpZHMsIGFuY2VzdG9ycyk7CgogICAgaWYgKHByb3RvUHJvdG8pIHsKICAgICAgcHJvdG9bX2FwcGx5UHJvdG90eXBlXShwcm90b1Byb3RvLCBpZHMsIGFuY2VzdG9ycyk7CiAgICB9CgogICAgcHJvdG9bJHJlc29sdmVQcm90b3R5cGVzXShpZHMsIGFuY2VzdG9ycyk7CiAgICBhbmNlc3RvcnMuZGVsZXRlKHByb3RvKTsKICAgIHJldHVybiBwcm90bzsKICB9CgogIFtfYXBwbHlQcm90b3R5cGVdKHByb3RvLCBpZHMsIGFuY2VzdG9ycykgewogICAgaWYgKGFuY2VzdG9ycy5oYXMocHJvdG8pKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gQ3ljbGUgZGV0ZWN0ZWQgaW4gcHJvdG90eXBlcyB1c2UuYCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIXRoaXNbJGNvbnRlbnRdICYmIHByb3RvWyRjb250ZW50XSkgewogICAgICB0aGlzWyRjb250ZW50XSA9IHByb3RvWyRjb250ZW50XTsKICAgIH0KCiAgICBjb25zdCBuZXdBbmNlc3RvcnMgPSBuZXcgU2V0KGFuY2VzdG9ycyk7CiAgICBuZXdBbmNlc3RvcnMuYWRkKHByb3RvKTsKCiAgICBmb3IgKGNvbnN0IHVuc2V0QXR0ck5hbWUgb2YgdGhpc1tfZ2V0VW5zZXRBdHRyaWJ1dGVzXShwcm90b1tfc2V0QXR0cmlidXRlc10pKSB7CiAgICAgIHRoaXNbdW5zZXRBdHRyTmFtZV0gPSBwcm90b1t1bnNldEF0dHJOYW1lXTsKCiAgICAgIGlmICh0aGlzW19zZXRBdHRyaWJ1dGVzXSkgewogICAgICAgIHRoaXNbX3NldEF0dHJpYnV0ZXNdLmFkZCh1bnNldEF0dHJOYW1lKTsKICAgICAgfQogICAgfQoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBpZiAodGhpc1tfYXR0cmlidXRlTmFtZXNdLmhhcyhuYW1lKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCB2YWx1ZSA9IHRoaXNbbmFtZV07CiAgICAgIGNvbnN0IHByb3RvVmFsdWUgPSBwcm90b1tuYW1lXTsKCiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFhGQU9iamVjdEFycmF5KSB7CiAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiB2YWx1ZVtfY2hpbGRyZW5dKSB7CiAgICAgICAgICBjaGlsZFtfcmVzb2x2ZVByb3RvdHlwZXNIZWxwZXJdKGlkcywgYW5jZXN0b3JzKTsKICAgICAgICB9CgogICAgICAgIGZvciAobGV0IGkgPSB2YWx1ZVtfY2hpbGRyZW5dLmxlbmd0aCwgaWkgPSBwcm90b1ZhbHVlW19jaGlsZHJlbl0ubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgY29uc3QgY2hpbGQgPSBwcm90b1tfY2hpbGRyZW5dW2ldWyRjbG9uZV0oKTsKCiAgICAgICAgICBpZiAodmFsdWUucHVzaChjaGlsZCkpIHsKICAgICAgICAgICAgY2hpbGRbX3BhcmVudF0gPSB0aGlzOwoKICAgICAgICAgICAgdGhpc1tfY2hpbGRyZW5dLnB1c2goY2hpbGQpOwoKICAgICAgICAgICAgY2hpbGRbX3Jlc29sdmVQcm90b3R5cGVzSGVscGVyXShpZHMsIGFuY2VzdG9ycyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAodmFsdWUgIT09IG51bGwpIHsKICAgICAgICB2YWx1ZVskcmVzb2x2ZVByb3RvdHlwZXNdKGlkcywgYW5jZXN0b3JzKTsKCiAgICAgICAgaWYgKHByb3RvVmFsdWUpIHsKICAgICAgICAgIHZhbHVlW19hcHBseVByb3RvdHlwZV0ocHJvdG9WYWx1ZSwgaWRzLCBhbmNlc3RvcnMpOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChwcm90b1ZhbHVlICE9PSBudWxsKSB7CiAgICAgICAgY29uc3QgY2hpbGQgPSBwcm90b1ZhbHVlWyRjbG9uZV0oKTsKICAgICAgICBjaGlsZFtfcGFyZW50XSA9IHRoaXM7CiAgICAgICAgdGhpc1tuYW1lXSA9IGNoaWxkOwoKICAgICAgICB0aGlzW19jaGlsZHJlbl0ucHVzaChjaGlsZCk7CgogICAgICAgIGNoaWxkW19yZXNvbHZlUHJvdG90eXBlc0hlbHBlcl0oaWRzLCBhbmNlc3RvcnMpOwogICAgICB9CiAgICB9CiAgfQoKICBzdGF0aWMgW19jbG9uZUF0dHJpYnV0ZV0ob2JqKSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIHJldHVybiBvYmoubWFwKHggPT4gWEZBT2JqZWN0W19jbG9uZUF0dHJpYnV0ZV0oeCkpOwogICAgfQoKICAgIGlmICh0eXBlb2Ygb2JqID09PSAib2JqZWN0IiAmJiBvYmogIT09IG51bGwpIHsKICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIG9iaik7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIFskY2xvbmVdKCkgewogICAgY29uc3QgY2xvbmUgPSBPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSk7CgogICAgZm9yIChjb25zdCAkc3ltYm9sIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModGhpcykpIHsKICAgICAgdHJ5IHsKICAgICAgICBjbG9uZVskc3ltYm9sXSA9IHRoaXNbJHN5bWJvbF07CiAgICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgICAoMCwgX3V0aWwuc2hhZG93KShjbG9uZSwgJHN5bWJvbCwgdGhpc1skc3ltYm9sXSk7CiAgICAgIH0KICAgIH0KCiAgICBjbG9uZVskdWlkXSA9IGAke2Nsb25lWyRub2RlTmFtZV19JHt1aWQrK31gOwogICAgY2xvbmVbX2NoaWxkcmVuXSA9IFtdOwoKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBpZiAodGhpc1tfYXR0cmlidXRlTmFtZXNdLmhhcyhuYW1lKSkgewogICAgICAgIGNsb25lW25hbWVdID0gWEZBT2JqZWN0W19jbG9uZUF0dHJpYnV0ZV0odGhpc1tuYW1lXSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZhbHVlID0gdGhpc1tuYW1lXTsKCiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFhGQU9iamVjdEFycmF5KSB7CiAgICAgICAgY2xvbmVbbmFtZV0gPSBuZXcgWEZBT2JqZWN0QXJyYXkodmFsdWVbX21heF0pOwogICAgICB9IGVsc2UgewogICAgICAgIGNsb25lW25hbWVdID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfY2hpbGRyZW5dKSB7CiAgICAgIGNvbnN0IG5hbWUgPSBjaGlsZFskbm9kZU5hbWVdOwogICAgICBjb25zdCBjbG9uZWRDaGlsZCA9IGNoaWxkWyRjbG9uZV0oKTsKCiAgICAgIGNsb25lW19jaGlsZHJlbl0ucHVzaChjbG9uZWRDaGlsZCk7CgogICAgICBjbG9uZWRDaGlsZFtfcGFyZW50XSA9IGNsb25lOwoKICAgICAgaWYgKGNsb25lW25hbWVdID09PSBudWxsKSB7CiAgICAgICAgY2xvbmVbbmFtZV0gPSBjbG9uZWRDaGlsZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjbG9uZVtuYW1lXVtfY2hpbGRyZW5dLnB1c2goY2xvbmVkQ2hpbGQpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGNsb25lOwogIH0KCiAgWyRnZXRDaGlsZHJlbl0obmFtZSA9IG51bGwpIHsKICAgIGlmICghbmFtZSkgewogICAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dOwogICAgfQoKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl0uZmlsdGVyKGMgPT4gY1skbm9kZU5hbWVdID09PSBuYW1lKTsKICB9CgogIFskZ2V0Q2hpbGRyZW5CeUNsYXNzXShuYW1lKSB7CiAgICByZXR1cm4gdGhpc1tuYW1lXTsKICB9CgogIFskZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBmaXJzdCA9IHRydWUpIHsKICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXNbJGdldENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBmaXJzdCkpOwogIH0KCiAgKlskZ2V0Q2hpbGRyZW5CeU5hbWVJdF0obmFtZSwgYWxsVHJhbnNwYXJlbnQsIGZpcnN0ID0gdHJ1ZSkgewogICAgaWYgKG5hbWUgPT09ICJwYXJlbnQiKSB7CiAgICAgIHlpZWxkIHRoaXNbX3BhcmVudF07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICBpZiAoY2hpbGRbJG5vZGVOYW1lXSA9PT0gbmFtZSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoY2hpbGQubmFtZSA9PT0gbmFtZSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoYWxsVHJhbnNwYXJlbnQgfHwgY2hpbGRbJGlzVHJhbnNwYXJlbnRdKCkpIHsKICAgICAgICB5aWVsZCogY2hpbGRbJGdldENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBmYWxzZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZmlyc3QgJiYgdGhpc1tfYXR0cmlidXRlTmFtZXNdLmhhcyhuYW1lKSkgewogICAgICB5aWVsZCBuZXcgWEZBQXR0cmlidXRlKHRoaXMsIG5hbWUsIHRoaXNbbmFtZV0pOwogICAgfQogIH0KCn0KCmV4cG9ydHMuWEZBT2JqZWN0ID0gWEZBT2JqZWN0OwoKY2xhc3MgWEZBT2JqZWN0QXJyYXkgewogIGNvbnN0cnVjdG9yKG1heCA9IEluZmluaXR5KSB7CiAgICB0aGlzW19tYXhdID0gbWF4OwogICAgdGhpc1tfY2hpbGRyZW5dID0gW107CiAgfQoKICBwdXNoKGNoaWxkKSB7CiAgICBjb25zdCBsZW4gPSB0aGlzW19jaGlsZHJlbl0ubGVuZ3RoOwoKICAgIGlmIChsZW4gPD0gdGhpc1tfbWF4XSkgewogICAgICB0aGlzW19jaGlsZHJlbl0ucHVzaChjaGlsZCk7CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIG5vZGUgIiR7Y2hpbGRbJG5vZGVOYW1lXX0iIGFjY2VwdHMgbm8gbW9yZSB0aGFuICR7dGhpc1tfbWF4XX0gY2hpbGRyZW5gKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlzRW1wdHkoKSB7CiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMDsKICB9CgogIGR1bXAoKSB7CiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMSA/IHRoaXNbX2NoaWxkcmVuXVswXVskZHVtcF0oKSA6IHRoaXNbX2NoaWxkcmVuXS5tYXAoeCA9PiB4WyRkdW1wXSgpKTsKICB9CgogIFskY2xvbmVdKCkgewogICAgY29uc3QgY2xvbmUgPSBuZXcgWEZBT2JqZWN0QXJyYXkodGhpc1tfbWF4XSk7CiAgICBjbG9uZVtfY2hpbGRyZW5dID0gdGhpc1tfY2hpbGRyZW5dLm1hcChjID0+IGNbJGNsb25lXSgpKTsKICAgIHJldHVybiBjbG9uZTsKICB9CgogIGdldCBjaGlsZHJlbigpIHsKICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl07CiAgfQoKICBjbGVhcigpIHsKICAgIHRoaXNbX2NoaWxkcmVuXS5sZW5ndGggPSAwOwogIH0KCn0KCmV4cG9ydHMuWEZBT2JqZWN0QXJyYXkgPSBYRkFPYmplY3RBcnJheTsKCmNsYXNzIFhGQUF0dHJpYnV0ZSB7CiAgY29uc3RydWN0b3Iobm9kZSwgbmFtZSwgdmFsdWUpIHsKICAgIHRoaXNbX3BhcmVudF0gPSBub2RlOwogICAgdGhpc1skbm9kZU5hbWVdID0gbmFtZTsKICAgIHRoaXNbJGNvbnRlbnRdID0gdmFsdWU7CiAgICB0aGlzWyRjb25zdW1lZF0gPSBmYWxzZTsKICAgIHRoaXNbJHVpZF0gPSBgYXR0cmlidXRlJHt1aWQrK31gOwogIH0KCiAgWyRnZXRQYXJlbnRdKCkgewogICAgcmV0dXJuIHRoaXNbX3BhcmVudF07CiAgfQoKICBbJGlzRGF0YVZhbHVlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgWyRnZXREYXRhVmFsdWVdKCkgewogICAgcmV0dXJuIHRoaXNbJGNvbnRlbnRdLnRyaW0oKTsKICB9CgogIFskc2V0VmFsdWVdKHZhbHVlKSB7CiAgICB2YWx1ZSA9IHZhbHVlLnZhbHVlIHx8ICIiOwogICAgdGhpc1skY29udGVudF0gPSB2YWx1ZS50b1N0cmluZygpOwogIH0KCiAgWyR0ZXh0XSgpIHsKICAgIHJldHVybiB0aGlzWyRjb250ZW50XTsKICB9CgogIFskaXNEZXNjZW5kZW50XShwYXJlbnQpIHsKICAgIHJldHVybiB0aGlzW19wYXJlbnRdID09PSBwYXJlbnQgfHwgdGhpc1tfcGFyZW50XVskaXNEZXNjZW5kZW50XShwYXJlbnQpOwogIH0KCn0KCmV4cG9ydHMuWEZBQXR0cmlidXRlID0gWEZBQXR0cmlidXRlOwoKY2xhc3MgWG1sT2JqZWN0IGV4dGVuZHMgWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3Rvcihuc0lkLCBuYW1lLCBhdHRyaWJ1dGVzID0ge30pIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUpOwogICAgdGhpc1skY29udGVudF0gPSAiIjsKICAgIHRoaXNbX2RhdGFWYWx1ZV0gPSBudWxsOwoKICAgIGlmIChuYW1lICE9PSAiI3RleHQiKSB7CiAgICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsKICAgICAgdGhpc1tfYXR0cmlidXRlc10gPSBtYXA7CgogICAgICBmb3IgKGNvbnN0IFthdHRyTmFtZSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGF0dHJpYnV0ZXMpKSB7CiAgICAgICAgbWFwLnNldChhdHRyTmFtZSwgbmV3IFhGQUF0dHJpYnV0ZSh0aGlzLCBhdHRyTmFtZSwgdmFsdWUpKTsKICAgICAgfQoKICAgICAgaWYgKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoJG5zQXR0cmlidXRlcykpIHsKICAgICAgICBjb25zdCBkYXRhTm9kZSA9IGF0dHJpYnV0ZXNbJG5zQXR0cmlidXRlc10ueGZhLmRhdGFOb2RlOwoKICAgICAgICBpZiAoZGF0YU5vZGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKGRhdGFOb2RlID09PSAiZGF0YUdyb3VwIikgewogICAgICAgICAgICB0aGlzW19kYXRhVmFsdWVdID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFOb2RlID09PSAiZGF0YVZhbHVlIikgewogICAgICAgICAgICB0aGlzW19kYXRhVmFsdWVdID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzWyRjb25zdW1lZF0gPSBmYWxzZTsKICB9CgogIFskdG9TdHJpbmddKGJ1ZikgewogICAgY29uc3QgdGFnTmFtZSA9IHRoaXNbJG5vZGVOYW1lXTsKCiAgICBpZiAodGFnTmFtZSA9PT0gIiN0ZXh0IikgewogICAgICBidWYucHVzaCgoMCwgX2NvcmVfdXRpbHMuZW5jb2RlVG9YbWxTdHJpbmcpKHRoaXNbJGNvbnRlbnRdKSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB1dGY4VGFnTmFtZSA9ICgwLCBfdXRpbC51dGY4U3RyaW5nVG9TdHJpbmcpKHRhZ05hbWUpOwogICAgY29uc3QgcHJlZml4ID0gdGhpc1skbmFtZXNwYWNlSWRdID09PSBOU19EQVRBU0VUUyA/ICJ4ZmE6IiA6ICIiOwogICAgYnVmLnB1c2goYDwke3ByZWZpeH0ke3V0ZjhUYWdOYW1lfWApOwoKICAgIGZvciAoY29uc3QgW25hbWUsIHZhbHVlXSBvZiB0aGlzW19hdHRyaWJ1dGVzXS5lbnRyaWVzKCkpIHsKICAgICAgY29uc3QgdXRmOE5hbWUgPSAoMCwgX3V0aWwudXRmOFN0cmluZ1RvU3RyaW5nKShuYW1lKTsKICAgICAgYnVmLnB1c2goYCAke3V0ZjhOYW1lfT0iJHsoMCwgX2NvcmVfdXRpbHMuZW5jb2RlVG9YbWxTdHJpbmcpKHZhbHVlWyRjb250ZW50XSl9ImApOwogICAgfQoKICAgIGlmICh0aGlzW19kYXRhVmFsdWVdICE9PSBudWxsKSB7CiAgICAgIGlmICh0aGlzW19kYXRhVmFsdWVdKSB7CiAgICAgICAgYnVmLnB1c2goYCB4ZmE6ZGF0YU5vZGU9ImRhdGFWYWx1ZSJgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWYucHVzaChgIHhmYTpkYXRhTm9kZT0iZGF0YUdyb3VwImApOwogICAgICB9CiAgICB9CgogICAgaWYgKCF0aGlzWyRjb250ZW50XSAmJiB0aGlzW19jaGlsZHJlbl0ubGVuZ3RoID09PSAwKSB7CiAgICAgIGJ1Zi5wdXNoKCIvPiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgYnVmLnB1c2goIj4iKTsKCiAgICBpZiAodGhpc1skY29udGVudF0pIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzWyRjb250ZW50XSA9PT0gInN0cmluZyIpIHsKICAgICAgICBidWYucHVzaCgoMCwgX2NvcmVfdXRpbHMuZW5jb2RlVG9YbWxTdHJpbmcpKHRoaXNbJGNvbnRlbnRdKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpc1skY29udGVudF1bJHRvU3RyaW5nXShidWYpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICAgIGNoaWxkWyR0b1N0cmluZ10oYnVmKTsKICAgICAgfQogICAgfQoKICAgIGJ1Zi5wdXNoKGA8LyR7cHJlZml4fSR7dXRmOFRhZ05hbWV9PmApOwogIH0KCiAgWyRvbkNoaWxkXShjaGlsZCkgewogICAgaWYgKHRoaXNbJGNvbnRlbnRdKSB7CiAgICAgIGNvbnN0IG5vZGUgPSBuZXcgWG1sT2JqZWN0KHRoaXNbJG5hbWVzcGFjZUlkXSwgIiN0ZXh0Iik7CiAgICAgIHRoaXNbJGFwcGVuZENoaWxkXShub2RlKTsKICAgICAgbm9kZVskY29udGVudF0gPSB0aGlzWyRjb250ZW50XTsKICAgICAgdGhpc1skY29udGVudF0gPSAiIjsKICAgIH0KCiAgICB0aGlzWyRhcHBlbmRDaGlsZF0oY2hpbGQpOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbJG9uVGV4dF0oc3RyKSB7CiAgICB0aGlzWyRjb250ZW50XSArPSBzdHI7CiAgfQoKICBbJGZpbmFsaXplXSgpIHsKICAgIGlmICh0aGlzWyRjb250ZW50XSAmJiB0aGlzW19jaGlsZHJlbl0ubGVuZ3RoID4gMCkgewogICAgICBjb25zdCBub2RlID0gbmV3IFhtbE9iamVjdCh0aGlzWyRuYW1lc3BhY2VJZF0sICIjdGV4dCIpOwogICAgICB0aGlzWyRhcHBlbmRDaGlsZF0obm9kZSk7CiAgICAgIG5vZGVbJGNvbnRlbnRdID0gdGhpc1skY29udGVudF07CiAgICAgIGRlbGV0ZSB0aGlzWyRjb250ZW50XTsKICAgIH0KICB9CgogIFskdG9IVE1MXSgpIHsKICAgIGlmICh0aGlzWyRub2RlTmFtZV0gPT09ICIjdGV4dCIpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICAgIG5hbWU6ICIjdGV4dCIsCiAgICAgICAgdmFsdWU6IHRoaXNbJGNvbnRlbnRdCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICB9CgogIFskZ2V0Q2hpbGRyZW5dKG5hbWUgPSBudWxsKSB7CiAgICBpZiAoIW5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXNbX2NoaWxkcmVuXTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmZpbHRlcihjID0+IGNbJG5vZGVOYW1lXSA9PT0gbmFtZSk7CiAgfQoKICBbJGdldEF0dHJpYnV0ZXNdKCkgewogICAgcmV0dXJuIHRoaXNbX2F0dHJpYnV0ZXNdOwogIH0KCiAgWyRnZXRDaGlsZHJlbkJ5Q2xhc3NdKG5hbWUpIHsKICAgIGNvbnN0IHZhbHVlID0gdGhpc1tfYXR0cmlidXRlc10uZ2V0KG5hbWUpOwoKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1skZ2V0Q2hpbGRyZW5dKG5hbWUpOwogIH0KCiAgKlskZ2V0Q2hpbGRyZW5CeU5hbWVJdF0obmFtZSwgYWxsVHJhbnNwYXJlbnQpIHsKICAgIGNvbnN0IHZhbHVlID0gdGhpc1tfYXR0cmlidXRlc10uZ2V0KG5hbWUpOwoKICAgIGlmICh2YWx1ZSkgewogICAgICB5aWVsZCB2YWx1ZTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICBpZiAoY2hpbGRbJG5vZGVOYW1lXSA9PT0gbmFtZSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoYWxsVHJhbnNwYXJlbnQpIHsKICAgICAgICB5aWVsZCogY2hpbGRbJGdldENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50KTsKICAgICAgfQogICAgfQogIH0KCiAgKlskZ2V0QXR0cmlidXRlSXRdKG5hbWUsIHNraXBDb25zdW1lZCkgewogICAgY29uc3QgdmFsdWUgPSB0aGlzW19hdHRyaWJ1dGVzXS5nZXQobmFtZSk7CgogICAgaWYgKHZhbHVlICYmICghc2tpcENvbnN1bWVkIHx8ICF2YWx1ZVskY29uc3VtZWRdKSkgewogICAgICB5aWVsZCB2YWx1ZTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX2NoaWxkcmVuXSkgewogICAgICB5aWVsZCogY2hpbGRbJGdldEF0dHJpYnV0ZUl0XShuYW1lLCBza2lwQ29uc3VtZWQpOwogICAgfQogIH0KCiAgKlskZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGFsbFRyYW5zcGFyZW50LCBza2lwQ29uc3VtZWQpIHsKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfY2hpbGRyZW5dKSB7CiAgICAgIGlmIChjaGlsZFskbm9kZU5hbWVdID09PSBuYW1lICYmICghc2tpcENvbnN1bWVkIHx8ICFjaGlsZFskY29uc3VtZWRdKSkgewogICAgICAgIHlpZWxkIGNoaWxkOwogICAgICB9CgogICAgICBpZiAoYWxsVHJhbnNwYXJlbnQpIHsKICAgICAgICB5aWVsZCogY2hpbGRbJGdldFJlYWxDaGlsZHJlbkJ5TmFtZUl0XShuYW1lLCBhbGxUcmFuc3BhcmVudCwgc2tpcENvbnN1bWVkKTsKICAgICAgfQogICAgfQogIH0KCiAgWyRpc0RhdGFWYWx1ZV0oKSB7CiAgICBpZiAodGhpc1tfZGF0YVZhbHVlXSA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdGhpc1tfY2hpbGRyZW5dLmxlbmd0aCA9PT0gMCB8fCB0aGlzW19jaGlsZHJlbl1bMF1bJG5hbWVzcGFjZUlkXSA9PT0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhodG1sLmlkOwogICAgfQoKICAgIHJldHVybiB0aGlzW19kYXRhVmFsdWVdOwogIH0KCiAgWyRnZXREYXRhVmFsdWVdKCkgewogICAgaWYgKHRoaXNbX2RhdGFWYWx1ZV0gPT09IG51bGwpIHsKICAgICAgaWYgKHRoaXNbX2NoaWxkcmVuXS5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpc1skY29udGVudF0udHJpbSgpOwogICAgICB9CgogICAgICBpZiAodGhpc1tfY2hpbGRyZW5dWzBdWyRuYW1lc3BhY2VJZF0gPT09IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy54aHRtbC5pZCkgewogICAgICAgIHJldHVybiB0aGlzW19jaGlsZHJlbl1bMF1bJHRleHRdKCkudHJpbSgpOwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICByZXR1cm4gdGhpc1skY29udGVudF0udHJpbSgpOwogIH0KCiAgWyRzZXRWYWx1ZV0odmFsdWUpIHsKICAgIHZhbHVlID0gdmFsdWUudmFsdWUgfHwgIiI7CiAgICB0aGlzWyRjb250ZW50XSA9IHZhbHVlLnRvU3RyaW5nKCk7CiAgfQoKICBbJGR1bXBdKGhhc05TID0gZmFsc2UpIHsKICAgIGNvbnN0IGR1bXBlZCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgaWYgKGhhc05TKSB7CiAgICAgIGR1bXBlZC4kbnMgPSB0aGlzWyRuYW1lc3BhY2VJZF07CiAgICB9CgogICAgaWYgKHRoaXNbJGNvbnRlbnRdKSB7CiAgICAgIGR1bXBlZC4kY29udGVudCA9IHRoaXNbJGNvbnRlbnRdOwogICAgfQoKICAgIGR1bXBlZC4kbmFtZSA9IHRoaXNbJG5vZGVOYW1lXTsKICAgIGR1bXBlZC5jaGlsZHJlbiA9IFtdOwoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpc1tfY2hpbGRyZW5dKSB7CiAgICAgIGR1bXBlZC5jaGlsZHJlbi5wdXNoKGNoaWxkWyRkdW1wXShoYXNOUykpOwogICAgfQoKICAgIGR1bXBlZC5hdHRyaWJ1dGVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgdGhpc1tfYXR0cmlidXRlc10pIHsKICAgICAgZHVtcGVkLmF0dHJpYnV0ZXNbbmFtZV0gPSB2YWx1ZVskY29udGVudF07CiAgICB9CgogICAgcmV0dXJuIGR1bXBlZDsKICB9Cgp9CgpleHBvcnRzLlhtbE9iamVjdCA9IFhtbE9iamVjdDsKCmNsYXNzIENvbnRlbnRPYmplY3QgZXh0ZW5kcyBYRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKG5zSWQsIG5hbWUpIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUpOwogICAgdGhpc1skY29udGVudF0gPSAiIjsKICB9CgogIFskb25UZXh0XSh0ZXh0KSB7CiAgICB0aGlzWyRjb250ZW50XSArPSB0ZXh0OwogIH0KCiAgWyRmaW5hbGl6ZV0oKSB7fQoKfQoKZXhwb3J0cy5Db250ZW50T2JqZWN0ID0gQ29udGVudE9iamVjdDsKCmNsYXNzIE9wdGlvbk9iamVjdCBleHRlbmRzIENvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKG5zSWQsIG5hbWUsIG9wdGlvbnMpIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUpOwogICAgdGhpc1tfb3B0aW9uc10gPSBvcHRpb25zOwogIH0KCiAgWyRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzWyRjb250ZW50XSA9ICgwLCBfdXRpbHMuZ2V0S2V5d29yZCkoewogICAgICBkYXRhOiB0aGlzWyRjb250ZW50XSwKICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzW19vcHRpb25zXVswXSwKICAgICAgdmFsaWRhdGU6IGsgPT4gdGhpc1tfb3B0aW9uc10uaW5jbHVkZXMoaykKICAgIH0pOwogIH0KCiAgWyRjbGVhbl0oYnVpbGRlcikgewogICAgc3VwZXJbJGNsZWFuXShidWlsZGVyKTsKICAgIGRlbGV0ZSB0aGlzW19vcHRpb25zXTsKICB9Cgp9CgpleHBvcnRzLk9wdGlvbk9iamVjdCA9IE9wdGlvbk9iamVjdDsKCmNsYXNzIFN0cmluZ09iamVjdCBleHRlbmRzIENvbnRlbnRPYmplY3QgewogIFskZmluYWxpemVdKCkgewogICAgdGhpc1skY29udGVudF0gPSB0aGlzWyRjb250ZW50XS50cmltKCk7CiAgfQoKfQoKZXhwb3J0cy5TdHJpbmdPYmplY3QgPSBTdHJpbmdPYmplY3Q7CgpjbGFzcyBJbnRlZ2VyT2JqZWN0IGV4dGVuZHMgQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IobnNJZCwgbmFtZSwgZGVmYXVsdFZhbHVlLCB2YWxpZGF0b3IpIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUpOwogICAgdGhpc1tfZGVmYXVsdFZhbHVlXSA9IGRlZmF1bHRWYWx1ZTsKICAgIHRoaXNbX3ZhbGlkYXRvcl0gPSB2YWxpZGF0b3I7CiAgfQoKICBbJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbJGNvbnRlbnRdID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IHRoaXNbJGNvbnRlbnRdLAogICAgICBkZWZhdWx0VmFsdWU6IHRoaXNbX2RlZmF1bHRWYWx1ZV0sCiAgICAgIHZhbGlkYXRlOiB0aGlzW192YWxpZGF0b3JdCiAgICB9KTsKICB9CgogIFskY2xlYW5dKGJ1aWxkZXIpIHsKICAgIHN1cGVyWyRjbGVhbl0oYnVpbGRlcik7CiAgICBkZWxldGUgdGhpc1tfZGVmYXVsdFZhbHVlXTsKICAgIGRlbGV0ZSB0aGlzW192YWxpZGF0b3JdOwogIH0KCn0KCmV4cG9ydHMuSW50ZWdlck9iamVjdCA9IEludGVnZXJPYmplY3Q7CgpjbGFzcyBPcHRpb24wMSBleHRlbmRzIEludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKG5zSWQsIG5hbWUpIHsKICAgIHN1cGVyKG5zSWQsIG5hbWUsIDAsIG4gPT4gbiA9PT0gMSk7CiAgfQoKfQoKZXhwb3J0cy5PcHRpb24wMSA9IE9wdGlvbjAxOwoKY2xhc3MgT3B0aW9uMTAgZXh0ZW5kcyBJbnRlZ2VyT2JqZWN0IHsKICBjb25zdHJ1Y3Rvcihuc0lkLCBuYW1lKSB7CiAgICBzdXBlcihuc0lkLCBuYW1lLCAxLCBuID0+IG4gPT09IDApOwogIH0KCn0KCmV4cG9ydHMuT3B0aW9uMTAgPSBPcHRpb24xMDsKCi8qKiovIH0pLAovKiA3OCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkhUTUxSZXN1bHQgPSB2b2lkIDA7CmV4cG9ydHMuZ2V0QkJveCA9IGdldEJCb3g7CmV4cG9ydHMuZ2V0Q29sb3IgPSBnZXRDb2xvcjsKZXhwb3J0cy5nZXRGbG9hdCA9IGdldEZsb2F0OwpleHBvcnRzLmdldEludGVnZXIgPSBnZXRJbnRlZ2VyOwpleHBvcnRzLmdldEtleXdvcmQgPSBnZXRLZXl3b3JkOwpleHBvcnRzLmdldE1lYXN1cmVtZW50ID0gZ2V0TWVhc3VyZW1lbnQ7CmV4cG9ydHMuZ2V0UmF0aW8gPSBnZXRSYXRpbzsKZXhwb3J0cy5nZXRSZWxldmFudCA9IGdldFJlbGV2YW50OwpleHBvcnRzLmdldFN0cmluZ09wdGlvbiA9IGdldFN0cmluZ09wdGlvbjsKZXhwb3J0cy5zdHJpcFF1b3RlcyA9IHN0cmlwUXVvdGVzOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IGRpbUNvbnZlcnRlcnMgPSB7CiAgcHQ6IHggPT4geCwKICBjbTogeCA9PiB4IC8gMi41NCAqIDcyLAogIG1tOiB4ID0+IHggLyAoMTAgKiAyLjU0KSAqIDcyLAogIGluOiB4ID0+IHggKiA3MiwKICBweDogeCA9PiB4Cn07CmNvbnN0IG1lYXN1cmVtZW50UGF0dGVybiA9IC8oWystXT9cZCtcLj9cZCopKC4qKS87CgpmdW5jdGlvbiBzdHJpcFF1b3RlcyhzdHIpIHsKICBpZiAoc3RyLnN0YXJ0c1dpdGgoIiciKSB8fCBzdHIuc3RhcnRzV2l0aCgnIicpKSB7CiAgICByZXR1cm4gc3RyLnNsaWNlKDEsIHN0ci5sZW5ndGggLSAxKTsKICB9CgogIHJldHVybiBzdHI7Cn0KCmZ1bmN0aW9uIGdldEludGVnZXIoewogIGRhdGEsCiAgZGVmYXVsdFZhbHVlLAogIHZhbGlkYXRlCn0pIHsKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiBkZWZhdWx0VmFsdWU7CiAgfQoKICBkYXRhID0gZGF0YS50cmltKCk7CiAgY29uc3QgbiA9IHBhcnNlSW50KGRhdGEsIDEwKTsKCiAgaWYgKCFpc05hTihuKSAmJiB2YWxpZGF0ZShuKSkgewogICAgcmV0dXJuIG47CiAgfQoKICByZXR1cm4gZGVmYXVsdFZhbHVlOwp9CgpmdW5jdGlvbiBnZXRGbG9hdCh7CiAgZGF0YSwKICBkZWZhdWx0VmFsdWUsCiAgdmFsaWRhdGUKfSkgewogIGlmICghZGF0YSkgewogICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKICB9CgogIGRhdGEgPSBkYXRhLnRyaW0oKTsKICBjb25zdCBuID0gcGFyc2VGbG9hdChkYXRhKTsKCiAgaWYgKCFpc05hTihuKSAmJiB2YWxpZGF0ZShuKSkgewogICAgcmV0dXJuIG47CiAgfQoKICByZXR1cm4gZGVmYXVsdFZhbHVlOwp9CgpmdW5jdGlvbiBnZXRLZXl3b3JkKHsKICBkYXRhLAogIGRlZmF1bHRWYWx1ZSwKICB2YWxpZGF0ZQp9KSB7CiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm4gZGVmYXVsdFZhbHVlOwogIH0KCiAgZGF0YSA9IGRhdGEudHJpbSgpOwoKICBpZiAodmFsaWRhdGUoZGF0YSkpIHsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKfQoKZnVuY3Rpb24gZ2V0U3RyaW5nT3B0aW9uKGRhdGEsIG9wdGlvbnMpIHsKICByZXR1cm4gZ2V0S2V5d29yZCh7CiAgICBkYXRhLAogICAgZGVmYXVsdFZhbHVlOiBvcHRpb25zWzBdLAogICAgdmFsaWRhdGU6IGsgPT4gb3B0aW9ucy5pbmNsdWRlcyhrKQogIH0pOwp9CgpmdW5jdGlvbiBnZXRNZWFzdXJlbWVudChzdHIsIGRlZiA9ICIwIikgewogIGRlZiA9IGRlZiB8fCAiMCI7CgogIGlmICghc3RyKSB7CiAgICByZXR1cm4gZ2V0TWVhc3VyZW1lbnQoZGVmKTsKICB9CgogIGNvbnN0IG1hdGNoID0gc3RyLnRyaW0oKS5tYXRjaChtZWFzdXJlbWVudFBhdHRlcm4pOwoKICBpZiAoIW1hdGNoKSB7CiAgICByZXR1cm4gZ2V0TWVhc3VyZW1lbnQoZGVmKTsKICB9CgogIGNvbnN0IFssIHZhbHVlU3RyLCB1bml0XSA9IG1hdGNoOwogIGNvbnN0IHZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZVN0cik7CgogIGlmIChpc05hTih2YWx1ZSkpIHsKICAgIHJldHVybiBnZXRNZWFzdXJlbWVudChkZWYpOwogIH0KCiAgaWYgKHZhbHVlID09PSAwKSB7CiAgICByZXR1cm4gMDsKICB9CgogIGNvbnN0IGNvbnYgPSBkaW1Db252ZXJ0ZXJzW3VuaXRdOwoKICBpZiAoY29udikgewogICAgcmV0dXJuIGNvbnYodmFsdWUpOwogIH0KCiAgcmV0dXJuIHZhbHVlOwp9CgpmdW5jdGlvbiBnZXRSYXRpbyhkYXRhKSB7CiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm4gewogICAgICBudW06IDEsCiAgICAgIGRlbjogMQogICAgfTsKICB9CgogIGNvbnN0IHJhdGlvID0gZGF0YS50cmltKCkuc3BsaXQoL1xzKjpccyovKS5tYXAoeCA9PiBwYXJzZUZsb2F0KHgpKS5maWx0ZXIoeCA9PiAhaXNOYU4oeCkpOwoKICBpZiAocmF0aW8ubGVuZ3RoID09PSAxKSB7CiAgICByYXRpby5wdXNoKDEpOwogIH0KCiAgaWYgKHJhdGlvLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIHsKICAgICAgbnVtOiAxLAogICAgICBkZW46IDEKICAgIH07CiAgfQoKICBjb25zdCBbbnVtLCBkZW5dID0gcmF0aW87CiAgcmV0dXJuIHsKICAgIG51bSwKICAgIGRlbgogIH07Cn0KCmZ1bmN0aW9uIGdldFJlbGV2YW50KGRhdGEpIHsKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiBbXTsKICB9CgogIHJldHVybiBkYXRhLnRyaW0oKS5zcGxpdCgvXHMrLykubWFwKGUgPT4gewogICAgcmV0dXJuIHsKICAgICAgZXhjbHVkZWQ6IGVbMF0gPT09ICItIiwKICAgICAgdmlld25hbWU6IGUuc3Vic3RyaW5nKDEpCiAgICB9OwogIH0pOwp9CgpmdW5jdGlvbiBnZXRDb2xvcihkYXRhLCBkZWYgPSBbMCwgMCwgMF0pIHsKICBsZXQgW3IsIGcsIGJdID0gZGVmOwoKICBpZiAoIWRhdGEpIHsKICAgIHJldHVybiB7CiAgICAgIHIsCiAgICAgIGcsCiAgICAgIGIKICAgIH07CiAgfQoKICBjb25zdCBjb2xvciA9IGRhdGEudHJpbSgpLnNwbGl0KC9ccyosXHMqLykubWFwKGMgPT4gTWF0aC5taW4oTWF0aC5tYXgoMCwgcGFyc2VJbnQoYy50cmltKCksIDEwKSksIDI1NSkpLm1hcChjID0+IGlzTmFOKGMpID8gMCA6IGMpOwoKICBpZiAoY29sb3IubGVuZ3RoIDwgMykgewogICAgcmV0dXJuIHsKICAgICAgciwKICAgICAgZywKICAgICAgYgogICAgfTsKICB9CgogIFtyLCBnLCBiXSA9IGNvbG9yOwogIHJldHVybiB7CiAgICByLAogICAgZywKICAgIGIKICB9Owp9CgpmdW5jdGlvbiBnZXRCQm94KGRhdGEpIHsKICBjb25zdCBkZWYgPSAtMTsKCiAgaWYgKCFkYXRhKSB7CiAgICByZXR1cm4gewogICAgICB4OiBkZWYsCiAgICAgIHk6IGRlZiwKICAgICAgd2lkdGg6IGRlZiwKICAgICAgaGVpZ2h0OiBkZWYKICAgIH07CiAgfQoKICBjb25zdCBiYm94ID0gZGF0YS50cmltKCkuc3BsaXQoL1xzKixccyovKS5tYXAobSA9PiBnZXRNZWFzdXJlbWVudChtLCAiLTEiKSk7CgogIGlmIChiYm94Lmxlbmd0aCA8IDQgfHwgYmJveFsyXSA8IDAgfHwgYmJveFszXSA8IDApIHsKICAgIHJldHVybiB7CiAgICAgIHg6IGRlZiwKICAgICAgeTogZGVmLAogICAgICB3aWR0aDogZGVmLAogICAgICBoZWlnaHQ6IGRlZgogICAgfTsKICB9CgogIGNvbnN0IFt4LCB5LCB3aWR0aCwgaGVpZ2h0XSA9IGJib3g7CiAgcmV0dXJuIHsKICAgIHgsCiAgICB5LAogICAgd2lkdGgsCiAgICBoZWlnaHQKICB9Owp9CgpjbGFzcyBIVE1MUmVzdWx0IHsKICBzdGF0aWMgZ2V0IEZBSUxVUkUoKSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIkZBSUxVUkUiLCBuZXcgSFRNTFJlc3VsdChmYWxzZSwgbnVsbCwgbnVsbCwgbnVsbCkpOwogIH0KCiAgc3RhdGljIGdldCBFTVBUWSgpIHsKICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiRU1QVFkiLCBuZXcgSFRNTFJlc3VsdCh0cnVlLCBudWxsLCBudWxsLCBudWxsKSk7CiAgfQoKICBjb25zdHJ1Y3RvcihzdWNjZXNzLCBodG1sLCBiYm94LCBicmVha05vZGUpIHsKICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3M7CiAgICB0aGlzLmh0bWwgPSBodG1sOwogICAgdGhpcy5iYm94ID0gYmJveDsKICAgIHRoaXMuYnJlYWtOb2RlID0gYnJlYWtOb2RlOwogIH0KCiAgaXNCcmVhaygpIHsKICAgIHJldHVybiAhIXRoaXMuYnJlYWtOb2RlOwogIH0KCiAgc3RhdGljIGJyZWFrTm9kZShub2RlKSB7CiAgICByZXR1cm4gbmV3IEhUTUxSZXN1bHQoZmFsc2UsIG51bGwsIG51bGwsIG5vZGUpOwogIH0KCiAgc3RhdGljIHN1Y2Nlc3MoaHRtbCwgYmJveCA9IG51bGwpIHsKICAgIHJldHVybiBuZXcgSFRNTFJlc3VsdCh0cnVlLCBodG1sLCBiYm94LCBudWxsKTsKICB9Cgp9CgpleHBvcnRzLkhUTUxSZXN1bHQgPSBIVE1MUmVzdWx0OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMpID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTmFtZXNwYWNlSWRzID0gZXhwb3J0cy4kYnVpbGRYRkFPYmplY3QgPSB2b2lkIDA7CmNvbnN0ICRidWlsZFhGQU9iamVjdCA9IFN5bWJvbCgpOwpleHBvcnRzLiRidWlsZFhGQU9iamVjdCA9ICRidWlsZFhGQU9iamVjdDsKY29uc3QgTmFtZXNwYWNlSWRzID0gewogIGNvbmZpZzogewogICAgaWQ6IDAsCiAgICBjaGVjazogbnMgPT4gbnMuc3RhcnRzV2l0aCgiaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94Y2kvIikKICB9LAogIGNvbm5lY3Rpb25TZXQ6IHsKICAgIGlkOiAxLAogICAgY2hlY2s6IG5zID0+IG5zLnN0YXJ0c1dpdGgoImh0dHA6Ly93d3cueGZhLm9yZy9zY2hlbWEveGZhLWNvbm5lY3Rpb24tc2V0LyIpCiAgfSwKICBkYXRhc2V0czogewogICAgaWQ6IDIsCiAgICBjaGVjazogbnMgPT4gbnMuc3RhcnRzV2l0aCgiaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94ZmEtZGF0YS8iKQogIH0sCiAgZm9ybTogewogICAgaWQ6IDMsCiAgICBjaGVjazogbnMgPT4gbnMuc3RhcnRzV2l0aCgiaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94ZmEtZm9ybS8iKQogIH0sCiAgbG9jYWxlU2V0OiB7CiAgICBpZDogNCwKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hmYS1sb2NhbGUtc2V0LyIpCiAgfSwKICBwZGY6IHsKICAgIGlkOiA1LAogICAgY2hlY2s6IG5zID0+IG5zID09PSAiaHR0cDovL25zLmFkb2JlLmNvbS94ZHAvcGRmLyIKICB9LAogIHNpZ25hdHVyZTogewogICAgaWQ6IDYsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIgogIH0sCiAgc291cmNlU2V0OiB7CiAgICBpZDogNywKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hmYS1zb3VyY2Utc2V0LyIpCiAgfSwKICBzdHlsZXNoZWV0OiB7CiAgICBpZDogOCwKICAgIGNoZWNrOiBucyA9PiBucyA9PT0gImh0dHA6Ly93d3cudzMub3JnLzE5OTkvWFNML1RyYW5zZm9ybSIKICB9LAogIHRlbXBsYXRlOiB7CiAgICBpZDogOSwKICAgIGNoZWNrOiBucyA9PiBucy5zdGFydHNXaXRoKCJodHRwOi8vd3d3LnhmYS5vcmcvc2NoZW1hL3hmYS10ZW1wbGF0ZS8iKQogIH0sCiAgeGRjOiB7CiAgICBpZDogMTAsCiAgICBjaGVjazogbnMgPT4gbnMuc3RhcnRzV2l0aCgiaHR0cDovL3d3dy54ZmEub3JnL3NjaGVtYS94ZGMvIikKICB9LAogIHhkcDogewogICAgaWQ6IDExLAogICAgY2hlY2s6IG5zID0+IG5zID09PSAiaHR0cDovL25zLmFkb2JlLmNvbS94ZHAvIgogIH0sCiAgeGZkZjogewogICAgaWQ6IDEyLAogICAgY2hlY2s6IG5zID0+IG5zID09PSAiaHR0cDovL25zLmFkb2JlLmNvbS94ZmRmLyIKICB9LAogIHhodG1sOiB7CiAgICBpZDogMTMsCiAgICBjaGVjazogbnMgPT4gbnMgPT09ICJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIgogIH0sCiAgeG1wbWV0YTogewogICAgaWQ6IDE0LAogICAgY2hlY2s6IG5zID0+IG5zID09PSAiaHR0cDovL25zLmFkb2JlLmNvbS94bXBtZXRhLyIKICB9Cn07CmV4cG9ydHMuTmFtZXNwYWNlSWRzID0gTmFtZXNwYWNlSWRzOwoKLyoqKi8gfSksCi8qIDgwICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuY3JlYXRlRGF0YU5vZGUgPSBjcmVhdGVEYXRhTm9kZTsKZXhwb3J0cy5zZWFyY2hOb2RlID0gc2VhcmNoTm9kZTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgbmFtZVBhdHRlcm4gPSAvXlteLltdKy87CmNvbnN0IGluZGV4UGF0dGVybiA9IC9eW15cXV0rLzsKY29uc3Qgb3BlcmF0b3JzID0gewogIGRvdDogMCwKICBkb3REb3Q6IDEsCiAgZG90SGFzaDogMiwKICBkb3RCcmFja2V0OiAzLAogIGRvdFBhcmVuOiA0Cn07CmNvbnN0IHNob3J0Y3V0cyA9IG5ldyBNYXAoW1siJGRhdGEiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5kYXRhc2V0cyA/IHJvb3QuZGF0YXNldHMuZGF0YSA6IHJvb3RdLCBbIiRyZWNvcmQiLCAocm9vdCwgY3VycmVudCkgPT4gKHJvb3QuZGF0YXNldHMgPyByb290LmRhdGFzZXRzLmRhdGEgOiByb290KVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKClbMF1dLCBbIiR0ZW1wbGF0ZSIsIChyb290LCBjdXJyZW50KSA9PiByb290LnRlbXBsYXRlXSwgWyIkY29ubmVjdGlvblNldCIsIChyb290LCBjdXJyZW50KSA9PiByb290LmNvbm5lY3Rpb25TZXRdLCBbIiRmb3JtIiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3QuZm9ybV0sIFsiJGxheW91dCIsIChyb290LCBjdXJyZW50KSA9PiByb290LmxheW91dF0sIFsiJGhvc3QiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdC5ob3N0XSwgWyIkZGF0YVdpbmRvdyIsIChyb290LCBjdXJyZW50KSA9PiByb290LmRhdGFXaW5kb3ddLCBbIiRldmVudCIsIChyb290LCBjdXJyZW50KSA9PiByb290LmV2ZW50XSwgWyIhIiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3QuZGF0YXNldHNdLCBbIiR4ZmEiLCAocm9vdCwgY3VycmVudCkgPT4gcm9vdF0sIFsieGZhIiwgKHJvb3QsIGN1cnJlbnQpID0+IHJvb3RdLCBbIiQiLCAocm9vdCwgY3VycmVudCkgPT4gY3VycmVudF1dKTsKY29uc3Qgc29tQ2FjaGUgPSBuZXcgV2Vha01hcCgpOwpjb25zdCBOU19EQVRBU0VUUyA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZDsKCmZ1bmN0aW9uIHBhcnNlSW5kZXgoaW5kZXgpIHsKICBpbmRleCA9IGluZGV4LnRyaW0oKTsKCiAgaWYgKGluZGV4ID09PSAiKiIpIHsKICAgIHJldHVybiBJbmZpbml0eTsKICB9CgogIHJldHVybiBwYXJzZUludChpbmRleCwgMTApIHx8IDA7Cn0KCmZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvbihleHByLCBkb3REb3RBbGxvd2VkLCBub0V4cHIgPSB0cnVlKSB7CiAgbGV0IG1hdGNoID0gZXhwci5tYXRjaChuYW1lUGF0dGVybik7CgogIGlmICghbWF0Y2gpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgbGV0IFtuYW1lXSA9IG1hdGNoOwogIGNvbnN0IHBhcnNlZCA9IFt7CiAgICBuYW1lLAogICAgY2FjaGVOYW1lOiAiLiIgKyBuYW1lLAogICAgaW5kZXg6IDAsCiAgICBqczogbnVsbCwKICAgIGZvcm1DYWxjOiBudWxsLAogICAgb3BlcmF0b3I6IG9wZXJhdG9ycy5kb3QKICB9XTsKICBsZXQgcG9zID0gbmFtZS5sZW5ndGg7CgogIHdoaWxlIChwb3MgPCBleHByLmxlbmd0aCkgewogICAgY29uc3Qgc3BvcyA9IHBvczsKICAgIGNvbnN0IGNoYXIgPSBleHByLmNoYXJBdChwb3MrKyk7CgogICAgaWYgKGNoYXIgPT09ICJbIikgewogICAgICBtYXRjaCA9IGV4cHIuc2xpY2UocG9zKS5tYXRjaChpbmRleFBhdHRlcm4pOwoKICAgICAgaWYgKCFtYXRjaCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiWEZBIC0gSW52YWxpZCBpbmRleCBpbiBTT00gZXhwcmVzc2lvbiIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBwYXJzZWQuYXQoLTEpLmluZGV4ID0gcGFyc2VJbmRleChtYXRjaFswXSk7CiAgICAgIHBvcyArPSBtYXRjaFswXS5sZW5ndGggKyAxOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBsZXQgb3BlcmF0b3I7CgogICAgc3dpdGNoIChleHByLmNoYXJBdChwb3MpKSB7CiAgICAgIGNhc2UgIi4iOgogICAgICAgIGlmICghZG90RG90QWxsb3dlZCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBwb3MrKzsKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3REb3Q7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICIjIjoKICAgICAgICBwb3MrKzsKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3RIYXNoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiWyI6CiAgICAgICAgaWYgKG5vRXhwcikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTT00gZXhwcmVzc2lvbiBjb250YWlucyBhIEZvcm1DYWxjIHN1YmV4cHJlc3Npb24gd2hpY2ggaXMgbm90IHN1cHBvcnRlZCBmb3Igbm93LiIpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3RCcmFja2V0OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiKCI6CiAgICAgICAgaWYgKG5vRXhwcikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTT00gZXhwcmVzc2lvbiBjb250YWlucyBhIEphdmFTY3JpcHQgc3ViZXhwcmVzc2lvbiB3aGljaCBpcyBub3Qgc3VwcG9ydGVkIGZvciBub3cuIik7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIG9wZXJhdG9yID0gb3BlcmF0b3JzLmRvdFBhcmVuOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBvcGVyYXRvciA9IG9wZXJhdG9ycy5kb3Q7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgbWF0Y2ggPSBleHByLnNsaWNlKHBvcykubWF0Y2gobmFtZVBhdHRlcm4pOwoKICAgIGlmICghbWF0Y2gpIHsKICAgICAgYnJlYWs7CiAgICB9CgogICAgW25hbWVdID0gbWF0Y2g7CiAgICBwb3MgKz0gbmFtZS5sZW5ndGg7CiAgICBwYXJzZWQucHVzaCh7CiAgICAgIG5hbWUsCiAgICAgIGNhY2hlTmFtZTogZXhwci5zbGljZShzcG9zLCBwb3MpLAogICAgICBvcGVyYXRvciwKICAgICAgaW5kZXg6IDAsCiAgICAgIGpzOiBudWxsLAogICAgICBmb3JtQ2FsYzogbnVsbAogICAgfSk7CiAgfQoKICByZXR1cm4gcGFyc2VkOwp9CgpmdW5jdGlvbiBzZWFyY2hOb2RlKHJvb3QsIGNvbnRhaW5lciwgZXhwciwgZG90RG90QWxsb3dlZCA9IHRydWUsIHVzZUNhY2hlID0gdHJ1ZSkgewogIGNvbnN0IHBhcnNlZCA9IHBhcnNlRXhwcmVzc2lvbihleHByLCBkb3REb3RBbGxvd2VkKTsKCiAgaWYgKCFwYXJzZWQpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgY29uc3QgZm4gPSBzaG9ydGN1dHMuZ2V0KHBhcnNlZFswXS5uYW1lKTsKICBsZXQgaSA9IDA7CiAgbGV0IGlzUXVhbGlmaWVkOwoKICBpZiAoZm4pIHsKICAgIGlzUXVhbGlmaWVkID0gdHJ1ZTsKICAgIHJvb3QgPSBbZm4ocm9vdCwgY29udGFpbmVyKV07CiAgICBpID0gMTsKICB9IGVsc2UgewogICAgaXNRdWFsaWZpZWQgPSBjb250YWluZXIgPT09IG51bGw7CiAgICByb290ID0gW2NvbnRhaW5lciB8fCByb290XTsKICB9CgogIGZvciAobGV0IGlpID0gcGFyc2VkLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgIGNvbnN0IHsKICAgICAgbmFtZSwKICAgICAgY2FjaGVOYW1lLAogICAgICBvcGVyYXRvciwKICAgICAgaW5kZXgKICAgIH0gPSBwYXJzZWRbaV07CiAgICBjb25zdCBub2RlcyA9IFtdOwoKICAgIGZvciAoY29uc3Qgbm9kZSBvZiByb290KSB7CiAgICAgIGlmICghKG5vZGUgaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGxldCBjaGlsZHJlbiwgY2FjaGVkOwoKICAgICAgaWYgKHVzZUNhY2hlKSB7CiAgICAgICAgY2FjaGVkID0gc29tQ2FjaGUuZ2V0KG5vZGUpOwoKICAgICAgICBpZiAoIWNhY2hlZCkgewogICAgICAgICAgY2FjaGVkID0gbmV3IE1hcCgpOwogICAgICAgICAgc29tQ2FjaGUuc2V0KG5vZGUsIGNhY2hlZCk7CiAgICAgICAgfQoKICAgICAgICBjaGlsZHJlbiA9IGNhY2hlZC5nZXQoY2FjaGVOYW1lKTsKICAgICAgfQoKICAgICAgaWYgKCFjaGlsZHJlbikgewogICAgICAgIHN3aXRjaCAob3BlcmF0b3IpIHsKICAgICAgICAgIGNhc2Ugb3BlcmF0b3JzLmRvdDoKICAgICAgICAgICAgY2hpbGRyZW4gPSBub2RlW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbkJ5TmFtZV0obmFtZSwgZmFsc2UpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIG9wZXJhdG9ycy5kb3REb3Q6CiAgICAgICAgICAgIGNoaWxkcmVuID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIHRydWUpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIG9wZXJhdG9ycy5kb3RIYXNoOgogICAgICAgICAgICBjaGlsZHJlbiA9IG5vZGVbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuQnlDbGFzc10obmFtZSk7CgogICAgICAgICAgICBpZiAoY2hpbGRyZW4gaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSkgewogICAgICAgICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uY2hpbGRyZW47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2hpbGRyZW4gPSBbY2hpbGRyZW5dOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh1c2VDYWNoZSkgewogICAgICAgICAgY2FjaGVkLnNldChjYWNoZU5hbWUsIGNoaWxkcmVuKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgbm9kZXMucHVzaChjaGlsZHJlbik7CiAgICAgIH0KICAgIH0KCiAgICBpZiAobm9kZXMubGVuZ3RoID09PSAwICYmICFpc1F1YWxpZmllZCAmJiBpID09PSAwKSB7CiAgICAgIGNvbnN0IHBhcmVudCA9IGNvbnRhaW5lcltfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgICAgY29udGFpbmVyID0gcGFyZW50OwoKICAgICAgaWYgKCFjb250YWluZXIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgaSA9IC0xOwogICAgICByb290ID0gW2NvbnRhaW5lcl07CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmIChpc0Zpbml0ZShpbmRleCkpIHsKICAgICAgcm9vdCA9IG5vZGVzLmZpbHRlcihub2RlID0+IGluZGV4IDwgbm9kZS5sZW5ndGgpLm1hcChub2RlID0+IG5vZGVbaW5kZXhdKTsKICAgIH0gZWxzZSB7CiAgICAgIHJvb3QgPSBub2Rlcy5mbGF0KCk7CiAgICB9CiAgfQoKICBpZiAocm9vdC5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgcmV0dXJuIHJvb3Q7Cn0KCmZ1bmN0aW9uIGNyZWF0ZU5vZGVzKHJvb3QsIHBhdGgpIHsKICBsZXQgbm9kZSA9IG51bGw7CgogIGZvciAoY29uc3QgewogICAgbmFtZSwKICAgIGluZGV4CiAgfSBvZiBwYXRoKSB7CiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSAhaXNGaW5pdGUoaW5kZXgpID8gMCA6IGluZGV4OyBpIDw9IGlpOyBpKyspIHsKICAgICAgY29uc3QgbnNJZCA9IHJvb3RbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gTlNfREFUQVNFVFMgPyAtMSA6IHJvb3RbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXTsKICAgICAgbm9kZSA9IG5ldyBfeGZhX29iamVjdC5YbWxPYmplY3QobnNJZCwgbmFtZSk7CgogICAgICByb290W194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZSk7CiAgICB9CgogICAgcm9vdCA9IG5vZGU7CiAgfQoKICByZXR1cm4gbm9kZTsKfQoKZnVuY3Rpb24gY3JlYXRlRGF0YU5vZGUocm9vdCwgY29udGFpbmVyLCBleHByKSB7CiAgY29uc3QgcGFyc2VkID0gcGFyc2VFeHByZXNzaW9uKGV4cHIpOwoKICBpZiAoIXBhcnNlZCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBpZiAocGFyc2VkLnNvbWUoeCA9PiB4Lm9wZXJhdG9yID09PSBvcGVyYXRvcnMuZG90RG90KSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBmbiA9IHNob3J0Y3V0cy5nZXQocGFyc2VkWzBdLm5hbWUpOwogIGxldCBpID0gMDsKCiAgaWYgKGZuKSB7CiAgICByb290ID0gZm4ocm9vdCwgY29udGFpbmVyKTsKICAgIGkgPSAxOwogIH0gZWxzZSB7CiAgICByb290ID0gY29udGFpbmVyIHx8IHJvb3Q7CiAgfQoKICBmb3IgKGxldCBpaSA9IHBhcnNlZC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICBjb25zdCB7CiAgICAgIG5hbWUsCiAgICAgIG9wZXJhdG9yLAogICAgICBpbmRleAogICAgfSA9IHBhcnNlZFtpXTsKCiAgICBpZiAoIWlzRmluaXRlKGluZGV4KSkgewogICAgICBwYXJzZWRbaV0uaW5kZXggPSAwOwogICAgICByZXR1cm4gY3JlYXRlTm9kZXMocm9vdCwgcGFyc2VkLnNsaWNlKGkpKTsKICAgIH0KCiAgICBsZXQgY2hpbGRyZW47CgogICAgc3dpdGNoIChvcGVyYXRvcikgewogICAgICBjYXNlIG9wZXJhdG9ycy5kb3Q6CiAgICAgICAgY2hpbGRyZW4gPSByb290W194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbkJ5TmFtZV0obmFtZSwgZmFsc2UpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBvcGVyYXRvcnMuZG90RG90OgogICAgICAgIGNoaWxkcmVuID0gcm9vdFtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5CeU5hbWVdKG5hbWUsIHRydWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBvcGVyYXRvcnMuZG90SGFzaDoKICAgICAgICBjaGlsZHJlbiA9IHJvb3RbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuQnlDbGFzc10obmFtZSk7CgogICAgICAgIGlmIChjaGlsZHJlbiBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KSB7CiAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmNoaWxkcmVuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjaGlsZHJlbiA9IFtjaGlsZHJlbl07CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gY3JlYXRlTm9kZXMocm9vdCwgcGFyc2VkLnNsaWNlKGkpKTsKICAgIH0KCiAgICBpZiAoaW5kZXggPCBjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpbmRleF07CgogICAgICBpZiAoIShjaGlsZCBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdCkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIENhbm5vdCBjcmVhdGUgYSBub2RlLmApOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByb290ID0gY2hpbGQ7CiAgICB9IGVsc2UgewogICAgICBwYXJzZWRbaV0uaW5kZXggPSBpbmRleCAtIGNoaWxkcmVuLmxlbmd0aDsKICAgICAgcmV0dXJuIGNyZWF0ZU5vZGVzKHJvb3QsIHBhcnNlZC5zbGljZShpKSk7CiAgICB9CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKLyoqKi8gfSksCi8qIDgxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuQmluZGVyID0gdm9pZCAwOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7Cgp2YXIgX3RlbXBsYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Mik7Cgp2YXIgX3NvbSA9IF9fd19wZGZqc19yZXF1aXJlX18oODApOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKY29uc3QgTlNfREFUQVNFVFMgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuZGF0YXNldHMuaWQ7CgpmdW5jdGlvbiBjcmVhdGVUZXh0KGNvbnRlbnQpIHsKICBjb25zdCBub2RlID0gbmV3IF90ZW1wbGF0ZS5UZXh0KHt9KTsKICBub2RlW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGNvbnRlbnQ7CiAgcmV0dXJuIG5vZGU7Cn0KCmNsYXNzIEJpbmRlciB7CiAgY29uc3RydWN0b3Iocm9vdCkgewogICAgdGhpcy5yb290ID0gcm9vdDsKICAgIHRoaXMuZGF0YXNldHMgPSByb290LmRhdGFzZXRzOwoKICAgIGlmIChyb290LmRhdGFzZXRzICYmIHJvb3QuZGF0YXNldHMuZGF0YSkgewogICAgICB0aGlzLmRhdGEgPSByb290LmRhdGFzZXRzLmRhdGE7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRhdGEgPSBuZXcgX3hmYV9vYmplY3QuWG1sT2JqZWN0KF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5kYXRhc2V0cy5pZCwgImRhdGEiKTsKICAgIH0KCiAgICB0aGlzLmVtcHR5TWVyZ2UgPSB0aGlzLmRhdGFbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpLmxlbmd0aCA9PT0gMDsKICAgIHRoaXMucm9vdC5mb3JtID0gdGhpcy5mb3JtID0gcm9vdC50ZW1wbGF0ZVtfeGZhX29iamVjdC4kY2xvbmVdKCk7CiAgfQoKICBfaXNDb25zdW1lRGF0YSgpIHsKICAgIHJldHVybiAhdGhpcy5lbXB0eU1lcmdlICYmIHRoaXMuX21lcmdlTW9kZTsKICB9CgogIF9pc01hdGNoVGVtcGxhdGUoKSB7CiAgICByZXR1cm4gIXRoaXMuX2lzQ29uc3VtZURhdGEoKTsKICB9CgogIGJpbmQoKSB7CiAgICB0aGlzLl9iaW5kRWxlbWVudCh0aGlzLmZvcm0sIHRoaXMuZGF0YSk7CgogICAgcmV0dXJuIHRoaXMuZm9ybTsKICB9CgogIGdldERhdGEoKSB7CiAgICByZXR1cm4gdGhpcy5kYXRhOwogIH0KCiAgX2JpbmRWYWx1ZShmb3JtTm9kZSwgZGF0YSwgcGljdHVyZSkgewogICAgZm9ybU5vZGVbX3hmYV9vYmplY3QuJGRhdGFdID0gZGF0YTsKCiAgICBpZiAoZm9ybU5vZGVbX3hmYV9vYmplY3QuJGhhc1NldHRhYmxlVmFsdWVdKCkpIHsKICAgICAgaWYgKGRhdGFbX3hmYV9vYmplY3QuJGlzRGF0YVZhbHVlXSgpKSB7CiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW194ZmFfb2JqZWN0LiRnZXREYXRhVmFsdWVdKCk7CgogICAgICAgIGZvcm1Ob2RlW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0oY3JlYXRlVGV4dCh2YWx1ZSkpOwogICAgICB9IGVsc2UgaWYgKGZvcm1Ob2RlIGluc3RhbmNlb2YgX3RlbXBsYXRlLkZpZWxkICYmIGZvcm1Ob2RlLnVpICYmIGZvcm1Ob2RlLnVpLmNob2ljZUxpc3QgJiYgZm9ybU5vZGUudWkuY2hvaWNlTGlzdC5vcGVuID09PSAibXVsdGlTZWxlY3QiKSB7CiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKS5tYXAoY2hpbGQgPT4gY2hpbGRbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKSkuam9pbigiXG4iKTsKCiAgICAgICAgZm9ybU5vZGVbX3hmYV9vYmplY3QuJHNldFZhbHVlXShjcmVhdGVUZXh0KHZhbHVlKSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNDb25zdW1lRGF0YSgpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBOb2RlcyBoYXZlbid0IHRoZSBzYW1lIHR5cGUuYCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoIWRhdGFbX3hmYV9vYmplY3QuJGlzRGF0YVZhbHVlXSgpIHx8IHRoaXMuX2lzTWF0Y2hUZW1wbGF0ZSgpKSB7CiAgICAgIHRoaXMuX2JpbmRFbGVtZW50KGZvcm1Ob2RlLCBkYXRhKTsKICAgIH0gZWxzZSB7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gTm9kZXMgaGF2ZW4ndCB0aGUgc2FtZSB0eXBlLmApOwogICAgfQogIH0KCiAgX2ZpbmREYXRhQnlOYW1lVG9Db25zdW1lKG5hbWUsIGlzVmFsdWUsIGRhdGFOb2RlLCBnbG9iYWwpIHsKICAgIGlmICghbmFtZSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBsZXQgZ2VuZXJhdG9yLCBtYXRjaDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykgewogICAgICBnZW5lcmF0b3IgPSBkYXRhTm9kZVtfeGZhX29iamVjdC4kZ2V0UmVhbENoaWxkcmVuQnlOYW1lSXRdKG5hbWUsIGZhbHNlLCB0cnVlKTsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgbWF0Y2ggPSBnZW5lcmF0b3IubmV4dCgpLnZhbHVlOwoKICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmIChpc1ZhbHVlID09PSBtYXRjaFtfeGZhX29iamVjdC4kaXNEYXRhVmFsdWVdKCkpIHsKICAgICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChkYXRhTm9kZVtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuZGF0YXNldHMuaWQgJiYgZGF0YU5vZGVbX3hmYV9vYmplY3QuJG5vZGVOYW1lXSA9PT0gImRhdGEiKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGRhdGFOb2RlID0gZGF0YU5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKICAgIH0KCiAgICBpZiAoIWdsb2JhbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBnZW5lcmF0b3IgPSB0aGlzLmRhdGFbX3hmYV9vYmplY3QuJGdldFJlYWxDaGlsZHJlbkJ5TmFtZUl0XShuYW1lLCB0cnVlLCBmYWxzZSk7CiAgICBtYXRjaCA9IGdlbmVyYXRvci5uZXh0KCkudmFsdWU7CgogICAgaWYgKG1hdGNoKSB7CiAgICAgIHJldHVybiBtYXRjaDsKICAgIH0KCiAgICBnZW5lcmF0b3IgPSB0aGlzLmRhdGFbX3hmYV9vYmplY3QuJGdldEF0dHJpYnV0ZUl0XShuYW1lLCB0cnVlKTsKICAgIG1hdGNoID0gZ2VuZXJhdG9yLm5leHQoKS52YWx1ZTsKCiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbX3hmYV9vYmplY3QuJGlzRGF0YVZhbHVlXSgpKSB7CiAgICAgIHJldHVybiBtYXRjaDsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIF9zZXRQcm9wZXJ0aWVzKGZvcm1Ob2RlLCBkYXRhTm9kZSkgewogICAgaWYgKCFmb3JtTm9kZS5oYXNPd25Qcm9wZXJ0eSgic2V0UHJvcGVydHkiKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCB7CiAgICAgIHJlZiwKICAgICAgdGFyZ2V0LAogICAgICBjb25uZWN0aW9uCiAgICB9IG9mIGZvcm1Ob2RlLnNldFByb3BlcnR5LmNoaWxkcmVuKSB7CiAgICAgIGlmIChjb25uZWN0aW9uKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghcmVmKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVzID0gKDAsIF9zb20uc2VhcmNoTm9kZSkodGhpcy5yb290LCBkYXRhTm9kZSwgcmVmLCBmYWxzZSwgZmFsc2UpOwoKICAgICAgaWYgKCFub2RlcykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCByZWZlcmVuY2U6ICR7cmVmfS5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgW25vZGVdID0gbm9kZXM7CgogICAgICBpZiAoIW5vZGVbX3hmYV9vYmplY3QuJGlzRGVzY2VuZGVudF0odGhpcy5kYXRhKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCBub2RlOiBtdXN0IGJlIGEgZGF0YSBub2RlLmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCB0YXJnZXROb2RlcyA9ICgwLCBfc29tLnNlYXJjaE5vZGUpKHRoaXMucm9vdCwgZm9ybU5vZGUsIHRhcmdldCwgZmFsc2UsIGZhbHNlKTsKCiAgICAgIGlmICghdGFyZ2V0Tm9kZXMpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgdGFyZ2V0OiAke3RhcmdldH0uYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IFt0YXJnZXROb2RlXSA9IHRhcmdldE5vZGVzOwoKICAgICAgaWYgKCF0YXJnZXROb2RlW194ZmFfb2JqZWN0LiRpc0Rlc2NlbmRlbnRdKGZvcm1Ob2RlKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCB0YXJnZXQ6IG11c3QgYmUgYSBwcm9wZXJ0eSBvciBzdWJwcm9wZXJ0eS5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgdGFyZ2V0UGFyZW50ID0gdGFyZ2V0Tm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgICAgaWYgKHRhcmdldE5vZGUgaW5zdGFuY2VvZiBfdGVtcGxhdGUuU2V0UHJvcGVydHkgfHwgdGFyZ2V0UGFyZW50IGluc3RhbmNlb2YgX3RlbXBsYXRlLlNldFByb3BlcnR5KSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHRhcmdldDogY2Fubm90IGJlIGEgc2V0UHJvcGVydHkgb3Igb25lIG9mIGl0cyBwcm9wZXJ0aWVzLmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAodGFyZ2V0Tm9kZSBpbnN0YW5jZW9mIF90ZW1wbGF0ZS5CaW5kSXRlbXMgfHwgdGFyZ2V0UGFyZW50IGluc3RhbmNlb2YgX3RlbXBsYXRlLkJpbmRJdGVtcykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCB0YXJnZXQ6IGNhbm5vdCBiZSBhIGJpbmRJdGVtcyBvciBvbmUgb2YgaXRzIHByb3BlcnRpZXMuYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGNvbnRlbnQgPSBub2RlW194ZmFfb2JqZWN0LiR0ZXh0XSgpOwoKICAgICAgY29uc3QgbmFtZSA9IHRhcmdldE5vZGVbX3hmYV9vYmplY3QuJG5vZGVOYW1lXTsKCiAgICAgIGlmICh0YXJnZXROb2RlIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBQXR0cmlidXRlKSB7CiAgICAgICAgY29uc3QgYXR0cnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgIGF0dHJzW25hbWVdID0gY29udGVudDsKICAgICAgICBjb25zdCBvYmogPSBSZWZsZWN0LmNvbnN0cnVjdChPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0UGFyZW50KS5jb25zdHJ1Y3RvciwgW2F0dHJzXSk7CiAgICAgICAgdGFyZ2V0UGFyZW50W25hbWVdID0gb2JqW25hbWVdOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAoIXRhcmdldE5vZGUuaGFzT3duUHJvcGVydHkoX3hmYV9vYmplY3QuJGNvbnRlbnQpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIG5vZGUgdG8gdXNlIGluIHNldFByb3BlcnR5YCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHRhcmdldE5vZGVbX3hmYV9vYmplY3QuJGRhdGFdID0gbm9kZTsKICAgICAgdGFyZ2V0Tm9kZVtfeGZhX29iamVjdC4kY29udGVudF0gPSBjb250ZW50OwoKICAgICAgdGFyZ2V0Tm9kZVtfeGZhX29iamVjdC4kZmluYWxpemVdKCk7CiAgICB9CiAgfQoKICBfYmluZEl0ZW1zKGZvcm1Ob2RlLCBkYXRhTm9kZSkgewogICAgaWYgKCFmb3JtTm9kZS5oYXNPd25Qcm9wZXJ0eSgiaXRlbXMiKSB8fCAhZm9ybU5vZGUuaGFzT3duUHJvcGVydHkoImJpbmRJdGVtcyIpIHx8IGZvcm1Ob2RlLmJpbmRJdGVtcy5pc0VtcHR5KCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZvciAoY29uc3QgaXRlbSBvZiBmb3JtTm9kZS5pdGVtcy5jaGlsZHJlbikgewogICAgICBmb3JtTm9kZVtfeGZhX29iamVjdC4kcmVtb3ZlQ2hpbGRdKGl0ZW0pOwogICAgfQoKICAgIGZvcm1Ob2RlLml0ZW1zLmNsZWFyKCk7CiAgICBjb25zdCBsYWJlbHMgPSBuZXcgX3RlbXBsYXRlLkl0ZW1zKHt9KTsKICAgIGNvbnN0IHZhbHVlcyA9IG5ldyBfdGVtcGxhdGUuSXRlbXMoe30pOwoKICAgIGZvcm1Ob2RlW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obGFiZWxzKTsKCiAgICBmb3JtTm9kZS5pdGVtcy5wdXNoKGxhYmVscyk7CgogICAgZm9ybU5vZGVbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXSh2YWx1ZXMpOwoKICAgIGZvcm1Ob2RlLml0ZW1zLnB1c2godmFsdWVzKTsKCiAgICBmb3IgKGNvbnN0IHsKICAgICAgcmVmLAogICAgICBsYWJlbFJlZiwKICAgICAgdmFsdWVSZWYsCiAgICAgIGNvbm5lY3Rpb24KICAgIH0gb2YgZm9ybU5vZGUuYmluZEl0ZW1zLmNoaWxkcmVuKSB7CiAgICAgIGlmIChjb25uZWN0aW9uKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmICghcmVmKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVzID0gKDAsIF9zb20uc2VhcmNoTm9kZSkodGhpcy5yb290LCBkYXRhTm9kZSwgcmVmLCBmYWxzZSwgZmFsc2UpOwoKICAgICAgaWYgKCFub2RlcykgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gSW52YWxpZCByZWZlcmVuY2U6ICR7cmVmfS5gKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7CiAgICAgICAgaWYgKCFub2RlW194ZmFfb2JqZWN0LiRpc0Rlc2NlbmRlbnRdKHRoaXMuZGF0YXNldHMpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgcmVmICgke3JlZn0pOiBtdXN0IGJlIGEgZGF0YXNldHMgY2hpbGQuYCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGxhYmVsTm9kZXMgPSAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLnJvb3QsIG5vZGUsIGxhYmVsUmVmLCB0cnVlLCBmYWxzZSk7CgogICAgICAgIGlmICghbGFiZWxOb2RlcykgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIGxhYmVsOiAke2xhYmVsUmVmfS5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgW2xhYmVsTm9kZV0gPSBsYWJlbE5vZGVzOwoKICAgICAgICBpZiAoIWxhYmVsTm9kZVtfeGZhX29iamVjdC4kaXNEZXNjZW5kZW50XSh0aGlzLmRhdGFzZXRzKSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIGxhYmVsOiBtdXN0IGJlIGEgZGF0YXNldHMgY2hpbGQuYCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHZhbHVlTm9kZXMgPSAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLnJvb3QsIG5vZGUsIHZhbHVlUmVmLCB0cnVlLCBmYWxzZSk7CgogICAgICAgIGlmICghdmFsdWVOb2RlcykgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHZhbHVlOiAke3ZhbHVlUmVmfS5gKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgW3ZhbHVlTm9kZV0gPSB2YWx1ZU5vZGVzOwoKICAgICAgICBpZiAoIXZhbHVlTm9kZVtfeGZhX29iamVjdC4kaXNEZXNjZW5kZW50XSh0aGlzLmRhdGFzZXRzKSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSBJbnZhbGlkIHZhbHVlOiBtdXN0IGJlIGEgZGF0YXNldHMgY2hpbGQuYCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGxhYmVsID0gY3JlYXRlVGV4dChsYWJlbE5vZGVbX3hmYV9vYmplY3QuJHRleHRdKCkpOwogICAgICAgIGNvbnN0IHZhbHVlID0gY3JlYXRlVGV4dCh2YWx1ZU5vZGVbX3hmYV9vYmplY3QuJHRleHRdKCkpOwoKICAgICAgICBsYWJlbHNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShsYWJlbCk7CgogICAgICAgIGxhYmVscy50ZXh0LnB1c2gobGFiZWwpOwoKICAgICAgICB2YWx1ZXNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXSh2YWx1ZSk7CgogICAgICAgIHZhbHVlcy50ZXh0LnB1c2godmFsdWUpOwogICAgICB9CiAgICB9CiAgfQoKICBfYmluZE9jY3VycmVuY2VzKGZvcm1Ob2RlLCBtYXRjaGVzLCBwaWN0dXJlKSB7CiAgICBsZXQgYmFzZUNsb25lOwoKICAgIGlmIChtYXRjaGVzLmxlbmd0aCA+IDEpIHsKICAgICAgYmFzZUNsb25lID0gZm9ybU5vZGVbX3hmYV9vYmplY3QuJGNsb25lXSgpOwoKICAgICAgYmFzZUNsb25lW194ZmFfb2JqZWN0LiRyZW1vdmVDaGlsZF0oYmFzZUNsb25lLm9jY3VyKTsKCiAgICAgIGJhc2VDbG9uZS5vY2N1ciA9IG51bGw7CiAgICB9CgogICAgdGhpcy5fYmluZFZhbHVlKGZvcm1Ob2RlLCBtYXRjaGVzWzBdLCBwaWN0dXJlKTsKCiAgICB0aGlzLl9zZXRQcm9wZXJ0aWVzKGZvcm1Ob2RlLCBtYXRjaGVzWzBdKTsKCiAgICB0aGlzLl9iaW5kSXRlbXMoZm9ybU5vZGUsIG1hdGNoZXNbMF0pOwoKICAgIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcGFyZW50ID0gZm9ybU5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBuYW1lID0gZm9ybU5vZGVbX3hmYV9vYmplY3QuJG5vZGVOYW1lXTsKCiAgICBjb25zdCBwb3MgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGluZGV4T2ZdKGZvcm1Ob2RlKTsKCiAgICBmb3IgKGxldCBpID0gMSwgaWkgPSBtYXRjaGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgbWF0Y2ggPSBtYXRjaGVzW2ldOwoKICAgICAgY29uc3QgY2xvbmUgPSBiYXNlQ2xvbmVbX3hmYV9vYmplY3QuJGNsb25lXSgpOwoKICAgICAgcGFyZW50W25hbWVdLnB1c2goY2xvbmUpOwoKICAgICAgcGFyZW50W194ZmFfb2JqZWN0LiRpbnNlcnRBdF0ocG9zICsgaSwgY2xvbmUpOwoKICAgICAgdGhpcy5fYmluZFZhbHVlKGNsb25lLCBtYXRjaCwgcGljdHVyZSk7CgogICAgICB0aGlzLl9zZXRQcm9wZXJ0aWVzKGNsb25lLCBtYXRjaCk7CgogICAgICB0aGlzLl9iaW5kSXRlbXMoY2xvbmUsIG1hdGNoKTsKICAgIH0KICB9CgogIF9jcmVhdGVPY2N1cnJlbmNlcyhmb3JtTm9kZSkgewogICAgaWYgKCF0aGlzLmVtcHR5TWVyZ2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHsKICAgICAgb2NjdXIKICAgIH0gPSBmb3JtTm9kZTsKCiAgICBpZiAoIW9jY3VyIHx8IG9jY3VyLmluaXRpYWwgPD0gMSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgcGFyZW50ID0gZm9ybU5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBuYW1lID0gZm9ybU5vZGVbX3hmYV9vYmplY3QuJG5vZGVOYW1lXTsKCiAgICBpZiAoIShwYXJlbnRbbmFtZV0gaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBjdXJyZW50TnVtYmVyOwoKICAgIGlmIChmb3JtTm9kZS5uYW1lKSB7CiAgICAgIGN1cnJlbnROdW1iZXIgPSBwYXJlbnRbbmFtZV0uY2hpbGRyZW4uZmlsdGVyKGUgPT4gZS5uYW1lID09PSBmb3JtTm9kZS5uYW1lKS5sZW5ndGg7CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50TnVtYmVyID0gcGFyZW50W25hbWVdLmNoaWxkcmVuLmxlbmd0aDsKICAgIH0KCiAgICBjb25zdCBwb3MgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGluZGV4T2ZdKGZvcm1Ob2RlKSArIDE7CiAgICBjb25zdCBpaSA9IG9jY3VyLmluaXRpYWwgLSBjdXJyZW50TnVtYmVyOwoKICAgIGlmIChpaSkgewogICAgICBjb25zdCBub2RlQ2xvbmUgPSBmb3JtTm9kZVtfeGZhX29iamVjdC4kY2xvbmVdKCk7CgogICAgICBub2RlQ2xvbmVbX3hmYV9vYmplY3QuJHJlbW92ZUNoaWxkXShub2RlQ2xvbmUub2NjdXIpOwoKICAgICAgbm9kZUNsb25lLm9jY3VyID0gbnVsbDsKICAgICAgcGFyZW50W25hbWVdLnB1c2gobm9kZUNsb25lKTsKCiAgICAgIHBhcmVudFtfeGZhX29iamVjdC4kaW5zZXJ0QXRdKHBvcywgbm9kZUNsb25lKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbnN0IGNsb25lID0gbm9kZUNsb25lW194ZmFfb2JqZWN0LiRjbG9uZV0oKTsKCiAgICAgICAgcGFyZW50W25hbWVdLnB1c2goY2xvbmUpOwoKICAgICAgICBwYXJlbnRbX3hmYV9vYmplY3QuJGluc2VydEF0XShwb3MgKyBpLCBjbG9uZSk7CiAgICAgIH0KICAgIH0KICB9CgogIF9nZXRPY2N1ckluZm8oZm9ybU5vZGUpIHsKICAgIGNvbnN0IHsKICAgICAgbmFtZSwKICAgICAgb2NjdXIKICAgIH0gPSBmb3JtTm9kZTsKCiAgICBpZiAoIW9jY3VyIHx8ICFuYW1lKSB7CiAgICAgIHJldHVybiBbMSwgMV07CiAgICB9CgogICAgY29uc3QgbWF4ID0gb2NjdXIubWF4ID09PSAtMSA/IEluZmluaXR5IDogb2NjdXIubWF4OwogICAgcmV0dXJuIFtvY2N1ci5taW4sIG1heF07CiAgfQoKICBfc2V0QW5kQmluZChmb3JtTm9kZSwgZGF0YU5vZGUpIHsKICAgIHRoaXMuX3NldFByb3BlcnRpZXMoZm9ybU5vZGUsIGRhdGFOb2RlKTsKCiAgICB0aGlzLl9iaW5kSXRlbXMoZm9ybU5vZGUsIGRhdGFOb2RlKTsKCiAgICB0aGlzLl9iaW5kRWxlbWVudChmb3JtTm9kZSwgZGF0YU5vZGUpOwogIH0KCiAgX2JpbmRFbGVtZW50KGZvcm1Ob2RlLCBkYXRhTm9kZSkgewogICAgY29uc3QgdXNlbGVzc05vZGVzID0gW107CgogICAgdGhpcy5fY3JlYXRlT2NjdXJyZW5jZXMoZm9ybU5vZGUpOwoKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZm9ybU5vZGVbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpKSB7CiAgICAgIGlmIChjaGlsZFtfeGZhX29iamVjdC4kZGF0YV0pIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX21lcmdlTW9kZSA9PT0gdW5kZWZpbmVkICYmIGNoaWxkW194ZmFfb2JqZWN0LiRub2RlTmFtZV0gPT09ICJzdWJmb3JtIikgewogICAgICAgIHRoaXMuX21lcmdlTW9kZSA9IGNoaWxkLm1lcmdlTW9kZSA9PT0gImNvbnN1bWVEYXRhIjsKCiAgICAgICAgY29uc3QgZGF0YUNoaWxkcmVuID0gZGF0YU5vZGVbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpOwoKICAgICAgICBpZiAoZGF0YUNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMuX2JpbmRPY2N1cnJlbmNlcyhjaGlsZCwgW2RhdGFDaGlsZHJlblswXV0sIG51bGwpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbXB0eU1lcmdlKSB7CiAgICAgICAgICBjb25zdCBuc0lkID0gZGF0YU5vZGVbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gTlNfREFUQVNFVFMgPyAtMSA6IGRhdGFOb2RlW194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF07CiAgICAgICAgICBjb25zdCBkYXRhQ2hpbGQgPSBjaGlsZFtfeGZhX29iamVjdC4kZGF0YV0gPSBuZXcgX3hmYV9vYmplY3QuWG1sT2JqZWN0KG5zSWQsIGNoaWxkLm5hbWUgfHwgInJvb3QiKTsKCiAgICAgICAgICBkYXRhTm9kZVtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKGRhdGFDaGlsZCk7CgogICAgICAgICAgdGhpcy5fYmluZEVsZW1lbnQoY2hpbGQsIGRhdGFDaGlsZCk7CiAgICAgICAgfQoKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKCFjaGlsZFtfeGZhX29iamVjdC4kaXNCaW5kYWJsZV0oKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBsZXQgZ2xvYmFsID0gZmFsc2U7CiAgICAgIGxldCBwaWN0dXJlID0gbnVsbDsKICAgICAgbGV0IHJlZiA9IG51bGw7CiAgICAgIGxldCBtYXRjaCA9IG51bGw7CgogICAgICBpZiAoY2hpbGQuYmluZCkgewogICAgICAgIHN3aXRjaCAoY2hpbGQuYmluZC5tYXRjaCkgewogICAgICAgICAgY2FzZSAibm9uZSI6CiAgICAgICAgICAgIHRoaXMuX3NldEFuZEJpbmQoY2hpbGQsIGRhdGFOb2RlKTsKCiAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgIGNhc2UgImdsb2JhbCI6CiAgICAgICAgICAgIGdsb2JhbCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImRhdGFSZWYiOgogICAgICAgICAgICBpZiAoIWNoaWxkLmJpbmQucmVmKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKGBYRkEgLSByZWYgaXMgZW1wdHkgaW4gbm9kZSAke2NoaWxkW194ZmFfb2JqZWN0LiRub2RlTmFtZV19LmApOwoKICAgICAgICAgICAgICB0aGlzLl9zZXRBbmRCaW5kKGNoaWxkLCBkYXRhTm9kZSk7CgogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZWYgPSBjaGlsZC5iaW5kLnJlZjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2hpbGQuYmluZC5waWN0dXJlKSB7CiAgICAgICAgICBwaWN0dXJlID0gY2hpbGQuYmluZC5waWN0dXJlW194ZmFfb2JqZWN0LiRjb250ZW50XTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IFttaW4sIG1heF0gPSB0aGlzLl9nZXRPY2N1ckluZm8oY2hpbGQpOwoKICAgICAgaWYgKHJlZikgewogICAgICAgIG1hdGNoID0gKDAsIF9zb20uc2VhcmNoTm9kZSkodGhpcy5yb290LCBkYXRhTm9kZSwgcmVmLCB0cnVlLCBmYWxzZSk7CgogICAgICAgIGlmIChtYXRjaCA9PT0gbnVsbCkgewogICAgICAgICAgbWF0Y2ggPSAoMCwgX3NvbS5jcmVhdGVEYXRhTm9kZSkodGhpcy5kYXRhLCBkYXRhTm9kZSwgcmVmKTsKCiAgICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLl9pc0NvbnN1bWVEYXRhKCkpIHsKICAgICAgICAgICAgbWF0Y2hbX3hmYV9vYmplY3QuJGNvbnN1bWVkXSA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5fc2V0QW5kQmluZChjaGlsZCwgbWF0Y2gpOwoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy5faXNDb25zdW1lRGF0YSgpKSB7CiAgICAgICAgICAgIG1hdGNoID0gbWF0Y2guZmlsdGVyKG5vZGUgPT4gIW5vZGVbX3hmYV9vYmplY3QuJGNvbnN1bWVkXSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IG1heCkgewogICAgICAgICAgICBtYXRjaCA9IG1hdGNoLnNsaWNlKDAsIG1heCk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBtYXRjaCA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG1hdGNoICYmIHRoaXMuX2lzQ29uc3VtZURhdGEoKSkgewogICAgICAgICAgICBtYXRjaC5mb3JFYWNoKG5vZGUgPT4gewogICAgICAgICAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGNvbnN1bWVkXSA9IHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIWNoaWxkLm5hbWUpIHsKICAgICAgICAgIHRoaXMuX3NldEFuZEJpbmQoY2hpbGQsIGRhdGFOb2RlKTsKCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLl9pc0NvbnN1bWVEYXRhKCkpIHsKICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBbXTsKCiAgICAgICAgICB3aGlsZSAobWF0Y2hlcy5sZW5ndGggPCBtYXgpIHsKICAgICAgICAgICAgY29uc3QgZm91bmQgPSB0aGlzLl9maW5kRGF0YUJ5TmFtZVRvQ29uc3VtZShjaGlsZC5uYW1lLCBjaGlsZFtfeGZhX29iamVjdC4kaGFzU2V0dGFibGVWYWx1ZV0oKSwgZGF0YU5vZGUsIGdsb2JhbCk7CgogICAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvdW5kW194ZmFfb2JqZWN0LiRjb25zdW1lZF0gPSB0cnVlOwogICAgICAgICAgICBtYXRjaGVzLnB1c2goZm91bmQpOwogICAgICAgICAgfQoKICAgICAgICAgIG1hdGNoID0gbWF0Y2hlcy5sZW5ndGggPiAwID8gbWF0Y2hlcyA6IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1hdGNoID0gZGF0YU5vZGVbX3hmYV9vYmplY3QuJGdldFJlYWxDaGlsZHJlbkJ5TmFtZUl0XShjaGlsZC5uYW1lLCBmYWxzZSwgdGhpcy5lbXB0eU1lcmdlKS5uZXh0KCkudmFsdWU7CgogICAgICAgICAgaWYgKCFtYXRjaCkgewogICAgICAgICAgICBpZiAobWluID09PSAwKSB7CiAgICAgICAgICAgICAgdXNlbGVzc05vZGVzLnB1c2goY2hpbGQpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBuc0lkID0gZGF0YU5vZGVbX3hmYV9vYmplY3QuJG5hbWVzcGFjZUlkXSA9PT0gTlNfREFUQVNFVFMgPyAtMSA6IGRhdGFOb2RlW194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF07CiAgICAgICAgICAgIG1hdGNoID0gY2hpbGRbX3hmYV9vYmplY3QuJGRhdGFdID0gbmV3IF94ZmFfb2JqZWN0LlhtbE9iamVjdChuc0lkLCBjaGlsZC5uYW1lKTsKCiAgICAgICAgICAgIGlmICh0aGlzLmVtcHR5TWVyZ2UpIHsKICAgICAgICAgICAgICBtYXRjaFtfeGZhX29iamVjdC4kY29uc3VtZWRdID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGF0YU5vZGVbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShtYXRjaCk7CgogICAgICAgICAgICB0aGlzLl9zZXRBbmRCaW5kKGNoaWxkLCBtYXRjaCk7CgogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5lbXB0eU1lcmdlKSB7CiAgICAgICAgICAgIG1hdGNoW194ZmFfb2JqZWN0LiRjb25zdW1lZF0gPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIG1hdGNoID0gW21hdGNoXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChtYXRjaCkgewogICAgICAgIHRoaXMuX2JpbmRPY2N1cnJlbmNlcyhjaGlsZCwgbWF0Y2gsIHBpY3R1cmUpOwogICAgICB9IGVsc2UgaWYgKG1pbiA+IDApIHsKICAgICAgICB0aGlzLl9zZXRBbmRCaW5kKGNoaWxkLCBkYXRhTm9kZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXNlbGVzc05vZGVzLnB1c2goY2hpbGQpOwogICAgICB9CiAgICB9CgogICAgdXNlbGVzc05vZGVzLmZvckVhY2gobm9kZSA9PiBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJHJlbW92ZUNoaWxkXShub2RlKSk7CiAgfQoKfQoKZXhwb3J0cy5CaW5kZXIgPSBCaW5kZXI7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5WYWx1ZSA9IGV4cG9ydHMuVGV4dCA9IGV4cG9ydHMuVGVtcGxhdGVOYW1lc3BhY2UgPSBleHBvcnRzLlRlbXBsYXRlID0gZXhwb3J0cy5TZXRQcm9wZXJ0eSA9IGV4cG9ydHMuSXRlbXMgPSBleHBvcnRzLkZpZWxkID0gZXhwb3J0cy5CaW5kSXRlbXMgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwoKdmFyIF9sYXlvdXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgzKTsKCnZhciBfaHRtbF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oODQpOwoKdmFyIF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzgpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNik7Cgp2YXIgX3NvbSA9IF9fd19wZGZqc19yZXF1aXJlX18oODApOwoKY29uc3QgVEVNUExBVEVfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMudGVtcGxhdGUuaWQ7CmNvbnN0IFNWR19OUyA9ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI7CmNvbnN0IE1BWF9BVFRFTVBUU19GT1JfTFJUQl9MQVlPVVQgPSAyOwpjb25zdCBNQVhfRU1QVFlfUEFHRVMgPSAzOwpjb25zdCBERUZBVUxUX1RBQl9JTkRFWCA9IDUwMDA7CmNvbnN0IEhFQURJTkdfUEFUVEVSTiA9IC9eSChcZCspJC87CmNvbnN0IE1JTUVTID0gbmV3IFNldChbImltYWdlL2dpZiIsICJpbWFnZS9qcGVnIiwgImltYWdlL2pwZyIsICJpbWFnZS9wanBlZyIsICJpbWFnZS9wbmciLCAiaW1hZ2UvYXBuZyIsICJpbWFnZS94LXBuZyIsICJpbWFnZS9ibXAiLCAiaW1hZ2UveC1tcy1ibXAiLCAiaW1hZ2UvdGlmZiIsICJpbWFnZS90aWYiLCAiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtIl0pOwpjb25zdCBJTUFHRVNfSEVBREVSUyA9IFtbWzB4NDIsIDB4NGRdLCAiaW1hZ2UvYm1wIl0sIFtbMHhmZiwgMHhkOCwgMHhmZl0sICJpbWFnZS9qcGVnIl0sIFtbMHg0OSwgMHg0OSwgMHgyYSwgMHgwMF0sICJpbWFnZS90aWZmIl0sIFtbMHg0ZCwgMHg0ZCwgMHgwMCwgMHgyYV0sICJpbWFnZS90aWZmIl0sIFtbMHg0NywgMHg0OSwgMHg0NiwgMHgzOCwgMHgzOSwgMHg2MV0sICJpbWFnZS9naWYiXSwgW1sweDg5LCAweDUwLCAweDRlLCAweDQ3LCAweDBkLCAweDBhLCAweDFhLCAweDBhXSwgImltYWdlL3BuZyJdXTsKCmZ1bmN0aW9uIGdldEJvcmRlckRpbXMobm9kZSkgewogIGlmICghbm9kZSB8fCAhbm9kZS5ib3JkZXIpIHsKICAgIHJldHVybiB7CiAgICAgIHc6IDAsCiAgICAgIGg6IDAKICAgIH07CiAgfQoKICBjb25zdCBib3JkZXJFeHRyYSA9IG5vZGUuYm9yZGVyW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKTsKCiAgaWYgKCFib3JkZXJFeHRyYSkgewogICAgcmV0dXJuIHsKICAgICAgdzogMCwKICAgICAgaDogMAogICAgfTsKICB9CgogIHJldHVybiB7CiAgICB3OiBib3JkZXJFeHRyYS53aWR0aHNbMF0gKyBib3JkZXJFeHRyYS53aWR0aHNbMl0gKyBib3JkZXJFeHRyYS5pbnNldHNbMF0gKyBib3JkZXJFeHRyYS5pbnNldHNbMl0sCiAgICBoOiBib3JkZXJFeHRyYS53aWR0aHNbMV0gKyBib3JkZXJFeHRyYS53aWR0aHNbM10gKyBib3JkZXJFeHRyYS5pbnNldHNbMV0gKyBib3JkZXJFeHRyYS5pbnNldHNbM10KICB9Owp9CgpmdW5jdGlvbiBoYXNNYXJnaW4obm9kZSkgewogIHJldHVybiBub2RlLm1hcmdpbiAmJiAobm9kZS5tYXJnaW4udG9wSW5zZXQgfHwgbm9kZS5tYXJnaW4ucmlnaHRJbnNldCB8fCBub2RlLm1hcmdpbi5ib3R0b21JbnNldCB8fCBub2RlLm1hcmdpbi5sZWZ0SW5zZXQpOwp9CgpmdW5jdGlvbiBfc2V0VmFsdWUodGVtcGxhdGVOb2RlLCB2YWx1ZSkgewogIGlmICghdGVtcGxhdGVOb2RlLnZhbHVlKSB7CiAgICBjb25zdCBub2RlVmFsdWUgPSBuZXcgVmFsdWUoe30pOwoKICAgIHRlbXBsYXRlTm9kZVtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGVWYWx1ZSk7CgogICAgdGVtcGxhdGVOb2RlLnZhbHVlID0gbm9kZVZhbHVlOwogIH0KCiAgdGVtcGxhdGVOb2RlLnZhbHVlW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0odmFsdWUpOwp9CgpmdW5jdGlvbiogZ2V0Q29udGFpbmVkQ2hpbGRyZW4obm9kZSkgewogIGZvciAoY29uc3QgY2hpbGQgb2Ygbm9kZVtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkpIHsKICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFN1YmZvcm1TZXQpIHsKICAgICAgeWllbGQqIGNoaWxkW194ZmFfb2JqZWN0LiRnZXRDb250YWluZWRDaGlsZHJlbl0oKTsKICAgICAgY29udGludWU7CiAgICB9CgogICAgeWllbGQgY2hpbGQ7CiAgfQp9CgpmdW5jdGlvbiBpc1JlcXVpcmVkKG5vZGUpIHsKICByZXR1cm4gbm9kZS52YWxpZGF0ZSAmJiBub2RlLnZhbGlkYXRlLm51bGxUZXN0ID09PSAiZXJyb3IiOwp9CgpmdW5jdGlvbiBzZXRUYWJJbmRleChub2RlKSB7CiAgd2hpbGUgKG5vZGUpIHsKICAgIGlmICghbm9kZS50cmF2ZXJzYWwpIHsKICAgICAgbm9kZVtfeGZhX29iamVjdC4kdGFiSW5kZXhdID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiR0YWJJbmRleF07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kdGFiSW5kZXhdKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgbmV4dCA9IG51bGw7CgogICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLnRyYXZlcnNhbFtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkpIHsKICAgICAgaWYgKGNoaWxkLm9wZXJhdGlvbiA9PT0gIm5leHQiKSB7CiAgICAgICAgbmV4dCA9IGNoaWxkOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKCFuZXh0IHx8ICFuZXh0LnJlZikgewogICAgICBub2RlW194ZmFfb2JqZWN0LiR0YWJJbmRleF0gPSBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJHRhYkluZGV4XTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHJvb3QgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKCk7CgogICAgbm9kZVtfeGZhX29iamVjdC4kdGFiSW5kZXhdID0gKytyb290W194ZmFfb2JqZWN0LiR0YWJJbmRleF07CgogICAgY29uc3QgcmVmID0gcm9vdFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0obmV4dC5yZWYsIG5vZGUpOwoKICAgIGlmICghcmVmKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBub2RlID0gcmVmWzBdOwogIH0KfQoKZnVuY3Rpb24gYXBwbHlBc3Npc3Qob2JqLCBhdHRyaWJ1dGVzKSB7CiAgY29uc3QgYXNzaXN0ID0gb2JqLmFzc2lzdDsKCiAgaWYgKGFzc2lzdCkgewogICAgY29uc3QgYXNzaXN0VGl0bGUgPSBhc3Npc3RbX3hmYV9vYmplY3QuJHRvSFRNTF0oKTsKCiAgICBpZiAoYXNzaXN0VGl0bGUpIHsKICAgICAgYXR0cmlidXRlcy50aXRsZSA9IGFzc2lzdFRpdGxlOwogICAgfQoKICAgIGNvbnN0IHJvbGUgPSBhc3Npc3Qucm9sZTsKICAgIGNvbnN0IG1hdGNoID0gcm9sZS5tYXRjaChIRUFESU5HX1BBVFRFUk4pOwoKICAgIGlmIChtYXRjaCkgewogICAgICBjb25zdCBhcmlhUm9sZSA9ICJoZWFkaW5nIjsKICAgICAgY29uc3QgYXJpYUxldmVsID0gbWF0Y2hbMV07CiAgICAgIGF0dHJpYnV0ZXMucm9sZSA9IGFyaWFSb2xlOwogICAgICBhdHRyaWJ1dGVzWyJhcmlhLWxldmVsIl0gPSBhcmlhTGV2ZWw7CiAgICB9CiAgfQoKICBpZiAob2JqLmxheW91dCA9PT0gInRhYmxlIikgewogICAgYXR0cmlidXRlcy5yb2xlID0gInRhYmxlIjsKICB9IGVsc2UgaWYgKG9iai5sYXlvdXQgPT09ICJyb3ciKSB7CiAgICBhdHRyaWJ1dGVzLnJvbGUgPSAicm93IjsKICB9IGVsc2UgewogICAgY29uc3QgcGFyZW50ID0gb2JqW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKHBhcmVudC5sYXlvdXQgPT09ICJyb3ciKSB7CiAgICAgIGlmIChwYXJlbnQuYXNzaXN0ICYmIHBhcmVudC5hc3Npc3Qucm9sZSA9PT0gIlRIIikgewogICAgICAgIGF0dHJpYnV0ZXMucm9sZSA9ICJjb2x1bW5oZWFkZXIiOwogICAgICB9IGVsc2UgewogICAgICAgIGF0dHJpYnV0ZXMucm9sZSA9ICJjZWxsIjsKICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gYXJpYUxhYmVsKG9iaikgewogIGlmICghb2JqLmFzc2lzdCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBjb25zdCBhc3Npc3QgPSBvYmouYXNzaXN0OwoKICBpZiAoYXNzaXN0LnNwZWFrICYmIGFzc2lzdC5zcGVha1tfeGZhX29iamVjdC4kY29udGVudF0gIT09ICIiKSB7CiAgICByZXR1cm4gYXNzaXN0LnNwZWFrW194ZmFfb2JqZWN0LiRjb250ZW50XTsKICB9CgogIGlmIChhc3Npc3QudG9vbFRpcCkgewogICAgcmV0dXJuIGFzc2lzdC50b29sVGlwW194ZmFfb2JqZWN0LiRjb250ZW50XTsKICB9CgogIHJldHVybiBudWxsOwp9CgpmdW5jdGlvbiB2YWx1ZVRvSHRtbCh2YWx1ZSkgewogIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgIG5hbWU6ICJkaXYiLAogICAgYXR0cmlidXRlczogewogICAgICBjbGFzczogWyJ4ZmFSaWNoIl0sCiAgICAgIHN0eWxlOiBPYmplY3QuY3JlYXRlKG51bGwpCiAgICB9LAogICAgY2hpbGRyZW46IFt7CiAgICAgIG5hbWU6ICJzcGFuIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHN0eWxlOiBPYmplY3QuY3JlYXRlKG51bGwpCiAgICAgIH0sCiAgICAgIHZhbHVlCiAgICB9XQogIH0pOwp9CgpmdW5jdGlvbiBzZXRGaXJzdFVuc3BsaXR0YWJsZShub2RlKSB7CiAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgaWYgKHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5maXJzdFVuc3BsaXR0YWJsZSA9PT0gbnVsbCkgewogICAgcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLmZpcnN0VW5zcGxpdHRhYmxlID0gbm9kZTsKICAgIHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUgPSB0cnVlOwogIH0KfQoKZnVuY3Rpb24gdW5zZXRGaXJzdFVuc3BsaXR0YWJsZShub2RlKSB7CiAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgaWYgKHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5maXJzdFVuc3BsaXR0YWJsZSA9PT0gbm9kZSkgewogICAgcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gaGFuZGxlQnJlYWsobm9kZSkgewogIGlmIChub2RlW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGlmIChub2RlLnRhcmdldFR5cGUgPT09ICJhdXRvIikgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgY29uc3Qgcm9vdCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgbGV0IHRhcmdldCA9IG51bGw7CgogIGlmIChub2RlLnRhcmdldCkgewogICAgdGFyZ2V0ID0gcm9vdFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0obm9kZS50YXJnZXQsIG5vZGVbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKSk7CgogICAgaWYgKCF0YXJnZXQpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRhcmdldCA9IHRhcmdldFswXTsKICB9CgogIGNvbnN0IHsKICAgIGN1cnJlbnRQYWdlQXJlYSwKICAgIGN1cnJlbnRDb250ZW50QXJlYQogIH0gPSByb290W194ZmFfb2JqZWN0LiRleHRyYV07CgogIGlmIChub2RlLnRhcmdldFR5cGUgPT09ICJwYWdlQXJlYSIpIHsKICAgIGlmICghKHRhcmdldCBpbnN0YW5jZW9mIFBhZ2VBcmVhKSkgewogICAgICB0YXJnZXQgPSBudWxsOwogICAgfQoKICAgIGlmIChub2RlLnN0YXJ0TmV3KSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS50YXJnZXQgPSB0YXJnZXQgfHwgY3VycmVudFBhZ2VBcmVhOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSBpZiAodGFyZ2V0ICYmIHRhcmdldCAhPT0gY3VycmVudFBhZ2VBcmVhKSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS50YXJnZXQgPSB0YXJnZXQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlmICghKHRhcmdldCBpbnN0YW5jZW9mIENvbnRlbnRBcmVhKSkgewogICAgdGFyZ2V0ID0gbnVsbDsKICB9CgogIGNvbnN0IHBhZ2VBcmVhID0gdGFyZ2V0ICYmIHRhcmdldFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICBsZXQgaW5kZXg7CiAgbGV0IG5leHRQYWdlQXJlYSA9IHBhZ2VBcmVhOwoKICBpZiAobm9kZS5zdGFydE5ldykgewogICAgaWYgKHRhcmdldCkgewogICAgICBjb25zdCBjb250ZW50QXJlYXMgPSBwYWdlQXJlYS5jb250ZW50QXJlYS5jaGlsZHJlbjsKICAgICAgY29uc3QgaW5kZXhGb3JDdXJyZW50ID0gY29udGVudEFyZWFzLmluZGV4T2YoY3VycmVudENvbnRlbnRBcmVhKTsKICAgICAgY29uc3QgaW5kZXhGb3JUYXJnZXQgPSBjb250ZW50QXJlYXMuaW5kZXhPZih0YXJnZXQpOwoKICAgICAgaWYgKGluZGV4Rm9yQ3VycmVudCAhPT0gLTEgJiYgaW5kZXhGb3JDdXJyZW50IDwgaW5kZXhGb3JUYXJnZXQpIHsKICAgICAgICBuZXh0UGFnZUFyZWEgPSBudWxsOwogICAgICB9CgogICAgICBpbmRleCA9IGluZGV4Rm9yVGFyZ2V0IC0gMTsKICAgIH0gZWxzZSB7CiAgICAgIGluZGV4ID0gY3VycmVudFBhZ2VBcmVhLmNvbnRlbnRBcmVhLmNoaWxkcmVuLmluZGV4T2YoY3VycmVudENvbnRlbnRBcmVhKTsKICAgIH0KICB9IGVsc2UgaWYgKHRhcmdldCAmJiB0YXJnZXQgIT09IGN1cnJlbnRDb250ZW50QXJlYSkgewogICAgY29uc3QgY29udGVudEFyZWFzID0gcGFnZUFyZWEuY29udGVudEFyZWEuY2hpbGRyZW47CiAgICBpbmRleCA9IGNvbnRlbnRBcmVhcy5pbmRleE9mKHRhcmdldCkgLSAxOwogICAgbmV4dFBhZ2VBcmVhID0gcGFnZUFyZWEgPT09IGN1cnJlbnRQYWdlQXJlYSA/IG51bGwgOiBwYWdlQXJlYTsKICB9IGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLnRhcmdldCA9IG5leHRQYWdlQXJlYTsKICBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uaW5kZXggPSBpbmRleDsKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gaGFuZGxlT3ZlcmZsb3cobm9kZSwgZXh0cmFOb2RlLCBzcGFjZSkgewogIGNvbnN0IHJvb3QgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKCk7CgogIGNvbnN0IHNhdmVkID0gcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZTsKICBjb25zdCBzYXZlZE1ldGhvZCA9IGV4dHJhTm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF07CgogIGV4dHJhTm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0gPSAoKSA9PiBub2RlOwoKICByb290W194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlID0gdHJ1ZTsKCiAgY29uc3QgcmVzID0gZXh0cmFOb2RlW194ZmFfb2JqZWN0LiR0b0hUTUxdKHNwYWNlKTsKCiAgbm9kZVtfeGZhX29iamVjdC4kYWRkSFRNTF0ocmVzLmh0bWwsIHJlcy5iYm94KTsKCiAgcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IHNhdmVkOwogIGV4dHJhTm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0gPSBzYXZlZE1ldGhvZDsKfQoKY2xhc3MgQXBwZWFyYW5jZUZpbHRlciBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJhcHBlYXJhbmNlRmlsdGVyIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIEFyYyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJhcmMiLCB0cnVlKTsKICAgIHRoaXMuY2lyY3VsYXIgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5jaXJjdWxhciwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuaGFuZCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhhbmQsIFsiZXZlbiIsICJsZWZ0IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnN0YXJ0QW5nbGUgPSAoMCwgX3V0aWxzLmdldEZsb2F0KSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuc3RhcnRBbmdsZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KTsKICAgIHRoaXMuc3dlZXBBbmdsZSA9ICgwLCBfdXRpbHMuZ2V0RmxvYXQpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5zd2VlcEFuZ2xlLAogICAgICBkZWZhdWx0VmFsdWU6IDM2MCwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5lZGdlID0gbnVsbDsKICAgIHRoaXMuZmlsbCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oKSB7CiAgICBjb25zdCBlZGdlID0gdGhpcy5lZGdlIHx8IG5ldyBFZGdlKHt9KTsKCiAgICBjb25zdCBlZGdlU3R5bGUgPSBlZGdlW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAodGhpcy5maWxsICYmIHRoaXMuZmlsbC5wcmVzZW5jZSA9PT0gInZpc2libGUiKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHRoaXMuZmlsbFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSk7CiAgICB9IGVsc2UgewogICAgICBzdHlsZS5maWxsID0gInRyYW5zcGFyZW50IjsKICAgIH0KCiAgICBzdHlsZS5zdHJva2VXaWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGVkZ2UucHJlc2VuY2UgPT09ICJ2aXNpYmxlIiA/IGVkZ2UudGhpY2tuZXNzIDogMCk7CiAgICBzdHlsZS5zdHJva2UgPSBlZGdlU3R5bGUuY29sb3I7CiAgICBsZXQgYXJjOwogICAgY29uc3QgYXR0cmlidXRlcyA9IHsKICAgICAgeG1sbnM6IFNWR19OUywKICAgICAgc3R5bGU6IHsKICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgIGhlaWdodDogIjEwMCUiLAogICAgICAgIG92ZXJmbG93OiAidmlzaWJsZSIKICAgICAgfQogICAgfTsKCiAgICBpZiAodGhpcy5zd2VlcEFuZ2xlID09PSAzNjApIHsKICAgICAgYXJjID0gewogICAgICAgIG5hbWU6ICJlbGxpcHNlIiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICB4bWxuczogU1ZHX05TLAogICAgICAgICAgY3g6ICI1MCUiLAogICAgICAgICAgY3k6ICI1MCUiLAogICAgICAgICAgcng6ICI1MCUiLAogICAgICAgICAgcnk6ICI1MCUiLAogICAgICAgICAgc3R5bGUKICAgICAgICB9CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBjb25zdCBzdGFydEFuZ2xlID0gdGhpcy5zdGFydEFuZ2xlICogTWF0aC5QSSAvIDE4MDsKICAgICAgY29uc3Qgc3dlZXBBbmdsZSA9IHRoaXMuc3dlZXBBbmdsZSAqIE1hdGguUEkgLyAxODA7CiAgICAgIGNvbnN0IGxhcmdlQXJjID0gdGhpcy5zd2VlcEFuZ2xlID4gMTgwID8gMSA6IDA7CiAgICAgIGNvbnN0IFt4MSwgeTEsIHgyLCB5Ml0gPSBbNTAgKiAoMSArIE1hdGguY29zKHN0YXJ0QW5nbGUpKSwgNTAgKiAoMSAtIE1hdGguc2luKHN0YXJ0QW5nbGUpKSwgNTAgKiAoMSArIE1hdGguY29zKHN0YXJ0QW5nbGUgKyBzd2VlcEFuZ2xlKSksIDUwICogKDEgLSBNYXRoLnNpbihzdGFydEFuZ2xlICsgc3dlZXBBbmdsZSkpXTsKICAgICAgYXJjID0gewogICAgICAgIG5hbWU6ICJwYXRoIiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICB4bWxuczogU1ZHX05TLAogICAgICAgICAgZDogYE0gJHt4MX0gJHt5MX0gQSA1MCA1MCAwICR7bGFyZ2VBcmN9IDAgJHt4Mn0gJHt5Mn1gLAogICAgICAgICAgdmVjdG9yRWZmZWN0OiAibm9uLXNjYWxpbmctc3Ryb2tlIiwKICAgICAgICAgIHN0eWxlCiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuYXNzaWduKGF0dHJpYnV0ZXMsIHsKICAgICAgICB2aWV3Qm94OiAiMCAwIDEwMCAxMDAiLAogICAgICAgIHByZXNlcnZlQXNwZWN0UmF0aW86ICJub25lIgogICAgICB9KTsKICAgIH0KCiAgICBjb25zdCBzdmcgPSB7CiAgICAgIG5hbWU6ICJzdmciLAogICAgICBjaGlsZHJlbjogW2FyY10sCiAgICAgIGF0dHJpYnV0ZXMKICAgIH07CgogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKGhhc01hcmdpbihwYXJlbnQpKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgICBuYW1lOiAiZGl2IiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICBkaXNwbGF5OiAiaW5saW5lIiwKICAgICAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICAgICAgaGVpZ2h0OiAiMTAwJSIKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBbc3ZnXQogICAgICB9KTsKICAgIH0KCiAgICBzdmcuYXR0cmlidXRlcy5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhzdmcpOwogIH0KCn0KCmNsYXNzIEFyZWEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYXJlYSIsIHRydWUpOwogICAgdGhpcy5jb2xTcGFuID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuY29sU3BhbiwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgfHwgbiA9PT0gLTEKICAgIH0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy54ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy54LCAiMHB0Iik7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnksICIwcHQiKTsKICAgIHRoaXMuZGVzYyA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZHJhdyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leE9iamVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leGNsR3JvdXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmllbGQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViZm9ybSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtU2V0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICAqW194ZmFfb2JqZWN0LiRnZXRDb250YWluZWRDaGlsZHJlbl0oKSB7CiAgICB5aWVsZCogZ2V0Q29udGFpbmVkQ2hpbGRyZW4odGhpcyk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzVHJhbnNwYXJlbnRdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzQmluZGFibGVdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJGFkZEhUTUxdKGh0bWwsIGJib3gpIHsKICAgIGNvbnN0IFt4LCB5LCB3LCBoXSA9IGJib3g7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ud2lkdGggPSBNYXRoLm1heCh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ud2lkdGgsIHggKyB3KTsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQgPSBNYXRoLm1heCh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uaGVpZ2h0LCB5ICsgaCk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEF2YWlsYWJsZVNwYWNlXSgpIHsKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXZhaWxhYmxlU3BhY2U7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJwb3NpdGlvbiIpOwogICAgY29uc3QgYXR0cmlidXRlcyA9IHsKICAgICAgc3R5bGUsCiAgICAgIGlkOiB0aGlzW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICBjbGFzczogWyJ4ZmFBcmVhIl0KICAgIH07CgogICAgaWYgKCgwLCBfaHRtbF91dGlscy5pc1ByaW50T25seSkodGhpcykpIHsKICAgICAgYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFQcmludE9ubHkiKTsKICAgIH0KCiAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGF0dHJpYnV0ZXMueGZhTmFtZSA9IHRoaXMubmFtZTsKICAgIH0KCiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICBjaGlsZHJlbiwKICAgICAgd2lkdGg6IDAsCiAgICAgIGhlaWdodDogMCwKICAgICAgYXZhaWxhYmxlU3BhY2UKICAgIH07CgogICAgY29uc3QgcmVzdWx0ID0gdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHsKICAgICAgZmlsdGVyOiBuZXcgU2V0KFsiYXJlYSIsICJkcmF3IiwgImZpZWxkIiwgImV4Y2xHcm91cCIsICJzdWJmb3JtIiwgInN1YmZvcm1TZXQiXSksCiAgICAgIGluY2x1ZGU6IHRydWUKICAgIH0pOwoKICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHsKICAgICAgaWYgKHJlc3VsdC5pc0JyZWFrKCkpIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CgogICAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgIH0KCiAgICBzdHlsZS53aWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCk7CiAgICBzdHlsZS5oZWlnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uaGVpZ2h0KTsKICAgIGNvbnN0IGh0bWwgPSB7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzLAogICAgICBjaGlsZHJlbgogICAgfTsKICAgIGNvbnN0IGJib3ggPSBbdGhpcy54LCB0aGlzLnksIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCwgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmhlaWdodF07CiAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoaHRtbCwgYmJveCk7CiAgfQoKfQoKY2xhc3MgQXNzaXN0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImFzc2lzdCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnJvbGUgPSBhdHRyaWJ1dGVzLnJvbGUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5zcGVhayA9IG51bGw7CiAgICB0aGlzLnRvb2xUaXAgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkgewogICAgcmV0dXJuIHRoaXMudG9vbFRpcCAmJiB0aGlzLnRvb2xUaXBbX3hmYV9vYmplY3QuJGNvbnRlbnRdID8gdGhpcy50b29sVGlwW194ZmFfb2JqZWN0LiRjb250ZW50XSA6IG51bGw7CiAgfQoKfQoKY2xhc3MgQmFyY29kZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJiYXJjb2RlIiwgdHJ1ZSk7CiAgICB0aGlzLmNoYXJFbmNvZGluZyA9ICgwLCBfdXRpbHMuZ2V0S2V5d29yZCkoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmNoYXJFbmNvZGluZyA/IGF0dHJpYnV0ZXMuY2hhckVuY29kaW5nLnRvTG93ZXJDYXNlKCkgOiAiIiwKICAgICAgZGVmYXVsdFZhbHVlOiAiIiwKICAgICAgdmFsaWRhdGU6IGsgPT4gWyJ1dGYtOCIsICJiaWctZml2ZSIsICJmb250c3BlY2lmaWMiLCAiZ2JrIiwgImdiLTE4MDMwIiwgImdiLTIzMTIiLCAia3NjLTU2MDEiLCAibm9uZSIsICJzaGlmdC1qaXMiLCAidWNzLTIiLCAidXRmLTE2Il0uaW5jbHVkZXMoaykgfHwgay5tYXRjaCgvaXNvLTg4NTktXGR7Mn0vKQogICAgfSk7CiAgICB0aGlzLmNoZWNrc3VtID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuY2hlY2tzdW0sIFsibm9uZSIsICIxbW9kMTAiLCAiMW1vZDEwXzFtb2QxMSIsICIybW9kMTAiLCAiYXV0byJdKTsKICAgIHRoaXMuZGF0YUNvbHVtbkNvdW50ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZGF0YUNvbHVtbkNvdW50LAogICAgICBkZWZhdWx0VmFsdWU6IC0xLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5kYXRhTGVuZ3RoID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZGF0YUxlbmd0aCwKICAgICAgZGVmYXVsdFZhbHVlOiAtMSwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMuZGF0YVByZXAgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5kYXRhUHJlcCwgWyJub25lIiwgImZsYXRlQ29tcHJlc3MiXSk7CiAgICB0aGlzLmRhdGFSb3dDb3VudCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmRhdGFSb3dDb3VudCwKICAgICAgZGVmYXVsdFZhbHVlOiAtMSwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMuZW5kQ2hhciA9IGF0dHJpYnV0ZXMuZW5kQ2hhciB8fCAiIjsKICAgIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5lcnJvckNvcnJlY3Rpb25MZXZlbCwKICAgICAgZGVmYXVsdFZhbHVlOiAtMSwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwICYmIHggPD0gOAogICAgfSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubW9kdWxlSGVpZ2h0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tb2R1bGVIZWlnaHQsICI1bW0iKTsKICAgIHRoaXMubW9kdWxlV2lkdGggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1vZHVsZVdpZHRoLCAiMC4yNW1tIik7CiAgICB0aGlzLnByaW50Q2hlY2tEaWdpdCA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnByaW50Q2hlY2tEaWdpdCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMucm93Q29sdW1uUmF0aW8gPSAoMCwgX3V0aWxzLmdldFJhdGlvKShhdHRyaWJ1dGVzLnJvd0NvbHVtblJhdGlvKTsKICAgIHRoaXMuc3RhcnRDaGFyID0gYXR0cmlidXRlcy5zdGFydENoYXIgfHwgIiI7CiAgICB0aGlzLnRleHRMb2NhdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRleHRMb2NhdGlvbiwgWyJiZWxvdyIsICJhYm92ZSIsICJhYm92ZUVtYmVkZGVkIiwgImJlbG93RW1iZWRkZWQiLCAibm9uZSJdKTsKICAgIHRoaXMudHJ1bmNhdGUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy50cnVuY2F0ZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUgPyBhdHRyaWJ1dGVzLnR5cGUudG9Mb3dlckNhc2UoKSA6ICIiLCBbImF6dGVjIiwgImNvZGFiYXIiLCAiY29kZTJvZjVpbmR1c3RyaWFsIiwgImNvZGUyb2Y1aW50ZXJsZWF2ZWQiLCAiY29kZTJvZjVtYXRyaXgiLCAiY29kZTJvZjVzdGFuZGFyZCIsICJjb2RlM29mOSIsICJjb2RlM29mOWV4dGVuZGVkIiwgImNvZGUxMSIsICJjb2RlNDkiLCAiY29kZTkzIiwgImNvZGUxMjgiLCAiY29kZTEyOGEiLCAiY29kZTEyOGIiLCAiY29kZTEyOGMiLCAiY29kZTEyOHNzY2MiLCAiZGF0YW1hdHJpeCIsICJlYW44IiwgImVhbjhhZGQyIiwgImVhbjhhZGQ1IiwgImVhbjEzIiwgImVhbjEzYWRkMiIsICJlYW4xM2FkZDUiLCAiZWFuMTNwd2NkIiwgImZpbSIsICJsb2dtYXJzIiwgIm1heGljb2RlIiwgIm1zaSIsICJwZGY0MTciLCAicGRmNDE3bWFjcm8iLCAicGxlc3NleSIsICJwb3N0YXVzY3VzdDIiLCAicG9zdGF1c2N1c3QzIiwgInBvc3RhdXNyZXBseXBhaWQiLCAicG9zdGF1c3N0YW5kYXJkIiwgInBvc3R1a3JtNHNjYyIsICJwb3N0dXNkcGJjIiwgInBvc3R1c2ltYiIsICJwb3N0dXNzdGFuZGFyZCIsICJwb3N0dXM1emlwIiwgInFyY29kZSIsICJyZmlkIiwgInJzczE0IiwgInJzczE0ZXhwYW5kZWQiLCAicnNzMTRsaW1pdGVkIiwgInJzczE0c3RhY2tlZCIsICJyc3MxNHN0YWNrZWRvbW5pIiwgInJzczE0dHJ1bmNhdGVkIiwgInRlbGVwZW4iLCAidWNjMTI4IiwgInVjYzEyOHJhbmRvbSIsICJ1Y2MxMjhzc2NjIiwgInVwY2EiLCAidXBjYWFkZDIiLCAidXBjYWFkZDUiLCAidXBjYXB3Y2QiLCAidXBjZSIsICJ1cGNlYWRkMiIsICJ1cGNlYWRkNSIsICJ1cGNlYW4yIiwgInVwY2VhbjUiLCAidXBzbWF4aWNvZGUiXSk7CiAgICB0aGlzLnVwc01vZGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy51cHNNb2RlLCBbInVzQ2FycmllciIsICJpbnRlcm5hdGlvbmFsQ2FycmllciIsICJzZWN1cmVTeW1ib2wiLCAic3RhbmRhcmRTeW1ib2wiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy53aWRlTmFycm93UmF0aW8gPSAoMCwgX3V0aWxzLmdldFJhdGlvKShhdHRyaWJ1dGVzLndpZGVOYXJyb3dSYXRpbyk7CiAgICB0aGlzLmVuY3J5cHQgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCn0KCmNsYXNzIEJpbmQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYmluZCIsIHRydWUpOwogICAgdGhpcy5tYXRjaCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm1hdGNoLCBbIm9uY2UiLCAiZGF0YVJlZiIsICJnbG9iYWwiLCAibm9uZSJdKTsKICAgIHRoaXMucmVmID0gYXR0cmlidXRlcy5yZWYgfHwgIiI7CiAgICB0aGlzLnBpY3R1cmUgPSBudWxsOwogIH0KCn0KCmNsYXNzIEJpbmRJdGVtcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJiaW5kSXRlbXMiKTsKICAgIHRoaXMuY29ubmVjdGlvbiA9IGF0dHJpYnV0ZXMuY29ubmVjdGlvbiB8fCAiIjsKICAgIHRoaXMubGFiZWxSZWYgPSBhdHRyaWJ1dGVzLmxhYmVsUmVmIHx8ICIiOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMudmFsdWVSZWYgPSBhdHRyaWJ1dGVzLnZhbHVlUmVmIHx8ICIiOwogIH0KCn0KCmV4cG9ydHMuQmluZEl0ZW1zID0gQmluZEl0ZW1zOwoKY2xhc3MgQm9va2VuZCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJib29rZW5kIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGVhZGVyID0gYXR0cmlidXRlcy5sZWFkZXIgfHwgIiI7CiAgICB0aGlzLnRyYWlsZXIgPSBhdHRyaWJ1dGVzLnRyYWlsZXIgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIEJvb2xlYW5FbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYm9vbGVhbiIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09IDEgPyAiMSIgOiAiMCIpOwogIH0KCn0KCmNsYXNzIEJvcmRlciBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJib3JkZXIiLCB0cnVlKTsKICAgIHRoaXMuYnJlYWsgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5icmVhaywgWyJjbG9zZSIsICJvcGVuIl0pOwogICAgdGhpcy5oYW5kID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaGFuZCwgWyJldmVuIiwgImxlZnQiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb3JuZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoNCk7CiAgICB0aGlzLmVkZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoNCk7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZpbGwgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICBjb25zdCBlZGdlcyA9IHRoaXMuZWRnZS5jaGlsZHJlbi5zbGljZSgpOwoKICAgICAgaWYgKGVkZ2VzLmxlbmd0aCA8IDQpIHsKICAgICAgICBjb25zdCBkZWZhdWx0RWRnZSA9IGVkZ2VzLmF0KC0xKSB8fCBuZXcgRWRnZSh7fSk7CgogICAgICAgIGZvciAobGV0IGkgPSBlZGdlcy5sZW5ndGg7IGkgPCA0OyBpKyspIHsKICAgICAgICAgIGVkZ2VzLnB1c2goZGVmYXVsdEVkZ2UpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3Qgd2lkdGhzID0gZWRnZXMubWFwKGVkZ2UgPT4gZWRnZS50aGlja25lc3MpOwogICAgICBjb25zdCBpbnNldHMgPSBbMCwgMCwgMCwgMF07CgogICAgICBpZiAodGhpcy5tYXJnaW4pIHsKICAgICAgICBpbnNldHNbMF0gPSB0aGlzLm1hcmdpbi50b3BJbnNldDsKICAgICAgICBpbnNldHNbMV0gPSB0aGlzLm1hcmdpbi5yaWdodEluc2V0OwogICAgICAgIGluc2V0c1syXSA9IHRoaXMubWFyZ2luLmJvdHRvbUluc2V0OwogICAgICAgIGluc2V0c1szXSA9IHRoaXMubWFyZ2luLmxlZnRJbnNldDsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICAgIHdpZHRocywKICAgICAgICBpbnNldHMsCiAgICAgICAgZWRnZXMKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIGNvbnN0IHsKICAgICAgZWRnZXMKICAgIH0gPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKTsKCiAgICBjb25zdCBlZGdlU3R5bGVzID0gZWRnZXMubWFwKG5vZGUgPT4gewogICAgICBjb25zdCBzdHlsZSA9IG5vZGVbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgICBzdHlsZS5jb2xvciA9IHN0eWxlLmNvbG9yIHx8ICIjMDAwMDAwIjsKICAgICAgcmV0dXJuIHN0eWxlOwogICAgfSk7CiAgICBjb25zdCBzdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgaWYgKHRoaXMubWFyZ2luKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHRoaXMubWFyZ2luW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpKTsKICAgIH0KCiAgICBpZiAodGhpcy5maWxsICYmIHRoaXMuZmlsbC5wcmVzZW5jZSA9PT0gInZpc2libGUiKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHRoaXMuZmlsbFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSk7CiAgICB9CgogICAgaWYgKHRoaXMuY29ybmVyLmNoaWxkcmVuLnNvbWUobm9kZSA9PiBub2RlLnJhZGl1cyAhPT0gMCkpIHsKICAgICAgY29uc3QgY29ybmVyU3R5bGVzID0gdGhpcy5jb3JuZXIuY2hpbGRyZW4ubWFwKG5vZGUgPT4gbm9kZVtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSk7CgogICAgICBpZiAoY29ybmVyU3R5bGVzLmxlbmd0aCA9PT0gMiB8fCBjb3JuZXJTdHlsZXMubGVuZ3RoID09PSAzKSB7CiAgICAgICAgY29uc3QgbGFzdCA9IGNvcm5lclN0eWxlcy5hdCgtMSk7CgogICAgICAgIGZvciAobGV0IGkgPSBjb3JuZXJTdHlsZXMubGVuZ3RoOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgICBjb3JuZXJTdHlsZXMucHVzaChsYXN0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHN0eWxlLmJvcmRlclJhZGl1cyA9IGNvcm5lclN0eWxlcy5tYXAocyA9PiBzLnJhZGl1cykuam9pbigiICIpOwogICAgfQoKICAgIHN3aXRjaCAodGhpcy5wcmVzZW5jZSkgewogICAgICBjYXNlICJpbnZpc2libGUiOgogICAgICBjYXNlICJoaWRkZW4iOgogICAgICAgIHN0eWxlLmJvcmRlclN0eWxlID0gIiI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJpbmFjdGl2ZSI6CiAgICAgICAgc3R5bGUuYm9yZGVyU3R5bGUgPSAibm9uZSI7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHN0eWxlLmJvcmRlclN0eWxlID0gZWRnZVN0eWxlcy5tYXAocyA9PiBzLnN0eWxlKS5qb2luKCIgIik7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgc3R5bGUuYm9yZGVyV2lkdGggPSBlZGdlU3R5bGVzLm1hcChzID0+IHMud2lkdGgpLmpvaW4oIiAiKTsKICAgIHN0eWxlLmJvcmRlckNvbG9yID0gZWRnZVN0eWxlcy5tYXAocyA9PiBzLmNvbG9yKS5qb2luKCIgIik7CiAgICByZXR1cm4gc3R5bGU7CiAgfQoKfQoKY2xhc3MgQnJlYWsgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYnJlYWsiLCB0cnVlKTsKICAgIHRoaXMuYWZ0ZXIgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hZnRlciwgWyJhdXRvIiwgImNvbnRlbnRBcmVhIiwgInBhZ2VBcmVhIiwgInBhZ2VFdmVuIiwgInBhZ2VPZGQiXSk7CiAgICB0aGlzLmFmdGVyVGFyZ2V0ID0gYXR0cmlidXRlcy5hZnRlclRhcmdldCB8fCAiIjsKICAgIHRoaXMuYmVmb3JlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYmVmb3JlLCBbImF1dG8iLCAiY29udGVudEFyZWEiLCAicGFnZUFyZWEiLCAicGFnZUV2ZW4iLCAicGFnZU9kZCJdKTsKICAgIHRoaXMuYmVmb3JlVGFyZ2V0ID0gYXR0cmlidXRlcy5iZWZvcmVUYXJnZXQgfHwgIiI7CiAgICB0aGlzLmJvb2tlbmRMZWFkZXIgPSBhdHRyaWJ1dGVzLmJvb2tlbmRMZWFkZXIgfHwgIiI7CiAgICB0aGlzLmJvb2tlbmRUcmFpbGVyID0gYXR0cmlidXRlcy5ib29rZW5kVHJhaWxlciB8fCAiIjsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vdmVyZmxvd0xlYWRlciA9IGF0dHJpYnV0ZXMub3ZlcmZsb3dMZWFkZXIgfHwgIiI7CiAgICB0aGlzLm92ZXJmbG93VGFyZ2V0ID0gYXR0cmlidXRlcy5vdmVyZmxvd1RhcmdldCB8fCAiIjsKICAgIHRoaXMub3ZlcmZsb3dUcmFpbGVyID0gYXR0cmlidXRlcy5vdmVyZmxvd1RyYWlsZXIgfHwgIiI7CiAgICB0aGlzLnN0YXJ0TmV3ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuc3RhcnROZXcsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCn0KCmNsYXNzIEJyZWFrQWZ0ZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYnJlYWtBZnRlciIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxlYWRlciA9IGF0dHJpYnV0ZXMubGVhZGVyIHx8ICIiOwogICAgdGhpcy5zdGFydE5ldyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnN0YXJ0TmV3LAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy50YXJnZXQgPSBhdHRyaWJ1dGVzLnRhcmdldCB8fCAiIjsKICAgIHRoaXMudGFyZ2V0VHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRhcmdldFR5cGUsIFsiYXV0byIsICJjb250ZW50QXJlYSIsICJwYWdlQXJlYSJdKTsKICAgIHRoaXMudHJhaWxlciA9IGF0dHJpYnV0ZXMudHJhaWxlciB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnNjcmlwdCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQnJlYWtCZWZvcmUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiYnJlYWtCZWZvcmUiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sZWFkZXIgPSBhdHRyaWJ1dGVzLmxlYWRlciB8fCAiIjsKICAgIHRoaXMuc3RhcnROZXcgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5zdGFydE5ldywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMudGFyZ2V0ID0gYXR0cmlidXRlcy50YXJnZXQgfHwgIiI7CiAgICB0aGlzLnRhcmdldFR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50YXJnZXRUeXBlLCBbImF1dG8iLCAiY29udGVudEFyZWEiLCAicGFnZUFyZWEiXSk7CiAgICB0aGlzLnRyYWlsZXIgPSBhdHRyaWJ1dGVzLnRyYWlsZXIgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7fTsKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogIH0KCn0KCmNsYXNzIEJ1dHRvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJidXR0b24iLCB0cnVlKTsKICAgIHRoaXMuaGlnaGxpZ2h0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaGlnaGxpZ2h0LCBbImludmVydGVkIiwgIm5vbmUiLCAib3V0bGluZSIsICJwdXNoIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgZ3JhbmRwYSA9IHBhcmVudFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGh0bWxCdXR0b24gPSB7CiAgICAgIG5hbWU6ICJidXR0b24iLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgY2xhc3M6IFsieGZhQnV0dG9uIl0sCiAgICAgICAgc3R5bGU6IHt9CiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbXQogICAgfTsKCiAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGdyYW5kcGEuZXZlbnQuY2hpbGRyZW4pIHsKICAgICAgaWYgKGV2ZW50LmFjdGl2aXR5ICE9PSAiY2xpY2siIHx8ICFldmVudC5zY3JpcHQpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QganNVUkwgPSAoMCwgX2NvcmVfdXRpbHMucmVjb3ZlckpzVVJMKShldmVudC5zY3JpcHRbX3hmYV9vYmplY3QuJGNvbnRlbnRdKTsKCiAgICAgIGlmICghanNVUkwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgaHJlZiA9ICgwLCBfaHRtbF91dGlscy5maXhVUkwpKGpzVVJMLnVybCk7CgogICAgICBpZiAoIWhyZWYpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaHRtbEJ1dHRvbi5jaGlsZHJlbi5wdXNoKHsKICAgICAgICBuYW1lOiAiYSIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgaWQ6ICJsaW5rIiArIHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgICBocmVmLAogICAgICAgICAgbmV3V2luZG93OiBqc1VSTC5uZXdXaW5kb3csCiAgICAgICAgICBjbGFzczogWyJ4ZmFMaW5rIl0sCiAgICAgICAgICBzdHlsZToge30KICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBbXQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhodG1sQnV0dG9uKTsKICB9Cgp9CgpjbGFzcyBDYWxjdWxhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY2FsY3VsYXRlIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMub3ZlcnJpZGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5vdmVycmlkZSwgWyJkaXNhYmxlZCIsICJlcnJvciIsICJpZ25vcmUiLCAid2FybmluZyJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1lc3NhZ2UgPSBudWxsOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogIH0KCn0KCmNsYXNzIENhcHRpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY2FwdGlvbiIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnBsYWNlbWVudCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnBsYWNlbWVudCwgWyJsZWZ0IiwgImJvdHRvbSIsICJpbmxpbmUiLCAicmlnaHQiLCAidG9wIl0pOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMucmVzZXJ2ZSA9IE1hdGguY2VpbCgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnJlc2VydmUpKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZvbnQgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogICAgdGhpcy5wYXJhID0gbnVsbDsKICAgIHRoaXMudmFsdWUgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0odmFsdWUpIHsKICAgIF9zZXRWYWx1ZSh0aGlzLCB2YWx1ZSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEV4dHJhXShhdmFpbGFibGVTcGFjZSkgewogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgbGV0IHsKICAgICAgICB3aWR0aCwKICAgICAgICBoZWlnaHQKICAgICAgfSA9IGF2YWlsYWJsZVNwYWNlOwoKICAgICAgc3dpdGNoICh0aGlzLnBsYWNlbWVudCkgewogICAgICAgIGNhc2UgImxlZnQiOgogICAgICAgIGNhc2UgInJpZ2h0IjoKICAgICAgICBjYXNlICJpbmxpbmUiOgogICAgICAgICAgd2lkdGggPSB0aGlzLnJlc2VydmUgPD0gMCA/IHdpZHRoIDogdGhpcy5yZXNlcnZlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInRvcCI6CiAgICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICAgIGhlaWdodCA9IHRoaXMucmVzZXJ2ZSA8PSAwID8gaGVpZ2h0IDogdGhpcy5yZXNlcnZlOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9ICgwLCBfaHRtbF91dGlscy5sYXlvdXROb2RlKSh0aGlzLCB7CiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV07CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGlmICghdGhpcy52YWx1ZSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcHVzaFBhcmFdKCk7CgogICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKS5odG1sOwoKICAgIGlmICghdmFsdWUpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICBjb25zdCBzYXZlZFJlc2VydmUgPSB0aGlzLnJlc2VydmU7CgogICAgaWYgKHRoaXMucmVzZXJ2ZSA8PSAwKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB3LAogICAgICAgIGgKICAgICAgfSA9IHRoaXNbX3hmYV9vYmplY3QuJGdldEV4dHJhXShhdmFpbGFibGVTcGFjZSk7CgogICAgICBzd2l0Y2ggKHRoaXMucGxhY2VtZW50KSB7CiAgICAgICAgY2FzZSAibGVmdCI6CiAgICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgIGNhc2UgImlubGluZSI6CiAgICAgICAgICB0aGlzLnJlc2VydmUgPSB3OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgInRvcCI6CiAgICAgICAgY2FzZSAiYm90dG9tIjoKICAgICAgICAgIHRoaXMucmVzZXJ2ZSA9IGg7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgbmFtZTogIiN0ZXh0IiwKICAgICAgICB2YWx1ZQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGNoaWxkcmVuLnB1c2godmFsdWUpOwogICAgfQoKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJmb250IiwgIm1hcmdpbiIsICJ2aXNpYmlsaXR5Iik7CgogICAgc3dpdGNoICh0aGlzLnBsYWNlbWVudCkgewogICAgICBjYXNlICJsZWZ0IjoKICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgIGlmICh0aGlzLnJlc2VydmUgPiAwKSB7CiAgICAgICAgICBzdHlsZS53aWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMucmVzZXJ2ZSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcCI6CiAgICAgIGNhc2UgImJvdHRvbSI6CiAgICAgICAgaWYgKHRoaXMucmVzZXJ2ZSA+IDApIHsKICAgICAgICAgIHN0eWxlLmhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMucmVzZXJ2ZSk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgIH0KCiAgICAoMCwgX2h0bWxfdXRpbHMuc2V0UGFyYSkodGhpcywgbnVsbCwgdmFsdWUpOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgdGhpcy5yZXNlcnZlID0gc2F2ZWRSZXNlcnZlOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHN0eWxlLAogICAgICAgIGNsYXNzOiBbInhmYUNhcHRpb24iXQogICAgICB9LAogICAgICBjaGlsZHJlbgogICAgfSk7CiAgfQoKfQoKY2xhc3MgQ2VydGlmaWNhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY2VydGlmaWNhdGUiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBDZXJ0aWZpY2F0ZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY2VydGlmaWNhdGVzIiwgdHJ1ZSk7CiAgICB0aGlzLmNyZWRlbnRpYWxTZXJ2ZXJQb2xpY3kgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5jcmVkZW50aWFsU2VydmVyUG9saWN5LCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVybCA9IGF0dHJpYnV0ZXMudXJsIHx8ICIiOwogICAgdGhpcy51cmxQb2xpY3kgPSBhdHRyaWJ1dGVzLnVybFBvbGljeSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmVuY3J5cHRpb24gPSBudWxsOwogICAgdGhpcy5pc3N1ZXJzID0gbnVsbDsKICAgIHRoaXMua2V5VXNhZ2UgPSBudWxsOwogICAgdGhpcy5vaWRzID0gbnVsbDsKICAgIHRoaXMuc2lnbmluZyA9IG51bGw7CiAgICB0aGlzLnN1YmplY3RETnMgPSBudWxsOwogIH0KCn0KCmNsYXNzIENoZWNrQnV0dG9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNoZWNrQnV0dG9uIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubWFyayA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm1hcmssIFsiZGVmYXVsdCIsICJjaGVjayIsICJjaXJjbGUiLCAiY3Jvc3MiLCAiZGlhbW9uZCIsICJzcXVhcmUiLCAic3RhciJdKTsKICAgIHRoaXMuc2hhcGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zaGFwZSwgWyJzcXVhcmUiLCAicm91bmQiXSk7CiAgICB0aGlzLnNpemUgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnNpemUsICIxMHB0Iik7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSgibWFyZ2luIik7CiAgICBjb25zdCBzaXplID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5zaXplKTsKICAgIHN0eWxlLndpZHRoID0gc3R5bGUuaGVpZ2h0ID0gc2l6ZTsKICAgIGxldCB0eXBlOwogICAgbGV0IGNsYXNzTmFtZTsKICAgIGxldCBncm91cElkOwoKICAgIGNvbnN0IGZpZWxkID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgaXRlbXMgPSBmaWVsZC5pdGVtcy5jaGlsZHJlbi5sZW5ndGggJiYgZmllbGQuaXRlbXMuY2hpbGRyZW5bMF1bX3hmYV9vYmplY3QuJHRvSFRNTF0oKS5odG1sIHx8IFtdOwogICAgY29uc3QgZXhwb3J0ZWRWYWx1ZSA9IHsKICAgICAgb246IChpdGVtc1swXSAhPT0gdW5kZWZpbmVkID8gaXRlbXNbMF0gOiAib24iKS50b1N0cmluZygpLAogICAgICBvZmY6IChpdGVtc1sxXSAhPT0gdW5kZWZpbmVkID8gaXRlbXNbMV0gOiAib2ZmIikudG9TdHJpbmcoKQogICAgfTsKICAgIGNvbnN0IHZhbHVlID0gZmllbGQudmFsdWUgJiYgZmllbGQudmFsdWVbX3hmYV9vYmplY3QuJHRleHRdKCkgfHwgIm9mZiI7CiAgICBjb25zdCBjaGVja2VkID0gdmFsdWUgPT09IGV4cG9ydGVkVmFsdWUub24gfHwgdW5kZWZpbmVkOwoKICAgIGNvbnN0IGNvbnRhaW5lciA9IGZpZWxkW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICAgIGNvbnN0IGZpZWxkSWQgPSBmaWVsZFtfeGZhX29iamVjdC4kdWlkXTsKICAgIGxldCBkYXRhSWQ7CgogICAgaWYgKGNvbnRhaW5lciBpbnN0YW5jZW9mIEV4Y2xHcm91cCkgewogICAgICBncm91cElkID0gY29udGFpbmVyW194ZmFfb2JqZWN0LiR1aWRdOwogICAgICB0eXBlID0gInJhZGlvIjsKICAgICAgY2xhc3NOYW1lID0gInhmYVJhZGlvIjsKICAgICAgZGF0YUlkID0gY29udGFpbmVyW194ZmFfb2JqZWN0LiRkYXRhXSAmJiBjb250YWluZXJbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGNvbnRhaW5lcltfeGZhX29iamVjdC4kdWlkXTsKICAgIH0gZWxzZSB7CiAgICAgIHR5cGUgPSAiY2hlY2tib3giOwogICAgICBjbGFzc05hbWUgPSAieGZhQ2hlY2tib3giOwogICAgICBkYXRhSWQgPSBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdOwogICAgfQoKICAgIGNvbnN0IGlucHV0ID0gewogICAgICBuYW1lOiAiaW5wdXQiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFtjbGFzc05hbWVdLAogICAgICAgIHN0eWxlLAogICAgICAgIGZpZWxkSWQsCiAgICAgICAgZGF0YUlkLAogICAgICAgIHR5cGUsCiAgICAgICAgY2hlY2tlZCwKICAgICAgICB4ZmFPbjogZXhwb3J0ZWRWYWx1ZS5vbiwKICAgICAgICB4ZmFPZmY6IGV4cG9ydGVkVmFsdWUub2ZmLAogICAgICAgICJhcmlhLWxhYmVsIjogYXJpYUxhYmVsKGZpZWxkKSwKICAgICAgICAiYXJpYS1yZXF1aXJlZCI6IGZhbHNlCiAgICAgIH0KICAgIH07CgogICAgaWYgKGdyb3VwSWQpIHsKICAgICAgaW5wdXQuYXR0cmlidXRlcy5uYW1lID0gZ3JvdXBJZDsKICAgIH0KCiAgICBpZiAoaXNSZXF1aXJlZChmaWVsZCkpIHsKICAgICAgaW5wdXQuYXR0cmlidXRlc1siYXJpYS1yZXF1aXJlZCJdID0gdHJ1ZTsKICAgICAgaW5wdXQuYXR0cmlidXRlcy5yZXF1aXJlZCA9IHRydWU7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAibGFiZWwiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFsieGZhTGFiZWwiXQogICAgICB9LAogICAgICBjaGlsZHJlbjogW2lucHV0XQogICAgfSk7CiAgfQoKfQoKY2xhc3MgQ2hvaWNlTGlzdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJjaG9pY2VMaXN0IiwgdHJ1ZSk7CiAgICB0aGlzLmNvbW1pdE9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuY29tbWl0T24sIFsic2VsZWN0IiwgImV4aXQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMub3BlbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm9wZW4sIFsidXNlckNvbnRyb2wiLCAiYWx3YXlzIiwgIm11bHRpU2VsZWN0IiwgIm9uRW50cnkiXSk7CiAgICB0aGlzLnRleHRFbnRyeSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnRleHRFbnRyeSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJib3JkZXIiLCAibWFyZ2luIik7CgogICAgY29uc3QgdWkgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgY29uc3QgZmllbGQgPSB1aVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGZvbnRTaXplID0gZmllbGQuZm9udCAmJiBmaWVsZC5mb250LnNpemUgfHwgMTA7CiAgICBjb25zdCBvcHRpb25TdHlsZSA9IHsKICAgICAgZm9udFNpemU6IGBjYWxjKCR7Zm9udFNpemV9cHggKiB2YXIoLS1zY2FsZS1mYWN0b3IpKWAKICAgIH07CiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwoKICAgIGlmIChmaWVsZC5pdGVtcy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IGl0ZW1zID0gZmllbGQuaXRlbXM7CiAgICAgIGxldCBkaXNwbGF5ZWRJbmRleCA9IDA7CiAgICAgIGxldCBzYXZlSW5kZXggPSAwOwoKICAgICAgaWYgKGl0ZW1zLmNoaWxkcmVuLmxlbmd0aCA9PT0gMikgewogICAgICAgIGRpc3BsYXllZEluZGV4ID0gaXRlbXMuY2hpbGRyZW5bMF0uc2F2ZTsKICAgICAgICBzYXZlSW5kZXggPSAxIC0gZGlzcGxheWVkSW5kZXg7CiAgICAgIH0KCiAgICAgIGNvbnN0IGRpc3BsYXllZCA9IGl0ZW1zLmNoaWxkcmVuW2Rpc3BsYXllZEluZGV4XVtfeGZhX29iamVjdC4kdG9IVE1MXSgpLmh0bWw7CgogICAgICBjb25zdCB2YWx1ZXMgPSBpdGVtcy5jaGlsZHJlbltzYXZlSW5kZXhdW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbDsKCiAgICAgIGxldCBzZWxlY3RlZCA9IGZhbHNlOwogICAgICBjb25zdCB2YWx1ZSA9IGZpZWxkLnZhbHVlICYmIGZpZWxkLnZhbHVlW194ZmFfb2JqZWN0LiR0ZXh0XSgpIHx8ICIiOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGlzcGxheWVkLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgICBuYW1lOiAib3B0aW9uIiwKICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgdmFsdWU6IHZhbHVlc1tpXSB8fCBkaXNwbGF5ZWRbaV0sCiAgICAgICAgICAgIHN0eWxlOiBvcHRpb25TdHlsZQogICAgICAgICAgfSwKICAgICAgICAgIHZhbHVlOiBkaXNwbGF5ZWRbaV0KICAgICAgICB9OwoKICAgICAgICBpZiAodmFsdWVzW2ldID09PSB2YWx1ZSkgewogICAgICAgICAgb3B0aW9uLmF0dHJpYnV0ZXMuc2VsZWN0ZWQgPSBzZWxlY3RlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBjaGlsZHJlbi5wdXNoKG9wdGlvbik7CiAgICAgIH0KCiAgICAgIGlmICghc2VsZWN0ZWQpIHsKICAgICAgICBjaGlsZHJlbi5zcGxpY2UoMCwgMCwgewogICAgICAgICAgbmFtZTogIm9wdGlvbiIsCiAgICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICAgIGhpZGRlbjogdHJ1ZSwKICAgICAgICAgICAgc2VsZWN0ZWQ6IHRydWUKICAgICAgICAgIH0sCiAgICAgICAgICB2YWx1ZTogIiAiCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzZWxlY3RBdHRyaWJ1dGVzID0gewogICAgICBjbGFzczogWyJ4ZmFTZWxlY3QiXSwKICAgICAgZmllbGRJZDogZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgIGRhdGFJZDogZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdICYmIGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXVtfeGZhX29iamVjdC4kdWlkXSB8fCBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgc3R5bGUsCiAgICAgICJhcmlhLWxhYmVsIjogYXJpYUxhYmVsKGZpZWxkKSwKICAgICAgImFyaWEtcmVxdWlyZWQiOiBmYWxzZQogICAgfTsKCiAgICBpZiAoaXNSZXF1aXJlZChmaWVsZCkpIHsKICAgICAgc2VsZWN0QXR0cmlidXRlc1siYXJpYS1yZXF1aXJlZCJdID0gdHJ1ZTsKICAgICAgc2VsZWN0QXR0cmlidXRlcy5yZXF1aXJlZCA9IHRydWU7CiAgICB9CgogICAgaWYgKHRoaXMub3BlbiA9PT0gIm11bHRpU2VsZWN0IikgewogICAgICBzZWxlY3RBdHRyaWJ1dGVzLm11bHRpcGxlID0gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJsYWJlbCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFMYWJlbCJdCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbewogICAgICAgIG5hbWU6ICJzZWxlY3QiLAogICAgICAgIGNoaWxkcmVuLAogICAgICAgIGF0dHJpYnV0ZXM6IHNlbGVjdEF0dHJpYnV0ZXMKICAgICAgfV0KICAgIH0pOwogIH0KCn0KCmNsYXNzIENvbG9yIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNvbG9yIiwgdHJ1ZSk7CiAgICB0aGlzLmNTcGFjZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmNTcGFjZSwgWyJTUkdCIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy52YWx1ZSA9IGF0dHJpYnV0ZXMudmFsdWUgPyAoMCwgX3V0aWxzLmdldENvbG9yKShhdHRyaWJ1dGVzLnZhbHVlKSA6ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRoYXNTZXR0YWJsZVZhbHVlXSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSB7CiAgICByZXR1cm4gdGhpcy52YWx1ZSA/IF91dGlsLlV0aWwubWFrZUhleENvbG9yKHRoaXMudmFsdWUuciwgdGhpcy52YWx1ZS5nLCB0aGlzLnZhbHVlLmIpIDogbnVsbDsKICB9Cgp9CgpjbGFzcyBDb21iIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNvbWIiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5udW1iZXJPZkNlbGxzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubnVtYmVyT2ZDZWxscywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBDb25uZWN0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNvbm5lY3QiLCB0cnVlKTsKICAgIHRoaXMuY29ubmVjdGlvbiA9IGF0dHJpYnV0ZXMuY29ubmVjdGlvbiB8fCAiIjsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMudXNhZ2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy51c2FnZSwgWyJleHBvcnRBbmRJbXBvcnQiLCAiZXhwb3J0T25seSIsICJpbXBvcnRPbmx5Il0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMucGljdHVyZSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ29udGVudEFyZWEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiY29udGVudEFyZWEiLCB0cnVlKTsKICAgIHRoaXMuaCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuaCk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLncgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLncpOwogICAgdGhpcy54ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy54LCAiMHB0Iik7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnksICIwcHQiKTsKICAgIHRoaXMuZGVzYyA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IGxlZnQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLngpOwogICAgY29uc3QgdG9wID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy55KTsKICAgIGNvbnN0IHN0eWxlID0gewogICAgICBsZWZ0LAogICAgICB0b3AsCiAgICAgIHdpZHRoOiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLncpLAogICAgICBoZWlnaHQ6ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuaCkKICAgIH07CiAgICBjb25zdCBjbGFzc05hbWVzID0gWyJ4ZmFDb250ZW50YXJlYSJdOwoKICAgIGlmICgoMCwgX2h0bWxfdXRpbHMuaXNQcmludE9ubHkpKHRoaXMpKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhUHJpbnRPbmx5Iik7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgY2hpbGRyZW46IFtdLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgc3R5bGUsCiAgICAgICAgY2xhc3M6IGNsYXNzTmFtZXMsCiAgICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0KICAgICAgfQogICAgfSk7CiAgfQoKfQoKY2xhc3MgQ29ybmVyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImNvcm5lciIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmludmVydGVkID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuaW52ZXJ0ZWQsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLmpvaW4gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5qb2luLCBbInNxdWFyZSIsICJyb3VuZCJdKTsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJhZGl1cyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMucmFkaXVzKTsKICAgIHRoaXMuc3Ryb2tlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuc3Ryb2tlLCBbInNvbGlkIiwgImRhc2hEb3QiLCAiZGFzaERvdERvdCIsICJkYXNoZWQiLCAiZG90dGVkIiwgImVtYm9zc2VkIiwgImV0Y2hlZCIsICJsb3dlcmVkIiwgInJhaXNlZCJdKTsKICAgIHRoaXMudGhpY2tuZXNzID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy50aGlja25lc3MsICIwLjVwdCIpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY29sb3IgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJ2aXNpYmlsaXR5Iik7CiAgICBzdHlsZS5yYWRpdXMgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLmpvaW4gPT09ICJzcXVhcmUiID8gMCA6IHRoaXMucmFkaXVzKTsKICAgIHJldHVybiBzdHlsZTsKICB9Cgp9CgpjbGFzcyBEYXRlRWxlbWVudCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGF0ZSIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBjb25zdCBkYXRlID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gZGF0ZSA/IG5ldyBEYXRlKGRhdGUpIDogbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIHZhbHVlVG9IdG1sKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udG9TdHJpbmcoKSA6ICIiKTsKICB9Cgp9CgpjbGFzcyBEYXRlVGltZSBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGF0ZVRpbWUiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgZGF0ZSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGRhdGUgPyBuZXcgRGF0ZShkYXRlKSA6IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHJldHVybiB2YWx1ZVRvSHRtbCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA/IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRvU3RyaW5nKCkgOiAiIik7CiAgfQoKfQoKY2xhc3MgRGF0ZVRpbWVFZGl0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImRhdGVUaW1lRWRpdCIsIHRydWUpOwogICAgdGhpcy5oU2Nyb2xsUG9saWN5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaFNjcm9sbFBvbGljeSwgWyJhdXRvIiwgIm9mZiIsICJvbiJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5waWNrZXIgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5waWNrZXIsIFsiaG9zdCIsICJub25lIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuY29tYiA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJib3JkZXIiLCAiZm9udCIsICJtYXJnaW4iKTsKCiAgICBjb25zdCBmaWVsZCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGh0bWwgPSB7CiAgICAgIG5hbWU6ICJpbnB1dCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgICAgZmllbGRJZDogZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgZGF0YUlkOiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgIGNsYXNzOiBbInhmYVRleHRmaWVsZCJdLAogICAgICAgIHN0eWxlLAogICAgICAgICJhcmlhLWxhYmVsIjogYXJpYUxhYmVsKGZpZWxkKSwKICAgICAgICAiYXJpYS1yZXF1aXJlZCI6IGZhbHNlCiAgICAgIH0KICAgIH07CgogICAgaWYgKGlzUmVxdWlyZWQoZmllbGQpKSB7CiAgICAgIGh0bWwuYXR0cmlidXRlc1siYXJpYS1yZXF1aXJlZCJdID0gdHJ1ZTsKICAgICAgaHRtbC5hdHRyaWJ1dGVzLnJlcXVpcmVkID0gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJsYWJlbCIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFMYWJlbCJdCiAgICAgIH0sCiAgICAgIGNoaWxkcmVuOiBbaHRtbF0KICAgIH0pOwogIH0KCn0KCmNsYXNzIERlY2ltYWwgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImRlY2ltYWwiKTsKICAgIHRoaXMuZnJhY0RpZ2l0cyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmZyYWNEaWdpdHMsCiAgICAgIGRlZmF1bHRWYWx1ZTogMiwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGVhZERpZ2l0cyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmxlYWREaWdpdHMsCiAgICAgIGRlZmF1bHRWYWx1ZTogLTEsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHRydWUKICAgIH0pOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgbnVtYmVyID0gcGFyc2VGbG9hdCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCkpOwogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBpc05hTihudW1iZXIpID8gbnVsbCA6IG51bWJlcjsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIHZhbHVlVG9IdG1sKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdICE9PSBudWxsID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udG9TdHJpbmcoKSA6ICIiKTsKICB9Cgp9CgpjbGFzcyBEZWZhdWx0VWkgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGVmYXVsdFVpIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRGVzYyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkZXNjIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvb2xlYW4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlVGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWNpbWFsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4RGF0YSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mbG9hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbnRlZ2VyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRleHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIERpZ2VzdE1ldGhvZCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkaWdlc3RNZXRob2QiLCBbIiIsICJTSEExIiwgIlNIQTI1NiIsICJTSEE1MTIiLCAiUklQRU1EMTYwIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIERpZ2VzdE1ldGhvZHMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZGlnZXN0TWV0aG9kcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZGlnZXN0TWV0aG9kID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRHJhdyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJkcmF3IiwgdHJ1ZSk7CiAgICB0aGlzLmFuY2hvclR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hbmNob3JUeXBlLCBbInRvcExlZnQiLCAiYm90dG9tQ2VudGVyIiwgImJvdHRvbUxlZnQiLCAiYm90dG9tUmlnaHQiLCAibWlkZGxlQ2VudGVyIiwgIm1pZGRsZUxlZnQiLCAibWlkZGxlUmlnaHQiLCAidG9wQ2VudGVyIiwgInRvcFJpZ2h0Il0pOwogICAgdGhpcy5jb2xTcGFuID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuY29sU3BhbiwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgfHwgbiA9PT0gLTEKICAgIH0pOwogICAgdGhpcy5oID0gYXR0cmlidXRlcy5oID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5oKSA6ICIiOwogICAgdGhpcy5oQWxpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oQWxpZ24sIFsibGVmdCIsICJjZW50ZXIiLCAianVzdGlmeSIsICJqdXN0aWZ5QWxsIiwgInJhZGl4IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxvY2FsZSA9IGF0dHJpYnV0ZXMubG9jYWxlIHx8ICIiOwogICAgdGhpcy5tYXhIID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXhILCAiMHB0Iik7CiAgICB0aGlzLm1heFcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heFcsICIwcHQiKTsKICAgIHRoaXMubWluSCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWluSCwgIjBwdCIpOwogICAgdGhpcy5taW5XID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5XLCAiMHB0Iik7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy5yb3RhdGUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5yb3RhdGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCAlIDkwID09PSAwCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLncgPSBhdHRyaWJ1dGVzLncgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLncpIDogIiI7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLngsICIwcHQiKTsKICAgIHRoaXMueSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueSwgIjBwdCIpOwogICAgdGhpcy5hc3Npc3QgPSBudWxsOwogICAgdGhpcy5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5jYXB0aW9uID0gbnVsbDsKICAgIHRoaXMuZGVzYyA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZvbnQgPSBudWxsOwogICAgdGhpcy5rZWVwID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICAgIHRoaXMucGFyYSA9IG51bGw7CiAgICB0aGlzLnRyYXZlcnNhbCA9IG51bGw7CiAgICB0aGlzLnVpID0gbnVsbDsKICAgIHRoaXMudmFsdWUgPSBudWxsOwogICAgdGhpcy5zZXRQcm9wZXJ0eSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0odmFsdWUpIHsKICAgIF9zZXRWYWx1ZSh0aGlzLCB2YWx1ZSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIHNldFRhYkluZGV4KHRoaXMpOwoKICAgIGlmICh0aGlzLnByZXNlbmNlID09PSAiaGlkZGVuIiB8fCB0aGlzLnByZXNlbmNlID09PSAiaW5hY3RpdmUiKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICAoMCwgX2h0bWxfdXRpbHMuZml4RGltZW5zaW9ucykodGhpcyk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kcHVzaFBhcmFdKCk7CgogICAgY29uc3Qgc2F2ZWRXID0gdGhpcy53OwogICAgY29uc3Qgc2F2ZWRIID0gdGhpcy5oOwogICAgY29uc3QgewogICAgICB3LAogICAgICBoLAogICAgICBpc0Jyb2tlbgogICAgfSA9ICgwLCBfaHRtbF91dGlscy5sYXlvdXROb2RlKSh0aGlzLCBhdmFpbGFibGVTcGFjZSk7CgogICAgaWYgKHcgJiYgdGhpcy53ID09PSAiIikgewogICAgICBpZiAoaXNCcm9rZW4gJiYgdGhpc1tfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKVtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgICB9CgogICAgICB0aGlzLncgPSB3OwogICAgfQoKICAgIGlmIChoICYmIHRoaXMuaCA9PT0gIiIpIHsKICAgICAgdGhpcy5oID0gaDsKICAgIH0KCiAgICBzZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKCiAgICBpZiAoISgwLCBfbGF5b3V0LmNoZWNrRGltZW5zaW9ucykodGhpcywgYXZhaWxhYmxlU3BhY2UpKSB7CiAgICAgIHRoaXMudyA9IHNhdmVkVzsKICAgICAgdGhpcy5oID0gc2F2ZWRIOwoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgfQoKICAgIHVuc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiZm9udCIsICJoQWxpZ24iLCAiZGltZW5zaW9ucyIsICJwb3NpdGlvbiIsICJwcmVzZW5jZSIsICJyb3RhdGUiLCAiYW5jaG9yVHlwZSIsICJib3JkZXIiLCAibWFyZ2luIik7CiAgICAoMCwgX2h0bWxfdXRpbHMuc2V0TWluTWF4RGltZW5zaW9ucykodGhpcywgc3R5bGUpOwoKICAgIGlmIChzdHlsZS5tYXJnaW4pIHsKICAgICAgc3R5bGUucGFkZGluZyA9IHN0eWxlLm1hcmdpbjsKICAgICAgZGVsZXRlIHN0eWxlLm1hcmdpbjsKICAgIH0KCiAgICBjb25zdCBjbGFzc05hbWVzID0gWyJ4ZmFEcmF3Il07CgogICAgaWYgKHRoaXMuZm9udCkgewogICAgICBjbGFzc05hbWVzLnB1c2goInhmYUZvbnQiKTsKICAgIH0KCiAgICBpZiAoKDAsIF9odG1sX3V0aWxzLmlzUHJpbnRPbmx5KSh0aGlzKSkgewogICAgICBjbGFzc05hbWVzLnB1c2goInhmYVByaW50T25seSIpOwogICAgfQoKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7CiAgICAgIHN0eWxlLAogICAgICBpZDogdGhpc1tfeGZhX29iamVjdC4kdWlkXSwKICAgICAgY2xhc3M6IGNsYXNzTmFtZXMKICAgIH07CgogICAgaWYgKHRoaXMubmFtZSkgewogICAgICBhdHRyaWJ1dGVzLnhmYU5hbWUgPSB0aGlzLm5hbWU7CiAgICB9CgogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGNoaWxkcmVuOiBbXQogICAgfTsKICAgIGFwcGx5QXNzaXN0KHRoaXMsIGF0dHJpYnV0ZXMpOwogICAgY29uc3QgYmJveCA9ICgwLCBfaHRtbF91dGlscy5jb21wdXRlQmJveCkodGhpcywgaHRtbCwgYXZhaWxhYmxlU3BhY2UpOwogICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlID8gdGhpcy52YWx1ZVtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkuaHRtbCA6IG51bGw7CgogICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgIHRoaXMudyA9IHNhdmVkVzsKICAgICAgdGhpcy5oID0gc2F2ZWRIOwoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKCgwLCBfaHRtbF91dGlscy5jcmVhdGVXcmFwcGVyKSh0aGlzLCBodG1sKSwgYmJveCk7CiAgICB9CgogICAgaHRtbC5jaGlsZHJlbi5wdXNoKHZhbHVlKTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRQYXJhKSh0aGlzLCBzdHlsZSwgdmFsdWUpOwogICAgdGhpcy53ID0gc2F2ZWRXOwogICAgdGhpcy5oID0gc2F2ZWRIOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKICB9Cgp9CgpjbGFzcyBFZGdlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVkZ2UiLCB0cnVlKTsKICAgIHRoaXMuY2FwID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuY2FwLCBbInNxdWFyZSIsICJidXR0IiwgInJvdW5kIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5zdHJva2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zdHJva2UsIFsic29saWQiLCAiZGFzaERvdCIsICJkYXNoRG90RG90IiwgImRhc2hlZCIsICJkb3R0ZWQiLCAiZW1ib3NzZWQiLCAiZXRjaGVkIiwgImxvd2VyZWQiLCAicmFpc2VkIl0pOwogICAgdGhpcy50aGlja25lc3MgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnRoaWNrbmVzcywgIjAuNXB0Iik7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb2xvciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgewogICAgY29uc3Qgc3R5bGUgPSAoMCwgX2h0bWxfdXRpbHMudG9TdHlsZSkodGhpcywgInZpc2liaWxpdHkiKTsKICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHsKICAgICAgbGluZWNhcDogdGhpcy5jYXAsCiAgICAgIHdpZHRoOiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLnRoaWNrbmVzcyksCiAgICAgIGNvbG9yOiB0aGlzLmNvbG9yID8gdGhpcy5jb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjMDAwMDAwIiwKICAgICAgc3R5bGU6ICIiCiAgICB9KTsKCiAgICBpZiAodGhpcy5wcmVzZW5jZSAhPT0gInZpc2libGUiKSB7CiAgICAgIHN0eWxlLnN0eWxlID0gIm5vbmUiOwogICAgfSBlbHNlIHsKICAgICAgc3dpdGNoICh0aGlzLnN0cm9rZSkgewogICAgICAgIGNhc2UgInNvbGlkIjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gInNvbGlkIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJkYXNoRG90IjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gImRhc2hlZCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZGFzaERvdERvdCI6CiAgICAgICAgICBzdHlsZS5zdHlsZSA9ICJkYXNoZWQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImRhc2hlZCI6CiAgICAgICAgICBzdHlsZS5zdHlsZSA9ICJkYXNoZWQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImRvdHRlZCI6CiAgICAgICAgICBzdHlsZS5zdHlsZSA9ICJkb3R0ZWQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImVtYm9zc2VkIjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gInJpZGdlIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJldGNoZWQiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAiZ3Jvb3ZlIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJsb3dlcmVkIjoKICAgICAgICAgIHN0eWxlLnN0eWxlID0gImluc2V0IjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJyYWlzZWQiOgogICAgICAgICAgc3R5bGUuc3R5bGUgPSAib3V0c2V0IjsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHN0eWxlOwogIH0KCn0KCmNsYXNzIEVuY29kaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVuY29kaW5nIiwgWyJhZGJlLng1MDkucnNhX3NoYTEiLCAiYWRiZS5wa2NzNy5kZXRhY2hlZCIsICJhZGJlLnBrY3M3LnNoYTEiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgRW5jb2RpbmdzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVuY29kaW5ncyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZW5jb2RpbmcgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBFbmNyeXB0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVuY3J5cHQiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY2VydGlmaWNhdGUgPSBudWxsOwogIH0KCn0KCmNsYXNzIEVuY3J5cHREYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImVuY3J5cHREYXRhIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMub3BlcmF0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMub3BlcmF0aW9uLCBbImVuY3J5cHQiLCAiZGVjcnlwdCJdKTsKICAgIHRoaXMudGFyZ2V0ID0gYXR0cmlidXRlcy50YXJnZXQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5maWx0ZXIgPSBudWxsOwogICAgdGhpcy5tYW5pZmVzdCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJlbmNyeXB0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jZXJ0aWZpY2F0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEVuY3J5cHRpb25NZXRob2QgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jcnlwdGlvbk1ldGhvZCIsIFsiIiwgIkFFUzI1Ni1DQkMiLCAiVFJJUExFREVTLUNCQyIsICJBRVMxMjgtQ0JDIiwgIkFFUzE5Mi1DQkMiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdGlvbk1ldGhvZHMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZW5jcnlwdGlvbk1ldGhvZHMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmVuY3J5cHRpb25NZXRob2QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBFdmVudCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJldmVudCIsIHRydWUpOwogICAgdGhpcy5hY3Rpdml0eSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFjdGl2aXR5LCBbImNsaWNrIiwgImNoYW5nZSIsICJkb2NDbG9zZSIsICJkb2NSZWFkeSIsICJlbnRlciIsICJleGl0IiwgImZ1bGwiLCAiaW5kZXhDaGFuZ2UiLCAiaW5pdGlhbGl6ZSIsICJtb3VzZURvd24iLCAibW91c2VFbnRlciIsICJtb3VzZUV4aXQiLCAibW91c2VVcCIsICJwb3N0RXhlY3V0ZSIsICJwb3N0T3BlbiIsICJwb3N0UHJpbnQiLCAicG9zdFNhdmUiLCAicG9zdFNpZ24iLCAicG9zdFN1Ym1pdCIsICJwcmVFeGVjdXRlIiwgInByZU9wZW4iLCAicHJlUHJpbnQiLCAicHJlU2F2ZSIsICJwcmVTaWduIiwgInByZVN1Ym1pdCIsICJyZWFkeSIsICJ2YWxpZGF0aW9uU3RhdGUiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGlzdGVuID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubGlzdGVuLCBbInJlZk9ubHkiLCAicmVmQW5kRGVzY2VuZGVudHMiXSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJlZiA9IGF0dHJpYnV0ZXMucmVmIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMuZW5jcnlwdERhdGEgPSBudWxsOwogICAgdGhpcy5leGVjdXRlID0gbnVsbDsKICAgIHRoaXMuc2NyaXB0ID0gbnVsbDsKICAgIHRoaXMuc2lnbkRhdGEgPSBudWxsOwogICAgdGhpcy5zdWJtaXQgPSBudWxsOwogIH0KCn0KCmNsYXNzIEV4RGF0YSBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZXhEYXRhIik7CiAgICB0aGlzLmNvbnRlbnRUeXBlID0gYXR0cmlidXRlcy5jb250ZW50VHlwZSB8fCAiIjsKICAgIHRoaXMuaHJlZiA9IGF0dHJpYnV0ZXMuaHJlZiB8fCAiIjsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5tYXhMZW5ndGggPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5tYXhMZW5ndGgsCiAgICAgIGRlZmF1bHRWYWx1ZTogLTEsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gLTEKICAgIH0pOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5yaWQgPSBhdHRyaWJ1dGVzLnJpZCB8fCAiIjsKICAgIHRoaXMudHJhbnNmZXJFbmNvZGluZyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnRyYW5zZmVyRW5jb2RpbmcsIFsibm9uZSIsICJiYXNlNjQiLCAicGFja2FnZSJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzQ0RBVEFYbWxdKCkgewogICAgcmV0dXJuIHRoaXMuY29udGVudFR5cGUgPT09ICJ0ZXh0L2h0bWwiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvbkNoaWxkXShjaGlsZCkgewogICAgaWYgKHRoaXMuY29udGVudFR5cGUgPT09ICJ0ZXh0L2h0bWwiICYmIGNoaWxkW194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF0gPT09IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy54aHRtbC5pZCkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGNoaWxkOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAodGhpcy5jb250ZW50VHlwZSA9PT0gInRleHQveG1sIikgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGNoaWxkOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGlmICh0aGlzLmNvbnRlbnRUeXBlICE9PSAidGV4dC9odG1sIiB8fCAhdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XVtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSk7CiAgfQoKfQoKY2xhc3MgRXhPYmplY3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZXhPYmplY3QiLCB0cnVlKTsKICAgIHRoaXMuYXJjaGl2ZSA9IGF0dHJpYnV0ZXMuYXJjaGl2ZSB8fCAiIjsKICAgIHRoaXMuY2xhc3NJZCA9IGF0dHJpYnV0ZXMuY2xhc3NJZCB8fCAiIjsKICAgIHRoaXMuY29kZUJhc2UgPSBhdHRyaWJ1dGVzLmNvZGVCYXNlIHx8ICIiOwogICAgdGhpcy5jb2RlVHlwZSA9IGF0dHJpYnV0ZXMuY29kZVR5cGUgfHwgIiI7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmJvb2xlYW4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlVGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWNpbWFsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4RGF0YSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leE9iamVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mbG9hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbnRlZ2VyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRleHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEV4Y2xHcm91cCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJleGNsR3JvdXAiLCB0cnVlKTsKICAgIHRoaXMuYWNjZXNzID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYWNjZXNzLCBbIm9wZW4iLCAibm9uSW50ZXJhY3RpdmUiLCAicHJvdGVjdGVkIiwgInJlYWRPbmx5Il0pOwogICAgdGhpcy5hY2Nlc3NLZXkgPSBhdHRyaWJ1dGVzLmFjY2Vzc0tleSB8fCAiIjsKICAgIHRoaXMuYW5jaG9yVHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFuY2hvclR5cGUsIFsidG9wTGVmdCIsICJib3R0b21DZW50ZXIiLCAiYm90dG9tTGVmdCIsICJib3R0b21SaWdodCIsICJtaWRkbGVDZW50ZXIiLCAibWlkZGxlTGVmdCIsICJtaWRkbGVSaWdodCIsICJ0b3BDZW50ZXIiLCAidG9wUmlnaHQiXSk7CiAgICB0aGlzLmNvbFNwYW4gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5jb2xTcGFuLAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiBuID0+IG4gPj0gMSB8fCBuID09PSAtMQogICAgfSk7CiAgICB0aGlzLmggPSBhdHRyaWJ1dGVzLmggPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmgpIDogIiI7CiAgICB0aGlzLmhBbGlnbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhBbGlnbiwgWyJsZWZ0IiwgImNlbnRlciIsICJqdXN0aWZ5IiwgImp1c3RpZnlBbGwiLCAicmFkaXgiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGF5b3V0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubGF5b3V0LCBbInBvc2l0aW9uIiwgImxyLXRiIiwgInJsLXJvdyIsICJybC10YiIsICJyb3ciLCAidGFibGUiLCAidGIiXSk7CiAgICB0aGlzLm1heEggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heEgsICIwcHQiKTsKICAgIHRoaXMubWF4VyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4VywgIjBwdCIpOwogICAgdGhpcy5taW5IID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5ILCAiMHB0Iik7CiAgICB0aGlzLm1pblcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1pblcsICIwcHQiKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucHJlc2VuY2UgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmVzZW5jZSwgWyJ2aXNpYmxlIiwgImhpZGRlbiIsICJpbmFjdGl2ZSIsICJpbnZpc2libGUiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy53ID0gYXR0cmlidXRlcy53ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy53KSA6ICIiOwogICAgdGhpcy54ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy54LCAiMHB0Iik7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnksICIwcHQiKTsKICAgIHRoaXMuYXNzaXN0ID0gbnVsbDsKICAgIHRoaXMuYmluZCA9IG51bGw7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmNhbGN1bGF0ZSA9IG51bGw7CiAgICB0aGlzLmNhcHRpb24gPSBudWxsOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICAgIHRoaXMucGFyYSA9IG51bGw7CiAgICB0aGlzLnRyYXZlcnNhbCA9IG51bGw7CiAgICB0aGlzLnZhbGlkYXRlID0gbnVsbDsKICAgIHRoaXMuY29ubmVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5ldmVudCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWVsZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zZXRQcm9wZXJ0eSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc0JpbmRhYmxlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRoYXNTZXR0YWJsZVZhbHVlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRzZXRWYWx1ZV0odmFsdWUpIHsKICAgIGZvciAoY29uc3QgZmllbGQgb2YgdGhpcy5maWVsZC5jaGlsZHJlbikgewogICAgICBpZiAoIWZpZWxkLnZhbHVlKSB7CiAgICAgICAgY29uc3Qgbm9kZVZhbHVlID0gbmV3IFZhbHVlKHt9KTsKCiAgICAgICAgZmllbGRbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXShub2RlVmFsdWUpOwoKICAgICAgICBmaWVsZC52YWx1ZSA9IG5vZGVWYWx1ZTsKICAgICAgfQoKICAgICAgZmllbGQudmFsdWVbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSk7CiAgICB9CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzVGhlcmVNb3JlV2lkdGhdKCkgewogICAgcmV0dXJuIHRoaXMubGF5b3V0LmVuZHNXaXRoKCItdGIiKSAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gMCAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID4gMCB8fCB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJGlzVGhlcmVNb3JlV2lkdGhdKCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzU3BsaXR0YWJsZV0oKSB7CiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICAgIGlmICghcGFyZW50W194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uX2lzU3BsaXR0YWJsZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uX2lzU3BsaXR0YWJsZTsKICAgIH0KCiAgICBpZiAodGhpcy5sYXlvdXQgPT09ICJwb3NpdGlvbiIgfHwgdGhpcy5sYXlvdXQuaW5jbHVkZXMoInJvdyIpKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlID0gZmFsc2U7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAocGFyZW50LmxheW91dCAmJiBwYXJlbnQubGF5b3V0LmVuZHNXaXRoKCItdGIiKSAmJiBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgIT09IDApIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlID0gdHJ1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmbHVzaEhUTUxdKCkgewogICAgcmV0dXJuICgwLCBfbGF5b3V0LmZsdXNoSFRNTCkodGhpcyk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGFkZEhUTUxdKGh0bWwsIGJib3gpIHsKICAgICgwLCBfbGF5b3V0LmFkZEhUTUwpKHRoaXMsIGh0bWwsIGJib3gpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRBdmFpbGFibGVTcGFjZV0oKSB7CiAgICByZXR1cm4gKDAsIF9sYXlvdXQuZ2V0QXZhaWxhYmxlU3BhY2UpKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBzZXRUYWJJbmRleCh0aGlzKTsKCiAgICBpZiAodGhpcy5wcmVzZW5jZSA9PT0gImhpZGRlbiIgfHwgdGhpcy5wcmVzZW5jZSA9PT0gImluYWN0aXZlIiB8fCB0aGlzLmggPT09IDAgfHwgdGhpcy53ID09PSAwKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICAoMCwgX2h0bWxfdXRpbHMuZml4RGltZW5zaW9ucykodGhpcyk7CiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwogICAgY29uc3QgYXR0cmlidXRlcyA9IHsKICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgIGNsYXNzOiBbXQogICAgfTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRBY2Nlc3MpKHRoaXMsIGF0dHJpYnV0ZXMuY2xhc3MpOwoKICAgIGlmICghdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogICAgT2JqZWN0LmFzc2lnbih0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0sIHsKICAgICAgY2hpbGRyZW4sCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGF0dGVtcHQ6IDAsCiAgICAgIGxpbmU6IG51bGwsCiAgICAgIG51bWJlckluTGluZTogMCwKICAgICAgYXZhaWxhYmxlU3BhY2U6IHsKICAgICAgICB3aWR0aDogTWF0aC5taW4odGhpcy53IHx8IEluZmluaXR5LCBhdmFpbGFibGVTcGFjZS53aWR0aCksCiAgICAgICAgaGVpZ2h0OiBNYXRoLm1pbih0aGlzLmggfHwgSW5maW5pdHksIGF2YWlsYWJsZVNwYWNlLmhlaWdodCkKICAgICAgfSwKICAgICAgd2lkdGg6IDAsCiAgICAgIGhlaWdodDogMCwKICAgICAgcHJldkhlaWdodDogMCwKICAgICAgY3VycmVudFdpZHRoOiAwCiAgICB9KTsKCiAgICBjb25zdCBpc1NwbGl0dGFibGUgPSB0aGlzW194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCk7CgogICAgaWYgKCFpc1NwbGl0dGFibGUpIHsKICAgICAgc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICB9CgogICAgaWYgKCEoMCwgX2xheW91dC5jaGVja0RpbWVuc2lvbnMpKHRoaXMsIGF2YWlsYWJsZVNwYWNlKSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgIH0KCiAgICBjb25zdCBmaWx0ZXIgPSBuZXcgU2V0KFsiZmllbGQiXSk7CgogICAgaWYgKHRoaXMubGF5b3V0LmluY2x1ZGVzKCJyb3ciKSkgewogICAgICBjb25zdCBjb2x1bW5XaWR0aHMgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpLmNvbHVtbldpZHRoczsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbHVtbldpZHRocykgJiYgY29sdW1uV2lkdGhzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY29sdW1uV2lkdGhzID0gY29sdW1uV2lkdGhzOwogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50Q29sdW1uID0gMDsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJhbmNob3JUeXBlIiwgImRpbWVuc2lvbnMiLCAicG9zaXRpb24iLCAicHJlc2VuY2UiLCAiYm9yZGVyIiwgIm1hcmdpbiIsICJoQWxpZ24iKTsKICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbInhmYUV4Y2xncm91cCJdOwogICAgY29uc3QgY2wgPSAoMCwgX2h0bWxfdXRpbHMubGF5b3V0Q2xhc3MpKHRoaXMpOwoKICAgIGlmIChjbCkgewogICAgICBjbGFzc05hbWVzLnB1c2goY2wpOwogICAgfQoKICAgIGlmICgoMCwgX2h0bWxfdXRpbHMuaXNQcmludE9ubHkpKHRoaXMpKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhUHJpbnRPbmx5Iik7CiAgICB9CgogICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlOwogICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzTmFtZXM7CgogICAgaWYgKHRoaXMubmFtZSkgewogICAgICBhdHRyaWJ1dGVzLnhmYU5hbWUgPSB0aGlzLm5hbWU7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcHVzaFBhcmFdKCk7CgogICAgY29uc3QgaXNMclRiID0gdGhpcy5sYXlvdXQgPT09ICJsci10YiIgfHwgdGhpcy5sYXlvdXQgPT09ICJybC10YiI7CiAgICBjb25zdCBtYXhSdW4gPSBpc0xyVGIgPyBNQVhfQVRURU1QVFNfRk9SX0xSVEJfTEFZT1VUIDogMTsKCiAgICBmb3IgKDsgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPCBtYXhSdW47IHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0KyspIHsKICAgICAgaWYgKGlzTHJUYiAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gTUFYX0FUVEVNUFRTX0ZPUl9MUlRCX0xBWU9VVCAtIDEpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID0gMDsKICAgICAgfQoKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHsKICAgICAgICBmaWx0ZXIsCiAgICAgICAgaW5jbHVkZTogdHJ1ZQogICAgICB9KTsKCiAgICAgIGlmIChyZXN1bHQuc3VjY2VzcykgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAocmVzdWx0LmlzQnJlYWsoKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KCiAgICAgIGlmIChpc0xyVGIgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IDAgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSA9PT0gMCAmJiAhdGhpc1tfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPSBtYXhSdW47CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRwb3BQYXJhXSgpOwoKICAgIGlmICghaXNTcGxpdHRhYmxlKSB7CiAgICAgIHVuc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICB9CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID09PSBtYXhSdW4pIHsKICAgICAgaWYgKCFpc1NwbGl0dGFibGUpIHsKICAgICAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgICB9CgogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRkFJTFVSRTsKICAgIH0KCiAgICBsZXQgbWFyZ2luSCA9IDA7CiAgICBsZXQgbWFyZ2luViA9IDA7CgogICAgaWYgKHRoaXMubWFyZ2luKSB7CiAgICAgIG1hcmdpbkggPSB0aGlzLm1hcmdpbi5sZWZ0SW5zZXQgKyB0aGlzLm1hcmdpbi5yaWdodEluc2V0OwogICAgICBtYXJnaW5WID0gdGhpcy5tYXJnaW4udG9wSW5zZXQgKyB0aGlzLm1hcmdpbi5ib3R0b21JbnNldDsKICAgIH0KCiAgICBjb25zdCB3aWR0aCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS53aWR0aCArIG1hcmdpbkgsIHRoaXMudyB8fCAwKTsKICAgIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQgKyBtYXJnaW5WLCB0aGlzLmggfHwgMCk7CiAgICBjb25zdCBiYm94ID0gW3RoaXMueCwgdGhpcy55LCB3aWR0aCwgaGVpZ2h0XTsKCiAgICBpZiAodGhpcy53ID09PSAiIikgewogICAgICBzdHlsZS53aWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHdpZHRoKTsKICAgIH0KCiAgICBpZiAodGhpcy5oID09PSAiIikgewogICAgICBzdHlsZS5oZWlnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKShoZWlnaHQpOwogICAgfQoKICAgIGNvbnN0IGh0bWwgPSB7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzLAogICAgICBjaGlsZHJlbgogICAgfTsKICAgIGFwcGx5QXNzaXN0KHRoaXMsIGF0dHJpYnV0ZXMpOwogICAgZGVsZXRlIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXTsKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKCgwLCBfaHRtbF91dGlscy5jcmVhdGVXcmFwcGVyKSh0aGlzLCBodG1sKSwgYmJveCk7CiAgfQoKfQoKY2xhc3MgRXhlY3V0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJleGVjdXRlIik7CiAgICB0aGlzLmNvbm5lY3Rpb24gPSBhdHRyaWJ1dGVzLmNvbm5lY3Rpb24gfHwgIiI7CiAgICB0aGlzLmV4ZWN1dGVUeXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZXhlY3V0ZVR5cGUsIFsiaW1wb3J0IiwgInJlbWVyZ2UiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucnVuQXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5ydW5BdCwgWyJjbGllbnQiLCAiYm90aCIsICJzZXJ2ZXIiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIEV4dHJhcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJleHRyYXMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9vbGVhbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRlY2ltYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhEYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4dHJhcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mbG9hdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbnRlZ2VyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRleHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEZpZWxkIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImZpZWxkIiwgdHJ1ZSk7CiAgICB0aGlzLmFjY2VzcyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFjY2VzcywgWyJvcGVuIiwgIm5vbkludGVyYWN0aXZlIiwgInByb3RlY3RlZCIsICJyZWFkT25seSJdKTsKICAgIHRoaXMuYWNjZXNzS2V5ID0gYXR0cmlidXRlcy5hY2Nlc3NLZXkgfHwgIiI7CiAgICB0aGlzLmFuY2hvclR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hbmNob3JUeXBlLCBbInRvcExlZnQiLCAiYm90dG9tQ2VudGVyIiwgImJvdHRvbUxlZnQiLCAiYm90dG9tUmlnaHQiLCAibWlkZGxlQ2VudGVyIiwgIm1pZGRsZUxlZnQiLCAibWlkZGxlUmlnaHQiLCAidG9wQ2VudGVyIiwgInRvcFJpZ2h0Il0pOwogICAgdGhpcy5jb2xTcGFuID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuY29sU3BhbiwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgfHwgbiA9PT0gLTEKICAgIH0pOwogICAgdGhpcy5oID0gYXR0cmlidXRlcy5oID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5oKSA6ICIiOwogICAgdGhpcy5oQWxpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oQWxpZ24sIFsibGVmdCIsICJjZW50ZXIiLCAianVzdGlmeSIsICJqdXN0aWZ5QWxsIiwgInJhZGl4IiwgInJpZ2h0Il0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmxvY2FsZSA9IGF0dHJpYnV0ZXMubG9jYWxlIHx8ICIiOwogICAgdGhpcy5tYXhIID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5tYXhILCAiMHB0Iik7CiAgICB0aGlzLm1heFcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heFcsICIwcHQiKTsKICAgIHRoaXMubWluSCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWluSCwgIjBwdCIpOwogICAgdGhpcy5taW5XID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5XLCAiMHB0Iik7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy5yb3RhdGUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5yb3RhdGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCAlIDkwID09PSAwCiAgICB9KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLncgPSBhdHRyaWJ1dGVzLncgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLncpIDogIiI7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLngsICIwcHQiKTsKICAgIHRoaXMueSA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueSwgIjBwdCIpOwogICAgdGhpcy5hc3Npc3QgPSBudWxsOwogICAgdGhpcy5iaW5kID0gbnVsbDsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuY2FsY3VsYXRlID0gbnVsbDsKICAgIHRoaXMuY2FwdGlvbiA9IG51bGw7CiAgICB0aGlzLmRlc2MgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5mb250ID0gbnVsbDsKICAgIHRoaXMuZm9ybWF0ID0gbnVsbDsKICAgIHRoaXMuaXRlbXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMik7CiAgICB0aGlzLmtlZXAgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogICAgdGhpcy5wYXJhID0gbnVsbDsKICAgIHRoaXMudHJhdmVyc2FsID0gbnVsbDsKICAgIHRoaXMudWkgPSBudWxsOwogICAgdGhpcy52YWxpZGF0ZSA9IG51bGw7CiAgICB0aGlzLnZhbHVlID0gbnVsbDsKICAgIHRoaXMuYmluZEl0ZW1zID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbm5lY3QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXZlbnQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2V0UHJvcGVydHkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNCaW5kYWJsZV0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kc2V0VmFsdWVdKHZhbHVlKSB7CiAgICBfc2V0VmFsdWUodGhpcywgdmFsdWUpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBzZXRUYWJJbmRleCh0aGlzKTsKCiAgICBpZiAoIXRoaXMudWkpIHsKICAgICAgdGhpcy51aSA9IG5ldyBVaSh7fSk7CiAgICAgIHRoaXMudWlbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdID0gdGhpc1tfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV07CgogICAgICB0aGlzW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0odGhpcy51aSk7CgogICAgICBsZXQgbm9kZTsKCiAgICAgIHN3aXRjaCAodGhpcy5pdGVtcy5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBub2RlID0gbmV3IFRleHRFZGl0KHt9KTsKICAgICAgICAgIHRoaXMudWkudGV4dEVkaXQgPSBub2RlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIG5vZGUgPSBuZXcgQ2hlY2tCdXR0b24oe30pOwogICAgICAgICAgdGhpcy51aS5jaGVja0J1dHRvbiA9IG5vZGU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgbm9kZSA9IG5ldyBDaG9pY2VMaXN0KHt9KTsKICAgICAgICAgIHRoaXMudWkuY2hvaWNlTGlzdCA9IG5vZGU7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdGhpcy51aVtfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGUpOwogICAgfQoKICAgIGlmICghdGhpcy51aSB8fCB0aGlzLnByZXNlbmNlID09PSAiaGlkZGVuIiB8fCB0aGlzLnByZXNlbmNlID09PSAiaW5hY3RpdmUiIHx8IHRoaXMuaCA9PT0gMCB8fCB0aGlzLncgPT09IDApIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGlmICh0aGlzLmNhcHRpb24pIHsKICAgICAgZGVsZXRlIHRoaXMuY2FwdGlvbltfeGZhX29iamVjdC4kZXh0cmFdOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJHB1c2hQYXJhXSgpOwoKICAgIGNvbnN0IGNhcHRpb24gPSB0aGlzLmNhcHRpb24gPyB0aGlzLmNhcHRpb25bX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpLmh0bWwgOiBudWxsOwogICAgY29uc3Qgc2F2ZWRXID0gdGhpcy53OwogICAgY29uc3Qgc2F2ZWRIID0gdGhpcy5oOwogICAgbGV0IG1hcmdpbkggPSAwOwogICAgbGV0IG1hcmdpblYgPSAwOwoKICAgIGlmICh0aGlzLm1hcmdpbikgewogICAgICBtYXJnaW5IID0gdGhpcy5tYXJnaW4ubGVmdEluc2V0ICsgdGhpcy5tYXJnaW4ucmlnaHRJbnNldDsKICAgICAgbWFyZ2luViA9IHRoaXMubWFyZ2luLnRvcEluc2V0ICsgdGhpcy5tYXJnaW4uYm90dG9tSW5zZXQ7CiAgICB9CgogICAgbGV0IGJvcmRlckRpbXMgPSBudWxsOwoKICAgIGlmICh0aGlzLncgPT09ICIiIHx8IHRoaXMuaCA9PT0gIiIpIHsKICAgICAgbGV0IHdpZHRoID0gbnVsbDsKICAgICAgbGV0IGhlaWdodCA9IG51bGw7CiAgICAgIGxldCB1aVcgPSAwOwogICAgICBsZXQgdWlIID0gMDsKCiAgICAgIGlmICh0aGlzLnVpLmNoZWNrQnV0dG9uKSB7CiAgICAgICAgdWlXID0gdWlIID0gdGhpcy51aS5jaGVja0J1dHRvbi5zaXplOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHcsCiAgICAgICAgICBoCiAgICAgICAgfSA9ICgwLCBfaHRtbF91dGlscy5sYXlvdXROb2RlKSh0aGlzLCBhdmFpbGFibGVTcGFjZSk7CgogICAgICAgIGlmICh3ICE9PSBudWxsKSB7CiAgICAgICAgICB1aVcgPSB3OwogICAgICAgICAgdWlIID0gaDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdWlIID0gKDAsIF9mb250cy5nZXRNZXRyaWNzKSh0aGlzLmZvbnQsIHRydWUpLmxpbmVOb0dhcDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJvcmRlckRpbXMgPSBnZXRCb3JkZXJEaW1zKHRoaXMudWlbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpKTsKICAgICAgdWlXICs9IGJvcmRlckRpbXMudzsKICAgICAgdWlIICs9IGJvcmRlckRpbXMuaDsKCiAgICAgIGlmICh0aGlzLmNhcHRpb24pIHsKICAgICAgICBjb25zdCB7CiAgICAgICAgICB3LAogICAgICAgICAgaCwKICAgICAgICAgIGlzQnJva2VuCiAgICAgICAgfSA9IHRoaXMuY2FwdGlvbltfeGZhX29iamVjdC4kZ2V0RXh0cmFdKGF2YWlsYWJsZVNwYWNlKTsKCiAgICAgICAgaWYgKGlzQnJva2VuICYmIHRoaXNbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKClbX3hmYV9vYmplY3QuJGlzVGhlcmVNb3JlV2lkdGhdKCkpIHsKICAgICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICAgICAgfQoKICAgICAgICB3aWR0aCA9IHc7CiAgICAgICAgaGVpZ2h0ID0gaDsKCiAgICAgICAgc3dpdGNoICh0aGlzLmNhcHRpb24ucGxhY2VtZW50KSB7CiAgICAgICAgICBjYXNlICJsZWZ0IjoKICAgICAgICAgIGNhc2UgInJpZ2h0IjoKICAgICAgICAgIGNhc2UgImlubGluZSI6CiAgICAgICAgICAgIHdpZHRoICs9IHVpVzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAidG9wIjoKICAgICAgICAgIGNhc2UgImJvdHRvbSI6CiAgICAgICAgICAgIGhlaWdodCArPSB1aUg7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB3aWR0aCA9IHVpVzsKICAgICAgICBoZWlnaHQgPSB1aUg7CiAgICAgIH0KCiAgICAgIGlmICh3aWR0aCAmJiB0aGlzLncgPT09ICIiKSB7CiAgICAgICAgd2lkdGggKz0gbWFyZ2luSDsKICAgICAgICB0aGlzLncgPSBNYXRoLm1pbih0aGlzLm1heFcgPD0gMCA/IEluZmluaXR5IDogdGhpcy5tYXhXLCB0aGlzLm1pblcgKyAxIDwgd2lkdGggPyB3aWR0aCA6IHRoaXMubWluVyk7CiAgICAgIH0KCiAgICAgIGlmIChoZWlnaHQgJiYgdGhpcy5oID09PSAiIikgewogICAgICAgIGhlaWdodCArPSBtYXJnaW5WOwogICAgICAgIHRoaXMuaCA9IE1hdGgubWluKHRoaXMubWF4SCA8PSAwID8gSW5maW5pdHkgOiB0aGlzLm1heEgsIHRoaXMubWluSCArIDEgPCBoZWlnaHQgPyBoZWlnaHQgOiB0aGlzLm1pbkgpOwogICAgICB9CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAoMCwgX2h0bWxfdXRpbHMuZml4RGltZW5zaW9ucykodGhpcyk7CiAgICBzZXRGaXJzdFVuc3BsaXR0YWJsZSh0aGlzKTsKCiAgICBpZiAoISgwLCBfbGF5b3V0LmNoZWNrRGltZW5zaW9ucykodGhpcywgYXZhaWxhYmxlU3BhY2UpKSB7CiAgICAgIHRoaXMudyA9IHNhdmVkVzsKICAgICAgdGhpcy5oID0gc2F2ZWRIOwoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5GQUlMVVJFOwogICAgfQoKICAgIHVuc2V0Rmlyc3RVbnNwbGl0dGFibGUodGhpcyk7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiZm9udCIsICJkaW1lbnNpb25zIiwgInBvc2l0aW9uIiwgInJvdGF0ZSIsICJhbmNob3JUeXBlIiwgInByZXNlbmNlIiwgIm1hcmdpbiIsICJoQWxpZ24iKTsKICAgICgwLCBfaHRtbF91dGlscy5zZXRNaW5NYXhEaW1lbnNpb25zKSh0aGlzLCBzdHlsZSk7CiAgICBjb25zdCBjbGFzc05hbWVzID0gWyJ4ZmFGaWVsZCJdOwoKICAgIGlmICh0aGlzLmZvbnQpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFGb250Iik7CiAgICB9CgogICAgaWYgKCgwLCBfaHRtbF91dGlscy5pc1ByaW50T25seSkodGhpcykpIHsKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFQcmludE9ubHkiKTsKICAgIH0KCiAgICBjb25zdCBhdHRyaWJ1dGVzID0gewogICAgICBzdHlsZSwKICAgICAgaWQ6IHRoaXNbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgIGNsYXNzOiBjbGFzc05hbWVzCiAgICB9OwoKICAgIGlmIChzdHlsZS5tYXJnaW4pIHsKICAgICAgc3R5bGUucGFkZGluZyA9IHN0eWxlLm1hcmdpbjsKICAgICAgZGVsZXRlIHN0eWxlLm1hcmdpbjsKICAgIH0KCiAgICAoMCwgX2h0bWxfdXRpbHMuc2V0QWNjZXNzKSh0aGlzLCBjbGFzc05hbWVzKTsKCiAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgIGF0dHJpYnV0ZXMueGZhTmFtZSA9IHRoaXMubmFtZTsKICAgIH0KCiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwogICAgY29uc3QgaHRtbCA9IHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGF0dHJpYnV0ZXMsCiAgICAgIGNoaWxkcmVuCiAgICB9OwogICAgYXBwbHlBc3Npc3QodGhpcywgYXR0cmlidXRlcyk7CiAgICBjb25zdCBib3JkZXJTdHlsZSA9IHRoaXMuYm9yZGVyID8gdGhpcy5ib3JkZXJbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiBudWxsOwogICAgY29uc3QgYmJveCA9ICgwLCBfaHRtbF91dGlscy5jb21wdXRlQmJveCkodGhpcywgaHRtbCwgYXZhaWxhYmxlU3BhY2UpOwoKICAgIGNvbnN0IHVpID0gdGhpcy51aVtfeGZhX29iamVjdC4kdG9IVE1MXSgpLmh0bWw7CgogICAgaWYgKCF1aSkgewogICAgICBPYmplY3QuYXNzaWduKHN0eWxlLCBib3JkZXJTdHlsZSk7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKCgwLCBfaHRtbF91dGlscy5jcmVhdGVXcmFwcGVyKSh0aGlzLCBodG1sKSwgYmJveCk7CiAgICB9CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJHRhYkluZGV4XSkgewogICAgICBpZiAodWkuY2hpbGRyZW4gJiYgdWkuY2hpbGRyZW5bMF0pIHsKICAgICAgICB1aS5jaGlsZHJlblswXS5hdHRyaWJ1dGVzLnRhYmluZGV4ID0gdGhpc1tfeGZhX29iamVjdC4kdGFiSW5kZXhdOwogICAgICB9IGVsc2UgewogICAgICAgIHVpLmF0dHJpYnV0ZXMudGFiaW5kZXggPSB0aGlzW194ZmFfb2JqZWN0LiR0YWJJbmRleF07CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXVpLmF0dHJpYnV0ZXMuc3R5bGUpIHsKICAgICAgdWkuYXR0cmlidXRlcy5zdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogICAgbGV0IGFFbGVtZW50ID0gbnVsbDsKCiAgICBpZiAodGhpcy51aS5idXR0b24pIHsKICAgICAgaWYgKHVpLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSkgewogICAgICAgIFthRWxlbWVudF0gPSB1aS5jaGlsZHJlbi5zcGxpY2UoMCwgMSk7CiAgICAgIH0KCiAgICAgIE9iamVjdC5hc3NpZ24odWkuYXR0cmlidXRlcy5zdHlsZSwgYm9yZGVyU3R5bGUpOwogICAgfSBlbHNlIHsKICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZSwgYm9yZGVyU3R5bGUpOwogICAgfQoKICAgIGNoaWxkcmVuLnB1c2godWkpOwoKICAgIGlmICh0aGlzLnZhbHVlKSB7CiAgICAgIGlmICh0aGlzLnVpLmltYWdlRWRpdCkgewogICAgICAgIHVpLmNoaWxkcmVuLnB1c2godGhpcy52YWx1ZVtfeGZhX29iamVjdC4kdG9IVE1MXSgpLmh0bWwpOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnVpLmJ1dHRvbikgewogICAgICAgIGxldCB2YWx1ZSA9ICIiOwoKICAgICAgICBpZiAodGhpcy52YWx1ZS5leERhdGEpIHsKICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZS5leERhdGFbX3hmYV9vYmplY3QuJHRleHRdKCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZhbHVlLnRleHQpIHsKICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZS50ZXh0W194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgaHRtbFZhbHVlID0gdGhpcy52YWx1ZVtfeGZhX29iamVjdC4kdG9IVE1MXSgpLmh0bWw7CgogICAgICAgICAgaWYgKGh0bWxWYWx1ZSAhPT0gbnVsbCkgewogICAgICAgICAgICB2YWx1ZSA9IGh0bWxWYWx1ZS5jaGlsZHJlblswXS52YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnVpLnRleHRFZGl0ICYmIHRoaXMudmFsdWUudGV4dCAmJiB0aGlzLnZhbHVlLnRleHQubWF4Q2hhcnMpIHsKICAgICAgICAgIHVpLmNoaWxkcmVuWzBdLmF0dHJpYnV0ZXMubWF4TGVuZ3RoID0gdGhpcy52YWx1ZS50ZXh0Lm1heENoYXJzOwogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICBpZiAodGhpcy51aS5udW1lcmljRWRpdCkgewogICAgICAgICAgICB2YWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpOwogICAgICAgICAgICB2YWx1ZSA9IGlzTmFOKHZhbHVlKSA/ICIiIDogdmFsdWUudG9TdHJpbmcoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodWkuY2hpbGRyZW5bMF0ubmFtZSA9PT0gInRleHRhcmVhIikgewogICAgICAgICAgICB1aS5jaGlsZHJlblswXS5hdHRyaWJ1dGVzLnRleHRDb250ZW50ID0gdmFsdWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1aS5jaGlsZHJlblswXS5hdHRyaWJ1dGVzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKCF0aGlzLnVpLmltYWdlRWRpdCAmJiB1aS5jaGlsZHJlbiAmJiB1aS5jaGlsZHJlblswXSAmJiB0aGlzLmgpIHsKICAgICAgYm9yZGVyRGltcyA9IGJvcmRlckRpbXMgfHwgZ2V0Qm9yZGVyRGltcyh0aGlzLnVpW194ZmFfb2JqZWN0LiRnZXRFeHRyYV0oKSk7CiAgICAgIGxldCBjYXB0aW9uSGVpZ2h0ID0gMDsKCiAgICAgIGlmICh0aGlzLmNhcHRpb24gJiYgWyJ0b3AiLCAiYm90dG9tIl0uaW5jbHVkZXModGhpcy5jYXB0aW9uLnBsYWNlbWVudCkpIHsKICAgICAgICBjYXB0aW9uSGVpZ2h0ID0gdGhpcy5jYXB0aW9uLnJlc2VydmU7CgogICAgICAgIGlmIChjYXB0aW9uSGVpZ2h0IDw9IDApIHsKICAgICAgICAgIGNhcHRpb25IZWlnaHQgPSB0aGlzLmNhcHRpb25bX3hmYV9vYmplY3QuJGdldEV4dHJhXShhdmFpbGFibGVTcGFjZSkuaDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlucHV0SGVpZ2h0ID0gdGhpcy5oIC0gY2FwdGlvbkhlaWdodCAtIG1hcmdpblYgLSBib3JkZXJEaW1zLmg7CiAgICAgICAgdWkuY2hpbGRyZW5bMF0uYXR0cmlidXRlcy5zdHlsZS5oZWlnaHQgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKShpbnB1dEhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdWkuY2hpbGRyZW5bMF0uYXR0cmlidXRlcy5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoYUVsZW1lbnQpIHsKICAgICAgdWkuY2hpbGRyZW4ucHVzaChhRWxlbWVudCk7CiAgICB9CgogICAgaWYgKCFjYXB0aW9uKSB7CiAgICAgIGlmICh1aS5hdHRyaWJ1dGVzLmNsYXNzKSB7CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFMZWZ0Iik7CiAgICAgIH0KCiAgICAgIHRoaXMudyA9IHNhdmVkVzsKICAgICAgdGhpcy5oID0gc2F2ZWRIOwogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcygoMCwgX2h0bWxfdXRpbHMuY3JlYXRlV3JhcHBlcikodGhpcywgaHRtbCksIGJib3gpOwogICAgfQoKICAgIGlmICh0aGlzLnVpLmJ1dHRvbikgewogICAgICBpZiAoc3R5bGUucGFkZGluZykgewogICAgICAgIGRlbGV0ZSBzdHlsZS5wYWRkaW5nOwogICAgICB9CgogICAgICBpZiAoY2FwdGlvbi5uYW1lID09PSAiZGl2IikgewogICAgICAgIGNhcHRpb24ubmFtZSA9ICJzcGFuIjsKICAgICAgfQoKICAgICAgdWkuY2hpbGRyZW4ucHVzaChjYXB0aW9uKTsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoaHRtbCwgYmJveCk7CiAgICB9IGVsc2UgaWYgKHRoaXMudWkuY2hlY2tCdXR0b24pIHsKICAgICAgY2FwdGlvbi5hdHRyaWJ1dGVzLmNsYXNzWzBdID0gInhmYUNhcHRpb25Gb3JDaGVja0J1dHRvbiI7CiAgICB9CgogICAgaWYgKCF1aS5hdHRyaWJ1dGVzLmNsYXNzKSB7CiAgICAgIHVpLmF0dHJpYnV0ZXMuY2xhc3MgPSBbXTsKICAgIH0KCiAgICB1aS5jaGlsZHJlbi5zcGxpY2UoMCwgMCwgY2FwdGlvbik7CgogICAgc3dpdGNoICh0aGlzLmNhcHRpb24ucGxhY2VtZW50KSB7CiAgICAgIGNhc2UgImxlZnQiOgogICAgICAgIHVpLmF0dHJpYnV0ZXMuY2xhc3MucHVzaCgieGZhTGVmdCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAicmlnaHQiOgogICAgICAgIHVpLmF0dHJpYnV0ZXMuY2xhc3MucHVzaCgieGZhUmlnaHQiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcCI6CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFUb3AiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImJvdHRvbSI6CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFCb3R0b20iKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImlubGluZSI6CiAgICAgICAgdWkuYXR0cmlidXRlcy5jbGFzcy5wdXNoKCJ4ZmFMZWZ0Iik7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgdGhpcy53ID0gc2F2ZWRXOwogICAgdGhpcy5oID0gc2F2ZWRIOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKICB9Cgp9CgpleHBvcnRzLkZpZWxkID0gRmllbGQ7CgpjbGFzcyBGaWxsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImZpbGwiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvbG9yID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubGluZWFyID0gbnVsbDsKICAgIHRoaXMucGF0dGVybiA9IG51bGw7CiAgICB0aGlzLnJhZGlhbCA9IG51bGw7CiAgICB0aGlzLnNvbGlkID0gbnVsbDsKICAgIHRoaXMuc3RpcHBsZSA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGdyYW5kcGEgPSBwYXJlbnRbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBnZ3JhbmRwYSA9IGdyYW5kcGFbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBzdHlsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBsZXQgcHJvcE5hbWUgPSAiY29sb3IiOwogICAgbGV0IGFsdFByb3BOYW1lID0gcHJvcE5hbWU7CgogICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIEJvcmRlcikgewogICAgICBwcm9wTmFtZSA9ICJiYWNrZ3JvdW5kLWNvbG9yIjsKICAgICAgYWx0UHJvcE5hbWUgPSAiYmFja2dyb3VuZCI7CgogICAgICBpZiAoZ2dyYW5kcGEgaW5zdGFuY2VvZiBVaSkgewogICAgICAgIHN0eWxlLmJhY2tncm91bmRDb2xvciA9ICJ3aGl0ZSI7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgUmVjdGFuZ2xlIHx8IHBhcmVudCBpbnN0YW5jZW9mIEFyYykgewogICAgICBwcm9wTmFtZSA9IGFsdFByb3BOYW1lID0gImZpbGwiOwogICAgICBzdHlsZS5maWxsID0gIndoaXRlIjsKICAgIH0KCiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgaWYgKG5hbWUgPT09ICJleHRyYXMiIHx8IG5hbWUgPT09ICJjb2xvciIpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3Qgb2JqID0gdGhpc1tuYW1lXTsKCiAgICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdCkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgY29sb3IgPSBvYmpbX3hmYV9vYmplY3QuJHRvU3R5bGVdKHRoaXMuY29sb3IpOwoKICAgICAgaWYgKGNvbG9yKSB7CiAgICAgICAgc3R5bGVbY29sb3Iuc3RhcnRzV2l0aCgiIyIpID8gcHJvcE5hbWUgOiBhbHRQcm9wTmFtZV0gPSBjb2xvcjsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0eWxlOwogICAgfQoKICAgIGlmICh0aGlzLmNvbG9yICYmIHRoaXMuY29sb3IudmFsdWUpIHsKICAgICAgY29uc3QgY29sb3IgPSB0aGlzLmNvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgICAgc3R5bGVbY29sb3Iuc3RhcnRzV2l0aCgiIyIpID8gcHJvcE5hbWUgOiBhbHRQcm9wTmFtZV0gPSBjb2xvcjsKICAgIH0KCiAgICByZXR1cm4gc3R5bGU7CiAgfQoKfQoKY2xhc3MgRmlsdGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImZpbHRlciIsIHRydWUpOwogICAgdGhpcy5hZGRSZXZvY2F0aW9uSW5mbyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFkZFJldm9jYXRpb25JbmZvLCBbIiIsICJyZXF1aXJlZCIsICJvcHRpb25hbCIsICJub25lIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy52ZXJzaW9uID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IHRoaXMudmVyc2lvbiwKICAgICAgZGVmYXVsdFZhbHVlOiA1LAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDEgJiYgeCA8PSA1CiAgICB9KTsKICAgIHRoaXMuYXBwZWFyYW5jZUZpbHRlciA9IG51bGw7CiAgICB0aGlzLmNlcnRpZmljYXRlcyA9IG51bGw7CiAgICB0aGlzLmRpZ2VzdE1ldGhvZHMgPSBudWxsOwogICAgdGhpcy5lbmNvZGluZ3MgPSBudWxsOwogICAgdGhpcy5lbmNyeXB0aW9uTWV0aG9kcyA9IG51bGw7CiAgICB0aGlzLmhhbmRsZXIgPSBudWxsOwogICAgdGhpcy5sb2NrRG9jdW1lbnQgPSBudWxsOwogICAgdGhpcy5tZHAgPSBudWxsOwogICAgdGhpcy5yZWFzb25zID0gbnVsbDsKICAgIHRoaXMudGltZVN0YW1wID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBGbG9hdCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiZmxvYXQiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgbnVtYmVyID0gcGFyc2VGbG9hdCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCkpOwogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBpc05hTihudW1iZXIpID8gbnVsbCA6IG51bWJlcjsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIHZhbHVlVG9IdG1sKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdICE9PSBudWxsID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udG9TdHJpbmcoKSA6ICIiKTsKICB9Cgp9CgpjbGFzcyBGb250IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImZvbnQiLCB0cnVlKTsKICAgIHRoaXMuYmFzZWxpbmVTaGlmdCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuYmFzZWxpbmVTaGlmdCk7CiAgICB0aGlzLmZvbnRIb3Jpem9udGFsU2NhbGUgPSAoMCwgX3V0aWxzLmdldEZsb2F0KSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZm9udEhvcml6b250YWxTY2FsZSwKICAgICAgZGVmYXVsdFZhbHVlOiAxMDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgICB0aGlzLmZvbnRWZXJ0aWNhbFNjYWxlID0gKDAsIF91dGlscy5nZXRGbG9hdCkoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmZvbnRWZXJ0aWNhbFNjYWxlLAogICAgICBkZWZhdWx0VmFsdWU6IDEwMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5rZXJuaW5nTW9kZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmtlcm5pbmdNb2RlLCBbIm5vbmUiLCAicGFpciJdKTsKICAgIHRoaXMubGV0dGVyU3BhY2luZyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubGV0dGVyU3BhY2luZywgIjAiKTsKICAgIHRoaXMubGluZVRocm91Z2ggPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5saW5lVGhyb3VnaCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxIHx8IHggPT09IDIKICAgIH0pOwogICAgdGhpcy5saW5lVGhyb3VnaFBlcmlvZCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmxpbmVUaHJvdWdoUGVyaW9kLCBbImFsbCIsICJ3b3JkIl0pOwogICAgdGhpcy5vdmVybGluZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLm92ZXJsaW5lLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEgfHwgeCA9PT0gMgogICAgfSk7CiAgICB0aGlzLm92ZXJsaW5lUGVyaW9kID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMub3ZlcmxpbmVQZXJpb2QsIFsiYWxsIiwgIndvcmQiXSk7CiAgICB0aGlzLnBvc3R1cmUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wb3N0dXJlLCBbIm5vcm1hbCIsICJpdGFsaWMiXSk7CiAgICB0aGlzLnNpemUgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnNpemUsICIxMHB0Iik7CiAgICB0aGlzLnR5cGVmYWNlID0gYXR0cmlidXRlcy50eXBlZmFjZSB8fCAiQ291cmllciI7CiAgICB0aGlzLnVuZGVybGluZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnVuZGVybGluZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxIHx8IHggPT09IDIKICAgIH0pOwogICAgdGhpcy51bmRlcmxpbmVQZXJpb2QgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy51bmRlcmxpbmVQZXJpb2QsIFsiYWxsIiwgIndvcmQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy53ZWlnaHQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy53ZWlnaHQsIFsibm9ybWFsIiwgImJvbGQiXSk7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZpbGwgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRjbGVhbl0oYnVpbGRlcikgewogICAgc3VwZXJbX3hmYV9vYmplY3QuJGNsZWFuXShidWlsZGVyKTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS51c2VkVHlwZWZhY2VzLmFkZCh0aGlzLnR5cGVmYWNlKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSB7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiZmlsbCIpOwogICAgY29uc3QgY29sb3IgPSBzdHlsZS5jb2xvcjsKCiAgICBpZiAoY29sb3IpIHsKICAgICAgaWYgKGNvbG9yID09PSAiIzAwMDAwMCIpIHsKICAgICAgICBkZWxldGUgc3R5bGUuY29sb3I7CiAgICAgIH0gZWxzZSBpZiAoIWNvbG9yLnN0YXJ0c1dpdGgoIiMiKSkgewogICAgICAgIHN0eWxlLmJhY2tncm91bmQgPSBjb2xvcjsKICAgICAgICBzdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICJ0ZXh0IjsKICAgICAgICBzdHlsZS5jb2xvciA9ICJ0cmFuc3BhcmVudCI7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5iYXNlbGluZVNoaWZ0KSB7CiAgICAgIHN0eWxlLnZlcnRpY2FsQWxpZ24gPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlzLmJhc2VsaW5lU2hpZnQpOwogICAgfQoKICAgIHN0eWxlLmZvbnRLZXJuaW5nID0gdGhpcy5rZXJuaW5nTW9kZSA9PT0gIm5vbmUiID8gIm5vbmUiIDogIm5vcm1hbCI7CiAgICBzdHlsZS5sZXR0ZXJTcGFjaW5nID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5sZXR0ZXJTcGFjaW5nKTsKCiAgICBpZiAodGhpcy5saW5lVGhyb3VnaCAhPT0gMCkgewogICAgICBzdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICJsaW5lLXRocm91Z2giOwoKICAgICAgaWYgKHRoaXMubGluZVRocm91Z2ggPT09IDIpIHsKICAgICAgICBzdHlsZS50ZXh0RGVjb3JhdGlvblN0eWxlID0gImRvdWJsZSI7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5vdmVybGluZSAhPT0gMCkgewogICAgICBzdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICJvdmVybGluZSI7CgogICAgICBpZiAodGhpcy5vdmVybGluZSA9PT0gMikgewogICAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uU3R5bGUgPSAiZG91YmxlIjsKICAgICAgfQogICAgfQoKICAgIHN0eWxlLmZvbnRTdHlsZSA9IHRoaXMucG9zdHVyZTsKICAgIHN0eWxlLmZvbnRTaXplID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoMC45OSAqIHRoaXMuc2l6ZSk7CiAgICAoMCwgX2h0bWxfdXRpbHMuc2V0Rm9udEZhbWlseSkodGhpcywgdGhpcywgdGhpc1tfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlciwgc3R5bGUpOwoKICAgIGlmICh0aGlzLnVuZGVybGluZSAhPT0gMCkgewogICAgICBzdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICJ1bmRlcmxpbmUiOwoKICAgICAgaWYgKHRoaXMudW5kZXJsaW5lID09PSAyKSB7CiAgICAgICAgc3R5bGUudGV4dERlY29yYXRpb25TdHlsZSA9ICJkb3VibGUiOwogICAgICB9CiAgICB9CgogICAgc3R5bGUuZm9udFdlaWdodCA9IHRoaXMud2VpZ2h0OwogICAgcmV0dXJuIHN0eWxlOwogIH0KCn0KCmNsYXNzIEZvcm1hdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJmb3JtYXQiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMucGljdHVyZSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgSGFuZGxlciBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJoYW5kbGVyIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIEh5cGhlbmF0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImh5cGhlbmF0aW9uIik7CiAgICB0aGlzLmV4Y2x1ZGVBbGxDYXBzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZXhjbHVkZUFsbENhcHMsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLmV4Y2x1ZGVJbml0aWFsQ2FwID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZXhjbHVkZUluaXRpYWxDYXAsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLmh5cGhlbmF0ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmh5cGhlbmF0ZSwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5wdXNoQ2hhcmFjdGVyQ291bnQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5wdXNoQ2hhcmFjdGVyQ291bnQsCiAgICAgIGRlZmF1bHRWYWx1ZTogMywKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMucmVtYWluQ2hhcmFjdGVyQ291bnQgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5yZW1haW5DaGFyYWN0ZXJDb3VudCwKICAgICAgZGVmYXVsdFZhbHVlOiAzLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMud29yZENoYXJhY3RlckNvdW50ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMud29yZENoYXJhY3RlckNvdW50LAogICAgICBkZWZhdWx0VmFsdWU6IDcsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMAogICAgfSk7CiAgfQoKfQoKY2xhc3MgSW1hZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiaW1hZ2UiKTsKICAgIHRoaXMuYXNwZWN0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYXNwZWN0LCBbImZpdCIsICJhY3R1YWwiLCAiaGVpZ2h0IiwgIm5vbmUiLCAid2lkdGgiXSk7CiAgICB0aGlzLmNvbnRlbnRUeXBlID0gYXR0cmlidXRlcy5jb250ZW50VHlwZSB8fCAiIjsKICAgIHRoaXMuaHJlZiA9IGF0dHJpYnV0ZXMuaHJlZiB8fCAiIjsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy50cmFuc2ZlckVuY29kaW5nID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHJhbnNmZXJFbmNvZGluZywgWyJiYXNlNjQiLCAibm9uZSIsICJwYWNrYWdlIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGlmICh0aGlzLmNvbnRlbnRUeXBlICYmICFNSU1FUy5oYXModGhpcy5jb250ZW50VHlwZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgbGV0IGJ1ZmZlciA9IHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLmltYWdlcyAmJiB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5pbWFnZXMuZ2V0KHRoaXMuaHJlZik7CgogICAgaWYgKCFidWZmZXIgJiYgKHRoaXMuaHJlZiB8fCAhdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICBpZiAoIWJ1ZmZlciAmJiB0aGlzLnRyYW5zZmVyRW5jb2RpbmcgPT09ICJiYXNlNjQiKSB7CiAgICAgIGJ1ZmZlciA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShhdG9iKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdKSk7CiAgICB9CgogICAgaWYgKCFidWZmZXIpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGlmICghdGhpcy5jb250ZW50VHlwZSkgewogICAgICBmb3IgKGNvbnN0IFtoZWFkZXIsIHR5cGVdIG9mIElNQUdFU19IRUFERVJTKSB7CiAgICAgICAgaWYgKGJ1ZmZlci5sZW5ndGggPiBoZWFkZXIubGVuZ3RoICYmIGhlYWRlci5ldmVyeSgoeCwgaSkgPT4geCA9PT0gYnVmZmVyW2ldKSkgewogICAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IHR5cGU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5jb250ZW50VHlwZSkgewogICAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnVmZmVyXSwgewogICAgICB0eXBlOiB0aGlzLmNvbnRlbnRUeXBlCiAgICB9KTsKICAgIGxldCBzdHlsZTsKCiAgICBzd2l0Y2ggKHRoaXMuYXNwZWN0KSB7CiAgICAgIGNhc2UgImZpdCI6CiAgICAgIGNhc2UgImFjdHVhbCI6CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJoZWlnaHQiOgogICAgICAgIHN0eWxlID0gewogICAgICAgICAgaGVpZ2h0OiAiMTAwJSIsCiAgICAgICAgICBvYmplY3RGaXQ6ICJmaWxsIgogICAgICAgIH07CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJub25lIjoKICAgICAgICBzdHlsZSA9IHsKICAgICAgICAgIHdpZHRoOiAiMTAwJSIsCiAgICAgICAgICBoZWlnaHQ6ICIxMDAlIiwKICAgICAgICAgIG9iamVjdEZpdDogImZpbGwiCiAgICAgICAgfTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIndpZHRoIjoKICAgICAgICBzdHlsZSA9IHsKICAgICAgICAgIHdpZHRoOiAiMTAwJSIsCiAgICAgICAgICBvYmplY3RGaXQ6ICJmaWxsIgogICAgICAgIH07CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogImltZyIsCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBjbGFzczogWyJ4ZmFJbWFnZSJdLAogICAgICAgIHN0eWxlLAogICAgICAgIHNyYzogVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSwKICAgICAgICBhbHQ6IHBhcmVudCA/IGFyaWFMYWJlbChwYXJlbnRbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKSkgOiBudWxsCiAgICAgIH0KICAgIH0pOwogIH0KCn0KCmNsYXNzIEltYWdlRWRpdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJpbWFnZUVkaXQiLCB0cnVlKTsKICAgIHRoaXMuZGF0YSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmRhdGEsIFsibGluayIsICJlbWJlZCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgaWYgKHRoaXMuZGF0YSA9PT0gImVtYmVkIikgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgICAgbmFtZTogImRpdiIsCiAgICAgICAgY2hpbGRyZW46IFtdLAogICAgICAgIGF0dHJpYnV0ZXM6IHt9CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICB9Cgp9CgpjbGFzcyBJbnRlZ2VyIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJpbnRlZ2VyIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIGNvbnN0IG51bWJlciA9IHBhcnNlSW50KHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKSwgMTApOwogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBpc05hTihudW1iZXIpID8gbnVsbCA6IG51bWJlcjsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgcmV0dXJuIHZhbHVlVG9IdG1sKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdICE9PSBudWxsID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udG9TdHJpbmcoKSA6ICIiKTsKICB9Cgp9CgpjbGFzcyBJc3N1ZXJzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImlzc3VlcnMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNlcnRpZmljYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgSXRlbXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAiaXRlbXMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5wcmVzZW5jZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnByZXNlbmNlLCBbInZpc2libGUiLCAiaGlkZGVuIiwgImluYWN0aXZlIiwgImludmlzaWJsZSJdKTsKICAgIHRoaXMucmVmID0gYXR0cmlidXRlcy5yZWYgfHwgIiI7CiAgICB0aGlzLnNhdmUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5zYXZlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9vbGVhbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGVUaW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRlY2ltYWwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhEYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZsb2F0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmltYWdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmludGVnZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oKSB7CiAgICBjb25zdCBvdXRwdXQgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpKSB7CiAgICAgIG91dHB1dC5wdXNoKGNoaWxkW194ZmFfb2JqZWN0LiR0ZXh0XSgpKTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhvdXRwdXQpOwogIH0KCn0KCmV4cG9ydHMuSXRlbXMgPSBJdGVtczsKCmNsYXNzIEtlZXAgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAia2VlcCIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICBjb25zdCBvcHRpb25zID0gWyJub25lIiwgImNvbnRlbnRBcmVhIiwgInBhZ2VBcmVhIl07CiAgICB0aGlzLmludGFjdCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmludGFjdCwgb3B0aW9ucyk7CiAgICB0aGlzLm5leHQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5uZXh0LCBvcHRpb25zKTsKICAgIHRoaXMucHJldmlvdXMgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5wcmV2aW91cywgb3B0aW9ucyk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCn0KCmNsYXNzIEtleVVzYWdlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImtleVVzYWdlIik7CiAgICBjb25zdCBvcHRpb25zID0gWyIiLCAieWVzIiwgIm5vIl07CiAgICB0aGlzLmNybFNpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5jcmxTaWduLCBvcHRpb25zKTsKICAgIHRoaXMuZGF0YUVuY2lwaGVybWVudCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmRhdGFFbmNpcGhlcm1lbnQsIG9wdGlvbnMpOwogICAgdGhpcy5kZWNpcGhlck9ubHkgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5kZWNpcGhlck9ubHksIG9wdGlvbnMpOwogICAgdGhpcy5kaWdpdGFsU2lnbmF0dXJlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZGlnaXRhbFNpZ25hdHVyZSwgb3B0aW9ucyk7CiAgICB0aGlzLmVuY2lwaGVyT25seSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmVuY2lwaGVyT25seSwgb3B0aW9ucyk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMua2V5QWdyZWVtZW50ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMua2V5QWdyZWVtZW50LCBvcHRpb25zKTsKICAgIHRoaXMua2V5Q2VydFNpZ24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5rZXlDZXJ0U2lnbiwgb3B0aW9ucyk7CiAgICB0aGlzLmtleUVuY2lwaGVybWVudCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmtleUVuY2lwaGVybWVudCwgb3B0aW9ucyk7CiAgICB0aGlzLm5vblJlcHVkaWF0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubm9uUmVwdWRpYXRpb24sIG9wdGlvbnMpOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgTGluZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJsaW5lIiwgdHJ1ZSk7CiAgICB0aGlzLmhhbmQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5oYW5kLCBbImV2ZW4iLCAibGVmdCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5zbG9wZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNsb3BlLCBbIlxcIiwgIi8iXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5lZGdlID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IGVkZ2UgPSB0aGlzLmVkZ2UgfHwgbmV3IEVkZ2Uoe30pOwoKICAgIGNvbnN0IGVkZ2VTdHlsZSA9IGVkZ2VbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCk7CgogICAgY29uc3Qgc3R5bGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgY29uc3QgdGhpY2tuZXNzID0gZWRnZS5wcmVzZW5jZSA9PT0gInZpc2libGUiID8gZWRnZS50aGlja25lc3MgOiAwOwogICAgc3R5bGUuc3Ryb2tlV2lkdGggPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh0aGlja25lc3MpOwogICAgc3R5bGUuc3Ryb2tlID0gZWRnZVN0eWxlLmNvbG9yOwogICAgbGV0IHgxLCB5MSwgeDIsIHkyOwogICAgbGV0IHdpZHRoID0gIjEwMCUiOwogICAgbGV0IGhlaWdodCA9ICIxMDAlIjsKCiAgICBpZiAocGFyZW50LncgPD0gdGhpY2tuZXNzKSB7CiAgICAgIFt4MSwgeTEsIHgyLCB5Ml0gPSBbIjUwJSIsIDAsICI1MCUiLCAiMTAwJSJdOwogICAgICB3aWR0aCA9IHN0eWxlLnN0cm9rZVdpZHRoOwogICAgfSBlbHNlIGlmIChwYXJlbnQuaCA8PSB0aGlja25lc3MpIHsKICAgICAgW3gxLCB5MSwgeDIsIHkyXSA9IFswLCAiNTAlIiwgIjEwMCUiLCAiNTAlIl07CiAgICAgIGhlaWdodCA9IHN0eWxlLnN0cm9rZVdpZHRoOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHRoaXMuc2xvcGUgPT09ICJcXCIpIHsKICAgICAgICBbeDEsIHkxLCB4MiwgeTJdID0gWzAsIDAsICIxMDAlIiwgIjEwMCUiXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBbeDEsIHkxLCB4MiwgeTJdID0gWzAsICIxMDAlIiwgIjEwMCUiLCAwXTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGxpbmUgPSB7CiAgICAgIG5hbWU6ICJsaW5lIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHhtbG5zOiBTVkdfTlMsCiAgICAgICAgeDEsCiAgICAgICAgeTEsCiAgICAgICAgeDIsCiAgICAgICAgeTIsCiAgICAgICAgc3R5bGUKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHN2ZyA9IHsKICAgICAgbmFtZTogInN2ZyIsCiAgICAgIGNoaWxkcmVuOiBbbGluZV0sCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICB4bWxuczogU1ZHX05TLAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBzdHlsZTogewogICAgICAgICAgb3ZlcmZsb3c6ICJ2aXNpYmxlIgogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBpZiAoaGFzTWFyZ2luKHBhcmVudCkpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICAgIG5hbWU6ICJkaXYiLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgIGRpc3BsYXk6ICJpbmxpbmUiLAogICAgICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgICAgICBoZWlnaHQ6ICIxMDAlIgogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2hpbGRyZW46IFtzdmddCiAgICAgIH0pOwogICAgfQoKICAgIHN2Zy5hdHRyaWJ1dGVzLnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHN2Zyk7CiAgfQoKfQoKY2xhc3MgTGluZWFyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgImxpbmVhciIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbInRvUmlnaHQiLCAidG9Cb3R0b20iLCAidG9MZWZ0IiwgInRvVG9wIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuY29sb3IgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXShzdGFydENvbG9yKSB7CiAgICBzdGFydENvbG9yID0gc3RhcnRDb2xvciA/IHN0YXJ0Q29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiAiI0ZGRkZGRiI7CiAgICBjb25zdCB0cmFuc2YgPSB0aGlzLnR5cGUucmVwbGFjZSgvKFtSQkxUXSkvLCAiICQxIikudG9Mb3dlckNhc2UoKTsKICAgIGNvbnN0IGVuZENvbG9yID0gdGhpcy5jb2xvciA/IHRoaXMuY29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiAiIzAwMDAwMCI7CiAgICByZXR1cm4gYGxpbmVhci1ncmFkaWVudCgke3RyYW5zZn0sICR7c3RhcnRDb2xvcn0sICR7ZW5kQ29sb3J9KWA7CiAgfQoKfQoKY2xhc3MgTG9ja0RvY3VtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJsb2NrRG9jdW1lbnQiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLCBbImF1dG8iLCAiMCIsICIxIl0pOwogIH0KCn0KCmNsYXNzIE1hbmlmZXN0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm1hbmlmZXN0IiwgdHJ1ZSk7CiAgICB0aGlzLmFjdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmFjdGlvbiwgWyJpbmNsdWRlIiwgImFsbCIsICJleGNsdWRlIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5yZWYgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBNYXJnaW4gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAibWFyZ2luIiwgdHJ1ZSk7CiAgICB0aGlzLmJvdHRvbUluc2V0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5ib3R0b21JbnNldCwgIjAiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sZWZ0SW5zZXQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmxlZnRJbnNldCwgIjAiKTsKICAgIHRoaXMucmlnaHRJbnNldCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMucmlnaHRJbnNldCwgIjAiKTsKICAgIHRoaXMudG9wSW5zZXQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnRvcEluc2V0LCAiMCIpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSB7CiAgICByZXR1cm4gewogICAgICBtYXJnaW46ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMudG9wSW5zZXQpICsgIiAiICsgKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5yaWdodEluc2V0KSArICIgIiArICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuYm90dG9tSW5zZXQpICsgIiAiICsgKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5sZWZ0SW5zZXQpCiAgICB9OwogIH0KCn0KCmNsYXNzIE1kcCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJtZHAiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5wZXJtaXNzaW9ucyA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnBlcm1pc3Npb25zLAogICAgICBkZWZhdWx0VmFsdWU6IDIsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEgfHwgeCA9PT0gMwogICAgfSk7CiAgICB0aGlzLnNpZ25hdHVyZVR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zaWduYXR1cmVUeXBlLCBbImZpbGxlciIsICJhdXRob3IiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIE1lZGl1bSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJtZWRpdW0iKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5pbWFnaW5nQkJveCA9ICgwLCBfdXRpbHMuZ2V0QkJveCkoYXR0cmlidXRlcy5pbWFnaW5nQkJveCk7CiAgICB0aGlzLmxvbmcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLmxvbmcpOwogICAgdGhpcy5vcmllbnRhdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm9yaWVudGF0aW9uLCBbInBvcnRyYWl0IiwgImxhbmRzY2FwZSJdKTsKICAgIHRoaXMuc2hvcnQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnNob3J0KTsKICAgIHRoaXMuc3RvY2sgPSBhdHRyaWJ1dGVzLnN0b2NrIHx8ICIiOwogICAgdGhpcy50cmF5SW4gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50cmF5SW4sIFsiYXV0byIsICJkZWxlZ2F0ZSIsICJwYWdlRnJvbnQiXSk7CiAgICB0aGlzLnRyYXlPdXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50cmF5T3V0LCBbImF1dG8iLCAiZGVsZWdhdGUiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIE1lc3NhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAibWVzc2FnZSIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy50ZXh0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgTnVtZXJpY0VkaXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAibnVtZXJpY0VkaXQiLCB0cnVlKTsKICAgIHRoaXMuaFNjcm9sbFBvbGljeSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhTY3JvbGxQb2xpY3ksIFsiYXV0byIsICJvZmYiLCAib24iXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmNvbWIgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiYm9yZGVyIiwgImZvbnQiLCAibWFyZ2luIik7CgogICAgY29uc3QgZmllbGQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKClbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKCiAgICBjb25zdCBodG1sID0gewogICAgICBuYW1lOiAiaW5wdXQiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgIGZpZWxkSWQ6IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgIGRhdGFJZDogZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdICYmIGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXVtfeGZhX29iamVjdC4kdWlkXSB8fCBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICBjbGFzczogWyJ4ZmFUZXh0ZmllbGQiXSwKICAgICAgICBzdHlsZSwKICAgICAgICAiYXJpYS1sYWJlbCI6IGFyaWFMYWJlbChmaWVsZCksCiAgICAgICAgImFyaWEtcmVxdWlyZWQiOiBmYWxzZQogICAgICB9CiAgICB9OwoKICAgIGlmIChpc1JlcXVpcmVkKGZpZWxkKSkgewogICAgICBodG1sLmF0dHJpYnV0ZXNbImFyaWEtcmVxdWlyZWQiXSA9IHRydWU7CiAgICAgIGh0bWwuYXR0cmlidXRlcy5yZXF1aXJlZCA9IHRydWU7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiAibGFiZWwiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFsieGZhTGFiZWwiXQogICAgICB9LAogICAgICBjaGlsZHJlbjogW2h0bWxdCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBPY2N1ciBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJvY2N1ciIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmluaXRpYWwgPSBhdHRyaWJ1dGVzLmluaXRpYWwgIT09ICIiID8gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuaW5pdGlhbCwKICAgICAgZGVmYXVsdFZhbHVlOiAiIiwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSkgOiAiIjsKICAgIHRoaXMubWF4ID0gYXR0cmlidXRlcy5tYXggIT09ICIiID8gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubWF4LAogICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHRydWUKICAgIH0pIDogIiI7CiAgICB0aGlzLm1pbiA9IGF0dHJpYnV0ZXMubWluICE9PSAiIiA/ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLm1pbiwKICAgICAgZGVmYXVsdFZhbHVlOiAxLAogICAgICB2YWxpZGF0ZTogeCA9PiB0cnVlCiAgICB9KSA6ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kY2xlYW5dKCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGNvbnN0IG9yaWdpbmFsTWluID0gdGhpcy5taW47CgogICAgaWYgKHRoaXMubWluID09PSAiIikgewogICAgICB0aGlzLm1pbiA9IHBhcmVudCBpbnN0YW5jZW9mIFBhZ2VBcmVhIHx8IHBhcmVudCBpbnN0YW5jZW9mIFBhZ2VTZXQgPyAwIDogMTsKICAgIH0KCiAgICBpZiAodGhpcy5tYXggPT09ICIiKSB7CiAgICAgIGlmIChvcmlnaW5hbE1pbiA9PT0gIiIpIHsKICAgICAgICB0aGlzLm1heCA9IHBhcmVudCBpbnN0YW5jZW9mIFBhZ2VBcmVhIHx8IHBhcmVudCBpbnN0YW5jZW9mIFBhZ2VTZXQgPyAtMSA6IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tYXggPSB0aGlzLm1pbjsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLm1heCAhPT0gLTEgJiYgdGhpcy5tYXggPCB0aGlzLm1pbikgewogICAgICB0aGlzLm1heCA9IHRoaXMubWluOwogICAgfQoKICAgIGlmICh0aGlzLmluaXRpYWwgPT09ICIiKSB7CiAgICAgIHRoaXMuaW5pdGlhbCA9IHBhcmVudCBpbnN0YW5jZW9mIFRlbXBsYXRlID8gMSA6IHRoaXMubWluOwogICAgfQogIH0KCn0KCmNsYXNzIE9pZCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJvaWQiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBPaWRzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm9pZHMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLm9pZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIE92ZXJmbG93IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgIm92ZXJmbG93Iik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubGVhZGVyID0gYXR0cmlidXRlcy5sZWFkZXIgfHwgIiI7CiAgICB0aGlzLnRhcmdldCA9IGF0dHJpYnV0ZXMudGFyZ2V0IHx8ICIiOwogICAgdGhpcy50cmFpbGVyID0gYXR0cmlidXRlcy50cmFpbGVyIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCkgewogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgICAgY29uc3Qgcm9vdCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgICAgIGNvbnN0IHRhcmdldCA9IHJvb3RbX3hmYV9vYmplY3QuJHNlYXJjaE5vZGVdKHRoaXMudGFyZ2V0LCBwYXJlbnQpOwoKICAgICAgY29uc3QgbGVhZGVyID0gcm9vdFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0odGhpcy5sZWFkZXIsIHBhcmVudCk7CgogICAgICBjb25zdCB0cmFpbGVyID0gcm9vdFtfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0odGhpcy50cmFpbGVyLCBwYXJlbnQpOwoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICAgIHRhcmdldDogdGFyZ2V0ICYmIHRhcmdldFswXSB8fCBudWxsLAogICAgICAgIGxlYWRlcjogbGVhZGVyICYmIGxlYWRlclswXSB8fCBudWxsLAogICAgICAgIHRyYWlsZXI6IHRyYWlsZXIgJiYgdHJhaWxlclswXSB8fCBudWxsLAogICAgICAgIGFkZExlYWRlcjogZmFsc2UsCiAgICAgICAgYWRkVHJhaWxlcjogZmFsc2UKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogIH0KCn0KCmNsYXNzIFBhZ2VBcmVhIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBhZ2VBcmVhIiwgdHJ1ZSk7CiAgICB0aGlzLmJsYW5rT3JOb3RCbGFuayA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmJsYW5rT3JOb3RCbGFuaywgWyJhbnkiLCAiYmxhbmsiLCAibm90QmxhbmsiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMuaW5pdGlhbE51bWJlciA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmluaXRpYWxOdW1iZXIsCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLm51bWJlcmVkID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubnVtYmVyZWQsCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IHggPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLm9kZE9yRXZlbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm9kZE9yRXZlbiwgWyJhbnkiLCAiZXZlbiIsICJvZGQiXSk7CiAgICB0aGlzLnBhZ2VQb3NpdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnBhZ2VQb3NpdGlvbiwgWyJhbnkiLCAiZmlyc3QiLCAibGFzdCIsICJvbmx5IiwgInJlc3QiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWVkaXVtID0gbnVsbDsKICAgIHRoaXMub2NjdXIgPSBudWxsOwogICAgdGhpcy5hcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbnRlbnRBcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRyYXcgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhjbEdyb3VwID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmZpZWxkID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm0gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNVc2FibGVdKCkgewogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICAgIG51bWJlck9mVXNlOiAwCiAgICAgIH07CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiAhdGhpcy5vY2N1ciB8fCB0aGlzLm9jY3VyLm1heCA9PT0gLTEgfHwgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlck9mVXNlIDwgdGhpcy5vY2N1ci5tYXg7CiAgfQoKICBbX3hmYV9vYmplY3QuJGNsZWFuUGFnZV0oKSB7CiAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXROZXh0UGFnZV0oKSB7CiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgICAgbnVtYmVyT2ZVc2U6IDAKICAgICAgfTsKICAgIH0KCiAgICBjb25zdCBwYXJlbnQgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgaWYgKHBhcmVudC5yZWxhdGlvbiA9PT0gIm9yZGVyZWRPY2N1cnJlbmNlIikgewogICAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kaXNVc2FibGVdKCkpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVyT2ZVc2UgKz0gMTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwYXJlbnRbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRnZXRBdmFpbGFibGVTcGFjZV0oKSB7CiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnNwYWNlIHx8IHsKICAgICAgd2lkdGg6IDAsCiAgICAgIGhlaWdodDogMAogICAgfTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXSgpIHsKICAgIGlmICghdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgICBudW1iZXJPZlVzZTogMQogICAgICB9OwogICAgfQoKICAgIGNvbnN0IGNoaWxkcmVuID0gW107CiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY2hpbGRyZW4gPSBjaGlsZHJlbjsKICAgIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAodGhpcy5tZWRpdW0gJiYgdGhpcy5tZWRpdW0uc2hvcnQgJiYgdGhpcy5tZWRpdW0ubG9uZykgewogICAgICBzdHlsZS53aWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMubWVkaXVtLnNob3J0KTsKICAgICAgc3R5bGUuaGVpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5tZWRpdW0ubG9uZyk7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5zcGFjZSA9IHsKICAgICAgICB3aWR0aDogdGhpcy5tZWRpdW0uc2hvcnQsCiAgICAgICAgaGVpZ2h0OiB0aGlzLm1lZGl1bS5sb25nCiAgICAgIH07CgogICAgICBpZiAodGhpcy5tZWRpdW0ub3JpZW50YXRpb24gPT09ICJsYW5kc2NhcGUiKSB7CiAgICAgICAgY29uc3QgeCA9IHN0eWxlLndpZHRoOwogICAgICAgIHN0eWxlLndpZHRoID0gc3R5bGUuaGVpZ2h0OwogICAgICAgIHN0eWxlLmhlaWdodCA9IHg7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnNwYWNlID0gewogICAgICAgICAgd2lkdGg6IHRoaXMubWVkaXVtLmxvbmcsCiAgICAgICAgICBoZWlnaHQ6IHRoaXMubWVkaXVtLnNob3J0CiAgICAgICAgfTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBObyBtZWRpdW0gc3BlY2lmaWVkIGluIHBhZ2VBcmVhOiBwbGVhc2UgZmlsZSBhIGJ1Zy4iKTsKICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oewogICAgICBmaWx0ZXI6IG5ldyBTZXQoWyJhcmVhIiwgImRyYXciLCAiZmllbGQiLCAic3ViZm9ybSJdKSwKICAgICAgaW5jbHVkZTogdHJ1ZQogICAgfSk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHsKICAgICAgZmlsdGVyOiBuZXcgU2V0KFsiY29udGVudEFyZWEiXSksCiAgICAgIGluY2x1ZGU6IHRydWUKICAgIH0pOwoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogImRpdiIsCiAgICAgIGNoaWxkcmVuLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFsieGZhUGFnZSJdLAogICAgICAgIGlkOiB0aGlzW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgIHN0eWxlLAogICAgICAgIHhmYU5hbWU6IHRoaXMubmFtZQogICAgICB9CiAgICB9KTsKICB9Cgp9CgpjbGFzcyBQYWdlU2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBhZ2VTZXQiLCB0cnVlKTsKICAgIHRoaXMuZHVwbGV4SW1wb3NpdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmR1cGxleEltcG9zaXRpb24sIFsibG9uZ0VkZ2UiLCAic2hvcnRFZGdlIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJlbGF0aW9uID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucmVsYXRpb24sIFsib3JkZXJlZE9jY3VycmVuY2UiLCAiZHVwbGV4UGFnaW5hdGVkIiwgInNpbXBsZXhQYWdpbmF0ZWQiXSk7CiAgICB0aGlzLnJlbGV2YW50ID0gKDAsIF91dGlscy5nZXRSZWxldmFudCkoYXR0cmlidXRlcy5yZWxldmFudCk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5vY2N1ciA9IG51bGw7CiAgICB0aGlzLnBhZ2VBcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBhZ2VTZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kY2xlYW5QYWdlXSgpIHsKICAgIGZvciAoY29uc3QgcGFnZSBvZiB0aGlzLnBhZ2VBcmVhLmNoaWxkcmVuKSB7CiAgICAgIHBhZ2VbX3hmYV9vYmplY3QuJGNsZWFuUGFnZV0oKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IHBhZ2Ugb2YgdGhpcy5wYWdlU2V0LmNoaWxkcmVuKSB7CiAgICAgIHBhZ2VbX3hmYV9vYmplY3QuJGNsZWFuUGFnZV0oKTsKICAgIH0KICB9CgogIFtfeGZhX29iamVjdC4kaXNVc2FibGVdKCkgewogICAgcmV0dXJuICF0aGlzLm9jY3VyIHx8IHRoaXMub2NjdXIubWF4ID09PSAtMSB8fCB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVyT2ZVc2UgPCB0aGlzLm9jY3VyLm1heDsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCkgewogICAgaWYgKCF0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0pIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICAgIG51bWJlck9mVXNlOiAxLAogICAgICAgIHBhZ2VJbmRleDogLTEsCiAgICAgICAgcGFnZVNldEluZGV4OiAtMQogICAgICB9OwogICAgfQoKICAgIGlmICh0aGlzLnJlbGF0aW9uID09PSAib3JkZXJlZE9jY3VycmVuY2UiKSB7CiAgICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZUluZGV4ICsgMSA8IHRoaXMucGFnZUFyZWEuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VJbmRleCArPSAxOwogICAgICAgIGNvbnN0IHBhZ2VBcmVhID0gdGhpcy5wYWdlQXJlYS5jaGlsZHJlblt0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZUluZGV4XTsKICAgICAgICByZXR1cm4gcGFnZUFyZWFbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogICAgICB9CgogICAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VTZXRJbmRleCArIDEgPCB0aGlzLnBhZ2VTZXQuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VTZXRJbmRleCArPSAxOwogICAgICAgIHJldHVybiB0aGlzLnBhZ2VTZXQuY2hpbGRyZW5bdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VTZXRJbmRleF1bX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogICAgICB9CgogICAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kaXNVc2FibGVdKCkpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVyT2ZVc2UgKz0gMTsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ucGFnZUluZGV4ID0gLTE7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VTZXRJbmRleCA9IC0xOwogICAgICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRnZXROZXh0UGFnZV0oKTsKICAgICAgfQoKICAgICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIFBhZ2VTZXQpIHsKICAgICAgICByZXR1cm4gcGFyZW50W194ZmFfb2JqZWN0LiRnZXROZXh0UGFnZV0oKTsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kY2xlYW5QYWdlXSgpOwoKICAgICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGdldE5leHRQYWdlXSgpOwogICAgfQoKICAgIGNvbnN0IHBhZ2VOdW1iZXIgPSB0aGlzW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5wYWdlTnVtYmVyOwoKICAgIGNvbnN0IHBhcml0eSA9IHBhZ2VOdW1iZXIgJSAyID09PSAwID8gImV2ZW4iIDogIm9kZCI7CiAgICBjb25zdCBwb3NpdGlvbiA9IHBhZ2VOdW1iZXIgPT09IDAgPyAiZmlyc3QiIDogInJlc3QiOwogICAgbGV0IHBhZ2UgPSB0aGlzLnBhZ2VBcmVhLmNoaWxkcmVuLmZpbmQocCA9PiBwLm9kZE9yRXZlbiA9PT0gcGFyaXR5ICYmIHAucGFnZVBvc2l0aW9uID09PSBwb3NpdGlvbik7CgogICAgaWYgKHBhZ2UpIHsKICAgICAgcmV0dXJuIHBhZ2U7CiAgICB9CgogICAgcGFnZSA9IHRoaXMucGFnZUFyZWEuY2hpbGRyZW4uZmluZChwID0+IHAub2RkT3JFdmVuID09PSAiYW55IiAmJiBwLnBhZ2VQb3NpdGlvbiA9PT0gcG9zaXRpb24pOwoKICAgIGlmIChwYWdlKSB7CiAgICAgIHJldHVybiBwYWdlOwogICAgfQoKICAgIHBhZ2UgPSB0aGlzLnBhZ2VBcmVhLmNoaWxkcmVuLmZpbmQocCA9PiBwLm9kZE9yRXZlbiA9PT0gImFueSIgJiYgcC5wYWdlUG9zaXRpb24gPT09ICJhbnkiKTsKCiAgICBpZiAocGFnZSkgewogICAgICByZXR1cm4gcGFnZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5wYWdlQXJlYS5jaGlsZHJlblswXTsKICB9Cgp9CgpjbGFzcyBQYXJhIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBhcmEiLCB0cnVlKTsKICAgIHRoaXMuaEFsaWduID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaEFsaWduLCBbImxlZnQiLCAiY2VudGVyIiwgImp1c3RpZnkiLCAianVzdGlmeUFsbCIsICJyYWRpeCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5saW5lSGVpZ2h0ID0gYXR0cmlidXRlcy5saW5lSGVpZ2h0ID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5saW5lSGVpZ2h0LCAiMHB0IikgOiAiIjsKICAgIHRoaXMubWFyZ2luTGVmdCA9IGF0dHJpYnV0ZXMubWFyZ2luTGVmdCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWFyZ2luTGVmdCwgIjBwdCIpIDogIiI7CiAgICB0aGlzLm1hcmdpblJpZ2h0ID0gYXR0cmlidXRlcy5tYXJnaW5SaWdodCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWFyZ2luUmlnaHQsICIwcHQiKSA6ICIiOwogICAgdGhpcy5vcnBoYW5zID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMub3JwaGFucywKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID49IDAKICAgIH0pOwogICAgdGhpcy5wcmVzZXJ2ZSA9IGF0dHJpYnV0ZXMucHJlc2VydmUgfHwgIiI7CiAgICB0aGlzLnJhZGl4T2Zmc2V0ID0gYXR0cmlidXRlcy5yYWRpeE9mZnNldCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMucmFkaXhPZmZzZXQsICIwcHQiKSA6ICIiOwogICAgdGhpcy5zcGFjZUFib3ZlID0gYXR0cmlidXRlcy5zcGFjZUFib3ZlID8gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5zcGFjZUFib3ZlLCAiMHB0IikgOiAiIjsKICAgIHRoaXMuc3BhY2VCZWxvdyA9IGF0dHJpYnV0ZXMuc3BhY2VCZWxvdyA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuc3BhY2VCZWxvdywgIjBwdCIpIDogIiI7CiAgICB0aGlzLnRhYkRlZmF1bHQgPSBhdHRyaWJ1dGVzLnRhYkRlZmF1bHQgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh0aGlzLnRhYkRlZmF1bHQpIDogIiI7CiAgICB0aGlzLnRhYlN0b3BzID0gKGF0dHJpYnV0ZXMudGFiU3RvcHMgfHwgIiIpLnRyaW0oKS5zcGxpdCgvXHMrLykubWFwKCh4LCBpKSA9PiBpICUgMiA9PT0gMSA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHgpIDogeCk7CiAgICB0aGlzLnRleHRJbmRlbnQgPSBhdHRyaWJ1dGVzLnRleHRJbmRlbnQgPyAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLnRleHRJbmRlbnQsICIwcHQiKSA6ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudkFsaWduID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudkFsaWduLCBbInRvcCIsICJib3R0b20iLCAibWlkZGxlIl0pOwogICAgdGhpcy53aWRvd3MgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy53aWRvd3MsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMuaHlwaGVuYXRpb24gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIHsKICAgIGNvbnN0IHN0eWxlID0gKDAsIF9odG1sX3V0aWxzLnRvU3R5bGUpKHRoaXMsICJoQWxpZ24iKTsKCiAgICBpZiAodGhpcy5tYXJnaW5MZWZ0ICE9PSAiIikgewogICAgICBzdHlsZS5wYWRkaW5nTGVmdCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMubWFyZ2luTGVmdCk7CiAgICB9CgogICAgaWYgKHRoaXMubWFyZ2luUmlnaHQgIT09ICIiKSB7CiAgICAgIHN0eWxlLnBhZGRpbmdpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykodGhpcy5tYXJnaW5SaWdodCk7CiAgICB9CgogICAgaWYgKHRoaXMuc3BhY2VBYm92ZSAhPT0gIiIpIHsKICAgICAgc3R5bGUucGFkZGluZ1RvcCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuc3BhY2VBYm92ZSk7CiAgICB9CgogICAgaWYgKHRoaXMuc3BhY2VCZWxvdyAhPT0gIiIpIHsKICAgICAgc3R5bGUucGFkZGluZ0JvdHRvbSA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMuc3BhY2VCZWxvdyk7CiAgICB9CgogICAgaWYgKHRoaXMudGV4dEluZGVudCAhPT0gIiIpIHsKICAgICAgc3R5bGUudGV4dEluZGVudCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMudGV4dEluZGVudCk7CiAgICAgICgwLCBfaHRtbF91dGlscy5maXhUZXh0SW5kZW50KShzdHlsZSk7CiAgICB9CgogICAgaWYgKHRoaXMubGluZUhlaWdodCA+IDApIHsKICAgICAgc3R5bGUubGluZUhlaWdodCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMubGluZUhlaWdodCk7CiAgICB9CgogICAgaWYgKHRoaXMudGFiRGVmYXVsdCAhPT0gIiIpIHsKICAgICAgc3R5bGUudGFiU2l6ZSA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKHRoaXMudGFiRGVmYXVsdCk7CiAgICB9CgogICAgaWYgKHRoaXMudGFiU3RvcHMubGVuZ3RoID4gMCkge30KCiAgICBpZiAodGhpcy5oeXBoZW5hdGF0aW9uKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHRoaXMuaHlwaGVuYXRhdGlvbltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSk7CiAgICB9CgogICAgcmV0dXJuIHN0eWxlOwogIH0KCn0KCmNsYXNzIFBhc3N3b3JkRWRpdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJwYXNzd29yZEVkaXQiLCB0cnVlKTsKICAgIHRoaXMuaFNjcm9sbFBvbGljeSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhTY3JvbGxQb2xpY3ksIFsiYXV0byIsICJvZmYiLCAib24iXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucGFzc3dvcmRDaGFyID0gYXR0cmlidXRlcy5wYXNzd29yZENoYXIgfHwgIioiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBQYXR0ZXJuIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBhdHRlcm4iLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJjcm9zc0hhdGNoIiwgImNyb3NzRGlhZ29uYWwiLCAiZGlhZ29uYWxMZWZ0IiwgImRpYWdvbmFsUmlnaHQiLCAiaG9yaXpvbnRhbCIsICJ2ZXJ0aWNhbCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvbG9yID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oc3RhcnRDb2xvcikgewogICAgc3RhcnRDb2xvciA9IHN0YXJ0Q29sb3IgPyBzdGFydENvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIDogIiNGRkZGRkYiOwogICAgY29uc3QgZW5kQ29sb3IgPSB0aGlzLmNvbG9yID8gdGhpcy5jb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjMDAwMDAwIjsKICAgIGNvbnN0IHdpZHRoID0gNTsKICAgIGNvbnN0IGNtZCA9ICJyZXBlYXRpbmctbGluZWFyLWdyYWRpZW50IjsKICAgIGNvbnN0IGNvbG9ycyA9IGAke3N0YXJ0Q29sb3J9LCR7c3RhcnRDb2xvcn0gJHt3aWR0aH1weCwke2VuZENvbG9yfSAke3dpZHRofXB4LCR7ZW5kQ29sb3J9ICR7MiAqIHdpZHRofXB4YDsKCiAgICBzd2l0Y2ggKHRoaXMudHlwZSkgewogICAgICBjYXNlICJjcm9zc0hhdGNoIjoKICAgICAgICByZXR1cm4gYCR7Y21kfSh0byB0b3AsJHtjb2xvcnN9KSAke2NtZH0odG8gcmlnaHQsJHtjb2xvcnN9KWA7CgogICAgICBjYXNlICJjcm9zc0RpYWdvbmFsIjoKICAgICAgICByZXR1cm4gYCR7Y21kfSg0NWRlZywke2NvbG9yc30pICR7Y21kfSgtNDVkZWcsJHtjb2xvcnN9KWA7CgogICAgICBjYXNlICJkaWFnb25hbExlZnQiOgogICAgICAgIHJldHVybiBgJHtjbWR9KDQ1ZGVnLCR7Y29sb3JzfSlgOwoKICAgICAgY2FzZSAiZGlhZ29uYWxSaWdodCI6CiAgICAgICAgcmV0dXJuIGAke2NtZH0oLTQ1ZGVnLCR7Y29sb3JzfSlgOwoKICAgICAgY2FzZSAiaG9yaXpvbnRhbCI6CiAgICAgICAgcmV0dXJuIGAke2NtZH0odG8gdG9wLCR7Y29sb3JzfSlgOwoKICAgICAgY2FzZSAidmVydGljYWwiOgogICAgICAgIHJldHVybiBgJHtjbWR9KHRvIHJpZ2h0LCR7Y29sb3JzfSlgOwogICAgfQoKICAgIHJldHVybiAiIjsKICB9Cgp9CgpjbGFzcyBQaWN0dXJlIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInBpY3R1cmUiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBQcm90byBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJwcm90byIsIHRydWUpOwogICAgdGhpcy5hcHBlYXJhbmNlRmlsdGVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmFyYyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5hcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmFzc2lzdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5iYXJjb2RlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJpbmRJdGVtcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5ib29rZW5kID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJvb2xlYW4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYm9yZGVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJyZWFrID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJyZWFrQWZ0ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYnJlYWtCZWZvcmUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuYnV0dG9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNhbGN1bGF0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jYXB0aW9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNlcnRpZmljYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNlcnRpZmljYXRlcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jaGVja0J1dHRvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jaG9pY2VMaXN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbG9yID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbWIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuY29ubmVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jb250ZW50QXJlYSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5jb3JuZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlVGltZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kYXRlVGltZUVkaXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGVjaW1hbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWZhdWx0VWkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGVzYyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kaWdlc3RNZXRob2QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGlnZXN0TWV0aG9kcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kcmF3ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVkZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jb2RpbmcgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jb2RpbmdzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVuY3J5cHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jcnlwdERhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZW5jcnlwdGlvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5lbmNyeXB0aW9uTWV0aG9kID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVuY3J5cHRpb25NZXRob2RzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV2ZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmV4RGF0YSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leE9iamVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leGNsR3JvdXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZXhlY3V0ZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leHRyYXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmllbGQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmlsbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5maWx0ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmxvYXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZm9udCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5mb3JtYXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaGFuZGxlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5oeXBoZW5hdGlvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pbWFnZUVkaXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaW50ZWdlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5pc3N1ZXJzID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLml0ZW1zID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmtlZXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMua2V5VXNhZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubGluZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5saW5lYXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubG9ja0RvY3VtZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm1hbmlmZXN0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm1hcmdpbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5tZHAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubWVkaXVtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm1lc3NhZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubnVtZXJpY0VkaXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMub2NjdXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMub2lkID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLm9pZHMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMub3ZlcmZsb3cgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGFnZUFyZWEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGFnZVNldCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wYXJhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBhc3N3b3JkRWRpdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wYXR0ZXJuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBpY3R1cmUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucmFkaWFsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnJlYXNvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5yZWFzb25zID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnJlY3RhbmdsZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5yZWYgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2NyaXB0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNldFByb3BlcnR5ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNpZ25EYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNpZ25hdHVyZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zaWduaW5nID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNvbGlkID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNwZWFrID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN0aXBwbGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViZm9ybSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtU2V0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmplY3RETiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJqZWN0RE5zID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1Ym1pdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50ZXh0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRleHRFZGl0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGltZVN0YW1wID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRvb2xUaXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudHJhdmVyc2FsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnRyYXZlcnNlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnVpID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnZhbGlkYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnZhbHVlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnZhcmlhYmxlcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIFJhZGlhbCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJyYWRpYWwiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJ0b0VkZ2UiLCAidG9DZW50ZXIiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb2xvciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKHN0YXJ0Q29sb3IpIHsKICAgIHN0YXJ0Q29sb3IgPSBzdGFydENvbG9yID8gc3RhcnRDb2xvcltfeGZhX29iamVjdC4kdG9TdHlsZV0oKSA6ICIjRkZGRkZGIjsKICAgIGNvbnN0IGVuZENvbG9yID0gdGhpcy5jb2xvciA/IHRoaXMuY29sb3JbX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkgOiAiIzAwMDAwMCI7CiAgICBjb25zdCBjb2xvcnMgPSB0aGlzLnR5cGUgPT09ICJ0b0VkZ2UiID8gYCR7c3RhcnRDb2xvcn0sJHtlbmRDb2xvcn1gIDogYCR7ZW5kQ29sb3J9LCR7c3RhcnRDb2xvcn1gOwogICAgcmV0dXJuIGByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IGNlbnRlciwgJHtjb2xvcnN9KWA7CiAgfQoKfQoKY2xhc3MgUmVhc29uIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInJlYXNvbiIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFJlYXNvbnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAicmVhc29ucyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnR5cGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy50eXBlLCBbIm9wdGlvbmFsIiwgInJlcXVpcmVkIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMucmVhc29uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgUmVjdGFuZ2xlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInJlY3RhbmdsZSIsIHRydWUpOwogICAgdGhpcy5oYW5kID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaGFuZCwgWyJldmVuIiwgImxlZnQiLCAicmlnaHQiXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNvcm5lciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICAgIHRoaXMuZWRnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICAgIHRoaXMuZmlsbCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oKSB7CiAgICBjb25zdCBlZGdlID0gdGhpcy5lZGdlLmNoaWxkcmVuLmxlbmd0aCA/IHRoaXMuZWRnZS5jaGlsZHJlblswXSA6IG5ldyBFZGdlKHt9KTsKCiAgICBjb25zdCBlZGdlU3R5bGUgPSBlZGdlW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICBpZiAodGhpcy5maWxsICYmIHRoaXMuZmlsbC5wcmVzZW5jZSA9PT0gInZpc2libGUiKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIHRoaXMuZmlsbFtfeGZhX29iamVjdC4kdG9TdHlsZV0oKSk7CiAgICB9IGVsc2UgewogICAgICBzdHlsZS5maWxsID0gInRyYW5zcGFyZW50IjsKICAgIH0KCiAgICBzdHlsZS5zdHJva2VXaWR0aCA9ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKGVkZ2UucHJlc2VuY2UgPT09ICJ2aXNpYmxlIiA/IGVkZ2UudGhpY2tuZXNzIDogMCk7CiAgICBzdHlsZS5zdHJva2UgPSBlZGdlU3R5bGUuY29sb3I7CiAgICBjb25zdCBjb3JuZXIgPSB0aGlzLmNvcm5lci5jaGlsZHJlbi5sZW5ndGggPyB0aGlzLmNvcm5lci5jaGlsZHJlblswXSA6IG5ldyBDb3JuZXIoe30pOwoKICAgIGNvbnN0IGNvcm5lclN0eWxlID0gY29ybmVyW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgIGNvbnN0IHJlY3QgPSB7CiAgICAgIG5hbWU6ICJyZWN0IiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIHhtbG5zOiBTVkdfTlMsCiAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICBoZWlnaHQ6ICIxMDAlIiwKICAgICAgICB4OiAwLAogICAgICAgIHk6IDAsCiAgICAgICAgcng6IGNvcm5lclN0eWxlLnJhZGl1cywKICAgICAgICByeTogY29ybmVyU3R5bGUucmFkaXVzLAogICAgICAgIHN0eWxlCiAgICAgIH0KICAgIH07CiAgICBjb25zdCBzdmcgPSB7CiAgICAgIG5hbWU6ICJzdmciLAogICAgICBjaGlsZHJlbjogW3JlY3RdLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgeG1sbnM6IFNWR19OUywKICAgICAgICBzdHlsZTogewogICAgICAgICAgb3ZlcmZsb3c6ICJ2aXNpYmxlIgogICAgICAgIH0sCiAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICBoZWlnaHQ6ICIxMDAlIgogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGlmIChoYXNNYXJnaW4ocGFyZW50KSkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgICAgbmFtZTogImRpdiIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgZGlzcGxheTogImlubGluZSIsCiAgICAgICAgICAgIHdpZHRoOiAiMTAwJSIsCiAgICAgICAgICAgIGhlaWdodDogIjEwMCUiCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjaGlsZHJlbjogW3N2Z10KICAgICAgfSk7CiAgICB9CgogICAgc3ZnLmF0dHJpYnV0ZXMuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3Moc3ZnKTsKICB9Cgp9CgpjbGFzcyBSZWZFbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInJlZiIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFNjcmlwdCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzY3JpcHQiKTsKICAgIHRoaXMuYmluZGluZyA9IGF0dHJpYnV0ZXMuYmluZGluZyB8fCAiIjsKICAgIHRoaXMuY29udGVudFR5cGUgPSBhdHRyaWJ1dGVzLmNvbnRlbnRUeXBlIHx8ICIiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnJ1bkF0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucnVuQXQsIFsiY2xpZW50IiwgImJvdGgiLCAic2VydmVyIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBTZXRQcm9wZXJ0eSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzZXRQcm9wZXJ0eSIpOwogICAgdGhpcy5jb25uZWN0aW9uID0gYXR0cmlidXRlcy5jb25uZWN0aW9uIHx8ICIiOwogICAgdGhpcy5yZWYgPSBhdHRyaWJ1dGVzLnJlZiB8fCAiIjsKICAgIHRoaXMudGFyZ2V0ID0gYXR0cmlidXRlcy50YXJnZXQgfHwgIiI7CiAgfQoKfQoKZXhwb3J0cy5TZXRQcm9wZXJ0eSA9IFNldFByb3BlcnR5OwoKY2xhc3MgU2lnbkRhdGEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic2lnbkRhdGEiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vcGVyYXRpb24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5vcGVyYXRpb24sIFsic2lnbiIsICJjbGVhciIsICJ2ZXJpZnkiXSk7CiAgICB0aGlzLnJlZiA9IGF0dHJpYnV0ZXMucmVmIHx8ICIiOwogICAgdGhpcy50YXJnZXQgPSBhdHRyaWJ1dGVzLnRhcmdldCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmZpbHRlciA9IG51bGw7CiAgICB0aGlzLm1hbmlmZXN0ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBTaWduYXR1cmUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic2lnbmF0dXJlIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsiUERGMS4zIiwgIlBERjEuNiJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLmZpbHRlciA9IG51bGw7CiAgICB0aGlzLm1hbmlmZXN0ID0gbnVsbDsKICAgIHRoaXMubWFyZ2luID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBTaWduaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInNpZ25pbmciLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmNlcnRpZmljYXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgU29saWQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic29saWQiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICB9CgogIFtfeGZhX29iamVjdC4kdG9TdHlsZV0oc3RhcnRDb2xvcikgewogICAgcmV0dXJuIHN0YXJ0Q29sb3IgPyBzdGFydENvbG9yW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpIDogIiNGRkZGRkYiOwogIH0KCn0KCmNsYXNzIFNwZWFrIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInNwZWFrIik7CiAgICB0aGlzLmRpc2FibGUgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5kaXNhYmxlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnByaW9yaXR5ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJpb3JpdHksIFsiY3VzdG9tIiwgImNhcHRpb24iLCAibmFtZSIsICJ0b29sVGlwIl0pOwogICAgdGhpcy5yaWQgPSBhdHRyaWJ1dGVzLnJpZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgU3RpcHBsZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzdGlwcGxlIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMucmF0ZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLnJhdGUsCiAgICAgIGRlZmF1bHRWYWx1ZTogNTAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPj0gMCAmJiB4IDw9IDEwMAogICAgfSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5jb2xvciA9IG51bGw7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvU3R5bGVdKGJnQ29sb3IpIHsKICAgIGNvbnN0IGFscGhhID0gdGhpcy5yYXRlIC8gMTAwOwogICAgcmV0dXJuIF91dGlsLlV0aWwubWFrZUhleENvbG9yKE1hdGgucm91bmQoYmdDb2xvci52YWx1ZS5yICogKDEgLSBhbHBoYSkgKyB0aGlzLnZhbHVlLnIgKiBhbHBoYSksIE1hdGgucm91bmQoYmdDb2xvci52YWx1ZS5nICogKDEgLSBhbHBoYSkgKyB0aGlzLnZhbHVlLmcgKiBhbHBoYSksIE1hdGgucm91bmQoYmdDb2xvci52YWx1ZS5iICogKDEgLSBhbHBoYSkgKyB0aGlzLnZhbHVlLmIgKiBhbHBoYSkpOwogIH0KCn0KCmNsYXNzIFN1YmZvcm0gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAic3ViZm9ybSIsIHRydWUpOwogICAgdGhpcy5hY2Nlc3MgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5hY2Nlc3MsIFsib3BlbiIsICJub25JbnRlcmFjdGl2ZSIsICJwcm90ZWN0ZWQiLCAicmVhZE9ubHkiXSk7CiAgICB0aGlzLmFsbG93TWFjcm8gPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5hbGxvd01hY3JvLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5hbmNob3JUeXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuYW5jaG9yVHlwZSwgWyJ0b3BMZWZ0IiwgImJvdHRvbUNlbnRlciIsICJib3R0b21MZWZ0IiwgImJvdHRvbVJpZ2h0IiwgIm1pZGRsZUNlbnRlciIsICJtaWRkbGVMZWZ0IiwgIm1pZGRsZVJpZ2h0IiwgInRvcENlbnRlciIsICJ0b3BSaWdodCJdKTsKICAgIHRoaXMuY29sU3BhbiA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmNvbFNwYW4sCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IG4gPT4gbiA+PSAxIHx8IG4gPT09IC0xCiAgICB9KTsKICAgIHRoaXMuY29sdW1uV2lkdGhzID0gKGF0dHJpYnV0ZXMuY29sdW1uV2lkdGhzIHx8ICIiKS50cmltKCkuc3BsaXQoL1xzKy8pLm1hcCh4ID0+IHggPT09ICItMSIgPyAtMSA6ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHgpKTsKICAgIHRoaXMuaCA9IGF0dHJpYnV0ZXMuaCA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMuaCkgOiAiIjsKICAgIHRoaXMuaEFsaWduID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuaEFsaWduLCBbImxlZnQiLCAiY2VudGVyIiwgImp1c3RpZnkiLCAianVzdGlmeUFsbCIsICJyYWRpeCIsICJyaWdodCJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5sYXlvdXQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5sYXlvdXQsIFsicG9zaXRpb24iLCAibHItdGIiLCAicmwtcm93IiwgInJsLXRiIiwgInJvdyIsICJ0YWJsZSIsICJ0YiJdKTsKICAgIHRoaXMubG9jYWxlID0gYXR0cmlidXRlcy5sb2NhbGUgfHwgIiI7CiAgICB0aGlzLm1heEggPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KShhdHRyaWJ1dGVzLm1heEgsICIwcHQiKTsKICAgIHRoaXMubWF4VyA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWF4VywgIjBwdCIpOwogICAgdGhpcy5tZXJnZU1vZGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5tZXJnZU1vZGUsIFsiY29uc3VtZURhdGEiLCAibWF0Y2hUZW1wbGF0ZSJdKTsKICAgIHRoaXMubWluSCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMubWluSCwgIjBwdCIpOwogICAgdGhpcy5taW5XID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy5taW5XLCAiMHB0Iik7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnByZXNlbmNlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMucHJlc2VuY2UsIFsidmlzaWJsZSIsICJoaWRkZW4iLCAiaW5hY3RpdmUiLCAiaW52aXNpYmxlIl0pOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy5yZXN0b3JlU3RhdGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5yZXN0b3JlU3RhdGUsIFsibWFudWFsIiwgImF1dG8iXSk7CiAgICB0aGlzLnNjb3BlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuc2NvcGUsIFsibmFtZSIsICJub25lIl0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudyA9IGF0dHJpYnV0ZXMudyA/ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMudykgOiAiIjsKICAgIHRoaXMueCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKGF0dHJpYnV0ZXMueCwgIjBwdCIpOwogICAgdGhpcy55ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoYXR0cmlidXRlcy55LCAiMHB0Iik7CiAgICB0aGlzLmFzc2lzdCA9IG51bGw7CiAgICB0aGlzLmJpbmQgPSBudWxsOwogICAgdGhpcy5ib29rZW5kID0gbnVsbDsKICAgIHRoaXMuYm9yZGVyID0gbnVsbDsKICAgIHRoaXMuYnJlYWsgPSBudWxsOwogICAgdGhpcy5jYWxjdWxhdGUgPSBudWxsOwogICAgdGhpcy5kZXNjID0gbnVsbDsKICAgIHRoaXMuZXh0cmFzID0gbnVsbDsKICAgIHRoaXMua2VlcCA9IG51bGw7CiAgICB0aGlzLm1hcmdpbiA9IG51bGw7CiAgICB0aGlzLm9jY3VyID0gbnVsbDsKICAgIHRoaXMub3ZlcmZsb3cgPSBudWxsOwogICAgdGhpcy5wYWdlU2V0ID0gbnVsbDsKICAgIHRoaXMucGFyYSA9IG51bGw7CiAgICB0aGlzLnRyYXZlcnNhbCA9IG51bGw7CiAgICB0aGlzLnZhbGlkYXRlID0gbnVsbDsKICAgIHRoaXMudmFyaWFibGVzID0gbnVsbDsKICAgIHRoaXMuYXJlYSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5icmVha0FmdGVyID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmJyZWFrQmVmb3JlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmNvbm5lY3QgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZHJhdyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5ldmVudCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leE9iamVjdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leGNsR3JvdXAgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmllbGQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucHJvdG8gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc2V0UHJvcGVydHkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuc3ViZm9ybSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtU2V0ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBTdWJmb3JtU2V0KSB7CiAgICAgIHJldHVybiBwYXJlbnRbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CiAgICB9CgogICAgcmV0dXJuIHBhcmVudDsKICB9CgogIFtfeGZhX29iamVjdC4kaXNCaW5kYWJsZV0oKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKSB7CiAgICByZXR1cm4gdGhpcy5sYXlvdXQuZW5kc1dpdGgoIi10YiIpICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID09PSAwICYmIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgPiAwIHx8IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kaXNUaGVyZU1vcmVXaWR0aF0oKTsKICB9CgogICpbX3hmYV9vYmplY3QuJGdldENvbnRhaW5lZENoaWxkcmVuXSgpIHsKICAgIHlpZWxkKiBnZXRDb250YWluZWRDaGlsZHJlbih0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmx1c2hIVE1MXSgpIHsKICAgIHJldHVybiAoMCwgX2xheW91dC5mbHVzaEhUTUwpKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRhZGRIVE1MXShodG1sLCBiYm94KSB7CiAgICAoMCwgX2xheW91dC5hZGRIVE1MKSh0aGlzLCBodG1sLCBiYm94KTsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0QXZhaWxhYmxlU3BhY2VdKCkgewogICAgcmV0dXJuICgwLCBfbGF5b3V0LmdldEF2YWlsYWJsZVNwYWNlKSh0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNTcGxpdHRhYmxlXSgpIHsKICAgIGNvbnN0IHBhcmVudCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgaWYgKCFwYXJlbnRbX3hmYV9vYmplY3QuJGlzU3BsaXR0YWJsZV0oKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlOwogICAgfQoKICAgIGlmICh0aGlzLmxheW91dCA9PT0gInBvc2l0aW9uIiB8fCB0aGlzLmxheW91dC5pbmNsdWRlcygicm93IikpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLl9pc1NwbGl0dGFibGUgPSBmYWxzZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLmtlZXAgJiYgdGhpcy5rZWVwLmludGFjdCAhPT0gIm5vbmUiKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlID0gZmFsc2U7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAocGFyZW50LmxheW91dCAmJiBwYXJlbnQubGF5b3V0LmVuZHNXaXRoKCItdGIiKSAmJiBwYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXS5udW1iZXJJbkxpbmUgIT09IDApIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5faXNTcGxpdHRhYmxlID0gdHJ1ZTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBzZXRUYWJJbmRleCh0aGlzKTsKCiAgICBpZiAodGhpcy5icmVhaykgewogICAgICBpZiAodGhpcy5icmVhay5hZnRlciAhPT0gImF1dG8iIHx8IHRoaXMuYnJlYWsuYWZ0ZXJUYXJnZXQgIT09ICIiKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBCcmVha0FmdGVyKHsKICAgICAgICAgIHRhcmdldFR5cGU6IHRoaXMuYnJlYWsuYWZ0ZXIsCiAgICAgICAgICB0YXJnZXQ6IHRoaXMuYnJlYWsuYWZ0ZXJUYXJnZXQsCiAgICAgICAgICBzdGFydE5ldzogdGhpcy5icmVhay5zdGFydE5ldy50b1N0cmluZygpCiAgICAgICAgfSk7CiAgICAgICAgbm9kZVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0gPSB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXTsKCiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGUpOwoKICAgICAgICB0aGlzLmJyZWFrQWZ0ZXIucHVzaChub2RlKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYnJlYWsuYmVmb3JlICE9PSAiYXV0byIgfHwgdGhpcy5icmVhay5iZWZvcmVUYXJnZXQgIT09ICIiKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBCcmVha0JlZm9yZSh7CiAgICAgICAgICB0YXJnZXRUeXBlOiB0aGlzLmJyZWFrLmJlZm9yZSwKICAgICAgICAgIHRhcmdldDogdGhpcy5icmVhay5iZWZvcmVUYXJnZXQsCiAgICAgICAgICBzdGFydE5ldzogdGhpcy5icmVhay5zdGFydE5ldy50b1N0cmluZygpCiAgICAgICAgfSk7CiAgICAgICAgbm9kZVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0gPSB0aGlzW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXTsKCiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kYXBwZW5kQ2hpbGRdKG5vZGUpOwoKICAgICAgICB0aGlzLmJyZWFrQmVmb3JlLnB1c2gobm9kZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmJyZWFrLm92ZXJmbG93VGFyZ2V0ICE9PSAiIikgewogICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgT3ZlcmZsb3coewogICAgICAgICAgdGFyZ2V0OiB0aGlzLmJyZWFrLm92ZXJmbG93VGFyZ2V0LAogICAgICAgICAgbGVhZGVyOiB0aGlzLmJyZWFrLm92ZXJmbG93TGVhZGVyLAogICAgICAgICAgdHJhaWxlcjogdGhpcy5icmVhay5vdmVyZmxvd1RyYWlsZXIKICAgICAgICB9KTsKICAgICAgICBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXSA9IHRoaXNbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdOwoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0obm9kZSk7CgogICAgICAgIHRoaXMub3ZlcmZsb3cucHVzaChub2RlKTsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kcmVtb3ZlQ2hpbGRdKHRoaXMuYnJlYWspOwoKICAgICAgdGhpcy5icmVhayA9IG51bGw7CiAgICB9CgogICAgaWYgKHRoaXMucHJlc2VuY2UgPT09ICJoaWRkZW4iIHx8IHRoaXMucHJlc2VuY2UgPT09ICJpbmFjdGl2ZSIpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGlmICh0aGlzLmJyZWFrQmVmb3JlLmNoaWxkcmVuLmxlbmd0aCA+IDEgfHwgdGhpcy5icmVha0FmdGVyLmNoaWxkcmVuLmxlbmd0aCA+IDEpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTZXZlcmFsIGJyZWFrQmVmb3JlIG9yIGJyZWFrQWZ0ZXIgaW4gc3ViZm9ybXM6IHBsZWFzZSBmaWxlIGEgYnVnLiIpOwogICAgfQoKICAgIGlmICh0aGlzLmJyZWFrQmVmb3JlLmNoaWxkcmVuLmxlbmd0aCA+PSAxKSB7CiAgICAgIGNvbnN0IGJyZWFrQmVmb3JlID0gdGhpcy5icmVha0JlZm9yZS5jaGlsZHJlblswXTsKCiAgICAgIGlmIChoYW5kbGVCcmVhayhicmVha0JlZm9yZSkpIHsKICAgICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuYnJlYWtOb2RlKGJyZWFrQmVmb3JlKTsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmFmdGVyQnJlYWtBZnRlcikgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgKDAsIF9odG1sX3V0aWxzLmZpeERpbWVuc2lvbnMpKHRoaXMpOwogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7CiAgICAgIGlkOiB0aGlzW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICBjbGFzczogW10KICAgIH07CiAgICAoMCwgX2h0bWxfdXRpbHMuc2V0QWNjZXNzKSh0aGlzLCBhdHRyaWJ1dGVzLmNsYXNzKTsKCiAgICBpZiAoIXRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgfQoKICAgIE9iamVjdC5hc3NpZ24odGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLCB7CiAgICAgIGNoaWxkcmVuLAogICAgICBsaW5lOiBudWxsLAogICAgICBhdHRyaWJ1dGVzLAogICAgICBhdHRlbXB0OiAwLAogICAgICBudW1iZXJJbkxpbmU6IDAsCiAgICAgIGF2YWlsYWJsZVNwYWNlOiB7CiAgICAgICAgd2lkdGg6IE1hdGgubWluKHRoaXMudyB8fCBJbmZpbml0eSwgYXZhaWxhYmxlU3BhY2Uud2lkdGgpLAogICAgICAgIGhlaWdodDogTWF0aC5taW4odGhpcy5oIHx8IEluZmluaXR5LCBhdmFpbGFibGVTcGFjZS5oZWlnaHQpCiAgICAgIH0sCiAgICAgIHdpZHRoOiAwLAogICAgICBoZWlnaHQ6IDAsCiAgICAgIHByZXZIZWlnaHQ6IDAsCiAgICAgIGN1cnJlbnRXaWR0aDogMAogICAgfSk7CgogICAgY29uc3Qgcm9vdCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKTsKCiAgICBjb25zdCBzYXZlZE5vTGF5b3V0RmFpbHVyZSA9IHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmU7CgogICAgY29uc3QgaXNTcGxpdHRhYmxlID0gdGhpc1tfeGZhX29iamVjdC4kaXNTcGxpdHRhYmxlXSgpOwoKICAgIGlmICghaXNTcGxpdHRhYmxlKSB7CiAgICAgIHNldEZpcnN0VW5zcGxpdHRhYmxlKHRoaXMpOwogICAgfQoKICAgIGlmICghKDAsIF9sYXlvdXQuY2hlY2tEaW1lbnNpb25zKSh0aGlzLCBhdmFpbGFibGVTcGFjZSkpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICB9CgogICAgY29uc3QgZmlsdGVyID0gbmV3IFNldChbImFyZWEiLCAiZHJhdyIsICJleGNsR3JvdXAiLCAiZmllbGQiLCAic3ViZm9ybSIsICJzdWJmb3JtU2V0Il0pOwoKICAgIGlmICh0aGlzLmxheW91dC5pbmNsdWRlcygicm93IikpIHsKICAgICAgY29uc3QgY29sdW1uV2lkdGhzID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKS5jb2x1bW5XaWR0aHM7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2x1bW5XaWR0aHMpICYmIGNvbHVtbldpZHRocy5sZW5ndGggPiAwKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmNvbHVtbldpZHRocyA9IGNvbHVtbldpZHRoczsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uY3VycmVudENvbHVtbiA9IDA7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiYW5jaG9yVHlwZSIsICJkaW1lbnNpb25zIiwgInBvc2l0aW9uIiwgInByZXNlbmNlIiwgImJvcmRlciIsICJtYXJnaW4iLCAiaEFsaWduIik7CiAgICBjb25zdCBjbGFzc05hbWVzID0gWyJ4ZmFTdWJmb3JtIl07CiAgICBjb25zdCBjbCA9ICgwLCBfaHRtbF91dGlscy5sYXlvdXRDbGFzcykodGhpcyk7CgogICAgaWYgKGNsKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaChjbCk7CiAgICB9CgogICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlOwogICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzTmFtZXM7CgogICAgaWYgKHRoaXMubmFtZSkgewogICAgICBhdHRyaWJ1dGVzLnhmYU5hbWUgPSB0aGlzLm5hbWU7CiAgICB9CgogICAgaWYgKHRoaXMub3ZlcmZsb3cpIHsKICAgICAgY29uc3Qgb3ZlcmZsb3dFeHRyYSA9IHRoaXMub3ZlcmZsb3dbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwoKICAgICAgaWYgKG92ZXJmbG93RXh0cmEuYWRkTGVhZGVyKSB7CiAgICAgICAgb3ZlcmZsb3dFeHRyYS5hZGRMZWFkZXIgPSBmYWxzZTsKICAgICAgICBoYW5kbGVPdmVyZmxvdyh0aGlzLCBvdmVyZmxvd0V4dHJhLmxlYWRlciwgYXZhaWxhYmxlU3BhY2UpOwogICAgICB9CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcHVzaFBhcmFdKCk7CgogICAgY29uc3QgaXNMclRiID0gdGhpcy5sYXlvdXQgPT09ICJsci10YiIgfHwgdGhpcy5sYXlvdXQgPT09ICJybC10YiI7CiAgICBjb25zdCBtYXhSdW4gPSBpc0xyVGIgPyBNQVhfQVRURU1QVFNfRk9SX0xSVEJfTEFZT1VUIDogMTsKCiAgICBmb3IgKDsgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPCBtYXhSdW47IHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0KyspIHsKICAgICAgaWYgKGlzTHJUYiAmJiB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gTUFYX0FUVEVNUFRTX0ZPUl9MUlRCX0xBWU9VVCAtIDEpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID0gMDsKICAgICAgfQoKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHsKICAgICAgICBmaWx0ZXIsCiAgICAgICAgaW5jbHVkZTogdHJ1ZQogICAgICB9KTsKCiAgICAgIGlmIChyZXN1bHQuc3VjY2VzcykgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAocmVzdWx0LmlzQnJlYWsoKSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJHBvcFBhcmFdKCk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KCiAgICAgIGlmIChpc0xyVGIgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IDAgJiYgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm51bWJlckluTGluZSA9PT0gMCAmJiAhcm9vdFtfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSkgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5hdHRlbXB0ID0gbWF4UnVuOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kcG9wUGFyYV0oKTsKCiAgICBpZiAoIWlzU3BsaXR0YWJsZSkgewogICAgICB1bnNldEZpcnN0VW5zcGxpdHRhYmxlKHRoaXMpOwogICAgfQoKICAgIHJvb3RbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUgPSBzYXZlZE5vTGF5b3V0RmFpbHVyZTsKCiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgPT09IG1heFJ1bikgewogICAgICBpZiAodGhpcy5vdmVyZmxvdykgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLm92ZXJmbG93Tm9kZSA9IHRoaXMub3ZlcmZsb3c7CiAgICAgIH0KCiAgICAgIGlmICghaXNTcGxpdHRhYmxlKSB7CiAgICAgICAgZGVsZXRlIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXTsKICAgICAgfQoKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkZBSUxVUkU7CiAgICB9CgogICAgaWYgKHRoaXMub3ZlcmZsb3cpIHsKICAgICAgY29uc3Qgb3ZlcmZsb3dFeHRyYSA9IHRoaXMub3ZlcmZsb3dbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwoKICAgICAgaWYgKG92ZXJmbG93RXh0cmEuYWRkVHJhaWxlcikgewogICAgICAgIG92ZXJmbG93RXh0cmEuYWRkVHJhaWxlciA9IGZhbHNlOwogICAgICAgIGhhbmRsZU92ZXJmbG93KHRoaXMsIG92ZXJmbG93RXh0cmEudHJhaWxlciwgYXZhaWxhYmxlU3BhY2UpOwogICAgICB9CiAgICB9CgogICAgbGV0IG1hcmdpbkggPSAwOwogICAgbGV0IG1hcmdpblYgPSAwOwoKICAgIGlmICh0aGlzLm1hcmdpbikgewogICAgICBtYXJnaW5IID0gdGhpcy5tYXJnaW4ubGVmdEluc2V0ICsgdGhpcy5tYXJnaW4ucmlnaHRJbnNldDsKICAgICAgbWFyZ2luViA9IHRoaXMubWFyZ2luLnRvcEluc2V0ICsgdGhpcy5tYXJnaW4uYm90dG9tSW5zZXQ7CiAgICB9CgogICAgY29uc3Qgd2lkdGggPSBNYXRoLm1heCh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ud2lkdGggKyBtYXJnaW5ILCB0aGlzLncgfHwgMCk7CiAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1heCh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uaGVpZ2h0ICsgbWFyZ2luViwgdGhpcy5oIHx8IDApOwogICAgY29uc3QgYmJveCA9IFt0aGlzLngsIHRoaXMueSwgd2lkdGgsIGhlaWdodF07CgogICAgaWYgKHRoaXMudyA9PT0gIiIpIHsKICAgICAgc3R5bGUud2lkdGggPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSh3aWR0aCk7CiAgICB9CgogICAgaWYgKHRoaXMuaCA9PT0gIiIpIHsKICAgICAgc3R5bGUuaGVpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoaGVpZ2h0KTsKICAgIH0KCiAgICBpZiAoKHN0eWxlLndpZHRoID09PSAiMHB4IiB8fCBzdHlsZS5oZWlnaHQgPT09ICIwcHgiKSAmJiBjaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LkVNUFRZOwogICAgfQoKICAgIGNvbnN0IGh0bWwgPSB7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzLAogICAgICBjaGlsZHJlbgogICAgfTsKICAgIGFwcGx5QXNzaXN0KHRoaXMsIGF0dHJpYnV0ZXMpOwoKICAgIGNvbnN0IHJlc3VsdCA9IF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoKDAsIF9odG1sX3V0aWxzLmNyZWF0ZVdyYXBwZXIpKHRoaXMsIGh0bWwpLCBiYm94KTsKCiAgICBpZiAodGhpcy5icmVha0FmdGVyLmNoaWxkcmVuLmxlbmd0aCA+PSAxKSB7CiAgICAgIGNvbnN0IGJyZWFrQWZ0ZXIgPSB0aGlzLmJyZWFrQWZ0ZXIuY2hpbGRyZW5bMF07CgogICAgICBpZiAoaGFuZGxlQnJlYWsoYnJlYWtBZnRlcikpIHsKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0uYWZ0ZXJCcmVha0FmdGVyID0gcmVzdWx0OwogICAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5icmVha05vZGUoYnJlYWtBZnRlcik7CiAgICAgIH0KICAgIH0KCiAgICBkZWxldGUgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdOwogICAgcmV0dXJuIHJlc3VsdDsKICB9Cgp9CgpjbGFzcyBTdWJmb3JtU2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInN1YmZvcm1TZXQiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5yZWxhdGlvbiA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnJlbGF0aW9uLCBbIm9yZGVyZWQiLCAiY2hvaWNlIiwgInVub3JkZXJlZCJdKTsKICAgIHRoaXMucmVsZXZhbnQgPSAoMCwgX3V0aWxzLmdldFJlbGV2YW50KShhdHRyaWJ1dGVzLnJlbGV2YW50KTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmJvb2tlbmQgPSBudWxsOwogICAgdGhpcy5icmVhayA9IG51bGw7CiAgICB0aGlzLmRlc2MgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5vY2N1ciA9IG51bGw7CiAgICB0aGlzLm92ZXJmbG93ID0gbnVsbDsKICAgIHRoaXMuYnJlYWtBZnRlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5icmVha0JlZm9yZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnN1YmZvcm1TZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogICpbX3hmYV9vYmplY3QuJGdldENvbnRhaW5lZENoaWxkcmVuXSgpIHsKICAgIHlpZWxkKiBnZXRDb250YWluZWRDaGlsZHJlbih0aGlzKTsKICB9CgogIFtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKSB7CiAgICBsZXQgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIHdoaWxlICghKHBhcmVudCBpbnN0YW5jZW9mIFN1YmZvcm0pKSB7CiAgICAgIHBhcmVudCA9IHBhcmVudFtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwogICAgfQoKICAgIHJldHVybiBwYXJlbnQ7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzQmluZGFibGVdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY2xhc3MgU3ViamVjdEROIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzdWJqZWN0RE4iKTsKICAgIHRoaXMuZGVsaW1pdGVyID0gYXR0cmlidXRlcy5kZWxpbWl0ZXIgfHwgIiwiOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IG5ldyBNYXAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0uc3BsaXQodGhpcy5kZWxpbWl0ZXIpLm1hcChrdiA9PiB7CiAgICAgIGt2ID0ga3Yuc3BsaXQoIj0iLCAyKTsKICAgICAga3ZbMF0gPSBrdlswXS50cmltKCk7CiAgICAgIHJldHVybiBrdjsKICAgIH0pKTsKICB9Cgp9CgpjbGFzcyBTdWJqZWN0RE5zIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInN1YmplY3RETnMiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy50eXBlID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMudHlwZSwgWyJvcHRpb25hbCIsICJyZXF1aXJlZCJdKTsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLnN1YmplY3RETiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIFN1Ym1pdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJzdWJtaXQiLCB0cnVlKTsKICAgIHRoaXMuZW1iZWRQREYgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5lbWJlZFBERiwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuZm9ybWF0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZm9ybWF0LCBbInhkcCIsICJmb3JtZGF0YSIsICJwZGYiLCAidXJsZW5jb2RlZCIsICJ4ZmQiLCAieG1sIl0pOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnRhcmdldCA9IGF0dHJpYnV0ZXMudGFyZ2V0IHx8ICIiOwogICAgdGhpcy50ZXh0RW5jb2RpbmcgPSAoMCwgX3V0aWxzLmdldEtleXdvcmQpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy50ZXh0RW5jb2RpbmcgPyBhdHRyaWJ1dGVzLnRleHRFbmNvZGluZy50b0xvd2VyQ2FzZSgpIDogIiIsCiAgICAgIGRlZmF1bHRWYWx1ZTogIiIsCiAgICAgIHZhbGlkYXRlOiBrID0+IFsidXRmLTgiLCAiYmlnLWZpdmUiLCAiZm9udHNwZWNpZmljIiwgImdiayIsICJnYi0xODAzMCIsICJnYi0yMzEyIiwgImtzYy01NjAxIiwgIm5vbmUiLCAic2hpZnQtamlzIiwgInVjcy0yIiwgInV0Zi0xNiJdLmluY2x1ZGVzKGspIHx8IGsubWF0Y2goL2lzby04ODU5LVxkezJ9LykKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMueGRwQ29udGVudCA9IGF0dHJpYnV0ZXMueGRwQ29udGVudCB8fCAiIjsKICAgIHRoaXMuZW5jcnlwdCA9IG51bGw7CiAgICB0aGlzLmVuY3J5cHREYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnNpZ25EYXRhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidGVtcGxhdGUiLCB0cnVlKTsKICAgIHRoaXMuYmFzZVByb2ZpbGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5iYXNlUHJvZmlsZSwgWyJmdWxsIiwgImludGVyYWN0aXZlRm9ybXMiXSk7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLnN1YmZvcm0gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgaWYgKHRoaXMuc3ViZm9ybS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBObyBzdWJmb3JtcyBpbiB0ZW1wbGF0ZSBub2RlLiIpOwogICAgfQoKICAgIGlmICh0aGlzLnN1YmZvcm0uY2hpbGRyZW4ubGVuZ3RoID49IDIpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBTZXZlcmFsIHN1YmZvcm1zIGluIHRlbXBsYXRlIG5vZGU6IHBsZWFzZSBmaWxlIGEgYnVnLiIpOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJHRhYkluZGV4XSA9IERFRkFVTFRfVEFCX0lOREVYOwogIH0KCiAgW194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJHNlYXJjaE5vZGVdKGV4cHIsIGNvbnRhaW5lcikgewogICAgaWYgKGV4cHIuc3RhcnRzV2l0aCgiIyIpKSB7CiAgICAgIHJldHVybiBbdGhpc1tfeGZhX29iamVjdC4kaWRzXS5nZXQoZXhwci5zbGljZSgxKSldOwogICAgfQoKICAgIHJldHVybiAoMCwgX3NvbS5zZWFyY2hOb2RlKSh0aGlzLCBjb250YWluZXIsIGV4cHIsIHRydWUsIHRydWUpOwogIH0KCiAgKltfeGZhX29iamVjdC4kdG9QYWdlc10oKSB7CiAgICBpZiAoIXRoaXMuc3ViZm9ybS5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICAgIG5hbWU6ICJkaXYiLAogICAgICAgIGNoaWxkcmVuOiBbXQogICAgICB9KTsKICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPSB7CiAgICAgIG92ZXJmbG93Tm9kZTogbnVsbCwKICAgICAgZmlyc3RVbnNwbGl0dGFibGU6IG51bGwsCiAgICAgIGN1cnJlbnRDb250ZW50QXJlYTogbnVsbCwKICAgICAgY3VycmVudFBhZ2VBcmVhOiBudWxsLAogICAgICBub0xheW91dEZhaWx1cmU6IGZhbHNlLAogICAgICBwYWdlTnVtYmVyOiAxLAogICAgICBwYWdlUG9zaXRpb246ICJmaXJzdCIsCiAgICAgIG9kZE9yRXZlbjogIm9kZCIsCiAgICAgIGJsYW5rT3JOb3RCbGFuazogIm5vbkJsYW5rIiwKICAgICAgcGFyYVN0YWNrOiBbXQogICAgfTsKICAgIGNvbnN0IHJvb3QgPSB0aGlzLnN1YmZvcm0uY2hpbGRyZW5bMF07CgogICAgcm9vdC5wYWdlU2V0W194ZmFfb2JqZWN0LiRjbGVhblBhZ2VdKCk7CgogICAgY29uc3QgcGFnZUFyZWFzID0gcm9vdC5wYWdlU2V0LnBhZ2VBcmVhLmNoaWxkcmVuOwogICAgY29uc3QgbWFpbkh0bWwgPSB7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBjaGlsZHJlbjogW10KICAgIH07CiAgICBsZXQgcGFnZUFyZWEgPSBudWxsOwogICAgbGV0IGJyZWFrQmVmb3JlID0gbnVsbDsKICAgIGxldCBicmVha0JlZm9yZVRhcmdldCA9IG51bGw7CgogICAgaWYgKHJvb3QuYnJlYWtCZWZvcmUuY2hpbGRyZW4ubGVuZ3RoID49IDEpIHsKICAgICAgYnJlYWtCZWZvcmUgPSByb290LmJyZWFrQmVmb3JlLmNoaWxkcmVuWzBdOwogICAgICBicmVha0JlZm9yZVRhcmdldCA9IGJyZWFrQmVmb3JlLnRhcmdldDsKICAgIH0gZWxzZSBpZiAocm9vdC5zdWJmb3JtLmNoaWxkcmVuLmxlbmd0aCA+PSAxICYmIHJvb3Quc3ViZm9ybS5jaGlsZHJlblswXS5icmVha0JlZm9yZS5jaGlsZHJlbi5sZW5ndGggPj0gMSkgewogICAgICBicmVha0JlZm9yZSA9IHJvb3Quc3ViZm9ybS5jaGlsZHJlblswXS5icmVha0JlZm9yZS5jaGlsZHJlblswXTsKICAgICAgYnJlYWtCZWZvcmVUYXJnZXQgPSBicmVha0JlZm9yZS50YXJnZXQ7CiAgICB9IGVsc2UgaWYgKHJvb3QuYnJlYWsgJiYgcm9vdC5icmVhay5iZWZvcmVUYXJnZXQpIHsKICAgICAgYnJlYWtCZWZvcmUgPSByb290LmJyZWFrOwogICAgICBicmVha0JlZm9yZVRhcmdldCA9IGJyZWFrQmVmb3JlLmJlZm9yZVRhcmdldDsKICAgIH0gZWxzZSBpZiAocm9vdC5zdWJmb3JtLmNoaWxkcmVuLmxlbmd0aCA+PSAxICYmIHJvb3Quc3ViZm9ybS5jaGlsZHJlblswXS5icmVhayAmJiByb290LnN1YmZvcm0uY2hpbGRyZW5bMF0uYnJlYWsuYmVmb3JlVGFyZ2V0KSB7CiAgICAgIGJyZWFrQmVmb3JlID0gcm9vdC5zdWJmb3JtLmNoaWxkcmVuWzBdLmJyZWFrOwogICAgICBicmVha0JlZm9yZVRhcmdldCA9IGJyZWFrQmVmb3JlLmJlZm9yZVRhcmdldDsKICAgIH0KCiAgICBpZiAoYnJlYWtCZWZvcmUpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpc1tfeGZhX29iamVjdC4kc2VhcmNoTm9kZV0oYnJlYWtCZWZvcmVUYXJnZXQsIGJyZWFrQmVmb3JlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCkpOwoKICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIFBhZ2VBcmVhKSB7CiAgICAgICAgcGFnZUFyZWEgPSB0YXJnZXQ7CiAgICAgICAgYnJlYWtCZWZvcmVbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHt9OwogICAgICB9CiAgICB9CgogICAgaWYgKCFwYWdlQXJlYSkgewogICAgICBwYWdlQXJlYSA9IHBhZ2VBcmVhc1swXTsKICAgIH0KCiAgICBwYWdlQXJlYVtfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICBudW1iZXJPZlVzZTogMQogICAgfTsKCiAgICBjb25zdCBwYWdlQXJlYVBhcmVudCA9IHBhZ2VBcmVhW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CgogICAgcGFnZUFyZWFQYXJlbnRbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgbnVtYmVyT2ZVc2U6IDEsCiAgICAgIHBhZ2VJbmRleDogcGFnZUFyZWFQYXJlbnQucGFnZUFyZWEuY2hpbGRyZW4uaW5kZXhPZihwYWdlQXJlYSksCiAgICAgIHBhZ2VTZXRJbmRleDogMAogICAgfTsKICAgIGxldCB0YXJnZXRQYWdlQXJlYTsKICAgIGxldCBsZWFkZXIgPSBudWxsOwogICAgbGV0IHRyYWlsZXIgPSBudWxsOwogICAgbGV0IGhhc1NvbWV0aGluZyA9IHRydWU7CiAgICBsZXQgaGFzU29tZXRoaW5nQ291bnRlciA9IDA7CiAgICBsZXQgc3RhcnRJbmRleCA9IDA7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgaWYgKCFoYXNTb21ldGhpbmcpIHsKICAgICAgICBtYWluSHRtbC5jaGlsZHJlbi5wb3AoKTsKCiAgICAgICAgaWYgKCsraGFzU29tZXRoaW5nQ291bnRlciA9PT0gTUFYX0VNUFRZX1BBR0VTKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlhGQSAtIFNvbWV0aGluZyBnb2VzIHdyb25nOiBwbGVhc2UgZmlsZSBhIGJ1Zy4iKTsKICAgICAgICAgIHJldHVybiBtYWluSHRtbDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaGFzU29tZXRoaW5nQ291bnRlciA9IDA7CiAgICAgIH0KCiAgICAgIHRhcmdldFBhZ2VBcmVhID0gbnVsbDsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLmN1cnJlbnRQYWdlQXJlYSA9IHBhZ2VBcmVhOwoKICAgICAgY29uc3QgcGFnZSA9IHBhZ2VBcmVhW194ZmFfb2JqZWN0LiR0b0hUTUxdKCkuaHRtbDsKCiAgICAgIG1haW5IdG1sLmNoaWxkcmVuLnB1c2gocGFnZSk7CgogICAgICBpZiAobGVhZGVyKSB7CiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm5vTGF5b3V0RmFpbHVyZSA9IHRydWU7CiAgICAgICAgcGFnZS5jaGlsZHJlbi5wdXNoKGxlYWRlcltfeGZhX29iamVjdC4kdG9IVE1MXShwYWdlQXJlYVtfeGZhX29iamVjdC4kZXh0cmFdLnNwYWNlKS5odG1sKTsKICAgICAgICBsZWFkZXIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAodHJhaWxlcikgewogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUgPSB0cnVlOwogICAgICAgIHBhZ2UuY2hpbGRyZW4ucHVzaCh0cmFpbGVyW194ZmFfb2JqZWN0LiR0b0hUTUxdKHBhZ2VBcmVhW194ZmFfb2JqZWN0LiRleHRyYV0uc3BhY2UpLmh0bWwpOwogICAgICAgIHRyYWlsZXIgPSBudWxsOwogICAgICB9CgogICAgICBjb25zdCBjb250ZW50QXJlYXMgPSBwYWdlQXJlYS5jb250ZW50QXJlYS5jaGlsZHJlbjsKICAgICAgY29uc3QgaHRtbENvbnRlbnRBcmVhcyA9IHBhZ2UuY2hpbGRyZW4uZmlsdGVyKG5vZGUgPT4gbm9kZS5hdHRyaWJ1dGVzLmNsYXNzLmluY2x1ZGVzKCJ4ZmFDb250ZW50YXJlYSIpKTsKICAgICAgaGFzU29tZXRoaW5nID0gZmFsc2U7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5maXJzdFVuc3BsaXR0YWJsZSA9IG51bGw7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUgPSBmYWxzZTsKCiAgICAgIGNvbnN0IGZsdXNoID0gaW5kZXggPT4gewogICAgICAgIGNvbnN0IGh0bWwgPSByb290W194ZmFfb2JqZWN0LiRmbHVzaEhUTUxdKCk7CgogICAgICAgIGlmIChodG1sKSB7CiAgICAgICAgICBoYXNTb21ldGhpbmcgPSBoYXNTb21ldGhpbmcgfHwgaHRtbC5jaGlsZHJlbiAmJiBodG1sLmNoaWxkcmVuLmxlbmd0aCAhPT0gMDsKICAgICAgICAgIGh0bWxDb250ZW50QXJlYXNbaW5kZXhdLmNoaWxkcmVuLnB1c2goaHRtbCk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXgsIGlpID0gY29udGVudEFyZWFzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50Q29udGVudEFyZWEgPSBjb250ZW50QXJlYXNbaV07CiAgICAgICAgY29uc3Qgc3BhY2UgPSB7CiAgICAgICAgICB3aWR0aDogY29udGVudEFyZWEudywKICAgICAgICAgIGhlaWdodDogY29udGVudEFyZWEuaAogICAgICAgIH07CiAgICAgICAgc3RhcnRJbmRleCA9IDA7CgogICAgICAgIGlmIChsZWFkZXIpIHsKICAgICAgICAgIGh0bWxDb250ZW50QXJlYXNbaV0uY2hpbGRyZW4ucHVzaChsZWFkZXJbX3hmYV9vYmplY3QuJHRvSFRNTF0oc3BhY2UpLmh0bWwpOwogICAgICAgICAgbGVhZGVyID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICh0cmFpbGVyKSB7CiAgICAgICAgICBodG1sQ29udGVudEFyZWFzW2ldLmNoaWxkcmVuLnB1c2godHJhaWxlcltfeGZhX29iamVjdC4kdG9IVE1MXShzcGFjZSkuaHRtbCk7CiAgICAgICAgICB0cmFpbGVyID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGh0bWwgPSByb290W194ZmFfb2JqZWN0LiR0b0hUTUxdKHNwYWNlKTsKCiAgICAgICAgaWYgKGh0bWwuc3VjY2VzcykgewogICAgICAgICAgaWYgKGh0bWwuaHRtbCkgewogICAgICAgICAgICBoYXNTb21ldGhpbmcgPSBoYXNTb21ldGhpbmcgfHwgaHRtbC5odG1sLmNoaWxkcmVuICYmIGh0bWwuaHRtbC5jaGlsZHJlbi5sZW5ndGggIT09IDA7CiAgICAgICAgICAgIGh0bWxDb250ZW50QXJlYXNbaV0uY2hpbGRyZW4ucHVzaChodG1sLmh0bWwpOwogICAgICAgICAgfSBlbHNlIGlmICghaGFzU29tZXRoaW5nICYmIG1haW5IdG1sLmNoaWxkcmVuLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgbWFpbkh0bWwuY2hpbGRyZW4ucG9wKCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG1haW5IdG1sOwogICAgICAgIH0KCiAgICAgICAgaWYgKGh0bWwuaXNCcmVhaygpKSB7CiAgICAgICAgICBjb25zdCBub2RlID0gaHRtbC5icmVha05vZGU7CiAgICAgICAgICBmbHVzaChpKTsKCiAgICAgICAgICBpZiAobm9kZS50YXJnZXRUeXBlID09PSAiYXV0byIpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG5vZGUubGVhZGVyKSB7CiAgICAgICAgICAgIGxlYWRlciA9IHRoaXNbX3hmYV9vYmplY3QuJHNlYXJjaE5vZGVdKG5vZGUubGVhZGVyLCBub2RlW194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCkpOwogICAgICAgICAgICBsZWFkZXIgPSBsZWFkZXIgPyBsZWFkZXJbMF0gOiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChub2RlLnRyYWlsZXIpIHsKICAgICAgICAgICAgdHJhaWxlciA9IHRoaXNbX3hmYV9vYmplY3QuJHNlYXJjaE5vZGVdKG5vZGUudHJhaWxlciwgbm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpKTsKICAgICAgICAgICAgdHJhaWxlciA9IHRyYWlsZXIgPyB0cmFpbGVyWzBdIDogbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobm9kZS50YXJnZXRUeXBlID09PSAicGFnZUFyZWEiKSB7CiAgICAgICAgICAgIHRhcmdldFBhZ2VBcmVhID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLnRhcmdldDsKICAgICAgICAgICAgaSA9IEluZmluaXR5OwogICAgICAgICAgfSBlbHNlIGlmICghbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLnRhcmdldCkgewogICAgICAgICAgICBpID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmluZGV4OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGFyZ2V0UGFnZUFyZWEgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0udGFyZ2V0OwogICAgICAgICAgICBzdGFydEluZGV4ID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmluZGV4ICsgMTsKICAgICAgICAgICAgaSA9IEluZmluaXR5OwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXS5vdmVyZmxvd05vZGUpIHsKICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0ub3ZlcmZsb3dOb2RlOwogICAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLm92ZXJmbG93Tm9kZSA9IG51bGw7CgogICAgICAgICAgY29uc3Qgb3ZlcmZsb3dFeHRyYSA9IG5vZGVbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpOwoKICAgICAgICAgIGNvbnN0IHRhcmdldCA9IG92ZXJmbG93RXh0cmEudGFyZ2V0OwogICAgICAgICAgb3ZlcmZsb3dFeHRyYS5hZGRMZWFkZXIgPSBvdmVyZmxvd0V4dHJhLmxlYWRlciAhPT0gbnVsbDsKICAgICAgICAgIG92ZXJmbG93RXh0cmEuYWRkVHJhaWxlciA9IG92ZXJmbG93RXh0cmEudHJhaWxlciAhPT0gbnVsbDsKICAgICAgICAgIGZsdXNoKGkpOwogICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gaTsKICAgICAgICAgIGkgPSBJbmZpbml0eTsKCiAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgUGFnZUFyZWEpIHsKICAgICAgICAgICAgdGFyZ2V0UGFnZUFyZWEgPSB0YXJnZXQ7CiAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIENvbnRlbnRBcmVhKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY29udGVudEFyZWFzLmluZGV4T2YodGFyZ2V0KTsKCiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgICBpZiAoaW5kZXggPiBjdXJyZW50SW5kZXgpIHsKICAgICAgICAgICAgICAgIGkgPSBpbmRleCAtIDE7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXggPSBpbmRleDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGFyZ2V0UGFnZUFyZWEgPSB0YXJnZXRbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKTsKICAgICAgICAgICAgICBzdGFydEluZGV4ID0gdGFyZ2V0UGFnZUFyZWEuY29udGVudEFyZWEuY2hpbGRyZW4uaW5kZXhPZih0YXJnZXQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBmbHVzaChpKTsKICAgICAgfQoKICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdLnBhZ2VOdW1iZXIgKz0gMTsKCiAgICAgIGlmICh0YXJnZXRQYWdlQXJlYSkgewogICAgICAgIGlmICh0YXJnZXRQYWdlQXJlYVtfeGZhX29iamVjdC4kaXNVc2FibGVdKCkpIHsKICAgICAgICAgIHRhcmdldFBhZ2VBcmVhW194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVyT2ZVc2UgKz0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGFyZ2V0UGFnZUFyZWEgPSBudWxsOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcGFnZUFyZWEgPSB0YXJnZXRQYWdlQXJlYSB8fCBwYWdlQXJlYVtfeGZhX29iamVjdC4kZ2V0TmV4dFBhZ2VdKCk7CiAgICAgIHlpZWxkIG51bGw7CiAgICB9CiAgfQoKfQoKZXhwb3J0cy5UZW1wbGF0ZSA9IFRlbXBsYXRlOwoKY2xhc3MgVGV4dCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidGV4dCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLm1heENoYXJzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubWF4Q2hhcnMsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA+PSAwCiAgICB9KTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucmlkID0gYXR0cmlidXRlcy5yaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCiAgW194ZmFfb2JqZWN0LiRhY2NlcHRXaGl0ZXNwYWNlXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvbkNoaWxkXShjaGlsZCkgewogICAgaWYgKGNoaWxkW194ZmFfb2JqZWN0LiRuYW1lc3BhY2VJZF0gPT09IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy54aHRtbC5pZCkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IGNoaWxkOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoYFhGQSAtIEludmFsaWQgY29udGVudCBpbiBUZXh0OiAke2NoaWxkW194ZmFfb2JqZWN0LiRub2RlTmFtZV19LmApOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvblRleHRdKHN0cikgewogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzdXBlcltfeGZhX29iamVjdC4kb25UZXh0XShzdHIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBpZiAodHlwZW9mIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID09PSAic3RyaW5nIikgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnJlcGxhY2UoL1xyXG4vZywgIlxuIik7CiAgICB9CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpIHsKICAgIGlmICh0eXBlb2YgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09ICJzdHJpbmciKSB7CiAgICAgIHJldHVybiB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS5zcGxpdCgvW1x1MjAyOVx1MjAyOFxuXS8pLnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7CiAgICAgICAgaWYgKGxpbmUpIHsKICAgICAgICAgIGFjYy5wdXNoKGxpbmUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgfSwgW10pLmpvaW4oIlxuIik7CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdW194ZmFfb2JqZWN0LiR0ZXh0XSgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBpZiAodHlwZW9mIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID09PSAic3RyaW5nIikgewogICAgICBjb25zdCBodG1sID0gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pLmh0bWw7CgogICAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0uaW5jbHVkZXMoIlx1MjAyOSIpKSB7CiAgICAgICAgaHRtbC5uYW1lID0gImRpdiI7CiAgICAgICAgaHRtbC5jaGlsZHJlbiA9IFtdOwoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS5zcGxpdCgiXHUyMDI5IikubWFwKHBhcmEgPT4gcGFyYS5zcGxpdCgvW1x1MjAyOFxuXS8pLnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7CiAgICAgICAgICBhY2MucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJzcGFuIiwKICAgICAgICAgICAgdmFsdWU6IGxpbmUKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbmFtZTogImJyIgogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0sIFtdKSkuZm9yRWFjaChsaW5lcyA9PiB7CiAgICAgICAgICBodG1sLmNoaWxkcmVuLnB1c2goewogICAgICAgICAgICBuYW1lOiAicCIsCiAgICAgICAgICAgIGNoaWxkcmVuOiBsaW5lcwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoL1tcdTIwMjhcbl0vLnRlc3QodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0pKSB7CiAgICAgICAgaHRtbC5uYW1lID0gImRpdiI7CiAgICAgICAgaHRtbC5jaGlsZHJlbiA9IFtdOwoKICAgICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS5zcGxpdCgvW1x1MjAyOFxuXS8pLmZvckVhY2gobGluZSA9PiB7CiAgICAgICAgICBodG1sLmNoaWxkcmVuLnB1c2goewogICAgICAgICAgICBuYW1lOiAic3BhbiIsCiAgICAgICAgICAgIHZhbHVlOiBsaW5lCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIG5hbWU6ICJiciIKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhodG1sKTsKICAgIH0KCiAgICByZXR1cm4gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF1bX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpOwogIH0KCn0KCmV4cG9ydHMuVGV4dCA9IFRleHQ7CgpjbGFzcyBUZXh0RWRpdCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0ZXh0RWRpdCIsIHRydWUpOwogICAgdGhpcy5hbGxvd1JpY2hUZXh0ID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuYWxsb3dSaWNoVGV4dCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAxCiAgICB9KTsKICAgIHRoaXMuaFNjcm9sbFBvbGljeSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmhTY3JvbGxQb2xpY3ksIFsiYXV0byIsICJvZmYiLCAib24iXSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubXVsdGlMaW5lID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubXVsdGlMaW5lLAogICAgICBkZWZhdWx0VmFsdWU6ICIiLAogICAgICB2YWxpZGF0ZTogeCA9PiB4ID09PSAwIHx8IHggPT09IDEKICAgIH0pOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMudlNjcm9sbFBvbGljeSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnZTY3JvbGxQb2xpY3ksIFsiYXV0byIsICJvZmYiLCAib24iXSk7CiAgICB0aGlzLmJvcmRlciA9IG51bGw7CiAgICB0aGlzLmNvbWIgPSBudWxsOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tYXJnaW4gPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBzdHlsZSA9ICgwLCBfaHRtbF91dGlscy50b1N0eWxlKSh0aGlzLCAiYm9yZGVyIiwgImZvbnQiLCAibWFyZ2luIik7CiAgICBsZXQgaHRtbDsKCiAgICBjb25zdCBmaWVsZCA9IHRoaXNbX3hmYV9vYmplY3QuJGdldFBhcmVudF0oKVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGlmICh0aGlzLm11bHRpTGluZSA9PT0gIiIpIHsKICAgICAgdGhpcy5tdWx0aUxpbmUgPSBmaWVsZCBpbnN0YW5jZW9mIERyYXcgPyAxIDogMDsKICAgIH0KCiAgICBpZiAodGhpcy5tdWx0aUxpbmUgPT09IDEpIHsKICAgICAgaHRtbCA9IHsKICAgICAgICBuYW1lOiAidGV4dGFyZWEiLAogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGRhdGFJZDogZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdICYmIGZpZWxkW194ZmFfb2JqZWN0LiRkYXRhXVtfeGZhX29iamVjdC4kdWlkXSB8fCBmaWVsZFtfeGZhX29iamVjdC4kdWlkXSwKICAgICAgICAgIGZpZWxkSWQ6IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgICAgY2xhc3M6IFsieGZhVGV4dGZpZWxkIl0sCiAgICAgICAgICBzdHlsZSwKICAgICAgICAgICJhcmlhLWxhYmVsIjogYXJpYUxhYmVsKGZpZWxkKSwKICAgICAgICAgICJhcmlhLXJlcXVpcmVkIjogZmFsc2UKICAgICAgICB9CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBodG1sID0gewogICAgICAgIG5hbWU6ICJpbnB1dCIsCiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgZGF0YUlkOiBmaWVsZFtfeGZhX29iamVjdC4kZGF0YV0gJiYgZmllbGRbX3hmYV9vYmplY3QuJGRhdGFdW194ZmFfb2JqZWN0LiR1aWRdIHx8IGZpZWxkW194ZmFfb2JqZWN0LiR1aWRdLAogICAgICAgICAgZmllbGRJZDogZmllbGRbX3hmYV9vYmplY3QuJHVpZF0sCiAgICAgICAgICBjbGFzczogWyJ4ZmFUZXh0ZmllbGQiXSwKICAgICAgICAgIHN0eWxlLAogICAgICAgICAgImFyaWEtbGFiZWwiOiBhcmlhTGFiZWwoZmllbGQpLAogICAgICAgICAgImFyaWEtcmVxdWlyZWQiOiBmYWxzZQogICAgICAgIH0KICAgICAgfTsKICAgIH0KCiAgICBpZiAoaXNSZXF1aXJlZChmaWVsZCkpIHsKICAgICAgaHRtbC5hdHRyaWJ1dGVzWyJhcmlhLXJlcXVpcmVkIl0gPSB0cnVlOwogICAgICBodG1sLmF0dHJpYnV0ZXMucmVxdWlyZWQgPSB0cnVlOwogICAgfQoKICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgbmFtZTogImxhYmVsIiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBbInhmYUxhYmVsIl0KICAgICAgfSwKICAgICAgY2hpbGRyZW46IFtodG1sXQogICAgfSk7CiAgfQoKfQoKY2xhc3MgVGltZSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0aW1lIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIGNvbnN0IGRhdGUgPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCk7CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBkYXRlID8gbmV3IERhdGUoZGF0ZSkgOiBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gdmFsdWVUb0h0bWwodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPyB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50b1N0cmluZygpIDogIiIpOwogIH0KCn0KCmNsYXNzIFRpbWVTdGFtcCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoVEVNUExBVEVfTlNfSUQsICJ0aW1lU3RhbXAiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5zZXJ2ZXIgPSBhdHRyaWJ1dGVzLnNlcnZlciB8fCAiIjsKICAgIHRoaXMudHlwZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnR5cGUsIFsib3B0aW9uYWwiLCAicmVxdWlyZWQiXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFRvb2xUaXAgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidG9vbFRpcCIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnJpZCA9IGF0dHJpYnV0ZXMucmlkIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBUcmF2ZXJzYWwgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidHJhdmVyc2FsIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLnRyYXZlcnNlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgVHJhdmVyc2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidHJhdmVyc2UiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vcGVyYXRpb24gPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5vcGVyYXRpb24sIFsibmV4dCIsICJiYWNrIiwgImRvd24iLCAiZmlyc3QiLCAibGVmdCIsICJyaWdodCIsICJ1cCJdKTsKICAgIHRoaXMucmVmID0gYXR0cmlidXRlcy5yZWYgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogIH0KCiAgZ2V0IG5hbWUoKSB7CiAgICByZXR1cm4gdGhpcy5vcGVyYXRpb247CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzVHJhbnNwYXJlbnRdKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCn0KCmNsYXNzIFVpIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInVpIiwgdHJ1ZSk7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgICB0aGlzLmV4dHJhcyA9IG51bGw7CiAgICB0aGlzLnBpY3R1cmUgPSBudWxsOwogICAgdGhpcy5iYXJjb2RlID0gbnVsbDsKICAgIHRoaXMuYnV0dG9uID0gbnVsbDsKICAgIHRoaXMuY2hlY2tCdXR0b24gPSBudWxsOwogICAgdGhpcy5jaG9pY2VMaXN0ID0gbnVsbDsKICAgIHRoaXMuZGF0ZVRpbWVFZGl0ID0gbnVsbDsKICAgIHRoaXMuZGVmYXVsdFVpID0gbnVsbDsKICAgIHRoaXMuaW1hZ2VFZGl0ID0gbnVsbDsKICAgIHRoaXMubnVtZXJpY0VkaXQgPSBudWxsOwogICAgdGhpcy5wYXNzd29yZEVkaXQgPSBudWxsOwogICAgdGhpcy5zaWduYXR1cmUgPSBudWxsOwogICAgdGhpcy50ZXh0RWRpdCA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJGdldEV4dHJhXSgpIHsKICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRleHRyYV0gPT09IHVuZGVmaW5lZCkgewogICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgICBpZiAobmFtZSA9PT0gImV4dHJhcyIgfHwgbmFtZSA9PT0gInBpY3R1cmUiKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG9iaiA9IHRoaXNbbmFtZV07CgogICAgICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF94ZmFfb2JqZWN0LlhGQU9iamVjdCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gb2JqOwogICAgICAgIHJldHVybiBvYmo7CiAgICAgIH0KCiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3Qgb2JqID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0RXh0cmFdKCk7CgogICAgaWYgKG9iaikgewogICAgICByZXR1cm4gb2JqW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKfQoKY2xhc3MgVmFsaWRhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidmFsaWRhdGUiLCB0cnVlKTsKICAgIHRoaXMuZm9ybWF0VGVzdCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLmZvcm1hdFRlc3QsIFsid2FybmluZyIsICJkaXNhYmxlZCIsICJlcnJvciJdKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5udWxsVGVzdCA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm51bGxUZXN0LCBbImRpc2FibGVkIiwgImVycm9yIiwgIndhcm5pbmciXSk7CiAgICB0aGlzLnNjcmlwdFRlc3QgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zY3JpcHRUZXN0LCBbImVycm9yIiwgImRpc2FibGVkIiwgIndhcm5pbmciXSk7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5leHRyYXMgPSBudWxsOwogICAgdGhpcy5tZXNzYWdlID0gbnVsbDsKICAgIHRoaXMucGljdHVyZSA9IG51bGw7CiAgICB0aGlzLnNjcmlwdCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgVmFsdWUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFRFTVBMQVRFX05TX0lELCAidmFsdWUiLCB0cnVlKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5vdmVycmlkZSA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLm92ZXJyaWRlLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5yZWxldmFudCA9ICgwLCBfdXRpbHMuZ2V0UmVsZXZhbnQpKGF0dHJpYnV0ZXMucmVsZXZhbnQpOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICAgIHRoaXMuYXJjID0gbnVsbDsKICAgIHRoaXMuYm9vbGVhbiA9IG51bGw7CiAgICB0aGlzLmRhdGUgPSBudWxsOwogICAgdGhpcy5kYXRlVGltZSA9IG51bGw7CiAgICB0aGlzLmRlY2ltYWwgPSBudWxsOwogICAgdGhpcy5leERhdGEgPSBudWxsOwogICAgdGhpcy5mbG9hdCA9IG51bGw7CiAgICB0aGlzLmltYWdlID0gbnVsbDsKICAgIHRoaXMuaW50ZWdlciA9IG51bGw7CiAgICB0aGlzLmxpbmUgPSBudWxsOwogICAgdGhpcy5yZWN0YW5nbGUgPSBudWxsOwogICAgdGhpcy50ZXh0ID0gbnVsbDsKICAgIHRoaXMudGltZSA9IG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHNldFZhbHVlXSh2YWx1ZSkgewogICAgY29uc3QgcGFyZW50ID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBGaWVsZCkgewogICAgICBpZiAocGFyZW50LnVpICYmIHBhcmVudC51aS5pbWFnZUVkaXQpIHsKICAgICAgICBpZiAoIXRoaXMuaW1hZ2UpIHsKICAgICAgICAgIHRoaXMuaW1hZ2UgPSBuZXcgSW1hZ2Uoe30pOwoKICAgICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXSh0aGlzLmltYWdlKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaW1hZ2VbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdmFsdWVbX3hmYV9vYmplY3QuJGNvbnRlbnRdOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHZhbHVlTmFtZSA9IHZhbHVlW194ZmFfb2JqZWN0LiRub2RlTmFtZV07CgogICAgaWYgKHRoaXNbdmFsdWVOYW1lXSAhPT0gbnVsbCkgewogICAgICB0aGlzW3ZhbHVlTmFtZV1bX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdmFsdWVbX3hmYV9vYmplY3QuJGNvbnRlbnRdOwogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7CiAgICAgIGNvbnN0IG9iaiA9IHRoaXNbbmFtZV07CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSB7CiAgICAgICAgdGhpc1tuYW1lXSA9IG51bGw7CgogICAgICAgIHRoaXNbX3hmYV9vYmplY3QuJHJlbW92ZUNoaWxkXShvYmopOwogICAgICB9CiAgICB9CgogICAgdGhpc1t2YWx1ZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdXSA9IHZhbHVlOwoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGFwcGVuZENoaWxkXSh2YWx1ZSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRleHRdKCkgewogICAgaWYgKHRoaXMuZXhEYXRhKSB7CiAgICAgIGlmICh0eXBlb2YgdGhpcy5leERhdGFbX3hmYV9vYmplY3QuJGNvbnRlbnRdID09PSAic3RyaW5nIikgewogICAgICAgIHJldHVybiB0aGlzLmV4RGF0YVtfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5leERhdGFbX3hmYV9vYmplY3QuJGNvbnRlbnRdW194ZmFfb2JqZWN0LiR0ZXh0XSgpLnRyaW0oKTsKICAgIH0KCiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHsKICAgICAgaWYgKG5hbWUgPT09ICJpbWFnZSIpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3Qgb2JqID0gdGhpc1tuYW1lXTsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpIHsKICAgICAgICByZXR1cm4gKG9ialtfeGZhX29iamVjdC4kY29udGVudF0gfHwgIiIpLnRvU3RyaW5nKCkudHJpbSgpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRvSFRNTF0oYXZhaWxhYmxlU3BhY2UpIHsKICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkgewogICAgICBjb25zdCBvYmogPSB0aGlzW25hbWVdOwoKICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgX3hmYV9vYmplY3QuWEZBT2JqZWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICByZXR1cm4gb2JqW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKTsKICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgfQoKfQoKZXhwb3J0cy5WYWx1ZSA9IFZhbHVlOwoKY2xhc3MgVmFyaWFibGVzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihURU1QTEFURV9OU19JRCwgInZhcmlhYmxlcyIsIHRydWUpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogICAgdGhpcy5ib29sZWFuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmRhdGUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGF0ZVRpbWUgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZGVjaW1hbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5leERhdGEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuZmxvYXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaW1hZ2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMuaW50ZWdlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5tYW5pZmVzdCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zY3JpcHQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGV4dCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy50aW1lID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKICBbX3hmYV9vYmplY3QuJGlzVHJhbnNwYXJlbnRdKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGVOYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoVGVtcGxhdGVOYW1lc3BhY2UuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgY29uc3Qgbm9kZSA9IFRlbXBsYXRlTmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwoKICAgICAgbm9kZVtfeGZhX29iamVjdC4kc2V0U2V0QXR0cmlidXRlc10oYXR0cmlidXRlcyk7CgogICAgICByZXR1cm4gbm9kZTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgc3RhdGljIGFwcGVhcmFuY2VGaWx0ZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQXBwZWFyYW5jZUZpbHRlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgYXJjKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFyYyhhdHRycyk7CiAgfQoKICBzdGF0aWMgYXJlYShhdHRycykgewogICAgcmV0dXJuIG5ldyBBcmVhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhc3Npc3QoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQXNzaXN0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBiYXJjb2RlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJhcmNvZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJpbmQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQmluZChhdHRycyk7CiAgfQoKICBzdGF0aWMgYmluZEl0ZW1zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJpbmRJdGVtcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgYm9va2VuZChhdHRycykgewogICAgcmV0dXJuIG5ldyBCb29rZW5kKGF0dHJzKTsKICB9CgogIHN0YXRpYyBib29sZWFuKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJvb2xlYW5FbGVtZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBib3JkZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQm9yZGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBicmVhayhhdHRycykgewogICAgcmV0dXJuIG5ldyBCcmVhayhhdHRycyk7CiAgfQoKICBzdGF0aWMgYnJlYWtBZnRlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBCcmVha0FmdGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBicmVha0JlZm9yZShhdHRycykgewogICAgcmV0dXJuIG5ldyBCcmVha0JlZm9yZShhdHRycyk7CiAgfQoKICBzdGF0aWMgYnV0dG9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJ1dHRvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgY2FsY3VsYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENhbGN1bGF0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY2FwdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBDYXB0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjZXJ0aWZpY2F0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBDZXJ0aWZpY2F0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY2VydGlmaWNhdGVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENlcnRpZmljYXRlcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgY2hlY2tCdXR0b24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2hlY2tCdXR0b24oYXR0cnMpOwogIH0KCiAgc3RhdGljIGNob2ljZUxpc3QoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2hvaWNlTGlzdChhdHRycyk7CiAgfQoKICBzdGF0aWMgY29sb3IoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29sb3IoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvbWIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29tYihhdHRycyk7CiAgfQoKICBzdGF0aWMgY29ubmVjdChhdHRycykgewogICAgcmV0dXJuIG5ldyBDb25uZWN0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb250ZW50QXJlYShhdHRycykgewogICAgcmV0dXJuIG5ldyBDb250ZW50QXJlYShhdHRycyk7CiAgfQoKICBzdGF0aWMgY29ybmVyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvcm5lcihhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBEYXRlRWxlbWVudChhdHRycyk7CiAgfQoKICBzdGF0aWMgZGF0ZVRpbWUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF0ZVRpbWUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRhdGVUaW1lRWRpdChhdHRycykgewogICAgcmV0dXJuIG5ldyBEYXRlVGltZUVkaXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRlY2ltYWwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGVjaW1hbChhdHRycyk7CiAgfQoKICBzdGF0aWMgZGVmYXVsdFVpKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERlZmF1bHRVaShhdHRycyk7CiAgfQoKICBzdGF0aWMgZGVzYyhhdHRycykgewogICAgcmV0dXJuIG5ldyBEZXNjKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkaWdlc3RNZXRob2QoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGlnZXN0TWV0aG9kKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkaWdlc3RNZXRob2RzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERpZ2VzdE1ldGhvZHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRyYXcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRHJhdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZWRnZShhdHRycykgewogICAgcmV0dXJuIG5ldyBFZGdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNvZGluZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNvZGluZyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jb2RpbmdzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY29kaW5ncyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jcnlwdChhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNyeXB0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0RGF0YShhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNyeXB0RGF0YShhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jcnlwdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNyeXB0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0aW9uTWV0aG9kKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY3J5cHRpb25NZXRob2QoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY3J5cHRpb25NZXRob2RzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuY3J5cHRpb25NZXRob2RzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBldmVudChhdHRycykgewogICAgcmV0dXJuIG5ldyBFdmVudChhdHRycyk7CiAgfQoKICBzdGF0aWMgZXhEYXRhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV4RGF0YShhdHRycyk7CiAgfQoKICBzdGF0aWMgZXhPYmplY3QoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRXhPYmplY3QoYXR0cnMpOwogIH0KCiAgc3RhdGljIGV4Y2xHcm91cChhdHRycykgewogICAgcmV0dXJuIG5ldyBFeGNsR3JvdXAoYXR0cnMpOwogIH0KCiAgc3RhdGljIGV4ZWN1dGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRXhlY3V0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgZXh0cmFzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV4dHJhcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZmllbGQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRmllbGQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZpbGwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRmlsbChhdHRycyk7CiAgfQoKICBzdGF0aWMgZmlsdGVyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZpbHRlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgZmxvYXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRmxvYXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZvbnQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRm9udChhdHRycyk7CiAgfQoKICBzdGF0aWMgZm9ybWF0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZvcm1hdChhdHRycyk7CiAgfQoKICBzdGF0aWMgaGFuZGxlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBIYW5kbGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBoeXBoZW5hdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBIeXBoZW5hdGlvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgaW1hZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSW1hZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGltYWdlRWRpdChhdHRycykgewogICAgcmV0dXJuIG5ldyBJbWFnZUVkaXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGludGVnZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSW50ZWdlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgaXNzdWVycyhhdHRycykgewogICAgcmV0dXJuIG5ldyBJc3N1ZXJzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBpdGVtcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBJdGVtcyhhdHRycyk7CiAgfQoKICBzdGF0aWMga2VlcChhdHRycykgewogICAgcmV0dXJuIG5ldyBLZWVwKGF0dHJzKTsKICB9CgogIHN0YXRpYyBrZXlVc2FnZShhdHRycykgewogICAgcmV0dXJuIG5ldyBLZXlVc2FnZShhdHRycyk7CiAgfQoKICBzdGF0aWMgbGluZShhdHRycykgewogICAgcmV0dXJuIG5ldyBMaW5lKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsaW5lYXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTGluZWFyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NrRG9jdW1lbnQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9ja0RvY3VtZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBtYW5pZmVzdChhdHRycykgewogICAgcmV0dXJuIG5ldyBNYW5pZmVzdChhdHRycyk7CiAgfQoKICBzdGF0aWMgbWFyZ2luKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1hcmdpbihhdHRycyk7CiAgfQoKICBzdGF0aWMgbWRwKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1kcChhdHRycyk7CiAgfQoKICBzdGF0aWMgbWVkaXVtKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lZGl1bShhdHRycyk7CiAgfQoKICBzdGF0aWMgbWVzc2FnZShhdHRycykgewogICAgcmV0dXJuIG5ldyBNZXNzYWdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBudW1lcmljRWRpdChhdHRycykgewogICAgcmV0dXJuIG5ldyBOdW1lcmljRWRpdChhdHRycyk7CiAgfQoKICBzdGF0aWMgb2NjdXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgT2NjdXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIG9pZChhdHRycykgewogICAgcmV0dXJuIG5ldyBPaWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG9pZHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgT2lkcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgb3ZlcmZsb3coYXR0cnMpIHsKICAgIHJldHVybiBuZXcgT3ZlcmZsb3coYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhZ2VBcmVhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhZ2VBcmVhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYWdlU2V0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhZ2VTZXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhcmEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFyYShhdHRycyk7CiAgfQoKICBzdGF0aWMgcGFzc3dvcmRFZGl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhc3N3b3JkRWRpdChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGF0dGVybihhdHRycykgewogICAgcmV0dXJuIG5ldyBQYXR0ZXJuKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwaWN0dXJlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBpY3R1cmUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByb3RvKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByb3RvKGF0dHJzKTsKICB9CgogIHN0YXRpYyByYWRpYWwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUmFkaWFsKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWFzb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUmVhc29uKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWFzb25zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlYXNvbnMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHJlY3RhbmdsZShhdHRycykgewogICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHJlZihhdHRycykgewogICAgcmV0dXJuIG5ldyBSZWZFbGVtZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzY3JpcHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2NyaXB0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzZXRQcm9wZXJ0eShhdHRycykgewogICAgcmV0dXJuIG5ldyBTZXRQcm9wZXJ0eShhdHRycyk7CiAgfQoKICBzdGF0aWMgc2lnbkRhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2lnbkRhdGEoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNpZ25hdHVyZShhdHRycykgewogICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNpZ25pbmcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2lnbmluZyhhdHRycyk7CiAgfQoKICBzdGF0aWMgc29saWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU29saWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNwZWFrKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNwZWFrKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGlwcGxlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFN0aXBwbGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHN1YmZvcm0oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3ViZm9ybShhdHRycyk7CiAgfQoKICBzdGF0aWMgc3ViZm9ybVNldChhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJmb3JtU2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJqZWN0RE4oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3ViamVjdEROKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJqZWN0RE5zKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFN1YmplY3RETnMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHN1Ym1pdChhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJtaXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRlbXBsYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRlbXBsYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0ZXh0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRleHQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRleHRFZGl0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRleHRFZGl0KGF0dHJzKTsKICB9CgogIHN0YXRpYyB0aW1lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRpbWUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRpbWVTdGFtcChhdHRycykgewogICAgcmV0dXJuIG5ldyBUaW1lU3RhbXAoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRvb2xUaXAoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVG9vbFRpcChhdHRycyk7CiAgfQoKICBzdGF0aWMgdHJhdmVyc2FsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRyYXZlcnNhbChhdHRycyk7CiAgfQoKICBzdGF0aWMgdHJhdmVyc2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVHJhdmVyc2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIHVpKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFVpKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2YWxpZGF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBWYWxpZGF0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdmFsdWUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmFsdWUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHZhcmlhYmxlcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBWYXJpYWJsZXMoYXR0cnMpOwogIH0KCn0KCmV4cG9ydHMuVGVtcGxhdGVOYW1lc3BhY2UgPSBUZW1wbGF0ZU5hbWVzcGFjZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLmFkZEhUTUwgPSBhZGRIVE1MOwpleHBvcnRzLmNoZWNrRGltZW5zaW9ucyA9IGNoZWNrRGltZW5zaW9uczsKZXhwb3J0cy5mbHVzaEhUTUwgPSBmbHVzaEhUTUw7CmV4cG9ydHMuZ2V0QXZhaWxhYmxlU3BhY2UgPSBnZXRBdmFpbGFibGVTcGFjZTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF9odG1sX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NCk7CgpmdW5jdGlvbiBjcmVhdGVMaW5lKG5vZGUsIGNoaWxkcmVuKSB7CiAgcmV0dXJuIHsKICAgIG5hbWU6ICJkaXYiLAogICAgYXR0cmlidXRlczogewogICAgICBjbGFzczogW25vZGUubGF5b3V0ID09PSAibHItdGIiID8gInhmYUxyIiA6ICJ4ZmFSbCJdCiAgICB9LAogICAgY2hpbGRyZW4KICB9Owp9CgpmdW5jdGlvbiBmbHVzaEhUTUwobm9kZSkgewogIGlmICghbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNvbnN0IGF0dHJpYnV0ZXMgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0cmlidXRlczsKICBjb25zdCBodG1sID0gewogICAgbmFtZTogImRpdiIsCiAgICBhdHRyaWJ1dGVzLAogICAgY2hpbGRyZW46IG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5jaGlsZHJlbgogIH07CgogIGlmIChub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uZmFpbGluZ05vZGUpIHsKICAgIGNvbnN0IGh0bWxGcm9tRmFpbGluZyA9IG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5mYWlsaW5nTm9kZVtfeGZhX29iamVjdC4kZmx1c2hIVE1MXSgpOwoKICAgIGlmIChodG1sRnJvbUZhaWxpbmcpIHsKICAgICAgaWYgKG5vZGUubGF5b3V0LmVuZHNXaXRoKCItdGIiKSkgewogICAgICAgIGh0bWwuY2hpbGRyZW4ucHVzaChjcmVhdGVMaW5lKG5vZGUsIFtodG1sRnJvbUZhaWxpbmddKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaHRtbC5jaGlsZHJlbi5wdXNoKGh0bWxGcm9tRmFpbGluZyk7CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChodG1sLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICByZXR1cm4gaHRtbDsKfQoKZnVuY3Rpb24gYWRkSFRNTChub2RlLCBodG1sLCBiYm94KSB7CiAgY29uc3QgZXh0cmEgPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV07CiAgY29uc3QgYXZhaWxhYmxlU3BhY2UgPSBleHRyYS5hdmFpbGFibGVTcGFjZTsKICBjb25zdCBbeCwgeSwgdywgaF0gPSBiYm94OwoKICBzd2l0Y2ggKG5vZGUubGF5b3V0KSB7CiAgICBjYXNlICJwb3NpdGlvbiI6CiAgICAgIHsKICAgICAgICBleHRyYS53aWR0aCA9IE1hdGgubWF4KGV4dHJhLndpZHRoLCB4ICsgdyk7CiAgICAgICAgZXh0cmEuaGVpZ2h0ID0gTWF0aC5tYXgoZXh0cmEuaGVpZ2h0LCB5ICsgaCk7CiAgICAgICAgZXh0cmEuY2hpbGRyZW4ucHVzaChodG1sKTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImxyLXRiIjoKICAgIGNhc2UgInJsLXRiIjoKICAgICAgaWYgKCFleHRyYS5saW5lIHx8IGV4dHJhLmF0dGVtcHQgPT09IDEpIHsKICAgICAgICBleHRyYS5saW5lID0gY3JlYXRlTGluZShub2RlLCBbXSk7CiAgICAgICAgZXh0cmEuY2hpbGRyZW4ucHVzaChleHRyYS5saW5lKTsKICAgICAgICBleHRyYS5udW1iZXJJbkxpbmUgPSAwOwogICAgICB9CgogICAgICBleHRyYS5udW1iZXJJbkxpbmUgKz0gMTsKICAgICAgZXh0cmEubGluZS5jaGlsZHJlbi5wdXNoKGh0bWwpOwoKICAgICAgaWYgKGV4dHJhLmF0dGVtcHQgPT09IDApIHsKICAgICAgICBleHRyYS5jdXJyZW50V2lkdGggKz0gdzsKICAgICAgICBleHRyYS5oZWlnaHQgPSBNYXRoLm1heChleHRyYS5oZWlnaHQsIGV4dHJhLnByZXZIZWlnaHQgKyBoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBleHRyYS5jdXJyZW50V2lkdGggPSB3OwogICAgICAgIGV4dHJhLnByZXZIZWlnaHQgPSBleHRyYS5oZWlnaHQ7CiAgICAgICAgZXh0cmEuaGVpZ2h0ICs9IGg7CiAgICAgICAgZXh0cmEuYXR0ZW1wdCA9IDA7CiAgICAgIH0KCiAgICAgIGV4dHJhLndpZHRoID0gTWF0aC5tYXgoZXh0cmEud2lkdGgsIGV4dHJhLmN1cnJlbnRXaWR0aCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgInJsLXJvdyI6CiAgICBjYXNlICJyb3ciOgogICAgICB7CiAgICAgICAgZXh0cmEuY2hpbGRyZW4ucHVzaChodG1sKTsKICAgICAgICBleHRyYS53aWR0aCArPSB3OwogICAgICAgIGV4dHJhLmhlaWdodCA9IE1hdGgubWF4KGV4dHJhLmhlaWdodCwgaCk7CiAgICAgICAgY29uc3QgaGVpZ2h0ID0gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoZXh0cmEuaGVpZ2h0KTsKCiAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBleHRyYS5jaGlsZHJlbikgewogICAgICAgICAgY2hpbGQuYXR0cmlidXRlcy5zdHlsZS5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgInRhYmxlIjoKICAgICAgewogICAgICAgIGV4dHJhLndpZHRoID0gTWF0aC5taW4oYXZhaWxhYmxlU3BhY2Uud2lkdGgsIE1hdGgubWF4KGV4dHJhLndpZHRoLCB3KSk7CiAgICAgICAgZXh0cmEuaGVpZ2h0ICs9IGg7CiAgICAgICAgZXh0cmEuY2hpbGRyZW4ucHVzaChodG1sKTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgInRiIjoKICAgICAgewogICAgICAgIGV4dHJhLndpZHRoID0gTWF0aC5taW4oYXZhaWxhYmxlU3BhY2Uud2lkdGgsIE1hdGgubWF4KGV4dHJhLndpZHRoLCB3KSk7CiAgICAgICAgZXh0cmEuaGVpZ2h0ICs9IGg7CiAgICAgICAgZXh0cmEuY2hpbGRyZW4ucHVzaChodG1sKTsKICAgICAgICBicmVhazsKICAgICAgfQogIH0KfQoKZnVuY3Rpb24gZ2V0QXZhaWxhYmxlU3BhY2Uobm9kZSkgewogIGNvbnN0IGF2YWlsYWJsZVNwYWNlID0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmF2YWlsYWJsZVNwYWNlOwogIGNvbnN0IG1hcmdpblYgPSBub2RlLm1hcmdpbiA/IG5vZGUubWFyZ2luLnRvcEluc2V0ICsgbm9kZS5tYXJnaW4uYm90dG9tSW5zZXQgOiAwOwogIGNvbnN0IG1hcmdpbkggPSBub2RlLm1hcmdpbiA/IG5vZGUubWFyZ2luLmxlZnRJbnNldCArIG5vZGUubWFyZ2luLnJpZ2h0SW5zZXQgOiAwOwoKICBzd2l0Y2ggKG5vZGUubGF5b3V0KSB7CiAgICBjYXNlICJsci10YiI6CiAgICBjYXNlICJybC10YiI6CiAgICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uYXR0ZW1wdCA9PT0gMCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB3aWR0aDogYXZhaWxhYmxlU3BhY2Uud2lkdGggLSBtYXJnaW5IIC0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmN1cnJlbnRXaWR0aCwKICAgICAgICAgIGhlaWdodDogYXZhaWxhYmxlU3BhY2UuaGVpZ2h0IC0gbWFyZ2luViAtIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5wcmV2SGVpZ2h0CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogYXZhaWxhYmxlU3BhY2Uud2lkdGggLSBtYXJnaW5ILAogICAgICAgIGhlaWdodDogYXZhaWxhYmxlU3BhY2UuaGVpZ2h0IC0gbWFyZ2luViAtIG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5oZWlnaHQKICAgICAgfTsKCiAgICBjYXNlICJybC1yb3ciOgogICAgY2FzZSAicm93IjoKICAgICAgY29uc3Qgd2lkdGggPSBub2RlW194ZmFfb2JqZWN0LiRleHRyYV0uY29sdW1uV2lkdGhzLnNsaWNlKG5vZGVbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50Q29sdW1uKS5yZWR1Y2UoKGEsIHgpID0+IGEgKyB4KTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0OiBhdmFpbGFibGVTcGFjZS5oZWlnaHQgLSBtYXJnaW5ICiAgICAgIH07CgogICAgY2FzZSAidGFibGUiOgogICAgY2FzZSAidGIiOgogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoOiBhdmFpbGFibGVTcGFjZS53aWR0aCAtIG1hcmdpbkgsCiAgICAgICAgaGVpZ2h0OiBhdmFpbGFibGVTcGFjZS5oZWlnaHQgLSBtYXJnaW5WIC0gbm9kZVtfeGZhX29iamVjdC4kZXh0cmFdLmhlaWdodAogICAgICB9OwoKICAgIGNhc2UgInBvc2l0aW9uIjoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBhdmFpbGFibGVTcGFjZTsKICB9Cn0KCmZ1bmN0aW9uIGdldFRyYW5zZm9ybWVkQkJveChub2RlKSB7CiAgbGV0IHcgPSBub2RlLncgPT09ICIiID8gTmFOIDogbm9kZS53OwogIGxldCBoID0gbm9kZS5oID09PSAiIiA/IE5hTiA6IG5vZGUuaDsKICBsZXQgW2NlbnRlclgsIGNlbnRlclldID0gWzAsIDBdOwoKICBzd2l0Y2ggKG5vZGUuYW5jaG9yVHlwZSB8fCAiIikgewogICAgY2FzZSAiYm90dG9tQ2VudGVyIjoKICAgICAgW2NlbnRlclgsIGNlbnRlclldID0gW3cgLyAyLCBoXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAiYm90dG9tTGVmdCI6CiAgICAgIFtjZW50ZXJYLCBjZW50ZXJZXSA9IFswLCBoXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAiYm90dG9tUmlnaHQiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbdywgaF07CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgIm1pZGRsZUNlbnRlciI6CiAgICAgIFtjZW50ZXJYLCBjZW50ZXJZXSA9IFt3IC8gMiwgaCAvIDJdOwogICAgICBicmVhazsKCiAgICBjYXNlICJtaWRkbGVMZWZ0IjoKICAgICAgW2NlbnRlclgsIGNlbnRlclldID0gWzAsIGggLyAyXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAibWlkZGxlUmlnaHQiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbdywgaCAvIDJdOwogICAgICBicmVhazsKCiAgICBjYXNlICJ0b3BDZW50ZXIiOgogICAgICBbY2VudGVyWCwgY2VudGVyWV0gPSBbdyAvIDIsIDBdOwogICAgICBicmVhazsKCiAgICBjYXNlICJ0b3BSaWdodCI6CiAgICAgIFtjZW50ZXJYLCBjZW50ZXJZXSA9IFt3LCAwXTsKICAgICAgYnJlYWs7CiAgfQoKICBsZXQgeCwgeTsKCiAgc3dpdGNoIChub2RlLnJvdGF0ZSB8fCAwKSB7CiAgICBjYXNlIDA6CiAgICAgIFt4LCB5XSA9IFstY2VudGVyWCwgLWNlbnRlclldOwogICAgICBicmVhazsKCiAgICBjYXNlIDkwOgogICAgICBbeCwgeV0gPSBbLWNlbnRlclksIGNlbnRlclhdOwogICAgICBbdywgaF0gPSBbaCwgLXddOwogICAgICBicmVhazsKCiAgICBjYXNlIDE4MDoKICAgICAgW3gsIHldID0gW2NlbnRlclgsIGNlbnRlclldOwogICAgICBbdywgaF0gPSBbLXcsIC1oXTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAyNzA6CiAgICAgIFt4LCB5XSA9IFtjZW50ZXJZLCAtY2VudGVyWF07CiAgICAgIFt3LCBoXSA9IFstaCwgd107CiAgICAgIGJyZWFrOwogIH0KCiAgcmV0dXJuIFtub2RlLnggKyB4ICsgTWF0aC5taW4oMCwgdyksIG5vZGUueSArIHkgKyBNYXRoLm1pbigwLCBoKSwgTWF0aC5hYnModyksIE1hdGguYWJzKGgpXTsKfQoKZnVuY3Rpb24gY2hlY2tEaW1lbnNpb25zKG5vZGUsIHNwYWNlKSB7CiAgaWYgKG5vZGVbX3hmYV9vYmplY3QuJGdldFRlbXBsYXRlUm9vdF0oKVtfeGZhX29iamVjdC4kZXh0cmFdLmZpcnN0VW5zcGxpdHRhYmxlID09PSBudWxsKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChub2RlLncgPT09IDAgfHwgbm9kZS5oID09PSAwKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGNvbnN0IEVSUk9SID0gMjsKCiAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgY29uc3QgYXR0ZW1wdCA9IHBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdICYmIHBhcmVudFtfeGZhX29iamVjdC4kZXh0cmFdLmF0dGVtcHQgfHwgMDsKICBjb25zdCBbLCB5LCB3LCBoXSA9IGdldFRyYW5zZm9ybWVkQkJveChub2RlKTsKCiAgc3dpdGNoIChwYXJlbnQubGF5b3V0KSB7CiAgICBjYXNlICJsci10YiI6CiAgICBjYXNlICJybC10YiI6CiAgICAgIGlmIChhdHRlbXB0ID09PSAwKSB7CiAgICAgICAgaWYgKCFub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUpIHsKICAgICAgICAgIGlmIChub2RlLmggIT09ICIiICYmIE1hdGgucm91bmQoaCAtIHNwYWNlLmhlaWdodCkgPiBFUlJPUikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG5vZGUudyAhPT0gIiIpIHsKICAgICAgICAgICAgaWYgKE1hdGgucm91bmQodyAtIHNwYWNlLndpZHRoKSA8PSBFUlJPUikgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocGFyZW50W194ZmFfb2JqZWN0LiRleHRyYV0ubnVtYmVySW5MaW5lID09PSAwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHNwYWNlLmhlaWdodCA+IEVSUk9SOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHNwYWNlLndpZHRoID4gRVJST1I7CiAgICAgICAgfQoKICAgICAgICBpZiAobm9kZS53ICE9PSAiIikgewogICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQodyAtIHNwYWNlLndpZHRoKSA8PSBFUlJPUjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzcGFjZS53aWR0aCA+IEVSUk9SOwogICAgICB9CgogICAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLmggIT09ICIiICYmIE1hdGgucm91bmQoaCAtIHNwYWNlLmhlaWdodCkgPiBFUlJPUikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUudyA9PT0gIiIgfHwgTWF0aC5yb3VuZCh3IC0gc3BhY2Uud2lkdGgpIDw9IEVSUk9SKSB7CiAgICAgICAgcmV0dXJuIHNwYWNlLmhlaWdodCA+IEVSUk9SOwogICAgICB9CgogICAgICBpZiAocGFyZW50W194ZmFfb2JqZWN0LiRpc1RoZXJlTW9yZVdpZHRoXSgpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gc3BhY2UuaGVpZ2h0ID4gRVJST1I7CgogICAgY2FzZSAidGFibGUiOgogICAgY2FzZSAidGIiOgogICAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLmggIT09ICIiICYmICFub2RlW194ZmFfb2JqZWN0LiRpc1NwbGl0dGFibGVdKCkpIHsKICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChoIC0gc3BhY2UuaGVpZ2h0KSA8PSBFUlJPUjsKICAgICAgfQoKICAgICAgaWYgKG5vZGUudyA9PT0gIiIgfHwgTWF0aC5yb3VuZCh3IC0gc3BhY2Uud2lkdGgpIDw9IEVSUk9SKSB7CiAgICAgICAgcmV0dXJuIHNwYWNlLmhlaWdodCA+IEVSUk9SOwogICAgICB9CgogICAgICBpZiAocGFyZW50W194ZmFfb2JqZWN0LiRpc1RoZXJlTW9yZVdpZHRoXSgpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gc3BhY2UuaGVpZ2h0ID4gRVJST1I7CgogICAgY2FzZSAicG9zaXRpb24iOgogICAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ubm9MYXlvdXRGYWlsdXJlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlLmggPT09ICIiIHx8IE1hdGgucm91bmQoaCArIHkgLSBzcGFjZS5oZWlnaHQpIDw9IEVSUk9SKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IGFyZWEgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5jdXJyZW50Q29udGVudEFyZWE7CgogICAgICByZXR1cm4gaCArIHkgPiBhcmVhLmg7CgogICAgY2FzZSAicmwtcm93IjoKICAgIGNhc2UgInJvdyI6CiAgICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKClbX3hmYV9vYmplY3QuJGV4dHJhXS5ub0xheW91dEZhaWx1cmUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUuaCAhPT0gIiIpIHsKICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChoIC0gc3BhY2UuaGVpZ2h0KSA8PSBFUlJPUjsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIHRydWU7CiAgfQp9CgovKioqLyB9KSwKLyogODQgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5jb21wdXRlQmJveCA9IGNvbXB1dGVCYm94OwpleHBvcnRzLmNyZWF0ZVdyYXBwZXIgPSBjcmVhdGVXcmFwcGVyOwpleHBvcnRzLmZpeERpbWVuc2lvbnMgPSBmaXhEaW1lbnNpb25zOwpleHBvcnRzLmZpeFRleHRJbmRlbnQgPSBmaXhUZXh0SW5kZW50OwpleHBvcnRzLmZpeFVSTCA9IGZpeFVSTDsKZXhwb3J0cy5pc1ByaW50T25seSA9IGlzUHJpbnRPbmx5OwpleHBvcnRzLmxheW91dENsYXNzID0gbGF5b3V0Q2xhc3M7CmV4cG9ydHMubGF5b3V0Tm9kZSA9IGxheW91dE5vZGU7CmV4cG9ydHMubWVhc3VyZVRvU3RyaW5nID0gbWVhc3VyZVRvU3RyaW5nOwpleHBvcnRzLnNldEFjY2VzcyA9IHNldEFjY2VzczsKZXhwb3J0cy5zZXRGb250RmFtaWx5ID0gc2V0Rm9udEZhbWlseTsKZXhwb3J0cy5zZXRNaW5NYXhEaW1lbnNpb25zID0gc2V0TWluTWF4RGltZW5zaW9uczsKZXhwb3J0cy5zZXRQYXJhID0gc2V0UGFyYTsKZXhwb3J0cy50b1N0eWxlID0gdG9TdHlsZTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KTsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKCnZhciBfdGV4dCA9IF9fd19wZGZqc19yZXF1aXJlX18oODYpOwoKZnVuY3Rpb24gbWVhc3VyZVRvU3RyaW5nKG0pIHsKICBpZiAodHlwZW9mIG0gPT09ICJzdHJpbmciKSB7CiAgICByZXR1cm4gIjBweCI7CiAgfQoKICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcihtKSA/IGAke219cHhgIDogYCR7bS50b0ZpeGVkKDIpfXB4YDsKfQoKY29uc3QgY29udmVydGVycyA9IHsKICBhbmNob3JUeXBlKG5vZGUsIHN0eWxlKSB7CiAgICBjb25zdCBwYXJlbnQgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICAgIGlmICghcGFyZW50IHx8IHBhcmVudC5sYXlvdXQgJiYgcGFyZW50LmxheW91dCAhPT0gInBvc2l0aW9uIikgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCEoInRyYW5zZm9ybSIgaW4gc3R5bGUpKSB7CiAgICAgIHN0eWxlLnRyYW5zZm9ybSA9ICIiOwogICAgfQoKICAgIHN3aXRjaCAobm9kZS5hbmNob3JUeXBlKSB7CiAgICAgIGNhc2UgImJvdHRvbUNlbnRlciI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoLTUwJSwgLTEwMCUpIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImJvdHRvbUxlZnQiOgogICAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSAidHJhbnNsYXRlKDAsLTEwMCUpIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImJvdHRvbVJpZ2h0IjoKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgtMTAwJSwtMTAwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibWlkZGxlQ2VudGVyIjoKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgtNTAlLC01MCUpIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIm1pZGRsZUxlZnQiOgogICAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSAidHJhbnNsYXRlKDAsLTUwJSkiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibWlkZGxlUmlnaHQiOgogICAgICAgIHN0eWxlLnRyYW5zZm9ybSArPSAidHJhbnNsYXRlKC0xMDAlLC01MCUpIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcENlbnRlciI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoLTUwJSwwKSI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJ0b3BSaWdodCI6CiAgICAgICAgc3R5bGUudHJhbnNmb3JtICs9ICJ0cmFuc2xhdGUoLTEwMCUsMCkiOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIGRpbWVuc2lvbnMobm9kZSwgc3R5bGUpIHsKICAgIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgbGV0IHdpZHRoID0gbm9kZS53OwogICAgY29uc3QgaGVpZ2h0ID0gbm9kZS5oOwoKICAgIGlmIChwYXJlbnQubGF5b3V0ICYmIHBhcmVudC5sYXlvdXQuaW5jbHVkZXMoInJvdyIpKSB7CiAgICAgIGNvbnN0IGV4dHJhID0gcGFyZW50W194ZmFfb2JqZWN0LiRleHRyYV07CiAgICAgIGNvbnN0IGNvbFNwYW4gPSBub2RlLmNvbFNwYW47CiAgICAgIGxldCB3OwoKICAgICAgaWYgKGNvbFNwYW4gPT09IC0xKSB7CiAgICAgICAgdyA9IGV4dHJhLmNvbHVtbldpZHRocy5zbGljZShleHRyYS5jdXJyZW50Q29sdW1uKS5yZWR1Y2UoKGEsIHgpID0+IGEgKyB4LCAwKTsKICAgICAgICBleHRyYS5jdXJyZW50Q29sdW1uID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICB3ID0gZXh0cmEuY29sdW1uV2lkdGhzLnNsaWNlKGV4dHJhLmN1cnJlbnRDb2x1bW4sIGV4dHJhLmN1cnJlbnRDb2x1bW4gKyBjb2xTcGFuKS5yZWR1Y2UoKGEsIHgpID0+IGEgKyB4LCAwKTsKICAgICAgICBleHRyYS5jdXJyZW50Q29sdW1uID0gKGV4dHJhLmN1cnJlbnRDb2x1bW4gKyBub2RlLmNvbFNwYW4pICUgZXh0cmEuY29sdW1uV2lkdGhzLmxlbmd0aDsKICAgICAgfQoKICAgICAgaWYgKCFpc05hTih3KSkgewogICAgICAgIHdpZHRoID0gbm9kZS53ID0gdzsKICAgICAgfQogICAgfQoKICAgIGlmICh3aWR0aCAhPT0gIiIpIHsKICAgICAgc3R5bGUud2lkdGggPSBtZWFzdXJlVG9TdHJpbmcod2lkdGgpOwogICAgfSBlbHNlIHsKICAgICAgc3R5bGUud2lkdGggPSAiYXV0byI7CiAgICB9CgogICAgaWYgKGhlaWdodCAhPT0gIiIpIHsKICAgICAgc3R5bGUuaGVpZ2h0ID0gbWVhc3VyZVRvU3RyaW5nKGhlaWdodCk7CiAgICB9IGVsc2UgewogICAgICBzdHlsZS5oZWlnaHQgPSAiYXV0byI7CiAgICB9CiAgfSwKCiAgcG9zaXRpb24obm9kZSwgc3R5bGUpIHsKICAgIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgaWYgKHBhcmVudCAmJiBwYXJlbnQubGF5b3V0ICYmIHBhcmVudC5sYXlvdXQgIT09ICJwb3NpdGlvbiIpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsKICAgIHN0eWxlLmxlZnQgPSBtZWFzdXJlVG9TdHJpbmcobm9kZS54KTsKICAgIHN0eWxlLnRvcCA9IG1lYXN1cmVUb1N0cmluZyhub2RlLnkpOwogIH0sCgogIHJvdGF0ZShub2RlLCBzdHlsZSkgewogICAgaWYgKG5vZGUucm90YXRlKSB7CiAgICAgIGlmICghKCJ0cmFuc2Zvcm0iIGluIHN0eWxlKSkgewogICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9ICIiOwogICAgICB9CgogICAgICBzdHlsZS50cmFuc2Zvcm0gKz0gYHJvdGF0ZSgtJHtub2RlLnJvdGF0ZX1kZWcpYDsKICAgICAgc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gInRvcCBsZWZ0IjsKICAgIH0KICB9LAoKICBwcmVzZW5jZShub2RlLCBzdHlsZSkgewogICAgc3dpdGNoIChub2RlLnByZXNlbmNlKSB7CiAgICAgIGNhc2UgImludmlzaWJsZSI6CiAgICAgICAgc3R5bGUudmlzaWJpbGl0eSA9ICJoaWRkZW4iOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiaGlkZGVuIjoKICAgICAgY2FzZSAiaW5hY3RpdmUiOgogICAgICAgIHN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgaEFsaWduKG5vZGUsIHN0eWxlKSB7CiAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kbm9kZU5hbWVdID09PSAicGFyYSIpIHsKICAgICAgc3dpdGNoIChub2RlLmhBbGlnbikgewogICAgICAgIGNhc2UgImp1c3RpZnlBbGwiOgogICAgICAgICAgc3R5bGUudGV4dEFsaWduID0gImp1c3RpZnktYWxsIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJyYWRpeCI6CiAgICAgICAgICBzdHlsZS50ZXh0QWxpZ24gPSAibGVmdCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHN0eWxlLnRleHRBbGlnbiA9IG5vZGUuaEFsaWduOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBzd2l0Y2ggKG5vZGUuaEFsaWduKSB7CiAgICAgICAgY2FzZSAibGVmdCI6CiAgICAgICAgICBzdHlsZS5hbGlnblNlbGYgPSAic3RhcnQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImNlbnRlciI6CiAgICAgICAgICBzdHlsZS5hbGlnblNlbGYgPSAiY2VudGVyIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJyaWdodCI6CiAgICAgICAgICBzdHlsZS5hbGlnblNlbGYgPSAiZW5kIjsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfSwKCiAgbWFyZ2luKG5vZGUsIHN0eWxlKSB7CiAgICBpZiAobm9kZS5tYXJnaW4pIHsKICAgICAgc3R5bGUubWFyZ2luID0gbm9kZS5tYXJnaW5bX3hmYV9vYmplY3QuJHRvU3R5bGVdKCkubWFyZ2luOwogICAgfQogIH0KCn07CgpmdW5jdGlvbiBzZXRNaW5NYXhEaW1lbnNpb25zKG5vZGUsIHN0eWxlKSB7CiAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgaWYgKHBhcmVudC5sYXlvdXQgPT09ICJwb3NpdGlvbiIpIHsKICAgIGlmIChub2RlLm1pblcgPiAwKSB7CiAgICAgIHN0eWxlLm1pbldpZHRoID0gbWVhc3VyZVRvU3RyaW5nKG5vZGUubWluVyk7CiAgICB9CgogICAgaWYgKG5vZGUubWF4VyA+IDApIHsKICAgICAgc3R5bGUubWF4V2lkdGggPSBtZWFzdXJlVG9TdHJpbmcobm9kZS5tYXhXKTsKICAgIH0KCiAgICBpZiAobm9kZS5taW5IID4gMCkgewogICAgICBzdHlsZS5taW5IZWlnaHQgPSBtZWFzdXJlVG9TdHJpbmcobm9kZS5taW5IKTsKICAgIH0KCiAgICBpZiAobm9kZS5tYXhIID4gMCkgewogICAgICBzdHlsZS5tYXhIZWlnaHQgPSBtZWFzdXJlVG9TdHJpbmcobm9kZS5tYXhIKTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGxheW91dFRleHQodGV4dCwgeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0LCBmb250RmluZGVyLCB3aWR0aCkgewogIGNvbnN0IG1lYXN1cmUgPSBuZXcgX3RleHQuVGV4dE1lYXN1cmUoeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0LCBmb250RmluZGVyKTsKCiAgaWYgKHR5cGVvZiB0ZXh0ID09PSAic3RyaW5nIikgewogICAgbWVhc3VyZS5hZGRTdHJpbmcodGV4dCk7CiAgfSBlbHNlIHsKICAgIHRleHRbX3hmYV9vYmplY3QuJHB1c2hHbHlwaHNdKG1lYXN1cmUpOwogIH0KCiAgcmV0dXJuIG1lYXN1cmUuY29tcHV0ZSh3aWR0aCk7Cn0KCmZ1bmN0aW9uIGxheW91dE5vZGUobm9kZSwgYXZhaWxhYmxlU3BhY2UpIHsKICBsZXQgaGVpZ2h0ID0gbnVsbDsKICBsZXQgd2lkdGggPSBudWxsOwogIGxldCBpc0Jyb2tlbiA9IGZhbHNlOwoKICBpZiAoKCFub2RlLncgfHwgIW5vZGUuaCkgJiYgbm9kZS52YWx1ZSkgewogICAgbGV0IG1hcmdpbkggPSAwOwogICAgbGV0IG1hcmdpblYgPSAwOwoKICAgIGlmIChub2RlLm1hcmdpbikgewogICAgICBtYXJnaW5IID0gbm9kZS5tYXJnaW4ubGVmdEluc2V0ICsgbm9kZS5tYXJnaW4ucmlnaHRJbnNldDsKICAgICAgbWFyZ2luViA9IG5vZGUubWFyZ2luLnRvcEluc2V0ICsgbm9kZS5tYXJnaW4uYm90dG9tSW5zZXQ7CiAgICB9CgogICAgbGV0IGxpbmVIZWlnaHQgPSBudWxsOwogICAgbGV0IG1hcmdpbiA9IG51bGw7CgogICAgaWYgKG5vZGUucGFyYSkgewogICAgICBtYXJnaW4gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBsaW5lSGVpZ2h0ID0gbm9kZS5wYXJhLmxpbmVIZWlnaHQgPT09ICIiID8gbnVsbCA6IG5vZGUucGFyYS5saW5lSGVpZ2h0OwogICAgICBtYXJnaW4udG9wID0gbm9kZS5wYXJhLnNwYWNlQWJvdmUgPT09ICIiID8gMCA6IG5vZGUucGFyYS5zcGFjZUFib3ZlOwogICAgICBtYXJnaW4uYm90dG9tID0gbm9kZS5wYXJhLnNwYWNlQmVsb3cgPT09ICIiID8gMCA6IG5vZGUucGFyYS5zcGFjZUJlbG93OwogICAgICBtYXJnaW4ubGVmdCA9IG5vZGUucGFyYS5tYXJnaW5MZWZ0ID09PSAiIiA/IDAgOiBub2RlLnBhcmEubWFyZ2luTGVmdDsKICAgICAgbWFyZ2luLnJpZ2h0ID0gbm9kZS5wYXJhLm1hcmdpblJpZ2h0ID09PSAiIiA/IDAgOiBub2RlLnBhcmEubWFyZ2luUmlnaHQ7CiAgICB9CgogICAgbGV0IGZvbnQgPSBub2RlLmZvbnQ7CgogICAgaWYgKCFmb250KSB7CiAgICAgIGNvbnN0IHJvb3QgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRUZW1wbGF0ZVJvb3RdKCk7CgogICAgICBsZXQgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpOwoKICAgICAgd2hpbGUgKHBhcmVudCAmJiBwYXJlbnQgIT09IHJvb3QpIHsKICAgICAgICBpZiAocGFyZW50LmZvbnQpIHsKICAgICAgICAgIGZvbnQgPSBwYXJlbnQuZm9udDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50ID0gcGFyZW50W194ZmFfb2JqZWN0LiRnZXRQYXJlbnRdKCk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBtYXhXaWR0aCA9IChub2RlLncgfHwgYXZhaWxhYmxlU3BhY2Uud2lkdGgpIC0gbWFyZ2luSDsKICAgIGNvbnN0IGZvbnRGaW5kZXIgPSBub2RlW194ZmFfb2JqZWN0LiRnbG9iYWxEYXRhXS5mb250RmluZGVyOwoKICAgIGlmIChub2RlLnZhbHVlLmV4RGF0YSAmJiBub2RlLnZhbHVlLmV4RGF0YVtfeGZhX29iamVjdC4kY29udGVudF0gJiYgbm9kZS52YWx1ZS5leERhdGEuY29udGVudFR5cGUgPT09ICJ0ZXh0L2h0bWwiKSB7CiAgICAgIGNvbnN0IHJlcyA9IGxheW91dFRleHQobm9kZS52YWx1ZS5leERhdGFbX3hmYV9vYmplY3QuJGNvbnRlbnRdLCBmb250LCBtYXJnaW4sIGxpbmVIZWlnaHQsIGZvbnRGaW5kZXIsIG1heFdpZHRoKTsKICAgICAgd2lkdGggPSByZXMud2lkdGg7CiAgICAgIGhlaWdodCA9IHJlcy5oZWlnaHQ7CiAgICAgIGlzQnJva2VuID0gcmVzLmlzQnJva2VuOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgdGV4dCA9IG5vZGUudmFsdWVbX3hmYV9vYmplY3QuJHRleHRdKCk7CgogICAgICBpZiAodGV4dCkgewogICAgICAgIGNvbnN0IHJlcyA9IGxheW91dFRleHQodGV4dCwgZm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0LCBmb250RmluZGVyLCBtYXhXaWR0aCk7CiAgICAgICAgd2lkdGggPSByZXMud2lkdGg7CiAgICAgICAgaGVpZ2h0ID0gcmVzLmhlaWdodDsKICAgICAgICBpc0Jyb2tlbiA9IHJlcy5pc0Jyb2tlbjsKICAgICAgfQogICAgfQoKICAgIGlmICh3aWR0aCAhPT0gbnVsbCAmJiAhbm9kZS53KSB7CiAgICAgIHdpZHRoICs9IG1hcmdpbkg7CiAgICB9CgogICAgaWYgKGhlaWdodCAhPT0gbnVsbCAmJiAhbm9kZS5oKSB7CiAgICAgIGhlaWdodCArPSBtYXJnaW5WOwogICAgfQogIH0KCiAgcmV0dXJuIHsKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgaXNCcm9rZW4KICB9Owp9CgpmdW5jdGlvbiBjb21wdXRlQmJveChub2RlLCBodG1sLCBhdmFpbGFibGVTcGFjZSkgewogIGxldCBiYm94OwoKICBpZiAobm9kZS53ICE9PSAiIiAmJiBub2RlLmggIT09ICIiKSB7CiAgICBiYm94ID0gW25vZGUueCwgbm9kZS55LCBub2RlLncsIG5vZGUuaF07CiAgfSBlbHNlIHsKICAgIGlmICghYXZhaWxhYmxlU3BhY2UpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgbGV0IHdpZHRoID0gbm9kZS53OwoKICAgIGlmICh3aWR0aCA9PT0gIiIpIHsKICAgICAgaWYgKG5vZGUubWF4VyA9PT0gMCkgewogICAgICAgIGNvbnN0IHBhcmVudCA9IG5vZGVbX3hmYV9vYmplY3QuJGdldFN1YmZvcm1QYXJlbnRdKCk7CgogICAgICAgIGlmIChwYXJlbnQubGF5b3V0ID09PSAicG9zaXRpb24iICYmIHBhcmVudC53ICE9PSAiIikgewogICAgICAgICAgd2lkdGggPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aWR0aCA9IG5vZGUubWluVzsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2lkdGggPSBNYXRoLm1pbihub2RlLm1heFcsIGF2YWlsYWJsZVNwYWNlLndpZHRoKTsKICAgICAgfQoKICAgICAgaHRtbC5hdHRyaWJ1dGVzLnN0eWxlLndpZHRoID0gbWVhc3VyZVRvU3RyaW5nKHdpZHRoKTsKICAgIH0KCiAgICBsZXQgaGVpZ2h0ID0gbm9kZS5oOwoKICAgIGlmIChoZWlnaHQgPT09ICIiKSB7CiAgICAgIGlmIChub2RlLm1heEggPT09IDApIHsKICAgICAgICBjb25zdCBwYXJlbnQgPSBub2RlW194ZmFfb2JqZWN0LiRnZXRTdWJmb3JtUGFyZW50XSgpOwoKICAgICAgICBpZiAocGFyZW50LmxheW91dCA9PT0gInBvc2l0aW9uIiAmJiBwYXJlbnQuaCAhPT0gIiIpIHsKICAgICAgICAgIGhlaWdodCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhlaWdodCA9IG5vZGUubWluSDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaGVpZ2h0ID0gTWF0aC5taW4obm9kZS5tYXhILCBhdmFpbGFibGVTcGFjZS5oZWlnaHQpOwogICAgICB9CgogICAgICBodG1sLmF0dHJpYnV0ZXMuc3R5bGUuaGVpZ2h0ID0gbWVhc3VyZVRvU3RyaW5nKGhlaWdodCk7CiAgICB9CgogICAgYmJveCA9IFtub2RlLngsIG5vZGUueSwgd2lkdGgsIGhlaWdodF07CiAgfQoKICByZXR1cm4gYmJveDsKfQoKZnVuY3Rpb24gZml4RGltZW5zaW9ucyhub2RlKSB7CiAgY29uc3QgcGFyZW50ID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0U3ViZm9ybVBhcmVudF0oKTsKCiAgaWYgKHBhcmVudC5sYXlvdXQgJiYgcGFyZW50LmxheW91dC5pbmNsdWRlcygicm93IikpIHsKICAgIGNvbnN0IGV4dHJhID0gcGFyZW50W194ZmFfb2JqZWN0LiRleHRyYV07CiAgICBjb25zdCBjb2xTcGFuID0gbm9kZS5jb2xTcGFuOwogICAgbGV0IHdpZHRoOwoKICAgIGlmIChjb2xTcGFuID09PSAtMSkgewogICAgICB3aWR0aCA9IGV4dHJhLmNvbHVtbldpZHRocy5zbGljZShleHRyYS5jdXJyZW50Q29sdW1uKS5yZWR1Y2UoKGEsIHcpID0+IGEgKyB3LCAwKTsKICAgIH0gZWxzZSB7CiAgICAgIHdpZHRoID0gZXh0cmEuY29sdW1uV2lkdGhzLnNsaWNlKGV4dHJhLmN1cnJlbnRDb2x1bW4sIGV4dHJhLmN1cnJlbnRDb2x1bW4gKyBjb2xTcGFuKS5yZWR1Y2UoKGEsIHcpID0+IGEgKyB3LCAwKTsKICAgIH0KCiAgICBpZiAoIWlzTmFOKHdpZHRoKSkgewogICAgICBub2RlLncgPSB3aWR0aDsKICAgIH0KICB9CgogIGlmIChwYXJlbnQubGF5b3V0ICYmIHBhcmVudC5sYXlvdXQgIT09ICJwb3NpdGlvbiIpIHsKICAgIG5vZGUueCA9IG5vZGUueSA9IDA7CiAgfQoKICBpZiAobm9kZS5sYXlvdXQgPT09ICJ0YWJsZSIpIHsKICAgIGlmIChub2RlLncgPT09ICIiICYmIEFycmF5LmlzQXJyYXkobm9kZS5jb2x1bW5XaWR0aHMpKSB7CiAgICAgIG5vZGUudyA9IG5vZGUuY29sdW1uV2lkdGhzLnJlZHVjZSgoYSwgeCkgPT4gYSArIHgsIDApOwogICAgfQogIH0KfQoKZnVuY3Rpb24gbGF5b3V0Q2xhc3Mobm9kZSkgewogIHN3aXRjaCAobm9kZS5sYXlvdXQpIHsKICAgIGNhc2UgInBvc2l0aW9uIjoKICAgICAgcmV0dXJuICJ4ZmFQb3NpdGlvbiI7CgogICAgY2FzZSAibHItdGIiOgogICAgICByZXR1cm4gInhmYUxyVGIiOwoKICAgIGNhc2UgInJsLXJvdyI6CiAgICAgIHJldHVybiAieGZhUmxSb3ciOwoKICAgIGNhc2UgInJsLXRiIjoKICAgICAgcmV0dXJuICJ4ZmFSbFRiIjsKCiAgICBjYXNlICJyb3ciOgogICAgICByZXR1cm4gInhmYVJvdyI7CgogICAgY2FzZSAidGFibGUiOgogICAgICByZXR1cm4gInhmYVRhYmxlIjsKCiAgICBjYXNlICJ0YiI6CiAgICAgIHJldHVybiAieGZhVGIiOwoKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAieGZhUG9zaXRpb24iOwogIH0KfQoKZnVuY3Rpb24gdG9TdHlsZShub2RlLCAuLi5uYW1lcykgewogIGNvbnN0IHN0eWxlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgZm9yIChjb25zdCBuYW1lIG9mIG5hbWVzKSB7CiAgICBjb25zdCB2YWx1ZSA9IG5vZGVbbmFtZV07CgogICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmIChjb252ZXJ0ZXJzLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIGNvbnZlcnRlcnNbbmFtZV0obm9kZSwgc3R5bGUpOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBfeGZhX29iamVjdC5YRkFPYmplY3QpIHsKICAgICAgY29uc3QgbmV3U3R5bGUgPSB2YWx1ZVtfeGZhX29iamVjdC4kdG9TdHlsZV0oKTsKCiAgICAgIGlmIChuZXdTdHlsZSkgewogICAgICAgIE9iamVjdC5hc3NpZ24oc3R5bGUsIG5ld1N0eWxlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoYChERUJVRykgLSBYRkEgLSBzdHlsZSBmb3IgJHtuYW1lfSBub3QgaW1wbGVtZW50ZWQgeWV0YCk7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBzdHlsZTsKfQoKZnVuY3Rpb24gY3JlYXRlV3JhcHBlcihub2RlLCBodG1sKSB7CiAgY29uc3QgewogICAgYXR0cmlidXRlcwogIH0gPSBodG1sOwogIGNvbnN0IHsKICAgIHN0eWxlCiAgfSA9IGF0dHJpYnV0ZXM7CiAgY29uc3Qgd3JhcHBlciA9IHsKICAgIG5hbWU6ICJkaXYiLAogICAgYXR0cmlidXRlczogewogICAgICBjbGFzczogWyJ4ZmFXcmFwcGVyIl0sCiAgICAgIHN0eWxlOiBPYmplY3QuY3JlYXRlKG51bGwpCiAgICB9LAogICAgY2hpbGRyZW46IFtdCiAgfTsKICBhdHRyaWJ1dGVzLmNsYXNzLnB1c2goInhmYVdyYXBwZWQiKTsKCiAgaWYgKG5vZGUuYm9yZGVyKSB7CiAgICBjb25zdCB7CiAgICAgIHdpZHRocywKICAgICAgaW5zZXRzCiAgICB9ID0gbm9kZS5ib3JkZXJbX3hmYV9vYmplY3QuJGV4dHJhXTsKICAgIGxldCB3aWR0aCwgaGVpZ2h0OwogICAgbGV0IHRvcCA9IGluc2V0c1swXTsKICAgIGxldCBsZWZ0ID0gaW5zZXRzWzNdOwogICAgY29uc3QgaW5zZXRzSCA9IGluc2V0c1swXSArIGluc2V0c1syXTsKICAgIGNvbnN0IGluc2V0c1cgPSBpbnNldHNbMV0gKyBpbnNldHNbM107CgogICAgc3dpdGNoIChub2RlLmJvcmRlci5oYW5kKSB7CiAgICAgIGNhc2UgImV2ZW4iOgogICAgICAgIHRvcCAtPSB3aWR0aHNbMF0gLyAyOwogICAgICAgIGxlZnQgLT0gd2lkdGhzWzNdIC8gMjsKICAgICAgICB3aWR0aCA9IGBjYWxjKDEwMCUgKyAkeyh3aWR0aHNbMV0gKyB3aWR0aHNbM10pIC8gMiAtIGluc2V0c1d9cHgpYDsKICAgICAgICBoZWlnaHQgPSBgY2FsYygxMDAlICsgJHsod2lkdGhzWzBdICsgd2lkdGhzWzJdKSAvIDIgLSBpbnNldHNIfXB4KWA7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJsZWZ0IjoKICAgICAgICB0b3AgLT0gd2lkdGhzWzBdOwogICAgICAgIGxlZnQgLT0gd2lkdGhzWzNdOwogICAgICAgIHdpZHRoID0gYGNhbGMoMTAwJSArICR7d2lkdGhzWzFdICsgd2lkdGhzWzNdIC0gaW5zZXRzV31weClgOwogICAgICAgIGhlaWdodCA9IGBjYWxjKDEwMCUgKyAke3dpZHRoc1swXSArIHdpZHRoc1syXSAtIGluc2V0c0h9cHgpYDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInJpZ2h0IjoKICAgICAgICB3aWR0aCA9IGluc2V0c1cgPyBgY2FsYygxMDAlIC0gJHtpbnNldHNXfXB4KWAgOiAiMTAwJSI7CiAgICAgICAgaGVpZ2h0ID0gaW5zZXRzSCA/IGBjYWxjKDEwMCUgLSAke2luc2V0c0h9cHgpYCA6ICIxMDAlIjsKICAgICAgICBicmVhazsKICAgIH0KCiAgICBjb25zdCBjbGFzc05hbWVzID0gWyJ4ZmFCb3JkZXIiXTsKCiAgICBpZiAoaXNQcmludE9ubHkobm9kZS5ib3JkZXIpKSB7CiAgICAgIGNsYXNzTmFtZXMucHVzaCgieGZhUHJpbnRPbmx5Iik7CiAgICB9CgogICAgY29uc3QgYm9yZGVyID0gewogICAgICBuYW1lOiAiZGl2IiwKICAgICAgYXR0cmlidXRlczogewogICAgICAgIGNsYXNzOiBjbGFzc05hbWVzLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICB0b3A6IGAke3RvcH1weGAsCiAgICAgICAgICBsZWZ0OiBgJHtsZWZ0fXB4YCwKICAgICAgICAgIHdpZHRoLAogICAgICAgICAgaGVpZ2h0CiAgICAgICAgfQogICAgICB9LAogICAgICBjaGlsZHJlbjogW10KICAgIH07CgogICAgZm9yIChjb25zdCBrZXkgb2YgWyJib3JkZXIiLCAiYm9yZGVyV2lkdGgiLCAiYm9yZGVyQ29sb3IiLCAiYm9yZGVyUmFkaXVzIiwgImJvcmRlclN0eWxlIl0pIHsKICAgICAgaWYgKHN0eWxlW2tleV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIGJvcmRlci5hdHRyaWJ1dGVzLnN0eWxlW2tleV0gPSBzdHlsZVtrZXldOwogICAgICAgIGRlbGV0ZSBzdHlsZVtrZXldOwogICAgICB9CiAgICB9CgogICAgd3JhcHBlci5jaGlsZHJlbi5wdXNoKGJvcmRlciwgaHRtbCk7CiAgfSBlbHNlIHsKICAgIHdyYXBwZXIuY2hpbGRyZW4ucHVzaChodG1sKTsKICB9CgogIGZvciAoY29uc3Qga2V5IG9mIFsiYmFja2dyb3VuZCIsICJiYWNrZ3JvdW5kQ2xpcCIsICJ0b3AiLCAibGVmdCIsICJ3aWR0aCIsICJoZWlnaHQiLCAibWluV2lkdGgiLCAibWluSGVpZ2h0IiwgIm1heFdpZHRoIiwgIm1heEhlaWdodCIsICJ0cmFuc2Zvcm0iLCAidHJhbnNmb3JtT3JpZ2luIiwgInZpc2liaWxpdHkiXSkgewogICAgaWYgKHN0eWxlW2tleV0gIT09IHVuZGVmaW5lZCkgewogICAgICB3cmFwcGVyLmF0dHJpYnV0ZXMuc3R5bGVba2V5XSA9IHN0eWxlW2tleV07CiAgICAgIGRlbGV0ZSBzdHlsZVtrZXldOwogICAgfQogIH0KCiAgaWYgKHN0eWxlLnBvc2l0aW9uID09PSAiYWJzb2x1dGUiKSB7CiAgICB3cmFwcGVyLmF0dHJpYnV0ZXMuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogIH0gZWxzZSB7CiAgICB3cmFwcGVyLmF0dHJpYnV0ZXMuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwogIH0KCiAgZGVsZXRlIHN0eWxlLnBvc2l0aW9uOwoKICBpZiAoc3R5bGUuYWxpZ25TZWxmKSB7CiAgICB3cmFwcGVyLmF0dHJpYnV0ZXMuc3R5bGUuYWxpZ25TZWxmID0gc3R5bGUuYWxpZ25TZWxmOwogICAgZGVsZXRlIHN0eWxlLmFsaWduU2VsZjsKICB9CgogIHJldHVybiB3cmFwcGVyOwp9CgpmdW5jdGlvbiBmaXhUZXh0SW5kZW50KHN0eWxlcykgewogIGNvbnN0IGluZGVudCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHN0eWxlcy50ZXh0SW5kZW50LCAiMHB4Iik7CgogIGlmIChpbmRlbnQgPj0gMCkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgYWxpZ24gPSBzdHlsZXMudGV4dEFsaWduID09PSAicmlnaHQiID8gInJpZ2h0IiA6ICJsZWZ0IjsKICBjb25zdCBuYW1lID0gInBhZGRpbmciICsgKGFsaWduID09PSAibGVmdCIgPyAiTGVmdCIgOiAiUmlnaHQiKTsKICBjb25zdCBwYWRkaW5nID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoc3R5bGVzW25hbWVdLCAiMHB4Iik7CiAgc3R5bGVzW25hbWVdID0gYCR7cGFkZGluZyAtIGluZGVudH1weGA7Cn0KCmZ1bmN0aW9uIHNldEFjY2Vzcyhub2RlLCBjbGFzc05hbWVzKSB7CiAgc3dpdGNoIChub2RlLmFjY2VzcykgewogICAgY2FzZSAibm9uSW50ZXJhY3RpdmUiOgogICAgICBjbGFzc05hbWVzLnB1c2goInhmYU5vbkludGVyYWN0aXZlIik7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgInJlYWRPbmx5IjoKICAgICAgY2xhc3NOYW1lcy5wdXNoKCJ4ZmFSZWFkT25seSIpOwogICAgICBicmVhazsKCiAgICBjYXNlICJwcm90ZWN0ZWQiOgogICAgICBjbGFzc05hbWVzLnB1c2goInhmYURpc2FibGVkIik7CiAgICAgIGJyZWFrOwogIH0KfQoKZnVuY3Rpb24gaXNQcmludE9ubHkobm9kZSkgewogIHJldHVybiBub2RlLnJlbGV2YW50Lmxlbmd0aCA+IDAgJiYgIW5vZGUucmVsZXZhbnRbMF0uZXhjbHVkZWQgJiYgbm9kZS5yZWxldmFudFswXS52aWV3bmFtZSA9PT0gInByaW50IjsKfQoKZnVuY3Rpb24gZ2V0Q3VycmVudFBhcmEobm9kZSkgewogIGNvbnN0IHN0YWNrID0gbm9kZVtfeGZhX29iamVjdC4kZ2V0VGVtcGxhdGVSb290XSgpW194ZmFfb2JqZWN0LiRleHRyYV0ucGFyYVN0YWNrOwoKICByZXR1cm4gc3RhY2subGVuZ3RoID8gc3RhY2suYXQoLTEpIDogbnVsbDsKfQoKZnVuY3Rpb24gc2V0UGFyYShub2RlLCBub2RlU3R5bGUsIHZhbHVlKSB7CiAgaWYgKHZhbHVlLmF0dHJpYnV0ZXMuY2xhc3MgJiYgdmFsdWUuYXR0cmlidXRlcy5jbGFzcy5pbmNsdWRlcygieGZhUmljaCIpKSB7CiAgICBpZiAobm9kZVN0eWxlKSB7CiAgICAgIGlmIChub2RlLmggPT09ICIiKSB7CiAgICAgICAgbm9kZVN0eWxlLmhlaWdodCA9ICJhdXRvIjsKICAgICAgfQoKICAgICAgaWYgKG5vZGUudyA9PT0gIiIpIHsKICAgICAgICBub2RlU3R5bGUud2lkdGggPSAiYXV0byI7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBwYXJhID0gZ2V0Q3VycmVudFBhcmEobm9kZSk7CgogICAgaWYgKHBhcmEpIHsKICAgICAgY29uc3QgdmFsdWVTdHlsZSA9IHZhbHVlLmF0dHJpYnV0ZXMuc3R5bGU7CiAgICAgIHZhbHVlU3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgdmFsdWVTdHlsZS5mbGV4RGlyZWN0aW9uID0gImNvbHVtbiI7CgogICAgICBzd2l0Y2ggKHBhcmEudkFsaWduKSB7CiAgICAgICAgY2FzZSAidG9wIjoKICAgICAgICAgIHZhbHVlU3R5bGUuanVzdGlmeUNvbnRlbnQgPSAic3RhcnQiOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImJvdHRvbSI6CiAgICAgICAgICB2YWx1ZVN0eWxlLmp1c3RpZnlDb250ZW50ID0gImVuZCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibWlkZGxlIjoKICAgICAgICAgIHZhbHVlU3R5bGUuanVzdGlmeUNvbnRlbnQgPSAiY2VudGVyIjsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBjb25zdCBwYXJhU3R5bGUgPSBwYXJhW194ZmFfb2JqZWN0LiR0b1N0eWxlXSgpOwoKICAgICAgZm9yIChjb25zdCBba2V5LCB2YWxdIG9mIE9iamVjdC5lbnRyaWVzKHBhcmFTdHlsZSkpIHsKICAgICAgICBpZiAoIShrZXkgaW4gdmFsdWVTdHlsZSkpIHsKICAgICAgICAgIHZhbHVlU3R5bGVba2V5XSA9IHZhbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHNldEZvbnRGYW1pbHkoeGZhRm9udCwgbm9kZSwgZm9udEZpbmRlciwgc3R5bGUpIHsKICBpZiAoIWZvbnRGaW5kZXIpIHsKICAgIGRlbGV0ZSBzdHlsZS5mb250RmFtaWx5OwogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgbmFtZSA9ICgwLCBfdXRpbHMuc3RyaXBRdW90ZXMpKHhmYUZvbnQudHlwZWZhY2UpOwogIHN0eWxlLmZvbnRGYW1pbHkgPSBgIiR7bmFtZX0iYDsKICBjb25zdCB0eXBlZmFjZSA9IGZvbnRGaW5kZXIuZmluZChuYW1lKTsKCiAgaWYgKHR5cGVmYWNlKSB7CiAgICBjb25zdCB7CiAgICAgIGZvbnRGYW1pbHkKICAgIH0gPSB0eXBlZmFjZS5yZWd1bGFyLmNzc0ZvbnRJbmZvOwoKICAgIGlmIChmb250RmFtaWx5ICE9PSBuYW1lKSB7CiAgICAgIHN0eWxlLmZvbnRGYW1pbHkgPSBgIiR7Zm9udEZhbWlseX0iYDsKICAgIH0KCiAgICBjb25zdCBwYXJhID0gZ2V0Q3VycmVudFBhcmEobm9kZSk7CgogICAgaWYgKHBhcmEgJiYgcGFyYS5saW5lSGVpZ2h0ICE9PSAiIikgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHN0eWxlLmxpbmVIZWlnaHQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHBkZkZvbnQgPSAoMCwgX2ZvbnRzLnNlbGVjdEZvbnQpKHhmYUZvbnQsIHR5cGVmYWNlKTsKCiAgICBpZiAocGRmRm9udCkgewogICAgICBzdHlsZS5saW5lSGVpZ2h0ID0gTWF0aC5tYXgoMS4yLCBwZGZGb250LmxpbmVIZWlnaHQpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gZml4VVJMKHN0cikgewogIGNvbnN0IGFic29sdXRlVXJsID0gKDAsIF91dGlsLmNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwpKHN0ciwgbnVsbCwgewogICAgYWRkRGVmYXVsdFByb3RvY29sOiB0cnVlLAogICAgdHJ5Q29udmVydEVuY29kaW5nOiB0cnVlCiAgfSk7CiAgcmV0dXJuIGFic29sdXRlVXJsID8gYWJzb2x1dGVVcmwuaHJlZiA6IG51bGw7Cn0KCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkZvbnRGaW5kZXIgPSB2b2lkIDA7CmV4cG9ydHMuZ2V0TWV0cmljcyA9IGdldE1ldHJpY3M7CmV4cG9ydHMuc2VsZWN0Rm9udCA9IHNlbGVjdEZvbnQ7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBGb250RmluZGVyIHsKICBjb25zdHJ1Y3RvcihwZGZGb250cykgewogICAgdGhpcy5mb250cyA9IG5ldyBNYXAoKTsKICAgIHRoaXMuY2FjaGUgPSBuZXcgTWFwKCk7CiAgICB0aGlzLndhcm5lZCA9IG5ldyBTZXQoKTsKICAgIHRoaXMuZGVmYXVsdEZvbnQgPSBudWxsOwogICAgdGhpcy5hZGQocGRmRm9udHMpOwogIH0KCiAgYWRkKHBkZkZvbnRzLCByZWFsbHlNaXNzaW5nRm9udHMgPSBudWxsKSB7CiAgICBmb3IgKGNvbnN0IHBkZkZvbnQgb2YgcGRmRm9udHMpIHsKICAgICAgdGhpcy5hZGRQZGZGb250KHBkZkZvbnQpOwogICAgfQoKICAgIGZvciAoY29uc3QgcGRmRm9udCBvZiB0aGlzLmZvbnRzLnZhbHVlcygpKSB7CiAgICAgIGlmICghcGRmRm9udC5yZWd1bGFyKSB7CiAgICAgICAgcGRmRm9udC5yZWd1bGFyID0gcGRmRm9udC5pdGFsaWMgfHwgcGRmRm9udC5ib2xkIHx8IHBkZkZvbnQuYm9sZGl0YWxpYzsKICAgICAgfQogICAgfQoKICAgIGlmICghcmVhbGx5TWlzc2luZ0ZvbnRzIHx8IHJlYWxseU1pc3NpbmdGb250cy5zaXplID09PSAwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBteXJpYWQgPSB0aGlzLmZvbnRzLmdldCgiUGRmSlMtRmFsbGJhY2stUGRmSlMtWEZBIik7CgogICAgZm9yIChjb25zdCBtaXNzaW5nIG9mIHJlYWxseU1pc3NpbmdGb250cykgewogICAgICB0aGlzLmZvbnRzLnNldChtaXNzaW5nLCBteXJpYWQpOwogICAgfQogIH0KCiAgYWRkUGRmRm9udChwZGZGb250KSB7CiAgICBjb25zdCBjc3NGb250SW5mbyA9IHBkZkZvbnQuY3NzRm9udEluZm87CiAgICBjb25zdCBuYW1lID0gY3NzRm9udEluZm8uZm9udEZhbWlseTsKICAgIGxldCBmb250ID0gdGhpcy5mb250cy5nZXQobmFtZSk7CgogICAgaWYgKCFmb250KSB7CiAgICAgIGZvbnQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB0aGlzLmZvbnRzLnNldChuYW1lLCBmb250KTsKCiAgICAgIGlmICghdGhpcy5kZWZhdWx0Rm9udCkgewogICAgICAgIHRoaXMuZGVmYXVsdEZvbnQgPSBmb250OwogICAgICB9CiAgICB9CgogICAgbGV0IHByb3BlcnR5ID0gIiI7CiAgICBjb25zdCBmb250V2VpZ2h0ID0gcGFyc2VGbG9hdChjc3NGb250SW5mby5mb250V2VpZ2h0KTsKCiAgICBpZiAocGFyc2VGbG9hdChjc3NGb250SW5mby5pdGFsaWNBbmdsZSkgIT09IDApIHsKICAgICAgcHJvcGVydHkgPSBmb250V2VpZ2h0ID49IDcwMCA/ICJib2xkaXRhbGljIiA6ICJpdGFsaWMiOwogICAgfSBlbHNlIGlmIChmb250V2VpZ2h0ID49IDcwMCkgewogICAgICBwcm9wZXJ0eSA9ICJib2xkIjsKICAgIH0KCiAgICBpZiAoIXByb3BlcnR5KSB7CiAgICAgIGlmIChwZGZGb250Lm5hbWUuaW5jbHVkZXMoIkJvbGQiKSB8fCBwZGZGb250LnBzTmFtZSAmJiBwZGZGb250LnBzTmFtZS5pbmNsdWRlcygiQm9sZCIpKSB7CiAgICAgICAgcHJvcGVydHkgPSAiYm9sZCI7CiAgICAgIH0KCiAgICAgIGlmIChwZGZGb250Lm5hbWUuaW5jbHVkZXMoIkl0YWxpYyIpIHx8IHBkZkZvbnQubmFtZS5lbmRzV2l0aCgiSXQiKSB8fCBwZGZGb250LnBzTmFtZSAmJiAocGRmRm9udC5wc05hbWUuaW5jbHVkZXMoIkl0YWxpYyIpIHx8IHBkZkZvbnQucHNOYW1lLmVuZHNXaXRoKCJJdCIpKSkgewogICAgICAgIHByb3BlcnR5ICs9ICJpdGFsaWMiOwogICAgICB9CiAgICB9CgogICAgaWYgKCFwcm9wZXJ0eSkgewogICAgICBwcm9wZXJ0eSA9ICJyZWd1bGFyIjsKICAgIH0KCiAgICBmb250W3Byb3BlcnR5XSA9IHBkZkZvbnQ7CiAgfQoKICBnZXREZWZhdWx0KCkgewogICAgcmV0dXJuIHRoaXMuZGVmYXVsdEZvbnQ7CiAgfQoKICBmaW5kKGZvbnROYW1lLCBtdXN0V2FybiA9IHRydWUpIHsKICAgIGxldCBmb250ID0gdGhpcy5mb250cy5nZXQoZm9udE5hbWUpIHx8IHRoaXMuY2FjaGUuZ2V0KGZvbnROYW1lKTsKCiAgICBpZiAoZm9udCkgewogICAgICByZXR1cm4gZm9udDsKICAgIH0KCiAgICBjb25zdCBwYXR0ZXJuID0gLyx8LXxffCB8Ym9sZGl0YWxpY3xib2xkfGl0YWxpY3xyZWd1bGFyfGl0L2dpOwogICAgbGV0IG5hbWUgPSBmb250TmFtZS5yZXBsYWNlKHBhdHRlcm4sICIiKTsKICAgIGZvbnQgPSB0aGlzLmZvbnRzLmdldChuYW1lKTsKCiAgICBpZiAoZm9udCkgewogICAgICB0aGlzLmNhY2hlLnNldChmb250TmFtZSwgZm9udCk7CiAgICAgIHJldHVybiBmb250OwogICAgfQoKICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCBtYXliZSA9IFtdOwoKICAgIGZvciAoY29uc3QgW2ZhbWlseSwgcGRmRm9udF0gb2YgdGhpcy5mb250cy5lbnRyaWVzKCkpIHsKICAgICAgaWYgKGZhbWlseS5yZXBsYWNlKHBhdHRlcm4sICIiKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobmFtZSkpIHsKICAgICAgICBtYXliZS5wdXNoKHBkZkZvbnQpOwogICAgICB9CiAgICB9CgogICAgaWYgKG1heWJlLmxlbmd0aCA9PT0gMCkgewogICAgICBmb3IgKGNvbnN0IFssIHBkZkZvbnRdIG9mIHRoaXMuZm9udHMuZW50cmllcygpKSB7CiAgICAgICAgaWYgKHBkZkZvbnQucmVndWxhci5uYW1lICYmIHBkZkZvbnQucmVndWxhci5uYW1lLnJlcGxhY2UocGF0dGVybiwgIiIpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChuYW1lKSkgewogICAgICAgICAgbWF5YmUucHVzaChwZGZGb250KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAobWF5YmUubGVuZ3RoID09PSAwKSB7CiAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL3BzbXR8bXQvZ2ksICIiKTsKCiAgICAgIGZvciAoY29uc3QgW2ZhbWlseSwgcGRmRm9udF0gb2YgdGhpcy5mb250cy5lbnRyaWVzKCkpIHsKICAgICAgICBpZiAoZmFtaWx5LnJlcGxhY2UocGF0dGVybiwgIiIpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChuYW1lKSkgewogICAgICAgICAgbWF5YmUucHVzaChwZGZGb250KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAobWF5YmUubGVuZ3RoID09PSAwKSB7CiAgICAgIGZvciAoY29uc3QgcGRmRm9udCBvZiB0aGlzLmZvbnRzLnZhbHVlcygpKSB7CiAgICAgICAgaWYgKHBkZkZvbnQucmVndWxhci5uYW1lICYmIHBkZkZvbnQucmVndWxhci5uYW1lLnJlcGxhY2UocGF0dGVybiwgIiIpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChuYW1lKSkgewogICAgICAgICAgbWF5YmUucHVzaChwZGZGb250KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAobWF5YmUubGVuZ3RoID49IDEpIHsKICAgICAgaWYgKG1heWJlLmxlbmd0aCAhPT0gMSAmJiBtdXN0V2FybikgewogICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gVG9vIG1hbnkgY2hvaWNlcyB0byBndWVzcyB0aGUgY29ycmVjdCBmb250OiAke2ZvbnROYW1lfWApOwogICAgICB9CgogICAgICB0aGlzLmNhY2hlLnNldChmb250TmFtZSwgbWF5YmVbMF0pOwogICAgICByZXR1cm4gbWF5YmVbMF07CiAgICB9CgogICAgaWYgKG11c3RXYXJuICYmICF0aGlzLndhcm5lZC5oYXMoZm9udE5hbWUpKSB7CiAgICAgIHRoaXMud2FybmVkLmFkZChmb250TmFtZSk7CiAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gQ2Fubm90IGZpbmQgdGhlIGZvbnQ6ICR7Zm9udE5hbWV9YCk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKfQoKZXhwb3J0cy5Gb250RmluZGVyID0gRm9udEZpbmRlcjsKCmZ1bmN0aW9uIHNlbGVjdEZvbnQoeGZhRm9udCwgdHlwZWZhY2UpIHsKICBpZiAoeGZhRm9udC5wb3N0dXJlID09PSAiaXRhbGljIikgewogICAgaWYgKHhmYUZvbnQud2VpZ2h0ID09PSAiYm9sZCIpIHsKICAgICAgcmV0dXJuIHR5cGVmYWNlLmJvbGRpdGFsaWM7CiAgICB9CgogICAgcmV0dXJuIHR5cGVmYWNlLml0YWxpYzsKICB9IGVsc2UgaWYgKHhmYUZvbnQud2VpZ2h0ID09PSAiYm9sZCIpIHsKICAgIHJldHVybiB0eXBlZmFjZS5ib2xkOwogIH0KCiAgcmV0dXJuIHR5cGVmYWNlLnJlZ3VsYXI7Cn0KCmZ1bmN0aW9uIGdldE1ldHJpY3MoeGZhRm9udCwgcmVhbCA9IGZhbHNlKSB7CiAgbGV0IHBkZkZvbnQgPSBudWxsOwoKICBpZiAoeGZhRm9udCkgewogICAgY29uc3QgbmFtZSA9ICgwLCBfdXRpbHMuc3RyaXBRdW90ZXMpKHhmYUZvbnQudHlwZWZhY2UpOwoKICAgIGNvbnN0IHR5cGVmYWNlID0geGZhRm9udFtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlci5maW5kKG5hbWUpOwoKICAgIHBkZkZvbnQgPSBzZWxlY3RGb250KHhmYUZvbnQsIHR5cGVmYWNlKTsKICB9CgogIGlmICghcGRmRm9udCkgewogICAgcmV0dXJuIHsKICAgICAgbGluZUhlaWdodDogMTIsCiAgICAgIGxpbmVHYXA6IDIsCiAgICAgIGxpbmVOb0dhcDogMTAKICAgIH07CiAgfQoKICBjb25zdCBzaXplID0geGZhRm9udC5zaXplIHx8IDEwOwogIGNvbnN0IGxpbmVIZWlnaHQgPSBwZGZGb250LmxpbmVIZWlnaHQgPyBNYXRoLm1heChyZWFsID8gMCA6IDEuMiwgcGRmRm9udC5saW5lSGVpZ2h0KSA6IDEuMjsKICBjb25zdCBsaW5lR2FwID0gcGRmRm9udC5saW5lR2FwID09PSB1bmRlZmluZWQgPyAwLjIgOiBwZGZGb250LmxpbmVHYXA7CiAgcmV0dXJuIHsKICAgIGxpbmVIZWlnaHQ6IGxpbmVIZWlnaHQgKiBzaXplLAogICAgbGluZUdhcDogbGluZUdhcCAqIHNpemUsCiAgICBsaW5lTm9HYXA6IE1hdGgubWF4KDEsIGxpbmVIZWlnaHQgLSBsaW5lR2FwKSAqIHNpemUKICB9Owp9CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5UZXh0TWVhc3VyZSA9IHZvaWQgMDsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKCmNvbnN0IFdJRFRIX0ZBQ1RPUiA9IDEuMDI7CgpjbGFzcyBGb250SW5mbyB7CiAgY29uc3RydWN0b3IoeGZhRm9udCwgbWFyZ2luLCBsaW5lSGVpZ2h0LCBmb250RmluZGVyKSB7CiAgICB0aGlzLmxpbmVIZWlnaHQgPSBsaW5lSGVpZ2h0OwogICAgdGhpcy5wYXJhTWFyZ2luID0gbWFyZ2luIHx8IHsKICAgICAgdG9wOiAwLAogICAgICBib3R0b206IDAsCiAgICAgIGxlZnQ6IDAsCiAgICAgIHJpZ2h0OiAwCiAgICB9OwoKICAgIGlmICgheGZhRm9udCkgewogICAgICBbdGhpcy5wZGZGb250LCB0aGlzLnhmYUZvbnRdID0gdGhpcy5kZWZhdWx0Rm9udChmb250RmluZGVyKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMueGZhRm9udCA9IHsKICAgICAgdHlwZWZhY2U6IHhmYUZvbnQudHlwZWZhY2UsCiAgICAgIHBvc3R1cmU6IHhmYUZvbnQucG9zdHVyZSwKICAgICAgd2VpZ2h0OiB4ZmFGb250LndlaWdodCwKICAgICAgc2l6ZTogeGZhRm9udC5zaXplLAogICAgICBsZXR0ZXJTcGFjaW5nOiB4ZmFGb250LmxldHRlclNwYWNpbmcKICAgIH07CiAgICBjb25zdCB0eXBlZmFjZSA9IGZvbnRGaW5kZXIuZmluZCh4ZmFGb250LnR5cGVmYWNlKTsKCiAgICBpZiAoIXR5cGVmYWNlKSB7CiAgICAgIFt0aGlzLnBkZkZvbnQsIHRoaXMueGZhRm9udF0gPSB0aGlzLmRlZmF1bHRGb250KGZvbnRGaW5kZXIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5wZGZGb250ID0gKDAsIF9mb250cy5zZWxlY3RGb250KSh4ZmFGb250LCB0eXBlZmFjZSk7CgogICAgaWYgKCF0aGlzLnBkZkZvbnQpIHsKICAgICAgW3RoaXMucGRmRm9udCwgdGhpcy54ZmFGb250XSA9IHRoaXMuZGVmYXVsdEZvbnQoZm9udEZpbmRlcik7CiAgICB9CiAgfQoKICBkZWZhdWx0Rm9udChmb250RmluZGVyKSB7CiAgICBjb25zdCBmb250ID0gZm9udEZpbmRlci5maW5kKCJIZWx2ZXRpY2EiLCBmYWxzZSkgfHwgZm9udEZpbmRlci5maW5kKCJNeXJpYWQgUHJvIiwgZmFsc2UpIHx8IGZvbnRGaW5kZXIuZmluZCgiQXJpYWwiLCBmYWxzZSkgfHwgZm9udEZpbmRlci5nZXREZWZhdWx0KCk7CgogICAgaWYgKGZvbnQgJiYgZm9udC5yZWd1bGFyKSB7CiAgICAgIGNvbnN0IHBkZkZvbnQgPSBmb250LnJlZ3VsYXI7CiAgICAgIGNvbnN0IGluZm8gPSBwZGZGb250LmNzc0ZvbnRJbmZvOwogICAgICBjb25zdCB4ZmFGb250ID0gewogICAgICAgIHR5cGVmYWNlOiBpbmZvLmZvbnRGYW1pbHksCiAgICAgICAgcG9zdHVyZTogIm5vcm1hbCIsCiAgICAgICAgd2VpZ2h0OiAibm9ybWFsIiwKICAgICAgICBzaXplOiAxMCwKICAgICAgICBsZXR0ZXJTcGFjaW5nOiAwCiAgICAgIH07CiAgICAgIHJldHVybiBbcGRmRm9udCwgeGZhRm9udF07CiAgICB9CgogICAgY29uc3QgeGZhRm9udCA9IHsKICAgICAgdHlwZWZhY2U6ICJDb3VyaWVyIiwKICAgICAgcG9zdHVyZTogIm5vcm1hbCIsCiAgICAgIHdlaWdodDogIm5vcm1hbCIsCiAgICAgIHNpemU6IDEwLAogICAgICBsZXR0ZXJTcGFjaW5nOiAwCiAgICB9OwogICAgcmV0dXJuIFtudWxsLCB4ZmFGb250XTsKICB9Cgp9CgpjbGFzcyBGb250U2VsZWN0b3IgewogIGNvbnN0cnVjdG9yKGRlZmF1bHRYZmFGb250LCBkZWZhdWx0UGFyYU1hcmdpbiwgZGVmYXVsdExpbmVIZWlnaHQsIGZvbnRGaW5kZXIpIHsKICAgIHRoaXMuZm9udEZpbmRlciA9IGZvbnRGaW5kZXI7CiAgICB0aGlzLnN0YWNrID0gW25ldyBGb250SW5mbyhkZWZhdWx0WGZhRm9udCwgZGVmYXVsdFBhcmFNYXJnaW4sIGRlZmF1bHRMaW5lSGVpZ2h0LCBmb250RmluZGVyKV07CiAgfQoKICBwdXNoRGF0YSh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQpIHsKICAgIGNvbnN0IGxhc3RGb250ID0gdGhpcy5zdGFjay5hdCgtMSk7CgogICAgZm9yIChjb25zdCBuYW1lIG9mIFsidHlwZWZhY2UiLCAicG9zdHVyZSIsICJ3ZWlnaHQiLCAic2l6ZSIsICJsZXR0ZXJTcGFjaW5nIl0pIHsKICAgICAgaWYgKCF4ZmFGb250W25hbWVdKSB7CiAgICAgICAgeGZhRm9udFtuYW1lXSA9IGxhc3RGb250LnhmYUZvbnRbbmFtZV07CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgWyJ0b3AiLCAiYm90dG9tIiwgImxlZnQiLCAicmlnaHQiXSkgewogICAgICBpZiAoaXNOYU4obWFyZ2luW25hbWVdKSkgewogICAgICAgIG1hcmdpbltuYW1lXSA9IGxhc3RGb250LnBhcmFNYXJnaW5bbmFtZV07CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBmb250SW5mbyA9IG5ldyBGb250SW5mbyh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQgfHwgbGFzdEZvbnQubGluZUhlaWdodCwgdGhpcy5mb250RmluZGVyKTsKCiAgICBpZiAoIWZvbnRJbmZvLnBkZkZvbnQpIHsKICAgICAgZm9udEluZm8ucGRmRm9udCA9IGxhc3RGb250LnBkZkZvbnQ7CiAgICB9CgogICAgdGhpcy5zdGFjay5wdXNoKGZvbnRJbmZvKTsKICB9CgogIHBvcEZvbnQoKSB7CiAgICB0aGlzLnN0YWNrLnBvcCgpOwogIH0KCiAgdG9wRm9udCgpIHsKICAgIHJldHVybiB0aGlzLnN0YWNrLmF0KC0xKTsKICB9Cgp9CgpjbGFzcyBUZXh0TWVhc3VyZSB7CiAgY29uc3RydWN0b3IoZGVmYXVsdFhmYUZvbnQsIGRlZmF1bHRQYXJhTWFyZ2luLCBkZWZhdWx0TGluZUhlaWdodCwgZm9udHMpIHsKICAgIHRoaXMuZ2x5cGhzID0gW107CiAgICB0aGlzLmZvbnRTZWxlY3RvciA9IG5ldyBGb250U2VsZWN0b3IoZGVmYXVsdFhmYUZvbnQsIGRlZmF1bHRQYXJhTWFyZ2luLCBkZWZhdWx0TGluZUhlaWdodCwgZm9udHMpOwogICAgdGhpcy5leHRyYUhlaWdodCA9IDA7CiAgfQoKICBwdXNoRGF0YSh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQpIHsKICAgIHRoaXMuZm9udFNlbGVjdG9yLnB1c2hEYXRhKHhmYUZvbnQsIG1hcmdpbiwgbGluZUhlaWdodCk7CiAgfQoKICBwb3BGb250KHhmYUZvbnQpIHsKICAgIHJldHVybiB0aGlzLmZvbnRTZWxlY3Rvci5wb3BGb250KCk7CiAgfQoKICBhZGRQYXJhKCkgewogICAgY29uc3QgbGFzdEZvbnQgPSB0aGlzLmZvbnRTZWxlY3Rvci50b3BGb250KCk7CiAgICB0aGlzLmV4dHJhSGVpZ2h0ICs9IGxhc3RGb250LnBhcmFNYXJnaW4udG9wICsgbGFzdEZvbnQucGFyYU1hcmdpbi5ib3R0b207CiAgfQoKICBhZGRTdHJpbmcoc3RyKSB7CiAgICBpZiAoIXN0cikgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgbGFzdEZvbnQgPSB0aGlzLmZvbnRTZWxlY3Rvci50b3BGb250KCk7CiAgICBjb25zdCBmb250U2l6ZSA9IGxhc3RGb250LnhmYUZvbnQuc2l6ZTsKCiAgICBpZiAobGFzdEZvbnQucGRmRm9udCkgewogICAgICBjb25zdCBsZXR0ZXJTcGFjaW5nID0gbGFzdEZvbnQueGZhRm9udC5sZXR0ZXJTcGFjaW5nOwogICAgICBjb25zdCBwZGZGb250ID0gbGFzdEZvbnQucGRmRm9udDsKICAgICAgY29uc3QgZm9udExpbmVIZWlnaHQgPSBwZGZGb250LmxpbmVIZWlnaHQgfHwgMS4yOwogICAgICBjb25zdCBsaW5lSGVpZ2h0ID0gbGFzdEZvbnQubGluZUhlaWdodCB8fCBNYXRoLm1heCgxLjIsIGZvbnRMaW5lSGVpZ2h0KSAqIGZvbnRTaXplOwogICAgICBjb25zdCBsaW5lR2FwID0gcGRmRm9udC5saW5lR2FwID09PSB1bmRlZmluZWQgPyAwLjIgOiBwZGZGb250LmxpbmVHYXA7CiAgICAgIGNvbnN0IG5vR2FwID0gZm9udExpbmVIZWlnaHQgLSBsaW5lR2FwOwogICAgICBjb25zdCBmaXJzdExpbmVIZWlnaHQgPSBNYXRoLm1heCgxLCBub0dhcCkgKiBmb250U2l6ZTsKICAgICAgY29uc3Qgc2NhbGUgPSBmb250U2l6ZSAvIDEwMDA7CiAgICAgIGNvbnN0IGZhbGxiYWNrV2lkdGggPSBwZGZGb250LmRlZmF1bHRXaWR0aCB8fCBwZGZGb250LmNoYXJzVG9HbHlwaHMoIiAiKVswXS53aWR0aDsKCiAgICAgIGZvciAoY29uc3QgbGluZSBvZiBzdHIuc3BsaXQoL1tcdTIwMjlcbl0vKSkgewogICAgICAgIGNvbnN0IGVuY29kZWRMaW5lID0gcGRmRm9udC5lbmNvZGVTdHJpbmcobGluZSkuam9pbigiIik7CiAgICAgICAgY29uc3QgZ2x5cGhzID0gcGRmRm9udC5jaGFyc1RvR2x5cGhzKGVuY29kZWRMaW5lKTsKCiAgICAgICAgZm9yIChjb25zdCBnbHlwaCBvZiBnbHlwaHMpIHsKICAgICAgICAgIGNvbnN0IHdpZHRoID0gZ2x5cGgud2lkdGggfHwgZmFsbGJhY2tXaWR0aDsKICAgICAgICAgIHRoaXMuZ2x5cGhzLnB1c2goW3dpZHRoICogc2NhbGUgKyBsZXR0ZXJTcGFjaW5nLCBsaW5lSGVpZ2h0LCBmaXJzdExpbmVIZWlnaHQsIGdseXBoLnVuaWNvZGUsIGZhbHNlXSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmdseXBocy5wdXNoKFswLCAwLCAwLCAiXG4iLCB0cnVlXSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2x5cGhzLnBvcCgpOwogICAgICByZXR1cm47CiAgICB9CgogICAgZm9yIChjb25zdCBsaW5lIG9mIHN0ci5zcGxpdCgvW1x1MjAyOVxuXS8pKSB7CiAgICAgIGZvciAoY29uc3QgY2hhciBvZiBsaW5lLnNwbGl0KCIiKSkgewogICAgICAgIHRoaXMuZ2x5cGhzLnB1c2goW2ZvbnRTaXplLCAxLjIgKiBmb250U2l6ZSwgZm9udFNpemUsIGNoYXIsIGZhbHNlXSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2x5cGhzLnB1c2goWzAsIDAsIDAsICJcbiIsIHRydWVdKTsKICAgIH0KCiAgICB0aGlzLmdseXBocy5wb3AoKTsKICB9CgogIGNvbXB1dGUobWF4V2lkdGgpIHsKICAgIGxldCBsYXN0U3BhY2VQb3MgPSAtMSwKICAgICAgICBsYXN0U3BhY2VXaWR0aCA9IDAsCiAgICAgICAgd2lkdGggPSAwLAogICAgICAgIGhlaWdodCA9IDAsCiAgICAgICAgY3VycmVudExpbmVXaWR0aCA9IDAsCiAgICAgICAgY3VycmVudExpbmVIZWlnaHQgPSAwOwogICAgbGV0IGlzQnJva2VuID0gZmFsc2U7CiAgICBsZXQgaXNGaXJzdExpbmUgPSB0cnVlOwoKICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHRoaXMuZ2x5cGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgY29uc3QgW2dseXBoV2lkdGgsIGxpbmVIZWlnaHQsIGZpcnN0TGluZUhlaWdodCwgY2hhciwgaXNFT0xdID0gdGhpcy5nbHlwaHNbaV07CiAgICAgIGNvbnN0IGlzU3BhY2UgPSBjaGFyID09PSAiICI7CiAgICAgIGNvbnN0IGdseXBoSGVpZ2h0ID0gaXNGaXJzdExpbmUgPyBmaXJzdExpbmVIZWlnaHQgOiBsaW5lSGVpZ2h0OwoKICAgICAgaWYgKGlzRU9MKSB7CiAgICAgICAgd2lkdGggPSBNYXRoLm1heCh3aWR0aCwgY3VycmVudExpbmVXaWR0aCk7CiAgICAgICAgY3VycmVudExpbmVXaWR0aCA9IDA7CiAgICAgICAgaGVpZ2h0ICs9IGN1cnJlbnRMaW5lSGVpZ2h0OwogICAgICAgIGN1cnJlbnRMaW5lSGVpZ2h0ID0gZ2x5cGhIZWlnaHQ7CiAgICAgICAgbGFzdFNwYWNlUG9zID0gLTE7CiAgICAgICAgbGFzdFNwYWNlV2lkdGggPSAwOwogICAgICAgIGlzRmlyc3RMaW5lID0gZmFsc2U7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChpc1NwYWNlKSB7CiAgICAgICAgaWYgKGN1cnJlbnRMaW5lV2lkdGggKyBnbHlwaFdpZHRoID4gbWF4V2lkdGgpIHsKICAgICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIGN1cnJlbnRMaW5lV2lkdGgpOwogICAgICAgICAgY3VycmVudExpbmVXaWR0aCA9IDA7CiAgICAgICAgICBoZWlnaHQgKz0gY3VycmVudExpbmVIZWlnaHQ7CiAgICAgICAgICBjdXJyZW50TGluZUhlaWdodCA9IGdseXBoSGVpZ2h0OwogICAgICAgICAgbGFzdFNwYWNlUG9zID0gLTE7CiAgICAgICAgICBsYXN0U3BhY2VXaWR0aCA9IDA7CiAgICAgICAgICBpc0Jyb2tlbiA9IHRydWU7CiAgICAgICAgICBpc0ZpcnN0TGluZSA9IGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50TGluZUhlaWdodCA9IE1hdGgubWF4KGdseXBoSGVpZ2h0LCBjdXJyZW50TGluZUhlaWdodCk7CiAgICAgICAgICBsYXN0U3BhY2VXaWR0aCA9IGN1cnJlbnRMaW5lV2lkdGg7CiAgICAgICAgICBjdXJyZW50TGluZVdpZHRoICs9IGdseXBoV2lkdGg7CiAgICAgICAgICBsYXN0U3BhY2VQb3MgPSBpOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChjdXJyZW50TGluZVdpZHRoICsgZ2x5cGhXaWR0aCA+IG1heFdpZHRoKSB7CiAgICAgICAgaGVpZ2h0ICs9IGN1cnJlbnRMaW5lSGVpZ2h0OwogICAgICAgIGN1cnJlbnRMaW5lSGVpZ2h0ID0gZ2x5cGhIZWlnaHQ7CgogICAgICAgIGlmIChsYXN0U3BhY2VQb3MgIT09IC0xKSB7CiAgICAgICAgICBpID0gbGFzdFNwYWNlUG9zOwogICAgICAgICAgd2lkdGggPSBNYXRoLm1heCh3aWR0aCwgbGFzdFNwYWNlV2lkdGgpOwogICAgICAgICAgY3VycmVudExpbmVXaWR0aCA9IDA7CiAgICAgICAgICBsYXN0U3BhY2VQb3MgPSAtMTsKICAgICAgICAgIGxhc3RTcGFjZVdpZHRoID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd2lkdGggPSBNYXRoLm1heCh3aWR0aCwgY3VycmVudExpbmVXaWR0aCk7CiAgICAgICAgICBjdXJyZW50TGluZVdpZHRoID0gZ2x5cGhXaWR0aDsKICAgICAgICB9CgogICAgICAgIGlzQnJva2VuID0gdHJ1ZTsKICAgICAgICBpc0ZpcnN0TGluZSA9IGZhbHNlOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjdXJyZW50TGluZVdpZHRoICs9IGdseXBoV2lkdGg7CiAgICAgIGN1cnJlbnRMaW5lSGVpZ2h0ID0gTWF0aC5tYXgoZ2x5cGhIZWlnaHQsIGN1cnJlbnRMaW5lSGVpZ2h0KTsKICAgIH0KCiAgICB3aWR0aCA9IE1hdGgubWF4KHdpZHRoLCBjdXJyZW50TGluZVdpZHRoKTsKICAgIGhlaWdodCArPSBjdXJyZW50TGluZUhlaWdodCArIHRoaXMuZXh0cmFIZWlnaHQ7CiAgICByZXR1cm4gewogICAgICB3aWR0aDogV0lEVEhfRkFDVE9SICogd2lkdGgsCiAgICAgIGhlaWdodCwKICAgICAgaXNCcm9rZW4KICAgIH07CiAgfQoKfQoKZXhwb3J0cy5UZXh0TWVhc3VyZSA9IFRleHRNZWFzdXJlOwoKLyoqKi8gfSksCi8qIDg3ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRGF0YUhhbmRsZXIgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCmNsYXNzIERhdGFIYW5kbGVyIHsKICBjb25zdHJ1Y3Rvcihyb290LCBkYXRhKSB7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5kYXRhc2V0ID0gcm9vdC5kYXRhc2V0cyB8fCBudWxsOwogIH0KCiAgc2VyaWFsaXplKHN0b3JhZ2UpIHsKICAgIGNvbnN0IHN0YWNrID0gW1stMSwgdGhpcy5kYXRhW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKV1dOwoKICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IGxhc3QgPSBzdGFjay5hdCgtMSk7CiAgICAgIGNvbnN0IFtpLCBjaGlsZHJlbl0gPSBsYXN0OwoKICAgICAgaWYgKGkgKyAxID09PSBjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlblsrK2xhc3RbMF1dOwogICAgICBjb25zdCBzdG9yYWdlRW50cnkgPSBzdG9yYWdlLmdldChjaGlsZFtfeGZhX29iamVjdC4kdWlkXSk7CgogICAgICBpZiAoc3RvcmFnZUVudHJ5KSB7CiAgICAgICAgY2hpbGRbX3hmYV9vYmplY3QuJHNldFZhbHVlXShzdG9yYWdlRW50cnkpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBjaGlsZFtfeGZhX29iamVjdC4kZ2V0QXR0cmlidXRlc10oKTsKCiAgICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiBhdHRyaWJ1dGVzLnZhbHVlcygpKSB7CiAgICAgICAgICBjb25zdCBlbnRyeSA9IHN0b3JhZ2UuZ2V0KHZhbHVlW194ZmFfb2JqZWN0LiR1aWRdKTsKCiAgICAgICAgICBpZiAoZW50cnkpIHsKICAgICAgICAgICAgdmFsdWVbX3hmYV9vYmplY3QuJHNldFZhbHVlXShlbnRyeSk7CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IG5vZGVzID0gY2hpbGRbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpOwoKICAgICAgaWYgKG5vZGVzLmxlbmd0aCA+IDApIHsKICAgICAgICBzdGFjay5wdXNoKFstMSwgbm9kZXNdKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IGJ1ZiA9IFtgPHhmYTpkYXRhc2V0cyB4bWxuczp4ZmE9Imh0dHA6Ly93d3cueGZhLm9yZy9zY2hlbWEveGZhLWRhdGEvMS4wLyI+YF07CgogICAgaWYgKHRoaXMuZGF0YXNldCkgewogICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMuZGF0YXNldFtfeGZhX29iamVjdC4kZ2V0Q2hpbGRyZW5dKCkpIHsKICAgICAgICBpZiAoY2hpbGRbX3hmYV9vYmplY3QuJG5vZGVOYW1lXSAhPT0gImRhdGEiKSB7CiAgICAgICAgICBjaGlsZFtfeGZhX29iamVjdC4kdG9TdHJpbmddKGJ1Zik7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpcy5kYXRhW194ZmFfb2JqZWN0LiR0b1N0cmluZ10oYnVmKTsKCiAgICBidWYucHVzaCgiPC94ZmE6ZGF0YXNldHM+Iik7CiAgICByZXR1cm4gYnVmLmpvaW4oIiIpOwogIH0KCn0KCmV4cG9ydHMuRGF0YUhhbmRsZXIgPSBEYXRhSGFuZGxlcjsKCi8qKiovIH0pLAovKiA4OCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhGQVBhcnNlciA9IHZvaWQgMDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF94bWxfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Nik7Cgp2YXIgX2J1aWxkZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg5KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBYRkFQYXJzZXIgZXh0ZW5kcyBfeG1sX3BhcnNlci5YTUxQYXJzZXJCYXNlIHsKICBjb25zdHJ1Y3Rvcihyb290TmFtZVNwYWNlID0gbnVsbCwgcmljaFRleHQgPSBmYWxzZSkgewogICAgc3VwZXIoKTsKICAgIHRoaXMuX2J1aWxkZXIgPSBuZXcgX2J1aWxkZXIuQnVpbGRlcihyb290TmFtZVNwYWNlKTsKICAgIHRoaXMuX3N0YWNrID0gW107CiAgICB0aGlzLl9nbG9iYWxEYXRhID0gewogICAgICB1c2VkVHlwZWZhY2VzOiBuZXcgU2V0KCkKICAgIH07CiAgICB0aGlzLl9pZHMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9jdXJyZW50ID0gdGhpcy5fYnVpbGRlci5idWlsZFJvb3QodGhpcy5faWRzKTsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IF94bWxfcGFyc2VyLlhNTFBhcnNlckVycm9yQ29kZS5Ob0Vycm9yOwogICAgdGhpcy5fd2hpdGVSZWdleCA9IC9eXHMrJC87CiAgICB0aGlzLl9uYnNwcyA9IC9ceGEwKy9nOwogICAgdGhpcy5fcmljaFRleHQgPSByaWNoVGV4dDsKICB9CgogIHBhcnNlKGRhdGEpIHsKICAgIHRoaXMucGFyc2VYbWwoZGF0YSk7CgogICAgaWYgKHRoaXMuX2Vycm9yQ29kZSAhPT0gX3htbF9wYXJzZXIuWE1MUGFyc2VyRXJyb3JDb2RlLk5vRXJyb3IpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKTsKCiAgICByZXR1cm4gdGhpcy5fY3VycmVudC5lbGVtZW50OwogIH0KCiAgb25UZXh0KHRleHQpIHsKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UodGhpcy5fbmJzcHMsIG1hdGNoID0+IG1hdGNoLnNsaWNlKDEpICsgIiAiKTsKCiAgICBpZiAodGhpcy5fcmljaFRleHQgfHwgdGhpcy5fY3VycmVudFtfeGZhX29iamVjdC4kYWNjZXB0V2hpdGVzcGFjZV0oKSkgewogICAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvblRleHRdKHRleHQsIHRoaXMuX3JpY2hUZXh0KTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5fd2hpdGVSZWdleC50ZXN0KHRleHQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvblRleHRdKHRleHQudHJpbSgpKTsKICB9CgogIG9uQ2RhdGEodGV4dCkgewogICAgdGhpcy5fY3VycmVudFtfeGZhX29iamVjdC4kb25UZXh0XSh0ZXh0KTsKICB9CgogIF9ta0F0dHJpYnV0ZXMoYXR0cmlidXRlcywgdGFnTmFtZSkgewogICAgbGV0IG5hbWVzcGFjZSA9IG51bGw7CiAgICBsZXQgcHJlZml4ZXMgPSBudWxsOwogICAgY29uc3QgYXR0cmlidXRlT2JqID0gT2JqZWN0LmNyZWF0ZSh7fSk7CgogICAgZm9yIChjb25zdCB7CiAgICAgIG5hbWUsCiAgICAgIHZhbHVlCiAgICB9IG9mIGF0dHJpYnV0ZXMpIHsKICAgICAgaWYgKG5hbWUgPT09ICJ4bWxucyIpIHsKICAgICAgICBpZiAoIW5hbWVzcGFjZSkgewogICAgICAgICAgbmFtZXNwYWNlID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKShgWEZBIC0gbXVsdGlwbGUgbmFtZXNwYWNlIGRlZmluaXRpb24gaW4gPCR7dGFnTmFtZX0+YCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5hbWUuc3RhcnRzV2l0aCgieG1sbnM6IikpIHsKICAgICAgICBjb25zdCBwcmVmaXggPSBuYW1lLnN1YnN0cmluZygieG1sbnM6Ii5sZW5ndGgpOwoKICAgICAgICBpZiAoIXByZWZpeGVzKSB7CiAgICAgICAgICBwcmVmaXhlcyA9IFtdOwogICAgICAgIH0KCiAgICAgICAgcHJlZml4ZXMucHVzaCh7CiAgICAgICAgICBwcmVmaXgsCiAgICAgICAgICB2YWx1ZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGkgPSBuYW1lLmluZGV4T2YoIjoiKTsKCiAgICAgICAgaWYgKGkgPT09IC0xKSB7CiAgICAgICAgICBhdHRyaWJ1dGVPYmpbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IG5zQXR0cnMgPSBhdHRyaWJ1dGVPYmpbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc107CgogICAgICAgICAgaWYgKCFuc0F0dHJzKSB7CiAgICAgICAgICAgIG5zQXR0cnMgPSBhdHRyaWJ1dGVPYmpbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc10gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IFtucywgYXR0ck5hbWVdID0gW25hbWUuc2xpY2UoMCwgaSksIG5hbWUuc2xpY2UoaSArIDEpXTsKICAgICAgICAgIGxldCBhdHRycyA9IG5zQXR0cnNbbnNdOwoKICAgICAgICAgIGlmICghYXR0cnMpIHsKICAgICAgICAgICAgYXR0cnMgPSBuc0F0dHJzW25zXSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFtuYW1lc3BhY2UsIHByZWZpeGVzLCBhdHRyaWJ1dGVPYmpdOwogIH0KCiAgX2dldE5hbWVBbmRQcmVmaXgobmFtZSwgbnNBZ25vc3RpYykgewogICAgY29uc3QgaSA9IG5hbWUuaW5kZXhPZigiOiIpOwoKICAgIGlmIChpID09PSAtMSkgewogICAgICByZXR1cm4gW25hbWUsIG51bGxdOwogICAgfQoKICAgIHJldHVybiBbbmFtZS5zdWJzdHJpbmcoaSArIDEpLCBuc0Fnbm9zdGljID8gIiIgOiBuYW1lLnN1YnN0cmluZygwLCBpKV07CiAgfQoKICBvbkJlZ2luRWxlbWVudCh0YWdOYW1lLCBhdHRyaWJ1dGVzLCBpc0VtcHR5KSB7CiAgICBjb25zdCBbbmFtZXNwYWNlLCBwcmVmaXhlcywgYXR0cmlidXRlc09ial0gPSB0aGlzLl9ta0F0dHJpYnV0ZXMoYXR0cmlidXRlcywgdGFnTmFtZSk7CgogICAgY29uc3QgW25hbWUsIG5zUHJlZml4XSA9IHRoaXMuX2dldE5hbWVBbmRQcmVmaXgodGFnTmFtZSwgdGhpcy5fYnVpbGRlci5pc05zQWdub3N0aWMoKSk7CgogICAgY29uc3Qgbm9kZSA9IHRoaXMuX2J1aWxkZXIuYnVpbGQoewogICAgICBuc1ByZWZpeCwKICAgICAgbmFtZSwKICAgICAgYXR0cmlidXRlczogYXR0cmlidXRlc09iaiwKICAgICAgbmFtZXNwYWNlLAogICAgICBwcmVmaXhlcwogICAgfSk7CgogICAgbm9kZVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0gPSB0aGlzLl9nbG9iYWxEYXRhOwoKICAgIGlmIChpc0VtcHR5KSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpOwoKICAgICAgaWYgKHRoaXMuX2N1cnJlbnRbX3hmYV9vYmplY3QuJG9uQ2hpbGRdKG5vZGUpKSB7CiAgICAgICAgbm9kZVtfeGZhX29iamVjdC4kc2V0SWRdKHRoaXMuX2lkcyk7CiAgICAgIH0KCiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGNsZWFuXSh0aGlzLl9idWlsZGVyKTsKCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdGFjay5wdXNoKHRoaXMuX2N1cnJlbnQpOwoKICAgIHRoaXMuX2N1cnJlbnQgPSBub2RlOwogIH0KCiAgb25FbmRFbGVtZW50KG5hbWUpIHsKICAgIGNvbnN0IG5vZGUgPSB0aGlzLl9jdXJyZW50OwoKICAgIGlmIChub2RlW194ZmFfb2JqZWN0LiRpc0NEQVRBWG1sXSgpICYmIHR5cGVvZiBub2RlW194ZmFfb2JqZWN0LiRjb250ZW50XSA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgcGFyc2VyID0gbmV3IFhGQVBhcnNlcigpOwogICAgICBwYXJzZXIuX2dsb2JhbERhdGEgPSB0aGlzLl9nbG9iYWxEYXRhOwogICAgICBjb25zdCByb290ID0gcGFyc2VyLnBhcnNlKG5vZGVbX3hmYV9vYmplY3QuJGNvbnRlbnRdKTsKICAgICAgbm9kZVtfeGZhX29iamVjdC4kY29udGVudF0gPSBudWxsOwoKICAgICAgbm9kZVtfeGZhX29iamVjdC4kb25DaGlsZF0ocm9vdCk7CiAgICB9CgogICAgbm9kZVtfeGZhX29iamVjdC4kZmluYWxpemVdKCk7CgogICAgdGhpcy5fY3VycmVudCA9IHRoaXMuX3N0YWNrLnBvcCgpOwoKICAgIGlmICh0aGlzLl9jdXJyZW50W194ZmFfb2JqZWN0LiRvbkNoaWxkXShub2RlKSkgewogICAgICBub2RlW194ZmFfb2JqZWN0LiRzZXRJZF0odGhpcy5faWRzKTsKICAgIH0KCiAgICBub2RlW194ZmFfb2JqZWN0LiRjbGVhbl0odGhpcy5fYnVpbGRlcik7CiAgfQoKICBvbkVycm9yKGNvZGUpIHsKICAgIHRoaXMuX2Vycm9yQ29kZSA9IGNvZGU7CiAgfQoKfQoKZXhwb3J0cy5YRkFQYXJzZXIgPSBYRkFQYXJzZXI7CgovKioqLyB9KSwKLyogODkgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5CdWlsZGVyID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfc2V0dXAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkwKTsKCnZhciBfdGVtcGxhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgyKTsKCnZhciBfdW5rbm93biA9IF9fd19wZGZqc19yZXF1aXJlX18oOTkpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNsYXNzIFJvb3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGlkcykgewogICAgc3VwZXIoLTEsICJyb290IiwgT2JqZWN0LmNyZWF0ZShudWxsKSk7CiAgICB0aGlzLmVsZW1lbnQgPSBudWxsOwogICAgdGhpc1tfeGZhX29iamVjdC4kaWRzXSA9IGlkczsKICB9CgogIFtfeGZhX29iamVjdC4kb25DaGlsZF0oY2hpbGQpIHsKICAgIHRoaXMuZWxlbWVudCA9IGNoaWxkOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHN1cGVyW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKTsKCiAgICBpZiAodGhpcy5lbGVtZW50LnRlbXBsYXRlIGluc3RhbmNlb2YgX3RlbXBsYXRlLlRlbXBsYXRlKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGlkc10uc2V0KF94ZmFfb2JqZWN0LiRyb290LCB0aGlzLmVsZW1lbnQpOwoKICAgICAgdGhpcy5lbGVtZW50LnRlbXBsYXRlW194ZmFfb2JqZWN0LiRyZXNvbHZlUHJvdG90eXBlc10odGhpc1tfeGZhX29iamVjdC4kaWRzXSk7CgogICAgICB0aGlzLmVsZW1lbnQudGVtcGxhdGVbX3hmYV9vYmplY3QuJGlkc10gPSB0aGlzW194ZmFfb2JqZWN0LiRpZHNdOwogICAgfQogIH0KCn0KCmNsYXNzIEVtcHR5IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKC0xLCAiIiwgT2JqZWN0LmNyZWF0ZShudWxsKSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJG9uQ2hpbGRdKF8pIHsKICAgIHJldHVybiBmYWxzZTsKICB9Cgp9CgpjbGFzcyBCdWlsZGVyIHsKICBjb25zdHJ1Y3Rvcihyb290TmFtZVNwYWNlID0gbnVsbCkgewogICAgdGhpcy5fbmFtZXNwYWNlU3RhY2sgPSBbXTsKICAgIHRoaXMuX25zQWdub3N0aWNMZXZlbCA9IDA7CiAgICB0aGlzLl9uYW1lc3BhY2VQcmVmaXhlcyA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX25hbWVzcGFjZXMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9uZXh0TnNJZCA9IE1hdGgubWF4KC4uLk9iamVjdC52YWx1ZXMoX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzKS5tYXAoKHsKICAgICAgaWQKICAgIH0pID0+IGlkKSk7CiAgICB0aGlzLl9jdXJyZW50TmFtZXNwYWNlID0gcm9vdE5hbWVTcGFjZSB8fCBuZXcgX3Vua25vd24uVW5rbm93bk5hbWVzcGFjZSgrK3RoaXMuX25leHROc0lkKTsKICB9CgogIGJ1aWxkUm9vdChpZHMpIHsKICAgIHJldHVybiBuZXcgUm9vdChpZHMpOwogIH0KCiAgYnVpbGQoewogICAgbnNQcmVmaXgsCiAgICBuYW1lLAogICAgYXR0cmlidXRlcywKICAgIG5hbWVzcGFjZSwKICAgIHByZWZpeGVzCiAgfSkgewogICAgY29uc3QgaGFzTmFtZXNwYWNlRGVmID0gbmFtZXNwYWNlICE9PSBudWxsOwoKICAgIGlmIChoYXNOYW1lc3BhY2VEZWYpIHsKICAgICAgdGhpcy5fbmFtZXNwYWNlU3RhY2sucHVzaCh0aGlzLl9jdXJyZW50TmFtZXNwYWNlKTsKCiAgICAgIHRoaXMuX2N1cnJlbnROYW1lc3BhY2UgPSB0aGlzLl9zZWFyY2hOYW1lc3BhY2UobmFtZXNwYWNlKTsKICAgIH0KCiAgICBpZiAocHJlZml4ZXMpIHsKICAgICAgdGhpcy5fYWRkTmFtZXNwYWNlUHJlZml4KHByZWZpeGVzKTsKICAgIH0KCiAgICBpZiAoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShfeGZhX29iamVjdC4kbnNBdHRyaWJ1dGVzKSkgewogICAgICBjb25zdCBkYXRhVGVtcGxhdGUgPSBfc2V0dXAuTmFtZXNwYWNlU2V0VXAuZGF0YXNldHM7CiAgICAgIGNvbnN0IG5zQXR0cnMgPSBhdHRyaWJ1dGVzW194ZmFfb2JqZWN0LiRuc0F0dHJpYnV0ZXNdOwogICAgICBsZXQgeGZhQXR0cnMgPSBudWxsOwoKICAgICAgZm9yIChjb25zdCBbbnMsIGF0dHJzXSBvZiBPYmplY3QuZW50cmllcyhuc0F0dHJzKSkgewogICAgICAgIGNvbnN0IG5zVG9Vc2UgPSB0aGlzLl9nZXROYW1lc3BhY2VUb1VzZShucyk7CgogICAgICAgIGlmIChuc1RvVXNlID09PSBkYXRhVGVtcGxhdGUpIHsKICAgICAgICAgIHhmYUF0dHJzID0gewogICAgICAgICAgICB4ZmE6IGF0dHJzCiAgICAgICAgICB9OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoeGZhQXR0cnMpIHsKICAgICAgICBhdHRyaWJ1dGVzW194ZmFfb2JqZWN0LiRuc0F0dHJpYnV0ZXNdID0geGZhQXR0cnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNbX3hmYV9vYmplY3QuJG5zQXR0cmlidXRlc107CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBuYW1lc3BhY2VUb1VzZSA9IHRoaXMuX2dldE5hbWVzcGFjZVRvVXNlKG5zUHJlZml4KTsKCiAgICBjb25zdCBub2RlID0gbmFtZXNwYWNlVG9Vc2UgJiYgbmFtZXNwYWNlVG9Vc2VbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB8fCBuZXcgRW1wdHkoKTsKCiAgICBpZiAobm9kZVtfeGZhX29iamVjdC4kaXNOc0Fnbm9zdGljXSgpKSB7CiAgICAgIHRoaXMuX25zQWdub3N0aWNMZXZlbCsrOwogICAgfQoKICAgIGlmIChoYXNOYW1lc3BhY2VEZWYgfHwgcHJlZml4ZXMgfHwgbm9kZVtfeGZhX29iamVjdC4kaXNOc0Fnbm9zdGljXSgpKSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGNsZWFudXBdID0gewogICAgICAgIGhhc05hbWVzcGFjZTogaGFzTmFtZXNwYWNlRGVmLAogICAgICAgIHByZWZpeGVzLAogICAgICAgIG5zQWdub3N0aWM6IG5vZGVbX3hmYV9vYmplY3QuJGlzTnNBZ25vc3RpY10oKQogICAgICB9OwogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0KCiAgaXNOc0Fnbm9zdGljKCkgewogICAgcmV0dXJuIHRoaXMuX25zQWdub3N0aWNMZXZlbCA+IDA7CiAgfQoKICBfc2VhcmNoTmFtZXNwYWNlKG5zTmFtZSkgewogICAgbGV0IG5zID0gdGhpcy5fbmFtZXNwYWNlcy5nZXQobnNOYW1lKTsKCiAgICBpZiAobnMpIHsKICAgICAgcmV0dXJuIG5zOwogICAgfQoKICAgIGZvciAoY29uc3QgW25hbWUsIHsKICAgICAgY2hlY2sKICAgIH1dIG9mIE9iamVjdC5lbnRyaWVzKF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcykpIHsKICAgICAgaWYgKGNoZWNrKG5zTmFtZSkpIHsKICAgICAgICBucyA9IF9zZXR1cC5OYW1lc3BhY2VTZXRVcFtuYW1lXTsKCiAgICAgICAgaWYgKG5zKSB7CiAgICAgICAgICB0aGlzLl9uYW1lc3BhY2VzLnNldChuc05hbWUsIG5zKTsKCiAgICAgICAgICByZXR1cm4gbnM7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIG5zID0gbmV3IF91bmtub3duLlVua25vd25OYW1lc3BhY2UoKyt0aGlzLl9uZXh0TnNJZCk7CgogICAgdGhpcy5fbmFtZXNwYWNlcy5zZXQobnNOYW1lLCBucyk7CgogICAgcmV0dXJuIG5zOwogIH0KCiAgX2FkZE5hbWVzcGFjZVByZWZpeChwcmVmaXhlcykgewogICAgZm9yIChjb25zdCB7CiAgICAgIHByZWZpeCwKICAgICAgdmFsdWUKICAgIH0gb2YgcHJlZml4ZXMpIHsKICAgICAgY29uc3QgbmFtZXNwYWNlID0gdGhpcy5fc2VhcmNoTmFtZXNwYWNlKHZhbHVlKTsKCiAgICAgIGxldCBwcmVmaXhTdGFjayA9IHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLmdldChwcmVmaXgpOwoKICAgICAgaWYgKCFwcmVmaXhTdGFjaykgewogICAgICAgIHByZWZpeFN0YWNrID0gW107CgogICAgICAgIHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLnNldChwcmVmaXgsIHByZWZpeFN0YWNrKTsKICAgICAgfQoKICAgICAgcHJlZml4U3RhY2sucHVzaChuYW1lc3BhY2UpOwogICAgfQogIH0KCiAgX2dldE5hbWVzcGFjZVRvVXNlKHByZWZpeCkgewogICAgaWYgKCFwcmVmaXgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnROYW1lc3BhY2U7CiAgICB9CgogICAgY29uc3QgcHJlZml4U3RhY2sgPSB0aGlzLl9uYW1lc3BhY2VQcmVmaXhlcy5nZXQocHJlZml4KTsKCiAgICBpZiAocHJlZml4U3RhY2sgJiYgcHJlZml4U3RhY2subGVuZ3RoID4gMCkgewogICAgICByZXR1cm4gcHJlZml4U3RhY2suYXQoLTEpOwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKShgVW5rbm93biBuYW1lc3BhY2UgcHJlZml4OiAke3ByZWZpeH0uYCk7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGNsZWFuKGRhdGEpIHsKICAgIGNvbnN0IHsKICAgICAgaGFzTmFtZXNwYWNlLAogICAgICBwcmVmaXhlcywKICAgICAgbnNBZ25vc3RpYwogICAgfSA9IGRhdGE7CgogICAgaWYgKGhhc05hbWVzcGFjZSkgewogICAgICB0aGlzLl9jdXJyZW50TmFtZXNwYWNlID0gdGhpcy5fbmFtZXNwYWNlU3RhY2sucG9wKCk7CiAgICB9CgogICAgaWYgKHByZWZpeGVzKSB7CiAgICAgIHByZWZpeGVzLmZvckVhY2goKHsKICAgICAgICBwcmVmaXgKICAgICAgfSkgPT4gewogICAgICAgIHRoaXMuX25hbWVzcGFjZVByZWZpeGVzLmdldChwcmVmaXgpLnBvcCgpOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAobnNBZ25vc3RpYykgewogICAgICB0aGlzLl9uc0Fnbm9zdGljTGV2ZWwtLTsKICAgIH0KICB9Cgp9CgpleHBvcnRzLkJ1aWxkZXIgPSBCdWlsZGVyOwoKLyoqKi8gfSksCi8qIDkwICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTmFtZXNwYWNlU2V0VXAgPSB2b2lkIDA7Cgp2YXIgX2NvbmZpZyA9IF9fd19wZGZqc19yZXF1aXJlX18oOTEpOwoKdmFyIF9jb25uZWN0aW9uX3NldCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTIpOwoKdmFyIF9kYXRhc2V0cyA9IF9fd19wZGZqc19yZXF1aXJlX18oOTMpOwoKdmFyIF9sb2NhbGVfc2V0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg5NCk7Cgp2YXIgX3NpZ25hdHVyZSA9IF9fd19wZGZqc19yZXF1aXJlX18oOTUpOwoKdmFyIF9zdHlsZXNoZWV0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg5Nik7Cgp2YXIgX3RlbXBsYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Mik7Cgp2YXIgX3hkcCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTcpOwoKdmFyIF94aHRtbCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTgpOwoKY29uc3QgTmFtZXNwYWNlU2V0VXAgPSB7CiAgY29uZmlnOiBfY29uZmlnLkNvbmZpZ05hbWVzcGFjZSwKICBjb25uZWN0aW9uOiBfY29ubmVjdGlvbl9zZXQuQ29ubmVjdGlvblNldE5hbWVzcGFjZSwKICBkYXRhc2V0czogX2RhdGFzZXRzLkRhdGFzZXRzTmFtZXNwYWNlLAogIGxvY2FsZVNldDogX2xvY2FsZV9zZXQuTG9jYWxlU2V0TmFtZXNwYWNlLAogIHNpZ25hdHVyZTogX3NpZ25hdHVyZS5TaWduYXR1cmVOYW1lc3BhY2UsCiAgc3R5bGVzaGVldDogX3N0eWxlc2hlZXQuU3R5bGVzaGVldE5hbWVzcGFjZSwKICB0ZW1wbGF0ZTogX3RlbXBsYXRlLlRlbXBsYXRlTmFtZXNwYWNlLAogIHhkcDogX3hkcC5YZHBOYW1lc3BhY2UsCiAgeGh0bWw6IF94aHRtbC5YaHRtbE5hbWVzcGFjZQp9OwpleHBvcnRzLk5hbWVzcGFjZVNldFVwID0gTmFtZXNwYWNlU2V0VXA7CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Db25maWdOYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX25hbWVzcGFjZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc5KTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzgpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IENPTkZJR19OU19JRCA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkcy5jb25maWcuaWQ7CgpjbGFzcyBBY3JvYmF0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJhY3JvYmF0IiwgdHJ1ZSk7CiAgICB0aGlzLmFjcm9iYXQ3ID0gbnVsbDsKICAgIHRoaXMuYXV0b1NhdmUgPSBudWxsOwogICAgdGhpcy5jb21tb24gPSBudWxsOwogICAgdGhpcy52YWxpZGF0ZSA9IG51bGw7CiAgICB0aGlzLnZhbGlkYXRlQXBwcm92YWxTaWduYXR1cmVzID0gbnVsbDsKICAgIHRoaXMuc3VibWl0VXJsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgQWNyb2JhdDcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFjcm9iYXQ3IiwgdHJ1ZSk7CiAgICB0aGlzLmR5bmFtaWNSZW5kZXIgPSBudWxsOwogIH0KCn0KCmNsYXNzIEFEQkVfSlNDb25zb2xlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJBREJFX0pTQ29uc29sZSIsIFsiZGVsZWdhdGUiLCAiRW5hYmxlIiwgIkRpc2FibGUiXSk7CiAgfQoKfQoKY2xhc3MgQURCRV9KU0RlYnVnZ2VyIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJBREJFX0pTRGVidWdnZXIiLCBbImRlbGVnYXRlIiwgIkVuYWJsZSIsICJEaXNhYmxlIl0pOwogIH0KCn0KCmNsYXNzIEFkZFNpbGVudFByaW50IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFkZFNpbGVudFByaW50Iik7CiAgfQoKfQoKY2xhc3MgQWRkVmlld2VyUHJlZmVyZW5jZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWRkVmlld2VyUHJlZmVyZW5jZXMiKTsKICB9Cgp9CgpjbGFzcyBBZGp1c3REYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMTAgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFkanVzdERhdGEiKTsKICB9Cgp9CgpjbGFzcyBBZG9iZUV4dGVuc2lvbkxldmVsIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWRvYmVFeHRlbnNpb25MZXZlbCIsIDAsIG4gPT4gbiA+PSAxICYmIG4gPD0gOCk7CiAgfQoKfQoKY2xhc3MgQWdlbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFnZW50IiwgdHJ1ZSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgPyBhdHRyaWJ1dGVzLm5hbWUudHJpbSgpIDogIiI7CiAgICB0aGlzLmNvbW1vbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEFsd2F5c0VtYmVkIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYWx3YXlzRW1iZWQiKTsKICB9Cgp9CgpjbGFzcyBBbWQgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFtZCIpOwogIH0KCn0KCmNsYXNzIEFyZWEgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImFyZWEiKTsKICAgIHRoaXMubGV2ZWwgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5sZXZlbCwKICAgICAgZGVmYXVsdFZhbHVlOiAwLAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDEgJiYgbiA8PSAzCiAgICB9KTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsiIiwgImJhcmNvZGUiLCAiY29yZWluaXQiLCAiZGV2aWNlRHJpdmVyIiwgImZvbnQiLCAiZ2VuZXJhbCIsICJsYXlvdXQiLCAibWVyZ2UiLCAic2NyaXB0IiwgInNpZ25hdHVyZSIsICJzb3VyY2VTZXQiLCAidGVtcGxhdGVDYWNoZSJdKTsKICB9Cgp9CgpjbGFzcyBBdHRyaWJ1dGVzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJhdHRyaWJ1dGVzIiwgWyJwcmVzZXJ2ZSIsICJkZWxlZ2F0ZSIsICJpZ25vcmUiXSk7CiAgfQoKfQoKY2xhc3MgQXV0b1NhdmUgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImF1dG9TYXZlIiwgWyJkaXNhYmxlZCIsICJlbmFibGVkIl0pOwogIH0KCn0KCmNsYXNzIEJhc2UgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImJhc2UiKTsKICB9Cgp9CgpjbGFzcyBCYXRjaE91dHB1dCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYmF0Y2hPdXRwdXQiKTsKICAgIHRoaXMuZm9ybWF0ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuZm9ybWF0LCBbIm5vbmUiLCAiY29uY2F0IiwgInppcCIsICJ6aXBDb21wcmVzcyJdKTsKICB9Cgp9CgpjbGFzcyBCZWhhdmlvck92ZXJyaWRlIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiYmVoYXZpb3JPdmVycmlkZSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IG5ldyBNYXAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiB4LmluY2x1ZGVzKCI6IikpLm1hcCh4ID0+IHguc3BsaXQoIjoiLCAyKSkpOwogIH0KCn0KCmNsYXNzIENhY2hlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjYWNoZSIsIHRydWUpOwogICAgdGhpcy50ZW1wbGF0ZUNhY2hlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBDaGFuZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY2hhbmdlIik7CiAgfQoKfQoKY2xhc3MgQ29tbW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjb21tb24iLCB0cnVlKTsKICAgIHRoaXMuZGF0YSA9IG51bGw7CiAgICB0aGlzLmxvY2FsZSA9IG51bGw7CiAgICB0aGlzLmxvY2FsZVNldCA9IG51bGw7CiAgICB0aGlzLm1lc3NhZ2luZyA9IG51bGw7CiAgICB0aGlzLnN1cHByZXNzQmFubmVyID0gbnVsbDsKICAgIHRoaXMudGVtcGxhdGUgPSBudWxsOwogICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnaW5nID0gbnVsbDsKICAgIHRoaXMudmVyc2lvbkNvbnRyb2wgPSBudWxsOwogICAgdGhpcy5sb2cgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBDb21wcmVzcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY29tcHJlc3MiKTsKICAgIHRoaXMuc2NvcGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5zY29wZSwgWyJpbWFnZU9ubHkiLCAiZG9jdW1lbnQiXSk7CiAgfQoKfQoKY2xhc3MgQ29tcHJlc3NMb2dpY2FsU3RydWN0dXJlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzTG9naWNhbFN0cnVjdHVyZSIpOwogIH0KCn0KCmNsYXNzIENvbXByZXNzT2JqZWN0U3RyZWFtIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMTAgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzT2JqZWN0U3RyZWFtIik7CiAgfQoKfQoKY2xhc3MgQ29tcHJlc3Npb24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbXByZXNzaW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmNvbXByZXNzTG9naWNhbFN0cnVjdHVyZSA9IG51bGw7CiAgICB0aGlzLmNvbXByZXNzT2JqZWN0U3RyZWFtID0gbnVsbDsKICAgIHRoaXMubGV2ZWwgPSBudWxsOwogICAgdGhpcy50eXBlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBDb25maWcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvbmZpZyIsIHRydWUpOwogICAgdGhpcy5hY3JvYmF0ID0gbnVsbDsKICAgIHRoaXMucHJlc2VudCA9IG51bGw7CiAgICB0aGlzLnRyYWNlID0gbnVsbDsKICAgIHRoaXMuYWdlbnQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBDb25mb3JtYW5jZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiY29uZm9ybWFuY2UiLCBbIkEiLCAiQiJdKTsKICB9Cgp9CgpjbGFzcyBDb250ZW50Q29weSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjb250ZW50Q29weSIpOwogIH0KCn0KCmNsYXNzIENvcGllcyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImNvcGllcyIsIDEsIG4gPT4gbiA+PSAxKTsKICB9Cgp9CgpjbGFzcyBDcmVhdG9yIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjcmVhdG9yIik7CiAgfQoKfQoKY2xhc3MgQ3VycmVudFBhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5JbnRlZ2VyT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJjdXJyZW50UGFnZSIsIDAsIG4gPT4gbiA+PSAwKTsKICB9Cgp9CgpjbGFzcyBEYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJkYXRhIiwgdHJ1ZSk7CiAgICB0aGlzLmFkanVzdERhdGEgPSBudWxsOwogICAgdGhpcy5hdHRyaWJ1dGVzID0gbnVsbDsKICAgIHRoaXMuaW5jcmVtZW50YWxMb2FkID0gbnVsbDsKICAgIHRoaXMub3V0cHV0WFNMID0gbnVsbDsKICAgIHRoaXMucmFuZ2UgPSBudWxsOwogICAgdGhpcy5yZWNvcmQgPSBudWxsOwogICAgdGhpcy5zdGFydE5vZGUgPSBudWxsOwogICAgdGhpcy51cmkgPSBudWxsOwogICAgdGhpcy53aW5kb3cgPSBudWxsOwogICAgdGhpcy54c2wgPSBudWxsOwogICAgdGhpcy5leGNsdWRlTlMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudHJhbnNmb3JtID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRGVidWcgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRlYnVnIiwgdHJ1ZSk7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRGVmYXVsdFR5cGVmYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuQ29udGVudE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZGVmYXVsdFR5cGVmYWNlIik7CiAgICB0aGlzLndyaXRpbmdTY3JpcHQgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy53cml0aW5nU2NyaXB0LCBbIioiLCAiQXJhYmljIiwgIkN5cmlsbGljIiwgIkVhc3RFdXJvcGVhblJvbWFuIiwgIkdyZWVrIiwgIkhlYnJldyIsICJKYXBhbmVzZSIsICJLb3JlYW4iLCAiUm9tYW4iLCAiU2ltcGxpZmllZENoaW5lc2UiLCAiVGhhaSIsICJUcmFkaXRpb25hbENoaW5lc2UiLCAiVmlldG5hbWVzZSJdKTsKICB9Cgp9CgpjbGFzcyBEZXN0aW5hdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZGVzdGluYXRpb24iLCBbInBkZiIsICJwY2wiLCAicHMiLCAid2ViQ2xpZW50IiwgInpwbCJdKTsKICB9Cgp9CgpjbGFzcyBEb2N1bWVudEFzc2VtYmx5IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRvY3VtZW50QXNzZW1ibHkiKTsKICB9Cgp9CgpjbGFzcyBEcml2ZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImRyaXZlciIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lID8gYXR0cmlidXRlcy5uYW1lLnRyaW0oKSA6ICIiOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgRHVwbGV4T3B0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJkdXBsZXhPcHRpb24iLCBbInNpbXBsZXgiLCAiZHVwbGV4RmxpcExvbmdFZGdlIiwgImR1cGxleEZsaXBTaG9ydEVkZ2UiXSk7CiAgfQoKfQoKY2xhc3MgRHluYW1pY1JlbmRlciBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZHluYW1pY1JlbmRlciIsIFsiZm9yYmlkZGVuIiwgInJlcXVpcmVkIl0pOwogIH0KCn0KCmNsYXNzIEVtYmVkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImVtYmVkIik7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJlbmNyeXB0Iik7CiAgfQoKfQoKY2xhc3MgRW5jcnlwdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5jcnlwdGlvbiIsIHRydWUpOwogICAgdGhpcy5lbmNyeXB0ID0gbnVsbDsKICAgIHRoaXMuZW5jcnlwdGlvbkxldmVsID0gbnVsbDsKICAgIHRoaXMucGVybWlzc2lvbnMgPSBudWxsOwogIH0KCn0KCmNsYXNzIEVuY3J5cHRpb25MZXZlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5jcnlwdGlvbkxldmVsIiwgWyI0MGJpdCIsICIxMjhiaXQiXSk7CiAgfQoKfQoKY2xhc3MgRW5mb3JjZSBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZW5mb3JjZSIpOwogIH0KCn0KCmNsYXNzIEVxdWF0ZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZXF1YXRlIik7CiAgICB0aGlzLmZvcmNlID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMuZm9yY2UsCiAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgdmFsaWRhdGU6IG4gPT4gbiA9PT0gMAogICAgfSk7CiAgICB0aGlzLmZyb20gPSBhdHRyaWJ1dGVzLmZyb20gfHwgIiI7CiAgICB0aGlzLnRvID0gYXR0cmlidXRlcy50byB8fCAiIjsKICB9Cgp9CgpjbGFzcyBFcXVhdGVSYW5nZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZXF1YXRlUmFuZ2UiKTsKICAgIHRoaXMuZnJvbSA9IGF0dHJpYnV0ZXMuZnJvbSB8fCAiIjsKICAgIHRoaXMudG8gPSBhdHRyaWJ1dGVzLnRvIHx8ICIiOwogICAgdGhpcy5fdW5pY29kZVJhbmdlID0gYXR0cmlidXRlcy51bmljb2RlUmFuZ2UgfHwgIiI7CiAgfQoKICBnZXQgdW5pY29kZVJhbmdlKCkgewogICAgY29uc3QgcmFuZ2VzID0gW107CiAgICBjb25zdCB1bmljb2RlUmVnZXggPSAvVVwrKFswLTlhLWZBLUZdKykvOwogICAgY29uc3QgdW5pY29kZVJhbmdlID0gdGhpcy5fdW5pY29kZVJhbmdlOwoKICAgIGZvciAobGV0IHJhbmdlIG9mIHVuaWNvZGVSYW5nZS5zcGxpdCgiLCIpLm1hcCh4ID0+IHgudHJpbSgpKS5maWx0ZXIoeCA9PiAhIXgpKSB7CiAgICAgIHJhbmdlID0gcmFuZ2Uuc3BsaXQoIi0iLCAyKS5tYXAoeCA9PiB7CiAgICAgICAgY29uc3QgZm91bmQgPSB4Lm1hdGNoKHVuaWNvZGVSZWdleCk7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGZvdW5kWzFdLCAxNik7CiAgICAgIH0pOwoKICAgICAgaWYgKHJhbmdlLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHJhbmdlLnB1c2gocmFuZ2VbMF0pOwogICAgICB9CgogICAgICByYW5nZXMucHVzaChyYW5nZSk7CiAgICB9CgogICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ1bmljb2RlUmFuZ2UiLCByYW5nZXMpOwogIH0KCn0KCmNsYXNzIEV4Y2x1ZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJleGNsdWRlIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiB4ICYmIFsiY2FsY3VsYXRlIiwgImNsb3NlIiwgImVudGVyIiwgImV4aXQiLCAiaW5pdGlhbGl6ZSIsICJyZWFkeSIsICJ2YWxpZGF0ZSJdLmluY2x1ZGVzKHgpKTsKICB9Cgp9CgpjbGFzcyBFeGNsdWRlTlMgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImV4Y2x1ZGVOUyIpOwogIH0KCn0KCmNsYXNzIEZsaXBMYWJlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZmxpcExhYmVsIiwgWyJ1c2VQcmludGVyU2V0dGluZyIsICJvbiIsICJvZmYiXSk7CiAgfQoKfQoKY2xhc3MgRm9udEluZm8gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImZvbnRJbmZvIiwgdHJ1ZSk7CiAgICB0aGlzLmVtYmVkID0gbnVsbDsKICAgIHRoaXMubWFwID0gbnVsbDsKICAgIHRoaXMuc3Vic2V0QmVsb3cgPSBudWxsOwogICAgdGhpcy5hbHdheXNFbWJlZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5kZWZhdWx0VHlwZWZhY2UgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMubmV2ZXJFbWJlZCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIEZvcm1GaWVsZEZpbGxpbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiZm9ybUZpZWxkRmlsbGluZyIpOwogIH0KCn0KCmNsYXNzIEdyb3VwUGFyZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJncm91cFBhcmVudCIpOwogIH0KCn0KCmNsYXNzIElmRW1wdHkgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImlmRW1wdHkiLCBbImRhdGFWYWx1ZSIsICJkYXRhR3JvdXAiLCAiaWdub3JlIiwgInJlbW92ZSJdKTsKICB9Cgp9CgpjbGFzcyBJbmNsdWRlWERQQ29udGVudCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiaW5jbHVkZVhEUENvbnRlbnQiKTsKICB9Cgp9CgpjbGFzcyBJbmNyZW1lbnRhbExvYWQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImluY3JlbWVudGFsTG9hZCIsIFsibm9uZSIsICJmb3J3YXJkT25seSJdKTsKICB9Cgp9CgpjbGFzcyBJbmNyZW1lbnRhbE1lcmdlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImluY3JlbWVudGFsTWVyZ2UiKTsKICB9Cgp9CgpjbGFzcyBJbnRlcmFjdGl2ZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJpbnRlcmFjdGl2ZSIpOwogIH0KCn0KCmNsYXNzIEpvZyBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAiam9nIiwgWyJ1c2VQcmludGVyU2V0dGluZyIsICJub25lIiwgInBhZ2VTZXQiXSk7CiAgfQoKfQoKY2xhc3MgTGFiZWxQcmludGVyIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsYWJlbFByaW50ZXIiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsienBsIiwgImRwbCIsICJpcGwiLCAidGNwbCJdKTsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mbGlwTGFiZWwgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgTGF5b3V0IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsYXlvdXQiLCBbInBhZ2luYXRlIiwgInBhbmVsIl0pOwogIH0KCn0KCmNsYXNzIExldmVsIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibGV2ZWwiLCAwLCBuID0+IG4gPiAwKTsKICB9Cgp9CgpjbGFzcyBMaW5lYXJpemVkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImxpbmVhcml6ZWQiKTsKICB9Cgp9CgpjbGFzcyBMb2NhbGUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgImxvY2FsZSIpOwogIH0KCn0KCmNsYXNzIExvY2FsZVNldCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibG9jYWxlU2V0Iik7CiAgfQoKfQoKY2xhc3MgTG9nIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJsb2ciLCB0cnVlKTsKICAgIHRoaXMubW9kZSA9IG51bGw7CiAgICB0aGlzLnRocmVzaG9sZCA9IG51bGw7CiAgICB0aGlzLnRvID0gbnVsbDsKICAgIHRoaXMudXJpID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBNYXBFbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJtYXAiLCB0cnVlKTsKICAgIHRoaXMuZXF1YXRlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLmVxdWF0ZVJhbmdlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgTWVkaXVtSW5mbyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibWVkaXVtSW5mbyIsIHRydWUpOwogICAgdGhpcy5tYXAgPSBudWxsOwogIH0KCn0KCmNsYXNzIE1lc3NhZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1lc3NhZ2UiLCB0cnVlKTsKICAgIHRoaXMubXNnSWQgPSBudWxsOwogICAgdGhpcy5zZXZlcml0eSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgTWVzc2FnaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJtZXNzYWdpbmciLCB0cnVlKTsKICAgIHRoaXMubWVzc2FnZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIE1vZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1vZGUiLCBbImFwcGVuZCIsICJvdmVyd3JpdGUiXSk7CiAgfQoKfQoKY2xhc3MgTW9kaWZ5QW5ub3RzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm1vZGlmeUFubm90cyIpOwogIH0KCn0KCmNsYXNzIE1zZ0lkIGV4dGVuZHMgX3hmYV9vYmplY3QuSW50ZWdlck9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAibXNnSWQiLCAxLCBuID0+IG4gPj0gMSk7CiAgfQoKfQoKY2xhc3MgTmFtZUF0dHIgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm5hbWVBdHRyIik7CiAgfQoKfQoKY2xhc3MgTmV2ZXJFbWJlZCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm5ldmVyRW1iZWQiKTsKICB9Cgp9CgpjbGFzcyBOdW1iZXJPZkNvcGllcyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm51bWJlck9mQ29waWVzIiwgbnVsbCwgbiA9PiBuID49IDIgJiYgbiA8PSA1KTsKICB9Cgp9CgpjbGFzcyBPcGVuQWN0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJvcGVuQWN0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmRlc3RpbmF0aW9uID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBPdXRwdXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm91dHB1dCIsIHRydWUpOwogICAgdGhpcy50byA9IG51bGw7CiAgICB0aGlzLnR5cGUgPSBudWxsOwogICAgdGhpcy51cmkgPSBudWxsOwogIH0KCn0KCmNsYXNzIE91dHB1dEJpbiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAib3V0cHV0QmluIik7CiAgfQoKfQoKY2xhc3MgT3V0cHV0WFNMIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJvdXRwdXRYU0wiLCB0cnVlKTsKICAgIHRoaXMudXJpID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBPdmVycHJpbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgIm92ZXJwcmludCIsIFsibm9uZSIsICJib3RoIiwgImRyYXciLCAiZmllbGQiXSk7CiAgfQoKfQoKY2xhc3MgUGFja2V0cyBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGFja2V0cyIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICBpZiAodGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPT09ICIqIikgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCkuc3BsaXQoL1xzKy8pLmZpbHRlcih4ID0+IFsiY29uZmlnIiwgImRhdGFzZXRzIiwgInRlbXBsYXRlIiwgInhmZGYiLCAieHNsdCJdLmluY2x1ZGVzKHgpKTsKICB9Cgp9CgpjbGFzcyBQYWdlT2Zmc2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYWdlT2Zmc2V0Iik7CiAgICB0aGlzLnggPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy54LAogICAgICBkZWZhdWx0VmFsdWU6ICJ1c2VYRENTZXR0aW5nIiwKICAgICAgdmFsaWRhdGU6IG4gPT4gdHJ1ZQogICAgfSk7CiAgICB0aGlzLnkgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy55LAogICAgICBkZWZhdWx0VmFsdWU6ICJ1c2VYRENTZXR0aW5nIiwKICAgICAgdmFsaWRhdGU6IG4gPT4gdHJ1ZQogICAgfSk7CiAgfQoKfQoKY2xhc3MgUGFnZVJhbmdlIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYWdlUmFuZ2UiKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgbnVtYmVycyA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMrLykubWFwKHggPT4gcGFyc2VJbnQoeCwgMTApKTsKCiAgICBjb25zdCByYW5nZXMgPSBbXTsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBudW1iZXJzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHsKICAgICAgcmFuZ2VzLnB1c2gobnVtYmVycy5zbGljZShpLCBpICsgMikpOwogICAgfQoKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gcmFuZ2VzOwogIH0KCn0KCmNsYXNzIFBhZ2luYXRpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBhZ2luYXRpb24iLCBbInNpbXBsZXgiLCAiZHVwbGV4U2hvcnRFZGdlIiwgImR1cGxleExvbmdFZGdlIl0pOwogIH0KCn0KCmNsYXNzIFBhZ2luYXRpb25PdmVycmlkZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGFnaW5hdGlvbk92ZXJyaWRlIiwgWyJub25lIiwgImZvcmNlRHVwbGV4IiwgImZvcmNlRHVwbGV4TG9uZ0VkZ2UiLCAiZm9yY2VEdXBsZXhTaG9ydEVkZ2UiLCAiZm9yY2VTaW1wbGV4Il0pOwogIH0KCn0KCmNsYXNzIFBhcnQgZXh0ZW5kcyBfeGZhX29iamVjdC5JbnRlZ2VyT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwYXJ0IiwgMSwgbiA9PiBmYWxzZSk7CiAgfQoKfQoKY2xhc3MgUGNsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwY2wiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLmpvZyA9IG51bGw7CiAgICB0aGlzLm1lZGl1bUluZm8gPSBudWxsOwogICAgdGhpcy5vdXRwdXRCaW4gPSBudWxsOwogICAgdGhpcy5wYWdlT2Zmc2V0ID0gbnVsbDsKICAgIHRoaXMuc3RhcGxlID0gbnVsbDsKICAgIHRoaXMueGRjID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBQZGYgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBkZiIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5hZG9iZUV4dGVuc2lvbkxldmVsID0gbnVsbDsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5jb21wcmVzc2lvbiA9IG51bGw7CiAgICB0aGlzLmNyZWF0b3IgPSBudWxsOwogICAgdGhpcy5lbmNyeXB0aW9uID0gbnVsbDsKICAgIHRoaXMuZm9udEluZm8gPSBudWxsOwogICAgdGhpcy5pbnRlcmFjdGl2ZSA9IG51bGw7CiAgICB0aGlzLmxpbmVhcml6ZWQgPSBudWxsOwogICAgdGhpcy5vcGVuQWN0aW9uID0gbnVsbDsKICAgIHRoaXMucGRmYSA9IG51bGw7CiAgICB0aGlzLnByb2R1Y2VyID0gbnVsbDsKICAgIHRoaXMucmVuZGVyUG9saWN5ID0gbnVsbDsKICAgIHRoaXMuc2NyaXB0TW9kZWwgPSBudWxsOwogICAgdGhpcy5zaWxlbnRQcmludCA9IG51bGw7CiAgICB0aGlzLnN1Ym1pdEZvcm1hdCA9IG51bGw7CiAgICB0aGlzLnRhZ2dlZCA9IG51bGw7CiAgICB0aGlzLnZlcnNpb24gPSBudWxsOwogICAgdGhpcy52aWV3ZXJQcmVmZXJlbmNlcyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUGRmYSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAicGRmYSIsIHRydWUpOwogICAgdGhpcy5hbWQgPSBudWxsOwogICAgdGhpcy5jb25mb3JtYW5jZSA9IG51bGw7CiAgICB0aGlzLmluY2x1ZGVYRFBDb250ZW50ID0gbnVsbDsKICAgIHRoaXMucGFydCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUGVybWlzc2lvbnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBlcm1pc3Npb25zIiwgdHJ1ZSk7CiAgICB0aGlzLmFjY2Vzc2libGVDb250ZW50ID0gbnVsbDsKICAgIHRoaXMuY2hhbmdlID0gbnVsbDsKICAgIHRoaXMuY29udGVudENvcHkgPSBudWxsOwogICAgdGhpcy5kb2N1bWVudEFzc2VtYmx5ID0gbnVsbDsKICAgIHRoaXMuZm9ybUZpZWxkRmlsbGluZyA9IG51bGw7CiAgICB0aGlzLm1vZGlmeUFubm90cyA9IG51bGw7CiAgICB0aGlzLnBsYWludGV4dE1ldGFkYXRhID0gbnVsbDsKICAgIHRoaXMucHJpbnQgPSBudWxsOwogICAgdGhpcy5wcmludEhpZ2hRdWFsaXR5ID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBQaWNrVHJheUJ5UERGU2l6ZSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwaWNrVHJheUJ5UERGU2l6ZSIpOwogIH0KCn0KCmNsYXNzIFBpY3R1cmUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInBpY3R1cmUiKTsKICB9Cgp9CgpjbGFzcyBQbGFpbnRleHRNZXRhZGF0YSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwbGFpbnRleHRNZXRhZGF0YSIpOwogIH0KCn0KCmNsYXNzIFByZXNlbmNlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmVzZW5jZSIsIFsicHJlc2VydmUiLCAiZGlzc29sdmUiLCAiZGlzc29sdmVTdHJ1Y3R1cmUiLCAiaWdub3JlIiwgInJlbW92ZSJdKTsKICB9Cgp9CgpjbGFzcyBQcmVzZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmVzZW50IiwgdHJ1ZSk7CiAgICB0aGlzLmJlaGF2aW9yT3ZlcnJpZGUgPSBudWxsOwogICAgdGhpcy5jYWNoZSA9IG51bGw7CiAgICB0aGlzLmNvbW1vbiA9IG51bGw7CiAgICB0aGlzLmNvcGllcyA9IG51bGw7CiAgICB0aGlzLmRlc3RpbmF0aW9uID0gbnVsbDsKICAgIHRoaXMuaW5jcmVtZW50YWxNZXJnZSA9IG51bGw7CiAgICB0aGlzLmxheW91dCA9IG51bGw7CiAgICB0aGlzLm91dHB1dCA9IG51bGw7CiAgICB0aGlzLm92ZXJwcmludCA9IG51bGw7CiAgICB0aGlzLnBhZ2luYXRpb24gPSBudWxsOwogICAgdGhpcy5wYWdpbmF0aW9uT3ZlcnJpZGUgPSBudWxsOwogICAgdGhpcy5zY3JpcHQgPSBudWxsOwogICAgdGhpcy52YWxpZGF0ZSA9IG51bGw7CiAgICB0aGlzLnhkcCA9IG51bGw7CiAgICB0aGlzLmRyaXZlciA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5sYWJlbFByaW50ZXIgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMucGNsID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnBkZiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5wcyA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy5zdWJtaXRVcmwgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMud2ViQ2xpZW50ID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgICB0aGlzLnpwbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIFByaW50IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uMDEgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInByaW50Iik7CiAgfQoKfQoKY2xhc3MgUHJpbnRIaWdoUXVhbGl0eSBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbjAxIHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludEhpZ2hRdWFsaXR5Iik7CiAgfQoKfQoKY2xhc3MgUHJpbnRTY2FsaW5nIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludFNjYWxpbmciLCBbImFwcGRlZmF1bHQiLCAibm9TY2FsaW5nIl0pOwogIH0KCn0KCmNsYXNzIFByaW50ZXJOYW1lIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcmludGVyTmFtZSIpOwogIH0KCn0KCmNsYXNzIFByb2R1Y2VyIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcm9kdWNlciIpOwogIH0KCn0KCmNsYXNzIFBzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJwcyIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy5iYXRjaE91dHB1dCA9IG51bGw7CiAgICB0aGlzLmZvbnRJbmZvID0gbnVsbDsKICAgIHRoaXMuam9nID0gbnVsbDsKICAgIHRoaXMubWVkaXVtSW5mbyA9IG51bGw7CiAgICB0aGlzLm91dHB1dEJpbiA9IG51bGw7CiAgICB0aGlzLnN0YXBsZSA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgUmFuZ2UgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJyYW5nZSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMqLFxzKi8sIDIpLm1hcChyYW5nZSA9PiByYW5nZS5zcGxpdCgiLSIpLm1hcCh4ID0+IHBhcnNlSW50KHgudHJpbSgpLCAxMCkpKS5maWx0ZXIocmFuZ2UgPT4gcmFuZ2UuZXZlcnkoeCA9PiAhaXNOYU4oeCkpKS5tYXAocmFuZ2UgPT4gewogICAgICBpZiAocmFuZ2UubGVuZ3RoID09PSAxKSB7CiAgICAgICAgcmFuZ2UucHVzaChyYW5nZVswXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByYW5nZTsKICAgIH0pOwogIH0KCn0KCmNsYXNzIFJlY29yZCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlY29yZCIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRmaW5hbGl6ZV0oKSB7CiAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKTsKICAgIGNvbnN0IG4gPSBwYXJzZUludCh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSwgMTApOwoKICAgIGlmICghaXNOYU4obikgJiYgbiA+PSAwKSB7CiAgICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gbjsKICAgIH0KICB9Cgp9CgpjbGFzcyBSZWxldmFudCBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlbGV2YW50Iik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKTsKICB9Cgp9CgpjbGFzcyBSZW5hbWUgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJyZW5hbWUiKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XS50cmltKCk7CgogICAgaWYgKHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgieG1sIikgfHwgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0ubWF0Y2gobmV3IFJlZ0V4cCgiW1xccHtMfV9dW1xccHtMfVxcZC5fXFxwe019LV0qIiwgInUiKSkpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJYRkEgLSBSZW5hbWU6IGludmFsaWQgWEZBIG5hbWUiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBSZW5kZXJQb2xpY3kgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInJlbmRlclBvbGljeSIsIFsic2VydmVyIiwgImNsaWVudCJdKTsKICB9Cgp9CgpjbGFzcyBSdW5TY3JpcHRzIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJydW5TY3JpcHRzIiwgWyJib3RoIiwgImNsaWVudCIsICJub25lIiwgInNlcnZlciJdKTsKICB9Cgp9CgpjbGFzcyBTY3JpcHQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInNjcmlwdCIsIHRydWUpOwogICAgdGhpcy5jdXJyZW50UGFnZSA9IG51bGw7CiAgICB0aGlzLmV4Y2x1ZGUgPSBudWxsOwogICAgdGhpcy5ydW5TY3JpcHRzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBTY3JpcHRNb2RlbCBleHRlbmRzIF94ZmFfb2JqZWN0Lk9wdGlvbk9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic2NyaXB0TW9kZWwiLCBbIlhGQSIsICJub25lIl0pOwogIH0KCn0KCmNsYXNzIFNldmVyaXR5IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzZXZlcml0eSIsIFsiaWdub3JlIiwgImVycm9yIiwgImluZm9ybWF0aW9uIiwgInRyYWNlIiwgIndhcm5pbmciXSk7CiAgfQoKfQoKY2xhc3MgU2lsZW50UHJpbnQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInNpbGVudFByaW50IiwgdHJ1ZSk7CiAgICB0aGlzLmFkZFNpbGVudFByaW50ID0gbnVsbDsKICAgIHRoaXMucHJpbnRlck5hbWUgPSBudWxsOwogIH0KCn0KCmNsYXNzIFN0YXBsZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic3RhcGxlIik7CiAgICB0aGlzLm1vZGUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5tb2RlLCBbInVzZVByaW50ZXJTZXR0aW5nIiwgIm9uIiwgIm9mZiJdKTsKICB9Cgp9CgpjbGFzcyBTdGFydE5vZGUgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN0YXJ0Tm9kZSIpOwogIH0KCn0KCmNsYXNzIFN0YXJ0UGFnZSBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN0YXJ0UGFnZSIsIDAsIG4gPT4gdHJ1ZSk7CiAgfQoKfQoKY2xhc3MgU3VibWl0Rm9ybWF0IGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzdWJtaXRGb3JtYXQiLCBbImh0bWwiLCAiZGVsZWdhdGUiLCAiZmRmIiwgInhtbCIsICJwZGYiXSk7CiAgfQoKfQoKY2xhc3MgU3VibWl0VXJsIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJzdWJtaXRVcmwiKTsKICB9Cgp9CgpjbGFzcyBTdWJzZXRCZWxvdyBleHRlbmRzIF94ZmFfb2JqZWN0LkludGVnZXJPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInN1YnNldEJlbG93IiwgMTAwLCBuID0+IG4gPj0gMCAmJiBuIDw9IDEwMCk7CiAgfQoKfQoKY2xhc3MgU3VwcHJlc3NCYW5uZXIgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAic3VwcHJlc3NCYW5uZXIiKTsKICB9Cgp9CgpjbGFzcyBUYWdnZWQgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb24wMSB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAidGFnZ2VkIik7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGUgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInRlbXBsYXRlIiwgdHJ1ZSk7CiAgICB0aGlzLmJhc2UgPSBudWxsOwogICAgdGhpcy5yZWxldmFudCA9IG51bGw7CiAgICB0aGlzLnN0YXJ0UGFnZSA9IG51bGw7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgICB0aGlzLnhzbCA9IG51bGw7CiAgfQoKfQoKY2xhc3MgVGhyZXNob2xkIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0aHJlc2hvbGQiLCBbInRyYWNlIiwgImVycm9yIiwgImluZm9ybWF0aW9uIiwgIndhcm5pbmciXSk7CiAgfQoKfQoKY2xhc3MgVG8gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInRvIiwgWyJudWxsIiwgIm1lbW9yeSIsICJzdGRlcnIiLCAic3Rkb3V0IiwgInN5c3RlbSIsICJ1cmkiXSk7CiAgfQoKfQoKY2xhc3MgVGVtcGxhdGVDYWNoZSBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAidGVtcGxhdGVDYWNoZSIpOwogICAgdGhpcy5tYXhFbnRyaWVzID0gKDAsIF91dGlscy5nZXRJbnRlZ2VyKSh7CiAgICAgIGRhdGE6IGF0dHJpYnV0ZXMubWF4RW50cmllcywKICAgICAgZGVmYXVsdFZhbHVlOiA1LAogICAgICB2YWxpZGF0ZTogbiA9PiBuID49IDAKICAgIH0pOwogIH0KCn0KCmNsYXNzIFRyYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0cmFjZSIsIHRydWUpOwogICAgdGhpcy5hcmVhID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgVHJhbnNmb3JtIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0cmFuc2Zvcm0iLCB0cnVlKTsKICAgIHRoaXMuZ3JvdXBQYXJlbnQgPSBudWxsOwogICAgdGhpcy5pZkVtcHR5ID0gbnVsbDsKICAgIHRoaXMubmFtZUF0dHIgPSBudWxsOwogICAgdGhpcy5waWN0dXJlID0gbnVsbDsKICAgIHRoaXMucHJlc2VuY2UgPSBudWxsOwogICAgdGhpcy5yZW5hbWUgPSBudWxsOwogICAgdGhpcy53aGl0ZXNwYWNlID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBUeXBlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ0eXBlIiwgWyJub25lIiwgImFzY2lpODUiLCAiYXNjaWlIZXgiLCAiY2NpdHRmYXgiLCAiZmxhdGUiLCAibHp3IiwgInJ1bkxlbmd0aCIsICJuYXRpdmUiLCAieGRwIiwgIm1lcmdlZFhEUCJdKTsKICB9Cgp9CgpjbGFzcyBVcmkgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInVyaSIpOwogIH0KCn0KCmNsYXNzIFZhbGlkYXRlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ2YWxpZGF0ZSIsIFsicHJlU3VibWl0IiwgInByZVByaW50IiwgInByZUV4ZWN1dGUiLCAicHJlU2F2ZSJdKTsKICB9Cgp9CgpjbGFzcyBWYWxpZGF0ZUFwcHJvdmFsU2lnbmF0dXJlcyBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZhbGlkYXRlQXBwcm92YWxTaWduYXR1cmVzIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJGZpbmFsaXplXSgpIHsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID0gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0udHJpbSgpLnNwbGl0KC9ccysvKS5maWx0ZXIoeCA9PiBbImRvY1JlYWR5IiwgInBvc3RTaWduIl0uaW5jbHVkZXMoeCkpOwogIH0KCn0KCmNsYXNzIFZhbGlkYXRpb25NZXNzYWdpbmcgZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZhbGlkYXRpb25NZXNzYWdpbmciLCBbImFsbE1lc3NhZ2VzSW5kaXZpZHVhbGx5IiwgImFsbE1lc3NhZ2VzVG9nZXRoZXIiLCAiZmlyc3RNZXNzYWdlT25seSIsICJub01lc3NhZ2VzIl0pOwogIH0KCn0KCmNsYXNzIFZlcnNpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5PcHRpb25PYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInZlcnNpb24iLCBbIjEuNyIsICIxLjYiLCAiMS41IiwgIjEuNCIsICIxLjMiLCAiMS4yIl0pOwogIH0KCn0KCmNsYXNzIFZlcnNpb25Db250cm9sIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJWZXJzaW9uQ29udHJvbCIpOwogICAgdGhpcy5vdXRwdXRCZWxvdyA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm91dHB1dEJlbG93LCBbIndhcm4iLCAiZXJyb3IiLCAidXBkYXRlIl0pOwogICAgdGhpcy5zb3VyY2VBYm92ZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLnNvdXJjZUFib3ZlLCBbIndhcm4iLCAiZXJyb3IiXSk7CiAgICB0aGlzLnNvdXJjZUJlbG93ID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMuc291cmNlQmVsb3csIFsidXBkYXRlIiwgIm1haW50YWluIl0pOwogIH0KCn0KCmNsYXNzIFZpZXdlclByZWZlcmVuY2VzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ2aWV3ZXJQcmVmZXJlbmNlcyIsIHRydWUpOwogICAgdGhpcy5BREJFX0pTQ29uc29sZSA9IG51bGw7CiAgICB0aGlzLkFEQkVfSlNEZWJ1Z2dlciA9IG51bGw7CiAgICB0aGlzLmFkZFZpZXdlclByZWZlcmVuY2VzID0gbnVsbDsKICAgIHRoaXMuZHVwbGV4T3B0aW9uID0gbnVsbDsKICAgIHRoaXMuZW5mb3JjZSA9IG51bGw7CiAgICB0aGlzLm51bWJlck9mQ29waWVzID0gbnVsbDsKICAgIHRoaXMucGFnZVJhbmdlID0gbnVsbDsKICAgIHRoaXMucGlja1RyYXlCeVBERlNpemUgPSBudWxsOwogICAgdGhpcy5wcmludFNjYWxpbmcgPSBudWxsOwogIH0KCn0KCmNsYXNzIFdlYkNsaWVudCBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAid2ViQ2xpZW50IiwgdHJ1ZSk7CiAgICB0aGlzLm5hbWUgPSBhdHRyaWJ1dGVzLm5hbWUgPyBhdHRyaWJ1dGVzLm5hbWUudHJpbSgpIDogIiI7CiAgICB0aGlzLmZvbnRJbmZvID0gbnVsbDsKICAgIHRoaXMueGRjID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBXaGl0ZXNwYWNlIGV4dGVuZHMgX3hmYV9vYmplY3QuT3B0aW9uT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ3aGl0ZXNwYWNlIiwgWyJwcmVzZXJ2ZSIsICJsdHJpbSIsICJub3JtYWxpemUiLCAicnRyaW0iLCAidHJpbSJdKTsKICB9Cgp9CgpjbGFzcyBXaW5kb3cgZXh0ZW5kcyBfeGZhX29iamVjdC5Db250ZW50T2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ3aW5kb3ciKTsKICB9CgogIFtfeGZhX29iamVjdC4kZmluYWxpemVdKCkgewogICAgY29uc3QgcGFpciA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdLnRyaW0oKS5zcGxpdCgvXHMqLFxzKi8sIDIpLm1hcCh4ID0+IHBhcnNlSW50KHgsIDEwKSk7CgogICAgaWYgKHBhaXIuc29tZSh4ID0+IGlzTmFOKHgpKSkgewogICAgICB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSA9IFswLCAwXTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChwYWlyLmxlbmd0aCA9PT0gMSkgewogICAgICBwYWlyLnB1c2gocGFpclswXSk7CiAgICB9CgogICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gPSBwYWlyOwogIH0KCn0KCmNsYXNzIFhkYyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09ORklHX05TX0lELCAieGRjIiwgdHJ1ZSk7CiAgICB0aGlzLnVyaSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy54c2wgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICB9Cgp9CgpjbGFzcyBYZHAgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInhkcCIsIHRydWUpOwogICAgdGhpcy5wYWNrZXRzID0gbnVsbDsKICB9Cgp9CgpjbGFzcyBYc2wgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTkZJR19OU19JRCwgInhzbCIsIHRydWUpOwogICAgdGhpcy5kZWJ1ZyA9IG51bGw7CiAgICB0aGlzLnVyaSA9IG51bGw7CiAgfQoKfQoKY2xhc3MgWnBsIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05GSUdfTlNfSUQsICJ6cGwiLCB0cnVlKTsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSA/IGF0dHJpYnV0ZXMubmFtZS50cmltKCkgOiAiIjsKICAgIHRoaXMuYmF0Y2hPdXRwdXQgPSBudWxsOwogICAgdGhpcy5mbGlwTGFiZWwgPSBudWxsOwogICAgdGhpcy5mb250SW5mbyA9IG51bGw7CiAgICB0aGlzLnhkYyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgQ29uZmlnTmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKENvbmZpZ05hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gQ29uZmlnTmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgYWNyb2JhdChhdHRycykgewogICAgcmV0dXJuIG5ldyBBY3JvYmF0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhY3JvYmF0NyhhdHRycykgewogICAgcmV0dXJuIG5ldyBBY3JvYmF0NyhhdHRycyk7CiAgfQoKICBzdGF0aWMgQURCRV9KU0NvbnNvbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQURCRV9KU0NvbnNvbGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIEFEQkVfSlNEZWJ1Z2dlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBBREJFX0pTRGVidWdnZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGFkZFNpbGVudFByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFkZFNpbGVudFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhZGRWaWV3ZXJQcmVmZXJlbmNlcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBBZGRWaWV3ZXJQcmVmZXJlbmNlcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgYWRqdXN0RGF0YShhdHRycykgewogICAgcmV0dXJuIG5ldyBBZGp1c3REYXRhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhZG9iZUV4dGVuc2lvbkxldmVsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFkb2JlRXh0ZW5zaW9uTGV2ZWwoYXR0cnMpOwogIH0KCiAgc3RhdGljIGFnZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFnZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBhbHdheXNFbWJlZChhdHRycykgewogICAgcmV0dXJuIG5ldyBBbHdheXNFbWJlZChhdHRycyk7CiAgfQoKICBzdGF0aWMgYW1kKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEFtZChhdHRycyk7CiAgfQoKICBzdGF0aWMgYXJlYShhdHRycykgewogICAgcmV0dXJuIG5ldyBBcmVhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBhdHRyaWJ1dGVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEF0dHJpYnV0ZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGF1dG9TYXZlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEF1dG9TYXZlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBiYXNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJhc2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGJhdGNoT3V0cHV0KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJhdGNoT3V0cHV0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBiZWhhdmlvck92ZXJyaWRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEJlaGF2aW9yT3ZlcnJpZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNhY2hlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENhY2hlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjaGFuZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ2hhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb21tb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29tbW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb21wcmVzcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDb21wcmVzcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgY29tcHJlc3NMb2dpY2FsU3RydWN0dXJlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbXByZXNzTG9naWNhbFN0cnVjdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY29tcHJlc3NPYmplY3RTdHJlYW0oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29tcHJlc3NPYmplY3RTdHJlYW0oYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvbXByZXNzaW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENvbXByZXNzaW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb25maWcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29uZmlnKGF0dHJzKTsKICB9CgogIHN0YXRpYyBjb25mb3JtYW5jZShhdHRycykgewogICAgcmV0dXJuIG5ldyBDb25mb3JtYW5jZShhdHRycyk7CiAgfQoKICBzdGF0aWMgY29udGVudENvcHkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29udGVudENvcHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNvcGllcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDb3BpZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGNyZWF0b3IoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3JlYXRvcihhdHRycyk7CiAgfQoKICBzdGF0aWMgY3VycmVudFBhZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3VycmVudFBhZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF0YShhdHRycyk7CiAgfQoKICBzdGF0aWMgZGVidWcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGVidWcoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRlZmF1bHRUeXBlZmFjZShhdHRycykgewogICAgcmV0dXJuIG5ldyBEZWZhdWx0VHlwZWZhY2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRlc3RpbmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERlc3RpbmF0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkb2N1bWVudEFzc2VtYmx5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERvY3VtZW50QXNzZW1ibHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRyaXZlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBEcml2ZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIGR1cGxleE9wdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBEdXBsZXhPcHRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIGR5bmFtaWNSZW5kZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRHluYW1pY1JlbmRlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgZW1iZWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW1iZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVuY3J5cHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdChhdHRycyk7CiAgfQoKICBzdGF0aWMgZW5jcnlwdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBFbmNyeXB0aW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmNyeXB0aW9uTGV2ZWwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRW5jcnlwdGlvbkxldmVsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBlbmZvcmNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVuZm9yY2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVxdWF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBFcXVhdGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGVxdWF0ZVJhbmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVxdWF0ZVJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBleGNsdWRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEV4Y2x1ZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGV4Y2x1ZGVOUyhhdHRycykgewogICAgcmV0dXJuIG5ldyBFeGNsdWRlTlMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZsaXBMYWJlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBGbGlwTGFiZWwoYXR0cnMpOwogIH0KCiAgc3RhdGljIGZvbnRJbmZvKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZvbnRJbmZvKGF0dHJzKTsKICB9CgogIHN0YXRpYyBmb3JtRmllbGRGaWxsaW5nKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEZvcm1GaWVsZEZpbGxpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIGdyb3VwUGFyZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEdyb3VwUGFyZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBpZkVtcHR5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IElmRW1wdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIGluY2x1ZGVYRFBDb250ZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEluY2x1ZGVYRFBDb250ZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBpbmNyZW1lbnRhbExvYWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSW5jcmVtZW50YWxMb2FkKGF0dHJzKTsKICB9CgogIHN0YXRpYyBpbmNyZW1lbnRhbE1lcmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEluY3JlbWVudGFsTWVyZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIGludGVyYWN0aXZlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEludGVyYWN0aXZlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBqb2coYXR0cnMpIHsKICAgIHJldHVybiBuZXcgSm9nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsYWJlbFByaW50ZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTGFiZWxQcmludGVyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsYXlvdXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTGF5b3V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBsZXZlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBMZXZlbChhdHRycyk7CiAgfQoKICBzdGF0aWMgbGluZWFyaXplZChhdHRycykgewogICAgcmV0dXJuIG5ldyBMaW5lYXJpemVkKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2NhbGVTZXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9jYWxlU2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBsb2coYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTG9nKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtYXAoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTWFwRWxlbWVudChhdHRycyk7CiAgfQoKICBzdGF0aWMgbWVkaXVtSW5mbyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNZWRpdW1JbmZvKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZXNzYWdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lc3NhZ2UoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1lc3NhZ2luZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBNZXNzYWdpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1vZGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTW9kZShhdHRycyk7CiAgfQoKICBzdGF0aWMgbW9kaWZ5QW5ub3RzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1vZGlmeUFubm90cyhhdHRycyk7CiAgfQoKICBzdGF0aWMgbXNnSWQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTXNnSWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG5hbWVBdHRyKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE5hbWVBdHRyKGF0dHJzKTsKICB9CgogIHN0YXRpYyBuZXZlckVtYmVkKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE5ldmVyRW1iZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlck9mQ29waWVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE51bWJlck9mQ29waWVzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBvcGVuQWN0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE9wZW5BY3Rpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dEJpbihhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXRCaW4oYXR0cnMpOwogIH0KCiAgc3RhdGljIG91dHB1dFhTTChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdXRwdXRYU0woYXR0cnMpOwogIH0KCiAgc3RhdGljIG92ZXJwcmludChhdHRycykgewogICAgcmV0dXJuIG5ldyBPdmVycHJpbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhY2tldHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFja2V0cyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcGFnZU9mZnNldChhdHRycykgewogICAgcmV0dXJuIG5ldyBQYWdlT2Zmc2V0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYWdlUmFuZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFnZVJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwYWdpbmF0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBhZ2luYXRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhZ2luYXRpb25PdmVycmlkZShhdHRycykgewogICAgcmV0dXJuIG5ldyBQYWdpbmF0aW9uT3ZlcnJpZGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBhcnQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGFydChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGNsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBjbChhdHRycyk7CiAgfQoKICBzdGF0aWMgcGRmKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFBkZihhdHRycyk7CiAgfQoKICBzdGF0aWMgcGRmYShhdHRycykgewogICAgcmV0dXJuIG5ldyBQZGZhKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwZXJtaXNzaW9ucyhhdHRycykgewogICAgcmV0dXJuIG5ldyBQZXJtaXNzaW9ucyhhdHRycyk7CiAgfQoKICBzdGF0aWMgcGlja1RyYXlCeVBERlNpemUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGlja1RyYXlCeVBERlNpemUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHBpY3R1cmUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGljdHVyZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcGxhaW50ZXh0TWV0YWRhdGEoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUGxhaW50ZXh0TWV0YWRhdGEoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByZXNlbmNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByZXNlbmNlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcmVzZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByZXNlbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcmludEhpZ2hRdWFsaXR5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50SGlnaFF1YWxpdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50U2NhbGluZyhhdHRycykgewogICAgcmV0dXJuIG5ldyBQcmludFNjYWxpbmcoYXR0cnMpOwogIH0KCiAgc3RhdGljIHByaW50ZXJOYW1lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFByaW50ZXJOYW1lKGF0dHJzKTsKICB9CgogIHN0YXRpYyBwcm9kdWNlcihhdHRycykgewogICAgcmV0dXJuIG5ldyBQcm9kdWNlcihhdHRycyk7CiAgfQoKICBzdGF0aWMgcHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHJhbmdlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJhbmdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWNvcmQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgUmVjb3JkKGF0dHJzKTsKICB9CgogIHN0YXRpYyByZWxldmFudChhdHRycykgewogICAgcmV0dXJuIG5ldyBSZWxldmFudChhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVuYW1lKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlbmFtZShhdHRycyk7CiAgfQoKICBzdGF0aWMgcmVuZGVyUG9saWN5KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJlbmRlclBvbGljeShhdHRycyk7CiAgfQoKICBzdGF0aWMgcnVuU2NyaXB0cyhhdHRycykgewogICAgcmV0dXJuIG5ldyBSdW5TY3JpcHRzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzY3JpcHQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2NyaXB0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzY3JpcHRNb2RlbChhdHRycykgewogICAgcmV0dXJuIG5ldyBTY3JpcHRNb2RlbChhdHRycyk7CiAgfQoKICBzdGF0aWMgc2V2ZXJpdHkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU2V2ZXJpdHkoYXR0cnMpOwogIH0KCiAgc3RhdGljIHNpbGVudFByaW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNpbGVudFByaW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFwbGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcGxlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFydE5vZGUoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcnROb2RlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdGFydFBhZ2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3RhcnRQYWdlKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJtaXRGb3JtYXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VibWl0Rm9ybWF0KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJtaXRVcmwoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VibWl0VXJsKGF0dHJzKTsKICB9CgogIHN0YXRpYyBzdWJzZXRCZWxvdyhhdHRycykgewogICAgcmV0dXJuIG5ldyBTdWJzZXRCZWxvdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgc3VwcHJlc3NCYW5uZXIoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgU3VwcHJlc3NCYW5uZXIoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRhZ2dlZChhdHRycykgewogICAgcmV0dXJuIG5ldyBUYWdnZWQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRlbXBsYXRlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRlbXBsYXRlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0ZW1wbGF0ZUNhY2hlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRlbXBsYXRlQ2FjaGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRocmVzaG9sZChhdHRycykgewogICAgcmV0dXJuIG5ldyBUaHJlc2hvbGQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHRvKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRvKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0cmFjZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUcmFjZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdHJhbnNmb3JtKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybShhdHRycyk7CiAgfQoKICBzdGF0aWMgdHlwZShhdHRycykgewogICAgcmV0dXJuIG5ldyBUeXBlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB1cmkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVXJpKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2YWxpZGF0ZShhdHRycykgewogICAgcmV0dXJuIG5ldyBWYWxpZGF0ZShhdHRycyk7CiAgfQoKICBzdGF0aWMgdmFsaWRhdGVBcHByb3ZhbFNpZ25hdHVyZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmFsaWRhdGVBcHByb3ZhbFNpZ25hdHVyZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHZhbGlkYXRpb25NZXNzYWdpbmcoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmFsaWRhdGlvbk1lc3NhZ2luZyhhdHRycyk7CiAgfQoKICBzdGF0aWMgdmVyc2lvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBWZXJzaW9uKGF0dHJzKTsKICB9CgogIHN0YXRpYyB2ZXJzaW9uQ29udHJvbChhdHRycykgewogICAgcmV0dXJuIG5ldyBWZXJzaW9uQ29udHJvbChhdHRycyk7CiAgfQoKICBzdGF0aWMgdmlld2VyUHJlZmVyZW5jZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVmlld2VyUHJlZmVyZW5jZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHdlYkNsaWVudChhdHRycykgewogICAgcmV0dXJuIG5ldyBXZWJDbGllbnQoYXR0cnMpOwogIH0KCiAgc3RhdGljIHdoaXRlc3BhY2UoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgV2hpdGVzcGFjZShhdHRycyk7CiAgfQoKICBzdGF0aWMgd2luZG93KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFdpbmRvdyhhdHRycyk7CiAgfQoKICBzdGF0aWMgeGRjKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhkYyhhdHRycyk7CiAgfQoKICBzdGF0aWMgeGRwKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhkcChhdHRycyk7CiAgfQoKICBzdGF0aWMgeHNsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFhzbChhdHRycyk7CiAgfQoKICBzdGF0aWMgenBsKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFpwbChhdHRycyk7CiAgfQoKfQoKZXhwb3J0cy5Db25maWdOYW1lc3BhY2UgPSBDb25maWdOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5Db25uZWN0aW9uU2V0TmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCmNvbnN0IENPTk5FQ1RJT05fU0VUX05TX0lEID0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLmNvbm5lY3Rpb25TZXQuaWQ7CgpjbGFzcyBDb25uZWN0aW9uU2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgImNvbm5lY3Rpb25TZXQiLCB0cnVlKTsKICAgIHRoaXMud3NkbENvbm5lY3Rpb24gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMueG1sQ29ubmVjdGlvbiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogICAgdGhpcy54c2RDb25uZWN0aW9uID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgRWZmZWN0aXZlSW5wdXRQb2xpY3kgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAiZWZmZWN0aXZlSW5wdXRQb2xpY3kiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBFZmZlY3RpdmVPdXRwdXRQb2xpY3kgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAiZWZmZWN0aXZlT3V0cHV0UG9saWN5Iik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgT3BlcmF0aW9uIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgIm9wZXJhdGlvbiIpOwogICAgdGhpcy5pZCA9IGF0dHJpYnV0ZXMuaWQgfHwgIiI7CiAgICB0aGlzLmlucHV0ID0gYXR0cmlidXRlcy5pbnB1dCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMub3V0cHV0ID0gYXR0cmlidXRlcy5vdXRwdXQgfHwgIiI7CiAgICB0aGlzLnVzZSA9IGF0dHJpYnV0ZXMudXNlIHx8ICIiOwogICAgdGhpcy51c2VocmVmID0gYXR0cmlidXRlcy51c2VocmVmIHx8ICIiOwogIH0KCn0KCmNsYXNzIFJvb3RFbGVtZW50IGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihDT05ORUNUSU9OX1NFVF9OU19JRCwgInJvb3RFbGVtZW50Iik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgU29hcEFjdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJzb2FwQWN0aW9uIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgU29hcEFkZHJlc3MgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAic29hcEFkZHJlc3MiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBVcmkgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAidXJpIik7CiAgICB0aGlzLmlkID0gYXR0cmlidXRlcy5pZCB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMudXNlID0gYXR0cmlidXRlcy51c2UgfHwgIiI7CiAgICB0aGlzLnVzZWhyZWYgPSBhdHRyaWJ1dGVzLnVzZWhyZWYgfHwgIiI7CiAgfQoKfQoKY2xhc3MgV3NkbEFkZHJlc3MgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAid3NkbEFkZHJlc3MiKTsKICAgIHRoaXMuaWQgPSBhdHRyaWJ1dGVzLmlkIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51c2UgPSBhdHRyaWJ1dGVzLnVzZSB8fCAiIjsKICAgIHRoaXMudXNlaHJlZiA9IGF0dHJpYnV0ZXMudXNlaHJlZiB8fCAiIjsKICB9Cgp9CgpjbGFzcyBXc2RsQ29ubmVjdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJ3c2RsQ29ubmVjdGlvbiIsIHRydWUpOwogICAgdGhpcy5kYXRhRGVzY3JpcHRpb24gPSBhdHRyaWJ1dGVzLmRhdGFEZXNjcmlwdGlvbiB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMuZWZmZWN0aXZlSW5wdXRQb2xpY3kgPSBudWxsOwogICAgdGhpcy5lZmZlY3RpdmVPdXRwdXRQb2xpY3kgPSBudWxsOwogICAgdGhpcy5vcGVyYXRpb24gPSBudWxsOwogICAgdGhpcy5zb2FwQWN0aW9uID0gbnVsbDsKICAgIHRoaXMuc29hcEFkZHJlc3MgPSBudWxsOwogICAgdGhpcy53c2RsQWRkcmVzcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgWG1sQ29ubmVjdGlvbiBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoQ09OTkVDVElPTl9TRVRfTlNfSUQsICJ4bWxDb25uZWN0aW9uIiwgdHJ1ZSk7CiAgICB0aGlzLmRhdGFEZXNjcmlwdGlvbiA9IGF0dHJpYnV0ZXMuZGF0YURlc2NyaXB0aW9uIHx8ICIiOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHx8ICIiOwogICAgdGhpcy51cmkgPSBudWxsOwogIH0KCn0KCmNsYXNzIFhzZENvbm5lY3Rpb24gZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKENPTk5FQ1RJT05fU0VUX05TX0lELCAieHNkQ29ubmVjdGlvbiIsIHRydWUpOwogICAgdGhpcy5kYXRhRGVzY3JpcHRpb24gPSBhdHRyaWJ1dGVzLmRhdGFEZXNjcmlwdGlvbiB8fCAiIjsKICAgIHRoaXMubmFtZSA9IGF0dHJpYnV0ZXMubmFtZSB8fCAiIjsKICAgIHRoaXMucm9vdEVsZW1lbnQgPSBudWxsOwogICAgdGhpcy51cmkgPSBudWxsOwogIH0KCn0KCmNsYXNzIENvbm5lY3Rpb25TZXROYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoQ29ubmVjdGlvblNldE5hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gQ29ubmVjdGlvblNldE5hbWVzcGFjZVtuYW1lXShhdHRyaWJ1dGVzKTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgc3RhdGljIGNvbm5lY3Rpb25TZXQoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ29ubmVjdGlvblNldChhdHRycyk7CiAgfQoKICBzdGF0aWMgZWZmZWN0aXZlSW5wdXRQb2xpY3koYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRWZmZWN0aXZlSW5wdXRQb2xpY3koYXR0cnMpOwogIH0KCiAgc3RhdGljIGVmZmVjdGl2ZU91dHB1dFBvbGljeShhdHRycykgewogICAgcmV0dXJuIG5ldyBFZmZlY3RpdmVPdXRwdXRQb2xpY3koYXR0cnMpOwogIH0KCiAgc3RhdGljIG9wZXJhdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBPcGVyYXRpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHJvb3RFbGVtZW50KGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFJvb3RFbGVtZW50KGF0dHJzKTsKICB9CgogIHN0YXRpYyBzb2FwQWN0aW9uKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNvYXBBY3Rpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHNvYXBBZGRyZXNzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFNvYXBBZGRyZXNzKGF0dHJzKTsKICB9CgogIHN0YXRpYyB1cmkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVXJpKGF0dHJzKTsKICB9CgogIHN0YXRpYyB3c2RsQWRkcmVzcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBXc2RsQWRkcmVzcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgd3NkbENvbm5lY3Rpb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgV3NkbENvbm5lY3Rpb24oYXR0cnMpOwogIH0KCiAgc3RhdGljIHhtbENvbm5lY3Rpb24oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgWG1sQ29ubmVjdGlvbihhdHRycyk7CiAgfQoKICBzdGF0aWMgeHNkQ29ubmVjdGlvbihhdHRycykgewogICAgcmV0dXJuIG5ldyBYc2RDb25uZWN0aW9uKGF0dHJzKTsKICB9Cgp9CgpleHBvcnRzLkNvbm5lY3Rpb25TZXROYW1lc3BhY2UgPSBDb25uZWN0aW9uU2V0TmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDkzICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuRGF0YXNldHNOYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwoKY29uc3QgREFUQVNFVFNfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuZGF0YXNldHMuaWQ7CgpjbGFzcyBEYXRhIGV4dGVuZHMgX3hmYV9vYmplY3QuWG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihEQVRBU0VUU19OU19JRCwgImRhdGEiLCBhdHRyaWJ1dGVzKTsKICB9CgogIFtfeGZhX29iamVjdC4kaXNOc0Fnbm9zdGljXSgpIHsKICAgIHJldHVybiB0cnVlOwogIH0KCn0KCmNsYXNzIERhdGFzZXRzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihEQVRBU0VUU19OU19JRCwgImRhdGFzZXRzIiwgdHJ1ZSk7CiAgICB0aGlzLmRhdGEgPSBudWxsOwogICAgdGhpcy5TaWduYXR1cmUgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvbkNoaWxkXShjaGlsZCkgewogICAgY29uc3QgbmFtZSA9IGNoaWxkW194ZmFfb2JqZWN0LiRub2RlTmFtZV07CgogICAgaWYgKG5hbWUgPT09ICJkYXRhIiAmJiBjaGlsZFtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBEQVRBU0VUU19OU19JRCB8fCBuYW1lID09PSAiU2lnbmF0dXJlIiAmJiBjaGlsZFtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuc2lnbmF0dXJlLmlkKSB7CiAgICAgIHRoaXNbbmFtZV0gPSBjaGlsZDsKICAgIH0KCiAgICB0aGlzW194ZmFfb2JqZWN0LiRhcHBlbmRDaGlsZF0oY2hpbGQpOwogIH0KCn0KCmNsYXNzIERhdGFzZXRzTmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKERhdGFzZXRzTmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBEYXRhc2V0c05hbWVzcGFjZVtuYW1lXShhdHRyaWJ1dGVzKTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgc3RhdGljIGRhdGFzZXRzKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgRGF0YXNldHMoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgZGF0YShhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IERhdGEoYXR0cmlidXRlcyk7CiAgfQoKfQoKZXhwb3J0cy5EYXRhc2V0c05hbWVzcGFjZSA9IERhdGFzZXRzTmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDk0ICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuTG9jYWxlU2V0TmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KTsKCmNvbnN0IExPQ0FMRV9TRVRfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMubG9jYWxlU2V0LmlkOwoKY2xhc3MgQ2FsZW5kYXJTeW1ib2xzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiY2FsZW5kYXJTeW1ib2xzIiwgdHJ1ZSk7CiAgICB0aGlzLm5hbWUgPSAiZ3JlZ29yaWFuIjsKICAgIHRoaXMuZGF5TmFtZXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMik7CiAgICB0aGlzLmVyYU5hbWVzID0gbnVsbDsKICAgIHRoaXMubWVyaWRpZW1OYW1lcyA9IG51bGw7CiAgICB0aGlzLm1vbnRoTmFtZXMgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMik7CiAgfQoKfQoKY2xhc3MgQ3VycmVuY3lTeW1ib2wgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJjdXJyZW5jeVN5bWJvbCIpOwogICAgdGhpcy5uYW1lID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubmFtZSwgWyJzeW1ib2wiLCAiaXNvbmFtZSIsICJkZWNpbWFsIl0pOwogIH0KCn0KCmNsYXNzIEN1cnJlbmN5U3ltYm9scyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImN1cnJlbmN5U3ltYm9scyIsIHRydWUpOwogICAgdGhpcy5jdXJyZW5jeVN5bWJvbCA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgzKTsKICB9Cgp9CgpjbGFzcyBEYXRlUGF0dGVybiBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImRhdGVQYXR0ZXJuIik7CiAgICB0aGlzLm5hbWUgPSAoMCwgX3V0aWxzLmdldFN0cmluZ09wdGlvbikoYXR0cmlidXRlcy5uYW1lLCBbImZ1bGwiLCAibG9uZyIsICJtZWQiLCAic2hvcnQiXSk7CiAgfQoKfQoKY2xhc3MgRGF0ZVBhdHRlcm5zIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiZGF0ZVBhdHRlcm5zIiwgdHJ1ZSk7CiAgICB0aGlzLmRhdGVQYXR0ZXJuID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDQpOwogIH0KCn0KCmNsYXNzIERhdGVUaW1lU3ltYm9scyBleHRlbmRzIF94ZmFfb2JqZWN0LkNvbnRlbnRPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJkYXRlVGltZVN5bWJvbHMiKTsKICB9Cgp9CgpjbGFzcyBEYXkgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJkYXkiKTsKICB9Cgp9CgpjbGFzcyBEYXlOYW1lcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgImRheU5hbWVzIiwgdHJ1ZSk7CiAgICB0aGlzLmFiYnIgPSAoMCwgX3V0aWxzLmdldEludGVnZXIpKHsKICAgICAgZGF0YTogYXR0cmlidXRlcy5hYmJyLAogICAgICBkZWZhdWx0VmFsdWU6IDAsCiAgICAgIHZhbGlkYXRlOiB4ID0+IHggPT09IDEKICAgIH0pOwogICAgdGhpcy5kYXkgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoNyk7CiAgfQoKfQoKY2xhc3MgRXJhIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAiZXJhIik7CiAgfQoKfQoKY2xhc3MgRXJhTmFtZXMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJlcmFOYW1lcyIsIHRydWUpOwogICAgdGhpcy5lcmEgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoMik7CiAgfQoKfQoKY2xhc3MgTG9jYWxlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibG9jYWxlIiwgdHJ1ZSk7CiAgICB0aGlzLmRlc2MgPSBhdHRyaWJ1dGVzLmRlc2MgfHwgIiI7CiAgICB0aGlzLm5hbWUgPSAiaXNvbmFtZSI7CiAgICB0aGlzLmNhbGVuZGFyU3ltYm9scyA9IG51bGw7CiAgICB0aGlzLmN1cnJlbmN5U3ltYm9scyA9IG51bGw7CiAgICB0aGlzLmRhdGVQYXR0ZXJucyA9IG51bGw7CiAgICB0aGlzLmRhdGVUaW1lU3ltYm9scyA9IG51bGw7CiAgICB0aGlzLm51bWJlclBhdHRlcm5zID0gbnVsbDsKICAgIHRoaXMubnVtYmVyU3ltYm9scyA9IG51bGw7CiAgICB0aGlzLnRpbWVQYXR0ZXJucyA9IG51bGw7CiAgICB0aGlzLnR5cGVGYWNlcyA9IG51bGw7CiAgfQoKfQoKY2xhc3MgTG9jYWxlU2V0IGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibG9jYWxlU2V0IiwgdHJ1ZSk7CiAgICB0aGlzLmxvY2FsZSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgpOwogIH0KCn0KCmNsYXNzIE1lcmlkaWVtIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibWVyaWRpZW0iKTsKICB9Cgp9CgpjbGFzcyBNZXJpZGllbU5hbWVzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibWVyaWRpZW1OYW1lcyIsIHRydWUpOwogICAgdGhpcy5tZXJpZGllbSA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSgyKTsKICB9Cgp9CgpjbGFzcyBNb250aCBleHRlbmRzIF94ZmFfb2JqZWN0LlN0cmluZ09iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm1vbnRoIik7CiAgfQoKfQoKY2xhc3MgTW9udGhOYW1lcyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm1vbnRoTmFtZXMiLCB0cnVlKTsKICAgIHRoaXMuYWJiciA9ICgwLCBfdXRpbHMuZ2V0SW50ZWdlcikoewogICAgICBkYXRhOiBhdHRyaWJ1dGVzLmFiYnIsCiAgICAgIGRlZmF1bHRWYWx1ZTogMCwKICAgICAgdmFsaWRhdGU6IHggPT4geCA9PT0gMQogICAgfSk7CiAgICB0aGlzLm1vbnRoID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDEyKTsKICB9Cgp9CgpjbGFzcyBOdW1iZXJQYXR0ZXJuIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibnVtYmVyUGF0dGVybiIpOwogICAgdGhpcy5uYW1lID0gKDAsIF91dGlscy5nZXRTdHJpbmdPcHRpb24pKGF0dHJpYnV0ZXMubmFtZSwgWyJmdWxsIiwgImxvbmciLCAibWVkIiwgInNob3J0Il0pOwogIH0KCn0KCmNsYXNzIE51bWJlclBhdHRlcm5zIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAibnVtYmVyUGF0dGVybnMiLCB0cnVlKTsKICAgIHRoaXMubnVtYmVyUGF0dGVybiA9IG5ldyBfeGZhX29iamVjdC5YRkFPYmplY3RBcnJheSg0KTsKICB9Cgp9CgpjbGFzcyBOdW1iZXJTeW1ib2wgZXh0ZW5kcyBfeGZhX29iamVjdC5TdHJpbmdPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJudW1iZXJTeW1ib2wiKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsiZGVjaW1hbCIsICJncm91cGluZyIsICJwZXJjZW50IiwgIm1pbnVzIiwgInplcm8iXSk7CiAgfQoKfQoKY2xhc3MgTnVtYmVyU3ltYm9scyBleHRlbmRzIF94ZmFfb2JqZWN0LlhGQU9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoTE9DQUxFX1NFVF9OU19JRCwgIm51bWJlclN5bWJvbHMiLCB0cnVlKTsKICAgIHRoaXMubnVtYmVyU3ltYm9sID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KDUpOwogIH0KCn0KCmNsYXNzIFRpbWVQYXR0ZXJuIGV4dGVuZHMgX3hmYV9vYmplY3QuU3RyaW5nT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAidGltZVBhdHRlcm4iKTsKICAgIHRoaXMubmFtZSA9ICgwLCBfdXRpbHMuZ2V0U3RyaW5nT3B0aW9uKShhdHRyaWJ1dGVzLm5hbWUsIFsiZnVsbCIsICJsb25nIiwgIm1lZCIsICJzaG9ydCJdKTsKICB9Cgp9CgpjbGFzcyBUaW1lUGF0dGVybnMgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJ0aW1lUGF0dGVybnMiLCB0cnVlKTsKICAgIHRoaXMudGltZVBhdHRlcm4gPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoNCk7CiAgfQoKfQoKY2xhc3MgVHlwZUZhY2UgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKExPQ0FMRV9TRVRfTlNfSUQsICJ0eXBlRmFjZSIsIHRydWUpOwogICAgdGhpcy5uYW1lID0gYXR0cmlidXRlcy5uYW1lIHwgIiI7CiAgfQoKfQoKY2xhc3MgVHlwZUZhY2VzIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihMT0NBTEVfU0VUX05TX0lELCAidHlwZUZhY2VzIiwgdHJ1ZSk7CiAgICB0aGlzLnR5cGVGYWNlID0gbmV3IF94ZmFfb2JqZWN0LlhGQU9iamVjdEFycmF5KCk7CiAgfQoKfQoKY2xhc3MgTG9jYWxlU2V0TmFtZXNwYWNlIHsKICBzdGF0aWMgW19uYW1lc3BhY2VzLiRidWlsZFhGQU9iamVjdF0obmFtZSwgYXR0cmlidXRlcykgewogICAgaWYgKExvY2FsZVNldE5hbWVzcGFjZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICByZXR1cm4gTG9jYWxlU2V0TmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgY2FsZW5kYXJTeW1ib2xzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IENhbGVuZGFyU3ltYm9scyhhdHRycyk7CiAgfQoKICBzdGF0aWMgY3VycmVuY3lTeW1ib2woYXR0cnMpIHsKICAgIHJldHVybiBuZXcgQ3VycmVuY3lTeW1ib2woYXR0cnMpOwogIH0KCiAgc3RhdGljIGN1cnJlbmN5U3ltYm9scyhhdHRycykgewogICAgcmV0dXJuIG5ldyBDdXJyZW5jeVN5bWJvbHMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGRhdGVQYXR0ZXJuKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IERhdGVQYXR0ZXJuKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXRlUGF0dGVybnMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF0ZVBhdHRlcm5zKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXRlVGltZVN5bWJvbHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF0ZVRpbWVTeW1ib2xzKGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXkoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRGF5KGF0dHJzKTsKICB9CgogIHN0YXRpYyBkYXlOYW1lcyhhdHRycykgewogICAgcmV0dXJuIG5ldyBEYXlOYW1lcyhhdHRycyk7CiAgfQoKICBzdGF0aWMgZXJhKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IEVyYShhdHRycyk7CiAgfQoKICBzdGF0aWMgZXJhTmFtZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgRXJhTmFtZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIGxvY2FsZShhdHRycykgewogICAgcmV0dXJuIG5ldyBMb2NhbGUoYXR0cnMpOwogIH0KCiAgc3RhdGljIGxvY2FsZVNldChhdHRycykgewogICAgcmV0dXJuIG5ldyBMb2NhbGVTZXQoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1lcmlkaWVtKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lcmlkaWVtKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtZXJpZGllbU5hbWVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1lcmlkaWVtTmFtZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIG1vbnRoKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1vbnRoKGF0dHJzKTsKICB9CgogIHN0YXRpYyBtb250aE5hbWVzKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IE1vbnRoTmFtZXMoYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlclBhdHRlcm4oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTnVtYmVyUGF0dGVybihhdHRycyk7CiAgfQoKICBzdGF0aWMgbnVtYmVyUGF0dGVybnMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTnVtYmVyUGF0dGVybnMoYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlclN5bWJvbChhdHRycykgewogICAgcmV0dXJuIG5ldyBOdW1iZXJTeW1ib2woYXR0cnMpOwogIH0KCiAgc3RhdGljIG51bWJlclN5bWJvbHMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgTnVtYmVyU3ltYm9scyhhdHRycyk7CiAgfQoKICBzdGF0aWMgdGltZVBhdHRlcm4oYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVGltZVBhdHRlcm4oYXR0cnMpOwogIH0KCiAgc3RhdGljIHRpbWVQYXR0ZXJucyhhdHRycykgewogICAgcmV0dXJuIG5ldyBUaW1lUGF0dGVybnMoYXR0cnMpOwogIH0KCiAgc3RhdGljIHR5cGVGYWNlKGF0dHJzKSB7CiAgICByZXR1cm4gbmV3IFR5cGVGYWNlKGF0dHJzKTsKICB9CgogIHN0YXRpYyB0eXBlRmFjZXMoYXR0cnMpIHsKICAgIHJldHVybiBuZXcgVHlwZUZhY2VzKGF0dHJzKTsKICB9Cgp9CgpleHBvcnRzLkxvY2FsZVNldE5hbWVzcGFjZSA9IExvY2FsZVNldE5hbWVzcGFjZTsKCi8qKiovIH0pLAovKiA5NSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlNpZ25hdHVyZU5hbWVzcGFjZSA9IHZvaWQgMDsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7Cgpjb25zdCBTSUdOQVRVUkVfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuc2lnbmF0dXJlLmlkOwoKY2xhc3MgU2lnbmF0dXJlIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihTSUdOQVRVUkVfTlNfSUQsICJzaWduYXR1cmUiLCB0cnVlKTsKICB9Cgp9CgpjbGFzcyBTaWduYXR1cmVOYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoU2lnbmF0dXJlTmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBTaWduYXR1cmVOYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHN0YXRpYyBzaWduYXR1cmUoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoYXR0cmlidXRlcyk7CiAgfQoKfQoKZXhwb3J0cy5TaWduYXR1cmVOYW1lc3BhY2UgPSBTaWduYXR1cmVOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5TdHlsZXNoZWV0TmFtZXNwYWNlID0gdm9pZCAwOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX3hmYV9vYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKCmNvbnN0IFNUWUxFU0hFRVRfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMuc3R5bGVzaGVldC5pZDsKCmNsYXNzIFN0eWxlc2hlZXQgZXh0ZW5kcyBfeGZhX29iamVjdC5YRkFPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKFNUWUxFU0hFRVRfTlNfSUQsICJzdHlsZXNoZWV0IiwgdHJ1ZSk7CiAgfQoKfQoKY2xhc3MgU3R5bGVzaGVldE5hbWVzcGFjZSB7CiAgc3RhdGljIFtfbmFtZXNwYWNlcy4kYnVpbGRYRkFPYmplY3RdKG5hbWUsIGF0dHJpYnV0ZXMpIHsKICAgIGlmIChTdHlsZXNoZWV0TmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBTdHlsZXNoZWV0TmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgc3R5bGVzaGVldChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFN0eWxlc2hlZXQoYXR0cmlidXRlcyk7CiAgfQoKfQoKZXhwb3J0cy5TdHlsZXNoZWV0TmFtZXNwYWNlID0gU3R5bGVzaGVldE5hbWVzcGFjZTsKCi8qKiovIH0pLAovKiA5NyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlhkcE5hbWVzcGFjZSA9IHZvaWQgMDsKCnZhciBfbmFtZXNwYWNlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwoKdmFyIF94ZmFfb2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7Cgpjb25zdCBYRFBfTlNfSUQgPSBfbmFtZXNwYWNlcy5OYW1lc3BhY2VJZHMueGRwLmlkOwoKY2xhc3MgWGRwIGV4dGVuZHMgX3hmYV9vYmplY3QuWEZBT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihYRFBfTlNfSUQsICJ4ZHAiLCB0cnVlKTsKICAgIHRoaXMudXVpZCA9IGF0dHJpYnV0ZXMudXVpZCB8fCAiIjsKICAgIHRoaXMudGltZVN0YW1wID0gYXR0cmlidXRlcy50aW1lU3RhbXAgfHwgIiI7CiAgICB0aGlzLmNvbmZpZyA9IG51bGw7CiAgICB0aGlzLmNvbm5lY3Rpb25TZXQgPSBudWxsOwogICAgdGhpcy5kYXRhc2V0cyA9IG51bGw7CiAgICB0aGlzLmxvY2FsZVNldCA9IG51bGw7CiAgICB0aGlzLnN0eWxlc2hlZXQgPSBuZXcgX3hmYV9vYmplY3QuWEZBT2JqZWN0QXJyYXkoKTsKICAgIHRoaXMudGVtcGxhdGUgPSBudWxsOwogIH0KCiAgW194ZmFfb2JqZWN0LiRvbkNoaWxkQ2hlY2tdKGNoaWxkKSB7CiAgICBjb25zdCBucyA9IF9uYW1lc3BhY2VzLk5hbWVzcGFjZUlkc1tjaGlsZFtfeGZhX29iamVjdC4kbm9kZU5hbWVdXTsKICAgIHJldHVybiBucyAmJiBjaGlsZFtfeGZhX29iamVjdC4kbmFtZXNwYWNlSWRdID09PSBucy5pZDsKICB9Cgp9CgpjbGFzcyBYZHBOYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoWGRwTmFtZXNwYWNlLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgIHJldHVybiBYZHBOYW1lc3BhY2VbbmFtZV0oYXR0cmlidXRlcyk7CiAgICB9CgogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHN0YXRpYyB4ZHAoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBYZHAoYXR0cmlidXRlcyk7CiAgfQoKfQoKZXhwb3J0cy5YZHBOYW1lc3BhY2UgPSBYZHBOYW1lc3BhY2U7CgovKioqLyB9KSwKLyogOTggKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgPT4gewoKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKZXhwb3J0cy5YaHRtbE5hbWVzcGFjZSA9IHZvaWQgMDsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKdmFyIF9uYW1lc3BhY2VzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3OSk7Cgp2YXIgX2h0bWxfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg0KTsKCnZhciBfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KTsKCmNvbnN0IFhIVE1MX05TX0lEID0gX25hbWVzcGFjZXMuTmFtZXNwYWNlSWRzLnhodG1sLmlkOwpjb25zdCAkcmljaFRleHQgPSBTeW1ib2woKTsKY29uc3QgVkFMSURfU1RZTEVTID0gbmV3IFNldChbImNvbG9yIiwgImZvbnQiLCAiZm9udC1mYW1pbHkiLCAiZm9udC1zaXplIiwgImZvbnQtc3RyZXRjaCIsICJmb250LXN0eWxlIiwgImZvbnQtd2VpZ2h0IiwgIm1hcmdpbiIsICJtYXJnaW4tYm90dG9tIiwgIm1hcmdpbi1sZWZ0IiwgIm1hcmdpbi1yaWdodCIsICJtYXJnaW4tdG9wIiwgImxldHRlci1zcGFjaW5nIiwgImxpbmUtaGVpZ2h0IiwgIm9ycGhhbnMiLCAicGFnZS1icmVhay1hZnRlciIsICJwYWdlLWJyZWFrLWJlZm9yZSIsICJwYWdlLWJyZWFrLWluc2lkZSIsICJ0YWItaW50ZXJ2YWwiLCAidGFiLXN0b3AiLCAidGV4dC1hbGlnbiIsICJ0ZXh0LWRlY29yYXRpb24iLCAidGV4dC1pbmRlbnQiLCAidmVydGljYWwtYWxpZ24iLCAid2lkb3dzIiwgImtlcm5pbmctbW9kZSIsICJ4ZmEtZm9udC1ob3Jpem9udGFsLXNjYWxlIiwgInhmYS1mb250LXZlcnRpY2FsLXNjYWxlIiwgInhmYS1zcGFjZXJ1biIsICJ4ZmEtdGFiLXN0b3BzIl0pOwpjb25zdCBTdHlsZU1hcHBpbmcgPSBuZXcgTWFwKFtbInBhZ2UtYnJlYWstYWZ0ZXIiLCAiYnJlYWtBZnRlciJdLCBbInBhZ2UtYnJlYWstYmVmb3JlIiwgImJyZWFrQmVmb3JlIl0sIFsicGFnZS1icmVhay1pbnNpZGUiLCAiYnJlYWtJbnNpZGUiXSwgWyJrZXJuaW5nLW1vZGUiLCB2YWx1ZSA9PiB2YWx1ZSA9PT0gIm5vbmUiID8gIm5vbmUiIDogIm5vcm1hbCJdLCBbInhmYS1mb250LWhvcml6b250YWwtc2NhbGUiLCB2YWx1ZSA9PiBgc2NhbGVYKCR7TWF0aC5tYXgoMCwgTWF0aC5taW4ocGFyc2VJbnQodmFsdWUpIC8gMTAwKSkudG9GaXhlZCgyKX0pYF0sIFsieGZhLWZvbnQtdmVydGljYWwtc2NhbGUiLCB2YWx1ZSA9PiBgc2NhbGVZKCR7TWF0aC5tYXgoMCwgTWF0aC5taW4ocGFyc2VJbnQodmFsdWUpIC8gMTAwKSkudG9GaXhlZCgyKX0pYF0sIFsieGZhLXNwYWNlcnVuIiwgIiJdLCBbInhmYS10YWItc3RvcHMiLCAiIl0sIFsiZm9udC1zaXplIiwgKHZhbHVlLCBvcmlnaW5hbCkgPT4gewogIHZhbHVlID0gb3JpZ2luYWwuZm9udFNpemUgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSk7CiAgcmV0dXJuICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKDAuOTkgKiB2YWx1ZSk7Cn1dLCBbImxldHRlci1zcGFjaW5nIiwgdmFsdWUgPT4gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpKV0sIFsibGluZS1oZWlnaHQiLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJtYXJnaW4iLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJtYXJnaW4tYm90dG9tIiwgdmFsdWUgPT4gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpKV0sIFsibWFyZ2luLWxlZnQiLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJtYXJnaW4tcmlnaHQiLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJtYXJnaW4tdG9wIiwgdmFsdWUgPT4gKDAsIF9odG1sX3V0aWxzLm1lYXN1cmVUb1N0cmluZykoKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpKV0sIFsidGV4dC1pbmRlbnQiLCB2YWx1ZSA9PiAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKSgoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSkpXSwgWyJmb250LWZhbWlseSIsIHZhbHVlID0+IHZhbHVlXSwgWyJ2ZXJ0aWNhbC1hbGlnbiIsIHZhbHVlID0+ICgwLCBfaHRtbF91dGlscy5tZWFzdXJlVG9TdHJpbmcpKCgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKSldXSk7CmNvbnN0IHNwYWNlc1JlZ0V4cCA9IC9ccysvZzsKY29uc3QgY3JsZlJlZ0V4cCA9IC9bXHJcbl0rL2c7CmNvbnN0IGNybGZGb3JSaWNoVGV4dFJlZ0V4cCA9IC9cclxuPy9nOwoKZnVuY3Rpb24gbWFwU3R5bGUoc3R5bGVTdHIsIG5vZGUsIHJpY2hUZXh0KSB7CiAgY29uc3Qgc3R5bGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICBpZiAoIXN0eWxlU3RyKSB7CiAgICByZXR1cm4gc3R5bGU7CiAgfQoKICBjb25zdCBvcmlnaW5hbCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHN0eWxlU3RyLnNwbGl0KCI7IikubWFwKHMgPT4gcy5zcGxpdCgiOiIsIDIpKSkgewogICAgY29uc3QgbWFwcGluZyA9IFN0eWxlTWFwcGluZy5nZXQoa2V5KTsKCiAgICBpZiAobWFwcGluZyA9PT0gIiIpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgbGV0IG5ld1ZhbHVlID0gdmFsdWU7CgogICAgaWYgKG1hcHBpbmcpIHsKICAgICAgaWYgKHR5cGVvZiBtYXBwaW5nID09PSAic3RyaW5nIikgewogICAgICAgIG5ld1ZhbHVlID0gbWFwcGluZzsKICAgICAgfSBlbHNlIHsKICAgICAgICBuZXdWYWx1ZSA9IG1hcHBpbmcodmFsdWUsIG9yaWdpbmFsKTsKICAgICAgfQogICAgfQoKICAgIGlmIChrZXkuZW5kc1dpdGgoInNjYWxlIikpIHsKICAgICAgaWYgKHN0eWxlLnRyYW5zZm9ybSkgewogICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IGAke3N0eWxlW2tleV19ICR7bmV3VmFsdWV9YDsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdHlsZS50cmFuc2Zvcm0gPSBuZXdWYWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgc3R5bGVba2V5LnJlcGxhY2VBbGwoLy0oW2EtekEtWl0pL2csIChfLCB4KSA9PiB4LnRvVXBwZXJDYXNlKCkpXSA9IG5ld1ZhbHVlOwogICAgfQogIH0KCiAgaWYgKHN0eWxlLmZvbnRGYW1pbHkpIHsKICAgICgwLCBfaHRtbF91dGlscy5zZXRGb250RmFtaWx5KSh7CiAgICAgIHR5cGVmYWNlOiBzdHlsZS5mb250RmFtaWx5LAogICAgICB3ZWlnaHQ6IHN0eWxlLmZvbnRXZWlnaHQgfHwgIm5vcm1hbCIsCiAgICAgIHBvc3R1cmU6IHN0eWxlLmZvbnRTdHlsZSB8fCAibm9ybWFsIiwKICAgICAgc2l6ZTogb3JpZ2luYWwuZm9udFNpemUgfHwgMAogICAgfSwgbm9kZSwgbm9kZVtfeGZhX29iamVjdC4kZ2xvYmFsRGF0YV0uZm9udEZpbmRlciwgc3R5bGUpOwogIH0KCiAgaWYgKHJpY2hUZXh0ICYmIHN0eWxlLnZlcnRpY2FsQWxpZ24gJiYgc3R5bGUudmVydGljYWxBbGlnbiAhPT0gIjBweCIgJiYgc3R5bGUuZm9udFNpemUpIHsKICAgIGNvbnN0IFNVQl9TVVBFUl9TQ1JJUFRfRkFDVE9SID0gMC41ODM7CiAgICBjb25zdCBWRVJUSUNBTF9GQUNUT1IgPSAwLjMzMzsKICAgIGNvbnN0IGZvbnRTaXplID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoc3R5bGUuZm9udFNpemUpOwogICAgc3R5bGUuZm9udFNpemUgPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKShmb250U2l6ZSAqIFNVQl9TVVBFUl9TQ1JJUFRfRkFDVE9SKTsKICAgIHN0eWxlLnZlcnRpY2FsQWxpZ24gPSAoMCwgX2h0bWxfdXRpbHMubWVhc3VyZVRvU3RyaW5nKShNYXRoLnNpZ24oKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkoc3R5bGUudmVydGljYWxBbGlnbikpICogZm9udFNpemUgKiBWRVJUSUNBTF9GQUNUT1IpOwogIH0KCiAgaWYgKHJpY2hUZXh0ICYmIHN0eWxlLmZvbnRTaXplKSB7CiAgICBzdHlsZS5mb250U2l6ZSA9IGBjYWxjKCR7c3R5bGUuZm9udFNpemV9ICogdmFyKC0tc2NhbGUtZmFjdG9yKSlgOwogIH0KCiAgKDAsIF9odG1sX3V0aWxzLmZpeFRleHRJbmRlbnQpKHN0eWxlKTsKICByZXR1cm4gc3R5bGU7Cn0KCmZ1bmN0aW9uIGNoZWNrU3R5bGUobm9kZSkgewogIGlmICghbm9kZS5zdHlsZSkgewogICAgcmV0dXJuICIiOwogIH0KCiAgcmV0dXJuIG5vZGUuc3R5bGUudHJpbSgpLnNwbGl0KC9ccyo7XHMqLykuZmlsdGVyKHMgPT4gISFzKS5tYXAocyA9PiBzLnNwbGl0KC9ccyo6XHMqLywgMikpLmZpbHRlcigoW2tleSwgdmFsdWVdKSA9PiB7CiAgICBpZiAoa2V5ID09PSAiZm9udC1mYW1pbHkiKSB7CiAgICAgIG5vZGVbX3hmYV9vYmplY3QuJGdsb2JhbERhdGFdLnVzZWRUeXBlZmFjZXMuYWRkKHZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gVkFMSURfU1RZTEVTLmhhcyhrZXkpOwogIH0pLm1hcChrdiA9PiBrdi5qb2luKCI6IikpLmpvaW4oIjsiKTsKfQoKY29uc3QgTm9XaGl0ZXMgPSBuZXcgU2V0KFsiYm9keSIsICJodG1sIl0pOwoKY2xhc3MgWGh0bWxPYmplY3QgZXh0ZW5kcyBfeGZhX29iamVjdC5YbWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMsIG5hbWUpIHsKICAgIHN1cGVyKFhIVE1MX05TX0lELCBuYW1lKTsKICAgIHRoaXNbJHJpY2hUZXh0XSA9IGZhbHNlOwogICAgdGhpcy5zdHlsZSA9IGF0dHJpYnV0ZXMuc3R5bGUgfHwgIiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJGNsZWFuXShidWlsZGVyKSB7CiAgICBzdXBlcltfeGZhX29iamVjdC4kY2xlYW5dKGJ1aWxkZXIpOwoKICAgIHRoaXMuc3R5bGUgPSBjaGVja1N0eWxlKHRoaXMpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRhY2NlcHRXaGl0ZXNwYWNlXSgpIHsKICAgIHJldHVybiAhTm9XaGl0ZXMuaGFzKHRoaXNbX3hmYV9vYmplY3QuJG5vZGVOYW1lXSk7CiAgfQoKICBbX3hmYV9vYmplY3QuJG9uVGV4dF0oc3RyLCByaWNoVGV4dCA9IGZhbHNlKSB7CiAgICBpZiAoIXJpY2hUZXh0KSB7CiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKGNybGZSZWdFeHAsICIiKTsKCiAgICAgIGlmICghdGhpcy5zdHlsZS5pbmNsdWRlcygieGZhLXNwYWNlcnVuOnllcyIpKSB7CiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2Uoc3BhY2VzUmVnRXhwLCAiICIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzWyRyaWNoVGV4dF0gPSB0cnVlOwogICAgfQoKICAgIGlmIChzdHIpIHsKICAgICAgdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0gKz0gc3RyOwogICAgfQogIH0KCiAgW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlLCBtdXN0UG9wID0gdHJ1ZSkgewogICAgY29uc3QgeGZhRm9udCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICBjb25zdCBtYXJnaW4gPSB7CiAgICAgIHRvcDogTmFOLAogICAgICBib3R0b206IE5hTiwKICAgICAgbGVmdDogTmFOLAogICAgICByaWdodDogTmFOCiAgICB9OwogICAgbGV0IGxpbmVIZWlnaHQgPSBudWxsOwoKICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHRoaXMuc3R5bGUuc3BsaXQoIjsiKS5tYXAocyA9PiBzLnNwbGl0KCI6IiwgMikpKSB7CiAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgY2FzZSAiZm9udC1mYW1pbHkiOgogICAgICAgICAgeGZhRm9udC50eXBlZmFjZSA9ICgwLCBfdXRpbHMuc3RyaXBRdW90ZXMpKHZhbHVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJmb250LXNpemUiOgogICAgICAgICAgeGZhRm9udC5zaXplID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgImZvbnQtd2VpZ2h0IjoKICAgICAgICAgIHhmYUZvbnQud2VpZ2h0ID0gdmFsdWU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiZm9udC1zdHlsZSI6CiAgICAgICAgICB4ZmFGb250LnBvc3R1cmUgPSB2YWx1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJsZXR0ZXItc3BhY2luZyI6CiAgICAgICAgICB4ZmFGb250LmxldHRlclNwYWNpbmcgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibWFyZ2luIjoKICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IHZhbHVlLnNwbGl0KC8gXHQvKS5tYXAoeCA9PiAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh4KSk7CgogICAgICAgICAgc3dpdGNoICh2YWx1ZXMubGVuZ3RoKSB7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBtYXJnaW4udG9wID0gbWFyZ2luLmJvdHRvbSA9IG1hcmdpbi5sZWZ0ID0gbWFyZ2luLnJpZ2h0ID0gdmFsdWVzWzBdOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIG1hcmdpbi50b3AgPSBtYXJnaW4uYm90dG9tID0gdmFsdWVzWzBdOwogICAgICAgICAgICAgIG1hcmdpbi5sZWZ0ID0gbWFyZ2luLnJpZ2h0ID0gdmFsdWVzWzFdOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIG1hcmdpbi50b3AgPSB2YWx1ZXNbMF07CiAgICAgICAgICAgICAgbWFyZ2luLmJvdHRvbSA9IHZhbHVlc1syXTsKICAgICAgICAgICAgICBtYXJnaW4ubGVmdCA9IG1hcmdpbi5yaWdodCA9IHZhbHVlc1sxXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBtYXJnaW4udG9wID0gdmFsdWVzWzBdOwogICAgICAgICAgICAgIG1hcmdpbi5sZWZ0ID0gdmFsdWVzWzFdOwogICAgICAgICAgICAgIG1hcmdpbi5ib3R0b20gPSB2YWx1ZXNbMl07CiAgICAgICAgICAgICAgbWFyZ2luLnJpZ2h0ID0gdmFsdWVzWzNdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJtYXJnaW4tdG9wIjoKICAgICAgICAgIG1hcmdpbi50b3AgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibWFyZ2luLWJvdHRvbSI6CiAgICAgICAgICBtYXJnaW4uYm90dG9tID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm1hcmdpbi1sZWZ0IjoKICAgICAgICAgIG1hcmdpbi5sZWZ0ID0gKDAsIF91dGlscy5nZXRNZWFzdXJlbWVudCkodmFsdWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIm1hcmdpbi1yaWdodCI6CiAgICAgICAgICBtYXJnaW4ucmlnaHQgPSAoMCwgX3V0aWxzLmdldE1lYXN1cmVtZW50KSh2YWx1ZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAibGluZS1oZWlnaHQiOgogICAgICAgICAgbGluZUhlaWdodCA9ICgwLCBfdXRpbHMuZ2V0TWVhc3VyZW1lbnQpKHZhbHVlKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgbWVhc3VyZS5wdXNoRGF0YSh4ZmFGb250LCBtYXJnaW4sIGxpbmVIZWlnaHQpOwoKICAgIGlmICh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSkgewogICAgICBtZWFzdXJlLmFkZFN0cmluZyh0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSk7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXNbX3hmYV9vYmplY3QuJGdldENoaWxkcmVuXSgpKSB7CiAgICAgICAgaWYgKGNoaWxkW194ZmFfb2JqZWN0LiRub2RlTmFtZV0gPT09ICIjdGV4dCIpIHsKICAgICAgICAgIG1lYXN1cmUuYWRkU3RyaW5nKGNoaWxkW194ZmFfb2JqZWN0LiRjb250ZW50XSk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNoaWxkW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKTsKICAgICAgfQogICAgfQoKICAgIGlmIChtdXN0UG9wKSB7CiAgICAgIG1lYXN1cmUucG9wRm9udCgpOwogICAgfQogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCBjaGlsZHJlbiA9IFtdOwogICAgdGhpc1tfeGZhX29iamVjdC4kZXh0cmFdID0gewogICAgICBjaGlsZHJlbgogICAgfTsKCiAgICB0aGlzW194ZmFfb2JqZWN0LiRjaGlsZHJlblRvSFRNTF0oe30pOwoKICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPT09IDAgJiYgIXRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5FTVBUWTsKICAgIH0KCiAgICBsZXQgdmFsdWU7CgogICAgaWYgKHRoaXNbJHJpY2hUZXh0XSkgewogICAgICB2YWx1ZSA9IHRoaXNbX3hmYV9vYmplY3QuJGNvbnRlbnRdID8gdGhpc1tfeGZhX29iamVjdC4kY29udGVudF0ucmVwbGFjZShjcmxmRm9yUmljaFRleHRSZWdFeHAsICJcbiIpIDogdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWUgPSB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSB8fCB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIF91dGlscy5IVE1MUmVzdWx0LnN1Y2Nlc3MoewogICAgICBuYW1lOiB0aGlzW194ZmFfb2JqZWN0LiRub2RlTmFtZV0sCiAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICBocmVmOiB0aGlzLmhyZWYsCiAgICAgICAgc3R5bGU6IG1hcFN0eWxlKHRoaXMuc3R5bGUsIHRoaXMsIHRoaXNbJHJpY2hUZXh0XSkKICAgICAgfSwKICAgICAgY2hpbGRyZW4sCiAgICAgIHZhbHVlCiAgICB9KTsKICB9Cgp9CgpjbGFzcyBBIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJhIik7CiAgICB0aGlzLmhyZWYgPSAoMCwgX2h0bWxfdXRpbHMuZml4VVJMKShhdHRyaWJ1dGVzLmhyZWYpIHx8ICIiOwogIH0KCn0KCmNsYXNzIEIgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImIiKTsKICB9CgogIFtfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSkgewogICAgbWVhc3VyZS5wdXNoRm9udCh7CiAgICAgIHdlaWdodDogImJvbGQiCiAgICB9KTsKCiAgICBzdXBlcltfeGZhX29iamVjdC4kcHVzaEdseXBoc10obWVhc3VyZSk7CgogICAgbWVhc3VyZS5wb3BGb250KCk7CiAgfQoKfQoKY2xhc3MgQm9keSBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAiYm9keSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICBjb25zdCByZXMgPSBzdXBlcltfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSk7CgogICAgY29uc3QgewogICAgICBodG1sCiAgICB9ID0gcmVzOwoKICAgIGlmICghaHRtbCkgewogICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuRU1QVFk7CiAgICB9CgogICAgaHRtbC5uYW1lID0gImRpdiI7CiAgICBodG1sLmF0dHJpYnV0ZXMuY2xhc3MgPSBbInhmYVJpY2giXTsKICAgIHJldHVybiByZXM7CiAgfQoKfQoKY2xhc3MgQnIgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImJyIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJHRleHRdKCkgewogICAgcmV0dXJuICJcbiI7CiAgfQoKICBbX3hmYV9vYmplY3QuJHB1c2hHbHlwaHNdKG1lYXN1cmUpIHsKICAgIG1lYXN1cmUuYWRkU3RyaW5nKCJcbiIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0b0hUTUxdKGF2YWlsYWJsZVNwYWNlKSB7CiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJiciIKICAgIH0pOwogIH0KCn0KCmNsYXNzIEh0bWwgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgImh0bWwiKTsKICB9CgogIFtfeGZhX29iamVjdC4kdG9IVE1MXShhdmFpbGFibGVTcGFjZSkgewogICAgY29uc3QgY2hpbGRyZW4gPSBbXTsKICAgIHRoaXNbX3hmYV9vYmplY3QuJGV4dHJhXSA9IHsKICAgICAgY2hpbGRyZW4KICAgIH07CgogICAgdGhpc1tfeGZhX29iamVjdC4kY2hpbGRyZW5Ub0hUTUxdKHt9KTsKCiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiBfdXRpbHMuSFRNTFJlc3VsdC5zdWNjZXNzKHsKICAgICAgICBuYW1lOiAiZGl2IiwKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjbGFzczogWyJ4ZmFSaWNoIl0sCiAgICAgICAgICBzdHlsZToge30KICAgICAgICB9LAogICAgICAgIHZhbHVlOiB0aGlzW194ZmFfb2JqZWN0LiRjb250ZW50XSB8fCAiIgogICAgICB9KTsKICAgIH0KCiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID09PSAxKSB7CiAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5bMF07CgogICAgICBpZiAoY2hpbGQuYXR0cmlidXRlcyAmJiBjaGlsZC5hdHRyaWJ1dGVzLmNsYXNzLmluY2x1ZGVzKCJ4ZmFSaWNoIikpIHsKICAgICAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2VzcyhjaGlsZCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gX3V0aWxzLkhUTUxSZXN1bHQuc3VjY2Vzcyh7CiAgICAgIG5hbWU6ICJkaXYiLAogICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgY2xhc3M6IFsieGZhUmljaCJdLAogICAgICAgIHN0eWxlOiB7fQogICAgICB9LAogICAgICBjaGlsZHJlbgogICAgfSk7CiAgfQoKfQoKY2xhc3MgSSBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAiaSIpOwogIH0KCiAgW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKSB7CiAgICBtZWFzdXJlLnB1c2hGb250KHsKICAgICAgcG9zdHVyZTogIml0YWxpYyIKICAgIH0pOwoKICAgIHN1cGVyW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlKTsKCiAgICBtZWFzdXJlLnBvcEZvbnQoKTsKICB9Cgp9CgpjbGFzcyBMaSBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAibGkiKTsKICB9Cgp9CgpjbGFzcyBPbCBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAib2wiKTsKICB9Cgp9CgpjbGFzcyBQIGV4dGVuZHMgWGh0bWxPYmplY3QgewogIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXMpIHsKICAgIHN1cGVyKGF0dHJpYnV0ZXMsICJwIik7CiAgfQoKICBbX3hmYV9vYmplY3QuJHB1c2hHbHlwaHNdKG1lYXN1cmUpIHsKICAgIHN1cGVyW194ZmFfb2JqZWN0LiRwdXNoR2x5cGhzXShtZWFzdXJlLCBmYWxzZSk7CgogICAgbWVhc3VyZS5hZGRTdHJpbmcoIlxuIik7CiAgICBtZWFzdXJlLmFkZFBhcmEoKTsKICAgIG1lYXN1cmUucG9wRm9udCgpOwogIH0KCiAgW194ZmFfb2JqZWN0LiR0ZXh0XSgpIHsKICAgIGNvbnN0IHNpYmxpbmdzID0gdGhpc1tfeGZhX29iamVjdC4kZ2V0UGFyZW50XSgpW194ZmFfb2JqZWN0LiRnZXRDaGlsZHJlbl0oKTsKCiAgICBpZiAoc2libGluZ3MuYXQoLTEpID09PSB0aGlzKSB7CiAgICAgIHJldHVybiBzdXBlcltfeGZhX29iamVjdC4kdGV4dF0oKTsKICAgIH0KCiAgICByZXR1cm4gc3VwZXJbX3hmYV9vYmplY3QuJHRleHRdKCkgKyAiXG4iOwogIH0KCn0KCmNsYXNzIFNwYW4gZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgInNwYW4iKTsKICB9Cgp9CgpjbGFzcyBTdWIgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgInN1YiIpOwogIH0KCn0KCmNsYXNzIFN1cCBleHRlbmRzIFhodG1sT2JqZWN0IHsKICBjb25zdHJ1Y3RvcihhdHRyaWJ1dGVzKSB7CiAgICBzdXBlcihhdHRyaWJ1dGVzLCAic3VwIik7CiAgfQoKfQoKY2xhc3MgVWwgZXh0ZW5kcyBYaHRtbE9iamVjdCB7CiAgY29uc3RydWN0b3IoYXR0cmlidXRlcykgewogICAgc3VwZXIoYXR0cmlidXRlcywgInVsIik7CiAgfQoKfQoKY2xhc3MgWGh0bWxOYW1lc3BhY2UgewogIHN0YXRpYyBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICBpZiAoWGh0bWxOYW1lc3BhY2UuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgcmV0dXJuIFhodG1sTmFtZXNwYWNlW25hbWVdKGF0dHJpYnV0ZXMpOwogICAgfQoKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBzdGF0aWMgYShhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IEEoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgYihhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IEIoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgYm9keShhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IEJvZHkoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgYnIoYXR0cmlidXRlcykgewogICAgcmV0dXJuIG5ldyBCcihhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyBodG1sKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgSHRtbChhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyBpKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgSShhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyBsaShhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IExpKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIG9sKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgT2woYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgcChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFAoYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgc3BhbihhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFNwYW4oYXR0cmlidXRlcyk7CiAgfQoKICBzdGF0aWMgc3ViKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBuZXcgU3ViKGF0dHJpYnV0ZXMpOwogIH0KCiAgc3RhdGljIHN1cChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFN1cChhdHRyaWJ1dGVzKTsKICB9CgogIHN0YXRpYyB1bChhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IFVsKGF0dHJpYnV0ZXMpOwogIH0KCn0KCmV4cG9ydHMuWGh0bWxOYW1lc3BhY2UgPSBYaHRtbE5hbWVzcGFjZTsKCi8qKiovIH0pLAovKiA5OSAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlVua25vd25OYW1lc3BhY2UgPSB2b2lkIDA7Cgp2YXIgX25hbWVzcGFjZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc5KTsKCnZhciBfeGZhX29iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzcpOwoKY2xhc3MgVW5rbm93bk5hbWVzcGFjZSB7CiAgY29uc3RydWN0b3IobnNJZCkgewogICAgdGhpcy5uYW1lc3BhY2VJZCA9IG5zSWQ7CiAgfQoKICBbX25hbWVzcGFjZXMuJGJ1aWxkWEZBT2JqZWN0XShuYW1lLCBhdHRyaWJ1dGVzKSB7CiAgICByZXR1cm4gbmV3IF94ZmFfb2JqZWN0LlhtbE9iamVjdCh0aGlzLm5hbWVzcGFjZUlkLCBuYW1lLCBhdHRyaWJ1dGVzKTsKICB9Cgp9CgpleHBvcnRzLlVua25vd25OYW1lc3BhY2UgPSBVbmtub3duTmFtZXNwYWNlOwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLkRhdGFzZXRSZWFkZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfeG1sX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNjYpOwoKZnVuY3Rpb24gZGVjb2RlU3RyaW5nKHN0cikgewogIHRyeSB7CiAgICByZXR1cm4gKDAsIF91dGlsLnN0cmluZ1RvVVRGOFN0cmluZykoc3RyKTsKICB9IGNhdGNoIChleCkgewogICAgKDAsIF91dGlsLndhcm4pKGBVVEYtOCBkZWNvZGluZyBmYWlsZWQ6ICIke2V4fSIuYCk7CiAgICByZXR1cm4gc3RyOwogIH0KfQoKY2xhc3MgRGF0YXNldFhNTFBhcnNlciBleHRlbmRzIF94bWxfcGFyc2VyLlNpbXBsZVhNTFBhcnNlciB7CiAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgc3VwZXIob3B0aW9ucyk7CiAgICB0aGlzLm5vZGUgPSBudWxsOwogIH0KCiAgb25FbmRFbGVtZW50KG5hbWUpIHsKICAgIGNvbnN0IG5vZGUgPSBzdXBlci5vbkVuZEVsZW1lbnQobmFtZSk7CgogICAgaWYgKG5vZGUgJiYgbmFtZSA9PT0gInhmYTpkYXRhc2V0cyIpIHsKICAgICAgdGhpcy5ub2RlID0gbm9kZTsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJBYm9ydGluZyBEYXRhc2V0WE1MUGFyc2VyLiIpOwogICAgfQogIH0KCn0KCmNsYXNzIERhdGFzZXRSZWFkZXIgewogIGNvbnN0cnVjdG9yKGRhdGEpIHsKICAgIGlmIChkYXRhLmRhdGFzZXRzKSB7CiAgICAgIHRoaXMubm9kZSA9IG5ldyBfeG1sX3BhcnNlci5TaW1wbGVYTUxQYXJzZXIoewogICAgICAgIGhhc0F0dHJpYnV0ZXM6IHRydWUKICAgICAgfSkucGFyc2VGcm9tU3RyaW5nKGRhdGEuZGF0YXNldHMpLmRvY3VtZW50RWxlbWVudDsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBEYXRhc2V0WE1MUGFyc2VyKHsKICAgICAgICBoYXNBdHRyaWJ1dGVzOiB0cnVlCiAgICAgIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKGRhdGFbInhkcDp4ZHAiXSk7CiAgICAgIH0gY2F0Y2ggKF8pIHt9CgogICAgICB0aGlzLm5vZGUgPSBwYXJzZXIubm9kZTsKICAgIH0KICB9CgogIGdldFZhbHVlKHBhdGgpIHsKICAgIGlmICghdGhpcy5ub2RlIHx8ICFwYXRoKSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBjb25zdCBub2RlID0gdGhpcy5ub2RlLnNlYXJjaE5vZGUoKDAsIF9jb3JlX3V0aWxzLnBhcnNlWEZBUGF0aCkocGF0aCksIDApOwoKICAgIGlmICghbm9kZSkgewogICAgICByZXR1cm4gIiI7CiAgICB9CgogICAgY29uc3QgZmlyc3QgPSBub2RlLmZpcnN0Q2hpbGQ7CgogICAgaWYgKGZpcnN0ICYmIGZpcnN0Lm5vZGVOYW1lID09PSAidmFsdWUiKSB7CiAgICAgIHJldHVybiBub2RlLmNoaWxkcmVuLm1hcChjaGlsZCA9PiBkZWNvZGVTdHJpbmcoY2hpbGQudGV4dENvbnRlbnQpKTsKICAgIH0KCiAgICByZXR1cm4gZGVjb2RlU3RyaW5nKG5vZGUudGV4dENvbnRlbnQpOwogIH0KCn0KCmV4cG9ydHMuRGF0YXNldFJlYWRlciA9IERhdGFzZXRSZWFkZXI7CgovKioqLyB9KSwKLyogMTAxICovCi8qKiovICgoX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pID0+IHsKCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgKHsKICB2YWx1ZTogdHJ1ZQp9KSk7CmV4cG9ydHMuWFJlZiA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxNyk7Cgp2YXIgX2Jhc2Vfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfY3J5cHRvID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Nyk7CgpjbGFzcyBYUmVmIHsKICBjb25zdHJ1Y3RvcihzdHJlYW0sIHBkZk1hbmFnZXIpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5wZGZNYW5hZ2VyID0gcGRmTWFuYWdlcjsKICAgIHRoaXMuZW50cmllcyA9IFtdOwogICAgdGhpcy54cmVmc3RtcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLl9jYWNoZU1hcCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX3BlbmRpbmdSZWZzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgdGhpcy5zdGF0cyA9IG5ldyBfY29yZV91dGlscy5Eb2NTdGF0cyhwZGZNYW5hZ2VyLm1zZ0hhbmRsZXIpOwogICAgdGhpcy5fbmV3UmVmTnVtID0gbnVsbDsKICB9CgogIGdldE5ld1JlZigpIHsKICAgIGlmICh0aGlzLl9uZXdSZWZOdW0gPT09IG51bGwpIHsKICAgICAgdGhpcy5fbmV3UmVmTnVtID0gdGhpcy5lbnRyaWVzLmxlbmd0aCB8fCAxOwogICAgfQoKICAgIHJldHVybiBfcHJpbWl0aXZlcy5SZWYuZ2V0KHRoaXMuX25ld1JlZk51bSsrLCAwKTsKICB9CgogIHJlc2V0TmV3UmVmKCkgewogICAgdGhpcy5fbmV3UmVmTnVtID0gbnVsbDsKICB9CgogIHNldFN0YXJ0WFJlZihzdGFydFhSZWYpIHsKICAgIHRoaXMuc3RhcnRYUmVmUXVldWUgPSBbc3RhcnRYUmVmXTsKICB9CgogIHBhcnNlKHJlY292ZXJ5TW9kZSA9IGZhbHNlKSB7CiAgICBsZXQgdHJhaWxlckRpY3Q7CgogICAgaWYgKCFyZWNvdmVyeU1vZGUpIHsKICAgICAgdHJhaWxlckRpY3QgPSB0aGlzLnJlYWRYUmVmKCk7CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoIkluZGV4aW5nIGFsbCBQREYgb2JqZWN0cyIpOwogICAgICB0cmFpbGVyRGljdCA9IHRoaXMuaW5kZXhPYmplY3RzKCk7CiAgICB9CgogICAgdHJhaWxlckRpY3QuYXNzaWduWHJlZih0aGlzKTsKICAgIHRoaXMudHJhaWxlciA9IHRyYWlsZXJEaWN0OwogICAgbGV0IGVuY3J5cHQ7CgogICAgdHJ5IHsKICAgICAgZW5jcnlwdCA9IHRyYWlsZXJEaWN0LmdldCgiRW5jcnlwdCIpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBYUmVmLnBhcnNlIC0gSW52YWxpZCAiRW5jcnlwdCIgcmVmZXJlbmNlOiAiJHtleH0iLmApOwogICAgfQoKICAgIGlmIChlbmNyeXB0IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICBjb25zdCBpZHMgPSB0cmFpbGVyRGljdC5nZXQoIklEIik7CiAgICAgIGNvbnN0IGZpbGVJZCA9IGlkcyAmJiBpZHMubGVuZ3RoID8gaWRzWzBdIDogIiI7CiAgICAgIGVuY3J5cHQuc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgdGhpcy5lbmNyeXB0ID0gbmV3IF9jcnlwdG8uQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeShlbmNyeXB0LCBmaWxlSWQsIHRoaXMucGRmTWFuYWdlci5wYXNzd29yZCk7CiAgICB9CgogICAgbGV0IHJvb3Q7CgogICAgdHJ5IHsKICAgICAgcm9vdCA9IHRyYWlsZXJEaWN0LmdldCgiUm9vdCIpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKGBYUmVmLnBhcnNlIC0gSW52YWxpZCAiUm9vdCIgcmVmZXJlbmNlOiAiJHtleH0iLmApOwogICAgfQoKICAgIGlmIChyb290IGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHBhZ2VzID0gcm9vdC5nZXQoIlBhZ2VzIik7CgogICAgICAgIGlmIChwYWdlcyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKShgWFJlZi5wYXJzZSAtIEludmFsaWQgIlBhZ2VzIiByZWZlcmVuY2U6ICIke2V4fSIuYCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXJlY292ZXJ5TW9kZSkgewogICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZlBhcnNlRXhjZXB0aW9uKCk7CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkludmFsaWRQREZFeGNlcHRpb24oIkludmFsaWQgUm9vdCByZWZlcmVuY2UuIik7CiAgfQoKICBwcm9jZXNzWFJlZlRhYmxlKHBhcnNlcikgewogICAgaWYgKCEoInRhYmxlU3RhdGUiIGluIHRoaXMpKSB7CiAgICAgIHRoaXMudGFibGVTdGF0ZSA9IHsKICAgICAgICBlbnRyeU51bTogMCwKICAgICAgICBzdHJlYW1Qb3M6IHBhcnNlci5sZXhlci5zdHJlYW0ucG9zLAogICAgICAgIHBhcnNlckJ1ZjE6IHBhcnNlci5idWYxLAogICAgICAgIHBhcnNlckJ1ZjI6IHBhcnNlci5idWYyCiAgICAgIH07CiAgICB9CgogICAgY29uc3Qgb2JqID0gdGhpcy5yZWFkWFJlZlRhYmxlKHBhcnNlcik7CgogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgInRyYWlsZXIiKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogY291bGQgbm90IGZpbmQgdHJhaWxlciBkaWN0aW9uYXJ5Iik7CiAgICB9CgogICAgbGV0IGRpY3QgPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpICYmIGRpY3QuZGljdCkgewogICAgICBkaWN0ID0gZGljdC5kaWN0OwogICAgfQoKICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogY291bGQgbm90IHBhcnNlIHRyYWlsZXIgZGljdGlvbmFyeSIpOwogICAgfQoKICAgIGRlbGV0ZSB0aGlzLnRhYmxlU3RhdGU7CiAgICByZXR1cm4gZGljdDsKICB9CgogIHJlYWRYUmVmVGFibGUocGFyc2VyKSB7CiAgICBjb25zdCBzdHJlYW0gPSBwYXJzZXIubGV4ZXIuc3RyZWFtOwogICAgY29uc3QgdGFibGVTdGF0ZSA9IHRoaXMudGFibGVTdGF0ZTsKICAgIHN0cmVhbS5wb3MgPSB0YWJsZVN0YXRlLnN0cmVhbVBvczsKICAgIHBhcnNlci5idWYxID0gdGFibGVTdGF0ZS5wYXJzZXJCdWYxOwogICAgcGFyc2VyLmJ1ZjIgPSB0YWJsZVN0YXRlLnBhcnNlckJ1ZjI7CiAgICBsZXQgb2JqOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIGlmICghKCJmaXJzdEVudHJ5TnVtIiBpbiB0YWJsZVN0YXRlKSB8fCAhKCJlbnRyeUNvdW50IiBpbiB0YWJsZVN0YXRlKSkgewogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiA9IHBhcnNlci5nZXRPYmooKSwgInRyYWlsZXIiKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW0gPSBvYmo7CiAgICAgICAgdGFibGVTdGF0ZS5lbnRyeUNvdW50ID0gcGFyc2VyLmdldE9iaigpOwogICAgICB9CgogICAgICBsZXQgZmlyc3QgPSB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW07CiAgICAgIGNvbnN0IGNvdW50ID0gdGFibGVTdGF0ZS5lbnRyeUNvdW50OwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihjb3VudCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogd3JvbmcgdHlwZXMgaW4gc3Vic2VjdGlvbiBoZWFkZXIiKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IHRhYmxlU3RhdGUuZW50cnlOdW07IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgdGFibGVTdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICAgIHRhYmxlU3RhdGUuZW50cnlOdW0gPSBpOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMSA9IHBhcnNlci5idWYxOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMiA9IHBhcnNlci5idWYyOwogICAgICAgIGNvbnN0IGVudHJ5ID0ge307CiAgICAgICAgZW50cnkub2Zmc2V0ID0gcGFyc2VyLmdldE9iaigpOwogICAgICAgIGVudHJ5LmdlbiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgICBjb25zdCB0eXBlID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgICBpZiAodHlwZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCkgewogICAgICAgICAgc3dpdGNoICh0eXBlLmNtZCkgewogICAgICAgICAgICBjYXNlICJmIjoKICAgICAgICAgICAgICBlbnRyeS5mcmVlID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgIm4iOgogICAgICAgICAgICAgIGVudHJ5LnVuY29tcHJlc3NlZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZW50cnkub2Zmc2V0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihlbnRyeS5nZW4pIHx8ICEoZW50cnkuZnJlZSB8fCBlbnRyeS51bmNvbXByZXNzZWQpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgZW50cnkgaW4gWFJlZiBzdWJzZWN0aW9uOiAke2ZpcnN0fSwgJHtjb3VudH1gKTsKICAgICAgICB9CgogICAgICAgIGlmIChpID09PSAwICYmIGVudHJ5LmZyZWUgJiYgZmlyc3QgPT09IDEpIHsKICAgICAgICAgIGZpcnN0ID0gMDsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5lbnRyaWVzW2kgKyBmaXJzdF0pIHsKICAgICAgICAgIHRoaXMuZW50cmllc1tpICsgZmlyc3RdID0gZW50cnk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0YWJsZVN0YXRlLmVudHJ5TnVtID0gMDsKICAgICAgdGFibGVTdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICB0YWJsZVN0YXRlLnBhcnNlckJ1ZjEgPSBwYXJzZXIuYnVmMTsKICAgICAgdGFibGVTdGF0ZS5wYXJzZXJCdWYyID0gcGFyc2VyLmJ1ZjI7CiAgICAgIGRlbGV0ZSB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW07CiAgICAgIGRlbGV0ZSB0YWJsZVN0YXRlLmVudHJ5Q291bnQ7CiAgICB9CgogICAgaWYgKHRoaXMuZW50cmllc1swXSAmJiAhdGhpcy5lbnRyaWVzWzBdLmZyZWUpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgdGFibGU6IHVuZXhwZWN0ZWQgZmlyc3Qgb2JqZWN0Iik7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIHByb2Nlc3NYUmVmU3RyZWFtKHN0cmVhbSkgewogICAgaWYgKCEoInN0cmVhbVN0YXRlIiBpbiB0aGlzKSkgewogICAgICBjb25zdCBzdHJlYW1QYXJhbWV0ZXJzID0gc3RyZWFtLmRpY3Q7CiAgICAgIGNvbnN0IGJ5dGVXaWR0aHMgPSBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiVyIpOwogICAgICBsZXQgcmFuZ2UgPSBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiSW5kZXgiKTsKCiAgICAgIGlmICghcmFuZ2UpIHsKICAgICAgICByYW5nZSA9IFswLCBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiU2l6ZSIpXTsKICAgICAgfQoKICAgICAgdGhpcy5zdHJlYW1TdGF0ZSA9IHsKICAgICAgICBlbnRyeVJhbmdlczogcmFuZ2UsCiAgICAgICAgYnl0ZVdpZHRocywKICAgICAgICBlbnRyeU51bTogMCwKICAgICAgICBzdHJlYW1Qb3M6IHN0cmVhbS5wb3MKICAgICAgfTsKICAgIH0KCiAgICB0aGlzLnJlYWRYUmVmU3RyZWFtKHN0cmVhbSk7CiAgICBkZWxldGUgdGhpcy5zdHJlYW1TdGF0ZTsKICAgIHJldHVybiBzdHJlYW0uZGljdDsKICB9CgogIHJlYWRYUmVmU3RyZWFtKHN0cmVhbSkgewogICAgY29uc3Qgc3RyZWFtU3RhdGUgPSB0aGlzLnN0cmVhbVN0YXRlOwogICAgc3RyZWFtLnBvcyA9IHN0cmVhbVN0YXRlLnN0cmVhbVBvczsKICAgIGNvbnN0IFt0eXBlRmllbGRXaWR0aCwgb2Zmc2V0RmllbGRXaWR0aCwgZ2VuZXJhdGlvbkZpZWxkV2lkdGhdID0gc3RyZWFtU3RhdGUuYnl0ZVdpZHRoczsKICAgIGNvbnN0IGVudHJ5UmFuZ2VzID0gc3RyZWFtU3RhdGUuZW50cnlSYW5nZXM7CgogICAgd2hpbGUgKGVudHJ5UmFuZ2VzLmxlbmd0aCA+IDApIHsKICAgICAgY29uc3QgW2ZpcnN0LCBuXSA9IGVudHJ5UmFuZ2VzOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihuKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgSW52YWxpZCBYUmVmIHJhbmdlIGZpZWxkczogJHtmaXJzdH0sICR7bn1gKTsKICAgICAgfQoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHR5cGVGaWVsZFdpZHRoKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihvZmZzZXRGaWVsZFdpZHRoKSB8fCAhTnVtYmVyLmlzSW50ZWdlcihnZW5lcmF0aW9uRmllbGRXaWR0aCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgWFJlZiBlbnRyeSBmaWVsZHMgbGVuZ3RoOiAke2ZpcnN0fSwgJHtufWApOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gc3RyZWFtU3RhdGUuZW50cnlOdW07IGkgPCBuOyArK2kpIHsKICAgICAgICBzdHJlYW1TdGF0ZS5lbnRyeU51bSA9IGk7CiAgICAgICAgc3RyZWFtU3RhdGUuc3RyZWFtUG9zID0gc3RyZWFtLnBvczsKICAgICAgICBsZXQgdHlwZSA9IDAsCiAgICAgICAgICAgIG9mZnNldCA9IDAsCiAgICAgICAgICAgIGdlbmVyYXRpb24gPSAwOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHR5cGVGaWVsZFdpZHRoOyArK2opIHsKICAgICAgICAgIGNvbnN0IHR5cGVCeXRlID0gc3RyZWFtLmdldEJ5dGUoKTsKCiAgICAgICAgICBpZiAodHlwZUJ5dGUgPT09IC0xKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIGJ5dGVXaWR0aHMgJ3R5cGUnLiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHR5cGUgPSB0eXBlIDw8IDggfCB0eXBlQnl0ZTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlRmllbGRXaWR0aCA9PT0gMCkgewogICAgICAgICAgdHlwZSA9IDE7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG9mZnNldEZpZWxkV2lkdGg7ICsraikgewogICAgICAgICAgY29uc3Qgb2Zmc2V0Qnl0ZSA9IHN0cmVhbS5nZXRCeXRlKCk7CgogICAgICAgICAgaWYgKG9mZnNldEJ5dGUgPT09IC0xKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIGJ5dGVXaWR0aHMgJ29mZnNldCcuIik7CiAgICAgICAgICB9CgogICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IDw8IDggfCBvZmZzZXRCeXRlOwogICAgICAgIH0KCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBnZW5lcmF0aW9uRmllbGRXaWR0aDsgKytqKSB7CiAgICAgICAgICBjb25zdCBnZW5lcmF0aW9uQnl0ZSA9IHN0cmVhbS5nZXRCeXRlKCk7CgogICAgICAgICAgaWYgKGdlbmVyYXRpb25CeXRlID09PSAtMSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBieXRlV2lkdGhzICdnZW5lcmF0aW9uJy4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBnZW5lcmF0aW9uID0gZ2VuZXJhdGlvbiA8PCA4IHwgZ2VuZXJhdGlvbkJ5dGU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBlbnRyeSA9IHt9OwogICAgICAgIGVudHJ5Lm9mZnNldCA9IG9mZnNldDsKICAgICAgICBlbnRyeS5nZW4gPSBnZW5lcmF0aW9uOwoKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgZW50cnkuZnJlZSA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgZW50cnkudW5jb21wcmVzc2VkID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYEludmFsaWQgWFJlZiBlbnRyeSB0eXBlOiAke3R5cGV9YCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXRoaXMuZW50cmllc1tmaXJzdCArIGldKSB7CiAgICAgICAgICB0aGlzLmVudHJpZXNbZmlyc3QgKyBpXSA9IGVudHJ5OwogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RyZWFtU3RhdGUuZW50cnlOdW0gPSAwOwogICAgICBzdHJlYW1TdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICBlbnRyeVJhbmdlcy5zcGxpY2UoMCwgMik7CiAgICB9CiAgfQoKICBpbmRleE9iamVjdHMoKSB7CiAgICBjb25zdCBUQUIgPSAweDksCiAgICAgICAgICBMRiA9IDB4YSwKICAgICAgICAgIENSID0gMHhkLAogICAgICAgICAgU1BBQ0UgPSAweDIwOwogICAgY29uc3QgUEVSQ0VOVCA9IDB4MjUsCiAgICAgICAgICBMVCA9IDB4M2M7CgogICAgZnVuY3Rpb24gcmVhZFRva2VuKGRhdGEsIG9mZnNldCkgewogICAgICBsZXQgdG9rZW4gPSAiIiwKICAgICAgICAgIGNoID0gZGF0YVtvZmZzZXRdOwoKICAgICAgd2hpbGUgKGNoICE9PSBMRiAmJiBjaCAhPT0gQ1IgJiYgY2ggIT09IExUKSB7CiAgICAgICAgaWYgKCsrb2Zmc2V0ID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHRva2VuICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwogICAgICAgIGNoID0gZGF0YVtvZmZzZXRdOwogICAgICB9CgogICAgICByZXR1cm4gdG9rZW47CiAgICB9CgogICAgZnVuY3Rpb24gc2tpcFVudGlsKGRhdGEsIG9mZnNldCwgd2hhdCkgewogICAgICBjb25zdCBsZW5ndGggPSB3aGF0Lmxlbmd0aCwKICAgICAgICAgICAgZGF0YUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgICBsZXQgc2tpcHBlZCA9IDA7CgogICAgICB3aGlsZSAob2Zmc2V0IDwgZGF0YUxlbmd0aCkgewogICAgICAgIGxldCBpID0gMDsKCiAgICAgICAgd2hpbGUgKGkgPCBsZW5ndGggJiYgZGF0YVtvZmZzZXQgKyBpXSA9PT0gd2hhdFtpXSkgewogICAgICAgICAgKytpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGkgPj0gbGVuZ3RoKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIG9mZnNldCsrOwogICAgICAgIHNraXBwZWQrKzsKICAgICAgfQoKICAgICAgcmV0dXJuIHNraXBwZWQ7CiAgICB9CgogICAgY29uc3Qgb2JqUmVnRXhwID0gL14oXGQrKVxzKyhcZCspXHMrb2JqXGIvOwogICAgY29uc3QgZW5kb2JqUmVnRXhwID0gL1xiZW5kb2JqW1xiXHNdJC87CiAgICBjb25zdCBuZXN0ZWRPYmpSZWdFeHAgPSAvXHMrKFxkK1xzK1xkK1xzK29ialtcYlxzPF0pJC87CiAgICBjb25zdCBDSEVDS19DT05URU5UX0xFTkdUSCA9IDI1OwogICAgY29uc3QgdHJhaWxlckJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzExNiwgMTE0LCA5NywgMTA1LCAxMDgsIDEwMSwgMTE0XSk7CiAgICBjb25zdCBzdGFydHhyZWZCeXRlcyA9IG5ldyBVaW50OEFycmF5KFsxMTUsIDExNiwgOTcsIDExNCwgMTE2LCAxMjAsIDExNCwgMTAxLCAxMDJdKTsKICAgIGNvbnN0IG9iakJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzExMSwgOTgsIDEwNl0pOwogICAgY29uc3QgeHJlZkJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzQ3LCA4OCwgODIsIDEwMSwgMTAyXSk7CiAgICB0aGlzLmVudHJpZXMubGVuZ3RoID0gMDsKCiAgICB0aGlzLl9jYWNoZU1hcC5jbGVhcigpOwoKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgc3RyZWFtLnBvcyA9IDA7CiAgICBjb25zdCBidWZmZXIgPSBzdHJlYW0uZ2V0Qnl0ZXMoKSwKICAgICAgICAgIGxlbmd0aCA9IGJ1ZmZlci5sZW5ndGg7CiAgICBsZXQgcG9zaXRpb24gPSBzdHJlYW0uc3RhcnQ7CiAgICBjb25zdCB0cmFpbGVycyA9IFtdLAogICAgICAgICAgeHJlZlN0bXMgPSBbXTsKCiAgICB3aGlsZSAocG9zaXRpb24gPCBsZW5ndGgpIHsKICAgICAgbGV0IGNoID0gYnVmZmVyW3Bvc2l0aW9uXTsKCiAgICAgIGlmIChjaCA9PT0gVEFCIHx8IGNoID09PSBMRiB8fCBjaCA9PT0gQ1IgfHwgY2ggPT09IFNQQUNFKSB7CiAgICAgICAgKytwb3NpdGlvbjsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGNoID09PSBQRVJDRU5UKSB7CiAgICAgICAgZG8gewogICAgICAgICAgKytwb3NpdGlvbjsKCiAgICAgICAgICBpZiAocG9zaXRpb24gPj0gbGVuZ3RoKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNoID0gYnVmZmVyW3Bvc2l0aW9uXTsKICAgICAgICB9IHdoaWxlIChjaCAhPT0gTEYgJiYgY2ggIT09IENSKTsKCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGNvbnN0IHRva2VuID0gcmVhZFRva2VuKGJ1ZmZlciwgcG9zaXRpb24pOwogICAgICBsZXQgbTsKCiAgICAgIGlmICh0b2tlbi5zdGFydHNXaXRoKCJ4cmVmIikgJiYgKHRva2VuLmxlbmd0aCA9PT0gNCB8fCAvXHMvLnRlc3QodG9rZW5bNF0pKSkgewogICAgICAgIHBvc2l0aW9uICs9IHNraXBVbnRpbChidWZmZXIsIHBvc2l0aW9uLCB0cmFpbGVyQnl0ZXMpOwogICAgICAgIHRyYWlsZXJzLnB1c2gocG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IHNraXBVbnRpbChidWZmZXIsIHBvc2l0aW9uLCBzdGFydHhyZWZCeXRlcyk7CiAgICAgIH0gZWxzZSBpZiAobSA9IG9ialJlZ0V4cC5leGVjKHRva2VuKSkgewogICAgICAgIGNvbnN0IG51bSA9IG1bMV0gfCAwLAogICAgICAgICAgICAgIGdlbiA9IG1bMl0gfCAwOwogICAgICAgIGxldCBjb250ZW50TGVuZ3RoLAogICAgICAgICAgICBzdGFydFBvcyA9IHBvc2l0aW9uICsgdG9rZW4ubGVuZ3RoLAogICAgICAgICAgICB1cGRhdGVFbnRyaWVzID0gZmFsc2U7CgogICAgICAgIGlmICghdGhpcy5lbnRyaWVzW251bV0pIHsKICAgICAgICAgIHVwZGF0ZUVudHJpZXMgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbnRyaWVzW251bV0uZ2VuID09PSBnZW4pIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgICAgICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbS5tYWtlU3ViU3RyZWFtKHN0YXJ0UG9zKSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHBhcnNlci5nZXRPYmooKTsKICAgICAgICAgICAgdXBkYXRlRW50cmllcyA9IHRydWU7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5QYXJzZXJFT0ZFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoYGluZGV4T2JqZWN0cyAtLSBjaGVja2luZyBvYmplY3QgKCR7dG9rZW59KTogIiR7ZXh9Ii5gKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB1cGRhdGVFbnRyaWVzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHVwZGF0ZUVudHJpZXMpIHsKICAgICAgICAgIHRoaXMuZW50cmllc1tudW1dID0gewogICAgICAgICAgICBvZmZzZXQ6IHBvc2l0aW9uIC0gc3RyZWFtLnN0YXJ0LAogICAgICAgICAgICBnZW4sCiAgICAgICAgICAgIHVuY29tcHJlc3NlZDogdHJ1ZQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHdoaWxlIChzdGFydFBvcyA8IGJ1ZmZlci5sZW5ndGgpIHsKICAgICAgICAgIGNvbnN0IGVuZFBvcyA9IHN0YXJ0UG9zICsgc2tpcFVudGlsKGJ1ZmZlciwgc3RhcnRQb3MsIG9iakJ5dGVzKSArIDQ7CiAgICAgICAgICBjb250ZW50TGVuZ3RoID0gZW5kUG9zIC0gcG9zaXRpb247CiAgICAgICAgICBjb25zdCBjaGVja1BvcyA9IE1hdGgubWF4KGVuZFBvcyAtIENIRUNLX0NPTlRFTlRfTEVOR1RILCBzdGFydFBvcyk7CiAgICAgICAgICBjb25zdCB0b2tlblN0ciA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShidWZmZXIuc3ViYXJyYXkoY2hlY2tQb3MsIGVuZFBvcykpOwoKICAgICAgICAgIGlmIChlbmRvYmpSZWdFeHAudGVzdCh0b2tlblN0cikpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBvYmpUb2tlbiA9IG5lc3RlZE9ialJlZ0V4cC5leGVjKHRva2VuU3RyKTsKCiAgICAgICAgICAgIGlmIChvYmpUb2tlbiAmJiBvYmpUb2tlblsxXSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgnaW5kZXhPYmplY3RzOiBGb3VuZCBuZXcgIm9iaiIgaW5zaWRlIG9mIGFub3RoZXIgIm9iaiIsICcgKyAnY2F1c2VkIGJ5IG1pc3NpbmcgImVuZG9iaiIgLS0gdHJ5aW5nIHRvIHJlY292ZXIuJyk7CiAgICAgICAgICAgICAgY29udGVudExlbmd0aCAtPSBvYmpUb2tlblsxXS5sZW5ndGg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzdGFydFBvcyA9IGVuZFBvczsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGNvbnRlbnQgPSBidWZmZXIuc3ViYXJyYXkocG9zaXRpb24sIHBvc2l0aW9uICsgY29udGVudExlbmd0aCk7CiAgICAgICAgY29uc3QgeHJlZlRhZ09mZnNldCA9IHNraXBVbnRpbChjb250ZW50LCAwLCB4cmVmQnl0ZXMpOwoKICAgICAgICBpZiAoeHJlZlRhZ09mZnNldCA8IGNvbnRlbnRMZW5ndGggJiYgY29udGVudFt4cmVmVGFnT2Zmc2V0ICsgNV0gPCA2NCkgewogICAgICAgICAgeHJlZlN0bXMucHVzaChwb3NpdGlvbiAtIHN0cmVhbS5zdGFydCk7CiAgICAgICAgICB0aGlzLnhyZWZzdG1zW3Bvc2l0aW9uIC0gc3RyZWFtLnN0YXJ0XSA9IDE7CiAgICAgICAgfQoKICAgICAgICBwb3NpdGlvbiArPSBjb250ZW50TGVuZ3RoOwogICAgICB9IGVsc2UgaWYgKHRva2VuLnN0YXJ0c1dpdGgoInRyYWlsZXIiKSAmJiAodG9rZW4ubGVuZ3RoID09PSA3IHx8IC9ccy8udGVzdCh0b2tlbls3XSkpKSB7CiAgICAgICAgdHJhaWxlcnMucHVzaChwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gc2tpcFVudGlsKGJ1ZmZlciwgcG9zaXRpb24sIHN0YXJ0eHJlZkJ5dGVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3NpdGlvbiArPSB0b2tlbi5sZW5ndGggKyAxOwogICAgICB9CiAgICB9CgogICAgZm9yIChsZXQgaSA9IDAsIGlpID0geHJlZlN0bXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlLnB1c2goeHJlZlN0bXNbaV0pOwogICAgICB0aGlzLnJlYWRYUmVmKHRydWUpOwogICAgfQoKICAgIGxldCB0cmFpbGVyRGljdDsKCiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0cmFpbGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIHN0cmVhbS5wb3MgPSB0cmFpbGVyc1tpXTsKICAgICAgY29uc3QgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtKSwKICAgICAgICB4cmVmOiB0aGlzLAogICAgICAgIGFsbG93U3RyZWFtczogdHJ1ZSwKICAgICAgICByZWNvdmVyeU1vZGU6IHRydWUKICAgICAgfSk7CiAgICAgIGNvbnN0IG9iaiA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJ0cmFpbGVyIikpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29uc3QgZGljdCA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJvb3REaWN0ID0gZGljdC5nZXQoIlJvb3QiKTsKCiAgICAgICAgaWYgKCEocm9vdERpY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBwYWdlc0RpY3QgPSByb290RGljdC5nZXQoIlBhZ2VzIik7CgogICAgICAgIGlmICghKHBhZ2VzRGljdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHBhZ2VzQ291bnQgPSBwYWdlc0RpY3QuZ2V0KCJDb3VudCIpOwoKICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIocGFnZXNDb3VudCkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKGRpY3QuaGFzKCJJRCIpKSB7CiAgICAgICAgcmV0dXJuIGRpY3Q7CiAgICAgIH0KCiAgICAgIHRyYWlsZXJEaWN0ID0gZGljdDsKICAgIH0KCiAgICBpZiAodHJhaWxlckRpY3QpIHsKICAgICAgcmV0dXJuIHRyYWlsZXJEaWN0OwogICAgfQoKICAgIGlmICh0aGlzLnRvcERpY3QpIHsKICAgICAgcmV0dXJuIHRoaXMudG9wRGljdDsKICAgIH0KCiAgICB0aHJvdyBuZXcgX3V0aWwuSW52YWxpZFBERkV4Y2VwdGlvbigiSW52YWxpZCBQREYgc3RydWN0dXJlLiIpOwogIH0KCiAgcmVhZFhSZWYocmVjb3ZlcnlNb2RlID0gZmFsc2UpIHsKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgY29uc3Qgc3RhcnRYUmVmUGFyc2VkQ2FjaGUgPSBuZXcgU2V0KCk7CgogICAgdHJ5IHsKICAgICAgd2hpbGUgKHRoaXMuc3RhcnRYUmVmUXVldWUubGVuZ3RoKSB7CiAgICAgICAgY29uc3Qgc3RhcnRYUmVmID0gdGhpcy5zdGFydFhSZWZRdWV1ZVswXTsKCiAgICAgICAgaWYgKHN0YXJ0WFJlZlBhcnNlZENhY2hlLmhhcyhzdGFydFhSZWYpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInJlYWRYUmVmIC0gc2tpcHBpbmcgWFJlZiB0YWJsZSBzaW5jZSBpdCB3YXMgYWxyZWFkeSBwYXJzZWQuIik7CiAgICAgICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlLnNoaWZ0KCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHN0YXJ0WFJlZlBhcnNlZENhY2hlLmFkZChzdGFydFhSZWYpOwogICAgICAgIHN0cmVhbS5wb3MgPSBzdGFydFhSZWYgKyBzdHJlYW0uc3RhcnQ7CiAgICAgICAgY29uc3QgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICAgIGxleGVyOiBuZXcgX3BhcnNlci5MZXhlcihzdHJlYW0pLAogICAgICAgICAgeHJlZjogdGhpcywKICAgICAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGxldCBvYmogPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICAgICAgbGV0IGRpY3Q7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgInhyZWYiKSkgewogICAgICAgICAgZGljdCA9IHRoaXMucHJvY2Vzc1hSZWZUYWJsZShwYXJzZXIpOwoKICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgIHRoaXMudG9wRGljdCA9IGRpY3Q7CiAgICAgICAgICB9CgogICAgICAgICAgb2JqID0gZGljdC5nZXQoIlhSZWZTdG0iKTsKCiAgICAgICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgICAgICAgIGNvbnN0IHBvcyA9IG9iajsKCiAgICAgICAgICAgIGlmICghKHBvcyBpbiB0aGlzLnhyZWZzdG1zKSkgewogICAgICAgICAgICAgIHRoaXMueHJlZnN0bXNbcG9zXSA9IDE7CiAgICAgICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKHBvcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKHBhcnNlci5nZXRPYmooKSkgfHwgISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkocGFyc2VyLmdldE9iaigpLCAib2JqIikgfHwgISgob2JqID0gcGFyc2VyLmdldE9iaigpKSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBzdHJlYW0iKTsKICAgICAgICAgIH0KCiAgICAgICAgICBkaWN0ID0gdGhpcy5wcm9jZXNzWFJlZlN0cmVhbShvYmopOwoKICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgIHRoaXMudG9wRGljdCA9IGRpY3Q7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFkaWN0KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRmFpbGVkIHRvIHJlYWQgWFJlZiBzdHJlYW0iKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgc3RyZWFtIGhlYWRlciIpOwogICAgICAgIH0KCiAgICAgICAgb2JqID0gZGljdC5nZXQoIlByZXYiKTsKCiAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKG9iaik7CiAgICAgICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUucHVzaChvYmoubnVtKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUuc2hpZnQoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMudG9wRGljdDsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGU7CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKSgiKHdoaWxlIHJlYWRpbmcgWFJlZik6ICIgKyBlKTsKICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5zaGlmdCgpOwogICAgfQoKICAgIGlmIChyZWNvdmVyeU1vZGUpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZlBhcnNlRXhjZXB0aW9uKCk7CiAgfQoKICBnZXRFbnRyeShpKSB7CiAgICBjb25zdCB4cmVmRW50cnkgPSB0aGlzLmVudHJpZXNbaV07CgogICAgaWYgKHhyZWZFbnRyeSAmJiAheHJlZkVudHJ5LmZyZWUgJiYgeHJlZkVudHJ5Lm9mZnNldCkgewogICAgICByZXR1cm4geHJlZkVudHJ5OwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZmV0Y2hJZlJlZihvYmosIHN1cHByZXNzRW5jcnlwdGlvbiA9IGZhbHNlKSB7CiAgICBpZiAob2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgIHJldHVybiB0aGlzLmZldGNoKG9iaiwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgZmV0Y2gocmVmLCBzdXBwcmVzc0VuY3J5cHRpb24gPSBmYWxzZSkgewogICAgaWYgKCEocmVmIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoInJlZiBvYmplY3QgaXMgbm90IGEgcmVmZXJlbmNlIik7CiAgICB9CgogICAgY29uc3QgbnVtID0gcmVmLm51bTsKCiAgICBjb25zdCBjYWNoZUVudHJ5ID0gdGhpcy5fY2FjaGVNYXAuZ2V0KG51bSk7CgogICAgaWYgKGNhY2hlRW50cnkgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoY2FjaGVFbnRyeSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QgJiYgIWNhY2hlRW50cnkub2JqSWQpIHsKICAgICAgICBjYWNoZUVudHJ5Lm9iaklkID0gcmVmLnRvU3RyaW5nKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjYWNoZUVudHJ5OwogICAgfQoKICAgIGxldCB4cmVmRW50cnkgPSB0aGlzLmdldEVudHJ5KG51bSk7CgogICAgaWYgKHhyZWZFbnRyeSA9PT0gbnVsbCkgewogICAgICB0aGlzLl9jYWNoZU1hcC5zZXQobnVtLCB4cmVmRW50cnkpOwoKICAgICAgcmV0dXJuIHhyZWZFbnRyeTsKICAgIH0KCiAgICBpZiAodGhpcy5fcGVuZGluZ1JlZnMuaGFzKHJlZikpIHsKICAgICAgdGhpcy5fcGVuZGluZ1JlZnMucmVtb3ZlKHJlZik7CgogICAgICAoMCwgX3V0aWwud2FybikoYElnbm9yaW5nIGNpcmN1bGFyIHJlZmVyZW5jZTogJHtyZWZ9LmApOwogICAgICByZXR1cm4gX3ByaW1pdGl2ZXMuQ0lSQ1VMQVJfUkVGOwogICAgfQoKICAgIHRoaXMuX3BlbmRpbmdSZWZzLnB1dChyZWYpOwoKICAgIHRyeSB7CiAgICAgIGlmICh4cmVmRW50cnkudW5jb21wcmVzc2VkKSB7CiAgICAgICAgeHJlZkVudHJ5ID0gdGhpcy5mZXRjaFVuY29tcHJlc3NlZChyZWYsIHhyZWZFbnRyeSwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB4cmVmRW50cnkgPSB0aGlzLmZldGNoQ29tcHJlc3NlZChyZWYsIHhyZWZFbnRyeSwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy5fcGVuZGluZ1JlZnMucmVtb3ZlKHJlZik7CiAgICB9IGNhdGNoIChleCkgewogICAgICB0aGlzLl9wZW5kaW5nUmVmcy5yZW1vdmUocmVmKTsKCiAgICAgIHRocm93IGV4OwogICAgfQoKICAgIGlmICh4cmVmRW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgIHhyZWZFbnRyeS5vYmpJZCA9IHJlZi50b1N0cmluZygpOwogICAgfSBlbHNlIGlmICh4cmVmRW50cnkgaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICB4cmVmRW50cnkuZGljdC5vYmpJZCA9IHJlZi50b1N0cmluZygpOwogICAgfQoKICAgIHJldHVybiB4cmVmRW50cnk7CiAgfQoKICBmZXRjaFVuY29tcHJlc3NlZChyZWYsIHhyZWZFbnRyeSwgc3VwcHJlc3NFbmNyeXB0aW9uID0gZmFsc2UpIHsKICAgIGNvbnN0IGdlbiA9IHJlZi5nZW47CiAgICBsZXQgbnVtID0gcmVmLm51bTsKCiAgICBpZiAoeHJlZkVudHJ5LmdlbiAhPT0gZ2VuKSB7CiAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24oYEluY29uc2lzdGVudCBnZW5lcmF0aW9uIGluIFhSZWY6ICR7cmVmfWApOwogICAgfQoKICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMuc3RyZWFtLm1ha2VTdWJTdHJlYW0oeHJlZkVudHJ5Lm9mZnNldCArIHRoaXMuc3RyZWFtLnN0YXJ0KTsKICAgIGNvbnN0IHBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgIGxleGVyOiBuZXcgX3BhcnNlci5MZXhlcihzdHJlYW0pLAogICAgICB4cmVmOiB0aGlzLAogICAgICBhbGxvd1N0cmVhbXM6IHRydWUKICAgIH0pOwogICAgY29uc3Qgb2JqMSA9IHBhcnNlci5nZXRPYmooKTsKICAgIGNvbnN0IG9iajIgPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICBjb25zdCBvYmozID0gcGFyc2VyLmdldE9iaigpOwoKICAgIGlmIChvYmoxICE9PSBudW0gfHwgb2JqMiAhPT0gZ2VuIHx8ICEob2JqMyBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCkpIHsKICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbihgQmFkICh1bmNvbXByZXNzZWQpIFhSZWYgZW50cnk6ICR7cmVmfWApOwogICAgfQoKICAgIGlmIChvYmozLmNtZCAhPT0gIm9iaiIpIHsKICAgICAgaWYgKG9iajMuY21kLnN0YXJ0c1dpdGgoIm9iaiIpKSB7CiAgICAgICAgbnVtID0gcGFyc2VJbnQob2JqMy5jbWQuc3Vic3RyaW5nKDMpLCAxMCk7CgogICAgICAgIGlmICghTnVtYmVyLmlzTmFOKG51bSkpIHsKICAgICAgICAgIHJldHVybiBudW07CiAgICAgICAgfQogICAgICB9CgogICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uKGBCYWQgKHVuY29tcHJlc3NlZCkgWFJlZiBlbnRyeTogJHtyZWZ9YCk7CiAgICB9CgogICAgaWYgKHRoaXMuZW5jcnlwdCAmJiAhc3VwcHJlc3NFbmNyeXB0aW9uKSB7CiAgICAgIHhyZWZFbnRyeSA9IHBhcnNlci5nZXRPYmoodGhpcy5lbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShudW0sIGdlbikpOwogICAgfSBlbHNlIHsKICAgICAgeHJlZkVudHJ5ID0gcGFyc2VyLmdldE9iaigpOwogICAgfQoKICAgIGlmICghKHhyZWZFbnRyeSBpbnN0YW5jZW9mIF9iYXNlX3N0cmVhbS5CYXNlU3RyZWFtKSkgewogICAgICB0aGlzLl9jYWNoZU1hcC5zZXQobnVtLCB4cmVmRW50cnkpOwogICAgfQoKICAgIHJldHVybiB4cmVmRW50cnk7CiAgfQoKICBmZXRjaENvbXByZXNzZWQocmVmLCB4cmVmRW50cnksIHN1cHByZXNzRW5jcnlwdGlvbiA9IGZhbHNlKSB7CiAgICBjb25zdCB0YWJsZU9mZnNldCA9IHhyZWZFbnRyeS5vZmZzZXQ7CiAgICBjb25zdCBzdHJlYW0gPSB0aGlzLmZldGNoKF9wcmltaXRpdmVzLlJlZi5nZXQodGFibGVPZmZzZXQsIDApKTsKCiAgICBpZiAoIShzdHJlYW0gaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJiYWQgT2JqU3RtIHN0cmVhbSIpOwogICAgfQoKICAgIGNvbnN0IGZpcnN0ID0gc3RyZWFtLmRpY3QuZ2V0KCJGaXJzdCIpOwogICAgY29uc3QgbiA9IHN0cmVhbS5kaWN0LmdldCgiTiIpOwoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihmaXJzdCkgfHwgIU51bWJlci5pc0ludGVnZXIobikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGZpcnN0IGFuZCBuIHBhcmFtZXRlcnMgZm9yIE9ialN0bSBzdHJlYW0iKTsKICAgIH0KCiAgICBsZXQgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSksCiAgICAgIHhyZWY6IHRoaXMsCiAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgfSk7CiAgICBjb25zdCBudW1zID0gbmV3IEFycmF5KG4pOwogICAgY29uc3Qgb2Zmc2V0cyA9IG5ldyBBcnJheShuKTsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICBjb25zdCBudW0gPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIobnVtKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcihgaW52YWxpZCBvYmplY3QgbnVtYmVyIGluIHRoZSBPYmpTdG0gc3RyZWFtOiAke251bX1gKTsKICAgICAgfQoKICAgICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG9mZnNldCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoYGludmFsaWQgb2JqZWN0IG9mZnNldCBpbiB0aGUgT2JqU3RtIHN0cmVhbTogJHtvZmZzZXR9YCk7CiAgICAgIH0KCiAgICAgIG51bXNbaV0gPSBudW07CiAgICAgIG9mZnNldHNbaV0gPSBvZmZzZXQ7CiAgICB9CgogICAgY29uc3Qgc3RhcnQgPSAoc3RyZWFtLnN0YXJ0IHx8IDApICsgZmlyc3Q7CiAgICBjb25zdCBlbnRyaWVzID0gbmV3IEFycmF5KG4pOwoKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGkgPCBuIC0gMSA/IG9mZnNldHNbaSArIDFdIC0gb2Zmc2V0c1tpXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmIChsZW5ndGggPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIG9mZnNldCBpbiB0aGUgT2JqU3RtIHN0cmVhbS4iKTsKICAgICAgfQoKICAgICAgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtLm1ha2VTdWJTdHJlYW0oc3RhcnQgKyBvZmZzZXRzW2ldLCBsZW5ndGgsIHN0cmVhbS5kaWN0KSksCiAgICAgICAgeHJlZjogdGhpcywKICAgICAgICBhbGxvd1N0cmVhbXM6IHRydWUKICAgICAgfSk7CiAgICAgIGNvbnN0IG9iaiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgZW50cmllc1tpXSA9IG9iajsKCiAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfYmFzZV9zdHJlYW0uQmFzZVN0cmVhbSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBudW0gPSBudW1zW2ldLAogICAgICAgICAgICBlbnRyeSA9IHRoaXMuZW50cmllc1tudW1dOwoKICAgICAgaWYgKGVudHJ5ICYmIGVudHJ5Lm9mZnNldCA9PT0gdGFibGVPZmZzZXQgJiYgZW50cnkuZ2VuID09PSBpKSB7CiAgICAgICAgdGhpcy5fY2FjaGVNYXAuc2V0KG51bSwgb2JqKTsKICAgICAgfQogICAgfQoKICAgIHhyZWZFbnRyeSA9IGVudHJpZXNbeHJlZkVudHJ5Lmdlbl07CgogICAgaWYgKHhyZWZFbnRyeSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24oYEJhZCAoY29tcHJlc3NlZCkgWFJlZiBlbnRyeTogJHtyZWZ9YCk7CiAgICB9CgogICAgcmV0dXJuIHhyZWZFbnRyeTsKICB9CgogIGFzeW5jIGZldGNoSWZSZWZBc3luYyhvYmosIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICByZXR1cm4gdGhpcy5mZXRjaEFzeW5jKG9iaiwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgYXN5bmMgZmV0Y2hBc3luYyhyZWYsIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocmVmLCBzdXBwcmVzc0VuY3J5cHRpb24pOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKCEoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikpIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQoKICAgICAgYXdhaXQgdGhpcy5wZGZNYW5hZ2VyLnJlcXVlc3RSYW5nZShleC5iZWdpbiwgZXguZW5kKTsKICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hBc3luYyhyZWYsIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICB9CiAgfQoKICBnZXRDYXRhbG9nT2JqKCkgewogICAgcmV0dXJuIHRoaXMucm9vdDsKICB9Cgp9CgpleHBvcnRzLlhSZWYgPSBYUmVmOwoKLyoqKi8gfSksCi8qIDEwMiAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLk1lc3NhZ2VIYW5kbGVyID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXygyKTsKCmNvbnN0IENhbGxiYWNrS2luZCA9IHsKICBVTktOT1dOOiAwLAogIERBVEE6IDEsCiAgRVJST1I6IDIKfTsKY29uc3QgU3RyZWFtS2luZCA9IHsKICBVTktOT1dOOiAwLAogIENBTkNFTDogMSwKICBDQU5DRUxfQ09NUExFVEU6IDIsCiAgQ0xPU0U6IDMsCiAgRU5RVUVVRTogNCwKICBFUlJPUjogNSwKICBQVUxMOiA2LAogIFBVTExfQ09NUExFVEU6IDcsCiAgU1RBUlRfQ09NUExFVEU6IDgKfTsKCmZ1bmN0aW9uIHdyYXBSZWFzb24ocmVhc29uKSB7CiAgaWYgKCEocmVhc29uIGluc3RhbmNlb2YgRXJyb3IgfHwgdHlwZW9mIHJlYXNvbiA9PT0gIm9iamVjdCIgJiYgcmVhc29uICE9PSBudWxsKSkgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgnd3JhcFJlYXNvbjogRXhwZWN0ZWQgInJlYXNvbiIgdG8gYmUgYSAocG9zc2libHkgY2xvbmVkKSBFcnJvci4nKTsKICB9CgogIHN3aXRjaCAocmVhc29uLm5hbWUpIHsKICAgIGNhc2UgIkFib3J0RXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5BYm9ydEV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSk7CgogICAgY2FzZSAiTWlzc2luZ1BERkV4Y2VwdGlvbiI6CiAgICAgIHJldHVybiBuZXcgX3V0aWwuTWlzc2luZ1BERkV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSk7CgogICAgY2FzZSAiUGFzc3dvcmRFeGNlcHRpb24iOgogICAgICByZXR1cm4gbmV3IF91dGlsLlBhc3N3b3JkRXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlLCByZWFzb24uY29kZSk7CgogICAgY2FzZSAiVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5VbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24ocmVhc29uLm1lc3NhZ2UsIHJlYXNvbi5zdGF0dXMpOwoKICAgIGNhc2UgIlVua25vd25FcnJvckV4Y2VwdGlvbiI6CiAgICAgIHJldHVybiBuZXcgX3V0aWwuVW5rbm93bkVycm9yRXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlLCByZWFzb24uZGV0YWlscyk7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5Vbmtub3duRXJyb3JFeGNlcHRpb24ocmVhc29uLm1lc3NhZ2UsIHJlYXNvbi50b1N0cmluZygpKTsKICB9Cn0KCmNsYXNzIE1lc3NhZ2VIYW5kbGVyIHsKICBjb25zdHJ1Y3Rvcihzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBjb21PYmopIHsKICAgIHRoaXMuc291cmNlTmFtZSA9IHNvdXJjZU5hbWU7CiAgICB0aGlzLnRhcmdldE5hbWUgPSB0YXJnZXROYW1lOwogICAgdGhpcy5jb21PYmogPSBjb21PYmo7CiAgICB0aGlzLmNhbGxiYWNrSWQgPSAxOwogICAgdGhpcy5zdHJlYW1JZCA9IDE7CiAgICB0aGlzLnN0cmVhbVNpbmtzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5jYWxsYmFja0NhcGFiaWxpdGllcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLmFjdGlvbkhhbmRsZXIgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIHRoaXMuX29uQ29tT2JqT25NZXNzYWdlID0gZXZlbnQgPT4gewogICAgICBjb25zdCBkYXRhID0gZXZlbnQuZGF0YTsKCiAgICAgIGlmIChkYXRhLnRhcmdldE5hbWUgIT09IHRoaXMuc291cmNlTmFtZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEuc3RyZWFtKSB7CiAgICAgICAgdGhpcy5fcHJvY2Vzc1N0cmVhbU1lc3NhZ2UoZGF0YSk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEuY2FsbGJhY2spIHsKICAgICAgICBjb25zdCBjYWxsYmFja0lkID0gZGF0YS5jYWxsYmFja0lkOwogICAgICAgIGNvbnN0IGNhcGFiaWxpdHkgPSB0aGlzLmNhbGxiYWNrQ2FwYWJpbGl0aWVzW2NhbGxiYWNrSWRdOwoKICAgICAgICBpZiAoIWNhcGFiaWxpdHkpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHJlc29sdmUgY2FsbGJhY2sgJHtjYWxsYmFja0lkfWApOwogICAgICAgIH0KCiAgICAgICAgZGVsZXRlIHRoaXMuY2FsbGJhY2tDYXBhYmlsaXRpZXNbY2FsbGJhY2tJZF07CgogICAgICAgIGlmIChkYXRhLmNhbGxiYWNrID09PSBDYWxsYmFja0tpbmQuREFUQSkgewogICAgICAgICAgY2FwYWJpbGl0eS5yZXNvbHZlKGRhdGEuZGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNhbGxiYWNrID09PSBDYWxsYmFja0tpbmQuRVJST1IpIHsKICAgICAgICAgIGNhcGFiaWxpdHkucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGNhbGxiYWNrIGNhc2UiKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5hY3Rpb25IYW5kbGVyW2RhdGEuYWN0aW9uXTsKCiAgICAgIGlmICghYWN0aW9uKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGFjdGlvbiBmcm9tIHdvcmtlcjogJHtkYXRhLmFjdGlvbn1gKTsKICAgICAgfQoKICAgICAgaWYgKGRhdGEuY2FsbGJhY2tJZCkgewogICAgICAgIGNvbnN0IGNiU291cmNlTmFtZSA9IHRoaXMuc291cmNlTmFtZTsKICAgICAgICBjb25zdCBjYlRhcmdldE5hbWUgPSBkYXRhLnNvdXJjZU5hbWU7CiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgIHJlc29sdmUoYWN0aW9uKGRhdGEuZGF0YSkpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZTogY2JTb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lOiBjYlRhcmdldE5hbWUsCiAgICAgICAgICAgIGNhbGxiYWNrOiBDYWxsYmFja0tpbmQuREFUQSwKICAgICAgICAgICAgY2FsbGJhY2tJZDogZGF0YS5jYWxsYmFja0lkLAogICAgICAgICAgICBkYXRhOiByZXN1bHQKICAgICAgICAgIH0pOwogICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWU6IGNiU291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZTogY2JUYXJnZXROYW1lLAogICAgICAgICAgICBjYWxsYmFjazogQ2FsbGJhY2tLaW5kLkVSUk9SLAogICAgICAgICAgICBjYWxsYmFja0lkOiBkYXRhLmNhbGxiYWNrSWQsCiAgICAgICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChkYXRhLnN0cmVhbUlkKSB7CiAgICAgICAgdGhpcy5fY3JlYXRlU3RyZWFtU2luayhkYXRhKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBhY3Rpb24oZGF0YS5kYXRhKTsKICAgIH07CgogICAgY29tT2JqLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0aGlzLl9vbkNvbU9iak9uTWVzc2FnZSk7CiAgfQoKICBvbihhY3Rpb25OYW1lLCBoYW5kbGVyKSB7CiAgICBjb25zdCBhaCA9IHRoaXMuYWN0aW9uSGFuZGxlcjsKCiAgICBpZiAoYWhbYWN0aW9uTmFtZV0pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGVyZSBpcyBhbHJlYWR5IGFuIGFjdGlvbk5hbWUgY2FsbGVkICIke2FjdGlvbk5hbWV9ImApOwogICAgfQoKICAgIGFoW2FjdGlvbk5hbWVdID0gaGFuZGxlcjsKICB9CgogIHNlbmQoYWN0aW9uTmFtZSwgZGF0YSwgdHJhbnNmZXJzKSB7CiAgICB0aGlzLmNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgIHNvdXJjZU5hbWU6IHRoaXMuc291cmNlTmFtZSwKICAgICAgdGFyZ2V0TmFtZTogdGhpcy50YXJnZXROYW1lLAogICAgICBhY3Rpb246IGFjdGlvbk5hbWUsCiAgICAgIGRhdGEKICAgIH0sIHRyYW5zZmVycyk7CiAgfQoKICBzZW5kV2l0aFByb21pc2UoYWN0aW9uTmFtZSwgZGF0YSwgdHJhbnNmZXJzKSB7CiAgICBjb25zdCBjYWxsYmFja0lkID0gdGhpcy5jYWxsYmFja0lkKys7CiAgICBjb25zdCBjYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgdGhpcy5jYWxsYmFja0NhcGFiaWxpdGllc1tjYWxsYmFja0lkXSA9IGNhcGFiaWxpdHk7CgogICAgdHJ5IHsKICAgICAgdGhpcy5jb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgIHNvdXJjZU5hbWU6IHRoaXMuc291cmNlTmFtZSwKICAgICAgICB0YXJnZXROYW1lOiB0aGlzLnRhcmdldE5hbWUsCiAgICAgICAgYWN0aW9uOiBhY3Rpb25OYW1lLAogICAgICAgIGNhbGxiYWNrSWQsCiAgICAgICAgZGF0YQogICAgICB9LCB0cmFuc2ZlcnMpOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgY2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgfQoKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQoKICBzZW5kV2l0aFN0cmVhbShhY3Rpb25OYW1lLCBkYXRhLCBxdWV1ZWluZ1N0cmF0ZWd5LCB0cmFuc2ZlcnMpIHsKICAgIGNvbnN0IHN0cmVhbUlkID0gdGhpcy5zdHJlYW1JZCsrLAogICAgICAgICAgc291cmNlTmFtZSA9IHRoaXMuc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUgPSB0aGlzLnRhcmdldE5hbWUsCiAgICAgICAgICBjb21PYmogPSB0aGlzLmNvbU9iajsKICAgIHJldHVybiBuZXcgUmVhZGFibGVTdHJlYW0oewogICAgICBzdGFydDogY29udHJvbGxlciA9PiB7CiAgICAgICAgY29uc3Qgc3RhcnRDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdID0gewogICAgICAgICAgY29udHJvbGxlciwKICAgICAgICAgIHN0YXJ0Q2FsbDogc3RhcnRDYXBhYmlsaXR5LAogICAgICAgICAgcHVsbENhbGw6IG51bGwsCiAgICAgICAgICBjYW5jZWxDYWxsOiBudWxsLAogICAgICAgICAgaXNDbG9zZWQ6IGZhbHNlCiAgICAgICAgfTsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICBhY3Rpb246IGFjdGlvbk5hbWUsCiAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBkZXNpcmVkU2l6ZTogY29udHJvbGxlci5kZXNpcmVkU2l6ZQogICAgICAgIH0sIHRyYW5zZmVycyk7CiAgICAgICAgcmV0dXJuIHN0YXJ0Q2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9LAogICAgICBwdWxsOiBjb250cm9sbGVyID0+IHsKICAgICAgICBjb25zdCBwdWxsQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5wdWxsQ2FsbCA9IHB1bGxDYXBhYmlsaXR5OwogICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5QVUxMLAogICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICBkZXNpcmVkU2l6ZTogY29udHJvbGxlci5kZXNpcmVkU2l6ZQogICAgICAgIH0pOwogICAgICAgIHJldHVybiBwdWxsQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9LAogICAgICBjYW5jZWw6IHJlYXNvbiA9PiB7CiAgICAgICAgKDAsIF91dGlsLmFzc2VydCkocmVhc29uIGluc3RhbmNlb2YgRXJyb3IsICJjYW5jZWwgbXVzdCBoYXZlIGEgdmFsaWQgcmVhc29uIik7CiAgICAgICAgY29uc3QgY2FuY2VsQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5jYW5jZWxDYWxsID0gY2FuY2VsQ2FwYWJpbGl0eTsKICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5pc0Nsb3NlZCA9IHRydWU7CiAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkNBTkNFTCwKICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gY2FuY2VsQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9CiAgICB9LCBxdWV1ZWluZ1N0cmF0ZWd5KTsKICB9CgogIF9jcmVhdGVTdHJlYW1TaW5rKGRhdGEpIHsKICAgIGNvbnN0IHN0cmVhbUlkID0gZGF0YS5zdHJlYW1JZCwKICAgICAgICAgIHNvdXJjZU5hbWUgPSB0aGlzLnNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lID0gZGF0YS5zb3VyY2VOYW1lLAogICAgICAgICAgY29tT2JqID0gdGhpcy5jb21PYmo7CiAgICBjb25zdCBzZWxmID0gdGhpcywKICAgICAgICAgIGFjdGlvbiA9IHRoaXMuYWN0aW9uSGFuZGxlcltkYXRhLmFjdGlvbl07CiAgICBjb25zdCBzdHJlYW1TaW5rID0gewogICAgICBlbnF1ZXVlKGNodW5rLCBzaXplID0gMSwgdHJhbnNmZXJzKSB7CiAgICAgICAgaWYgKHRoaXMuaXNDYW5jZWxsZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGxhc3REZXNpcmVkU2l6ZSA9IHRoaXMuZGVzaXJlZFNpemU7CiAgICAgICAgdGhpcy5kZXNpcmVkU2l6ZSAtPSBzaXplOwoKICAgICAgICBpZiAobGFzdERlc2lyZWRTaXplID4gMCAmJiB0aGlzLmRlc2lyZWRTaXplIDw9IDApIHsKICAgICAgICAgIHRoaXMuc2lua0NhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgICAgICAgICB0aGlzLnJlYWR5ID0gdGhpcy5zaW5rQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICAgIH0KCiAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkVOUVVFVUUsCiAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgIGNodW5rCiAgICAgICAgfSwgdHJhbnNmZXJzKTsKICAgICAgfSwKCiAgICAgIGNsb3NlKCkgewogICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsbGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLmlzQ2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0xPU0UsCiAgICAgICAgICBzdHJlYW1JZAogICAgICAgIH0pOwogICAgICAgIGRlbGV0ZSBzZWxmLnN0cmVhbVNpbmtzW3N0cmVhbUlkXTsKICAgICAgfSwKCiAgICAgIGVycm9yKHJlYXNvbikgewogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHJlYXNvbiBpbnN0YW5jZW9mIEVycm9yLCAiZXJyb3IgbXVzdCBoYXZlIGEgdmFsaWQgcmVhc29uIik7CgogICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsbGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLmlzQ2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuRVJST1IsCiAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgICAgfSk7CiAgICAgIH0sCgogICAgICBzaW5rQ2FwYWJpbGl0eTogKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpLAogICAgICBvblB1bGw6IG51bGwsCiAgICAgIG9uQ2FuY2VsOiBudWxsLAogICAgICBpc0NhbmNlbGxlZDogZmFsc2UsCiAgICAgIGRlc2lyZWRTaXplOiBkYXRhLmRlc2lyZWRTaXplLAogICAgICByZWFkeTogbnVsbAogICAgfTsKICAgIHN0cmVhbVNpbmsuc2lua0NhcGFiaWxpdHkucmVzb2x2ZSgpOwogICAgc3RyZWFtU2luay5yZWFkeSA9IHN0cmVhbVNpbmsuc2lua0NhcGFiaWxpdHkucHJvbWlzZTsKICAgIHRoaXMuc3RyZWFtU2lua3Nbc3RyZWFtSWRdID0gc3RyZWFtU2luazsKICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlc29sdmUoYWN0aW9uKGRhdGEuZGF0YSwgc3RyZWFtU2luaykpOwogICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgc291cmNlTmFtZSwKICAgICAgICB0YXJnZXROYW1lLAogICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5TVEFSVF9DT01QTEVURSwKICAgICAgICBzdHJlYW1JZCwKICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgIH0pOwogICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuU1RBUlRfQ09NUExFVEUsCiAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgfSk7CiAgICB9KTsKICB9CgogIF9wcm9jZXNzU3RyZWFtTWVzc2FnZShkYXRhKSB7CiAgICBjb25zdCBzdHJlYW1JZCA9IGRhdGEuc3RyZWFtSWQsCiAgICAgICAgICBzb3VyY2VOYW1lID0gdGhpcy5zb3VyY2VOYW1lLAogICAgICAgICAgdGFyZ2V0TmFtZSA9IGRhdGEuc291cmNlTmFtZSwKICAgICAgICAgIGNvbU9iaiA9IHRoaXMuY29tT2JqOwogICAgY29uc3Qgc3RyZWFtQ29udHJvbGxlciA9IHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLAogICAgICAgICAgc3RyZWFtU2luayA9IHRoaXMuc3RyZWFtU2lua3Nbc3RyZWFtSWRdOwoKICAgIHN3aXRjaCAoZGF0YS5zdHJlYW0pIHsKICAgICAgY2FzZSBTdHJlYW1LaW5kLlNUQVJUX0NPTVBMRVRFOgogICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuc3RhcnRDYWxsLnJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RyZWFtQ29udHJvbGxlci5zdGFydENhbGwucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTdHJlYW1LaW5kLlBVTExfQ09NUExFVEU6CiAgICAgICAgaWYgKGRhdGEuc3VjY2VzcykgewogICAgICAgICAgc3RyZWFtQ29udHJvbGxlci5wdWxsQ2FsbC5yZXNvbHZlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0cmVhbUNvbnRyb2xsZXIucHVsbENhbGwucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTdHJlYW1LaW5kLlBVTEw6CiAgICAgICAgaWYgKCFzdHJlYW1TaW5rKSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuUFVMTF9DT01QTEVURSwKICAgICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RyZWFtU2luay5kZXNpcmVkU2l6ZSA8PSAwICYmIGRhdGEuZGVzaXJlZFNpemUgPiAwKSB7CiAgICAgICAgICBzdHJlYW1TaW5rLnNpbmtDYXBhYmlsaXR5LnJlc29sdmUoKTsKICAgICAgICB9CgogICAgICAgIHN0cmVhbVNpbmsuZGVzaXJlZFNpemUgPSBkYXRhLmRlc2lyZWRTaXplOwogICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICByZXNvbHZlKHN0cmVhbVNpbmsub25QdWxsICYmIHN0cmVhbVNpbmsub25QdWxsKCkpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLlBVTExfQ09NUExFVEUsCiAgICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuUFVMTF9DT01QTEVURSwKICAgICAgICAgICAgc3RyZWFtSWQsCiAgICAgICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5FTlFVRVVFOgogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHN0cmVhbUNvbnRyb2xsZXIsICJlbnF1ZXVlIHNob3VsZCBoYXZlIHN0cmVhbSBjb250cm9sbGVyIik7CgogICAgICAgIGlmIChzdHJlYW1Db250cm9sbGVyLmlzQ2xvc2VkKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuY29udHJvbGxlci5lbnF1ZXVlKGRhdGEuY2h1bmspOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTdHJlYW1LaW5kLkNMT1NFOgogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHN0cmVhbUNvbnRyb2xsZXIsICJjbG9zZSBzaG91bGQgaGF2ZSBzdHJlYW0gY29udHJvbGxlciIpOwoKICAgICAgICBpZiAoc3RyZWFtQ29udHJvbGxlci5pc0Nsb3NlZCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBzdHJlYW1Db250cm9sbGVyLmlzQ2xvc2VkID0gdHJ1ZTsKICAgICAgICBzdHJlYW1Db250cm9sbGVyLmNvbnRyb2xsZXIuY2xvc2UoKTsKCiAgICAgICAgdGhpcy5fZGVsZXRlU3RyZWFtQ29udHJvbGxlcihzdHJlYW1Db250cm9sbGVyLCBzdHJlYW1JZCk7CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBTdHJlYW1LaW5kLkVSUk9SOgogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHN0cmVhbUNvbnRyb2xsZXIsICJlcnJvciBzaG91bGQgaGF2ZSBzdHJlYW0gY29udHJvbGxlciIpOwogICAgICAgIHN0cmVhbUNvbnRyb2xsZXIuY29udHJvbGxlci5lcnJvcih3cmFwUmVhc29uKGRhdGEucmVhc29uKSk7CgogICAgICAgIHRoaXMuX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtQ29udHJvbGxlciwgc3RyZWFtSWQpOwoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3RyZWFtS2luZC5DQU5DRUxfQ09NUExFVEU6CiAgICAgICAgaWYgKGRhdGEuc3VjY2VzcykgewogICAgICAgICAgc3RyZWFtQ29udHJvbGxlci5jYW5jZWxDYWxsLnJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RyZWFtQ29udHJvbGxlci5jYW5jZWxDYWxsLnJlamVjdCh3cmFwUmVhc29uKGRhdGEucmVhc29uKSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9kZWxldGVTdHJlYW1Db250cm9sbGVyKHN0cmVhbUNvbnRyb2xsZXIsIHN0cmVhbUlkKTsKCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFN0cmVhbUtpbmQuQ0FOQ0VMOgogICAgICAgIGlmICghc3RyZWFtU2luaykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgcmVzb2x2ZShzdHJlYW1TaW5rLm9uQ2FuY2VsICYmIHN0cmVhbVNpbmsub25DYW5jZWwod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpKTsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWUsCiAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5DQU5DRUxfQ09NUExFVEUsCiAgICAgICAgICAgIHN0cmVhbUlkLAogICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lLAogICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFLAogICAgICAgICAgICBzdHJlYW1JZCwKICAgICAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHN0cmVhbVNpbmsuc2lua0NhcGFiaWxpdHkucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICBzdHJlYW1TaW5rLmlzQ2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICBkZWxldGUgdGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF07CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBzdHJlYW0gY2FzZSIpOwogICAgfQogIH0KCiAgYXN5bmMgX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtQ29udHJvbGxlciwgc3RyZWFtSWQpIHsKICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChbc3RyZWFtQ29udHJvbGxlci5zdGFydENhbGwgJiYgc3RyZWFtQ29udHJvbGxlci5zdGFydENhbGwucHJvbWlzZSwgc3RyZWFtQ29udHJvbGxlci5wdWxsQ2FsbCAmJiBzdHJlYW1Db250cm9sbGVyLnB1bGxDYWxsLnByb21pc2UsIHN0cmVhbUNvbnRyb2xsZXIuY2FuY2VsQ2FsbCAmJiBzdHJlYW1Db250cm9sbGVyLmNhbmNlbENhbGwucHJvbWlzZV0pOwogICAgZGVsZXRlIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdOwogIH0KCiAgZGVzdHJveSgpIHsKICAgIHRoaXMuY29tT2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0aGlzLl9vbkNvbU9iak9uTWVzc2FnZSk7CiAgfQoKfQoKZXhwb3J0cy5NZXNzYWdlSGFuZGxlciA9IE1lc3NhZ2VIYW5kbGVyOwoKLyoqKi8gfSksCi8qIDEwMyAqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSA9PiB7CgoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsICh7CiAgdmFsdWU6IHRydWUKfSkpOwpleHBvcnRzLlBERldvcmtlclN0cmVhbSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMik7CgpjbGFzcyBQREZXb3JrZXJTdHJlYW0gewogIGNvbnN0cnVjdG9yKG1zZ0hhbmRsZXIpIHsKICAgIHRoaXMuX21zZ0hhbmRsZXIgPSBtc2dIYW5kbGVyOwogICAgdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7CiAgICB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciA9IG51bGw7CiAgICB0aGlzLl9yYW5nZVJlcXVlc3RSZWFkZXJzID0gW107CiAgfQoKICBnZXRGdWxsUmVhZGVyKCkgewogICAgKDAsIF91dGlsLmFzc2VydCkoIXRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyLCAiUERGV29ya2VyU3RyZWFtLmdldEZ1bGxSZWFkZXIgY2FuIG9ubHkgYmUgY2FsbGVkIG9uY2UuIik7CiAgICB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciA9IG5ldyBQREZXb3JrZXJTdHJlYW1SZWFkZXIodGhpcy5fbXNnSGFuZGxlcik7CiAgICByZXR1cm4gdGhpcy5fZnVsbFJlcXVlc3RSZWFkZXI7CiAgfQoKICBnZXRSYW5nZVJlYWRlcihiZWdpbiwgZW5kKSB7CiAgICBjb25zdCByZWFkZXIgPSBuZXcgUERGV29ya2VyU3RyZWFtUmFuZ2VSZWFkZXIoYmVnaW4sIGVuZCwgdGhpcy5fbXNnSGFuZGxlcik7CgogICAgdGhpcy5fcmFuZ2VSZXF1ZXN0UmVhZGVycy5wdXNoKHJlYWRlcik7CgogICAgcmV0dXJuIHJlYWRlcjsKICB9CgogIGNhbmNlbEFsbFJlcXVlc3RzKHJlYXNvbikgewogICAgaWYgKHRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyKSB7CiAgICAgIHRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyLmNhbmNlbChyZWFzb24pOwogICAgfQoKICAgIGZvciAoY29uc3QgcmVhZGVyIG9mIHRoaXMuX3JhbmdlUmVxdWVzdFJlYWRlcnMuc2xpY2UoMCkpIHsKICAgICAgcmVhZGVyLmNhbmNlbChyZWFzb24pOwogICAgfQogIH0KCn0KCmV4cG9ydHMuUERGV29ya2VyU3RyZWFtID0gUERGV29ya2VyU3RyZWFtOwoKY2xhc3MgUERGV29ya2VyU3RyZWFtUmVhZGVyIHsKICBjb25zdHJ1Y3Rvcihtc2dIYW5kbGVyKSB7CiAgICB0aGlzLl9tc2dIYW5kbGVyID0gbXNnSGFuZGxlcjsKICAgIHRoaXMub25Qcm9ncmVzcyA9IG51bGw7CiAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDsKICAgIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQgPSBmYWxzZTsKICAgIHRoaXMuX2lzU3RyZWFtaW5nU3VwcG9ydGVkID0gZmFsc2U7CgogICAgY29uc3QgcmVhZGFibGVTdHJlYW0gPSB0aGlzLl9tc2dIYW5kbGVyLnNlbmRXaXRoU3RyZWFtKCJHZXRSZWFkZXIiKTsKCiAgICB0aGlzLl9yZWFkZXIgPSByZWFkYWJsZVN0cmVhbS5nZXRSZWFkZXIoKTsKICAgIHRoaXMuX2hlYWRlcnNSZWFkeSA9IHRoaXMuX21zZ0hhbmRsZXIuc2VuZFdpdGhQcm9taXNlKCJSZWFkZXJIZWFkZXJzUmVhZHkiKS50aGVuKGRhdGEgPT4gewogICAgICB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZCA9IGRhdGEuaXNTdHJlYW1pbmdTdXBwb3J0ZWQ7CiAgICAgIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQgPSBkYXRhLmlzUmFuZ2VTdXBwb3J0ZWQ7CiAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSBkYXRhLmNvbnRlbnRMZW5ndGg7CiAgICB9KTsKICB9CgogIGdldCBoZWFkZXJzUmVhZHkoKSB7CiAgICByZXR1cm4gdGhpcy5faGVhZGVyc1JlYWR5OwogIH0KCiAgZ2V0IGNvbnRlbnRMZW5ndGgoKSB7CiAgICByZXR1cm4gdGhpcy5fY29udGVudExlbmd0aDsKICB9CgogIGdldCBpc1N0cmVhbWluZ1N1cHBvcnRlZCgpIHsKICAgIHJldHVybiB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZDsKICB9CgogIGdldCBpc1JhbmdlU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIHRoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQ7CiAgfQoKICBhc3luYyByZWFkKCkgewogICAgY29uc3QgewogICAgICB2YWx1ZSwKICAgICAgZG9uZQogICAgfSA9IGF3YWl0IHRoaXMuX3JlYWRlci5yZWFkKCk7CgogICAgaWYgKGRvbmUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB2YWx1ZTogdW5kZWZpbmVkLAogICAgICAgIGRvbmU6IHRydWUKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICB2YWx1ZTogdmFsdWUuYnVmZmVyLAogICAgICBkb25lOiBmYWxzZQogICAgfTsKICB9CgogIGNhbmNlbChyZWFzb24pIHsKICAgIHRoaXMuX3JlYWRlci5jYW5jZWwocmVhc29uKTsKICB9Cgp9CgpjbGFzcyBQREZXb3JrZXJTdHJlYW1SYW5nZVJlYWRlciB7CiAgY29uc3RydWN0b3IoYmVnaW4sIGVuZCwgbXNnSGFuZGxlcikgewogICAgdGhpcy5fbXNnSGFuZGxlciA9IG1zZ0hhbmRsZXI7CiAgICB0aGlzLm9uUHJvZ3Jlc3MgPSBudWxsOwoKICAgIGNvbnN0IHJlYWRhYmxlU3RyZWFtID0gdGhpcy5fbXNnSGFuZGxlci5zZW5kV2l0aFN0cmVhbSgiR2V0UmFuZ2VSZWFkZXIiLCB7CiAgICAgIGJlZ2luLAogICAgICBlbmQKICAgIH0pOwoKICAgIHRoaXMuX3JlYWRlciA9IHJlYWRhYmxlU3RyZWFtLmdldFJlYWRlcigpOwogIH0KCiAgZ2V0IGlzU3RyZWFtaW5nU3VwcG9ydGVkKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgYXN5bmMgcmVhZCgpIHsKICAgIGNvbnN0IHsKICAgICAgdmFsdWUsCiAgICAgIGRvbmUKICAgIH0gPSBhd2FpdCB0aGlzLl9yZWFkZXIucmVhZCgpOwoKICAgIGlmIChkb25lKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICAgICBkb25lOiB0cnVlCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgdmFsdWU6IHZhbHVlLmJ1ZmZlciwKICAgICAgZG9uZTogZmFsc2UKICAgIH07CiAgfQoKICBjYW5jZWwocmVhc29uKSB7CiAgICB0aGlzLl9yZWFkZXIuY2FuY2VsKHJlYXNvbik7CiAgfQoKfQoKLyoqKi8gfSkKLyoqKioqKi8gCV0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193X3BkZmpzX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLyogd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzICovCi8qKioqKiovIAkoKCkgPT4gewovKioqKioqLyAJCS8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCQlfX3dfcGRmanNfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4gewovKioqKioqLyAJCQlmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7Ci8qKioqKiovIAkJCQlpZihfX3dfcGRmanNfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193X3BkZmpzX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHsKLyoqKioqKi8gCQkJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pOwovKioqKioqLyAJCQkJfQovKioqKioqLyAJCQl9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCX0pKCk7Ci8qKioqKiovIAkKLyoqKioqKi8gCS8qIHdlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQgKi8KLyoqKioqKi8gCSgoKSA9PiB7Ci8qKioqKiovIAkJX193X3BkZmpzX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKQovKioqKioqLyAJfSkoKTsKLyoqKioqKi8gCQovKioqKioqLyAJLyogd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCAqLwovKioqKioqLyAJKCgpID0+IHsKLyoqKioqKi8gCQkvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzCi8qKioqKiovIAkJX193X3BkZmpzX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHsKLyoqKioqKi8gCQkJaWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7Ci8qKioqKiovIAkJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTsKLyoqKioqKi8gCQkJfQovKioqKioqLyAJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pOwovKioqKioqLyAJCX07Ci8qKioqKiovIAl9KSgpOwovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0ge307Ci8vIFRoaXMgZW50cnkgbmVlZCB0byBiZSB3cmFwcGVkIGluIGFuIElJRkUgYmVjYXVzZSBpdCBuZWVkIHRvIGJlIGlzb2xhdGVkIGFnYWluc3Qgb3RoZXIgbW9kdWxlcyBpbiB0aGUgY2h1bmsuCigoKSA9PiB7CnZhciBleHBvcnRzID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCAoewogIHZhbHVlOiB0cnVlCn0pKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJXb3JrZXJNZXNzYWdlSGFuZGxlciIsICh7CiAgZW51bWVyYWJsZTogdHJ1ZSwKICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfd29ya2VyLldvcmtlck1lc3NhZ2VIYW5kbGVyOwogIH0KfSkpOwoKdmFyIF93b3JrZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEpOwoKY29uc3QgcGRmanNWZXJzaW9uID0gJzIuMTYuMTA1JzsKY29uc3QgcGRmanNCdWlsZCA9ICcxNzJjY2RiZTUnOwp9KSgpOwoKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfZXhwb3J0c19fOwovKioqKioqLyB9KSgpCjsKfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXBkZi53b3JrZXIuanMubWFw";pdfExports.GlobalWorkerOptions.workerSrc=PDFWorker;function usePDF(wI,c={onProgress:void 0,onPassword:void 0,onError:void 0,password:""}){const $=shallowRef(),h=shallowRef(0),M=shallowRef({}),_=pdfExports.getDocument(wI);if(c.onProgress&&(_.onProgress=c.onProgress),c.onPassword)_.onPassword=c.onPassword;else if(c.password){const z=(T,r)=>{T(c.password??"")};_.onPassword=z}return _.promise.then(async z=>{$.value=z.loadingTask,h.value=z.numPages;const T=await z.getMetadata(),r=await z.getAttachments(),Z=await z.getJavaScript();M.value={metadata:T,attachments:r,javascript:Z}},z=>{typeof c.onError=="function"&&c.onError(z)}),{pdf:$,pages:h,info:M}}export{_sfc_main as _,usePDF as u};
